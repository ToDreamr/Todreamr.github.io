
[{"content":"ä½ å¥½ï¼Œæˆ‘æ˜¯æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œæˆ‘æ˜¯è¿™ä¸ªåšå®¢çš„ä½œè€…ã€‚ æˆ‘æ˜¯ä¸€åå…¨æ ˆå¼€å‘è€…ã€‚æˆ‘å¶å°”å†™ä¸€äº›ç¬”è®°å’Œå¿ƒå¾—å¹¶ä¸”å®šæœŸåˆ†äº«åˆ°\rå“”å“©å“”å“©å’Œ\ræœ¬ç«™ç‚¹ å¦‚æœä½ å–œæ¬¢æ–°æµ·è¯šï¼Œå®«å´éªï¼Œä»Šæ•ï¼Œä¹Ÿè®¸æˆ‘ä»¬ä¼šæœ‰ç›¸ä¼¼çš„çˆ±å¥½å’Œæ€§æ ¼ã€‚ æˆ‘å¹³æ—¶è¿˜åœ¨å­¦ä¹ è‹±è¯­å’Œæ—¥è¯­ï¼Œè¯»ä¸€äº›é’æ˜¥æ–‡å­¦ã€‚æ¬¢è¿ä½ å’Œæˆ‘äº¤æµå­¦ä¹ å’Œè¯»ä¹¦çš„å¿ƒå¾—ğŸª¶ å½“ç„¶ï¼Œå¦‚æœä½ å¥½å¥‡æˆ‘\rç›®å‰åœ¨åšçš„äº‹æƒ…,ä¹Ÿå¯ä»¥äº†è§£æ›´å¤š\rå…³äºæˆ‘çš„ä¿¡æ¯ã€‚\nå½“ä½ å¼•ç”¨æœ¬ç«™ç‚¹æ–‡ç« æ—¶ï¼Œè¯·åŠ ä¸Šæœ¬ç«™é“¾æ¥å¹¶æ³¨æ˜ã€‚\r","date":"15 October 2024","externalUrl":null,"permalink":"/","section":"","summary":"ä½ å¥½ï¼Œæˆ‘æ˜¯æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œæˆ‘æ˜¯è¿™ä¸ªåšå®¢çš„ä½œè€…ã€‚ æˆ‘æ˜¯ä¸€åå…¨æ ˆå¼€å‘è€…ã€‚æˆ‘å¶å°”å†™ä¸€äº›ç¬”è®°å’Œå¿ƒå¾—å¹¶ä¸”å®šæœŸåˆ†äº«åˆ°\rå“”å“©å“”å“©å’Œ\ræœ¬ç«™ç‚¹ å¦‚æœä½ å–œæ¬¢æ–°æµ·è¯šï¼Œå®«å´éªï¼Œä»Šæ•ï¼Œä¹Ÿè®¸æˆ‘ä»¬ä¼šæœ‰ç›¸ä¼¼çš„çˆ±å¥½å’Œæ€§æ ¼ã€‚ æˆ‘å¹³æ—¶è¿˜åœ¨å­¦ä¹ è‹±è¯­å’Œæ—¥è¯­ï¼Œè¯»ä¸€äº›é’æ˜¥æ–‡å­¦ã€‚æ¬¢è¿ä½ å’Œæˆ‘äº¤æµå­¦ä¹ å’Œè¯»ä¹¦çš„å¿ƒå¾—ğŸª¶ å½“ç„¶ï¼Œå¦‚æœä½ å¥½å¥‡æˆ‘\rç›®å‰åœ¨åšçš„äº‹æƒ…,ä¹Ÿå¯ä»¥äº†è§£æ›´å¤š\rå…³äºæˆ‘çš„ä¿¡æ¯ã€‚\nå½“ä½ å¼•ç”¨æœ¬ç«™ç‚¹æ–‡ç« æ—¶ï¼Œè¯·åŠ ä¸Šæœ¬ç«™é“¾æ¥å¹¶æ³¨æ˜ã€‚\r","title":"","type":"page"},{"content":"\rMVCCæœºåˆ¶ #\rå½“ä¸€ä¸ªäº‹åŠ¡è¦å¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼ŒMVCC ä¼šä¸ºè¯¥äº‹åŠ¡åˆ›å»ºä¸€ä¸ªæ•°æ®å¿«ç…§ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹å®é™…çš„æ•°æ®è¡Œã€‚\nä¸€è‡´æ€§éé”å®šè¯»ï¼ˆè¯»å–æ•°æ®çš„æ—¶å€™ä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæ²¡æœ‰é”å®šï¼Œé€šè¿‡ç‰ˆæœ¬å·ï¼‰\nå¦‚æœè¯»å–çš„è¡Œæ­£åœ¨æ‰§è¡Œ DELETE æˆ– UPDATE æ“ä½œï¼Œè¿™æ—¶è¯»å–æ“ä½œä¸ä¼šå»ç­‰å¾…è¡Œä¸Šé”çš„é‡Šæ”¾ã€‚ç›¸ååœ°ï¼ŒInnoDB å­˜å‚¨å¼•æ“ä¼šå»è¯»å–è¡Œçš„ä¸€ä¸ªå¿«ç…§æ•°æ®ï¼Œå¯¹äºè¿™ç§è¯»å–å†å²æ•°æ®çš„æ–¹å¼ï¼Œæˆ‘ä»¬å«å®ƒå¿«ç…§è¯» \u0026gt;(snapshot read)\né”å®šè¯»å¦‚æœæ‰§è¡Œçš„æ˜¯ä¸‹åˆ—è¯­å¥ï¼Œå°±æ˜¯ é”å®šè¯»ï¼ˆLocking Readsï¼‰ select \u0026hellip; lock in share mode\nselect \u0026hellip; for updateinsertã€updateã€\ndelete\næ“ä½œåœ¨é”å®šè¯»ä¸‹ï¼Œè¯»å–çš„æ˜¯æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿™ç§è¯»ä¹Ÿè¢«ç§°ä¸º å½“å‰è¯»ï¼ˆcurrent readï¼‰ã€‚é”å®šè¯»ä¼šå¯¹è¯»å–åˆ°çš„è®°å½•åŠ é”ï¼šselect \u0026hellip; lock in share modeï¼šå¯¹è®°å½•åŠ  S é”ï¼Œå…¶å®ƒäº‹åŠ¡ä¹Ÿå¯ä»¥åŠ Sé”ï¼Œå¦‚æœåŠ  x é”åˆ™ä¼šè¢«é˜»å¡select \u0026hellip; for updateã€insertã€updateã€deleteï¼šå¯¹è®°å½•åŠ  X é”ï¼Œä¸”å…¶å®ƒäº‹åŠ¡ä¸èƒ½åŠ ä»»ä½•é”åœ¨ä¸€è‡´æ€§éé”å®šè¯»ä¸‹ï¼Œå³ä½¿è¯»å–çš„è®°å½•å·²è¢«å…¶å®ƒäº‹åŠ¡åŠ ä¸Š X é”ï¼Œè¿™æ—¶è®°å½•ä¹Ÿæ˜¯å¯ä»¥è¢«è¯»å–çš„ï¼Œå³è¯»å–çš„å¿«ç…§æ•°æ®ã€‚ä¸Šé¢è¯´äº†ï¼Œåœ¨ Repeatable Read ä¸‹ MVCC é˜²æ­¢äº†éƒ¨åˆ†å¹»è¯»ï¼Œè¿™è¾¹çš„ â€œéƒ¨åˆ†â€ æ˜¯æŒ‡åœ¨ ä¸€è‡´æ€§éé”å®šè¯» æƒ…å†µä¸‹ï¼Œåªèƒ½è¯»å–åˆ°ç¬¬ä¸€æ¬¡æŸ¥è¯¢ä¹‹å‰æ‰€æ’å…¥çš„æ•°æ®ï¼ˆæ ¹æ® Read View åˆ¤æ–­æ•°æ®å¯è§æ€§ï¼ŒRead View åœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶ç”Ÿæˆï¼‰ã€‚ä½†æ˜¯ï¼å¦‚æœæ˜¯ å½“å‰è¯» ï¼Œæ¯æ¬¡è¯»å–çš„éƒ½æ˜¯æœ€æ–°æ•°æ®ï¼Œè¿™æ—¶å¦‚æœä¸¤æ¬¡æŸ¥è¯¢ä¸­é—´æœ‰å…¶å®ƒäº‹åŠ¡æ’å…¥æ•°æ®ï¼Œå°±ä¼šäº§ç”Ÿå¹»è¯»ã€‚æ‰€ä»¥ï¼Œ InnoDB åœ¨å®ç°Repeatable Read æ—¶ï¼Œå¦‚æœæ‰§è¡Œçš„æ˜¯å½“å‰è¯»ï¼Œåˆ™ä¼šå¯¹è¯»å–çš„è®°å½•ä½¿ç”¨ Next-key Lock ï¼Œæ¥é˜²æ­¢å…¶å®ƒäº‹åŠ¡åœ¨é—´éš™é—´æ’å…¥æ•°æ®\nSELECT FEE_TYPE,SUM(${@com.kingtsoft.kingpower.frame.utils.core.DBUtil@getNull()}(AMOUNT,0)) AMOUNT\rFROM\r(\rSELECT AMOUNT,\r(SELECT CASE WHEN NAME LIKE \u0026#39;%ä½“æ£€%\u0026#39; OR NAME LIKE \u0026#39;%ç£å…±æŒ¯%\u0026#39; OR NAME LIKE \u0026#39;%CT%\u0026#39;OR NAME LIKE \u0026#39;%æ”¾å°„%\u0026#39;OR NAME LIKE \u0026#39;%æ£€æŸ¥%\u0026#39; THEN \u0026#39;05\u0026#39;\rWHEN NAME LIKE \u0026#39;%æ²»ç–—%\u0026#39; THEN \u0026#39;06\u0026#39;\rWHEN NAME LIKE \u0026#39;%æ‰‹æœ¯%\u0026#39; THEN \u0026#39;07\u0026#39;\rWHEN NAME LIKE \u0026#39;%æ£€éªŒ%\u0026#39; THEN \u0026#39;08\u0026#39;\rWHEN NAME LIKE \u0026#39;%ææ–™%\u0026#39; THEN \u0026#39;09\u0026#39;\rELSE \u0026#39;99\u0026#39;END FROM ACC_DIC_FEE_CLASSIFY WHERE ID = B.CLASSIFY_ID) FEE_TYPE\rFROM OIS_BILL_DETAILS A,ACC_DIC_FEE_ITEM B\rWHERE A.FEE_ID = B.ID\rAND A.BILL_ID IN (SELECT BILL_ID FROM OIS_BILL WHERE OPC_ID = #{opcId} AND INVALID_TIME IS NULL)\rAND A.HT = \u0026#39;C\u0026#39;\runion all\rSELECT AMOUNT,\r(CASE WHEN b.TYPE =\u0026#39;Y\u0026#39; THEN \u0026#39;01\u0026#39;\rWHEN b.TYPE = \u0026#39;Z\u0026#39; THEN \u0026#39;02\u0026#39;\rWHEN b.TYPE = \u0026#39;C\u0026#39; THEN \u0026#39;03\u0026#39;\rELSE \u0026#39;99\u0026#39; END) FEE_TYPE\rFROM OIS_BILL_DETAILS A,MMIS_DIC_MED B\rWHERE A.Mat_Id = B.ID\rAND B.TYPE IN (\u0026#39;Y\u0026#39;, \u0026#39;Z\u0026#39;, \u0026#39;C\u0026#39;)\rAND A.BILL_ID IN (SELECT BILL_ID FROM OIS_BILL WHERE OPC_ID = #{opcId} AND INVALID_TIME IS NULL)\rAND A.HT = \u0026#39;C\u0026#39;\runion all\rSELECT SUM(${@com.kingtsoft.kingpower.frame.utils.core.DBUtil@getNull()}(AMOUNT,0)) AMOUNT,\u0026#39;00\u0026#39; FEE_TYPE\rFROM OIS_BILL_DETAILS A\rWHERE A.BILL_ID IN (SELECT BILL_ID FROM OIS_BILL WHERE OPC_ID = #{opcId} AND INVALID_TIME IS NULL)\rAND A.HT = \u0026#39;C\u0026#39;\r) T\rGROUP BY FEE_TYPE åœ¨å­æŸ¥è¯¢ç»“æœé›†ä¸Šè¿›è¡Œæ“ä½œçš„æŸ¥è¯¢æ˜¯å¤–éƒ¨æŸ¥è¯¢ã€‚\nä¸€äº›ä¸è®¤è¯†çš„å‡½æ•°ï¼š\nCOALESCE å‡½æ•°æ˜¯ä¸€ä¸ªåœ¨ SQL ä¸­ç”¨äºå¤„ç†ç©ºå€¼çš„å‡½æ•°ï¼Œå®ƒçš„è¯­æ³•å¦‚ä¸‹ï¼š\rCOALESCE ( expression_1, expression_2,..., expression_n )\rCOALESCE å‡½æ•°ä¼šä¾æ¬¡æ£€æŸ¥æ¯ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªéç©ºçš„å€¼ã€‚å¦‚æœæ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½ä¸ºç©ºå€¼ï¼Œåˆ™è¿”å› NULLã€‚\rä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ COALESCE å‡½æ•°çš„ç¤ºä¾‹ï¼š\rå‡è®¾æœ‰ä¸€ä¸ªåä¸º employees çš„è¡¨ï¼Œå…¶ä¸­åŒ…å« nameã€salary å’Œ bonus ä¸‰ä¸ªåˆ—ã€‚å¦‚æœ bonus åˆ—çš„å€¼ä¸º NULLï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨ 0 æ¥ä»£æ›¿ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢æ¥å®ç°ï¼š\rSELECT name, salary, COALESCE(bonus, 0) AS bonus FROM employees;\råœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼ŒCOALESCE å‡½æ•°ä¼šæ£€æŸ¥ bonus åˆ—çš„å€¼ã€‚å¦‚æœ bonus åˆ—çš„å€¼ä¸ä¸º NULLï¼Œå®ƒå°†è¿”å›è¯¥å€¼ï¼›å¦åˆ™ï¼Œå®ƒå°†è¿”å› 0ã€‚ åœ¨ SQL ä¸­ï¼ŒEXTRACT()æ˜¯ä¸€ä¸ªç”¨äºä»æ—¥æœŸæ—¶é—´å€¼ä¸­æå–ç‰¹å®šéƒ¨åˆ†ï¼ˆå¦‚å¹´ã€æœˆã€æ—¥ã€å°æ—¶ç­‰ï¼‰çš„å‡½æ•°ã€‚\rå…¶è¯­æ³•é€šå¸¸ä¸ºï¼šEXTRACT(unit FROM datetime_expression)ã€‚\rå…¶ä¸­ï¼Œunitæ˜¯è¦æå–çš„æ—¶é—´éƒ¨åˆ†ï¼Œå¯ä»¥æ˜¯YEARï¼ˆå¹´ï¼‰ã€MONTHï¼ˆæœˆï¼‰ã€DAYï¼ˆæ—¥ï¼‰ã€HOURï¼ˆå°æ—¶ï¼‰ã€MINUTEï¼ˆåˆ†é’Ÿï¼‰ã€SECONDï¼ˆç§’ï¼‰ç­‰ï¼›datetime_expressionæ˜¯ä¸€ä¸ªæ—¥æœŸæ—¶é—´ç±»å‹çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæ—¥æœŸæ—¶é—´åˆ—ã€ä¸€ä¸ªå‡½æ•°è¿”å›çš„æ—¥æœŸæ—¶é—´å€¼æˆ–ä¸€ä¸ªå¸¸é‡æ—¥æœŸæ—¶é—´å€¼ã€‚\rä¾‹å¦‚ï¼š\rsql\rå¤åˆ¶\rSELECT EXTRACT(YEAR FROM \u0026#39;2023-10-29\u0026#39;::date) AS year_value;\r-- è¿”å›ç»“æœä¸º 2023\rè¿™ä¸ªå‡½æ•°åœ¨å¤„ç†æ—¥æœŸæ—¶é—´æ•°æ®æ—¶éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥æ–¹ä¾¿åœ°è·å–ç‰¹å®šçš„æ—¶é—´éƒ¨åˆ†è¿›è¡Œåˆ†ææˆ–è®¡ç®—ã€‚ä¸åŒçš„æ•°æ®åº“ç³»ç»Ÿå¯èƒ½å¯¹EXTRACT()å‡½æ•°çš„æ”¯æŒç•¥æœ‰ä¸åŒï¼Œä½†åŸºæœ¬ç”¨æ³•ç›¸ä¼¼ã€‚ ä»€ä¹ˆæ˜¯å¤–éƒ¨æŸ¥è¯¢ï¼š\nåœ¨ SQL ä¸­ï¼Œèšåˆå‡½æ•°æ˜¯å¯¹ä¸€ç»„å€¼è¿›è¡Œè®¡ç®—å¹¶è¿”å›å•ä¸€å€¼çš„å‡½æ•°ã€‚å½“èšåˆå‡½æ•°å‡ºç°åœ¨æŸ¥è¯¢çš„ SELECT å­å¥ä¸­ï¼Œä¸”ä¸æ˜¯åœ¨å­æŸ¥è¯¢ä¸­æ—¶ï¼Œå°±ç§°ä¸ºå¤–éƒ¨èšåˆå‡½æ•°ã€‚å¤–éƒ¨èšåˆå‡½æ•°ç”¨äºå¯¹æ•´ä¸ªæŸ¥è¯¢ç»“æœé›†è¿›è¡Œèšåˆæ“ä½œã€‚\nåŒºåˆ†å¤–æŸ¥è¯¢å’Œå­æŸ¥è¯¢ï¼š\n*æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡è–ªèµ„ ï¼š\nSELECT department_id, (SELECTAVG(salary) FROM employees WHERE department_id = e.department_id) AS average_salary FROM employees e GROUP BY department_id; *æŸ¥è¯¢æ¯ä¸ªç­çº§çš„å­¦ç”Ÿäººæ•° ï¼š\nSELECT class_id, (SELECTCOUNT(*) FROM students WHERE class_id = s.class_id) AS student_count FROM students s GROUP BY class_id; *æŸ¥è¯¢æ¯ä¸ªåŸå¸‚çš„è®¢å•æ€»é‡‘é¢ ï¼š\nSELECT city, (SELECTSUM(amount) FROM orders WHERE city = o.city) AS total_amount FROM orders o GROUP BY city; *æŸ¥è¯¢æ¯ä¸ªäº§å“ç±»åˆ«çš„æœ€é«˜ä»·æ ¼ ï¼š\nSELECT category_id, (SELECTMAX(price) FROM products WHERE category_id = p.category_id) AS max_price FROM products p GROUP BY category_id; *æŸ¥è¯¢æ¯ä¸ªä¾›åº”å•†çš„æœ€ä½ä»·æ ¼ ï¼š\nSELECT supplier_id, (SELECTMIN(price) FROM products WHERE supplier_id = s.supplier_id) AS min_price FROM products s GROUP BY supplier_id; ","date":"15 October 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/mysql/","section":"ç¬”è®°s","summary":"MVCCæœºåˆ¶ #\rå½“ä¸€ä¸ªäº‹åŠ¡è¦å¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼ŒMVCC ä¼šä¸ºè¯¥äº‹åŠ¡åˆ›å»ºä¸€ä¸ªæ•°æ®å¿«ç…§ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹å®é™…çš„æ•°æ®è¡Œã€‚\nä¸€è‡´æ€§éé”å®šè¯»ï¼ˆè¯»å–æ•°æ®çš„æ—¶å€™ä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæ²¡æœ‰é”å®šï¼Œé€šè¿‡ç‰ˆæœ¬å·ï¼‰\nå¦‚æœè¯»å–çš„è¡Œæ­£åœ¨æ‰§è¡Œ DELETE æˆ– UPDATE æ“ä½œï¼Œè¿™æ—¶è¯»å–æ“ä½œä¸ä¼šå»ç­‰å¾…è¡Œä¸Šé”çš„é‡Šæ”¾ã€‚ç›¸ååœ°ï¼ŒInnoDB å­˜å‚¨å¼•æ“ä¼šå»è¯»å–è¡Œçš„ä¸€ä¸ªå¿«ç…§æ•°æ®ï¼Œå¯¹äºè¿™ç§è¯»å–å†å²æ•°æ®çš„æ–¹å¼ï¼Œæˆ‘ä»¬å«å®ƒå¿«ç…§è¯» \u0026gt;(snapshot read)\né”å®šè¯»å¦‚æœæ‰§è¡Œçš„æ˜¯ä¸‹åˆ—è¯­å¥ï¼Œå°±æ˜¯ é”å®šè¯»ï¼ˆLocking Readsï¼‰ select \u0026hellip; lock in share mode\nselect \u0026hellip; for updateinsertã€updateã€\ndelete\næ“ä½œåœ¨é”å®šè¯»ä¸‹ï¼Œè¯»å–çš„æ˜¯æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿™ç§è¯»ä¹Ÿè¢«ç§°ä¸º å½“å‰è¯»ï¼ˆcurrent readï¼‰ã€‚é”å®šè¯»ä¼šå¯¹è¯»å–åˆ°çš„è®°å½•åŠ é”ï¼šselect \u0026hellip; lock in share modeï¼šå¯¹è®°å½•åŠ  S é”ï¼Œå…¶å®ƒäº‹åŠ¡ä¹Ÿå¯ä»¥åŠ Sé”ï¼Œå¦‚æœåŠ  x é”åˆ™ä¼šè¢«é˜»å¡select \u0026hellip; for updateã€insertã€updateã€deleteï¼šå¯¹è®°å½•åŠ  X é”ï¼Œä¸”å…¶å®ƒäº‹åŠ¡ä¸èƒ½åŠ ä»»ä½•é”åœ¨ä¸€è‡´æ€§éé”å®šè¯»ä¸‹ï¼Œå³ä½¿è¯»å–çš„è®°å½•å·²è¢«å…¶å®ƒäº‹åŠ¡åŠ ä¸Š X é”ï¼Œè¿™æ—¶è®°å½•ä¹Ÿæ˜¯å¯ä»¥è¢«è¯»å–çš„ï¼Œå³è¯»å–çš„å¿«ç…§æ•°æ®ã€‚ä¸Šé¢è¯´äº†ï¼Œåœ¨ Repeatable Read ä¸‹ MVCC é˜²æ­¢äº†éƒ¨åˆ†å¹»è¯»ï¼Œè¿™è¾¹çš„ â€œéƒ¨åˆ†â€ æ˜¯æŒ‡åœ¨ ä¸€è‡´æ€§éé”å®šè¯» æƒ…å†µä¸‹ï¼Œåªèƒ½è¯»å–åˆ°ç¬¬ä¸€æ¬¡æŸ¥è¯¢ä¹‹å‰æ‰€æ’å…¥çš„æ•°æ®ï¼ˆæ ¹æ® Read View åˆ¤æ–­æ•°æ®å¯è§æ€§ï¼ŒRead View åœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶ç”Ÿæˆï¼‰ã€‚ä½†æ˜¯ï¼å¦‚æœæ˜¯ å½“å‰è¯» ï¼Œæ¯æ¬¡è¯»å–çš„éƒ½æ˜¯æœ€æ–°æ•°æ®ï¼Œè¿™æ—¶å¦‚æœä¸¤æ¬¡æŸ¥è¯¢ä¸­é—´æœ‰å…¶å®ƒäº‹åŠ¡æ’å…¥æ•°æ®ï¼Œå°±ä¼šäº§ç”Ÿå¹»è¯»ã€‚æ‰€ä»¥ï¼Œ InnoDB åœ¨å®ç°Repeatable Read æ—¶ï¼Œå¦‚æœæ‰§è¡Œçš„æ˜¯å½“å‰è¯»ï¼Œåˆ™ä¼šå¯¹è¯»å–çš„è®°å½•ä½¿ç”¨ Next-key Lock ï¼Œæ¥é˜²æ­¢å…¶å®ƒäº‹åŠ¡åœ¨é—´éš™é—´æ’å…¥æ•°æ®","title":"MySQLä¸€äº›å¸¸è¯†å’Œå‡½æ•°","type":"ç¬”è®°"},{"content":"å»ºè¡¨è¯­å¥ï¼š\ncreate table DEPARTMENTS ( deptno number, name varchar2(50) not null, location varchar2(50), constraint pk_departments primary key (deptno) ); Tables can declarative specify relationships between tables, typically referred to as referential integrity. To see how this works we can create a \u0026ldquo;child\u0026rdquo; table of the DEPARTMENTS table by including a foreign key in the EMPLOYEES table that references the DEPARTMENTS table. For example:\ncreate table EMPLOYEES ( empno number, name varchar2(50) not null, job varchar2(50), manager number, hiredate date, salary number(7,2), commission number(7,2), deptno number, constraint pk_employees primary key (empno), constraint fk_employees_deptno foreign key (deptno) references DEPARTMENTS (deptno) ); è§¦å‘å™¨ï¼š\nTriggers are procedures that are stored in the database and are implicitly run, or fired, when something happens. Traditionally, triggers supported the execution of a procedural code, in Oracle procedural SQL is called a PL/SQL block. PL stands for procedural language. When an INSERT, UPDATE, or DELETE occurred on a table or view. Triggers support system and other data events on DATABASE and SCHEMA.\nTriggers are frequently used to automatically populate table primary keys, the trigger examples below show an example trigger to do just this. We will use a built in function to obtain a globallally unique identifier or GUID.\nåˆ›å»ºè§¦å‘å™¨ï¼š\ncreate or replace trigger DEPARTMENTS_BIU before insert or update on DEPARTMENTS for each row begin if inserting and :new.deptno is null then :new.deptno := to_number(sys_guid(), \u0026#39;Do something\u0026#39;); end if; end; / create or replace trigger EMPLOYEES_BIU before insert or update on EMPLOYEES for each row begin if inserting and :new.empno is null then :new.empno := to_number(sys_guid(), \u0026#39;Do something\u0026#39;); end if; end; / Now that we have tables created, and we have triggers to automatically populate our primary keys, we can add data to our tables. Because we have a parent child relationship, with the DEPARTMENTS table as the parent table, and the EMPLOYEES table as the child we will first INSERT a row into the DEPARTMENTS table.\nselect * from departments; use the sentence above to select your data.\nYou can see that an ID will have been automatically generated. You can now insert into the EMPLOYEES table a new row but you will need to put the generated DEPTID value into your SQL INSERT statement. The examples below show how we can do this using a SQL query, but you could simply enter the department number directly.\ninsert into EMPLOYEES (name, job, salary, deptno) values (\u0026#39;Sam Smith\u0026#39;,\u0026#39;Programmer\u0026#39;, 5000, (select deptno from departments where name = \u0026#39;Development\u0026#39;)); insert into EMPLOYEES (name, job, salary, deptno) values (\u0026#39;Mara Martin\u0026#39;,\u0026#39;Analyst\u0026#39;, 6000, (select deptno from departments where name = \u0026#39;Finance\u0026#39;)); insert into EMPLOYEES (name, job, salary, deptno) values (\u0026#39;Yun Yates\u0026#39;,\u0026#39;Analyst\u0026#39;, 5500, (select deptno from departments where name = \u0026#39;Development\u0026#39;)); Indexing Columns #\rTypically developers index columns for three major reasons:\nTo enforce unique values within a column To improve data access performance To prevent lock escalation when updating rows of tables that use declarative referential integrity When a table is created and a PRIMARY KEY is specified an index is automatically created to enforce the primary key constraint. If you specific UNIQUE for a column when creating a column a unique index is also created. To see the indexes that already exist for a given table you can run the following dictionary query.\nselect table_name \u0026#34;Table\u0026#34;, index_name \u0026#34;Index\u0026#34;, column_name \u0026#34;Column\u0026#34;, column_position \u0026#34;Position\u0026#34; from user_ind_columns where table_name = \u0026#39;EMPLOYEES\u0026#39; or table_name = \u0026#39;DEPARTMENTS\u0026#39; order by table_name, column_name, column_position use a foreign key:\ncreate index employee_dept_no_fk_idx on employees (deptno) when select some other data with oracle function like below:\nYou can sum data in tables using aggregate functions. We will use column aliases to rename columns for readability, we will also use the null value function (NVL) to allow us to properly sum columns with null values.\nselect count(*) employee_count,\rsum(salary) total_salary,\rsum(commission) total_commission,\rmin(salary + nvl(commission,0)) min_compensation,\rmax(salary + nvl(commission,0)) max_compensation\rfrom employees; ","date":"15 October 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/oracle/","section":"ç¬”è®°s","summary":"å»ºè¡¨è¯­å¥ï¼š\ncreate table DEPARTMENTS ( deptno number, name varchar2(50) not null, location varchar2(50), constraint pk_departments primary key (deptno) ); Tables can declarative specify relationships between tables, typically referred to as referential integrity.","title":"Oracleæ•°æ®åº“","type":"ç¬”è®°"},{"content":"","date":"15 October 2024","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"\rUbuntuæ“ä½œç³»ç»Ÿ #\rNginxå®‰è£… #\råˆ é™¤nginxï¼Œâ€“purgeåŒ…æ‹¬é…ç½®æ–‡ä»¶ #\rsudo apt-get --purge remove nginx åˆ é™¤Nginxçš„ç›¸å…³æ ¸å¿ƒåŒ…å’Œ\nsudo apt-get --purge remove nginx\rsudo apt-get --purge remove nginx-common\rsudo apt-get --purge remove nginx-core æŸ¥çœ‹æ˜¯å¦è¿˜æœ‰Nginx\ndpkg --get-selections|grep nginxwhich nginx # ä¸åœ¨æ˜¾ç¤ºnginx å®‰è£…Nginx\nsudo apt-get install nginx ufwé˜²ç«å¢™ #\rå¼€æ”¾ç«¯å£ï¼š\nufw allow 80/tcp å»ºç«‹æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶è·¯å¾„æ˜ å°„ï¼š #\r# é¦–å…ˆå®‰è£…å·¥å…·\ryum -y install open-vm-tools open-vm-tools-desktop\r# æŸ¥çœ‹å…±äº«çš„ç›®å½• æ­¤æ—¶å¯ä»¥çœ‹åˆ°ï¼Œåˆšæ‰é…ç½®çš„wwwç›®å½•\rvmware-hgfsclient\r# åˆ›å»ºä¸€ä¸ªç›®å½•, ç”¨äºæ˜ å°„å…³è”\rmkdir /www\r# æ­¤æ—¶ç”¨ ls /www æŸ¥çœ‹ç›®å½•æ˜¯ç©ºçš„\r# æ˜ å°„å…±äº«ç›®å½•\rvmhgfs-fuse .host:/www /www -o subtype=vmhgfs-fuse,allow_other,nonempty\r# æ­¤æ—¶ ls /www æŸ¥çœ‹ç›®å½•ï¼Œå·²ç»æœ‰ä¸œè¥¿äº†ï¼Œæ˜ å°„æˆåŠŸã€‚\r# å¯ä»¥ä¸ç”¨å‚æ•°ï¼Œå¦‚ä¸‹\rvmhgfs-fuse .host:/www /www\r# æ³¨æ„ï¼šè¿™æ ·è™½ç„¶æ˜ å°„æˆåŠŸï¼Œå¹¶ä¸”ï¼Œä½¿ç”¨ ll /www æŸ¥çœ‹é‡Œé¢çš„å†…å®¹ï¼Œæƒé™éƒ½æ˜¯æœ€é«˜æƒé™ï¼Œä½†æ˜¯ï¼Œå…¶ä»–ç”¨æˆ·å´è¿˜æ˜¯æ— æ³•è®¿é—®çš„ã€‚ ","date":"15 October 2024","externalUrl":null,"permalink":"/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","section":"","summary":"Ubuntuæ“ä½œç³»ç»Ÿ #\rNginxå®‰è£… #\råˆ é™¤nginxï¼Œâ€“purgeåŒ…æ‹¬é…ç½®æ–‡ä»¶ #\rsudo apt-get --purge remove nginx åˆ é™¤Nginxçš„ç›¸å…³æ ¸å¿ƒåŒ…å’Œ\nsudo apt-get --purge remove nginx\rsudo apt-get --purge remove nginx-common\rsudo apt-get --purge remove nginx-core æŸ¥çœ‹æ˜¯å¦è¿˜æœ‰Nginx\ndpkg --get-selections|grep nginxwhich nginx # ä¸åœ¨æ˜¾ç¤ºnginx å®‰è£…Nginx","title":"Ubuntuæ“ä½œç³»ç»Ÿ","type":"page"},{"content":"","date":"15 October 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/","section":"ç¬”è®°s","summary":"","title":"ç¬”è®°s","type":"ç¬”è®°"},{"content":"\rUMLç±»å›¾ #\rUMLâ€”â€”Unified modeling language UML(ç»Ÿä¸€å»ºæ¨¡è¯­è¨€)ï¼Œæ˜¯ä¸€ç§ç”¨äºè½¯ä»¶ç³»ç»Ÿåˆ†æå’Œè®¾è®¡çš„è¯­è¨€å·¥å…·ï¼Œå®ƒç”¨äºå¸®åŠ©è½¯ä»¶å¼€å‘äººå‘˜è¿›è¡Œæ€è€ƒå’Œè®°å½•æ€è·¯çš„ç»“æœ\nUMLæœ¬èº«æ˜¯ä¸€å¥—ç¬¦å·çš„è§„å®šï¼Œå°±åƒæ•°å­¦ç¬¦å·å’ŒåŒ–å­¦ç¬¦å·ä¸€æ ·ï¼Œè¿™äº›ç¬¦å·ç”¨äºæè¿°è½¯ä»¶æ¨¡å‹ä¸­çš„å„ä¸ªå…ƒç´ å’Œä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œæ¯”å¦‚ç±»ã€æ¥å£ã€å®ç°ã€æ³›åŒ–ã€ä¾èµ–ã€ç»„åˆã€èšåˆç­‰ è®¾è®¡ç±»çš„åŸåˆ™ï¼š #\rè®¾è®¡ä¸€ä¸ªç±»ä¸­çš„ä¿¡æ¯å’Œè¡Œä¸ºè¦ é«˜å†…èš è®¾è®¡å¤šä¸ªç±», ç±»ä¹‹é—´è¦ ä½è€¦åˆ å¯¹äº ç»§æ‰¿(æ³›åŒ–)ã€å®ç°(å®ç°)è¿™ä¸¤ç§å…³ç³»æ¯”è¾ƒç®€å•ï¼Œå®ƒä»¬ä½“ç°çš„æ˜¯ä¸€ç§ç±»ä¸ç±»ã€æˆ–è€…ç±»ä¸æ¥å£ä¹‹é—´çš„ çºµå‘å…³ç³»ã€‚ å…¶ä»–çš„å››ç§å…³ç³»åˆ™ä½“ç°çš„æ˜¯ç±»ä¸ç±»ã€æˆ–è€…ç±»ä¸æ¥å£ä¹‹é—´çš„ å¼•ç”¨/æ¨ªå‘å…³ç³»ã€‚è¿™å››ç§å…³ç³»æ‰€è¡¨ç°çš„å¼ºå¼±ç¨‹åº¦æ¥çœ‹ï¼Œä»å¼ºåˆ°å¼±ä¾æ¬¡ä¸ºï¼šç»„åˆ\u0026gt;èšåˆ\u0026gt;å…³è”\u0026gt;ä¾èµ–ã€‚\n","date":"15 October 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E7%94%BB%E5%9B%BE/","section":"ç¬”è®°s","summary":"UMLç±»å›¾ #\rUMLâ€”â€”Unified modeling language UML(ç»Ÿä¸€å»ºæ¨¡è¯­è¨€)ï¼Œæ˜¯ä¸€ç§ç”¨äºè½¯ä»¶ç³»ç»Ÿåˆ†æå’Œè®¾è®¡çš„è¯­è¨€å·¥å…·ï¼Œå®ƒç”¨äºå¸®åŠ©è½¯ä»¶å¼€å‘äººå‘˜è¿›è¡Œæ€è€ƒå’Œè®°å½•æ€è·¯çš„ç»“æœ\nUMLæœ¬èº«æ˜¯ä¸€å¥—ç¬¦å·çš„è§„å®šï¼Œå°±åƒæ•°å­¦ç¬¦å·å’ŒåŒ–å­¦ç¬¦å·ä¸€æ ·ï¼Œè¿™äº›ç¬¦å·ç”¨äºæè¿°è½¯ä»¶æ¨¡å‹ä¸­çš„å„ä¸ªå…ƒç´ å’Œä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œæ¯”å¦‚ç±»ã€æ¥å£ã€å®ç°ã€æ³›åŒ–ã€ä¾èµ–ã€ç»„åˆã€èšåˆç­‰ è®¾è®¡ç±»çš„åŸåˆ™ï¼š #\rè®¾è®¡ä¸€ä¸ªç±»ä¸­çš„ä¿¡æ¯å’Œè¡Œä¸ºè¦ é«˜å†…èš è®¾è®¡å¤šä¸ªç±», ç±»ä¹‹é—´è¦ ä½è€¦åˆ å¯¹äº ç»§æ‰¿(æ³›åŒ–)ã€å®ç°(å®ç°)è¿™ä¸¤ç§å…³ç³»æ¯”è¾ƒç®€å•ï¼Œå®ƒä»¬ä½“ç°çš„æ˜¯ä¸€ç§ç±»ä¸ç±»ã€æˆ–è€…ç±»ä¸æ¥å£ä¹‹é—´çš„ çºµå‘å…³ç³»ã€‚ å…¶ä»–çš„å››ç§å…³ç³»åˆ™ä½“ç°çš„æ˜¯ç±»ä¸ç±»ã€æˆ–è€…ç±»ä¸æ¥å£ä¹‹é—´çš„ å¼•ç”¨/æ¨ªå‘å…³ç³»ã€‚è¿™å››ç§å…³ç³»æ‰€è¡¨ç°çš„å¼ºå¼±ç¨‹åº¦æ¥çœ‹ï¼Œä»å¼ºåˆ°å¼±ä¾æ¬¡ä¸ºï¼šç»„åˆ\u0026gt;èšåˆ\u0026gt;å…³è”\u0026gt;ä¾èµ–ã€‚","title":"ç¨‹åºè®¾è®¡ä¸­ä½¿ç”¨åˆ°çš„ä¸€äº›å›¾","type":"ç¬”è®°"},{"content":"","date":"15 October 2024","externalUrl":null,"permalink":"/tags/%E9%9D%A2%E8%AF%95/","section":"Tags","summary":"","title":"é¢è¯•","type":"tags"},{"content":"\ræ•°å­—é©¬åŠ› #\rè¯´å‡ºè‡ªå·±å®ä¹ ç»å†ä¸­è´Ÿè´£çš„æœ€å‡ºå½©çš„é¡¹ç›®å¹¶ä»‹ç»æƒ…å†µ\nå…«è‚¡æ–‡ï¼š\nListä½¿ç”¨forå¾ªç¯éå†å¢åŠ æˆ–åˆ é™¤å…ƒç´ æ˜¯å¦å¯è¡Œ?\nä¸å¯ä»¥ï¼Œå›æŠ›å‡º(ConcurrentModificationException)\nåŸå› ï¼šremoveå’Œaddæ“ä½œä¼šå¯¼è‡´modCountå’Œè¿­ä»£å™¨ä¸­çš„expectedModCountä¸ä¸€è‡´ã€‚\nè§£é‡Šï¼šæ¶‰åŠåˆ°fail-fastæœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯ä¸€æ—¦æ£€æµ‹åˆ°å¯èƒ½å‘ç”Ÿé”™è¯¯ï¼Œå°±ç«‹é©¬æŠ›å‡ºå¼‚å¸¸ï¼Œç¨‹åºä¸ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œåœ¨Javaä¸­å¯¹é›†åˆçš„æ“ä½œç»å¸¸æ¶‰åŠåˆ°fail-fastæœºåˆ¶ï¼Œ å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿfail-fastäº‹ä»¶\nè§£å†³åŠæ³•ï¼šæ™®é€šforå¾ªç¯ã€ä½¿ç”¨Iteratorè¿›è¡Œå…ƒç´ åˆ é™¤ã€ä½¿ç”¨Streamçš„filterã€ä½¿ç”¨fail-safeçš„ç±»ç­‰ã€‚\næ•°ç»„è½¬æˆé›†åˆï¼š\n//1: List list = new ArrayList\u0026lt;\u0026gt;(Arrays.asList(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;)) //2: Integer [] myArray = { 1, 2, 3 }; List myList = Arrays.stream(myArray).collect(Collectors.toList()); //åŸºæœ¬ç±»å‹ä¹Ÿå¯ä»¥å®ç°è½¬æ¢ï¼ˆä¾èµ–boxedçš„è£…ç®±æ“ä½œï¼‰ int [] myArray2 = { 1, 2, 3 }; List myList = Arrays.stream(myArray2).boxed().collect(Collectors.toList()); çº¿ç¨‹æ± ä½¿ç”¨æ–¹æ³•ï¼Œå¦‚æœè¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ± å¤§å°ï¼Œæ–°åˆ›å»ºçš„çº¿ç¨‹æ”¾å…¥å“ªä¸€ä¸ªé˜Ÿåˆ—ï¼Ÿ\nè¯¢é—®MVCæ¨¡å¼ï¼Œè¯´å‡ºå…¶æ•°æ®æµèµ°å‘ï¼Œå¦‚ä½•å¯¹å…¶å‰ååšå‡ºè§„èŒƒå‹æ“ä½œï¼Ÿ\nè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨ï¼Œå†…éƒ¨åŒºåˆ«ï¼Œæºç çœ‹å¾—ä¸æ˜¯å¾ˆä»”ç»†ã€‚\nSpring çš„Beanç”Ÿå‘½å‘¨æœŸï¼Œå¯¹å‰åé¡ºåºåšæ‰©å±•å¦‚ä½•æ“ä½œï¼Ÿ\næ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨Servletå’Œå†…éƒ¨æ–¹æ³•æ‹¦æˆªé—®é¢˜ã€‚\nFilter å¯åœ¨è¯·æ±‚åˆ°è¾¾ DispatcherServlet ä¹‹å‰å¯¹å…¶è¿›è¡Œæ‹¦æˆªï¼Œå› æ­¤éå¸¸é€‚åˆæ‰§è¡Œç²—ç²’åº¦ä»»åŠ¡ï¼Œä¾‹å¦‚\nè®¤è¯ã€‚\næ—¥å¿—è®°å½•å’Œå®¡è®¡ã€‚ å‹ç¼©å›¾åƒå’Œæ•°æ®ã€‚ ä»»ä½•å¸Œæœ›ä¸ Spring MVC è§£è€¦çš„åŠŸèƒ½ã€‚ HandlerInterceptor ä¼šæ‹¦æˆª DispatcherServlet ä¸ Controller ä¹‹é—´çš„è¯·æ±‚ã€‚è¿™æ˜¯åœ¨ Spring MVC æ¡†æ¶å†…å®Œæˆçš„ï¼Œæä¾›äº†å¯¹ Handler å’Œ ModelAndView å¯¹è±¡çš„è®¿é—®ã€‚è¿™å‡å°‘äº†é‡å¤ä»£ç ï¼Œå¹¶å…è®¸å®ç°æ›´ç»†ç²’åº¦çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š\nå¤„ç†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œå¦‚åº”ç”¨æ—¥å¿—è®°å½•ã€‚ è¯¦ç»†çš„æƒé™æ£€æŸ¥ã€‚ æ“ä½œ Spring Context æˆ– Modelã€‚ SQLä¼˜åŒ–ç­–ç•¥ï¼Œæåˆ°äº†ç´¢å¼•ï¼Œç«‹é©¬é—®åˆ°ç´¢å¼•ï¼Œåœºæ™¯æ˜¯ä¸‰å¼ è¡¨ï¼Œå»ºç«‹äº†è”åˆç´¢å¼•ï¼ŒæŸ¥è¯¢æ—¶å€™ä½¿ç”¨Where A=B=C ä¼šä¸ä¼šèµ°è”åˆç´¢å¼•ã€‚\nä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨ç´¢å¼•ï¼Œå½“è¡¨å­—æ®µæ•°æ®æ˜¯é‡å¤ç›¸ç­‰çš„æ—¶å€™æ˜¯å¦é€‚åˆå»ºç«‹ç´¢å¼•ï¼Ÿ\næ€»ä½“çœ‹æ¥ä¸»è¦æ˜¯å…«è‚¡æ–‡çš„é—®ç­”ï¼Œä¸è¶³ç‚¹æ˜¯æ¡†æ¶å’Œç´¢å¼•è¢«æ‰¹è¯„äº†ã€‚\nå…³äºäº‹åŠ¡ï¼Œå®šä¹‰çš„ä¸šåŠ¡å¼‚å¸¸ï¼ˆé”™è¯¯çš„ï¼‰ï¼ŒæŒ‰ç†æ¥è¯´åº”è¯¥æ˜¯è¶…ç±»å¼‚å¸¸ï¼Œè€Œä¸æ˜¯ä¸šåŠ¡å¼‚å¸¸å›æ»šï¼Œé—®çš„é—®é¢˜æ˜¯åŒ…æ‹¬çš„å¤§èŒƒå›´äº‹åŠ¡ï¼Œå†…éƒ¨æŠ›å‡ºçš„æ˜¯å…¶ä»–å¼‚å¸¸ä¼šä¸ä¼šå›æ»šçš„é—®é¢˜ã€‚\nå¦‚ä½•ä½¿ç”¨çº¿ç¨‹æ± çš„é—®é¢˜ï¼Ÿå½“è¶…è¿‡äº†æ ¸å¿ƒçº¿ç¨‹æ± å¤§å°ä½†æ˜¯æ²¡æœ‰è¶…è¿‡æœ€å¤§çº¿ç¨‹æ± å¤§å°çš„æ—¶å€™ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆåˆ«çš„äº‹æƒ…ï¼Ÿ\næ ¸å¿ƒçº¿ç¨‹æ±  ï¼š å½“çº¿ç¨‹æ± çš„å½“å‰çº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ± å¤§å°æ—¶ï¼Œçº¿ç¨‹æ± ä¼šç›´æ¥åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚ è¶…è¿‡æ ¸å¿ƒä½†æœªè¾¾åˆ°æœ€å¤§ ï¼š å¦‚æœå½“å‰çº¿ç¨‹æ•°å·²ç»è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ± å¤§å°ï¼Œä½†ä»æœªè¶…è¿‡æœ€å¤§çº¿ç¨‹æ± å¤§å°ï¼Œæ–°çš„ä»»åŠ¡å°†è¢«æ”¾å…¥æŒ‡å®šçš„å·¥ä½œé˜Ÿåˆ—ï¼ˆworkQueueï¼‰ä¸­è¿›è¡Œæ’é˜Ÿã€‚ å½“é˜Ÿåˆ—æ»¡æ—¶ ï¼š å¦‚æœå·¥ä½œé˜Ÿåˆ—æ»¡äº†ï¼Œå¹¶ä¸”å½“å‰çº¿ç¨‹æ•°ä»åœ¨æœ€å¤§çº¿ç¨‹æ•°ä¹‹å†…ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ± å¤§å°ã€‚ ä¸€æ—¦è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ± å¤§å°ï¼Œå¦‚æœè¿˜æœ‰ä»»åŠ¡éœ€è¦å¤„ç†ï¼Œçº¿ç¨‹æ± å°†æ ¹æ®é…ç½®çš„æ‹’ç»ç­–ç•¥æ¥å†³å®šå¦‚ä½•å¤„ç†è¿™äº›ä»»åŠ¡ï¼ˆå¦‚æŠ›å‡ºå¼‚å¸¸ã€ä¸¢å¼ƒä»»åŠ¡æˆ–è°ƒç”¨è€…è¿è¡Œç­‰ï¼‰ã€‚ ä»€ä¹ˆæ—¶å€™æ–°çš„ä»»åŠ¡ä¼šè¢«åŠ å…¥åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ï¼Ÿ\næ–°çš„ä»»åŠ¡ä¼šè¢«åŠ å…¥åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­çš„æƒ…å†µä¸»è¦å–å†³äºçº¿ç¨‹æ± çš„çŠ¶æ€å’Œé…ç½®ã€‚å…·ä½“æ¥è¯´ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®æƒ…å¢ƒï¼š\næ ¸å¿ƒçº¿ç¨‹æ•°å·²æ»¡ å½“çº¿ç¨‹æ± çš„å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°å·²ç»è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼ˆcorePoolSizeï¼‰æ—¶ï¼Œæ–°çš„ä»»åŠ¡å°†è¢«æ”¾å…¥å·¥ä½œé˜Ÿåˆ—ä¸­ï¼Œè€Œä¸æ˜¯ç«‹å³åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚ çº¿ç¨‹æ± é…ç½® å¦‚æœçº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ï¼ˆmaximumPoolSizeï¼‰æœªè¾¾åˆ°ï¼Œä¸”æ ¸å¿ƒçº¿ç¨‹æ•°å·²æ»¡ï¼Œæ–°ä»»åŠ¡ä¼šè¢«æ·»åŠ åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ã€‚ å·¥ä½œé˜Ÿåˆ—çš„ç±»å‹ä¹Ÿä¼šå½±å“ä»»åŠ¡çš„å¤„ç†æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸åŒç±»å‹çš„é˜Ÿåˆ—ï¼ˆå¦‚ ArrayBlockingQueueã€LinkedBlockingQueueã€SynchronousQueueï¼‰ä¼šå¯¼è‡´ä¸åŒçš„è¡Œä¸ºã€‚ å·¥ä½œé˜Ÿåˆ—å·²æ»¡ å¦‚æœå·¥ä½œé˜Ÿåˆ—æ»¡äº†å¹¶ä¸”å½“å‰çº¿ç¨‹æ•°è¿˜æœªè¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™çº¿ç¨‹æ± ä¼šæ ¹æ®é…ç½®å°è¯•åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚ ä¸€æ—¦çº¿ç¨‹æ± çš„æ´»åŠ¨çº¿ç¨‹æ•°è¾¾åˆ°äº†æœ€å¤§çº¿ç¨‹æ•°ï¼Œä¸”å·¥ä½œé˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼Œæ–°çš„ä»»åŠ¡å°†æ ¹æ®è®¾å®šçš„æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚ ä»‹ç»å¿«é€Ÿæ’åºï¼š\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; using namespace std; // åˆ†åŒºå‡½æ•° int partition(vector\u0026lt;int\u0026gt;\u0026amp; arr, int low, int high) { int pivot = arr[high]; // é€‰æ‹©æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡† int i = low - 1; // å°äºåŸºå‡†çš„å…ƒç´ çš„ç´¢å¼• for (int j = low; j \u0026lt; high; j++) { if (arr[j] \u0026lt; pivot) { i++; swap(arr[i], arr[j]); // äº¤æ¢å…ƒç´  } } swap(arr[i + 1], arr[high]); // å°†åŸºå‡†æ”¾åˆ°æ­£ç¡®çš„ä½ç½® return i + 1; // è¿”å›åŸºå‡†çš„ä½ç½® } // å¿«é€Ÿæ’åºå‡½æ•° void quickSort(vector\u0026lt;int\u0026gt;\u0026amp; arr, int low, int high) { if (low \u0026lt; high) { int pi = partition(arr, low, high); // è·å–åŸºå‡†çš„ç´¢å¼• // é€’å½’æ’åºå·¦åŠéƒ¨åˆ† quickSort(arr, low, pi - 1); // é€’å½’æ’åºå³åŠéƒ¨åˆ† quickSort(arr, pi + 1, high); } } // ä¸»å‡½æ•° int main() { vector\u0026lt;int\u0026gt; arr = {10, 7, 8, 9, 1, 5}; int n = arr.size(); quickSort(arr, 0, n - 1); // è°ƒç”¨å¿«é€Ÿæ’åº cout \u0026lt;\u0026lt; \u0026#34;æ’åºåçš„æ•°ç»„ï¼š\u0026#34;; for (int i : arr) { cout \u0026lt;\u0026lt; i \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; return 0; } 1.å¿«é€Ÿæ’åºä½¿ç”¨çš„æ˜¯åˆ†æ²»é€’å½’çš„æ€æƒ³æ¥è¿›è¡Œæ’åºçš„ï¼Œé¦–å…ˆæ˜¯æ‰¾åˆ°åŸºå‡†å…ƒç´ ï¼Œå°äºåŸºå‡†æ”¾å·¦è¾¹ï¼Œå¤§äºåŸºå‡†æ”¾å³è¾¹ã€‚\n2.å¯¹å·¦å³åŸºå‡†é‡å¤1æ“ä½œï¼Œç›´åˆ°æ‰€æœ‰æ’åºå®Œæˆã€‚\n","date":"15 October 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E5%AE%9E%E9%99%85%E9%9D%A2%E8%AF%95%E8%A2%AB%E9%97%AE%E5%88%B0%E7%9A%84/","section":"ç¬”è®°s","summary":"æ•°å­—é©¬åŠ› #\rè¯´å‡ºè‡ªå·±å®ä¹ ç»å†ä¸­è´Ÿè´£çš„æœ€å‡ºå½©çš„é¡¹ç›®å¹¶ä»‹ç»æƒ…å†µ\nå…«è‚¡æ–‡ï¼š\nListä½¿ç”¨forå¾ªç¯éå†å¢åŠ æˆ–åˆ é™¤å…ƒç´ æ˜¯å¦å¯è¡Œ?\nä¸å¯ä»¥ï¼Œå›æŠ›å‡º(ConcurrentModificationException)\nåŸå› ï¼šremoveå’Œaddæ“ä½œä¼šå¯¼è‡´modCountå’Œè¿­ä»£å™¨ä¸­çš„expectedModCountä¸ä¸€è‡´ã€‚\nè§£é‡Šï¼šæ¶‰åŠåˆ°fail-fastæœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯ä¸€æ—¦æ£€æµ‹åˆ°å¯èƒ½å‘ç”Ÿé”™è¯¯ï¼Œå°±ç«‹é©¬æŠ›å‡ºå¼‚å¸¸ï¼Œç¨‹åºä¸ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œåœ¨Javaä¸­å¯¹é›†åˆçš„æ“ä½œç»å¸¸æ¶‰åŠåˆ°fail-fastæœºåˆ¶ï¼Œ å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿfail-fastäº‹ä»¶\nè§£å†³åŠæ³•ï¼šæ™®é€šforå¾ªç¯ã€ä½¿ç”¨Iteratorè¿›è¡Œå…ƒç´ åˆ é™¤ã€ä½¿ç”¨Streamçš„filterã€ä½¿ç”¨fail-safeçš„ç±»ç­‰ã€‚\næ•°ç»„è½¬æˆé›†åˆï¼š\n//1: List list = new ArrayList\u0026lt;\u0026gt;(Arrays.asList(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;)) //2: Integer [] myArray = { 1, 2, 3 }; List myList = Arrays.","title":"é¢è¯•ç»å†","type":"ç¬”è®°"},{"content":"\rå¦‚ä½•ä½¿ç”¨Hugo+Blowfish? #\ræ–°å»ºæ–‡ç«  #\rä½¿ç”¨å‘½ä»¤æ–°å»ºæ–‡ç« ï¼Œæ–°å»ºæ–‡ç« ç”Ÿæˆåœ¨contentç›®å½•ä¸‹ å°†ä¼šä½¿ç”¨archrtypes/default.mdæ ¼å¼æ·»åŠ æ–°æ–‡ä»¶å¤´éƒ¨é…ç½®é”®ã€‚\nPS D:\\JavaWork\\qvisl9.github.io\u0026gt; hugo new help/index.md Content \u0026#34;D:\\\\JavaWork\\\\qvisl9.github.io\\\\content\\\\help\\\\index.md\u0026#34; created PS D:\\JavaWork\\qvisl9.github.io\u0026gt; åˆ†ç±» #\rblowfishçš„åˆ†ç±»ç›¸å¯¹æ¥è¯´ä¸æ˜¯å¾ˆå®Œå–„æ•ˆæœå¦‚ä¸‹ï¼š\nå®ç°æ–¹å¼å¾ˆç®€å•ï¼Œéœ€åœ¨å¤´éƒ¨é…ç½®é”®ä¸­æ·»åŠ tagsé¡¹\nå°±åƒè¿™æ ·å­ï¼š\nä¸»é¢˜å°†ä¼šè¯†åˆ«é…ç½®é”®å¹¶è‡ªåŠ¨æ£€ç´¢æ‰€æœ‰å¸¦æœ‰æ­¤é¡¹çš„æ–‡ç« ç”Ÿæˆåˆ†ç±»é¡µé¢\nç³»åˆ— #\rblowfishçš„æ˜¯å¸¦æœ‰ç³»åˆ—é…ç½®é¡¹çš„ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š\nç±»ä¼¼ä¸Šè¿°çš„æ“ä½œï¼Œéœ€è¦æ·»åŠ å¤´éƒ¨é…ç½®é¡¹ï¼š\næ³¨æ„ï¼ï¼ï¼è¯·å°†æ–‡ä»¶å‘½åä¸ºindex.mdï¼Œå¦åˆ™åšå®¢ä¸»é¢˜å°†æ— æ³•è‡ªåŠ¨ä¸ºæ–‡ç« è¿›è¡Œåˆ†ç±»å’Œæ·»åŠ ç›¸åº”çš„åŠŸèƒ½\nå›¾æ ‡ #\ræ·»åŠ è‡ªå·±çš„å›¾æ ‡å’Œæ–‡ç« å›¾ç‰‡ï¼Œæ”¾åœ¨assetsç›®å½•ä¸‹ï¼Œiconä½œä¸º å›¾æ ‡æ–‡ä»¶å¤¹ï¼Œæ·»åŠ ç›¸åº”å›¾æ ‡åå¯æ˜¾ç¤ºå¯¹åº”çš„å›¾ç‰‡ï¼Œå¦‚ä¸‹ï¼š\ni18nå›½é™…åŒ– #\rhugo.tomlæ–‡ä»¶ä¸‹ï¼š\ntheme = \u0026#34;blowfish\u0026#34; # UNCOMMENT THIS LINE # baseURL = \u0026#34;https://your_domain.com/\u0026#34; defaultContentLanguage = \u0026#34;zh-CN\u0026#34; æ·»åŠ å¹¶ç¼–è¾‘ç›¸å¯¹äºçš„æ–‡ä»¶ï¼š\næ·»åŠ ç‰¹å®šç¿»è¯‘ï¼š\nä¾‹å¦‚ï¼š\narticle: anchor_label: \u0026#34;é”šç‚¹\u0026#34; date: \u0026#34;{{ .Date }}\u0026#34; date_updated: \u0026#34;Updated: {{ .Date }}\u0026#34; draft: \u0026#34;è‰ç¨¿\u0026#34; edit_title: \u0026#34;ç¼–è¾‘å†…å®¹\u0026#34; reading_time: other: \u0026#34;{{ .Count }} åˆ†é’Ÿ\u0026#34; reading_time_title: \u0026#34;é¢„è®¡é˜…è¯»\u0026#34; # table_of_contents: \u0026#34;Table of Contents\u0026#34; word_count: one: \u0026#34;{{ .Count }} å­—\u0026#34; other: \u0026#34;{{ .Count }} å­—\u0026#34; part_of_series: \u0026#34;è¿™æ˜¯ç³»åˆ—æ–‡ç« ä¹‹ä¸€.\u0026#34; part: \u0026#34;éƒ¨åˆ†\u0026#34; this_article: \u0026#34;æœ¬æ–‡\u0026#34; related_articles: \u0026#34;ç›¸å…³æ–‡ç« \u0026#34; è‡ªå®šä¹‰ #\råœ¨params.tomlæ–‡ä»¶ä¸­ç¼–è¾‘è‡ªå·±çš„é…ç½®é”®å€¼ï¼Œä¸‹é¢ä¸¾ä¸€äº›å¸¸è§ä¾‹å­\nä¾‹å¦‚ä¸‹é¢ä¸¤ç§æ•ˆæœï¼š\nçŸ­ä»£ç  #\rblowfishæ˜¯æ”¯æŒè‡ªå®šä¹‰åŒ–å’Œè‡ªå·±ç¼–å†™çŸ­ä»£ç å®ç°è‡ªå·±çš„æ‰©å±•åŠŸèƒ½çš„ï¼Œä¾‹å¦‚ï¼š\nåœ¨index.mdä¸­ï¼Œæˆ‘æ·»åŠ äº†ä¸€è¡Œæ®µä»£ç ï¼š\n(list limit=1000 title=\u0026#34;å…¨éƒ¨æ–‡ç« \u0026#34;) å…¶å®é™…å¯¹åº”ä¸»é¢˜ä¸­çš„è¿™ä¸ªæ–‡ä»¶ï¼ŒåŠŸèƒ½æ˜¯å°†æ–‡ç« æˆ–è¿™å¯¹åº”çš„ç»™å®šå‚æ•°è¿›è¡Œ æ’åˆ—ï¼Œæ’åˆ—æ ·å¼å–å†³äºå‰é¢æåˆ°çš„params.tomlçš„é…ç½®é”®\nè‡ªå®šä¹‰æ·»åŠ è‡ªå·±çš„çŸ­ä»£ç  #\rä¾‹å¦‚åœ¨è‡ªå·±çš„åšå®¢ç›®å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è‡ªå·±çš„layoutsç›®å½•ï¼Œblowfishå°†ä¼šè¦†ç›–åŸæœ‰çš„layoutsç›®å½• ä¹Ÿå°±æ˜¯ä¼˜å…ˆçº§æ›´é«˜ã€‚\nå°±åƒè¿™æ ·å­ï¼š\nå…¶ä»–å¯è¯„è®º\u0026hellip;.\n","date":"30 April 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/help/","section":"ç¬”è®°s","summary":"å¦‚ä½•ä½¿ç”¨Hugo+Blowfish? #\ræ–°å»ºæ–‡ç«  #\rä½¿ç”¨å‘½ä»¤æ–°å»ºæ–‡ç« ï¼Œæ–°å»ºæ–‡ç« ç”Ÿæˆåœ¨contentç›®å½•ä¸‹ å°†ä¼šä½¿ç”¨archrtypes/default.mdæ ¼å¼æ·»åŠ æ–°æ–‡ä»¶å¤´éƒ¨é…ç½®é”®ã€‚\nPS D:\\JavaWork\\qvisl9.github.io\u0026gt; hugo new help/index.md Content \u0026#34;D:\\\\JavaWork\\\\qvisl9.github.io\\\\content\\\\help\\\\index.md\u0026#34; created PS D:\\JavaWork\\qvisl9.github.io\u0026gt; åˆ†ç±» #\rblowfishçš„åˆ†ç±»ç›¸å¯¹æ¥è¯´ä¸æ˜¯å¾ˆå®Œå–„æ•ˆæœå¦‚ä¸‹ï¼š\nå®ç°æ–¹å¼å¾ˆç®€å•ï¼Œéœ€åœ¨å¤´éƒ¨é…ç½®é”®ä¸­æ·»åŠ tagsé¡¹\nå°±åƒè¿™æ ·å­ï¼š\nä¸»é¢˜å°†ä¼šè¯†åˆ«é…ç½®é”®å¹¶è‡ªåŠ¨æ£€ç´¢æ‰€æœ‰å¸¦æœ‰æ­¤é¡¹çš„æ–‡ç« ç”Ÿæˆåˆ†ç±»é¡µé¢\nç³»åˆ— #\rblowfishçš„æ˜¯å¸¦æœ‰ç³»åˆ—é…ç½®é¡¹çš„ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š\nç±»ä¼¼ä¸Šè¿°çš„æ“ä½œï¼Œéœ€è¦æ·»åŠ å¤´éƒ¨é…ç½®é¡¹ï¼š\næ³¨æ„ï¼ï¼ï¼è¯·å°†æ–‡ä»¶å‘½åä¸ºindex.mdï¼Œå¦åˆ™åšå®¢ä¸»é¢˜å°†æ— æ³•è‡ªåŠ¨ä¸ºæ–‡ç« è¿›è¡Œåˆ†ç±»å’Œæ·»åŠ ç›¸åº”çš„åŠŸèƒ½\nå›¾æ ‡ #\ræ·»åŠ è‡ªå·±çš„å›¾æ ‡å’Œæ–‡ç« å›¾ç‰‡ï¼Œæ”¾åœ¨assetsç›®å½•ä¸‹ï¼Œiconä½œä¸º å›¾æ ‡æ–‡ä»¶å¤¹ï¼Œæ·»åŠ ç›¸åº”å›¾æ ‡åå¯æ˜¾ç¤ºå¯¹åº”çš„å›¾ç‰‡ï¼Œå¦‚ä¸‹ï¼š","title":"Help","type":"ç¬”è®°"},{"content":"","date":"30 April 2024","externalUrl":null,"permalink":"/tags/%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3/","section":"Tags","summary":"","title":"å¸®åŠ©æ–‡æ¡£","type":"tags"},{"content":"","date":"19 March 2024","externalUrl":null,"permalink":"/entire-note/","section":"Entire-Notes","summary":"","title":"Entire-Notes","type":"entire-note"},{"content":"\rç®—æ³•åˆè¾‘\râœˆï¸âœˆï¸å»åˆ°ç®—æ³•ç›®å½•âœˆï¸âœˆï¸\r2024å¹´3æœˆ19æ—¥\rÂ· 12:01\n","date":"19 March 2024","externalUrl":null,"permalink":"/entire-note/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95-%E7%AE%97%E6%B3%95/","section":"Entire-Notes","summary":"ç®—æ³•åˆè¾‘\râœˆï¸âœˆï¸å»åˆ°ç®—æ³•ç›®å½•âœˆï¸âœˆï¸\r2024å¹´3æœˆ19æ—¥\rÂ· 12:01","title":"ä»£ç éšæƒ³å½•ç®—æ³•åˆè¾‘","type":"entire-note"},{"content":"","date":"19 March 2024","externalUrl":null,"permalink":"/tags/%E7%AE%97%E6%B3%95/","section":"Tags","summary":"","title":"ç®—æ³•","type":"tags"},{"content":"\ré“¾è¡¨ ï¼Œé˜Ÿåˆ—å’ŒäºŒå‰æ ‘ #\rå°è¯•ä½¿ç”¨cppå®ç°äºŒå‰æ ‘ï¼Œä¸‹é¢æ˜¯ç²—åŠ£çš„ä»£ç ï¼š #\ræŒ‡é’ˆå’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ«ï¼š\n//å¦‚æœä¼ é€’å¼•ç”¨ï¼š void List_Init(List \u0026amp;list) { // é˜²æ­¢è®¿é—®ç©ºæŒ‡é’ˆ if (list.next != NULL) { list.next = NULL; list.node_count = 0; } } //å¦‚æœä¼ é€’æŒ‡é’ˆï¼š void List_Init(List *list) { // é˜²æ­¢è®¿é—®ç©ºæŒ‡é’ˆ if (list-\u0026gt;next != NULL) { list-\u0026gt;next = NULL; list-\u0026gt;node_count = 0; } } //å¦‚æœä¸æƒ³ç”¨æŒ‡é’ˆï¼Œæƒ³ç”¨å¼•ç”¨ï¼š List \u0026amp;tmp = *list; ä½¿ç”¨ç±»æ¨¡æ¿ï¼š\nç±»æ¨¡æ¿ä½¿ç”¨åªèƒ½ç”¨æ˜¾ç¤ºæŒ‡å®šç±»å‹æ–¹å¼ ç±»æ¨¡æ¿ä¸­çš„æ¨¡æ¿å‚æ•°åˆ—è¡¨å¯ä»¥æœ‰é»˜è®¤å‚æ•°\ntemplate\u0026lt;class NameType\u0026gt; #include \u0026#34;stdio.h\u0026#34; #include \u0026#34;stdlib.h\u0026#34; #include \u0026#34;iostream\u0026#34; using namespace std; // å®šä¹‰ä¸€ä¸ªé“¾è¡¨ typedef struct list { int item; bool isEmpty; // æ˜¯å¦ç©ºé“¾è¡¨ int node_count; // èŠ‚ç‚¹æ•° list *next; // ä¸‹ä¸€èŠ‚ç‚¹ } List; // å®šä¹‰ä¸€ä¸ªäºŒå‰æ ‘ADT typedef struct tree { list node; tree *tree; } Tree; void List_Init(List \u0026amp;list) { // é˜²æ­¢è®¿é—®ç©ºæŒ‡é’ˆ if (list.next != NULL) { list.next = NULL; list.node_count = 0; } } bool List_IsEmpty(List \u0026amp;list) { return list.isEmpty; } bool Add_List_Item(List \u0026amp;list, int \u0026amp;new_item) { if (list.next != NULL) { // åŠ å…¥å…ƒç´  List *tp = (List *)malloc(sizeof(List)); List \u0026amp;tmp = *tp; if (tmp.next != NULL) { // tmp.item = new_item; tmp.next = NULL; tmp.isEmpty = false; tmp.node_count++; list.next = tmp.next; } return true; } return false; } void Travel_List(List \u0026amp;list) { while (list.next != NULL) { cout \u0026lt;\u0026lt; \u0026#34;å…ƒç´ æ˜¯ï¼š\u0026#34; \u0026lt;\u0026lt; list.item \u0026lt;\u0026lt; endl; list = *list.next; } cout \u0026lt;\u0026lt; \u0026#34;å…ƒç´ æ˜¯ï¼š\u0026#34; \u0026lt;\u0026lt; list.item \u0026lt;\u0026lt; endl; } int main(int argc, char const *argv[]) { List *test = (List *)malloc(sizeof(List)); List \u0026amp;res = *test; List_Init(res); int item = 12; for (int i = 0; i \u0026lt; 12; i++) { Add_List_Item(res, item); } while (true) { Travel_List(res); } return 0; } äºŒå‰æ ‘çš„åŸºæœ¬çŸ¥è¯†ï¼š #\rå‚è€ƒæ–‡ç« \næ»¡äºŒå‰æ ‘ï¼š\næ‰€æœ‰å…ƒç´ å…¨éƒ¨å æ»¡ï¼Œå¿…å®šæ˜¯å®Œå…¨äºŒå‰æ ‘ åªæœ‰æœ€ä¸‹å±‚æ‰æœ‰å¶å­èŠ‚ç‚¹ éå¶å­èŠ‚ç‚¹çš„åº¦ä¸º 2 å®Œå…¨äºŒå‰æ ‘ï¼š\nå¶å­ç»“ç‚¹åªèƒ½å‡ºç°åœ¨æœ€ä¸‹ä¸¤å±‚ï¼› æœ€ä¸‹å±‚çš„å¶å­ç»“ç‚¹ä¸€å®šé›†ä¸­åœ¨å·¦è¾¹å¹¶ä¸”è¿ç»­ï¼› è‹¥ç»“ç‚¹åº¦ä¸º1ï¼Œåˆ™è¯¥èŠ‚ç‚¹åªæœ‰å·¦å­èŠ‚ç‚¹ï¼›\néå†äºŒå‰æ ‘ #\râ‘ ã€å‰åºéå†ï¼š\rå®šä¹‰ï¼šå…ˆè®¿é—®æ ¹èŠ‚ç‚¹ï¼Œç„¶åè®¿é—®å·¦å­æ ‘ï¼Œå†è®¿é—®å³å­æ ‘ï¼›\næŒ‰ç…§å®šä¹‰éå†çš„é¡ºåºéå†ç»“æœä¸ºï¼šA B D H I E J C F K G\nâ‘¡ã€ä¸­åºéå†ï¼š\nå®šä¹‰ï¼šå…ˆè®¿é—®å·¦å­æ ‘ï¼Œå†è®¿é—®æ ¹èŠ‚ç‚¹ï¼Œæœ€åè®¿é—®å³å­æ ‘ï¼›\næŒ‰ç…§å®šä¹‰éå†çš„é¡ºåºéå†ç»“æœä¸ºï¼šH D I B E J A F K C G\nâ‘¢ã€ååºéå†ï¼š\nå®šä¹‰ï¼šå…ˆè®¿é—®å·¦å­æ ‘ï¼Œå†è®¿é—®å³å­æ ‘ï¼Œæœ€åè®¿é—®æ ¹èŠ‚ç‚¹ï¼›\næŒ‰ç…§å®šä¹‰éå†çš„é¡ºåºéå†ç»“æœä¸ºï¼šH I D J E B K F G C A\nâ‘£ã€å±‚æ¬¡éå†ï¼š\nå®šä¹‰ï¼šé€å±‚çš„ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ¯å±‚ä»å·¦è‡³å³éå†ï¼›\næŒ‰ç…§å®šä¹‰éå†çš„é¡ºåºéå†ç»“æœä¸ºï¼šA B C D E F G H I J K\nç»å¸¸ä½¿ç”¨çš„åº“ï¼š\n// // Created by Rainy-Heights on 2024/3/19. // #ifndef CARL_CODE_UNION_H #define CARL_CODE_UNION_H #include \u0026lt;iostream\u0026gt; #include \u0026lt;cstdio\u0026gt; #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; using namespace std; //é“¾è¡¨ADT struct ListNode { int val; ListNode *next; ListNode() : val(0), next(nullptr) {} ListNode(int x) : val(x), next(nullptr) {} ListNode(int x, ListNode *next) : val(x), next(next) {} void initNode(ListNode *listNode,int len){ ListNode *head=listNode; int index=0; while (index\u0026lt;len){ head-\u0026gt;next=new ListNode; head-\u0026gt;val=0; head=head-\u0026gt;next; index++; } } }; //æ ‘ADT struct TreeNode { int val; TreeNode *left; TreeNode *right; TreeNode(int x) : val(x), left(NULL), right(NULL) {} }; #endif //CARL_CODE_UNION_H ","date":"18 March 2024","externalUrl":null,"permalink":"/entire-note/%E9%93%BE%E8%A1%A8%E9%98%9F%E5%88%97%E5%92%8C%E6%A0%91/","section":"Entire-Notes","summary":"é“¾è¡¨ ï¼Œé˜Ÿåˆ—å’ŒäºŒå‰æ ‘ #\rå°è¯•ä½¿ç”¨cppå®ç°äºŒå‰æ ‘ï¼Œä¸‹é¢æ˜¯ç²—åŠ£çš„ä»£ç ï¼š #\ræŒ‡é’ˆå’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ«ï¼š\n//å¦‚æœä¼ é€’å¼•ç”¨ï¼š void List_Init(List \u0026amp;list) { // é˜²æ­¢è®¿é—®ç©ºæŒ‡é’ˆ if (list.next != NULL) { list.next = NULL; list.node_count = 0; } } //å¦‚æœä¼ é€’æŒ‡é’ˆï¼š void List_Init(List *list) { // é˜²æ­¢è®¿é—®ç©ºæŒ‡é’ˆ if (list-\u0026gt;next !","title":"æŠ½è±¡æ•°æ®ç±»å‹ADT","type":"entire-note"},{"content":"","date":"18 March 2024","externalUrl":null,"permalink":"/tags/%E8%A6%81%E6%B1%82%E7%86%9F%E8%AE%B0/","section":"Tags","summary":"","title":"è¦æ±‚ç†Ÿè®°","type":"tags"},{"content":"\rRedisè¯¦è§£ #\r1. Redisç®€ä»‹ #\rä½¿ç”¨Cè¯­è¨€å¼€å‘çš„å†…å­˜æ•°æ®åº“ï¼Œè¯»å†™é€Ÿåº¦å¿«ï¼Œå¹¿æ³›ç”¨äºç¼“å­˜æ–¹å‘ å¯ä»¥ç”¨äºåˆ†å¸ƒå¼é”ï¼Œç”šè‡³æ˜¯æ¶ˆæ¯é˜Ÿåˆ— æä¾›å¤šç§æ•°æ®ç±»å‹æ¥æ”¯æŒä¸åŒçš„ä¸šåŠ¡åœºæ™¯ æ”¯æŒäº‹åŠ¡ã€æŒä¹…åŒ–ã€Luaè„šæœ¬ã€å¤šç§é›†ç¾¤æ–¹æ¡ˆ 2. Redis å’Œ Memcached å¯¹æ¯” #\r2.1 ç›¸åŒç‚¹ #\réƒ½åŸºäºå†…å­˜ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨æ¥å½“ç¼“å­˜ä½¿ç”¨ éƒ½æœ‰è¿‡æœŸç­–ç•¥ ä¸¤è€…æ€§èƒ½éƒ½éå¸¸é«˜ 2.2 åŒºåˆ« #\rRedis æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ã€key-valueç±»å‹ã€æä¾›l ist set zset hashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‘ã€æ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ã€‚Memcachedåªæ”¯æŒç®€å•çš„ key-value ç±»å‹ï¼› Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œæœ‰ç¾éš¾æ¢å¤æœºåˆ¶ï¼ŒMemcachedä¸æ”¯æŒï¼› Redisåœ¨æœåŠ¡å™¨å†…å­˜ä¸è¶³æ—¶ï¼Œå¯ä»¥å°†ä¸ç”¨çš„æ•°æ®æ”¾åˆ°ç£ç›˜ä¸Šï¼›Memcachedåˆ™ç›´æ¥æŠ¥å¼‚å¸¸ï¼› RedisåŸç”Ÿæ”¯æŒé›†ç¾¤æ¨¡å¼ï¼ŒMemcachedåŸç”Ÿä¸æ”¯æŒï¼Œéœ€è¦ä¾é å®¢æˆ·ç«¯å®ç°å¾€é›†ç¾¤åˆ†ç‰‡å†™å…¥æ•°æ®ï¼› Memcachedæ˜¯å¤šçº¿ç¨‹çš„éé˜»å¡IOå¤ç”¨çš„ç½‘ç»œæ¨¡å‹ï¼ŒRedisä½¿ç”¨å•çº¿ç¨‹çš„å¤šè·¯IOå¤ç”¨æ¨¡å‹ã€6.0ä»¥åå¼•å…¥äº†å¤šçº¿ç¨‹ã€‘ Redisæ”¯æŒå‘å¸ƒè®¢é˜…æ¨¡å‹ã€Luaè„šæœ¬ã€äº‹åŠ¡ç­‰åŠŸèƒ½ï¼Œè€ŒMemcachedä¸æ”¯æŒã€‚å¹¶ä¸”ï¼ŒRedisæ”¯æŒæ›´å¤šçš„ç¼–ç¨‹è¯­è¨€ Memcachedè¿‡æœŸæ•°æ®åªä½¿ç”¨æƒ°æ€§åˆ é™¤ï¼Œè€ŒRedisåŒæ—¶ä½¿ç”¨æƒ°æ€§åˆ é™¤å’Œå®šæœŸåˆ é™¤ 3. ç¼“å­˜æ•°æ®å¤„ç†æµç¨‹ #\rè‹¥ç”¨æˆ·è¯·æ±‚çš„æ•°æ®åœ¨ç¼“å­˜ä¸­åˆ™ç›´æ¥è¿”å› è‹¥ç¼“å­˜ä¸­ä¸å­˜åœ¨ï¼Œåˆ™æŸ¥è¯¢æ•°æ®åº“ è‹¥æ•°æ®åº“ä¸­å­˜åœ¨ï¼Œåˆ™æ›´æ–°ç¼“å­˜ è‹¥æ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºæ•°æ® 4. ä¸ºä»€ä¹ˆä½¿ç”¨Redis #\r4.1 é«˜æ€§èƒ½è€ƒè™‘ #\rç”¨æˆ·æ¯æ¬¡è¯·æ±‚éƒ½æŸ¥è¯¢æ•°æ®åº“ï¼Œæ¶‰åŠç£ç›˜IOæ“ä½œï¼Œé€Ÿåº¦æ…¢ã€‚ è‹¥æŠŠé«˜é¢‘è®¿é—®ä¸”ä¸ç»å¸¸æ”¹å˜çš„æ•°æ®æ”¾å…¥ç¼“å­˜ï¼Œèƒ½æå¤§æé«˜æŸ¥è¯¢é€Ÿåº¦ã€‚ æ³¨æ„è¦ä¿æŒæ•°æ®åº“å’Œç¼“å­˜ä¸­çš„æ•°æ®çš„ä¸€è‡´æ€§ã€‚å¦‚æœæ•°æ®åº“ä¸­çš„å¯¹åº”æ•°æ®æ”¹å˜ï¼Œéœ€è¦åŒæ­¥æ”¹å˜ç¼“å­˜ä¸­çš„æ•°æ® 4.2 é«˜å¹¶å‘è€ƒè™‘ #\rå¦‚MySQLæ•°æ®åº“çš„QPSå¤§æ¦‚åœ¨1wå·¦å³ã€4æ ¸8Gã€‘ï¼Œä½†æ˜¯ä½¿ç”¨Redisç¼“å­˜ä¹‹åï¼Œå¾ˆå®¹æ˜“èƒ½è¾¾åˆ°10w+ï¼Œç”šè‡³æœ€é«˜èƒ½åˆ°è¾¾30w+ã€å•æœºæƒ…å†µã€‘ æ•…ï¼Œç›´æ¥æ“ä½œç¼“å­˜èƒ½æ‰¿å—æ›´å¤šçš„è¯·æ±‚ï¼Œè¿›è€Œæä¾›ç³»ç»Ÿçš„å¹¶å‘èƒ½åŠ› 5. Rediså¸¸è§æ•°æ®ç»“æ„åŠåº”ç”¨åœºæ™¯ #\r5.1 string #\rstringæ•°æ®ç»“æ„æ˜¯ç®€å•çš„ key-valueç±»å‹ï¼Œæ˜¯Redisè‡ªè¡Œæ„å»ºçš„åŠ¨æ€å­—ç¬¦ä¸²ã€‚å¯ä»¥ä¿å­˜æ–‡æœ¬æ•°æ®ã€äºŒè¿›åˆ¶æ•°æ®ï¼Œè·å–é•¿åº¦çš„å¤æ‚åº¦ä¸ºO(1)ï¼Œä¸ä¼šé€ æˆç¼“å†²åŒºæº¢å‡º å¸¸ç”¨å‘½ä»¤ï¼šset, get, strlen, exists, decr, incr, setex åº”ç”¨åœºæ™¯ï¼šéœ€è¦è®¡æ•°çš„åœºæ™¯ï¼Œå¦‚ç”¨æˆ·è®¿é—®æ¬¡æ•°ã€çƒ­ç‚¹æ–‡ç« çš„ç‚¹èµè½¬å‘æ•°é‡ç­‰ç­‰ 5.1.1 åŸºæœ¬æ“ä½œ #\r127.0.0.1:6379\u0026gt; set key value #è®¾ç½® key-value ç±»å‹çš„å€¼\rOK\r127.0.0.1:6379\u0026gt; get key # æ ¹æ® key è·å¾—å¯¹åº”çš„ value\r\u0026#34;value\u0026#34;\r127.0.0.1:6379\u0026gt; exists key # åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨\r(integer) 1\r127.0.0.1:6379\u0026gt; strlen key # è¿”å› key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚\r(integer) 5\r127.0.0.1:6379\u0026gt; del key # åˆ é™¤æŸä¸ª key å¯¹åº”çš„å€¼\r(integer) 1\r127.0.0.1:6379\u0026gt; get key\r(nil)\r127.0.0.1:6379\u0026gt; mset key1 value1 key2 value2 # æ‰¹é‡è®¾ç½® key-value ç±»å‹çš„å€¼\rOK\r127.0.0.1:6379\u0026gt; mget key1 key2 # æ‰¹é‡è·å–å¤šä¸ª key å¯¹åº”çš„ value\r1) \u0026#34;value1\u0026#34;\r2) \u0026#34;value2\u0026#34; 5.1.2 è®¡æ•°å™¨ #\r127.0.0.1:6379\u0026gt; set number 1\rOK\r127.0.0.1:6379\u0026gt; incr number # å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢ä¸€\r(integer) 2\r127.0.0.1:6379\u0026gt; get number\r\u0026#34;2\u0026#34;\r127.0.0.1:6379\u0026gt; decr number # å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€\r(integer) 1\r127.0.0.1:6379\u0026gt; get number\r\u0026#34;1\u0026#34; 5.1.3 è¿‡æœŸæ—¶é—´è®¾ç½® #\r127.0.0.1:6379\u0026gt; expire key 60 # æ•°æ®åœ¨ 60s åè¿‡æœŸ\r(integer) 1\r127.0.0.1:6379\u0026gt; setex key 60 value # æ•°æ®åœ¨ 60s åè¿‡æœŸ (setex:[set] + [ex]pire)\rOK\r127.0.0.1:6379\u0026gt; ttl key # æŸ¥çœ‹æ•°æ®è¿˜æœ‰å¤šä¹…è¿‡æœŸ\r(integer) 56 5.2 list #\rRedisè‡ªè¡Œå®ç°äº†è‡ªå·±çš„é“¾è¡¨ç»“æ„ï¼Œä¸ºåŒå‘é“¾è¡¨ å¸¸ç”¨å‘½ä»¤ï¼šrpush, lpop, lpush, rpop, lrange, llen åº”ç”¨åœºæ™¯ï¼šå‘å¸ƒè®¢é˜…ã€æ¶ˆæ¯é˜Ÿåˆ—ã€‘ï¼Œæ…¢æŸ¥è¯¢ é€šè¿‡rpush/lpopå®ç°é˜Ÿåˆ— #\r127.0.0.1:6379\u0026gt; rpush myList value1 # å‘ list çš„æœ€å³è¾¹æ·»åŠ å…ƒç´ \r(integer) 1\r127.0.0.1:6379\u0026gt; rpush myList value2 value3 # å‘listçš„æœ€å³è¾¹æ·»åŠ å¤šä¸ªå…ƒç´ \r(integer) 3\r127.0.0.1:6379\u0026gt; lpop myList # å°† listçš„æœ€å·¦è¾¹å…ƒç´ å–å‡º\r\u0026#34;value1\u0026#34;\r127.0.0.1:6379\u0026gt; lrange myList 0 1 # æŸ¥çœ‹å¯¹åº”ä¸‹æ ‡çš„liståˆ—è¡¨ï¼Œ 0 ä¸º start,1ä¸º end\r1) \u0026#34;value2\u0026#34;\r2) \u0026#34;value3\u0026#34;\r127.0.0.1:6379\u0026gt; lrange myList 0 -1 # æŸ¥çœ‹åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œ-1è¡¨ç¤ºå€’æ•°ç¬¬ä¸€\r1) \u0026#34;value2\u0026#34;\r2) \u0026#34;value3\u0026#34;\r127.0.0.1:6379\u0026gt; llen myList # æŸ¥çœ‹é“¾è¡¨é•¿åº¦\r(integer) 2 5.3 hash #\rå†…éƒ¨å®ç°ä¸ºã€æ•°ç»„ + é“¾è¡¨ã€‘ é€‚åˆå­˜å‚¨å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥ä»…ä»…ä¿®æ”¹è¿™ä¸ªå¯¹è±¡ä¸­æŸä¸ªå­—æ®µçš„å€¼ã€‚å¦‚ï¼Œå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€å•†å“ä¿¡æ¯ å¸¸ç”¨å‘½ä»¤ï¼šhset, hmset, hget, hgetall, hkeys, hvals åº”ç”¨åœºæ™¯ï¼šç³»ç»Ÿä¸­å¯¹è±¡æ•°æ®çš„å­˜å‚¨ 127.0.0.1:6379\u0026gt; hmset userInfoKey name \u0026#34;guide\u0026#34; description \u0026#34;dev\u0026#34; age \u0026#34;24\u0026#34;\rOK\r127.0.0.1:6379\u0026gt; hexists userInfoKey name # æŸ¥çœ‹ key å¯¹åº”çš„ valueä¸­æŒ‡å®šçš„å­—æ®µæ˜¯å¦å­˜åœ¨ã€‚\r(integer) 1\r127.0.0.1:6379\u0026gt; hget userInfoKey name # è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ã€‚\r\u0026#34;guide\u0026#34;\r127.0.0.1:6379\u0026gt; hget userInfoKey age\r\u0026#34;24\u0026#34;\r127.0.0.1:6379\u0026gt; hgetall userInfoKey # è·å–åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®š key çš„æ‰€æœ‰å­—æ®µå’Œå€¼\r1) \u0026#34;name\u0026#34;\r2) \u0026#34;guide\u0026#34;\r3) \u0026#34;description\u0026#34;\r4) \u0026#34;dev\u0026#34;\r5) \u0026#34;age\u0026#34;\r6) \u0026#34;24\u0026#34;\r127.0.0.1:6379\u0026gt; hkeys userInfoKey # è·å– key åˆ—è¡¨\r1) \u0026#34;name\u0026#34;\r2) \u0026#34;description\u0026#34;\r3) \u0026#34;age\u0026#34;\r127.0.0.1:6379\u0026gt; hvals userInfoKey # è·å– value åˆ—è¡¨\r1) \u0026#34;guide\u0026#34;\r2) \u0026#34;dev\u0026#34;\r3) \u0026#34;24\u0026#34;\r127.0.0.1:6379\u0026gt; hset userInfoKey name \u0026#34;GuideGeGe\u0026#34; # ä¿®æ”¹æŸä¸ªå­—æ®µå¯¹åº”çš„å€¼\r127.0.0.1:6379\u0026gt; hget userInfoKey name\r\u0026#34;GuideGeGe\u0026#34; 5.4 set #\rå­˜å‚¨æ— é‡å¤å…ƒç´  å®¹æ˜“å®ç°äº¤é›†ã€å¹¶é›†ã€å·®é›†æ“ä½œã€‚å®ç°å¦‚å…±åŒå…³æ³¨ã€å…±åŒç²‰ä¸ã€å…±åŒå–œå¥½ç­‰åŠŸèƒ½ å¸¸ç”¨å‘½ä»¤ï¼šsadd, spop, smembers, sismembers, scard, sinterstore, sunion åº”ç”¨åœºæ™¯ï¼šéœ€è¦å­˜æ”¾çš„æ•°æ®ä¸èƒ½é‡å¤ã€éœ€è¦è·å–å¤šä¸ªæ•°æ®æºäº¤é›†å’Œå¹¶é›†ç­‰åœºæ™¯ 127.0.0.1:6379\u0026gt; sadd mySet value1 value2 # æ·»åŠ å…ƒç´ è¿›å»\r(integer) 2\r127.0.0.1:6379\u0026gt; sadd mySet value1 # ä¸å…è®¸æœ‰é‡å¤å…ƒç´ \r(integer) 0\r127.0.0.1:6379\u0026gt; smembers mySet # æŸ¥çœ‹ set ä¸­æ‰€æœ‰çš„å…ƒç´ \r1) \u0026#34;value1\u0026#34;\r2) \u0026#34;value2\u0026#34;\r127.0.0.1:6379\u0026gt; scard mySet # æŸ¥çœ‹ set çš„é•¿åº¦\r(integer) 2\r127.0.0.1:6379\u0026gt; sismember mySet value1 # æ£€æŸ¥æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨set ä¸­ï¼Œåªèƒ½æ¥æ”¶å•ä¸ªå…ƒç´ \r(integer) 1\r127.0.0.1:6379\u0026gt; sadd mySet2 value2 value3\r(integer) 2\r127.0.0.1:6379\u0026gt; sinterstore mySet3 mySet mySet2 # è·å– mySet å’Œ mySet2 çš„äº¤é›†å¹¶å­˜æ”¾åœ¨ mySet3 ä¸­\r(integer) 1\r127.0.0.1:6379\u0026gt; smembers mySet3\r1) \u0026#34;value2\u0026#34; 5.5 sorted set #\rä»‹ç»ï¼šå’Œ setæ¯”ï¼Œå¢åŠ äº†ä¸€ä¸ªæƒé‡å‚æ•° scoreï¼Œä½¿å¾—é›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰scoreè¿›è¡Œæœ‰åºæ’åºï¼Œä¹Ÿå¯é€šè¿‡scoreçš„èŒƒå›´æ¥è·å–å…ƒç´ çš„åˆ—è¡¨ã€‚ å¸¸ç”¨å‘½ä»¤ï¼šzadd, zcard, zscore, zrange, zreverange, zrem åº”ç”¨åœºæ™¯ï¼šéœ€è¦æ ¹æ®æƒé‡å¯¹æ•°æ®è¿›è¡Œæ’åºçš„åœºæ™¯ã€‚å¦‚ï¼Œç›´æ’­ç³»ç»Ÿä¸­ï¼Œå®æ—¶æ’è¡Œä¿¡æ¯åŒ…å«ç›´æ’­é—´åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ï¼Œå„ç§ç¤¼ç‰©æ’è¡Œæ¦œï¼Œå¼¹å¹•æ¶ˆæ¯ç­‰ä¿¡æ¯ 127.0.0.1:6379\u0026gt; zadd myZset 3.0 value1 # æ·»åŠ å…ƒç´ åˆ° sorted set ä¸­ 3.0 ä¸ºæƒé‡\r(integer) 1\r127.0.0.1:6379\u0026gt; zadd myZset 2.0 value2 1.0 value3 # ä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ \r(integer) 2\r127.0.0.1:6379\u0026gt; zcard myZset # æŸ¥çœ‹ sorted set ä¸­çš„å…ƒç´ æ•°é‡\r(integer) 3\r127.0.0.1:6379\u0026gt; zscore myZset value1 # æŸ¥çœ‹æŸä¸ª value çš„æƒé‡\r\u0026#34;3\u0026#34;\r127.0.0.1:6379\u0026gt; zrange myZset 0 -1 # é¡ºåºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 -1 è¡¨ç¤ºè¾“å‡ºæ‰€æœ‰å…ƒç´ \r1) \u0026#34;value3\u0026#34;\r2) \u0026#34;value2\u0026#34;\r3) \u0026#34;value1\u0026#34;\r127.0.0.1:6379\u0026gt; zrange myZset 0 1 # é¡ºåºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 ä¸º start 1 ä¸º stop\r1) \u0026#34;value3\u0026#34;\r2) \u0026#34;value2\u0026#34;\r127.0.0.1:6379\u0026gt; zrevrange myZset 0 1 # é€†åºè¾“å‡ºæŸä¸ªèŒƒå›´åŒºé—´çš„å…ƒç´ ï¼Œ0 ä¸º start 1 ä¸º stop\r1) \u0026#34;value1\u0026#34;\r2) \u0026#34;value2\u0026#34; 5.6 bitmap #\rä»‹ç»ï¼šbitmapå­˜å‚¨è¿ç»­äºŒè¿›åˆ¶æ•°å­—ã€0å’Œ 1ã€‘ï¼Œä¸€ä¸ªäºŒè¿›åˆ¶ä½å¯¹åº”æŸä¸ªå…ƒç´ çš„å€¼æˆ–è€…çŠ¶æ€ï¼Œkey å¯¹åº”å…ƒç´ æœ¬èº«ã€‚ èƒ½æå¤§èŠ‚çœå­˜å‚¨ç©ºé—´ å¸¸ç”¨å‘½ä»¤ï¼šsetbit, getbit, bitcount, bitop åº”ç”¨åœºæ™¯ï¼šé€‚åˆéœ€è¦ä¿å­˜çŠ¶æ€ä¿¡æ¯å¹¶éœ€è¦è¿›ä¸€æ­¥å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œåˆ†æçš„åœºæ™¯ã€‚å¦‚ï¼Œç”¨æˆ·ç­¾åˆ°ã€æ´»è·ƒç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ã€å¦‚æ˜¯å¦ç‚¹èµè¿‡æŸä¸ªè§†é¢‘ã€‘ # SETBIT ä¼šè¿”å›ä¹‹å‰ä½çš„å€¼ï¼ˆé»˜è®¤æ˜¯ 0ï¼‰è¿™é‡Œä¼šç”Ÿæˆ 7 ä¸ªä½\r127.0.0.1:6379\u0026gt; setbit mykey 7 1\r(integer) 0\r127.0.0.1:6379\u0026gt; setbit mykey 7 0\r(integer) 1\r127.0.0.1:6379\u0026gt; getbit mykey 7\r(integer) 0\r127.0.0.1:6379\u0026gt; setbit mykey 6 1\r(integer) 0\r127.0.0.1:6379\u0026gt; setbit mykey 8 1\r(integer) 0\r# é€šè¿‡ bitcount ç»Ÿè®¡è¢«è¢«è®¾ç½®ä¸º 1 çš„ä½çš„æ•°é‡ã€‚\r127.0.0.1:6379\u0026gt; bitcount mykey\r(integer) 2 5.6.1 ä½¿ç”¨åœºæ™¯ä¸€ #\rç”¨æˆ·è¡Œä¸ºåˆ†æ\n# è®°å½•ä½ å–œæ¬¢è¿‡ 001 å·å°å§å§\r127.0.0.1:6379\u0026gt; setbit beauty_girl_001 uid 1 5.6.2 ä½¿ç”¨åœºæ™¯äºŒ #\rç»Ÿè®¡æ´»è·ƒç”¨æˆ·\n# å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªä¿å­˜äºŒè¿›åˆ¶ä½çš„å­—ç¬¦ä¸² key è¿›è¡Œä½å…ƒæ“ä½œï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ° destkey ä¸Šã€‚\r# BITOP å‘½ä»¤æ”¯æŒ AND ã€ OR ã€ NOT ã€ XOR è¿™å››ç§æ“ä½œä¸­çš„ä»»æ„ä¸€ç§å‚æ•°\rBITOP operation destkey key [key ...] ä½¿ç”¨æ—¶é—´ä½œä¸º keyï¼Œç„¶åç”¨æˆ· ID ä¸º offsetï¼Œå¦‚æœå½“æ—¥æ´»è·ƒè¿‡å°±è®¾ç½®ä¸º 1\nåˆå§‹åŒ–æ•°æ®ï¼š\n127.0.0.1:6379\u0026gt; setbit 20210308 1 1\r(integer) 0\r127.0.0.1:6379\u0026gt; setbit 20210308 2 1\r(integer) 0\r127.0.0.1:6379\u0026gt; setbit 20210309 1 1\r(integer) 0 ç»Ÿè®¡ 20210308~20210309 æ€»æ´»è·ƒç”¨æˆ·æ•°: 1\n127.0.0.1:6379\u0026gt; bitop and desk1 20210308 20210309\r(integer) 1\r127.0.0.1:6379\u0026gt; bitcount desk1\r(integer) 1 ç»Ÿè®¡ 20210308~20210309 åœ¨çº¿æ´»è·ƒç”¨æˆ·æ•°: 2\n127.0.0.1:6379\u0026gt; bitop or desk2 20210308 20210309\r(integer) 1\r127.0.0.1:6379\u0026gt; bitcount desk2\r(integer) 2 5.6.3 ä½¿ç”¨åœºæ™¯ä¸‰\nå¯¹äºè·å–æˆ–è€…ç»Ÿè®¡ç”¨æˆ·åœ¨çº¿çŠ¶æ€ï¼Œä½¿ç”¨ bitmap æ˜¯ä¸€ä¸ªèŠ‚çº¦ç©ºé—´æ•ˆç‡åˆé«˜çš„ä¸€ç§æ–¹æ³•ã€‚\nåªéœ€è¦ä¸€ä¸ª keyï¼Œç„¶åç”¨æˆ· ID ä¸º offsetï¼Œå¦‚æœåœ¨çº¿å°±è®¾ç½®ä¸º 1ï¼Œä¸åœ¨çº¿å°±è®¾ç½®ä¸º 0ã€‚\n6. Rediså•çº¿ç¨‹æ¨¡å‹è¯¦è§£ #\rRedis åŸºäº Reactor æ¨¡å¼æ¥è®¾è®¡å¼€å‘ä¸€å¥—é«˜æ•ˆçš„äº‹ä»¶å¤„ç†æ¨¡å‹ï¼Œè¿™å¥—äº‹ä»¶å¤„ç†æ¨¡å‹å¯¹åº”çš„æ˜¯Redisä¸­çš„æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ã€‚ ç”±äºæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½è¯´Redisæ˜¯å•çº¿ç¨‹æ¨¡å‹ Redisé€šè¿‡IOå¤šè·¯å¤ç”¨ç¨‹åºæ¥ç›‘å¬æ¥è‡ªå®¢æˆ·ç«¯çš„å¤§é‡è¿æ¥ã€ç›‘å¬å¤šä¸ªsocketã€‘ï¼Œå°†ç‰¹å®šçš„äº‹ä»¶åŠç±»å‹ã€è¯»ã€å†™ã€‘æ³¨å†Œåˆ°å†…æ ¸ä¸­å¹¶ç›‘å¬æ¯ä¸ªäº‹ä»¶æ˜¯å¦å‘ç”Ÿ IOå¤šè·¯å¤ç”¨æŠ€æœ¯ä½¿å¾—Redisä¸éœ€è¦é¢å¤–åˆ›å»ºå¤šä½™çš„çº¿ç¨‹æ¥ç›‘å¬å®¢æˆ·ç«¯çš„å¤§é‡è¿æ¥ï¼Œé™ä½èµ„æºçš„æ¶ˆè€— RedisæœåŠ¡å™¨æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ç¨‹åºï¼ŒæœåŠ¡å™¨éœ€è¦å¤„ç†ä¸¤ç±»äº‹ä»¶ï¼šæ–‡ä»¶äº‹ä»¶ å’Œ æ—¶é—´äº‹ä»¶ RedisåŸºäºReactoræ¨¡å¼å¼€å‘äº†è‡ªå·±çš„ç½‘ç»œäº‹ä»¶å¤„ç†å™¨ï¼šè¿™ä¸ªå¤„ç†å™¨è¢«ç§°ä¸ºæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ã€‚è¯¥å¤„ç†å™¨ä½¿ç”¨IOå¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œå¹¶æ ¹æ®å¥—æ¥å­—ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚\nå½“å‰è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”ã€acceptã€‘ã€è¯»å–ã€readã€‘ã€å†™å…¥ã€readã€‘ã€å…³é—­ã€closeã€‘ç­‰æ“ä½œæ—¶ï¼Œè‹¥ä¸æ“ä½œç›¸å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶äº§ç”Ÿï¼Œè¿™æ—¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å°±ä¼šè°ƒç”¨å¥—æ¥å­—ä¹‹å‰å…³è”å¥½çš„äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¿™äº›äº‹ä»¶ã€‚\nè™½ç„¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ä»¥å•çº¿ç¨‹æ–¹å¼è¿è¡Œï¼Œä½†é€šè¿‡ä½¿ç”¨ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ¥ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨æ—¢å®ç°äº†é«˜æ€§èƒ½çš„ç½‘ç»œé€šä¿¡æ¨¡å‹ï¼Œåˆå¯ä»¥å¾ˆå¥½åœ°ä¸ Redis æœåŠ¡å™¨ä¸­å…¶ä»–åŒæ ·ä»¥å•çº¿ç¨‹æ–¹å¼è¿è¡Œçš„æ¨¡å—è¿›è¡Œå¯¹æ¥ï¼Œè¿™ä¿æŒäº† Redis å†…éƒ¨å•çº¿ç¨‹è®¾è®¡çš„ç®€å•æ€§ã€‚\næ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ä¸»è¦åŒ…å«å››éƒ¨åˆ†ï¼š\nå¤šä¸ªsocket IOå¤šè·¯å¤ç”¨ç¨‹åº æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ äº‹ä»¶å¤„ç†å™¨ 7. Redis 6.0 ä¹‹å‰ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¤šçº¿ç¨‹ #\rå®é™…ä¸Šï¼ŒRedis åœ¨ 4.0 ä¹‹åçš„ç‰ˆæœ¬ä¸­å°±å·²ç»åŠ å…¥äº†å¯¹å¤šçº¿ç¨‹çš„æ”¯æŒ ä¸è¿‡ï¼ŒRedis 4.0 å¢åŠ çš„å¤šçº¿ç¨‹ä¸»è¦æ˜¯é’ˆå¯¹ä¸€äº›å¤§é”®å€¼å¯¹çš„åˆ é™¤æ“ä½œçš„å‘½ä»¤ï¼Œä½¿ç”¨è¿™äº›å‘½ä»¤å°±ä¼šä½¿ç”¨ä¸»å¤„ç†ä¹‹å¤–çš„å…¶ä»–çº¿ç¨‹æ¥â€œå¼‚æ­¥å¤„ç†â€ å¤§ä½“ä¸Šæ¥è¯´ï¼ŒRedis 6.0 ä¹‹å‰ä¸»è¦è¿˜æ˜¯å•çº¿ç¨‹å¤„ç† Redis 6.0 ä¹‹å‰ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼š\nå•çº¿ç¨‹ç¼–ç¨‹å®¹æ˜“ä¸”æ˜“äºç»´æŠ¤ Redisçš„æ€§èƒ½ç“¶é¢ˆä¸åœ¨CPUï¼Œä¸»è¦åœ¨å†…å­˜å’Œç½‘ç»œ å¤šçº¿ç¨‹å­˜åœ¨æ­»é”ã€çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ç­‰é—®é¢˜ï¼Œæœ‰å¯èƒ½ä¼šå½±å“æ€§èƒ½ 8. Redis 6.0 ä¹‹åä¸ºä»€ä¹ˆå¼•å…¥å¤šçº¿ç¨‹ #\rä¸ºäº†æé«˜ç½‘ç»œIOè¯»å†™æ€§èƒ½ï¼Œè¿™æ˜¯Redisçš„ä¸€ä¸ªæ€§èƒ½ç“¶é¢ˆä¹‹ä¸€ Redisçš„å¤šçº¿ç¨‹åªæ˜¯åœ¨ç½‘ç»œæ•°æ®çš„è¯»å†™è¿™ä¸€ç±»è€—æ—¶è¾ƒå¤šçš„æ“ä½œä¸Šä½¿ç”¨ï¼Œæ‰§è¡Œå‘½ä»¤æ—¶ä»ç„¶æ˜¯å•çº¿ç¨‹æ‰§è¡Œï¼Œæ•…ä¹Ÿä¸éœ€è¦æ‹…å¿ƒçº¿ç¨‹å®‰å…¨é—®é¢˜ Redis6.0 çš„å¤šçº¿ç¨‹é»˜è®¤æ˜¯ç¦ç”¨çš„ï¼Œåªä½¿ç”¨ä¸»çº¿ç¨‹ã€‚å¦‚éœ€å¼€å¯éœ€è¦ä¿®æ”¹ redis é…ç½®æ–‡ä»¶ redis.conf ï¼š\nio-threads-do-reads yes å¼€å¯å¤šçº¿ç¨‹åï¼Œè¿˜éœ€è¦è®¾ç½®çº¿ç¨‹æ•°ï¼Œå¦åˆ™æ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚åŒæ ·éœ€è¦ä¿®æ”¹ redis é…ç½®æ–‡ä»¶ redis.conf :\nio-threads 4 #å®˜ç½‘å»ºè®®4æ ¸çš„æœºå™¨å»ºè®®è®¾ç½®ä¸º2æˆ–3ä¸ªçº¿ç¨‹ï¼Œ8æ ¸çš„å»ºè®®è®¾ç½®ä¸º6ä¸ªçº¿ç¨‹ 9. Redis è¿‡æœŸæ—¶é—´çš„ä½œç”¨ #\ræœåŠ¡å™¨å†…å­˜æœ‰é™ï¼Œè‹¥ç¼“å­˜çš„æ‰€æœ‰æ•°æ®éƒ½ä¸€ç›´ä¿å­˜ï¼Œæœ€ç»ˆå°†å¯¼è‡´OOM\nRedisè‡ªå¸¦äº†ç»™ç¼“å­˜æ•°æ®è®¾ç½®è¿‡æœŸæ—¶é—´çš„åŠŸèƒ½ï¼š\n127.0.0.1:6379\u0026gt; exp key 60 # æ•°æ®åœ¨ 60s åè¿‡æœŸ\r(integer) 1\r127.0.0.1:6379\u0026gt; setex key 60 value # æ•°æ®åœ¨ 60s åè¿‡æœŸ (setex:[set] + [ex]pire)\rOK\r127.0.0.1:6379\u0026gt; ttl key # æŸ¥çœ‹æ•°æ®è¿˜æœ‰å¤šä¹…è¿‡æœŸ\r(integer) 56 * Redis ä¸­é™¤äº†å­—ç¬¦ä¸²ç±»å‹æœ‰è‡ªå·±ç‹¬æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´çš„å‘½ä»¤ `setex` å¤–ï¼Œå…¶ä»–æ–¹æ³•éƒ½éœ€è¦ä¾é  `expire` å‘½ä»¤æ¥è®¾ç½®è¿‡æœŸæ—¶é—´ ã€‚å¦å¤–ï¼Œ `persist` å‘½ä»¤å¯ä»¥ç§»é™¤ä¸€ä¸ªé”®çš„è¿‡æœŸæ—¶é—´\r* æŸäº›ä¸šåŠ¡åœºæ™¯éœ€è¦æŸä¸ªæ•°æ®åªåœ¨æŸä¸€æ—¶é—´æ®µå†…å­˜åœ¨ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„çŸ­ä¿¡éªŒè¯ç å¯èƒ½åªåœ¨ 1 åˆ†é’Ÿå†…æœ‰æ•ˆï¼Œç”¨æˆ·ç™»å½•çš„ token å¯èƒ½åªåœ¨ 1 å¤©å†…æœ‰æ•ˆ 10. Redis å¦‚ä½•åˆ¤æ–­æ•°æ®æ˜¯å¦è¿‡æœŸ #\rRedisé€šè¿‡ä¸€ä¸ªå«åš è¿‡æœŸå­—å…¸ã€ç›¸å½“äº hash è¡¨ã€‘ çš„ç»“æ„æ¥ä¿å­˜æ•°æ®è¿‡æœŸæ—¶é—´ã€‚ è¿‡æœŸå­—å…¸çš„å»ºæŒ‡å‘Redisæ•°æ®åº“ä¸­çš„æŸä¸ª key è¿‡æœŸå­—å…¸çš„å€¼æ˜¯ä¸€ä¸ª long longç±»å‹çš„æ•´æ•°ï¼Œä¿å­˜äº† key æ‰€æŒ‡å‘çš„æ•°æ®åº“å»ºçš„è¿‡æœŸæ—¶é—´ã€æ¯«ç§’ç²¾åº¦çš„UNIXæ—¶é—´æˆ³ã€‘ è¿‡æœŸå­—å…¸æ˜¯å­˜å‚¨åœ¨ redisDb è¿™ä¸ªç»“æ„é‡Œçš„ï¼š\ntypedef struct redisDb { ... dict *dict; //æ•°æ®åº“é”®ç©ºé—´,ä¿å­˜ç€æ•°æ®åº“ä¸­æ‰€æœ‰é”®å€¼å¯¹ dict *expires // è¿‡æœŸå­—å…¸,ä¿å­˜ç€é”®çš„è¿‡æœŸæ—¶é—´ ... } redisDb; 11. è¿‡æœŸçš„æ•°æ®çš„åˆ é™¤ç­–ç•¥ #\rå¸¸ç”¨çš„è¿‡æœŸæ•°æ®åˆ é™¤ä»ç­–ç•¥ï¼š\næƒ°æ€§åˆ é™¤ï¼šåªä¼šåœ¨å–å‡º key çš„æ—¶å€™æ‰å¯¹æ•°æ®è¿›è¡Œè¿‡æœŸæ£€æŸ¥ã€‚å¯¹ CPU å‹å¥½ï¼Œä½†æ˜¯å¯èƒ½ä¼šé€ æˆè¿‡å¤šçš„è¿‡æœŸæ•°æ®å †ç§¯ å®šæœŸåˆ é™¤ï¼šæ¯éš”ä¸€æ®µæ—¶é—´æŠ½å–ä¸€æ‰¹ key æ‰§è¡Œåˆ é™¤è¿‡æœŸæ•°æ®æ“ä½œã€‚Redisåº•å±‚ä¼šé€šè¿‡é™åˆ¶åˆ é™¤æ“ä½œæ‰§è¡Œçš„æ—¶é•¿å’Œé¢‘ç‡æ¥å‡å°‘å¯¹ CPU çš„å½±å“ å®šæœŸåˆ é™¤å¯¹å†…å­˜å‹å¥½ï¼Œæƒ°æ€§åˆ é™¤å¯¹ CPU å‹å¥½ã€‚Redis é‡‡ç”¨å®šæœŸåˆ é™¤ + æƒ°æ€§åˆ é™¤\n12. å†…å­˜æ·˜æ±°æœºåˆ¶ #\ré‡‡ç”¨ å®šæœŸåˆ é™¤ + æƒ°æ€§åˆ é™¤ ä»æœ‰å¯èƒ½å¯¼è‡´ OOMã€‚è§£å†³ç­–ç•¥æ˜¯ï¼šå†…å­˜æ·˜æ±°æœºåˆ¶\nRedis æä¾› 6 ç§æ•°æ®æ·˜æ±°ç­–ç•¥ï¼š\nvolatile-lruã€least recently usedã€‘ï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®æ·˜æ±° valatile-ttlï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ä¸­æŒ‘é€‰å°†è¦è¿‡æœŸçš„æ•°æ®æ·˜æ±° volatile-randomï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ä¸­ä»»æ„æŒ‘é€‰æ•°æ®æ·˜æ±° allkeys-lruã€least recently usedã€‘ï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨å»ºç©ºé—´ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ key allkeys-randomï¼šä»æ•°æ®é›†ä¸­ä»»æ„é€‰æ‹©æ•°æ®æ·˜æ±° no-evictionï¼šç¦æ­¢é©±é€æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å½“å‰å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œæ–°å†™å…¥æ“ä½œä¼šæŠ¥é”™ã€‚ 4.0 ç‰ˆæœ¬æ–°å¢åŠ ä»¥ä¸‹ä¸¤ç§ï¼š\nvalatile-lfuã€least frequently usedã€‘ï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ä¸­æŒ‘é€‰æœ€ä¸ç»å¸¸ä½¿ç”¨çš„æ•°æ®æ·˜æ±° allkeys-lfuã€least frequently usedã€‘ï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨é”®ç©ºé—´ä¸­ï¼Œç§»é™¤æœ€ä¸ç»å¸¸ä½¿ç”¨çš„ key 13. Redis æŒä¹…åŒ–æœºåˆ¶ #\r13.1 ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ #\rå¿«ç…§æŒä¹…åŒ–ï¼ˆRDBï¼‰å’Œè¿½åŠ æ–‡ä»¶æŒä¹…åŒ–ï¼ˆAOFï¼‰\nRedisæ”¯æŒä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼š\nå¿«ç…§æŒä¹…åŒ–ã€RDBã€‘ åªè¿½åŠ æ–‡ä»¶ã€AOFã€‘ 13.1.1 å¿«ç…§æŒä¹…åŒ– #\rå¿«ç…§æŒä¹…åŒ–ï¼š\nRedis é€šè¿‡åˆ›å»ºå¿«ç…§æ¥è·å¾—å­˜å‚¨åœ¨å†…å­˜é‡Œé¢çš„æ•°æ®åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„å‰¯æœ¬ã€‚ å¿«ç…§åˆ›å»ºåï¼Œå¯ä»¥å¯¹å¿«ç…§è¿›è¡Œå¤‡ä»½ï¼Œå¯ä»¥å°†å¿«ç…§å¤åˆ¶åˆ°å…¶ä»–æœåŠ¡å™¨ä»è€Œåˆ›å»ºå…·æœ‰ç›¸åŒæ•°æ®çš„æœåŠ¡å™¨å‰¯æœ¬ã€Redisä¸»ä»ç»“æ„ï¼Œä¸»è¦ç”¨æ¥æé«˜Redisæ€§èƒ½ã€‘ å¯ä»¥å°†å¿«ç…§ç•™åœ¨åŸåœ°ä»¥ä¾¿é‡å¯æœåŠ¡å™¨çš„æ—¶å€™ä½¿ç”¨ã€‚ å¿«ç…§æŒä¹…åŒ–æ—¶Redis é»˜è®¤é‡‡ç”¨çš„æŒä¹…åŒ–æ–¹å¼ï¼Œåœ¨Redis.confé…ç½®æ–‡ä»¶ä¸­é»˜è®¤æœ‰ä»¥ä¸‹é…ç½®ï¼š\nsave 900 1 #åœ¨900ç§’(15åˆ†é’Ÿ)ä¹‹åï¼Œå¦‚æœè‡³å°‘æœ‰1ä¸ªkeyå‘ç”Ÿå˜åŒ–ï¼ŒRediså°±ä¼šè‡ªåŠ¨è§¦å‘BGSAVEå‘½ä»¤åˆ›å»ºå¿«ç…§ã€‚\rsave 300 10 #åœ¨300ç§’(5åˆ†é’Ÿ)ä¹‹åï¼Œå¦‚æœè‡³å°‘æœ‰10ä¸ªkeyå‘ç”Ÿå˜åŒ–ï¼ŒRediså°±ä¼šè‡ªåŠ¨è§¦å‘BGSAVEå‘½ä»¤åˆ›å»ºå¿«ç…§ã€‚\rsave 60 10000 #åœ¨60ç§’(1åˆ†é’Ÿ)ä¹‹åï¼Œå¦‚æœè‡³å°‘æœ‰10000ä¸ªkeyå‘ç”Ÿå˜åŒ–ï¼ŒRediså°±ä¼šè‡ªåŠ¨è§¦å‘BGSAVEå‘½ä»¤åˆ›å»ºå¿«ç…§ã€‚ 13.1.2 AOFæŒä¹…åŒ– #\rAOFã€append-only fileã€‘æŒä¹…åŒ–\nä¸å¿«ç…§æŒä¹…åŒ–ç›¸æ¯”ï¼ŒAOF æŒä¹…åŒ– çš„å®æ—¶æ€§æ›´å¥½ï¼Œå› æ­¤å·²æˆä¸ºä¸»æµçš„æŒä¹…åŒ–æ–¹æ¡ˆã€‚é»˜è®¤æƒ…å†µä¸‹ Redis æ²¡æœ‰å¼€å¯ AOFï¼ˆappend only fileï¼‰æ–¹å¼çš„æŒä¹…åŒ–ï¼Œå¯ä»¥é€šè¿‡ appendonly å‚æ•°å¼€å¯ï¼š\nappendonly yes å¼€å¯ AOF æŒä¹…åŒ–åæ¯æ‰§è¡Œä¸€æ¡ä¼šæ›´æ”¹ Redis ä¸­çš„æ•°æ®çš„å‘½ä»¤ï¼ŒRedis å°±ä¼šå°†è¯¥å‘½ä»¤å†™å…¥ç¡¬ç›˜ä¸­çš„ AOF æ–‡ä»¶ã€‚AOF æ–‡ä»¶çš„ä¿å­˜ä½ç½®å’Œ RDB æ–‡ä»¶çš„ä½ç½®ç›¸åŒï¼Œéƒ½æ˜¯é€šè¿‡ dir å‚æ•°è®¾ç½®çš„ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯ appendonly.aofã€‚\nåœ¨ Redis çš„é…ç½®æ–‡ä»¶ä¸­å­˜åœ¨ä¸‰ç§ä¸åŒçš„ AOF æŒä¹…åŒ–æ–¹å¼ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š\nappendfsync always #æ¯æ¬¡æœ‰æ•°æ®ä¿®æ”¹å‘ç”Ÿæ—¶éƒ½ä¼šå†™å…¥AOFæ–‡ä»¶,è¿™æ ·ä¼šä¸¥é‡é™ä½Redisçš„é€Ÿåº¦\rappendfsync everysec #æ¯ç§’é’ŸåŒæ­¥ä¸€æ¬¡ï¼Œæ˜¾ç¤ºåœ°å°†å¤šä¸ªå†™å‘½ä»¤åŒæ­¥åˆ°ç¡¬ç›˜\rappendfsync no #è®©æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶è¿›è¡ŒåŒæ­¥ ä¸ºäº†å…¼é¡¾æ•°æ®å’Œå†™å…¥æ€§èƒ½ï¼Œç”¨æˆ·å¯ä»¥è€ƒè™‘ appendfsync everysec é€‰é¡¹ ï¼Œè®© Redis æ¯ç§’åŒæ­¥ä¸€æ¬¡ AOF æ–‡ä»¶ï¼ŒRedis æ€§èƒ½å‡ ä¹æ²¡å—åˆ°ä»»ä½•å½±å“ã€‚è€Œä¸”è¿™æ ·å³ä½¿å‡ºç°ç³»ç»Ÿå´©æºƒï¼Œ ç”¨æˆ·æœ€å¤šåªä¼šä¸¢å¤±ä¸€ç§’ä¹‹å†…äº§ç”Ÿçš„æ•°æ®ã€‚å½“ç¡¬ç›˜å¿™äºæ‰§è¡Œå†™å…¥æ“ä½œçš„æ—¶å€™ï¼ŒRedis è¿˜ä¼šä¼˜é›…çš„æ”¾æ…¢è‡ªå·±çš„é€Ÿåº¦ä»¥ä¾¿é€‚åº”ç¡¬ç›˜çš„æœ€å¤§å†™å…¥é€Ÿåº¦ã€‚\n13.2 Redis 4.0 å¯¹äºæŒä¹…åŒ–æœºåˆ¶çš„ä¼˜åŒ– #\rRedis 4.0 å¼€å§‹æ”¯æŒRDBå’ŒAOFçš„æ··åˆæŒä¹…åŒ–ã€é»˜è®¤å…³é—­ï¼Œå¯ä»¥é€šè¿‡é…ç½®é¡¹ aof-use-rdb-preambleå¼€å¯ã€‘\næ··åˆæŒä¹…åŒ–åœ¨ AOFé‡å†™çš„æ—¶å€™å°±ç›´æ¥æŠŠRDBçš„å†…å®¹å†™åˆ°AOFæ–‡ä»¶å¼€å¤´ã€‚å¥½å¤„æ˜¯å¯ä»¥ç»“åˆRDBå’ŒAOFä¼˜ç‚¹ï¼Œå¿«é€ŸåŠ è½½çš„åŒæ—¶é¿å…ä¸¢å¤±è¿‡å¤šçš„æ•°æ®ã€‚ç¼ºç‚¹ï¼šAOFé‡Œçš„RDBéƒ¨åˆ†æ˜¯å‹ç¼©æ ¼å¼è€Œä¸å†æ˜¯AOFæ ¼å¼ï¼Œå¯è¯»æ€§è¾ƒå·®ã€‚\n13.3 AOFé‡å†™ #\rAOFé‡å†™å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ–°çš„AOFæ–‡ä»¶ï¼Œè¿™ä¸ªæ–°æ–‡ä»¶å’ŒåŸæœ‰AOFæ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®åº“çŠ¶æ€ä¸€æ ·ï¼Œä½†ä½“ç§¯æ›´å° AOFé‡å†™é€šè¿‡è¯»å–æ•°æ®åº“çš„é”®å€¼å¯¹æ¥å®ç°ï¼Œç¨‹åºæ— éœ€å¯¹ç°æœ‰AOFæ–‡ä»¶è¿›è¡Œä»»ä½•è¯»å…¥ã€åˆ†ææˆ–è€…å†™å…¥æ“ä½œ åœ¨æ‰§è¡Œã€€ï¼¢ï¼§ï¼²ï¼¥ï¼·ï¼²ï¼©ï¼´ï¼¥ï¼¡ï¼¯ï¼¦ã€€å‘½ä»¤æ—¶ï¼Œï¼²ï½…ï½„ï½‰ï½“æœåŠ¡å™¨ä¼šç»´æŠ¤ä¸€ä¸ªAOFé‡å†™ç¼“å†²åŒºï¼Œè¯¥ç¼“å†²åŒºä¼šåœ¨å­è¿›ç¨‹åˆ›å»ºæ–°çš„AOFæ–‡ä»¶æœŸé—´ï¼Œè®°å½•æœåŠ¡å™¨æ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ã€‚å½“ç´«ç¦åŸå®Œæˆåˆ›å»ºæ–°AOFæ–‡ä»¶çš„å·¥ä½œä¹‹åï¼ŒæœåŠ¡å™¨ä¼šå°†é‡å†™ç¼“å†²åŒºæ‰€æœ‰å†…å®¹è¿½åŠ åˆ°æ–°çš„AOFæ–‡ä»¶çš„æœ«å°¾ï¼Œä½¿å¾—æ–°æ—§çš„ä¸¤ä¸ªAOFæ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®åº“çŠ¶æ€ä¸€è‡´ã€‚æœ€åï¼ŒæœåŠ¡å™¨ç”¨æ–°çš„AOFæ–‡ä»¶æ›¿æ¢æ—§çš„AOFæ–‡ä»¶ï¼Œä»¥æ­¤æ¥å®ŒæˆAOFæ–‡ä»¶é‡å†™æ“ä½œã€‚ 14.ã€€ï¼²ï½…ï½„ï½‰ï½“äº‹åŠ¡ #\rï¼²ï½…ï½„ï½‰ï½“å¯ä»¥é€šè¿‡MULTI, EXEC, DISCARD, WATCHç­‰å‘½ä»¤æ¥å®ç°äº‹åŠ¡åŠŸèƒ½\n\u0026gt; MULTI\rOK\r\u0026gt; SET USER \u0026#34;å¼ ä¸‰\rQUEUED\r\u0026gt; GET USER\rQUEUED\r\u0026gt; EXEC\r1) OK\r2) \u0026#34;å¼ ä¸‰\u0026#34; ä½¿ç”¨ MULTIå‘½ä»¤åå¯ä»¥è¾“å…¥å¤šä¸ªå‘½ä»¤ã€‚Redisä¸ä¼šç«‹å³æ‰§è¡Œè¿™äº›å‘½ä»¤ã€‚è€Œæ˜¯å°†å®ƒæ”¾åˆ°é˜Ÿåˆ—ï¼Œå½“è°ƒç”¨EXECå‘½ä»¤ï¼Œå°†æ‰§è¡Œé˜Ÿåˆ—ä¸­æ‰€æœ‰å‘½ä»¤ã€‚\nè¿‡ç¨‹å¦‚ä¸‹ï¼š\nå¼€å§‹äº‹åŠ¡ã€MULTIã€‘ å‘½ä»¤å…¥é˜Ÿã€å…ˆè¿›å…ˆå‡ºé¡ºåºæ‰§è¡Œã€‘ æ‰§è¡Œäº‹åŠ¡ã€EXECã€‘ DISCARDå‘½ä»¤å¯ä»¥å–æ¶ˆä¸€ä¸ªäº‹åŠ¡ï¼Œå°†æ¸…ç©ºè¯¥äº‹åŠ¡å¯¹åº”é˜Ÿåˆ—æ‰€ä¿å­˜çš„å‘½ä»¤\n\u0026gt; MULTI\rOK\r\u0026gt; SET USER \u0026#34;å¼ ä¸‰\u0026#34;\rQUEUED\r\u0026gt; GET USER\rQUEUED\r\u0026gt; DISCARD\rOK WATCHå‘½ä»¤ç”¨äºç›‘å¬æŒ‡å®šçš„é”®ï¼Œå½“è°ƒç”¨EXECå‘½ä»¤æ‰§è¡Œäº‹åŠ¡æ—¶ï¼Œå¦‚æœå‘ç°è¢«ç›‘å¬é”®è¢«ä¿®æ”¹æ—¶ï¼Œæ•´ä¸ªäº‹åŠ¡å°†æ‰§è¡Œå¤±è´¥ã€‚\n\u0026gt; WATCH USER\rOK\r\u0026gt; MULTI\r\u0026gt; SET USER \u0026#34;å¼ ä¸‰\u0026#34;\rOK\r\u0026gt; GET USER\rå¼ ä¸‰\r\u0026gt; EXEC\rERR EXEC without MULTI Redis ä¸æ”¯æŒå›æ»šï¼Œä¸æ»¡è¶³ä¸€èˆ¬äº‹åŠ¡å®šä¹‰çš„åŸå­æ€§å’ŒæŒä¹…æ€§\n15. ç¼“å­˜ç©¿é€ #\r15.1 ç®€ä»‹ #\rå¤§é‡è¯·æ±‚çš„ key ä¸å­˜åœ¨ç¼“å­˜ä¸­ï¼Œå¯¼è‡´è¯·æ±‚å…¨éƒ¨è½åœ¨äº†æ•°æ®åº“ä¸Šã€‚\n15.2 è§£å†³æ–¹æ¡ˆ #\r15.2.1 åšå¥½å‚æ•°æ ¡éªŒ #\râ€‹\tä¸€äº›ä¸åˆæ³•çš„å‚æ•°è¯·æ±‚ç›´æ¥æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ¯”å¦‚æŸ¥è¯¢çš„æ•°æ®åº“ id ä¸èƒ½å°äº 0ã€ä¼ å…¥çš„é‚®ç®±æ ¼å¼ä¸å¯¹çš„æ—¶å€™ç›´æ¥è¿”å›é”™è¯¯æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ç­‰ç­‰ã€‚\n15.2.2 ç¼“å­˜æ— æ•ˆçš„ key #\rå¦‚æœç¼“å­˜å’Œæ•°æ®åº“éƒ½æŸ¥ä¸åˆ°æŸä¸ª key çš„æ•°æ®å°±å†™ä¸€ä¸ªåˆ° Redis ä¸­å»å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š SET key value EX 10086 ã€‚è¿™ç§æ–¹å¼å¯ä»¥è§£å†³è¯·æ±‚çš„ key å˜åŒ–ä¸é¢‘ç¹çš„æƒ…å†µï¼Œå¦‚æœé»‘å®¢æ¶æ„æ”»å‡»ï¼Œæ¯æ¬¡æ„å»ºä¸åŒçš„è¯·æ±‚ keyï¼Œä¼šå¯¼è‡´ Redis ä¸­ç¼“å­˜å¤§é‡æ— æ•ˆçš„ key ã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™ç§æ–¹æ¡ˆå¹¶ä¸èƒ½ä»æ ¹æœ¬ä¸Šè§£å†³æ­¤é—®é¢˜ã€‚å¦‚æœéè¦ç”¨è¿™ç§æ–¹å¼æ¥è§£å†³ç©¿é€é—®é¢˜çš„è¯ï¼Œå°½é‡å°†æ— æ•ˆçš„ key çš„è¿‡æœŸæ—¶é—´è®¾ç½®çŸ­ä¸€ç‚¹æ¯”å¦‚ 1 åˆ†é’Ÿã€‚\nä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ key çš„æ ¼å¼ï¼š è¡¨å:åˆ—å:ä¸»é”®å:ä¸»é”®å€¼ ã€‚\n15.2.3 å¸ƒéš†è¿‡æ»¤å™¨ #\r15.2.3.1 ç®€ä»‹ #\rå¯ä»¥æ–¹ä¾¿åœ°åˆ¤æ–­ä¸€ä¸ªç»™å®šçš„æ•°æ®æ˜¯å¦å­˜åœ¨äºæµ·é‡çš„æ•°æ®ä¸­ï¼Œå³åˆ¤æ–­ key æ˜¯å¦åˆæ³•ã€‚ å…·ä½“æ“ä½œï¼šæŠŠæ‰€æœ‰å¯èƒ½å­˜åœ¨çš„è¯·æ±‚å€¼éƒ½å­˜æ”¾åœ¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå½“ç”¨æˆ·è¯·æ±‚è¿‡æ¥æ—¶ï¼Œå…ˆåˆ¤æ–­ç”¨æˆ·å‘æ¥çš„è¯·æ±‚çš„å€¼æ˜¯å¦å­˜åœ¨ä¸å¸ƒéš†è¿‡æ»¤å™¨ã€‚ä¸å­˜åœ¨çš„è¯ï¼Œç›´æ¥è¿”å›è¯·æ±‚å‚æ•°é”™è¯¯ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œå­˜åœ¨çš„è¯æ‰ä¼šæ­£å¸¸æ‰§è¡Œä¸šåŠ¡æµç¨‹ã€‚ å¸ƒéš†è¿‡æ»¤å™¨è®¤ä¸ºæŸå…ƒç´ å­˜åœ¨æ—¶ï¼Œæœ‰å°æ¦‚ç‡ä¼šè¯¯åˆ¤ï¼›ä½†æ˜¯è®¤ä¸ºæŸå…ƒç´ ä¸å­˜åœ¨æ—¶ï¼Œåˆ™è¯¥å…ƒç´ ä¸€å®šä¸å­˜åœ¨ã€‚ 15.2.3.2 å¸ƒéš†è¿‡æ»¤å™¨åŸç† #\rå½“ä¸€ä¸ªå…ƒç´ åŠ å…¥å¸ƒéš†è¿‡æ»¤å™¨æ—¶ï¼š\nä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„å“ˆå¸Œå‡½æ•°å¯¹å…ƒç´ å€¼è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ã€æœ‰å‡ ä¸ªå“ˆå¸Œ å‡½æ•°å°±å¾—åˆ°å‡ ä¸ªå“ˆå¸Œå€¼ã€‘ æ ¹æ®å“ˆå¸Œå€¼ï¼Œåœ¨ä½æ•°ç»„ä¸­æŠŠå¯¹åº”ä¸‹æ ‡çš„å€¼ç½®ä¸º 1 å½“éœ€è¦åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ä¸å¸ƒéš†è¿‡æ»¤å™¨æ—¶ï¼š\nå¯¹ç»™å®šå…ƒç´ å†æ¬¡è¿›è¡Œç›¸åŒçš„å“ˆå¸Œè®¡ç®— å¾—åˆ°å€¼åï¼Œåˆ¤æ–­ä½æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯å¦éƒ½ä¸º 1ï¼Œå¦‚æœå€¼éƒ½ä¸º 1ï¼Œè¯´æ˜è¿™ä¸ªå€¼åœ¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå€¼ä¸ä¸º 1ï¼Œè¯´æ˜è¯¥å…ƒç´ ä¸åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚ è‹¥ä¸åŒçš„å­—ç¬¦ä¸²å“ˆå¸Œå‡ºæ¥çš„ä½ç½®ç›¸åŒï¼Œåˆ™ä¼šé€ æˆå¸ƒéš†è¿‡æ»¤å™¨çš„è¯¯åˆ¤ï¼Œä½†æ˜¯æ¦‚ç‡æ¯”è¾ƒå°ã€‚å¯ä»¥é€‚å½“å¢åŠ ä½æ•°ç»„å¤§å°æˆ–è€…è°ƒæ•´å“ˆå¸Œå‡½æ•°æ¥é™ä½æ¦‚ç‡\n16. ç¼“å­˜é›ªå´© #\r16.1 ç®€ä»‹ #\rç¼“å­˜åœ¨åŒä¸€æ—¶é—´å¤§é¢ç§¯çš„å¤±æ•ˆï¼Œåé¢çš„è¯·æ±‚éƒ½ç›´æ¥è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çŸ­æ—¶é—´å†…æ‰¿å—äº†å¤§é‡çš„è¯·æ±‚ã€‚ ä¾‹å­ï¼šç§’æ€å¼€å§‹ 1 ä¸ªå°æ—¶å‰ï¼Œç»Ÿä¸€å­˜æ”¾äº†ä¸€æ‰¹å•†å“åˆ° Redis ä¸­ï¼Œè®¾ç½®çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ä¹Ÿæ˜¯ 1 ä¸ªå°æ—¶ï¼Œç§’æ€å¼€å§‹æ—¶ï¼Œè¿™äº›ç§’æ€çš„å•†å“çš„è®¿é—®ç›´æ¥å¤±æ•ˆã€‚å¯¼è‡´ç›¸åº”çš„è¯·æ±‚ç›´æ¥å°±è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå°±åƒé›ªå´©ä¸€æ ·å¯æ€•ã€‚ 16.2 è§£å†³æ–¹æ¡ˆ #\r16.2.1 æœåŠ¡å™¨ä¸å¯ç”¨æƒ…å†µ #\ré‡‡ç”¨Redisé›†ç¾¤ï¼Œé¿å…å•æœºå‡ºç°é—®é¢˜å¯¼è‡´æ•´ä¸ªç¼“å­˜æœåŠ¡å™¨æ— æ³•ä½¿ç”¨ é™æµï¼Œé¿å…åŒæ—¶å¤„ç†å¤§é‡çš„è¯·æ±‚ 16.2.2 çƒ­ç‚¹ç¼“å­˜å¤±æ•ˆæƒ…å†µ #\rè®¾ç½®ä¸åŒçš„å¤±æ•ˆæ—¶é—´ï¼Œå¦‚éšæœºè®¾ç½®ç¼“å­˜çš„å¤±æ•ˆæ—¶é—´ ç¼“å­˜æ°¸ä¸å¤±æ•ˆ 17. å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸€è‡´æ€§ #\r17.1 æ•°æ®ä¸ä¸€è‡´æƒ…å†µ #\rè¯»å–ç¼“å­˜æ­¥éª¤ä¸€èˆ¬æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ä¸€æ—¦æ¶‰åŠåˆ°æ•°æ®æ›´æ–°ï¼šæ•°æ®åº“å’Œç¼“å­˜æ›´æ–°ï¼Œå°±å®¹æ˜“å‡ºç°ç¼“å­˜(Redis)å’Œæ•°æ®åº“ï¼ˆMySQLï¼‰é—´çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚ä¸ç®¡æ˜¯å…ˆå†™MySQLæ•°æ®åº“ï¼Œå†åˆ é™¤Redisç¼“å­˜ï¼›è¿˜æ˜¯å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†å†™åº“ï¼Œéƒ½æœ‰å¯èƒ½å‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚\nä¸¾ä¸€ä¸ªä¾‹å­ï¼š 1.å¦‚æœåˆ é™¤äº†ç¼“å­˜Redisï¼Œè¿˜æ²¡æœ‰æ¥å¾—åŠå†™åº“MySQLï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±æ¥è¯»å–ï¼Œå‘ç°ç¼“å­˜ä¸ºç©ºï¼Œåˆ™å»æ•°æ®åº“ä¸­è¯»å–æ•°æ®å†™å…¥ç¼“å­˜ï¼Œæ­¤æ—¶ç¼“å­˜ä¸­ä¸ºè„æ•°æ®ã€‚ 2.å¦‚æœå…ˆå†™äº†åº“ï¼Œåœ¨åˆ é™¤ç¼“å­˜å‰ï¼Œå†™åº“çš„çº¿ç¨‹å®•æœºäº†ï¼Œæ²¡æœ‰åˆ é™¤æ‰ç¼“å­˜ï¼Œåˆ™ä¹Ÿä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´æƒ…å†µã€‚ å› ä¸ºå†™å’Œè¯»æ˜¯å¹¶å‘çš„ï¼Œæ²¡æ³•ä¿è¯é¡ºåº,å°±ä¼šå‡ºç°ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚\n17.2 è§£å†³æ–¹æ¡ˆ #\r17.2.1 é‡‡ç”¨å»¶æ—¶åŒåˆ ç­–ç•¥ #\råœ¨å†™åº“å‰åéƒ½è¿›è¡Œredis.del(key)æ“ä½œï¼Œå¹¶ä¸”è®¾å®šåˆç†çš„è¶…æ—¶æ—¶é—´ã€‚\nä¼ªä»£ç å¦‚ä¸‹ï¼š\npublic void write(String key,Object data){ redis.delKey(key); db.updateData(data); Thread.sleep(500); redis.delKey(key); } å…·ä½“çš„æ­¥éª¤å°±æ˜¯ï¼š\nå…ˆåˆ é™¤ç¼“å­˜ï¼› å†å†™æ•°æ®åº“ï¼› ä¼‘çœ 500æ¯«ç§’ï¼› å†æ¬¡åˆ é™¤ç¼“å­˜ã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ª500æ¯«ç§’æ€ä¹ˆç¡®å®šçš„ï¼Œå…·ä½“è¯¥ä¼‘çœ å¤šä¹…å‘¢ï¼Ÿ\néœ€è¦è¯„ä¼°è‡ªå·±çš„é¡¹ç›®çš„è¯»æ•°æ®ä¸šåŠ¡é€»è¾‘çš„è€—æ—¶ã€‚è¿™ä¹ˆåšçš„ç›®çš„ï¼Œå°±æ˜¯ç¡®ä¿è¯»è¯·æ±‚ç»“æŸï¼Œå†™è¯·æ±‚å¯ä»¥åˆ é™¤è¯»è¯·æ±‚é€ æˆçš„ç¼“å­˜è„æ•°æ®ã€‚\nå½“ç„¶è¿™ç§ç­–ç•¥è¿˜è¦è€ƒè™‘rediså’Œæ•°æ®åº“ä¸»ä»åŒæ­¥çš„è€—æ—¶ã€‚æœ€åçš„çš„å†™æ•°æ®çš„ä¼‘çœ æ—¶é—´ï¼šåˆ™åœ¨è¯»æ•°æ®ä¸šåŠ¡é€»è¾‘çš„è€—æ—¶åŸºç¡€ä¸Šï¼ŒåŠ å‡ ç™¾mså³å¯ã€‚æ¯”å¦‚ï¼šä¼‘çœ 1ç§’ã€‚\nè®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´\nä»ç†è®ºä¸Šæ¥è¯´ï¼Œç»™ç¼“å­˜è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ˜¯ä¿è¯æœ€ç»ˆä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆã€‚æ‰€æœ‰çš„å†™æ“ä½œä»¥æ•°æ®åº“ä¸ºå‡†ï¼Œåªè¦åˆ°è¾¾ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œåˆ™åé¢çš„è¯»è¯·æ±‚è‡ªç„¶ä¼šä»æ•°æ®åº“ä¸­è¯»å–æ–°å€¼ç„¶åå›å¡«ç¼“å­˜ã€‚\nè¯¥æ–¹æ¡ˆçš„å¼Šç«¯\nç»“åˆåŒåˆ ç­–ç•¥+ç¼“å­˜è¶…æ—¶è®¾ç½®ï¼Œè¿™æ ·æœ€å·®çš„æƒ…å†µå°±æ˜¯åœ¨è¶…æ—¶æ—¶é—´å†…æ•°æ®å­˜åœ¨ä¸ä¸€è‡´ï¼Œè€Œä¸”åˆå¢åŠ äº†å†™è¯·æ±‚çš„è€—æ—¶ã€‚\n17.2.2 å¼‚æ­¥æ›´æ–°ç¼“å­˜ã€åŸºäºè®¢é˜…binlogçš„åŒæ­¥æœºåˆ¶ã€‘ #\ræŠ€æœ¯æ•´ä½“æ€è·¯ï¼š\nMySQL binlogå¢é‡è®¢é˜…æ¶ˆè´¹+æ¶ˆæ¯é˜Ÿåˆ—+å¢é‡æ•°æ®æ›´æ–°åˆ°redis\nè¯»Redisï¼šçƒ­æ•°æ®åŸºæœ¬éƒ½åœ¨Redis å†™MySQL:å¢åˆ æ”¹éƒ½æ˜¯æ“ä½œMySQL æ›´æ–°Redisæ•°æ®ï¼šMySQçš„æ•°æ®æ“ä½œbinlogï¼Œæ¥æ›´æ–°åˆ°Redis Redisæ›´æ–°\n1ï¼‰æ•°æ®æ“ä½œä¸»è¦åˆ†ä¸ºä¸¤å¤§å—ï¼š\nä¸€ä¸ªæ˜¯å…¨é‡(å°†å…¨éƒ¨æ•°æ®ä¸€æ¬¡å†™å…¥åˆ°redis) ä¸€ä¸ªæ˜¯å¢é‡ï¼ˆå®æ—¶æ›´æ–°ï¼‰ è¿™é‡Œè¯´çš„æ˜¯å¢é‡,æŒ‡çš„æ˜¯mysqlçš„updateã€insertã€delateå˜æ›´æ•°æ®ã€‚\n2ï¼‰è¯»å–binlogååˆ†æ ï¼Œåˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—,æ¨é€æ›´æ–°å„å°çš„redisç¼“å­˜æ•°æ®ã€‚\nè¿™æ ·ä¸€æ—¦MySQLä¸­äº§ç”Ÿäº†æ–°çš„å†™å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œï¼Œå°±å¯ä»¥æŠŠbinlogç›¸å…³çš„æ¶ˆæ¯æ¨é€è‡³Redisï¼ŒRediså†æ ¹æ®binlogä¸­çš„è®°å½•ï¼Œå¯¹Redisè¿›è¡Œæ›´æ–°ã€‚\nå…¶å®è¿™ç§æœºåˆ¶ï¼Œå¾ˆç±»ä¼¼MySQLçš„ä¸»ä»å¤‡ä»½æœºåˆ¶ï¼Œå› ä¸ºMySQLçš„ä¸»å¤‡ä¹Ÿæ˜¯é€šè¿‡binlogæ¥å®ç°çš„æ•°æ®ä¸€è‡´æ€§ã€‚\nè¿™é‡Œå¯ä»¥ç»“åˆä½¿ç”¨canal(é˜¿é‡Œçš„ä¸€æ¬¾å¼€æºæ¡†æ¶)ï¼Œé€šè¿‡è¯¥æ¡†æ¶å¯ä»¥å¯¹MySQLçš„binlogè¿›è¡Œè®¢é˜…ï¼Œè€Œcanalæ­£æ˜¯æ¨¡ä»¿äº†mysqlçš„slaveæ•°æ®åº“çš„å¤‡ä»½è¯·æ±‚ï¼Œä½¿å¾—Redisçš„æ•°æ®æ›´æ–°è¾¾åˆ°äº†ç›¸åŒçš„æ•ˆæœã€‚\nå½“ç„¶ï¼Œè¿™é‡Œçš„æ¶ˆæ¯æ¨é€å·¥å…·ä½ ä¹Ÿå¯ä»¥é‡‡ç”¨åˆ«çš„ç¬¬ä¸‰æ–¹ï¼škafkaã€rabbitMQç­‰æ¥å®ç°æ¨é€æ›´æ–°Redisã€‚\nè®¤è¯† #\ræœ‰åºé›†åˆå’Œæ™®é€šé›†åˆsetå¾ˆç›¸ä¼¼ï¼Œæ˜¯ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„å­—ç¬¦ä¸²é›†åˆã€‚\næ¯ä¸ªæˆå‘˜éƒ½å…³è”äº†ä¸€ä¸ªè¯„åˆ†ï¼ˆscoreï¼‰ï¼Œè¿™ä¸ªè¯„åˆ†è¢«ç”¨æ¥æŒ‰ç…§æœ€ä½åˆ†åˆ°æœ€é«˜åˆ†çš„æ–¹å¼æ’åºé›†åˆç§çš„æˆå‘˜ã€‚é›†åˆçš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯åˆ†æ•°å¯ä»¥é‡å¤\nåº•å±‚ï¼š #\rRedisæä¾›çš„ä¸€ä¸ªéå¸¸ç‰¹åˆ«çš„æ•°æ®ç»“æ„ï¼Œä¸€æ–¹é¢å®ƒç­‰ä»·äºjavaçš„æ•°æ®ç»“æ„Map\u0026lt;String, double\u0026gt;ï¼Œå¯ä»¥ç»™æ¯ä¸€ä¸ªå…ƒç´ valueèµ‹äºˆä¸€ä¸ªæƒé‡scoreï¼Œ å¦ä¸€æ–¹é¢å®ƒåˆç±»ä¼¼äºTreeSetï¼Œå†…éƒ¨çš„å…ƒç´ ä¼šæŒ‰ç…§æƒé‡è¿›è¡Œæ’åºï¼Œå¯ä»¥å¾—åˆ°æ¯ä¸ªå…ƒç´ çš„åæ¬¡ï¼Œè¿˜å¯ä»¥é€šè¿‡scoreçš„èŒƒå›´æ¥è·å–å…ƒç´ çš„åˆ—è¡¨\nå®ç°ï¼š\nhashï¼›hashçš„ä½œç”¨å°±æ˜¯å…³è”å…ƒç´ valueå’Œæƒé‡scoreï¼Œä¿éšœå…ƒç´ valueçš„å”¯ä¸€æ€§ï¼Œå¯ä»¥é€šè¿‡å…ƒç´ valueæ‰¾åˆ°score è·³è·ƒè¡¨ï¼Œè·³è·ƒè¡¨çš„ç›®çš„åœ¨äºç»™å…ƒç´ valueæ’åºï¼Œæ ¹æ®scoreçš„èŒƒå›´è·å–å…ƒç´ åˆ—è¡¨\nç›¸åŒåˆ†æ•°çš„æ—¶å€™\næœ‰åºé›†åˆé‡Œé¢çš„æˆå‘˜æ˜¯ä¸èƒ½é‡å¤çš„éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯ï¼Œä¸åŒæˆå‘˜é—´æœ‰å¯èƒ½æœ‰ç›¸åŒçš„åˆ†æ•°ã€‚å½“å¤šä¸ªæˆå‘˜æœ‰ç›¸åŒçš„åˆ†æ•°æ—¶ï¼Œä»–ä»¬å°†æ˜¯æœ‰åºçš„å­—å…¸ï¼ˆordered lexicographicallyï¼‰ï¼ˆä»ç”±åˆ†æ•°ä½œä¸ºç¬¬ä¸€æ’åºæ¡ä»¶ï¼Œç„¶åï¼Œç›¸åŒåˆ†æ•°çš„æˆå‘˜æŒ‰ç…§å­—å…¸è§„åˆ™ç›¸å¯¹æ’åºï¼‰ã€‚\nå­—å…¸é¡ºåºæ’åºç”¨çš„æ˜¯äºŒè¿›åˆ¶ï¼Œå®ƒæ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²çš„å­—èŠ‚æ•°ç»„ã€‚\nMysqlç´¢å¼• #\rMySQLç´¢å¼•è¯¦è§£ #\r1. ä»€ä¹ˆæ˜¯ç´¢å¼• #\rç´¢å¼•æ˜¯ä¸€ç§ç”¨äºå¿«é€ŸæŸ¥è¯¢å’Œæ£€ç´¢æ•°æ®çš„æ•°æ®ç»“æ„ã€‚å¸¸è§çš„ç´¢å¼•ç»“æ„æœ‰: B æ ‘ï¼Œ B+æ ‘å’Œ Hash 2. ç´¢å¼•ä¼˜ç¼ºç‚¹ #\rä¼˜ç‚¹ï¼š\nèƒ½æå¤§æé«˜æŸ¥è¯¢æ•ˆç‡ åˆ›å»ºå”¯ä¸€ç´¢å¼•å¯ä»¥ä¿è¯æ•°æ®åº“è¡¨ä¸­æ¯ä¸€è¡Œæ•°æ®çš„å”¯ä¸€æ€§ ç¼ºç‚¹ï¼š\nåˆ›å»ºå’Œç»´æŠ¤ç´¢å¼•æ¯”è¾ƒè€—æ—¶ï¼Œå½“æ•°æ®è¡¨é¢‘ç¹å¢åˆ æ”¹æ—¶ï¼Œå¯¹åº”çš„ç´¢å¼•ä¹Ÿè¦åŠ¨æ€æ”¹å˜ï¼Œä¼šé™ä½SQLæ‰§è¡Œæ•ˆç‡ ç´¢å¼•éœ€è¦ä½¿ç”¨ç‰©ç†æ–‡ä»¶å­˜å‚¨ï¼Œä¼šè€—è´¹ä¸€å®šå­˜å‚¨ç©ºé—´ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç´¢å¼•æŸ¥è¯¢éƒ½æ¯”å…¨è¡¨æ‰«æå¿«ã€‚ä½†æ˜¯æ•°æ®åº“æ•°æ®é‡ä¸å¤§çš„è¯ï¼Œä½¿ç”¨ç´¢å¼•ä¸ä¸€å®šèƒ½æå‡æŸ¥è¯¢æ•ˆç‡\n3. ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„ #\r3.1 MySQLä¸ºä½•ä¸ä½¿ç”¨Hashä½œä¸ºç´¢å¼• #\rHashå­˜åœ¨å“ˆå¸Œå†²çª Hashç´¢å¼•ä¸æ”¯æŒé¡ºåºæŸ¥æ‰¾å’ŒèŒƒå›´æŸ¥æ‰¾ 3.2 Bæ ‘ å’Œ B+æ ‘ #\rB æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æ—¢å­˜æ”¾é”®(key) ä¹Ÿå­˜æ”¾ æ•°æ®(data)ï¼Œè€Œ B+æ ‘åªæœ‰å¶å­èŠ‚ç‚¹å­˜æ”¾ key å’Œ dataï¼Œå…¶ä»–å†…èŠ‚ç‚¹åªå­˜æ”¾ keyã€‚ B æ ‘çš„å¶å­èŠ‚ç‚¹éƒ½æ˜¯ç‹¬ç«‹çš„;B+æ ‘çš„å¶å­èŠ‚ç‚¹æœ‰ä¸€æ¡å¼•ç”¨é“¾æŒ‡å‘ä¸å®ƒç›¸é‚»çš„å¶å­èŠ‚ç‚¹ B æ ‘çš„æ£€ç´¢çš„è¿‡ç¨‹ç›¸å½“äºå¯¹èŒƒå›´å†…çš„æ¯ä¸ªèŠ‚ç‚¹çš„å…³é”®å­—åšäºŒåˆ†æŸ¥æ‰¾ï¼Œå¯èƒ½è¿˜æ²¡æœ‰åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œæ£€ç´¢å°±ç»“æŸäº†ã€‚è€Œ B+æ ‘çš„æ£€ç´¢æ•ˆç‡å°±å¾ˆç¨³å®šäº†ï¼Œä»»ä½•æŸ¥æ‰¾éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œå¶å­èŠ‚ç‚¹çš„é¡ºåºæ£€ç´¢å¾ˆæ˜æ˜¾ åœ¨ MySQL ä¸­ï¼ŒMyISAM å¼•æ“å’Œ InnoDB å¼•æ“éƒ½æ˜¯ä½¿ç”¨ B+Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œä½†æ˜¯ï¼Œä¸¤è€…çš„å®ç°æ–¹å¼ä¸å¤ªä¸€æ ·ã€‚ MyISAM å¼•æ“ä¸­ï¼ŒB+Tree å¶èŠ‚ç‚¹çš„ data åŸŸå­˜æ”¾çš„æ˜¯æ•°æ®è®°å½•çš„åœ°å€ã€‚åœ¨ç´¢å¼•æ£€ç´¢çš„æ—¶å€™ï¼Œé¦–å…ˆæŒ‰ç…§ B+Tree æœç´¢ç®—æ³•æœç´¢ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šçš„ Key å­˜åœ¨ï¼Œåˆ™å–å‡ºå…¶ data åŸŸçš„å€¼ï¼Œç„¶åä»¥ data åŸŸçš„å€¼ä¸ºåœ°å€è¯»å–ç›¸åº”çš„æ•°æ®è®°å½•ã€‚è¿™è¢«ç§°ä¸ºâ€œéèšç°‡ç´¢å¼•â€ã€‚ InnoDB å¼•æ“ä¸­ï¼Œå…¶æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ç´¢å¼•æ–‡ä»¶ã€‚ç›¸æ¯” MyISAMï¼Œç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œå…¶è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰ B+Tree ç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„ï¼Œæ ‘çš„å¶èŠ‚ç‚¹ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ä¸ªç´¢å¼•çš„ key æ˜¯æ•°æ®è¡¨çš„ä¸»é”®ï¼Œå› æ­¤ InnoDB è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸»ç´¢å¼•ã€‚è¿™è¢«ç§°ä¸ºâ€œèšç°‡ç´¢å¼•ï¼ˆæˆ–èšé›†ç´¢å¼•ï¼‰â€ï¼Œè€Œå…¶ä½™çš„ç´¢å¼•éƒ½ä½œä¸ºè¾…åŠ©ç´¢å¼•ï¼Œè¾…åŠ©ç´¢å¼•çš„ data åŸŸå­˜å‚¨ç›¸åº”è®°å½•ä¸»é”®çš„å€¼è€Œä¸æ˜¯åœ°å€ï¼Œè¿™ä¹Ÿæ˜¯å’Œ MyISAM ä¸åŒçš„åœ°æ–¹ã€‚åœ¨æ ¹æ®ä¸»ç´¢å¼•æœç´¢æ—¶ï¼Œç›´æ¥æ‰¾åˆ° key æ‰€åœ¨çš„èŠ‚ç‚¹å³å¯å–å‡ºæ•°æ®ï¼›åœ¨æ ¹æ®è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾æ—¶ï¼Œåˆ™éœ€è¦å…ˆå–å‡ºä¸»é”®çš„å€¼ï¼Œåœ¨èµ°ä¸€éä¸»ç´¢å¼•ã€å›è¡¨ã€‘ã€‚ å› æ­¤ï¼Œåœ¨è®¾è®¡è¡¨çš„æ—¶å€™ï¼Œä¸å»ºè®®ä½¿ç”¨è¿‡é•¿çš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œä¹Ÿä¸å»ºè®®ä½¿ç”¨éå•è°ƒçš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™æ ·ä¼šé€ æˆä¸»ç´¢å¼•é¢‘ç¹åˆ†è£‚ã€‚ 4. ç´¢å¼•ç±»å‹ #\r4.1 ä¸»é”®ç´¢å¼• #\ræ•°æ®è¡¨çš„ä¸»é”®åˆ—ä½¿ç”¨çš„å°±æ˜¯ä¸»é”®ç´¢å¼• ä¸€å¼ æ•°æ®è¡¨æœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œå¹¶ä¸”ä¸»é”®ä¸èƒ½ä¸º nullï¼Œä¸èƒ½é‡å¤ åœ¨ MySQL çš„ InnoDB çš„è¡¨ä¸­ï¼Œå½“æ²¡æœ‰æ˜¾ç¤ºçš„æŒ‡å®šè¡¨çš„ä¸»é”®æ—¶ï¼ŒInnoDB ä¼šè‡ªåŠ¨å…ˆæ£€æŸ¥è¡¨ä¸­æ˜¯å¦æœ‰å”¯ä¸€ç´¢å¼•çš„å­—æ®µï¼Œå¦‚æœæœ‰ï¼Œåˆ™é€‰æ‹©è¯¥å­—æ®µä¸ºé»˜è®¤çš„ä¸»é”®ï¼Œå¦åˆ™ InnoDB å°†ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª 6Byte çš„è‡ªå¢ä¸»é”®ã€‚ 4.2 è¾…åŠ©ç´¢å¼• #\räºŒçº§ç´¢å¼•åˆç§°ä¸ºè¾…åŠ©ç´¢å¼•ï¼Œæ˜¯å› ä¸ºäºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ•°æ®æ˜¯ä¸»é”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡äºŒçº§ç´¢å¼•ï¼Œå¯ä»¥å®šä½ä¸»é”®çš„ä½ç½®ã€‚ å”¯ä¸€ç´¢å¼•ï¼Œæ™®é€šç´¢å¼•ï¼Œå‰ç¼€ç´¢å¼•ç­‰ç´¢å¼•å±äºäºŒçº§ç´¢å¼• \u0026gt; * å”¯ä¸€ç´¢å¼•(Unique Key) ï¼šå”¯ä¸€ç´¢å¼•ä¹Ÿæ˜¯ä¸€ç§çº¦æŸã€‚å”¯ä¸€ç´¢å¼•çš„å±æ€§åˆ—ä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ®ï¼Œä½†æ˜¯å…è®¸æ•°æ®ä¸º NULLï¼Œä¸€å¼ è¡¨å…è®¸åˆ›å»ºå¤šä¸ªå”¯ä¸€ç´¢å¼•ã€‚ å»ºç«‹å”¯ä¸€ç´¢å¼•çš„ç›®çš„å¤§éƒ¨åˆ†æ—¶å€™éƒ½æ˜¯ä¸ºäº†è¯¥å±æ€§åˆ—çš„æ•°æ®çš„å”¯ä¸€æ€§ï¼Œè€Œä¸æ˜¯ä¸ºäº†æŸ¥è¯¢æ•ˆç‡ æ™®é€šç´¢å¼•(Index) ï¼šæ™®é€šç´¢å¼•çš„å”¯ä¸€ä½œç”¨å°±æ˜¯ä¸ºäº†å¿«é€ŸæŸ¥è¯¢æ•°æ®ï¼Œä¸€å¼ è¡¨å…è®¸åˆ›å»ºå¤šä¸ªæ™®é€šç´¢å¼•ï¼Œå¹¶å…è®¸æ•°æ®é‡å¤å’Œ NULL å‰ç¼€ç´¢å¼•(Prefix) ï¼šå‰ç¼€ç´¢å¼•åªé€‚ç”¨äºå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ã€‚å‰ç¼€ç´¢å¼•æ˜¯å¯¹æ–‡æœ¬çš„å‰å‡ ä¸ªå­—ç¬¦åˆ›å»ºç´¢å¼•ï¼Œç›¸æ¯”æ™®é€šç´¢å¼•å»ºç«‹çš„æ•°æ®æ›´å°ï¼Œ å› ä¸ºåªå–å‰å‡ ä¸ªå­—ç¬¦ å…¨æ–‡ç´¢å¼•(Full Text) ï¼šå…¨æ–‡ç´¢å¼•ä¸»è¦æ˜¯ä¸ºäº†æ£€ç´¢å¤§æ–‡æœ¬æ•°æ®ä¸­çš„å…³é”®å­—çš„ä¿¡æ¯ï¼Œæ˜¯ç›®å‰æœç´¢å¼•æ“æ•°æ®åº“ä½¿ç”¨çš„ä¸€ç§æŠ€æœ¯ã€‚Mysql5.6 ä¹‹å‰åªæœ‰ MYISAM å¼•æ“æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œ5.6 ä¹‹å InnoDB ä¹Ÿæ”¯æŒäº†å…¨æ–‡ç´¢å¼• 5. èšé›†ç´¢å¼•å’Œéèšé›†ç´¢å¼• #\r5.1 èšé›†ç´¢å¼• #\rç´¢å¼•ç»“æ„å’Œæ•°æ®ä¸€èµ·å­˜æ”¾çš„ç´¢å¼•ã€‚ä¸»é”®ç´¢å¼•å±äºèšé›†ç´¢å¼• åœ¨ Mysql ä¸­ï¼ŒInnoDB å¼•æ“çš„è¡¨çš„ .ibdæ–‡ä»¶å°±åŒ…å«äº†è¯¥è¡¨çš„ç´¢å¼•å’Œæ•°æ®ï¼Œå¯¹äº InnoDB å¼•æ“è¡¨æ¥è¯´ï¼Œè¯¥è¡¨çš„ç´¢å¼•(B+æ ‘)çš„æ¯ä¸ªéå¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•å’Œç´¢å¼•å¯¹åº”çš„æ•°æ® ä¼˜ç‚¹ï¼šèšé›†ç´¢å¼•çš„æŸ¥è¯¢é€Ÿåº¦éå¸¸çš„å¿«ï¼Œå› ä¸ºæ•´ä¸ª B+æ ‘æœ¬èº«å°±æ˜¯ä¸€é¢—å¤šå‰å¹³è¡¡æ ‘ï¼Œå¶å­èŠ‚ç‚¹ä¹Ÿéƒ½æ˜¯æœ‰åºçš„ï¼Œå®šä½åˆ°ç´¢å¼•çš„èŠ‚ç‚¹ï¼Œå°±ç›¸å½“äºå®šä½åˆ°äº†æ•°æ®ã€‚ ç¼ºç‚¹ï¼š \u0026gt; * ä¾èµ–äºæœ‰åºçš„æ•°æ® ï¼Œå› ä¸º B+æ ‘æ˜¯å¤šè·¯å¹³è¡¡æ ‘ï¼Œå¦‚æœç´¢å¼•çš„æ•°æ®ä¸æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨æ’å…¥æ—¶æ’åºï¼Œæ•´å‹æ•°æ®è¿˜å¥½ï¼Œè‹¥ç±»ä¼¼äºå­—ç¬¦ä¸²æˆ– UUID è¿™ç§åˆé•¿åˆéš¾æ¯”è¾ƒçš„æ•°æ®ï¼Œä¼šé€ æˆä¸»ç´¢å¼•é¢‘ç¹åˆ†è£‚ï¼Œæ’å…¥æˆ–æŸ¥æ‰¾çš„é€Ÿåº¦è‚¯å®šæ¯”è¾ƒæ…¢ æ›´æ–°ä»£ä»·å¤§ï¼Œå¦‚æœå¯¹ç´¢å¼•åˆ—çš„æ•°æ®è¢«ä¿®æ”¹æ—¶ï¼Œé‚£ä¹ˆå¯¹åº”çš„ç´¢å¼•ä¹Ÿå°†ä¼šè¢«ä¿®æ”¹ï¼Œ è€Œä¸”èšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹è¿˜å­˜æ”¾ç€æ•°æ®ï¼Œä¿®æ”¹ä»£ä»·è‚¯å®šæ˜¯è¾ƒå¤§çš„ï¼Œ æ‰€ä»¥å¯¹äºä¸»é”®ç´¢å¼•æ¥è¯´ï¼Œä¸»é”®ä¸€èˆ¬éƒ½æ˜¯ä¸å¯è¢«ä¿®æ”¹çš„ 5.2 éèšé›†ç´¢å¼• #\rå³ç´¢å¼•ç»“æ„å’Œæ•°æ®åˆ†å¼€å­˜æ”¾çš„ç´¢å¼• äºŒçº§ç´¢å¼•å±äºéèšé›†ç´¢å¼• MYISAM å¼•æ“çš„è¡¨çš„.MYI æ–‡ä»¶åŒ…å«äº†è¡¨çš„ç´¢å¼•ï¼Œ è¯¥è¡¨çš„ç´¢å¼•(B+æ ‘)çš„æ¯ä¸ªå¶å­éå¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•ï¼Œ å¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•å’Œç´¢å¼•å¯¹åº”æ•°æ®çš„æŒ‡é’ˆï¼ŒæŒ‡å‘.MYD æ–‡ä»¶çš„æ•°æ®ã€‚ éèšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å¹¶ä¸ä¸€å®šå­˜æ”¾æ•°æ®çš„æŒ‡é’ˆï¼Œ å› ä¸ºäºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±å­˜æ”¾çš„æ˜¯ä¸»é”®ï¼Œæ ¹æ®ä¸»é”®å†å›è¡¨æŸ¥æ•°æ®ã€‚ ä¼˜ç‚¹ï¼šæ›´æ–°ä»£ä»·æ¯”èšé›†ç´¢å¼•è¦å° ã€‚éèšé›†ç´¢å¼•çš„æ›´æ–°ä»£ä»·å°±æ²¡æœ‰èšé›†ç´¢å¼•é‚£ä¹ˆå¤§äº†ï¼Œéèšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹æ˜¯ä¸å­˜æ”¾æ•°æ®çš„ ç¼ºç‚¹ï¼š \u0026gt; * éèšé›†ç´¢å¼•ä¹Ÿä¾èµ–äºæœ‰åºçš„æ•°æ® å¯èƒ½ä¼šäºŒæ¬¡æŸ¥è¯¢(å›è¡¨) : å½“æŸ¥åˆ°ç´¢å¼•å¯¹åº”çš„æŒ‡é’ˆæˆ–ä¸»é”®åï¼Œå¯èƒ½è¿˜éœ€è¦æ ¹æ®æŒ‡é’ˆæˆ–ä¸»é”®å†åˆ°æ•°æ®æ–‡ä»¶æˆ–è¡¨ä¸­æŸ¥è¯¢ã€‚ 6. è¦†ç›–ç´¢å¼• #\rä¸€ä¸ªç´¢å¼•åŒ…å«ï¼ˆæˆ–è€…è¯´è¦†ç›–ï¼‰æ‰€æœ‰éœ€è¦æŸ¥è¯¢çš„å­—æ®µçš„å€¼ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºâ€œè¦†ç›–ç´¢å¼•â€ åœ¨ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œå¦‚æœä¸æ˜¯ä¸»é”®ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®+åˆ—å€¼ã€‚æœ€ç»ˆè¿˜æ˜¯è¦â€œå›è¡¨â€ï¼Œä¹Ÿå°±æ˜¯è¦é€šè¿‡ä¸»é”®å†æŸ¥æ‰¾ä¸€æ¬¡ã€‚è¿™æ ·å°±ä¼šæ¯”è¾ƒæ…¢ è¦†ç›–ç´¢å¼•å°±æ˜¯æŠŠè¦æŸ¥è¯¢å‡ºçš„åˆ—å’Œç´¢å¼•æ˜¯å¯¹åº”çš„ï¼Œä¸åšå›è¡¨æ“ä½œ 7. åˆ›å»ºç´¢å¼•æ³¨æ„äº‹é¡¹ #\ré€‰æ‹©åˆé€‚çš„å­—æ®µåˆ›å»ºç´¢å¼•ï¼š \u0026gt; * ä¸ä¸º NULL çš„å­—æ®µ ï¼šç´¢å¼•å­—æ®µçš„æ•°æ®åº”è¯¥å°½é‡ä¸ä¸º NULLï¼Œå› ä¸ºå¯¹äºæ•°æ®ä¸º NULL çš„å­—æ®µï¼Œæ•°æ®åº“è¾ƒéš¾ä¼˜åŒ–ã€‚å¦‚æœå­—æ®µé¢‘ç¹è¢«æŸ¥è¯¢ï¼Œä½†åˆé¿å…ä¸äº†ä¸º NULLï¼Œå»ºè®®ä½¿ç”¨ 0,1,true,false è¿™æ ·è¯­ä¹‰è¾ƒä¸ºæ¸…æ™°çš„çŸ­å€¼æˆ–çŸ­å­—ç¬¦ä½œä¸ºæ›¿ä»£ã€‚ è¢«é¢‘ç¹æŸ¥è¯¢çš„å­—æ®µ ï¼šæˆ‘ä»¬åˆ›å»ºç´¢å¼•çš„å­—æ®µåº”è¯¥æ˜¯æŸ¥è¯¢æ“ä½œéå¸¸é¢‘ç¹çš„å­—æ®µã€‚ è¢«ä½œä¸ºæ¡ä»¶æŸ¥è¯¢çš„å­—æ®µ ï¼šè¢«ä½œä¸º WHERE æ¡ä»¶æŸ¥è¯¢çš„å­—æ®µï¼Œåº”è¯¥è¢«è€ƒè™‘å»ºç«‹ç´¢å¼•ã€‚ é¢‘ç¹éœ€è¦æ’åºçš„å­—æ®µ ï¼šç´¢å¼•å·²ç»æ’åºï¼Œè¿™æ ·æŸ¥è¯¢å¯ä»¥åˆ©ç”¨ç´¢å¼•çš„æ’åºï¼ŒåŠ å¿«æ’åºæŸ¥è¯¢æ—¶é—´ã€‚ è¢«ç»å¸¸é¢‘ç¹ç”¨äºè¿æ¥çš„å­—æ®µ ï¼šç»å¸¸ç”¨äºè¿æ¥çš„å­—æ®µå¯èƒ½æ˜¯ä¸€äº›å¤–é”®åˆ—ï¼Œå¯¹äºå¤–é”®åˆ—å¹¶ä¸ä¸€å®šè¦å»ºç«‹å¤–é”®ï¼Œåªæ˜¯è¯´è¯¥åˆ—æ¶‰åŠåˆ°è¡¨ä¸è¡¨çš„å…³ç³»ã€‚å¯¹äºé¢‘ç¹è¢«è¿æ¥æŸ¥è¯¢çš„å­—æ®µï¼Œå¯ä»¥è€ƒè™‘å»ºç«‹ç´¢å¼•ï¼Œæé«˜å¤šè¡¨è¿æ¥æŸ¥è¯¢çš„æ•ˆç‡ã€‚ è¢«é¢‘ç¹æ›´æ–°çš„å­—æ®µåº”è¯¥æ…é‡å»ºç«‹ç´¢å¼•ã€‚ å°½å¯èƒ½çš„è€ƒè™‘å»ºç«‹è”åˆç´¢å¼•è€Œä¸æ˜¯å•åˆ—ç´¢å¼•ã€‚å› ä¸ºç´¢å¼•æ˜¯éœ€è¦å ç”¨ç£ç›˜ç©ºé—´çš„ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºæ¯ä¸ªç´¢å¼•éƒ½å¯¹åº”ç€ä¸€é¢— B+æ ‘ã€‚å¦‚æœä¸€ä¸ªè¡¨çš„å­—æ®µè¿‡å¤šï¼Œç´¢å¼•è¿‡å¤šï¼Œé‚£ä¹ˆå½“è¿™ä¸ªè¡¨çš„æ•°æ®è¾¾åˆ°ä¸€ä¸ªä½“é‡åï¼Œç´¢å¼•å ç”¨çš„ç©ºé—´ä¹Ÿæ˜¯å¾ˆå¤šçš„ï¼Œä¸”ä¿®æ”¹ç´¢å¼•æ—¶ï¼Œè€—è´¹çš„æ—¶é—´ä¹Ÿæ˜¯è¾ƒå¤šçš„ã€‚å¦‚æœæ˜¯è”åˆç´¢å¼•ï¼Œå¤šä¸ªå­—æ®µåœ¨ä¸€ä¸ªç´¢å¼•ä¸Šï¼Œé‚£ä¹ˆå°†ä¼šèŠ‚çº¦å¾ˆå¤§ç£ç›˜ç©ºé—´ï¼Œä¸”ä¿®æ”¹æ•°æ®çš„æ“ä½œæ•ˆç‡ä¹Ÿä¼šæå‡ æ³¨æ„é¿å…å†—ä½™ç´¢å¼•ã€‚å†—ä½™ç´¢å¼•æŒ‡çš„æ˜¯ç´¢å¼•çš„åŠŸèƒ½ç›¸åŒï¼Œèƒ½å¤Ÿå‘½ä¸­ç´¢å¼•(a, b)å°±è‚¯å®šèƒ½å‘½ä¸­ç´¢å¼•(a) ï¼Œé‚£ä¹ˆç´¢å¼•(a)å°±æ˜¯å†—ä½™ç´¢å¼•ã€‚å¦‚ï¼ˆname,city ï¼‰å’Œï¼ˆname ï¼‰è¿™ä¸¤ä¸ªç´¢å¼•å°±æ˜¯å†—ä½™ç´¢å¼•ï¼Œèƒ½å¤Ÿå‘½ä¸­å‰è€…çš„æŸ¥è¯¢è‚¯å®šæ˜¯èƒ½å¤Ÿå‘½ä¸­åè€…çš„ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéƒ½åº”è¯¥å°½é‡æ‰©å±•å·²æœ‰çš„ç´¢å¼•è€Œä¸æ˜¯åˆ›å»ºæ–°ç´¢å¼• è€ƒè™‘åœ¨å­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µä¸Šä½¿ç”¨å‰ç¼€ç´¢å¼•ä»£æ›¿æ™®é€šç´¢å¼•ã€‚å‰ç¼€ç´¢å¼•ä»…é™äºå­—ç¬¦ä¸²ç±»å‹ï¼Œè¾ƒæ™®é€šç´¢å¼•ä¼šå ç”¨æ›´å°çš„ç©ºé—´ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ä½¿ç”¨å‰ç¼€ç´¢å¼•å¸¦æ›¿æ™®é€šç´¢å¼• 8. ä½¿ç”¨ç´¢å¼•çš„æ³¨æ„äº‹é¡¹ #\rå¯¹äºä¸­åˆ°å¤§å‹è¡¨ç´¢å¼•éƒ½æ˜¯éå¸¸æœ‰æ•ˆçš„ï¼Œä½†æ˜¯ç‰¹å¤§å‹è¡¨çš„è¯ç»´æŠ¤å¼€é”€ä¼šå¾ˆå¤§ï¼Œä¸é€‚åˆå»ºç´¢å¼• é¿å… where å­å¥ä¸­å¯¹å­—æ®µæ–½åŠ å‡½æ•°ï¼Œè¿™ä¼šé€ æˆæ— æ³•å‘½ä¸­ç´¢å¼• åœ¨ä½¿ç”¨ InnoDB æ—¶ä½¿ç”¨ä¸ä¸šåŠ¡æ— å…³çš„è‡ªå¢ä¸»é”®ä½œä¸ºä¸»é”®ï¼Œå³ä½¿ç”¨é€»è¾‘ä¸»é”®ï¼Œè€Œä¸è¦ä½¿ç”¨ä¸šåŠ¡ä¸»é”® åˆ é™¤é•¿æœŸæœªä½¿ç”¨çš„ç´¢å¼•ï¼Œä¸ç”¨çš„ç´¢å¼•çš„å­˜åœ¨ä¼šé€ æˆä¸å¿…è¦çš„æ€§èƒ½æŸè€— MySQL 5.7 å¯ä»¥é€šè¿‡æŸ¥è¯¢ sys åº“çš„ schema_unused_indexes è§†å›¾æ¥æŸ¥è¯¢å“ªäº›ç´¢å¼•ä»æœªè¢«ä½¿ç”¨ åœ¨ä½¿ç”¨ limit offset æŸ¥è¯¢ç¼“æ…¢æ—¶ï¼Œå¯ä»¥å€ŸåŠ©ç´¢å¼•æ¥æé«˜æ€§èƒ½ 9. MySQLå¦‚ä½•ä¸ºè¡¨å­—æ®µæ·»åŠ ç´¢å¼• #\ræ·»åŠ ä¸»é”®ç´¢å¼• alter table table_name add primary key(column) æ·»åŠ å”¯ä¸€ç´¢å¼• alter table table_name add unique(column) æ·»åŠ æ™®é€šç´¢å¼• alter table table_name add index index_name(column) æ·»åŠ å…¨éƒ¨ç´¢å¼• alter table table_name add fulltext(column) æ·»åŠ å¤šåˆ—ç´¢å¼• alter table table_name add index index_name(column1, column2, column3) 10. æœ€å·¦å‰ç¼€åŒ¹é… #\råœ¨MySQLå»ºç«‹è”åˆç´¢å¼•æ—¶ä¼šéµå®ˆæœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ï¼Œå³æœ€å·¦ä¼˜å…ˆï¼Œåœ¨æ£€ç´¢æ•°æ®æ—¶ä»è”åˆç´¢å¼•çš„æœ€å·¦è¾¹å¼€å§‹åŒ¹é…ã€‚ MySQLåˆ›å»ºè”åˆç´¢å¼•çš„è§„åˆ™æ˜¯é¦–å…ˆä¼šå¯¹è”åˆç´¢å¼•çš„æœ€å·¦è¾¹ç¬¬ä¸€ä¸ªå­—æ®µæ’åºï¼Œåœ¨ç¬¬ä¸€ä¸ªå­—æ®µçš„æ’åºåŸºç¡€ä¸Šï¼Œç„¶ååœ¨å¯¹ç¬¬äºŒä¸ªå­—æ®µè¿›è¡Œæ’åºã€‚ ","date":"15 March 2024","externalUrl":null,"permalink":"/entire-note/%E9%9D%A2%E8%AF%95%E9%A2%98/sql-redis-db/","section":"Entire-Notes","summary":"Redisè¯¦è§£ #\r1. Redisç®€ä»‹ #\rä½¿ç”¨Cè¯­è¨€å¼€å‘çš„å†…å­˜æ•°æ®åº“ï¼Œè¯»å†™é€Ÿåº¦å¿«ï¼Œå¹¿æ³›ç”¨äºç¼“å­˜æ–¹å‘ å¯ä»¥ç”¨äºåˆ†å¸ƒå¼é”ï¼Œç”šè‡³æ˜¯æ¶ˆæ¯é˜Ÿåˆ— æä¾›å¤šç§æ•°æ®ç±»å‹æ¥æ”¯æŒä¸åŒçš„ä¸šåŠ¡åœºæ™¯ æ”¯æŒäº‹åŠ¡ã€æŒä¹…åŒ–ã€Luaè„šæœ¬ã€å¤šç§é›†ç¾¤æ–¹æ¡ˆ 2. Redis å’Œ Memcached å¯¹æ¯” #\r2.1 ç›¸åŒç‚¹ #\réƒ½åŸºäºå†…å­˜ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨æ¥å½“ç¼“å­˜ä½¿ç”¨ éƒ½æœ‰è¿‡æœŸç­–ç•¥ ä¸¤è€…æ€§èƒ½éƒ½éå¸¸é«˜ 2.2 åŒºåˆ« #\rRedis æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ã€key-valueç±»å‹ã€æä¾›l ist set zset hashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‘ã€æ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ã€‚Memcachedåªæ”¯æŒç®€å•çš„ key-value ç±»å‹ï¼› Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œæœ‰ç¾éš¾æ¢å¤æœºåˆ¶ï¼ŒMemcachedä¸æ”¯æŒï¼› Redisåœ¨æœåŠ¡å™¨å†…å­˜ä¸è¶³æ—¶ï¼Œå¯ä»¥å°†ä¸ç”¨çš„æ•°æ®æ”¾åˆ°ç£ç›˜ä¸Šï¼›Memcachedåˆ™ç›´æ¥æŠ¥å¼‚å¸¸ï¼› RedisåŸç”Ÿæ”¯æŒé›†ç¾¤æ¨¡å¼ï¼ŒMemcachedåŸç”Ÿä¸æ”¯æŒï¼Œéœ€è¦ä¾é å®¢æˆ·ç«¯å®ç°å¾€é›†ç¾¤åˆ†ç‰‡å†™å…¥æ•°æ®ï¼› Memcachedæ˜¯å¤šçº¿ç¨‹çš„éé˜»å¡IOå¤ç”¨çš„ç½‘ç»œæ¨¡å‹ï¼ŒRedisä½¿ç”¨å•çº¿ç¨‹çš„å¤šè·¯IOå¤ç”¨æ¨¡å‹ã€6.","title":"Mysql-Redis","type":"entire-note"},{"content":"","date":"15 March 2024","externalUrl":null,"permalink":"/tags/%E4%B8%BB%E4%BB%8E%E9%83%A8%E5%88%86/","section":"Tags","summary":"","title":"ä¸»ä»éƒ¨åˆ†","type":"tags"},{"content":"ç»è¿‡æˆ‘çš„ä¸æ‡ˆåŠªåŠ›ï¼ŒRedmiBookç»ˆäºå˜æˆäº†Mac Bookâ¬‡ï¸â¬‡ï¸\nå‚è€ƒç¬”è®° å‚è€ƒè§†é¢‘ #\rç›®å‰çœ‹èµ·æ¥è¿˜è¡Œï¼š\nä¸å¾—ä¸è¯´è¿™ä¸ªæ–‡ä»¶å¤¹æ ·å¼æ•ˆæœçœŸå¥½ï¼š\nå¶å°”å‡ºç°å¡é¡¿ï¼Œä¹‹åè®°å½•\n","date":"14 March 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/mac%E4%BD%93%E9%AA%8C%E7%89%88bushi/","section":"ç¬”è®°s","summary":"ç»è¿‡æˆ‘çš„ä¸æ‡ˆåŠªåŠ›ï¼ŒRedmiBookç»ˆäºå˜æˆäº†Mac Bookâ¬‡ï¸â¬‡ï¸\nå‚è€ƒç¬”è®° å‚è€ƒè§†é¢‘ #\rç›®å‰çœ‹èµ·æ¥è¿˜è¡Œï¼š\nä¸å¾—ä¸è¯´è¿™ä¸ªæ–‡ä»¶å¤¹æ ·å¼æ•ˆæœçœŸå¥½ï¼š\nå¶å°”å‡ºç°å¡é¡¿ï¼Œä¹‹åè®°å½•","title":"Macä½“éªŒç‰ˆ","type":"ç¬”è®°"},{"content":"","date":"14 March 2024","externalUrl":null,"permalink":"/tags/%E7%AC%94%E8%AE%B0/","section":"Tags","summary":"","title":"ç¬”è®°","type":"tags"},{"content":"\rç›®çš„ï¼šä½¿ç”¨çˆ¬è™«çˆ¬å–éƒ½åº”æŒ‡å®šè§†é¢‘ä¸‹æ–¹çš„æ‰€æœ‰è¯„è®º #\ræ¥ç”µå•†å°å…¬å¸çš„é¢è¯•éœ€æ±‚\nå‚è€ƒè§†é¢‘\nçŸ¥é“äº†çˆ¬è™«çš„åŸºæœ¬åŸç†æ˜¯æ¨¡ä»¿æ­£å¸¸ç”¨æˆ·çš„æ“ä½œè·å–ç›¸å…³ä¿¡æ¯ï¼Œä¸‹é¢æ˜¯å®é™…æ“ä½œçš„è®°å½•\nè¿‡ç¨‹ï¼š\nå…ˆæ˜¯å»æŠ–éŸ³ç½‘ç«™è·å–è¯„è®ºçš„apiæ¥å£ï¼Œæ‹‰å–ä¸‹æ¥åä½¿ç”¨ApiPostæµ‹è¯•å‘ç°è¿”å›\u0026quot;block\u0026quot;é˜»å¡ä¿¡æ¯ è€Œåæ·»åŠ äº†ç›¸å…³è¯·æ±‚å¤´ï¼Œå‘ç°åŠ å…¥User-Agentæ˜¯å…³é”®ä¿¡æ¯ ç„¶è€Œæ¯æ¬¡è·å–ä¸åŒçš„è§†é¢‘å‘ç°æœ‰æ›´æ”¹çš„å‚æ•°ï¼šXBogusï¼Œè¿™ä¸ªå‚æ•°æ˜¯ç½‘ç«™åå°é€šè¿‡å‡½æ•°å¾ªç¯è°ƒç”¨è‡ªå·±ç”Ÿæˆçš„ï¼ˆåçˆ¬ï¼‰ é‚é€šè¿‡æµè§ˆå™¨æ–­ç‚¹è°ƒè¯•æœ€ç»ˆè¿½è¸ªå †æ ˆåˆ°ç”Ÿæˆå‡½æ•°ï¼š function _0x5a8f25(_0x48914f, _0xa771aa) { return (\u0026#39;undefined\u0026#39; == typeof window ? global : window)[\u0026#39;_$webrt_1668687510\u0026#39;](args) } äºæ˜¯é€šè¿‡Nodeè°ƒè¯•jsæ–‡ä»¶ï¼Œæ¨¡æ‹Ÿå¾ªç¯è¿‡ç¨‹ç”Ÿæˆå‚æ•° window = global; document = { refferer:\u0026#39;https://www.baidu.com/\u0026#39; } document.addEventListener=function (){} navigator={ userAgent:\u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36\u0026#39; } document.addEventListener=function (){} window.rainy=_0x5a8f25; å…¶å®è¿™é‡Œå°±å·²ç»æ¶‰åŠåˆ°jsé€†å‘çš„çŸ¥è¯†äº†ï¼Œå½“æ—¶ä¸çŸ¥é“ äºæ˜¯åœ¨pythonä¸­ç¼–å†™ä»£ç å¦‚ä¸‹ import csv import execjs import requests # æ‰§è¡Œjsè„šæœ¬ ctx = execjs.compile(open(\u0026#39;js/Run.js\u0026#39;, mode=\u0026#39;r\u0026#39;, encoding=\u0026#39;gbk\u0026#39;).read()) # 2ä¸ªå¿…é¡»åŠ å…¥çš„å‚æ•° header = { \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 \u0026#39; \u0026#39;Safari/537.36\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;https://www.douyin.com/\u0026#39; } # æµ‹è¯•å‘ç°æœ€å¤šåªèƒ½æŸ¥è¯¢50é¡µ cursor = input(\u0026#34;è¾“å…¥èµ·å§‹æŸ¥è¯¢åˆ†é¡µæ•°\u0026#34;) count = input(\u0026#34;è¾“å…¥ç»ˆæ­¢æŸ¥è¯¢åˆ†é¡µæ•°\u0026#34;) url = (\u0026#39;https://www.douyin.com/aweme/v1/web/comment/list/?\u0026#39;) # æ¯”è¾ƒå‘ç°ä¸‰ä¸ªå‚æ•° éœ€è¦å•ç‹¬åˆ†æ # x-bos,token,cursor # aweme_idä¸ºä½œå“id arg1 = (\u0026#39;device_platform=webapp\u0026amp;aid=6383\u0026amp;channel=channel_pc_web\u0026amp;aweme_id=7331940186147933474cursor=\u0026#39; + str(cursor) + \u0026#39;\u0026amp;count=\u0026#39; + str(count) + \u0026#39;\u0026amp;item_type=0\u0026amp;insert_ids=\u0026amp;whale_cut_token=\u0026amp;cut_version=1\u0026amp;rcFT=\u0026amp;pc_client_type=1\u0026amp;version_code=170400\u0026#39; \u0026#39;\u0026amp;version_name=17.4.0\u0026amp;cookie_enabled=true\u0026amp;screen_width=1707\u0026amp;screen_height=1067\u0026amp;browser_language=zh-CN\u0026#39; \u0026#39;\u0026amp;browser_platform=Win32\u0026amp;browser_name=Chrome\u0026amp;browser_version=122.0.0.0\u0026amp;browser_online=true\u0026amp;engine_name=Blink\u0026#39; \u0026#39;\u0026amp;engine_version=122.0.0.0\u0026amp;os_name=Windows\u0026amp;os_version=10\u0026amp;cpu_core_num=8\u0026amp;device_memory=8\u0026amp;platform=PC\u0026amp;downlink\u0026#39; \u0026#39;=1.35\u0026amp;effective_type=3g\u0026amp;round_trip_time=550\u0026amp;webid=7331622910048732683\u0026amp;msToken=hqxyFiEvhisE9d09ik0BsoXlpZs49u8r\u0026#39; \u0026#39;-WVP6f7rWmZs8QtFKXsKT2V7jPuo0x3IgvGbFDdvE6gAb1VCZWFYN_0qL_8qP8jSFGVaBJKqbC8noxhnjfdXLDQ1ofFR\u0026amp;\u0026#39;) xb = arg1 + \u0026#39;\u0026amp;XBogus=\u0026#39; + ctx.call(\u0026#39;window.rainy\u0026#39;, arg1) url += xb print(url) response = requests.request(\u0026#39;GET\u0026#39;, url, headers=header) json_data = response.json() # è·å–jsonæ•°æ® text = json_data[\u0026#39;comments\u0026#39;] #ç±»å‹ä¸ºlist # print(type(text)) # éå† listé›†åˆ user = [] columns = [\u0026#39;ç”¨æˆ·\u0026#39;, \u0026#39;è¯„è®º\u0026#39;] data = { \u0026#39;ç”¨æˆ·\u0026#39;: [], \u0026#39;è¯„è®º\u0026#39;: [] } with open(\u0026#39;results/comment.csv\u0026#39;, \u0026#39;w\u0026#39;, newline=\u0026#39;\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as file: writer = csv.writer(file) # å†™å…¥æ ‡é¢˜è¡Œï¼ŒåªåŒ…å«æŒ‡å®šçš„åˆ— writer.writerow([col for col in columns]) for item in text: data[\u0026#39;è¯„è®º\u0026#39;].append(item[\u0026#39;text\u0026#39;]) print(item[\u0026#39;text\u0026#39;]) # è·å–è¯„è®ºç”¨æˆ· user.append(item[\u0026#39;user\u0026#39;]) for item in user: data[\u0026#39;ç”¨æˆ·\u0026#39;].append(item[\u0026#39;nickname\u0026#39;]) print(item[\u0026#39;nickname\u0026#39;]) for row in zip(*(data[col] for col in columns)): writer.writerow(row) æµ‹è¯•ç»“æœï¼š\nå…¶ä»–è°ƒè¯•è¿‡ç¨‹ï¼š\næµ‹è¯•è§†é¢‘\nçˆ¬å–æµ‹è¯•å¯¹è±¡ï¼š\næµ‹è¯•é“¾æ¥\nå‘ç°åœ¨æ–­ç‚¹å¤„ç”Ÿæˆäº†xbox\næ—¥å¿—æ–­ç‚¹æ‰“å°æ‰¾åˆ°äº†xbogs\nè·å–æˆåŠŸï¼š\nè¿™ç§æ–¹å¼çš„çˆ¬å–æ•ˆç‡å¤ªä½ï¼Œé‚å°è¯•\rgithubé¡¹ç›®çˆ¬å– #\rè´Ÿè´£äººè¦æ±‚çˆ¬å–æ¨èå…³é”®è¯çš„çˆ¬å–ï¼ŒåŒæ—¶æåˆ°äº†ä»£ç†è¿™ä¸ªè¯´æ³•ï¼Œè²Œä¼¼æ˜¯ä¸€ä¸ªåŠ å¤§çˆ¬å–é‡çš„ä¸œè¥¿ï¼Œæ°å¥½è¿™ä¸ªé¡¹ç›®é‡Œé¢æœ‰\nå‘ç°æ•ˆæœéå¸¸å¥½ï¼š\nç”šè‡³æ¨¡æ‹Ÿäº†æ‰«ç ç™»é™†è¿™æ ·çš„åŠŸèƒ½ï¼Œä¸è¿‡çœ‹åŸç†åº”è¯¥æ˜¯ä½¿ç”¨pythonçš„å†…ç½®æµè§ˆå™¨æ¨¡æ‹Ÿæ–¹æ³•ã€‚åç»­æœ‰æ—¶é—´ç»§ç»­ç ”ç©¶ä»£ç†æ–¹æ³•ï¼ˆä¸è¿‡éœ€è¦ä»˜è´¹çœ‹èµ·æ¥ï¼‰\n","date":"13 March 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E7%88%AC%E8%99%AB/","section":"ç¬”è®°s","summary":"ç›®çš„ï¼šä½¿ç”¨çˆ¬è™«çˆ¬å–éƒ½åº”æŒ‡å®šè§†é¢‘ä¸‹æ–¹çš„æ‰€æœ‰è¯„è®º #\ræ¥ç”µå•†å°å…¬å¸çš„é¢è¯•éœ€æ±‚\nå‚è€ƒè§†é¢‘\nçŸ¥é“äº†çˆ¬è™«çš„åŸºæœ¬åŸç†æ˜¯æ¨¡ä»¿æ­£å¸¸ç”¨æˆ·çš„æ“ä½œè·å–ç›¸å…³ä¿¡æ¯ï¼Œä¸‹é¢æ˜¯å®é™…æ“ä½œçš„è®°å½•\nè¿‡ç¨‹ï¼š\nå…ˆæ˜¯å»æŠ–éŸ³ç½‘ç«™è·å–è¯„è®ºçš„apiæ¥å£ï¼Œæ‹‰å–ä¸‹æ¥åä½¿ç”¨ApiPostæµ‹è¯•å‘ç°è¿”å›\u0026quot;block\u0026quot;é˜»å¡ä¿¡æ¯ è€Œåæ·»åŠ äº†ç›¸å…³è¯·æ±‚å¤´ï¼Œå‘ç°åŠ å…¥User-Agentæ˜¯å…³é”®ä¿¡æ¯ ç„¶è€Œæ¯æ¬¡è·å–ä¸åŒçš„è§†é¢‘å‘ç°æœ‰æ›´æ”¹çš„å‚æ•°ï¼šXBogusï¼Œè¿™ä¸ªå‚æ•°æ˜¯ç½‘ç«™åå°é€šè¿‡å‡½æ•°å¾ªç¯è°ƒç”¨è‡ªå·±ç”Ÿæˆçš„ï¼ˆåçˆ¬ï¼‰ é‚é€šè¿‡æµè§ˆå™¨æ–­ç‚¹è°ƒè¯•æœ€ç»ˆè¿½è¸ªå †æ ˆåˆ°ç”Ÿæˆå‡½æ•°ï¼š function _0x5a8f25(_0x48914f, _0xa771aa) { return (\u0026#39;undefined\u0026#39; == typeof window ? global : window)[\u0026#39;_$webrt_1668687510\u0026#39;](args) } äºæ˜¯é€šè¿‡Nodeè°ƒè¯•jsæ–‡ä»¶ï¼Œæ¨¡æ‹Ÿå¾ªç¯è¿‡ç¨‹ç”Ÿæˆå‚æ•° window = global; document = { refferer:\u0026#39;https://www.","title":"çˆ¬è™«æµ…è®°","type":"ç¬”è®°"},{"content":"\rWalineåšå®¢ç½‘ç«™è¯„è®º #\ræ³¨å†Œè´¦å· #\ræ³¨å†Œè´¦å·âœˆï¸\nåˆ›å»ºåº”ç”¨âœˆï¸\nåˆ›å»ºä»“åº“-ã€‹ç”¨äºå­˜æ”¾è¯„è®º\nåˆ›å»ºå¥½ä¹‹åï¼Œå»åˆ°settingsé‡Œé¢ä¿®æ”¹Environmentä¸‰ä¸ªå‚æ•°\nLEAN_IDï¼šAppId LEAN_KEYï¼šApp_key LEAN_MASTER_KEYï¼šMaster_KEY\næ·»åŠ å¥½ä¹‹åï¼Œåˆ·æ–°å·¥ä½œæµ\né€šè¿‡HTMLéƒ¨ç½²\nå¯¼å…¥æ ·å¼æ–‡ä»¶å’Œjsè„šæœ¬æ–‡ä»¶\né€šè¿‡Walineçš„é…ç½®é”®æ·»åŠ è‡ªå®šä¹‰çš„ä¸œè¥¿\næ³¨ï¼š\rå€Ÿé‰´è‡ªé‡‘åœ£æµ©\n\u0026lt;br/\u0026gt; \u0026lt;span style=\u0026#34;color:rgba(var(--color-neutral-400),var(--tw-text-opacity));\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;post-meta-item-text\u0026#34; \u0026gt;\u0026amp;nbsp;\u0026amp;nbsp;{{i18n \u0026#34;article.page_views\u0026#34;}}: \u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;waline-pageview-count\u0026#34;\u0026gt;â³\u0026lt;/span\u0026gt;\u0026lt;div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;/span\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; document.getElementByClassName(\u0026#34;aline-pageview-count\u0026#34;)[0].data-path = window.location.pathname; \u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#39;/waline/waline.js\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;!-- @v2.18 --\u0026gt; \u0026lt;link href=\u0026#39;/waline/waline.css\u0026#39; rel=\u0026#39;stylesheet\u0026#39; /\u0026gt; \u0026lt;div id=\u0026#34;vcomments\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; if ({{i18n \u0026#34;lanString\u0026#34;}}==\u0026#34;zh-CN\u0026#34;) { Waline.init({ el: \u0026#39;#vcomments\u0026#39;, serverURL: \u0026#39;ä½ çš„è¯„è®ºç½‘ç«™æœåŠ¡å™¨\u0026#39;, emoji: [\u0026#39;https://valine-emoji.bili33.top/bilibilitv\u0026#39;,\u0026#39;https://valine-emoji.bili33.top/bilibiliHotKey\u0026#39;,\u0026#39;https://valine-emoji.bili33.top/Tieba-New\u0026#39;,\u0026#39;https://valine-emoji.bili33.top/weibo\u0026#39;,], meta:[\u0026#39;nick\u0026#39;, \u0026#39;mail\u0026#39;, \u0026#39;link\u0026#39;], pageview: true, reaction: true, lang: \u0026#34;zh-CN\u0026#34;, /* ä¸‹é¢çš„å¯ä»¥è‡ªå®šä¹‰ */ locale: { reactionTitle: \u0026#39;â€¢ç•…æ‰€æ¬²è¨€â€”â€”è¿™é‡Œæ˜¯å¼€æ”¾åŒºâ€¢\u0026#39;, comment: \u0026#39;ç•™è¨€æ¿\u0026#39;, placeholder: \u0026#39;ç‚¹å‡»ä¸‹æ–¹ç™»å½•åå†è¯„è®ºï¼Œä¼šæœ‰æƒŠå–œå“¦~\u0026#39;, gifSearchPlaceholder: \u0026#39;æœç´¢è¡¨æƒ…åŒ…...\u0026#39;, admin: \u0026#39;ä½œè€…\u0026#39;, sofa: \u0026#39;è¿˜æ²¡æœ‰äººè¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘å§\u0026#39;, anonymous: \u0026#39;åŒ¿åè€…\u0026#39; } }); } else { Waline.init({ el: \u0026#39;#vcomments\u0026#39;, serverURL: \u0026#39;ä½ çš„è¯„è®ºç½‘ç«™æœåŠ¡å™¨\u0026#39;, emoji: [\u0026#39;https://valine-emoji.bili33.top/bilibilitv\u0026#39;,\u0026#39;https://valine-emoji.bili33.top/bilibiliHotKey\u0026#39;,\u0026#39;https://valine-emoji.bili33.top/Tieba-New\u0026#39;,\u0026#39;https://valine-emoji.bili33.top/weibo\u0026#39;,], meta:[\u0026#39;nick\u0026#39;, \u0026#39;mail\u0026#39;], pageview: true, reaction: true, // lang:{{i18n \u0026#34;lanString\u0026#34;}}, lang: \u0026#34;zh-CN\u0026#34;, locale: { reactionTitle: \u0026#39;â€¢ç•…æ‰€æ¬²è¨€â€”â€”è¿™é‡Œæ˜¯å¼€æ”¾åŒºâ€¢\u0026#39;, comment: \u0026#39;ç•™è¨€æ¿\u0026#39;, placeholder: \u0026#39;ç‚¹å‡»ä¸‹æ–¹ç™»å½•åå†è¯„è®ºï¼Œä¼šæœ‰æƒŠå–œå“¦~\u0026#39;, gifSearchPlaceholder: \u0026#39;æœç´¢è¡¨æƒ…åŒ…...\u0026#39;, admin: \u0026#39;ä½œè€…\u0026#39;, sofa: \u0026#39;è¿˜æ²¡æœ‰äººè¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘å§\u0026#39;, anonymous: \u0026#39;åŒ¿åè€…\u0026#39; } }); } document.getElementsByClassName(\u0026#39;wl-power\u0026#39;)[0].style.display = \u0026#39;none\u0026#39;; document.querySelector(\u0026#34;.wl-actions a\u0026#34;).style.display = \u0026#39;none\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt; :root{ --waline-color: var(--tw-prose-quotes); --waline-info-color: var(--tw-prose-quotes); --waline-info-bgcolor: var(--tw-ring-color); --waline-theme-color: rgba(var(--color-primary-400)); --waline-bgcolor: transparent; --waline-border-color: #747474; } .wl-editor:focus, .wl-input:focus { background: transparent; } .wl-editor,.wl-input{ max-width:88%; } .wl-reaction-item.active .wl-reaction-votes { color: white; } \u0026lt;/style\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; var pagect = document.getElementById(\u0026#39;pagec\u0026#39;); var observer = new MutationObserver(function(){ var itl,itll; var element = document.getElementById(\u0026#34;pagec\u0026#34;); observer.disconnect(); itl = element.innerText; itll = Number(itl).toLocaleString(); document.getElementById(\u0026#39;pagec\u0026#39;).innerHTML = itll; }); var article = document.getElementById(\u0026#39;pagec\u0026#39;); var options = { \u0026#39;childList\u0026#39;: true, \u0026#39;subtree\u0026#39;: true }; observer.observe(article, options); \u0026lt;/script\u0026gt; ","date":"11 March 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E6%80%8E%E4%B9%88%E8%AF%84%E8%AE%BA/","section":"ç¬”è®°s","summary":"Walineåšå®¢ç½‘ç«™è¯„è®º #\ræ³¨å†Œè´¦å· #\ræ³¨å†Œè´¦å·âœˆï¸\nåˆ›å»ºåº”ç”¨âœˆï¸\nåˆ›å»ºä»“åº“-ã€‹ç”¨äºå­˜æ”¾è¯„è®º\nåˆ›å»ºå¥½ä¹‹åï¼Œå»åˆ°settingsé‡Œé¢ä¿®æ”¹Environmentä¸‰ä¸ªå‚æ•°\nLEAN_IDï¼šAppId LEAN_KEYï¼šApp_key LEAN_MASTER_KEYï¼šMaster_KEY\næ·»åŠ å¥½ä¹‹åï¼Œåˆ·æ–°å·¥ä½œæµ\né€šè¿‡HTMLéƒ¨ç½²\nå¯¼å…¥æ ·å¼æ–‡ä»¶å’Œjsè„šæœ¬æ–‡ä»¶\né€šè¿‡Walineçš„é…ç½®é”®æ·»åŠ è‡ªå®šä¹‰çš„ä¸œè¥¿\næ³¨ï¼š\rå€Ÿé‰´è‡ªé‡‘åœ£æµ©\n\u0026lt;br/\u0026gt; \u0026lt;span style=\u0026#34;color:rgba(var(--color-neutral-400),var(--tw-text-opacity));\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;post-meta-item-text\u0026#34; \u0026gt;\u0026amp;nbsp;\u0026amp;nbsp;{{i18n \u0026#34;article.page_views\u0026#34;}}: \u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;waline-pageview-count\u0026#34;\u0026gt;â³\u0026lt;/span\u0026gt;\u0026lt;div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;/span\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; document.","title":"Walineè¯„è®ºç³»ç»Ÿ","type":"ç¬”è®°"},{"content":"\råŸºç¡€çŸ¥è¯† #\rHashæ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›å¸¸è§çš„hashå®šå€æ³• #\ræ•£åˆ—è¡¨ç®—æ³•å¸Œæœ›èƒ½å°½é‡åšåˆ°ä¸ç»è¿‡ä»»ä½•æ¯”è¾ƒï¼Œé€šè¿‡ä¸€æ¬¡å­˜å–å°±èƒ½å¾—åˆ°æ‰€æŸ¥æ‰¾çš„æ•°æ®å…ƒç´  ï¼Œå› è€Œå¿… é¡»è¦åœ¨æ•°æ®å…ƒç´ çš„å­˜å‚¨ä½ç½®å’Œå®ƒçš„å…³é”®å­—ï¼ˆå¯ç”¨ key è¡¨ç¤ºï¼‰ä¹‹é—´å»ºç«‹ä¸€ä¸ªç¡®å®šçš„å¯¹åº”å…³ç³»ï¼Œä½¿æ¯ä¸ª å…³é”®å­—å’Œæ•£åˆ—è¡¨ä¸­ä¸€ä¸ªå”¯ä¸€çš„å­˜å‚¨ä½ç½®ç›¸å¯¹åº”ã€‚å› æ­¤åœ¨æŸ¥æ‰¾æ—¶ï¼Œåªè¦æ ¹æ®è¿™ä¸ªå¯¹åº”å…³ç³»æ‰¾åˆ°ç»™å®š å…³é”®å­—åœ¨æ•£åˆ—è¡¨ä¸­çš„ä½ç½®å³å¯ã€‚è¿™ç§å¯¹åº”å…³ç³»è¢«ç§°ä¸ºæ•£åˆ—å‡½æ•°(å¯ç”¨ h(key)è¡¨ç¤º)ã€‚\n1ï¼‰ç›´æ¥å®šå€æ³•ï¼š å–å…³é”®å­—æˆ–å…³é”®å­—çš„æŸä¸ªçº¿æ€§å‡½æ•°å€¼ä¸ºæ•£åˆ—åœ°å€ã€‚ å³ï¼šh(key) = key æˆ– h(key) = a * key + bï¼Œå…¶ä¸­ a å’Œ b ä¸ºå¸¸æ•°ã€‚ ï¼ˆ2ï¼‰æ•°å­—åˆ†ææ³• ï¼ˆ3ï¼‰å¹³æ–¹å–å€¼æ³•ï¼š å–å…³é”®å­—å¹³æ–¹åçš„ä¸­é—´å‡ ä½ä¸ºæ•£åˆ—åœ°å€ã€‚ ï¼ˆ4ï¼‰æŠ˜å æ³•ï¼šå°†å…³é”®å­—åˆ†å‰²æˆä½æ•°ç›¸åŒçš„å‡ éƒ¨åˆ†ï¼Œç„¶åå–è¿™å‡ éƒ¨åˆ†çš„å åŠ å’Œä½œä¸ºæ•£åˆ—åœ°å€ã€‚ ï¼ˆ5ï¼‰é™¤ç•™ä½™æ•°æ³•ï¼šå–å…³é”®å­—è¢«æŸä¸ªä¸å¤§äºæ•£åˆ—è¡¨è¡¨é•¿ m çš„æ•° p é™¤åæ‰€å¾—çš„ä½™æ•°ä¸ºæ•£åˆ—åœ°å€ï¼Œ å³ï¼šh(key) = key MOD p p â‰¤ m ï¼ˆ6ï¼‰éšæœºæ•°æ³•ï¼šé€‰æ‹©ä¸€ä¸ªéšæœºå‡½æ•°ï¼Œå–å…³é”®å­—çš„éšæœºå‡½æ•°å€¼ä¸ºå®ƒçš„æ•£åˆ—åœ°å€ï¼Œ å³ï¼šh(key) = random(key) ä»€ä¹ˆæ˜¯æ’åºäºŒå‰æ ‘ #\ré¦–å…ˆå¦‚æœæ™®é€šäºŒå‰æ ‘æ¯ä¸ªèŠ‚ç‚¹æ»¡è¶³ï¼šå·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å€¼å°äºå®ƒçš„æ ¹èŠ‚ç‚¹å€¼ï¼Œä¸”å³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å€¼ å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹å€¼ï¼Œåˆ™è¿™æ ·çš„äºŒå‰æ ‘å°±æ˜¯æ’åºäºŒå‰æ ‘\nä¸ºä»€ä¹ˆè¦é‡å†™hashcodeå’Œequalsæ–¹æ³• #\rå›ç­”ï¼šå› ä¸ºç±»æœ¬çœçš„è¿™ä¸¤ä¸ªæ–¹æ³•è°ƒç”¨æ—¶éƒ½åªæ˜¯å»æ¯”è¾ƒå¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œå½“æˆ‘ä»¬newä¸¤ä¸ªç›¸åŒå†…å®¹çš„å¯¹è±¡ï¼Œæœ¬æ¥æ˜¯è¦æ¯”è¾ƒè¿”å›trueçš„ä½†æ˜¯ä¸é‡å†™çš„è¯æ¯”è¾ƒ å†…å­˜è¿”å›falseï¼Œé€ æˆé”™è¯¯ï¼Œæ•…è€Œéœ€è¦é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•\nä»€ä¹ˆæ˜¯æ·±æ‹·è´å’Œæµ…æ‹·è´ #\ræµ…æ‹·è´ï¼šç®€å•çš„èµ‹å€¼æ‹·è´æ“ä½œ\næ·±æ‹·è´ï¼šåœ¨å †åŒºé‡æ–°ç”³è¯·ç©ºé—´ï¼Œè¿›è¡Œæ‹·è´æ“ä½œ\nArrayListå’ŒLinkedListåŒºåˆ« #\rå›ç­”éƒ½å®ç°äº†Listæ¥å£ä½œä¸ºæ•°æ®å­˜å‚¨ç®¡ç†çš„å®¹å™¨ï¼Œåœºæ™¯ä¸ŠArraylistå†…éƒ¨é€šè¿‡åŠ¨æ€æ•°ç»„å®ç°ï¼Œå®ç°å¿«é€Ÿçš„éšæœºè®¿é—®ï¼Œé€‚ç”¨äºé¢‘ç¹çš„è¯»å–æ“ä½œï¼Œç§»åŠ¨æ“ä½œæ€§èƒ½ä½ï¼Œ ä¸æ”¯æŒåŒæ­¥ï¼Œçº¿ç¨‹ä¸å®‰å…¨ã€‚LinkedListå†…éƒ¨åŒå‘é“¾è¡¨å®ç°ï¼Œé€‚åˆæ’å…¥åˆ é™¤æ“ä½œï¼Œæ”¯æŒä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨ï¼ˆå› ä¸ºå®ç°äº†Dequeæ¥å£ï¼‰ï¼ŒåŒæ ·çº¿ç¨‹ä¸å®‰å…¨ï¼Œå•çº¿ç¨‹æ€§èƒ½è¾ƒå¥½ã€‚\nHashMapç¼ºç‚¹ #\råœ¨JDK1.7å’ŒJDK1.8ä¸­çš„HashMapçš„é»˜è®¤åˆå§‹å®¹é‡ä¸º16ï¼ŒloadFactorå‡ä¸º0.75ã€‚\nå‚è€ƒæ–‡ç« \nå›ç­”çº¿ç¨‹ä¸å®‰å…¨ï¼Œæ²¡æœ‰å†…ç½®è¯»å†™é”ï¼Œå¤´æ’äº§ç”Ÿæ­»å¾ªç¯ï¼Œputä¼šè¦†ç›–ï¼Œå¹¶å‘æƒ…å†µput/getå¯èƒ½ä¸ºç©º\nå¤´æ’æ³•/å°¾æ’æ³• #\rï¼ˆjdk1.7ï¼‰å¤´æ’åœ¨å°¾éƒ¨è¿½åŠ å…ƒç´ ï¼Œï¼ˆjdk1.8ï¼‰å°¾æ’æ³•ï¼Œé“¾è¡¨é•¿åº¦å¤§äºç­‰äº8è½¬åŒ–çº¢é»‘æ ‘ï¼Œåˆ¤æ–­Mapé”®å€¼å¯¹æ•°é‡è¶…è¿‡64\nHashTableä¸ºä»€ä¹ˆçº¿ç¨‹å®‰å…¨ #\rå›ç­”removeï¼Œputï¼Œgetéƒ½æ˜¯åŒæ­¥çš„æ–¹æ³•ï¼ˆsynchronizedå…³é”®å­—ï¼‰ï¼Œåº•å±‚é€šè¿‡æ•°ç»„+é“¾è¡¨å®ç°ï¼Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹å…¶è¿›è¡ŒæŸç§æ“ä½œï¼Œæ‰€ä»¥å¹¶å‘æ€§æ¯”ConcurrnetHashMapå·®\nConcurrentHashMapçº¿ç¨‹å®‰å…¨åŸå›  #\rjdk1.7å¯¹æ¯ä¸ªsegmentï¼ˆæ®µï¼‰åŠ åˆ†æ®µé”ï¼ˆReentrantLockï¼‰å®ç°æ®µéš”ç¦»ä¿è¯å¹¶å‘å®‰å…¨ ï¼Œæœ€å¤šå­˜åœ¨16ä¸ªæ®µ\njdk1.8ä¸å†ä½¿ç”¨æ®µï¼Œä½¿ç”¨ç»“ç‚¹ï¼ˆNodeï¼‰å’ŒCASï¼ŒSynchronizedä¿è¯çº¿ç¨‹å®‰å…¨\nConcurrentHashMapèƒ½ä¿è¯å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œputæ“ä½œåæ•°æ®ä¸ä¼šé”™ä¹±ï¼Œè€ŒHashMapåœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œputæ“ä½œåæ•°æ®ä¼šé”™ä¹±ç»“æœæ— æ³•é¢„çŸ¥ã€‚ä½†æ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œgetæ–¹æ³•å’Œputæ–¹å¼æ—¶ï¼Œå°±æ— æ³•ä¿è¯å¹¶å‘çº¿ç¨‹å®‰å…¨ã€‚\ntokenæ— æ„Ÿåˆ·æ–° #\rç”¨æˆ·ç™»å½•æˆåŠŸåï¼ŒæœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ªTokenï¼Œå¹¶å°†å…¶é¢å‘ç»™å®¢æˆ·ç«¯ã€‚ å‰ç«¯ä¼šä¿å­˜è¿™ä¸ªTokenï¼Œå¹¶åœ¨æ¯æ¬¡è¯·æ±‚æ—¶å°†å…¶æ·»åŠ åˆ°è¯·æ±‚å¤´ä¸­ï¼Œé€šå¸¸æ˜¯Authorizationå­—æ®µã€‚ åç«¯æœåŠ¡å™¨ä½¿ç”¨å¯†é’¥å¯¹Tokenè¿›è¡Œç­¾åï¼Œä»¥ç¡®ä¿å…¶çœŸå®æ€§å’Œå®Œæ•´æ€§ã€‚ å¦‚æœTokenå³å°†è¿‡æœŸï¼Œåç«¯æœåŠ¡å™¨ä¼šåœ¨å“åº”ä¸­è¿”å›ä¸€ä¸ªæ–°çš„Tokenï¼Œå¹¶å°†å…¶ä½œä¸ºå“åº”å¤´çš„ä¸€éƒ¨åˆ†ã€‚ å‰ç«¯çš„æ‹¦æˆªå™¨ä¼šæ£€æŸ¥å“åº”ä¸­æ˜¯å¦å­˜åœ¨æ–°çš„Tokenï¼Œå¹¶å°†å®ƒä¿å­˜åœ¨æœ¬åœ°ã€‚ åœ¨åç»­çš„è¯·æ±‚ä¸­ï¼Œå‰ç«¯ä¼šç»§ç»­ä½¿ç”¨æœ€æ–°çš„Tokenè¿›è¡Œèº«ä»½éªŒè¯ åŒTokenæœºåˆ¶ #\rAccess Tokenï¼šç”¨äºè·å–è®¿é—®èµ„æºæˆ–æ‰§è¡Œæ“ä½œçš„æˆæƒï¼Œæœ‰æ•ˆæœŸçŸ­ã€‚å®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œåœ¨è¯·æ±‚å¤´æºå¸¦æ­¤accessTokenã€‚ Refresh Tokenï¼šç”¨æ¥éªŒè¯ç”¨æˆ·çš„èº«ä»½ï¼Œåˆ·æ–°accessTokenï¼Œæœ‰æ•ˆæœŸé•¿ã€‚å½“accessTokenè¿‡æœŸæ—¶ï¼Œå‘æœåŠ¡ç«¯ä¼ é€’refreshTokenæ¥åˆ·æ–°accessTokenã€‚ å¸ƒéš†è¿‡æ»¤å™¨ #\råå« Bloom çš„äººæå‡ºäº†ä¸€ç§æ¥æ£€ç´¢å…ƒç´ æ˜¯å¦åœ¨ç»™å®šå¤§é›†åˆä¸­çš„æ•°æ®ç»“æ„ï¼Œè¿™ç§æ•°æ®ç»“æ„æ˜¯é«˜æ•ˆä¸”æ€§èƒ½å¾ˆå¥½çš„ï¼Œä½†ç¼ºç‚¹æ˜¯å…·æœ‰ä¸€å®šçš„é”™è¯¯è¯†åˆ«ç‡å’Œåˆ é™¤éš¾åº¦ã€‚å¹¶ä¸”ï¼Œç†è®ºæƒ…å†µä¸‹ï¼Œæ·»åŠ åˆ°é›†åˆä¸­çš„å…ƒç´ è¶Šå¤šï¼Œè¯¯æŠ¥çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚\nå‚è€ƒæ–‡ç« \nMqä½¿ç”¨åœºæ™¯ #\rå¼‚æ­¥è§£è€¦ï¼š è€—æ—¶è€Œä¸”ä¸éœ€è¦å³æ—¶è¿”å›ç»“æœçš„æ“ä½œã€‚å°†è¿™äº›æ“ä½œå¯ä»¥åšä¸ºã€Œå¼‚æ­¥å¤„ç†ã€ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§çš„åŠ å¿«è¯·æ±‚çš„å“åº”æ—¶é—´\nå¾®æœåŠ¡è§£è€¦ï¼šç‹¬ç«‹æœåŠ¡ä½œä¸ºå¾®æœåŠ¡ï¼Œé€šè¿‡Mqå®ç°Appé€šä¿¡ã€‚\næµé‡å‰Šå³°å¡«è°·ï¼šMQï¼Œå¯ä»¥å°†éœ€è¦å¤„ç†çš„æ¶ˆæ¯å…¨éƒ¨æ”¾å…¥å…¶ä¸­ï¼Œç³»ç»ŸæŒ‰ç…§æœ€å¤§å¤„ç†èƒ½åŠ›ï¼Œå»è·å–æ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ï¼Œè¿™æ ·å°±å¯ä»¥å°†ä¸€ç¬é—´è¿‡æ¥çš„è¯·æ±‚ï¼Œåˆ†æ•£åˆ°ä¸€æ®µæ—¶é—´å†…è¿›è¡Œå¤„ç†ï¼Œé¿å…äº†ç³»ç»Ÿçš„å´©æºƒã€‚\næ¶ˆæ¯åˆ†å‘ï¼šç›‘å¬æœåŠ¡è‡ªå·±éœ€è¦çš„æ¶ˆæ¯\nåˆ†å¸ƒå¼äº‹åŠ¡çš„æ•°æ®ä¸€è‡´æ€§ï¼šå·²è¢«Seataå–ä»£\nç®—æ³• #\r1.\rå‰åºéå†äºŒå‰æ ‘\nå¼ºåŒ–å…«è‚¡æ–‡çš„æ–¹å‘ï¼Œæ„Ÿè°¢\rå­¦é™¢åŒå­¦çš„å¸®åŠ©ï¼š\nåŸæ–‡é“¾æ¥\nvolatile å…³é”®å­— ä¿è¯å˜é‡çš„å¯è§æ€§ #\rå¸¦äº†è¿™ä¸ªå…³é”®å­—çš„å˜é‡JMMä¼šæŠŠè¯¥çº¿ç¨‹æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡å¼ºåˆ¶åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­å»ï¼Œå¹¶ä¸”è¿™ä¸ªå†™ä¼šæ“ä½œä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹ä¸­çš„volatileå˜é‡ç¼“å­˜æ— æ•ˆï¼Œè¿™æ ·ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜æ—¶ï¼Œå½“å‰çº¿ç¨‹ä¼šç«‹å³å¾—çŸ¥ï¼Œå¹¶å°†å·¥ä½œå†…å­˜ä¸­çš„å˜é‡æ›´æ–°ä¸ºæœ€æ–°çš„ç‰ˆæœ¬\nåº•å±‚å®ç°ï¼šå†…å­˜å±éšœ\nå†…å­˜å±éšœï¼ˆMemory Barrierï¼‰åˆç§°å†…å­˜æ …æ ï¼Œæ˜¯ä¸€ä¸ªCPUæŒ‡ä»¤ï¼Œå®ƒçš„ä½œç”¨æœ‰ä¸¤ä¸ªï¼š\nä¿è¯ç‰¹å®šæ“ä½œçš„é¡ºåº ä¿è¯æŸäº›å˜é‡çš„å†…å­˜å¯è§æ€§ï¼ˆvolatileçš„å†…å­˜å¯è§æ€§ï¼Œå…¶å®å°±æ˜¯ä¾é è¿™ä¸ªå®ç°çš„ï¼‰ ç”±äºç¼–è¯‘å™¨å’Œå¤„ç†å™¨éƒ½èƒ½æ‰§è¡ŒæŒ‡ä»¤é‡æ’çš„ä¼˜åŒ–ï¼Œå¦‚æœåœ¨æŒ‡ä»¤é—´æ’å…¥ä¸€æ¡Memory Barrieråˆ™ä¼šå‘Šè¯‰ç¼–è¯‘å™¨å’ŒCPUï¼Œä¸ç®¡ä»€ä¹ˆæŒ‡ä»¤éƒ½ä¸èƒ½å’Œè¿™æ¡Memory BarrieræŒ‡ä»¤é‡æ’åºã€‚\næ‰€ä»¥volatileèƒ½å¤Ÿä¿è¯ï¼Œä¹‹å‰çš„æŒ‡ä»¤ä¸€å®šå…¨éƒ¨æ‰§è¡Œï¼Œä¹‹åçš„æŒ‡ä»¤ä¸€å®šéƒ½æ²¡æœ‰æ‰§è¡Œï¼Œå¹¶ä¸”å‰é¢è¯­å¥çš„ç»“æœå¯¹åé¢çš„è¯­å¥å¯è§ã€‚\næœ€åæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹volatileå…³é”®å­—çš„ä¸‰ä¸ªç‰¹æ€§ï¼š\nåŸå­æ€§ï¼šå…¶å®ä¹‹å‰è®²è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œå°±æ˜¯è¦åšä»€ä¹ˆäº‹æƒ…è¦ä¹ˆåšå®Œï¼Œè¦ä¹ˆå°±ä¸åšï¼Œä¸å­˜åœ¨åšä¸€åŠçš„æƒ…å†µã€‚ å¯è§æ€§ï¼šæŒ‡å½“å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹å¾—åˆ°ä¿®æ”¹çš„å€¼ã€‚ æœ‰åºæ€§ï¼šå³ç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚\nä¿è¯å¯è§æ€§ ä¸ä¿è¯åŸå­æ€§ é˜²æ­¢æŒ‡ä»¤é‡æ’ æœ€å®¹æ˜“ç†è§£ï¼š\nprivate static volatile int a = 0; public static void main(String[] args) throws InterruptedException { new Thread(() -\u0026gt; { while (a == 0); System.out.println(\u0026#34;çº¿ç¨‹ç»“æŸï¼\u0026#34;); }).start(); Thread.sleep(1000); System.out.println(\u0026#34;æ­£åœ¨ä¿®æ”¹açš„å€¼...\u0026#34;); a = 1; } çº¿ç¨‹æ± ï¼š #\rç±»ï¼šThreadPoolExecutor\npublic ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue\u0026lt;Runnable\u0026gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) ä¸ƒä¸ªå‚æ•°çš„å®é™…æ„ä¹‰ï¼š\ncorePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ± å¤§å°ï¼Œæˆ‘ä»¬æ¯å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªå¤šçº¿ç¨‹ä»»åŠ¡æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ ¸å¿ƒçº¿ç¨‹ï¼Œæ— è®ºæ˜¯å¦å­˜åœ¨å…¶ä»–ç©ºé—²çº¿ç¨‹ï¼Œç›´åˆ°åˆ°è¾¾æ ¸å¿ƒçº¿ç¨‹æ± å¤§å°ä¸ºæ­¢ï¼Œä¹‹åä¼šå°è¯•å¤ç”¨çº¿ç¨‹èµ„æºã€‚å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ä¸€å¼€å§‹å°±å…¨éƒ¨åˆå§‹åŒ–å¥½ï¼Œè°ƒç”¨prestartAllCoreThreads()å³å¯ã€‚ maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ± å¤§å°ï¼Œå½“ç›®å‰çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¹¶ä¸”ç­‰å¾…é˜Ÿåˆ—å·²æ»¡ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥å°è¯•ç»§ç»­åˆ›å»ºæ–°çš„éæ ¸å¿ƒçº¿ç¨‹è¿è¡Œï¼Œä½†æ˜¯ä¸èƒ½è¶…è¿‡æœ€å¤§çº¿ç¨‹æ± å¤§å°ã€‚ keepAliveTimeï¼šçº¿ç¨‹æœ€å¤§ç©ºé—²æ—¶é—´ï¼Œå½“ä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹ç©ºé—²è¶…è¿‡ä¸€å®šæ—¶é—´ï¼Œä¼šè‡ªåŠ¨é”€æ¯ã€‚ unitï¼šçº¿ç¨‹æœ€å¤§ç©ºé—²æ—¶é—´çš„æ—¶é—´å•ä½ workQueueï¼šçº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ï¼Œå½“çº¿ç¨‹æ± ä¸­æ ¸å¿ƒçº¿ç¨‹æ•°å·²æ»¡æ—¶ï¼Œå°±ä¼šå°†ä»»åŠ¡æš‚æ—¶å­˜åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°æœ‰çº¿ç¨‹èµ„æºå¯ç”¨ä¸ºæ­¢ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨æˆ‘ä»¬ä¸Šä¸€ç« å­¦åˆ°çš„é˜»å¡é˜Ÿåˆ—ã€‚ threadFactoryï¼šçº¿ç¨‹åˆ›å»ºå·¥å‚ï¼Œæˆ‘ä»¬å¯ä»¥å¹²æ¶‰çº¿ç¨‹æ± ä¸­çº¿ç¨‹çš„åˆ›å»ºè¿‡ç¨‹ï¼Œè¿›è¡Œè‡ªå®šä¹‰ã€‚ handlerï¼šæ‹’ç»ç­–ç•¥ï¼Œå½“ç­‰å¾…é˜Ÿåˆ—å’Œçº¿ç¨‹æ± éƒ½æ²¡æœ‰ç©ºé—´äº†ï¼ŒçœŸçš„ä¸èƒ½å†æ¥æ–°çš„ä»»åŠ¡æ—¶ï¼Œæ¥äº†ä¸ªæ–°çš„å¤šçº¿ç¨‹ä»»åŠ¡ï¼Œé‚£ä¹ˆåªèƒ½æ‹’ç»äº†ï¼Œè¿™æ—¶å°±ä¼šæ ¹æ®å½“å‰è®¾å®šçš„æ‹’ç»ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚ æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹Ÿè¿™æ ·çš„ä¸€ä¸ªçº¿ç¨‹ï¼š\nThreadPoolExecutor executor = new ThreadPoolExecutor(2, 4, //2ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸º4ä¸ª 3, TimeUnit.SECONDS, //æœ€å¤§ç©ºé—²æ—¶é—´ä¸º3ç§’é’Ÿ new ArrayBlockingQueue\u0026lt;\u0026gt;(2)); //è¿™é‡Œä½¿ç”¨å®¹é‡ä¸º2çš„ArrayBlockingQueueé˜Ÿåˆ— å¦‚ä½•å®ç°å®šæ—¶ä»»åŠ¡ï¼Ÿ #\rå›ç­”å¯ä»¥é€šè¿‡Springè‡ªå¸¦çš„Scheduledå®šæ—¶è®¡åˆ’å’Œjucé‡Œé¢çš„Timertask\nçº¿ç¨‹æ± èƒ½ä¸èƒ½æ‰§è¡Œå®šæ—¶ä»»åŠ¡å‘¢ï¼Ÿæˆ‘ä»¬ä¹‹å‰å¦‚æœéœ€è¦æ‰§è¡Œä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œé‚£ä¹ˆè‚¯å®šä¼šç”¨åˆ°Timerå’ŒTimerTaskï¼Œ ä½†æ˜¯å®ƒåªä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¤„ç†æˆ‘ä»¬çš„å®šæ—¶ä»»åŠ¡ï¼Œæ— æ³•å®ç°å¤šçº¿ç¨‹è°ƒåº¦ï¼Œå¹¶ä¸”å®ƒæ— æ³•å¤„ç†å¼‚å¸¸æƒ…å†µä¸€æ—¦æŠ›å‡ºæœªæ•è·å¼‚å¸¸é‚£ä¹ˆä¼šç›´æ¥ç»ˆæ­¢ï¼Œæ˜¾ç„¶æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ å¼ºå¤§çš„å®šæ—¶å™¨ã€‚\nJDK5ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ScheduledThreadPoolExecutoræ¥æäº¤å®šæ—¶ä»»åŠ¡ï¼Œå®ƒç»§æ‰¿è‡ªThreadPoolExecutorï¼Œå¹¶ä¸”æ‰€æœ‰çš„æ„é€ æ–¹æ³•éƒ½å¿…é¡»è¦æ±‚æœ€å¤§çº¿ç¨‹æ± å®¹é‡ä¸ºInteger.MAX_VALUEï¼Œå¹¶ä¸”éƒ½æ˜¯é‡‡ç”¨çš„DelayedWorkQueueä½œä¸ºç­‰å¾…é˜Ÿåˆ—ã€‚\nå¦‚ä½•ä½¿ç”¨çº¿ç¨‹å¹¶å‘å·¥å…·ç±»CountDownLatchï¼Ÿ #\rè¯´ä¸€ä¸‹åŒäº²å§”æ´¾æœºåˆ¶ #\rå½“ä¸€ä¸ªç±»æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œä»–é¦–å…ˆä¸ä¼šå°è¯•è‡ªå·±å»åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ ç±»å»å®Œæˆï¼Œæ¯ä¸€ä¸ªå±‚æ¬¡ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œå› æ­¤æ‰€æœ‰çš„åŠ è½½è¯·æ±‚éƒ½åº”è¯¥ä¼ é€åˆ°å¯åŠ¨ç±»åŠ è½½å…¶ä¸­ï¼Œ åªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼ˆåœ¨å®ƒçš„åŠ è½½è·¯å¾„ä¸‹æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€åŠ è½½çš„ Classï¼‰ï¼Œå­ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚ é‡‡ç”¨åŒäº²å§”æ´¾çš„ä¸€ä¸ªå¥½å¤„æ˜¯æ¯”å¦‚åŠ è½½ä½äº rt.jar åŒ…ä¸­çš„ç±» java.lang.Objectï¼Œä¸ç®¡æ˜¯å“ªä¸ªåŠ è½½ å™¨åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ‰˜ç»™é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·å°±ä¿è¯äº†ä½¿ç”¨ä¸åŒçš„ç±»åŠ è½½ å™¨æœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯åŒæ ·ä¸€ä¸ª Object å¯¹è±¡ã€‚\nçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ #\rçº¿ç¨‹ç»å†äº”ä¸ªç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»ºï¼Œå°±ç»ªï¼Œè¿è¡Œï¼Œé˜»å¡ï¼Œæ¶ˆäº¡\nåˆ›å»ºï¼šçº¿ç¨‹çš„newæ–¹æ³•\nå°±ç»ªï¼šè°ƒç”¨startæ–¹æ³•ä¹‹åï¼Œå°†è¢«JVMè¿›è¡Œåˆå§‹åŒ–\nè¿è¡Œï¼šè°ƒç”¨runæ–¹æ³•\né˜»å¡ï¼šçº¿ç¨‹ä¸»åŠ¨æ”¾å¼ƒå¯¹çº¿ç¨‹èµ„æºçš„æŒæ§\næ¶ˆäº¡ï¼šç›´æ¥è°ƒç”¨è¯¥çº¿ç¨‹çš„ stop()æ–¹æ³•æ¥ç»“æŸè¯¥çº¿ç¨‹â€”è¯¥æ–¹æ³•é€šå¸¸å®¹æ˜“å¯¼è‡´æ­»é”ï¼Œä¸æ¨èä½¿ç”¨\nçº¿ç¨‹æ“ä½œçš„åŸºæœ¬æ–¹æ³•ï¼šçº¿ç¨‹ç›¸å…³çš„åŸºæœ¬æ–¹æ³•æœ‰ waitï¼Œnotifyï¼ŒnotifyAllï¼Œsleepï¼Œjoinï¼Œyield ç­‰\nSpringäº‹åŠ¡ä¼ æ’­æœºåˆ¶ï¼š #\räº‹åŠ¡ä¼ æ’­çš„å®šä¹‰ï¼š #\räº‹åŠ¡ä¼ æ’­è¡Œä¸ºä¸»è¦ç”¨æ¥æè¿°ç”±æŸä¸€ä¸ªäº‹åŠ¡ä¼ æ’­è¡Œä¸ºä¿®é¥°çš„æ–¹æ³•è¢«åµŒå¥—è¿›å¦ä¸€ä¸ªæ–¹æ³•çš„äº‹åŠ¡ä¸­ï¼Œè¯¥ äº‹åŠ¡å¦‚ä½•ä¼ æ’­ã€‚è¿™ä¸ªæ¦‚è¿°å¯èƒ½ä¸å¥½ç†è§£ï¼Œæ¢å¥è¯å°±æ˜¯å½“ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªäº‹åŠ¡æ–¹æ³•åº”è¯¥å¦‚ä½•è¿›è¡Œã€‚\nspringä¸­çš„äº‹åŠ¡çº§åˆ«#\nREQUIRED #\rREQUIREDæ˜¯Springé»˜è®¤çš„ä¼ æ’­æœºåˆ¶ã€‚å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ã€‚ REQUIREDä¼ æ’­æœºåˆ¶æœ€å¸¸ç”¨çš„æƒ…å†µæ˜¯åœ¨ä¸€ä¸ªäº‹åŠ¡ ä¸­è¿›è¡Œå¤šä¸ªæ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡éƒ½å°†è¢«å›æ»šã€‚\nSUPPORTS #\rSUPPORTSä¼ æ’­æœºåˆ¶è¡¨ç¤ºå½“å‰æ–¹æ³•å¦‚æœåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¢«è°ƒç”¨ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼› å¦åˆ™ï¼Œä»¥éäº‹åŠ¡çš„æ–¹å¼è¿è¡Œã€‚SUPPORTSä¼ æ’­æœºåˆ¶é€‚ç”¨äºå¯¹äº‹åŠ¡è¦æ±‚ä¸é«˜çš„æ“ä½œï¼Œä¾‹å¦‚è¯»å–æ“ä½œã€‚\nMANDATORY #\rMANDATORYä¼ æ’­æœºåˆ¶è¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¢«è°ƒç”¨ï¼Œå¦åˆ™å°†æŠ›å‡ºå¼‚å¸¸ã€‚ MANDATORYä¼ æ’­æœºåˆ¶é€‚ç”¨äºåœ¨éœ€è¦äº‹åŠ¡çš„æƒ…å†µä¸‹è°ƒç”¨æ–¹æ³•ã€‚\nREQUIRES_NEW #\rREQUIRES_NEWä¼ æ’­æœºåˆ¶è¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»å¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·è¯¥äº‹åŠ¡ã€‚ REQUIRES_NEWä¼ æ’­æœºåˆ¶é€‚ç”¨äºå¯¹äº‹åŠ¡è¦æ±‚è¾ƒé«˜çš„æ“ä½œï¼Œä¾‹å¦‚æ›´æ–°æ“ä½œã€‚\nNOT_SUPPORTED #\rNOT_SUPPORTEDä¼ æ’­æœºåˆ¶è¡¨ç¤ºå½“å‰æ–¹æ³•ä¸åº”è¯¥åœ¨äº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·è¯¥äº‹åŠ¡ã€‚ NOT_SUPPORTEDä¼ æ’­æœºåˆ¶é€‚ç”¨äºå¯¹äº‹åŠ¡æ²¡æœ‰è¦æ±‚çš„æ“ä½œï¼Œä¾‹å¦‚æ—¥å¿—è®°å½•ç­‰ã€‚\nNEVER #\rNEVERä¼ æ’­æœºåˆ¶è¡¨ç¤ºå½“å‰æ–¹æ³•ä¸åº”è¯¥åœ¨äº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ NEVERä¼ æ’­æœºåˆ¶é€‚ç”¨äºç¦æ­¢åœ¨äº‹åŠ¡ä¸­è¿è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚å®‰å…¨æ£€æŸ¥ç­‰ã€‚\nNESTED #\rNESTEDä¼ æ’­æœºåˆ¶è¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»åœ¨ä¸€ä¸ªåµŒå¥—äº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨è¯¥äº‹åŠ¡å†…å¼€å¯ä¸€ä¸ªåµŒå¥—äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ã€‚ NESTEDä¼ æ’­æœºåˆ¶é€‚ç”¨äºéœ€è¦åˆ†æ­¥æ“ä½œçš„åœºæ™¯ï¼Œä¾‹å¦‚è®¢å•ä¸­åˆ›å»ºè®¢å•å’Œè®¢å•é¡¹çš„æ“ä½œã€‚\né™¤äº†äº‹åŠ¡ä¼ æ’­æœºåˆ¶ï¼ŒSpringè¿˜æä¾›äº†äº‹åŠ¡éš”ç¦»çº§åˆ«å’Œè¶…æ—¶è®¾ç½®ç­‰äº‹åŠ¡ç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥æ›´åŠ ç»†ç²’åº¦åœ°æ§åˆ¶äº‹åŠ¡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©é€‚å½“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œ é¿å…æ•°æ®ä¸ä¸€è‡´ç­‰é—®é¢˜ï¼›ä¹Ÿå¯ä»¥è®¾ç½®äº‹åŠ¡è¶…æ—¶æ—¶é—´ï¼Œé¿å…é•¿æ—¶é—´å ç”¨æ•°æ®åº“èµ„æºã€‚\nSpringé…ç½®å£°æ˜å¼äº‹åŠ¡ #\ré…ç½®DataSource é…ç½®äº‹åŠ¡ç®¡ç†å™¨ äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§ é‚£äº›ç±»é‚£äº›æ–¹æ³•ä½¿ç”¨äº‹åŠ¡ DataSourceã€TransactionManagerè¿™ä¸¤éƒ¨åˆ†åªæ˜¯ä¼šæ ¹æ®æ•°æ®è®¿é—®æ–¹å¼æœ‰æ‰€å˜åŒ–ï¼Œæ¯”å¦‚ä½¿ç”¨Hibernateè¿›è¡Œæ•°æ®è®¿é—® æ—¶ï¼ŒDataSourceå®é™…ä¸ºSessionFactoryï¼ŒTransactionManagerçš„å®ç°ä¸º HibernateTransactionManagerã€‚\næ ¹æ®ä»£ç†æœºåˆ¶çš„ä¸åŒï¼ŒSpringäº‹åŠ¡çš„é…ç½®åˆæœ‰å‡ ç§ä¸åŒçš„æ–¹å¼ï¼š\nç¬¬ä¸€ç§æ–¹å¼ï¼šæ¯ä¸ªBeanéƒ½æœ‰ä¸€ä¸ªä»£ç† * ç¬¬äºŒç§æ–¹å¼ï¼šæ‰€æœ‰Beanå…±äº«ä¸€ä¸ªä»£ç†åŸºç±» * ç¬¬ä¸‰ç§æ–¹å¼ï¼šä½¿ç”¨æ‹¦æˆªå™¨ * ç¬¬å››ç§æ–¹å¼ï¼šä½¿ç”¨txæ ‡ç­¾é…ç½®çš„æ‹¦æˆªå™¨ * ç¬¬äº”ç§æ–¹å¼ï¼šå…¨æ³¨è§£ 1ã€springäº‹åŠ¡æ§åˆ¶æ”¾åœ¨serviceå±‚ï¼Œåœ¨serviceæ–¹æ³•ä¸­ä¸€ä¸ªæ–¹æ³•è°ƒç”¨serviceä¸­çš„å¦ä¸€ä¸ªæ–¹æ³•ï¼Œé»˜è®¤å¼€å¯å‡ ä¸ªäº‹åŠ¡ï¼Ÿ\nspringçš„äº‹åŠ¡ä¼ æ’­æ–¹å¼é»˜è®¤æ˜¯PROPAGATION_REQUIREDï¼Œåˆ¤æ–­å½“å‰æ˜¯å¦å·²å¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œæœ‰åˆ™åŠ å…¥å½“å‰äº‹åŠ¡ï¼Œå¦åˆ™æ–°å¼€ä¸€ä¸ªäº‹åŠ¡ï¼ˆå¦‚æœæ²¡æœ‰å°±å¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡ï¼‰ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡ã€‚\n2ã€spring ä»€ä¹ˆæƒ…å†µä¸‹è¿›è¡Œäº‹åŠ¡å›æ»šï¼Ÿ\nSpringã€EJBçš„å£°æ˜å¼äº‹åŠ¡é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯åœ¨æŠ›å‡ºunchecked exceptionåæ‰ä¼šè§¦å‘äº‹åŠ¡çš„å›æ»š\nuncheckedå¼‚å¸¸,å³è¿è¡Œæ—¶å¼‚å¸¸runntimeException å›æ»šäº‹åŠ¡;\ncheckedå¼‚å¸¸,å³Exceptionå¯try{}æ•è·çš„ä¸ä¼šå›æ»š.å½“ç„¶ä¹Ÿå¯é…ç½®springå‚æ•°è®©å…¶å›æ»š.\nspringçš„äº‹åŠ¡è¾¹ç•Œæ˜¯åœ¨è°ƒç”¨ä¸šåŠ¡æ–¹æ³•ä¹‹å‰å¼€å§‹çš„ï¼Œä¸šåŠ¡æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åæ¥æ‰§è¡Œcommit or rollback(Springé»˜è®¤å–å†³äºæ˜¯å¦æŠ›å‡ºruntimeå¼‚å¸¸). å¦‚æœæŠ›å‡ºruntime exception å¹¶åœ¨ä½ çš„ä¸šåŠ¡æ–¹æ³•ä¸­æ²¡æœ‰catchåˆ°çš„è¯ï¼Œäº‹åŠ¡ä¼šå›æ»šã€‚ ä¸€èˆ¬ä¸éœ€è¦åœ¨ä¸šåŠ¡æ–¹æ³•ä¸­catchå¼‚å¸¸ï¼Œå¦‚æœéè¦catchï¼Œåœ¨åšå®Œä½ æƒ³åšçš„å·¥ä½œåï¼ˆæ¯”å¦‚å…³é—­æ–‡ä»¶ç­‰ï¼‰ä¸€å®šè¦æŠ›å‡ºruntime exceptionï¼Œå¦åˆ™springä¼šå°†ä½ çš„æ“ä½œcommit,è¿™æ ·å°±ä¼šäº§ç”Ÿè„æ•°æ®.æ‰€ä»¥ä½ çš„catchä»£ç æ˜¯ç”»è›‡æ·»è¶³ã€‚\nMysqlä¸­æ•°æ®éš”ç¦»æœºåˆ¶ #\ræ•°æ®éš”ç¦»æœºåˆ¶ è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯» ä¸²è¡ŒåŒ– ä¸ä¼š ä¸ä¼š ä¸ä¼š å¯é‡å¤è¯» ä¸ä¼š ä¸ä¼š ä¼š è¯»å·²æäº¤ ä¸ä¼š ä¼š ä¼š è¯»æœªæäº¤ ä¼š ä¼š ä¼š æ­¤å¤–ï¼Œæ·»åŠ DEFAULT ä½¿ç”¨æ•°æ®åº“è®¾ç½®çš„éš”ç¦»çº§åˆ« ( é»˜è®¤ ) ï¼Œç”± DBA é»˜è®¤çš„è®¾ç½®æ¥å†³å®šéš”ç¦»çº§åˆ«.è¿™å°±ç»„æˆäº†Springçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶\næ³¨æ„ï¼š\nè„è¯» :æ‰€è°“çš„è„è¯»ï¼Œå…¶å®å°±æ˜¯è¯»åˆ°äº†åˆ«çš„äº‹åŠ¡å›æ»šå‰çš„è„æ•°æ®ã€‚æ¯”å¦‚äº‹åŠ¡Bæ‰§è¡Œè¿‡ç¨‹ä¸­ä¿®æ”¹äº†æ•°æ®Xï¼Œåœ¨æœªæäº¤å‰ï¼Œäº‹åŠ¡Aè¯»å–äº†Xï¼Œè€Œäº‹åŠ¡Bå´å›æ»šäº†ï¼Œè¿™æ ·äº‹åŠ¡Aå°±å½¢æˆäº†è„è¯»ã€‚\nä¸å¯é‡å¤è¯» ï¼šä¸å¯é‡å¤è¯»å­—é¢å«ä¹‰å·²ç»å¾ˆæ˜äº†äº†ï¼Œæ¯”å¦‚äº‹åŠ¡Aé¦–å…ˆè¯»å–äº†ä¸€æ¡æ•°æ®ï¼Œç„¶åæ‰§è¡Œé€»è¾‘çš„æ—¶å€™ï¼Œäº‹åŠ¡Bå°†è¿™æ¡æ•°æ®æ”¹å˜äº†ï¼Œç„¶åäº‹åŠ¡Aå†æ¬¡è¯»å–çš„æ—¶å€™ï¼Œå‘ç°æ•°æ®ä¸åŒ¹é…äº†ï¼Œå°±æ˜¯æ‰€è°“çš„ä¸å¯é‡å¤è¯»äº†ã€‚\nå¹»è¯»: äº‹åŠ¡Aé¦–å…ˆæ ¹æ®æ¡ä»¶ç´¢å¼•å¾—åˆ°10æ¡æ•°æ®ï¼Œç„¶åäº‹åŠ¡Bæ”¹å˜äº†æ•°æ®åº“ä¸€æ¡æ•°æ®ï¼Œå¯¼è‡´ä¹Ÿç¬¦åˆäº‹åŠ¡Aå½“æ—¶çš„æœç´¢æ¡ä»¶ï¼Œè¿™æ ·äº‹åŠ¡Aå†æ¬¡æœç´¢å‘ç°æœ‰11æ¡æ•°æ®äº†ï¼Œå°±äº§ç”Ÿäº†å¹»è¯»ã€‚\nè¯´ä¸€ä¸‹Javaé‡Œé¢ä½ è®¤è¯†çš„é” #\rä¹è§‚é”ï¼š\nä¹è§‚é”æ˜¯ä¸€ç§ä¹è§‚æ€æƒ³ï¼Œå³è®¤ä¸ºè¯»å¤šå†™å°‘ï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§ä½ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸º åˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•° æ®ï¼Œé‡‡å–åœ¨å†™æ—¶å…ˆè¯»å‡ºå½“å‰ç‰ˆæœ¬å·ï¼Œç„¶ååŠ é”æ“ä½œï¼ˆæ¯”è¾ƒè·Ÿä¸Šä¸€æ¬¡çš„ç‰ˆæœ¬å·ï¼Œå¦‚æœä¸€æ ·åˆ™æ›´æ–°ï¼‰ï¼Œ å¦‚æœå¤±è´¥åˆ™è¦é‡å¤è¯»-æ¯”è¾ƒ-å†™çš„æ“ä½œã€‚ java ä¸­çš„ä¹è§‚é”åŸºæœ¬éƒ½æ˜¯é€šè¿‡ CAS æ“ä½œå®ç°çš„ï¼ŒCAS æ˜¯ä¸€ç§æ›´æ–°çš„åŸå­æ“ä½œï¼Œæ¯”è¾ƒå½“å‰å€¼è·Ÿä¼ å…¥ å€¼æ˜¯å¦ä¸€æ ·ï¼Œä¸€æ ·åˆ™æ›´æ–°ï¼Œå¦åˆ™å¤±è´¥\næ‚²è§‚é”ï¼š\næ‚²è§‚é”æ˜¯å°±æ˜¯æ‚²è§‚æ€æƒ³ï¼Œå³è®¤ä¸ºå†™å¤šï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§é«˜ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äºº ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨è¯»å†™æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³è¯»å†™è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°æ‹¿åˆ°é”ã€‚ java ä¸­çš„æ‚²è§‚é”å°±æ˜¯ Synchronized,AQS æ¡†æ¶ä¸‹çš„é”åˆ™æ˜¯å…ˆå°è¯• cas ä¹è§‚é”å»è·å–é”ï¼Œè·å–ä¸åˆ°ï¼Œ æ‰ä¼šè½¬æ¢ä¸ºæ‚²è§‚é”ï¼Œå¦‚ RetreenLockã€‚\nè‡ªæ—‹é”ï¼š\nå¦‚æœæŒæœ‰é”çš„çº¿ç¨‹èƒ½åœ¨å¾ˆçŸ­æ—¶é—´å†…é‡Šæ”¾é”èµ„æºï¼Œé‚£ä¹ˆé‚£äº›ç­‰å¾…ç«äº‰é” çš„çº¿ç¨‹å°±ä¸éœ€è¦åšå†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´çš„åˆ‡æ¢è¿›å…¥é˜»å¡æŒ‚èµ·çŠ¶æ€ï¼Œå®ƒä»¬åªéœ€è¦ç­‰ä¸€ç­‰ï¼ˆè‡ªæ—‹ï¼‰ï¼Œ ç­‰æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”åå³å¯ç«‹å³è·å–é”ï¼Œè¿™æ ·å°±é¿å…ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çš„åˆ‡æ¢çš„æ¶ˆè€—ã€‚\nä¼˜ç‚¹ï¼šä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†çº¿ç¨‹é˜»å¡æ‹¥å µçš„æƒ…å†µ\nç¼ºç‚¹ï¼šcpuæ— ç”¨åŠŸ\nè®¡ç®—æœºç½‘ç»œTCP #\rè¯´ä¸€ä¸‹ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚è¿‡ç¨‹åŒ…å«çš„æ­¥éª¤ï¼Ÿ\nè¿›è¡ŒåŸŸåè§£æ å‘èµ·TCP3æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ å®¢æˆ·ç«¯å‘èµ·httpè¯·æ±‚ æœåŠ¡å™¨å“åº”è¯·æ±‚ï¼Œè¿”å›HTMLä»£ç  å®¢æˆ·ç«¯è§£æä»£ç ï¼Œå¹¶è¯·æ±‚HTMLä»£ç ä¸­åŒ…å«çš„èµ„æºã€JSã€CSSã€å›¾ç‰‡ç­‰ã€‘ æµè§ˆå™¨å¯¹é¡µé¢è¿›è¡Œæ¸²æŸ“ 4æ¬¡æŒ¥æ‰‹æ–­å¼€è¿æ¥ ä»€ä¹ˆæ˜¯dnsï¼Ÿ\nDNSå³åŸŸåç³»ç»Ÿï¼Œæ˜¯IPåœ°å€ä¸åŸŸåç›¸äº’æ˜ å°„çš„åˆ†å¸ƒå¼æ•°æ®åº“ã€‚ä¸»è¦åŠŸèƒ½æ˜¯åŸŸåè§£æï¼Œå³èƒ½æ ¹æ®åŸŸåè§£æå‡ºå¯¹åº”çš„IPåœ°å€ã€‚DNSå±äºåº”ç”¨å±‚åè®®ï¼Œä½¿ç”¨UDPè¿›è¡Œé€šä¿¡ã€‚\nä¸ºä»€ä¹ˆdnsä½¿ç”¨çš„æ˜¯udpåè®®ï¼Ÿ\nå› ä¸ºUDPå·¥ä½œæ–¹å¼ç®€å•æ–¹ä¾¿ï¼Œåªéœ€ä¸€æ¬¡è¯·æ±‚ã€ä¸€æ¬¡å“åº”å³å¯å®Œæˆè§£æå·¥ä½œã€‚ è€Œä½¿ç”¨TCPéœ€è¦ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ã€è¯·æ±‚ä¸åº”ç­”ã€å››æ¬¡æŒ¥æ‰‹ç­‰æ“ä½œï¼Œå¤æ‚ä¸”è€—æ—¶é•¿ã€‚ UDPä¼ è¾“å†…å®¹æœ€å¤§ä¸èƒ½è¶…è¿‡512å­—èŠ‚ï¼Œä½†æ˜¯å¯¹äºåŸŸåè§£ææ¥è¯´å·²ç»è¶³å¤Ÿã€‚\näº”å±‚åè®® ï¼šç‰©ç†å±‚ï¼Œæ•°æ®é“¾è·¯å±‚ï¼Œç½‘è·¯å±‚ï¼Œä¼ è¾“å±‚ï¼Œåº”ç”¨å±‚\nåœæ­¢ç­‰å¾…åè®®ä¿¡é“åˆ©ç”¨ç‡ï¼š\næ•°æ®åˆ†ç»„å‘é€æ—¶å»¶TD\nç¡®è®¤åˆ†ç»„å‘é€æ—¶å»¶TA\næ”¶å‘åŒæ–¹ï¼ˆå•ç¨‹å‘é€æ—¶å»¶x2ï¼‰RTT\nä¿¡é“åˆ©ç”¨ç‡=ï¼ˆTDï¼‰/(TD+RTT+TA)\nä¸ºäº†æå‡ä¿¡é“ä¼ è¾“æ•ˆç‡ï¼Œæ¥æ”¶æ–¹ä¸å¿…æ¯æ¬¡æ¥æ”¶æ•°æ®éƒ½å‘é€ACKæ¥æ”¶\nå›é€€Nå¸§åè®®ï¼ˆæ»‘åŠ¨çª—å£åè®®ï¼‰ï¼šä½¿ç”¨æŒ‡é’ˆåŠ¨æ€è°ƒæ•´çª—å£å¤§å°ï¼Œæ»‘åŠ¨å‘å‰æˆ–è€…å›é€€ï¼Œé™åˆ¶çª—å£å¤§å°ä¹‹ç±»çš„ å½“å‘ç°å‡ºé”™çš„æ•°æ®æ—¶å°†ä¼šé€€å›å·²å‘é€çš„Nä¸ªæ•°æ®åˆ†ç»„\nå‘ç”Ÿè¶…æ—¶é‡ä¼ ï¼Œæˆ–è€…æ¥æ”¶æ–¹æ¥æ”¶åˆ°è¯¯ç ä¸»åŠ¨ä¸¢å¼ƒéœ€è¦å‘é€æ–¹å†æ¬¡å‘é€ä¹‹åæ‰ä¼šç»§ç»­æ»‘åŠ¨çª—å£\nç½‘ç»œé€‚é…å™¨ï¼ˆç½‘å¡ï¼‰ï¼šå®ç°äº†ä¸²è¡Œé€šä¿¡å’Œå¹¶è¡Œé€šä¿¡çš„è½¬æ¢ï¼Œç½‘ç»œä¸ä¸»æœºï¼Œä¸»æœºå†…éƒ¨çš„é€šä¿¡æ˜¯å¹¶è¡Œé«˜é€Ÿé€šä¿¡ï¼Œä½†åˆ°è¾¾ç‰©ç†å±‚åº”è¯¥ä½¿ç”¨çš„ä¸²è¡Œé€šä¿¡åˆ°å±€åŸŸç½‘\nmacåœ°å€ï¼šç¡¬ä»¶åœ°å€æˆ–è€…å«ç‰©ç†åœ°å€ ï¼Œå›ºåŒ–åœ¨ç½‘å¡é‡Œé¢\nç½‘é™…åè®®ï¼ˆIPï¼‰ï¼šä½œä¸ºTCP/IPä½“ç³»ç»“æ„ç½‘ç»œå±‚é‡Œé¢çš„æ ¸å¿ƒåè®®-IPv4\né…å¥—çš„å››ä¸ªåè®®ï¼š\nåœ°å€è§£æåè®®ï¼Œé€†åœ°å€è§£æåè®®ï¼Œç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ï¼Œç½‘é™…ç»„ç®¡ç†åè®®\nIPv4åœ°å€ç¼–å€æ–¹å¼ï¼š\nåˆ†ç±»ç¼–å€ï¼š\nç½‘ç»œå·ï¼Œä¸»æœºå·ï¼Œåˆ†ä¸ºA-Eäº”ç±»\nè¯´æ˜çº¿ç¨‹å’Œè¿›ç¨‹ä¹‹é—´çš„åŒºåˆ« #\rè¿›ç¨‹æ˜¯æ‰§è¡Œçš„åº”ç”¨ç¨‹åºï¼Œçº¿ç¨‹æ˜¯è¿›ç¨‹å†…éƒ¨çš„æ‰§è¡Œåºåˆ—ï¼Œçº¿ç¨‹åˆç§°ä¸ºè½»é‡çº§è¿›ç¨‹\nåŒºåˆ«ï¼š\nè¿›ç¨‹ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œè¿›ç¨‹å†…çš„çº¿ç¨‹ç‹¬ç«‹å…±äº«ï¼Œè¿›ç¨‹å¤–åˆ™éš”ç¦» è¿›ç¨‹é—´é€šä¿¡IPCï¼Œçº¿ç¨‹ä¹‹é—´å¯ä»¥ç›´æ¥è¯»å†™ è¿›ç¨‹æ•°æ®æ®µå®ç°é€šä¿¡ çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ¯”è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ›´å¿« å¤šçº¿ç¨‹OSä¸­ï¼Œè¿›ç¨‹ä¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„å®ä½“ã€‚ çº¿ç¨‹çš„å‡ ä¸ªçŠ¶æ€ï¼š\nåŒæ­¥æ–¹æ³•å’ŒåŒæ­¥ä»£ç å—çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\nåŒæ­¥æ–¹æ³•é»˜è®¤ç”¨thisæˆ–è€…å½“å‰ç±»classå¯¹è±¡ä½œä¸ºé”ï¼› åŒæ­¥ä»£ç å—å¯ä»¥é€‰æ‹©ä»¥ä»€ä¹ˆæ¥åŠ é”ï¼Œæ¯”åŒæ­¥æ–¹æ³•è¦æ›´ç»†é¢—ç²’åº¦ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åªåŒæ­¥ä¼šå‘ç”ŸåŒæ­¥é—®é¢˜çš„éƒ¨åˆ†ä»£ç è€Œä¸æ˜¯æ•´ä¸ªæ–¹æ³•ï¼› åŒæ­¥æ–¹æ³•ä½¿ç”¨å…³é”®å­— synchronizedä¿®é¥°æ–¹æ³•ï¼Œè€ŒåŒæ­¥ä»£ç å—ä¸»è¦æ˜¯ä¿®é¥°éœ€è¦è¿›è¡ŒåŒæ­¥çš„ä»£ç ï¼Œç”¨ synchronizedï¼ˆobjectï¼‰{ä»£ç å†…å®¹}è¿›è¡Œä¿®é¥°ï¼›\nå…³äºäºŒå‰æ ‘\nå­˜å‚¨æ–¹å¼ï¼š\né“¾å¼å­˜å‚¨ï¼š çº¿æ€§å­˜å‚¨ï¼šç¬¬iæ­Œå…ƒç´ çš„å­èŠ‚ç‚¹-\u0026gt; å·¦å­©å­ä¸º2i+1,å³å­©å­ä¸º2i+2\n","date":"9 March 2024","externalUrl":null,"permalink":"/entire-note/%E9%9D%A2%E8%AF%95%E9%A2%98/%E9%9D%A2%E8%AF%95/","section":"Entire-Notes","summary":"åŸºç¡€çŸ¥è¯† #\rHashæ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›å¸¸è§çš„hashå®šå€æ³• #\ræ•£åˆ—è¡¨ç®—æ³•å¸Œæœ›èƒ½å°½é‡åšåˆ°ä¸ç»è¿‡ä»»ä½•æ¯”è¾ƒï¼Œé€šè¿‡ä¸€æ¬¡å­˜å–å°±èƒ½å¾—åˆ°æ‰€æŸ¥æ‰¾çš„æ•°æ®å…ƒç´  ï¼Œå› è€Œå¿… é¡»è¦åœ¨æ•°æ®å…ƒç´ çš„å­˜å‚¨ä½ç½®å’Œå®ƒçš„å…³é”®å­—ï¼ˆå¯ç”¨ key è¡¨ç¤ºï¼‰ä¹‹é—´å»ºç«‹ä¸€ä¸ªç¡®å®šçš„å¯¹åº”å…³ç³»ï¼Œä½¿æ¯ä¸ª å…³é”®å­—å’Œæ•£åˆ—è¡¨ä¸­ä¸€ä¸ªå”¯ä¸€çš„å­˜å‚¨ä½ç½®ç›¸å¯¹åº”ã€‚å› æ­¤åœ¨æŸ¥æ‰¾æ—¶ï¼Œåªè¦æ ¹æ®è¿™ä¸ªå¯¹åº”å…³ç³»æ‰¾åˆ°ç»™å®š å…³é”®å­—åœ¨æ•£åˆ—è¡¨ä¸­çš„ä½ç½®å³å¯ã€‚è¿™ç§å¯¹åº”å…³ç³»è¢«ç§°ä¸ºæ•£åˆ—å‡½æ•°(å¯ç”¨ h(key)è¡¨ç¤º)ã€‚\n1ï¼‰ç›´æ¥å®šå€æ³•ï¼š å–å…³é”®å­—æˆ–å…³é”®å­—çš„æŸä¸ªçº¿æ€§å‡½æ•°å€¼ä¸ºæ•£åˆ—åœ°å€ã€‚ å³ï¼šh(key) = key æˆ– h(key) = a * key + bï¼Œå…¶ä¸­ a å’Œ b ä¸ºå¸¸æ•°ã€‚ ï¼ˆ2ï¼‰æ•°å­—åˆ†ææ³• ï¼ˆ3ï¼‰å¹³æ–¹å–å€¼æ³•ï¼š å–å…³é”®å­—å¹³æ–¹åçš„ä¸­é—´å‡ ä½ä¸ºæ•£åˆ—åœ°å€ã€‚ ï¼ˆ4ï¼‰æŠ˜å æ³•ï¼šå°†å…³é”®å­—åˆ†å‰²æˆä½æ•°ç›¸åŒçš„å‡ éƒ¨åˆ†ï¼Œç„¶åå–è¿™å‡ éƒ¨åˆ†çš„å åŠ å’Œä½œä¸ºæ•£åˆ—åœ°å€ã€‚ ï¼ˆ5ï¼‰é™¤ç•™ä½™æ•°æ³•ï¼šå–å…³é”®å­—è¢«æŸä¸ªä¸å¤§äºæ•£åˆ—è¡¨è¡¨é•¿ m çš„æ•° p é™¤åæ‰€å¾—çš„ä½™æ•°ä¸ºæ•£åˆ—åœ°å€ï¼Œ å³ï¼šh(key) = key MOD p p â‰¤ m ï¼ˆ6ï¼‰éšæœºæ•°æ³•ï¼šé€‰æ‹©ä¸€ä¸ªéšæœºå‡½æ•°ï¼Œå–å…³é”®å­—çš„éšæœºå‡½æ•°å€¼ä¸ºå®ƒçš„æ•£åˆ—åœ°å€ï¼Œ å³ï¼šh(key) = random(key) ä»€ä¹ˆæ˜¯æ’åºäºŒå‰æ ‘ #\ré¦–å…ˆå¦‚æœæ™®é€šäºŒå‰æ ‘æ¯ä¸ªèŠ‚ç‚¹æ»¡è¶³ï¼šå·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å€¼å°äºå®ƒçš„æ ¹èŠ‚ç‚¹å€¼ï¼Œä¸”å³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹å€¼ å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹å€¼ï¼Œåˆ™è¿™æ ·çš„äºŒå‰æ ‘å°±æ˜¯æ’åºäºŒå‰æ ‘","title":"è®¡ç®—æœºç§‘å­¦åŸºç¡€","type":"entire-note"},{"content":"","date":"6 March 2024","externalUrl":null,"permalink":"/tags/nio/","section":"Tags","summary":"","title":"Nio","type":"tags"},{"content":"\ré€šè¿‡NIOéé˜»å¡å¼æ¨¡å‹æˆ‘ä»¬å¯ä»¥æ­å»ºä¸€ä¸ªReactor-SubReactor-Handlerçš„æ¶ˆæ¯æœåŠ¡å™¨ #\rnettyçš„ä¸‰å¤§åŸºæœ¬ç»„ä»¶æ˜¯ï¼šbufferï¼Œchannelï¼Œselector\nç›®çš„ï¼š\nä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨Selectoré€‰æ‹©å™¨å®ç°IOå¤šè·¯å¤ç”¨\nå…ˆæ¥ç¼–å†™ä¸€ä¸‹å®¢æˆ·ç«¯ï¼Œç®€å•èµ·è§ï¼Œåªéœ€è¦å»ºç«‹ä¸€ä¸ªSocketChannelè·å–ç®¡é“æµä¼ è¾“æ•°æ®\n/** * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ */ public class ClientReactor { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªæ–°çš„SocketChannelï¼Œä¸€ä¼šé€šè¿‡é€šé“è¿›è¡Œé€šä¿¡ try (SocketChannel channel =SocketChannel.open(newInetSocketAddress(\u0026#34;localhost\u0026#34;, 9000)); Scanner scanner = new Scanner(System.in)) { System.out.println(\u0026#34;å·²è¿æ¥åˆ°æœåŠ¡ç«¯ï¼\u0026#34;); while (true) { // å’±ç»™å®ƒå¥—ä¸ªæ— é™å¾ªç¯ï¼Œè¿™æ ·å°±èƒ½ä¸€ç›´å‘æ¶ˆæ¯äº† System.out.println(\u0026#34;è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); // ç›´æ¥å‘é€šé“ä¸­å†™å…¥æ•°æ® channel.write(ByteBuffer.wrap(text.getBytes(StandardCharsets.UTF_8))); System.out.println(\u0026#34;å·²å‘é€ï¼\u0026#34;); ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); // ç›´æ¥ä»é€šé“ä¸­è¯»å–æ•°æ® buffer.flip(); System.out.println(\u0026#34;æ”¶åˆ°æœåŠ¡å™¨è¿”å›ï¼š\u0026#34; + new String(buffer.array(), 0, buffer.remaining())); } } catch (IOException e) { throw new RuntimeException(e); } } } ç°åœ¨æ¥è€ƒè™‘ä¸€ä¸‹æœåŠ¡ç«¯æ¨¡å‹\nç”±äºæ˜¯ä¸»ä»æ¨¡å¼ï¼Œå…ˆæ˜¯æœ‰ä¸€ä¸ªä¸»Reactorä½œä¸ºè¯·æ±‚æ¥æ”¶å™¨ä»¶ï¼Œç„¶åå°†ä»»åŠ¡ä»£ç†ç»™Sub-Reactor\n","date":"6 March 2024","externalUrl":null,"permalink":"/entire-note/netty/","section":"Entire-Notes","summary":"é€šè¿‡NIOéé˜»å¡å¼æ¨¡å‹æˆ‘ä»¬å¯ä»¥æ­å»ºä¸€ä¸ªReactor-SubReactor-Handlerçš„æ¶ˆæ¯æœåŠ¡å™¨ #\rnettyçš„ä¸‰å¤§åŸºæœ¬ç»„ä»¶æ˜¯ï¼šbufferï¼Œchannelï¼Œselector\nç›®çš„ï¼š\nä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨Selectoré€‰æ‹©å™¨å®ç°IOå¤šè·¯å¤ç”¨\nå…ˆæ¥ç¼–å†™ä¸€ä¸‹å®¢æˆ·ç«¯ï¼Œç®€å•èµ·è§ï¼Œåªéœ€è¦å»ºç«‹ä¸€ä¸ªSocketChannelè·å–ç®¡é“æµä¼ è¾“æ•°æ®\n/** * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ */ public class ClientReactor { public static void main(String[] args) { // åˆ›å»ºä¸€ä¸ªæ–°çš„SocketChannelï¼Œä¸€ä¼šé€šè¿‡é€šé“è¿›è¡Œé€šä¿¡ try (SocketChannel channel =SocketChannel.open(newInetSocketAddress(\u0026#34;localhost\u0026#34;, 9000)); Scanner scanner = new Scanner(System.","title":"ä½¿ç”¨ä¸»ä»æ¨¡å¼æ­å»ºä¸€ä¸ªSocketç½‘ç»œé€šä¿¡æ¨¡å‹","type":"entire-note"},{"content":"","date":"5 March 2024","externalUrl":null,"permalink":"/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/","section":"Tags","summary":"","title":"å¾®æœåŠ¡","type":"tags"},{"content":"\råŸºäºSpringCloudAlibaba+Nacos+Feign+Seata+Sentinelä½œä¸ºå¾®æœåŠ¡è·¯çº¿å™è¿° #\rå‰è¨€ï¼šæœ¬æ¬¡SpringCloudå¾®æœåŠ¡å­¦ä¹ æ¶‰åŠNetFlixå’ŒAlibabaä¸¤ä¸åŒç‰ˆæœ¬ï¼Œä¸»è¦å¯¹åº”å…³ç³»ä¸ºï¼š\nå¾®æœåŠ¡åŸåˆ™ï¼šæ‰€æœ‰çš„æœåŠ¡éƒ½éœ€è¦ä¿è¯èŒè´£çš„å•ä¸€åŸåˆ™\nSpringCloudä½œä¸ºä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆï¼Œæ˜¯SOAçš„å»¶ç»­\nSpringCloud Alibaba æ˜¯éµå¾ªSpringCloudæ¥å¼€å‘çš„å¥—ä»¶ï¼ŒNacosäº¦ç„¶\næœåŠ¡æ³¨å†Œå’Œå‘ç° #\rEureka #\rEurekaèƒ½å¤Ÿè‡ªåŠ¨æ³¨å†Œå¹¶å‘ç°å¾®æœåŠ¡ï¼Œç„¶åå¯¹æœåŠ¡çš„çŠ¶æ€ã€ä¿¡æ¯è¿›è¡Œé›†ä¸­ç®¡ç†ï¼Œè¿™æ ·å½“æˆ‘ä»¬éœ€è¦è·å–å…¶ä»–æœåŠ¡çš„ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å‘Eurekaè¿›è¡ŒæŸ¥è¯¢å°±å¯ä»¥äº†ã€‚\né€šè¿‡EurekaæœåŠ¡å™¨è¿›è¡ŒæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œå®ƒçš„è´Ÿè½½å‡è¡¡åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå®é™…ä¸Šä¹‹å‰æ¼”ç¤ºçš„è´Ÿè½½å‡è¡¡æ˜¯ä¾é LoadBalancerå®ç°çš„ã€‚\nåœ¨2020å¹´å‰çš„SpringCloudç‰ˆæœ¬æ˜¯é‡‡ç”¨Ribbonä½œä¸ºè´Ÿè½½å‡è¡¡å®ç°ï¼Œä½†æ˜¯2020å¹´çš„ç‰ˆæœ¬ä¹‹åSpringCloudæŠŠRibbonç§»é™¤äº†ï¼Œè¿›è€Œç”¨è‡ªå·±ç¼–å†™çš„LoadBalanceræ›¿ä»£ã€‚\nå¦‚ä½•æ‰¾åˆ°æœåŠ¡ï¼Ÿ\nNacos #\rNacosæ³¨å†Œä¸­å¿ƒ #\råŠŸèƒ½ï¼š\næœåŠ¡æ³¨å†Œå‘ç° é…ç½®ä¸­å¿ƒ æœåŠ¡å…ƒæ•°æ®/å®ä¾‹å…ƒæ•°æ®ï¼šå¯ä»¥ç”¨äºæµé‡æ§åˆ¶ï¼ˆåœ¨å®ä¾‹çš„metadataï¼ˆå…ƒæ•°æ®ï¼‰ä¸­åŠ ä¸Šæ ‡ç­¾ä¿¡æ¯ã€‚é€šè¿‡IRuleè·å–Serveråˆ—è¡¨å¹¶æ ¹æ®è¿™äº›Serverä¸­å…ƒæ•°æ®çš„æ ‡ç­¾ä¿¡æ¯å†³å®šè·¯ç”±æƒ…å†µï¼‰ å±€åŸŸç½‘å†…æœåŠ¡ä¿¡æ¯ä¼ è¾“å¿« æœåŠ¡é›†ç¾¤åˆ†çº§æ¨¡å¼\næœåŠ¡-é›†ç¾¤-å®ä¾‹\nä¿®æ”¹ymlï¼š\nspring: cloud: nacos: server-addr: localhost:8848 discovery: cluster-name: ClUSTER-01 å¯¹æŒ‡å®šæœåŠ¡è¿›è¡Œé…ç½®\nå¿…é¡»é‡å†™è´Ÿè½½å‡è¡¡çš„è½®è¯¢è§„åˆ™æ‰å¯ä»¥æ”¹å˜è´Ÿè½½å‡è¡¡è§„åˆ™ï¼ˆå®ç°æ–¹å¼ä¸ºæ³¨å…¥Beanæˆ–ymlé…ç½®ï¼‰\n@Configuration @LoadBalancerClient(value = \u0026#34;userservice\u0026#34;, //æŒ‡å®šä¸º userservice æœåŠ¡ï¼Œåªè¦æ˜¯è°ƒç”¨æ­¤æœåŠ¡éƒ½ä¼šä½¿ç”¨æˆ‘ä»¬æŒ‡å®šçš„ç­–ç•¥ configuration = LoadBalancerConfig.class) //æŒ‡å®šæˆ‘ä»¬åˆšåˆšå®šä¹‰å¥½çš„é…ç½®ç±» public class BeanConfig { @Bean @LoadBalanced RestTemplate template(){ return new RestTemplate(); } } è¿™æ ·å­å°±å®ç°äº†å¯¹æœåŠ¡çš„æŒ‡å®šè´Ÿè½½å‡è¡¡ç­–ç•¥é…ç½®\né›†ç¾¤ä¼˜å…ˆ\nNacosä¼˜å…ˆè®¿é—®æœ¬åœ°é›†ç¾¤ï¼Œå½“æœ¬åœ°é›†ç¾¤å®•æœºæ—¶ï¼Œä¼šå‘ç”Ÿè·¨é›†ç¾¤è®¿é—®ï¼Œç¡®å®šå®ä¾‹ä¹‹åï¼Œä¼šåœ¨æœ¬åœ°å®ä¾‹ä¸­éšæœºè½®è¯¢\næƒé‡è´Ÿè½½å‡è¡¡\nå’ŒNginxå·®ä¸å¤šï¼Œé€šè¿‡æ›´æ”¹é›†ç¾¤ä¸­å®ä¾‹æƒé‡æ”¹å˜è´Ÿè½½ç­–ç•¥\nåˆ©ç”¨ï¼šå°†æœåŠ¡å®ä¾‹æƒé‡è°ƒä¸º0~0.01,æ”¾å…¥å°‘é‡è¯·æ±‚å®ç°æœåŠ¡å‡çº§\nç¯å¢ƒéš”ç¦»\nnamespace\nç›¸å…³åº¦é«˜æ—¶å¯ä»¥æ”¾å…¥åŒä¸€ç»„\nä¸åŒnamespaceä¹‹é—´ä¸å¯é€šè¿‡RPCç›¸äº’è°ƒç”¨ï¼\nå¿ƒè·³æ£€æµ‹\nä¸´æ—¶å®ä¾‹æŒ‚æ‰ç›´æ¥å‰”é™¤ï¼Œéä¸´æ—¶å®ä¾‹ï¼ˆä¸»åŠ¨æ£€æµ‹ï¼‰æŒ‚æ‰æ—¶ï¼ŒNacoså°†ä¼šè¯¢é—®å¥åº·çŠ¶å†µï¼ŒåŒæ—¶æŒ‚èµ·ç›´åˆ°å®ä¾‹é‡å¯ï¼ŒåŒæ—¶ä¸»åŠ¨å‘é€æœåŠ¡å®ä¾‹å˜æ›´æ¶ˆæ¯ ç»™æœåŠ¡è°ƒç”¨æ–¹ã€‚Nacosé‡‡ç”¨CPï¼ŒEurekaé‡‡ç”¨AP\nNacosé…ç½®ç®¡ç† #\rData-IDï¼šServiceName-dev/pro.yaml\nä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-nacos-config\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ä¸€èˆ¬åªåœ¨æœ‰çƒ­æ›´æ–°éœ€æ±‚çš„é…ç½®åŠ å…¥ Nacosé…ç½®ä¸­å¿ƒ\nç»Ÿä¸€é…ç½®ç®¡ç†\næ·»åŠ bootstrap.yml\nå®ç°çƒ­æ›´æ–°\næ³¨è§£@Refreshed\né…ç½®æ–‡ä»¶æ ¹æ®ä¸åŒç¯å¢ƒï¼Œå…·æœ‰å…±äº«é…ç½®å’Œdev/testé…ç½®æ–‡ä»¶ç­‰ï¼Œé…ç½®ä¼˜å…ˆçº§ä¸ºè¿œç«¯\u0026gt;æœåŠ¡å\u0026gt;æœ¬åœ°ç¯å¢ƒ\nç»Ÿä¸€é…ç½®ä¸­å¿ƒ\nä½œä¸ºè¿œç«¯é…ç½®ç»Ÿä¸€ç®¡ç†ï¼Œæœ¬åœ°å¯ä»¥ç›´æ¥fetchç„¶åä½¿ç”¨ï¼Œæé«˜ç»´æŠ¤æ€§\nä¾èµ–ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-config\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-bootstrap\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; è´Ÿè½½å‡è¡¡ #\rSpringå®ç°äº†ä¸€å¥—è‡ªå·±çš„è´Ÿè½½å‡è¡¡LoadBalancer. å®é™…ä¸Šåœ¨è¿›è¡Œè´Ÿè½½å‡è¡¡çš„æ—¶å€™ï¼Œä¼šå‘Eurekaå‘èµ·è¯·æ±‚ï¼Œé€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„å¯¹åº”æœåŠ¡ï¼Œç„¶åä¼šè¿”å›æ­¤æœåŠ¡çš„ä¸»æœºåœ°å€ç­‰ä¿¡æ¯,ç„¶åæ‰è¿›è¡Œå®é™…çš„æœåŠ¡è°ƒç”¨ã€‚\nè´Ÿè½½å‡è¡¡ç­–ç•¥\nè½®è¯¢ç­–ç•¥ æƒé‡ç­–ç•¥ éšæœºç­–ç•¥ æœ€å°è¿æ¥æ•°ç­–ç•¥ï¼ˆé€‰æ‹©è¿æ¥æ•°æœ€å°çš„çš„æœåŠ¡å®ä¾‹ï¼‰ é‡è¯•ç­–ç•¥ï¼ˆå½“æœåŠ¡å®ä¾‹å°è¯•å¤±è´¥ä¹‹åï¼Œå°è¯•ç»§ç»­è·å–ï¼Œè‹¥å¤šæ¬¡å¤±è´¥è¿”å›nullï¼‰ å¯ç”¨æ€§æ•æ„Ÿç­–ç•¥ï¼ˆéšæœºè½®è¯¢ï¼Œåˆ¤æ–­æ˜¯å¦å¯ç”¨ï¼‰ åŒºåŸŸæ•æ„Ÿç­–ç•¥ï¼ˆå¯ç”¨å’Œä¸å¯ç”¨ç›¸äº’çš„åˆ†åŒºä¸­é€‰å–å¯ç”¨åˆ†åŒºä¸­çš„å®ä¾‹ï¼‰ é™æµæ–¹æ¡ˆ\nGuava RateLimiterï¼šåŸºäºä»¤ç‰Œæ¡¶ç®—æ³•é™æµï¼Œå•æœºçš„ã€‚ Sentinelï¼šåŸºäºæ»‘åŠ¨çª—å£ã€æ¼æ¡¶ã€ä»¤ç‰Œæ¡¶é™æµï¼Œæ”¯æŒå•æœºï¼Œä¹Ÿæ”¯æŒé›†ç¾¤ã€‚ Redission RateLimiterï¼šä»¤ç‰Œæ¡¶ï¼Œæ”¯æŒå•æœºï¼Œä¹Ÿæ”¯æŒé›†ç¾¤ã€‚ æ·»åŠ ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-loadbalancer\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥ LoadBalanceré»˜è®¤æä¾›äº†ä¸¤ç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š\nRandomLoadBalancer - éšæœºåˆ†é…ç­–ç•¥ (é»˜è®¤) RoundRobinLoadBalancer - è½®è¯¢åˆ†é…ç­–ç•¥\næœåŠ¡åç§°-ã€‹ LoadBalancerInterceptor-\u0026gt; execute -ã€‹ é€šè¿‡è½®è¯¢è§„åˆ™é€‰æ‹©æœåŠ¡ -ã€‹è¿”å›æœåŠ¡åç§°ä»¥ä¾›è°ƒç”¨\nRibbionæ‡’åŠ è½½\u0026amp;é¥¥é¥¿åŠ è½½\nç¬¬ä¸€æ¬¡åŠ è½½è€—æ—¶å¾ˆé•¿ï¼Œç„¶åå°†æ•°æ®ç¼“å­˜\né…ç½®é¥¥é¥¿åŠ è½½\nribbon: eager-load: enabled: true clients: -service1 -service2 RPCè¿œç¨‹è°ƒç”¨ #\rFeignå’ŒRestTemplateä¸€æ ·ï¼Œä¹Ÿæ˜¯HTTPå®¢æˆ·ç«¯è¯·æ±‚å·¥å…·ï¼Œä½†æ˜¯å®ƒçš„ä½¿ç”¨æ–¹å¼æ›´åŠ ä¾¿æ·ã€‚é¦–å…ˆæ˜¯ä¾èµ–ï¼š\nä¸åŒäºRestTemplate,Feignæ˜¯è‡ªåŠ¨é›†æˆRibbonçš„ï¼ŒåŒæ—¶é»˜è®¤ä¸é‡è¯•\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-openfeign\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; feigné…ç½®éƒ¨åˆ†ï¼š\næ·»åŠ æ¥å£ï¼š\n@FeignClient(\u0026#34;cloud_service\u0026#34;) public interface RoleClient { // List\u0026lt;Role\u0026gt; listRole=restTemplate.getForObject(\u0026#34;http://localhost:8066/cache/role/list?key=\u0026#34;+key,List.class); @GetMapping List\u0026lt;Role\u0026gt; getRoleCache(@RequestParam String key); } æ€§èƒ½ä¼˜åŒ–è§£å†³æ–¹æ¡ˆ\nä½¿ç”¨HTTPè¿æ¥æ±  å…³é—­æ—¥å¿— @FeignClient(\u0026#34;cloud_service\u0026#34;) public interface RoleClient { @GetMapping List\u0026lt;Role\u0026gt; getRoleCache(@RequestParam String key); } Feignçš„æœ€ä½³å®è·µæ–¹å¼\nç»§æ‰¿æ–¹å¼ RPCåˆ°è¾¾controllerï¼Œå£°æ˜æ–¹å¼å’Œcontrollerå¿…é¡»ä¸€æ ·ï¼Œæ³¨æ„å®é™…å¼€å‘åœ¨Feignè°ƒç”¨ä¸­å¯èƒ½ä¼šå¯¹è¯·æ±‚å¤´ä¸­åŠ å…¥ç›¸å…³çš„é‰´æƒä¿¡æ¯\nä¸€èˆ¬ä¸æ¨èç»§æ‰¿æ–¹å¼ï¼Œå› ä¸ºå®šä¹‰äº†åŒä¸€æ¥å£ï¼Œé€ æˆäº†ç´§è€¦åˆ\næŠ½å–Feign ç‹¬ç«‹å‡ºfeign-apiï¼Œæ¨¡å— è´Ÿè´£å®ä½“ï¼Œé…ç½®ç­‰æœåŠ¡\næœåŠ¡ç½‘å…³ #\rç»Ÿä¸€ç½‘å…³GateWay(åŸºäºWebFluxå®ç°ï¼Œæœ‰å“åº”å¼ç¼–ç¨‹çš„ä¼˜åŠ¿)\næœåŠ¡ç½‘å…³æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­ä¸€ä¸ªéå¸¸å…³é”®çš„è§’è‰²ï¼Œä½œä¸ºåç«¯æœåŠ¡çš„ç»Ÿä¸€å…¥å£ï¼Œè´Ÿè´£ç»Ÿç­¹å’Œç®¡ç†åç«¯æœåŠ¡ã€‚èƒ½å¤Ÿæä¾›çš„åŠŸèƒ½æœ‰è·¯ç”±åŠŸèƒ½ã€ è´Ÿè½½å‡è¡¡ã€å®‰å…¨è®¤è¯ã€æµé‡æŸ“è‰²ã€ç°åº¦å‘å¸ƒã€é™æµç†”æ–­ã€åè®®è½¬æ¢ã€æ—¥å¿—æ”¶é›†ç­‰\nåŸºæœ¬ä½œç”¨ï¼šè®¤è¯ï¼Œæ ¡éªŒï¼Œè·¯ç”±å¾®æœåŠ¡è¯·æ±‚ï¼Œè´Ÿè½½å‡è¡¡ï¼Œé™æµ,è·¯ç”±è¿‡æ»¤å™¨\nå·¥ä½œåŸç†ï¼š\nå®¢æˆ·ç«¯å‘Spring Cloud Gatewayå‘å‡ºè¯·æ±‚ã€‚ç„¶ååœ¨Gateway Handler Mappingä¸­æ‰¾åˆ°ä¸è¯·æ±‚ç›¸åŒ¹é…çš„è·¯ç”±ï¼Œ å°†å…¶å‘é€åˆ°Gateway Web Handlerã€‚Gateway Web Handlerå†é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾æ¥å°†è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬å®é™…çš„æœåŠ¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ã€‚\né…ç½®æ–¹æ³•ï¼š\n\u0026lt;!-- å¼•å…¥Gateway --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-gateway\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; spring: cloud: gateway: routes: - id: auth-center uri: lb://auth-center #åŠ ä¸Šlbä»£è¡¨è´Ÿè½½å‡è¡¡ predicates: - Path=/oauth #è°“è¯åˆ¤æ–­ä¾æ® lbï¼šå›ºå®šæ ¼å¼ï¼ŒæŒ‡çš„æ˜¯ä»Nacosä¸­æŒ‰ç…§åç§°è·å–å¾®æœåŠ¡ï¼Œå¹¶éµå¾ªè´Ÿè½½å‡è¡¡ç­–ç•¥ service-nameï¼šNacosæ³¨å†Œä¸­å¿ƒçš„æœåŠ¡åç§° é€šè¿‡é‡å†™è¿‡æ»¤å™¨å®ç°è‡ªå®šä¹‰GateWayè¿‡æ»¤å™¨\næ–­è¨€ï¼š\nç®€å•æ¶æ„ï¼š\næ­å»ºç½‘å…³\né€‚é…å™¨æ¨¡å¼ï¼šå°†å¤šä¸ªä¸åŒçš„æ¥å£å®ç°é¡¶çº§ï¼Œå˜æˆå¸Œæœ›çš„ç±»æˆ–è€…å±æ€§\nè¿‡æ»¤å™¨æ‰§è¡Œé¡ºåºï¼š\nè£…é¥°è€…æ¨¡å¼\nç½‘å…³è·¨åŸŸé—®é¢˜ï¼š\nå®é™…ä¸Šå°±æ˜¯RPCçš„codecå±‚é¢\næ–­è·¯å™¨ #\rå¾®æœåŠ¡å­˜åœ¨é›ªå´©é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªå¾®æœåŠ¡å‡ºç°é—®é¢˜ï¼Œæœ‰å¯èƒ½å¯¼è‡´æ•´ä¸ªé“¾è·¯ç›´æ¥ä¸å¯ç”¨ï¼Œè¿™ç§æ—¶å€™æˆ‘ä»¬å°±éœ€è¦è¿›è¡ŒåŠæ—¶çš„ç†”æ–­å’Œé™çº§\nHystrix #\rHystrixæ–­è·¯å™¨ï¼Œå·²ç»åœæ­¢ç»´æŠ¤\nä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-hystrix\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.10.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æœåŠ¡å¤±è´¥è½¬ä¸ºæœåŠ¡é™çº§ï¼Œè€Œåå½“æœåŠ¡å¤šæ¬¡è°ƒç”¨å¤±è´¥åï¼Œå°†ä¼šå‘ç”ŸæœåŠ¡ç†”æ–­\nSentinel #\réšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚Sentinel ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œ ä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-sentinel\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; å¯ä»¥å®ç°çš„ç›‘æ§äº‹é¡¹æœ‰ï¼š\næ—¶é—´ç‚¹ã€QPS(æ¯ç§’æŸ¥è¯¢ç‡)ã€å“åº”æ—¶é—´ç­‰æ•°æ®ã€‚\nä¸‰ç§é™æµç­–ç•¥\næ–¹æ¡ˆä¸€ï¼šå¿«é€Ÿæ‹’ç»ï¼Œæ—¢ç„¶ä¸å†æ¥å—æ–°çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªæ‹’ç»ä¿¡æ¯ï¼Œå‘Šè¯‰ç”¨æˆ·è®¿é—®é¢‘ç‡è¿‡é«˜ã€‚ æ–¹æ¡ˆäºŒï¼šé¢„çƒ­ï¼Œä¾ç„¶åŸºäºæ–¹æ¡ˆä¸€ï¼Œä½†æ˜¯ç”±äºæŸäº›æƒ…å†µä¸‹é«˜å¹¶å‘è¯·æ±‚æ˜¯åœ¨æŸä¸€æ—¶åˆ»çªç„¶åˆ°æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç¼“æ…¢åœ°å°†é˜ˆå€¼æé«˜åˆ°æŒ‡å®šé˜ˆå€¼ï¼Œå½¢æˆä¸€ä¸ªç¼“å†²ä¿æŠ¤ã€‚ æ–¹æ¡ˆä¸‰ï¼šæ’é˜Ÿç­‰å¾…ï¼Œä¸æ¥å—æ–°çš„è¯·æ±‚ï¼Œä½†æ˜¯ä¹Ÿä¸ç›´æ¥æ‹’ç»ï¼Œè€Œæ˜¯è¿›é˜Ÿåˆ—å…ˆç­‰ä¸€ä¸‹ï¼Œå¦‚æœè§„å®šæ—¶é—´å†…èƒ½å¤Ÿæ‰§è¡Œï¼Œé‚£ä¹ˆå°±æ‰§è¡Œï¼Œè¦æ˜¯è¶…æ—¶å°±ç®—äº†ã€‚ æµé‡é˜ˆå€¼çš„åˆ¤æ–­ï¼Œè¿™é‡Œæˆ‘ä»¬æ4ç§ç®—æ³•ï¼š\næ¼æ¡¶ç®—æ³•ï¼Œä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œå›ºå®šæ—¶é—´çª—å£ç®—æ³•ï¼Œæ»‘åŠ¨æ—¶é—´çª—å£ç®—æ³•\né™æµæ—¶ï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œå¯ä»¥æœ‰æ›¿ä»£æ–¹æ¡ˆï¼›\næ³¨è§£:\n@SentinelResource(value = \u0026#34;test\u0026#34;, fallback = \u0026#34;except\u0026#34;, //fallbackæŒ‡å®šå‡ºç°å¼‚å¸¸æ—¶çš„æ›¿ä»£æ–¹æ¡ˆ exceptionsToIgnore = IOException.class) æ€è€ƒï¼š æœåŠ¡é™çº§æ—¶ï¼Œæ–°æ¥çš„è¯·æ±‚å°±ä¼šå¯¼è‡´çº¿ç¨‹æ•°ä¸æ–­åœ°å¢åŠ ï¼Œè¿™æ ·ï¼ŒCPUçš„èµ„æºå¾ˆå¿«å°±ä¼šè¢«è€—å°½ã€‚\nè§£å†³åŠæ³•ï¼š\nå¯¹feignå¼€å¯æ–­è·¯å™¨\nfeign: sentinel: enabled: true åˆ†å¸ƒå¼äº‹åŠ¡ #\rå•ç‚¹ç™»å½• #\rå‚è€ƒæ–‡ç« ï¼š\rSpringSecurity-OauthåŸºäºSpring3.x\nåè¯è§£é‡Šï¼ˆUAï¼‰ï¼šuser account and authentication\nè¯·æ±‚æµç¨‹å›¾ï¼š\nå®¢æˆ·ç«¯æ¨¡å¼ï¼š\nå¯†ç æ¨¡å¼ï¼š\néšå¼æˆæƒæ¨¡å¼\næˆæƒç æ¨¡å¼ï¼ˆç›®å‰é‡‡ç”¨çš„ä¸»æµæ–¹æ¡ˆï¼‰ï¼š\nç¬¬ä¸‰æ–¹ç™»å½•Oauth2ç¤ºæ„å›¾ï¼š\nä½¿ç”¨jwtå­˜å‚¨Token\nå®˜ç½‘ï¼šhttps://jwt.io\nJSON Web Tokenä»¤ç‰Œï¼ˆJWTï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼ˆRFC 7519ï¼‰ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘å’Œè‡ªæˆä¸€ä½“çš„æ–¹å¼ï¼Œç”¨äºåœ¨å„æ–¹ä¹‹é—´ä½œä¸ºJSONå¯¹è±¡å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚ JWTå¯ä»¥ä½¿ç”¨å¯†é’¥ï¼ˆä½¿ç”¨HMACç®—æ³•ï¼‰æˆ–ä½¿ç”¨RSAæˆ–ECDSAè¿›è¡Œå…¬é’¥/ç§é’¥å¯¹è¿›è¡Œç­¾åã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯æºå¸¦Tokenå‘èµ„æºæœåŠ¡å™¨å‘èµ·è¯·æ±‚åï¼Œèµ„æºæœåŠ¡å™¨ç”±äºä¸çŸ¥é“æˆ‘ä»¬Tokençš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥éœ€è¦å‘éªŒè¯æœåŠ¡å™¨è¯¢é—®æ­¤Tokençš„è®¤è¯ä¿¡æ¯ï¼Œ è¿™æ ·æ‰èƒ½å¾—åˆ°Tokenä»£è¡¨çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯å„ä½æ˜¯å¦è€ƒè™‘è¿‡ï¼Œå¦‚æœæ¯æ¬¡ç”¨æˆ·è¯·æ±‚éƒ½å»æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œé‚£ä¹ˆåœ¨å¤§é‡è¯·æ±‚ä¸‹ï¼ŒéªŒè¯æœåŠ¡å™¨çš„å‹åŠ›å¯èƒ½ä¼šéå¸¸çš„å¤§ã€‚è€Œä½¿ç”¨JWTä¹‹åï¼ŒTokenä¸­ä¼šç›´æ¥ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œ è¿™æ ·èµ„æºæœåŠ¡å™¨å°±ä¸å†éœ€è¦è¯¢é—®éªŒè¯æœåŠ¡å™¨ï¼Œè‡ªè¡Œå°±å¯ä»¥å®Œæˆè§£æï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¸è”ç³»éªŒè¯æœåŠ¡å™¨å°±èƒ½ç›´æ¥å®ŒæˆéªŒè¯ã€‚ ä¸€ä¸ªJWTä»¤ç‰Œç”±3éƒ¨åˆ†ç»„æˆï¼šæ ‡å¤´(Header)ã€æœ‰æ•ˆè½½è·(Payload)å’Œç­¾å(Signature)ã€‚åœ¨ä¼ è¾“çš„æ—¶å€™ï¼Œä¼šå°†JWTçš„3éƒ¨åˆ†åˆ†åˆ«è¿›è¡ŒBase64ç¼–ç åç”¨.è¿›è¡Œè¿æ¥å½¢æˆæœ€ç»ˆéœ€è¦ä¼ è¾“çš„å­—ç¬¦ä¸²ã€‚ æ ‡å¤´ï¼šåŒ…å«ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚JWTç­¾åæ‰€ä½¿ç”¨çš„åŠ å¯†ç®—æ³•ï¼Œè¿˜æœ‰ç±»å‹ï¼Œè¿™é‡Œç»Ÿä¸€éƒ½æ˜¯JWTã€‚ æœ‰æ•ˆè½½è·ï¼šåŒ…æ‹¬ç”¨æˆ·åç§°ã€ä»¤ç‰Œå‘å¸ƒæ—¶é—´ã€è¿‡æœŸæ—¶é—´ã€JWT IDç­‰ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ·»åŠ å­—æ®µï¼Œæˆ‘ä»¬çš„ç”¨æˆ·ä¿¡æ¯ä¸€èˆ¬éƒ½åœ¨è¿™é‡Œå­˜æ”¾ã€‚ ç­¾åï¼šé¦–å…ˆéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼Œè¯¥å¯†é’¥ä»…ä»…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œä¿è¯ä¸èƒ½è®©å…¶ä»–ç”¨æˆ·çŸ¥é“ã€‚ç„¶åä½¿ç”¨Headerä¸­æŒ‡å®šçš„ç®—æ³•å¯¹Headerå’ŒPayloadè¿›è¡Œbase64åŠ å¯†ä¹‹åçš„ç»“æœé€šè¿‡å¯†é’¥è®¡ç®—å“ˆå¸Œå€¼ï¼Œç„¶åå°±å¾—å‡ºä¸€ä¸ªç­¾åå“ˆå¸Œã€‚è¿™ä¸ªä¼šç”¨äºä¹‹åéªŒè¯å†…å®¹æ˜¯å¦è¢«ç¯¡æ”¹ã€‚ Base64ï¼ˆä¸æ˜¯åŠ å¯†ç®—æ³•è€Œæ˜¯ç¼–ç æ–¹å¼ï¼‰ï¼š å°±æ˜¯åŒ…æ‹¬å°å†™å­—æ¯a-zã€å¤§å†™å­—æ¯A-Zã€æ•°å­—0-9ã€ç¬¦å·\u0026#34;+\u0026#34;ã€\u0026#34;/\u0026#34;ä¸€å…±64ä¸ªå­—ç¬¦çš„å­—ç¬¦é›†ï¼ˆæœ«å°¾è¿˜æœ‰1ä¸ªæˆ–å¤šä¸ª=ç”¨æ¥å‡‘å¤Ÿå­—èŠ‚æ•°ï¼‰ï¼Œä»»ä½•çš„ç¬¦å·éƒ½å¯ä»¥è½¬æ¢æˆè¿™ä¸ªå­—ç¬¦é›†ä¸­çš„å­—ç¬¦ï¼Œ è¿™ä¸ªè½¬æ¢è¿‡ç¨‹å°±å«åšBase64ç¼–ç ï¼Œç¼–ç ä¹‹åä¼šç”ŸæˆåªåŒ…å«ä¸Šè¿°64ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ç›¸åï¼Œå¦‚æœéœ€è¦åŸæœ¬çš„å†…å®¹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›è¡ŒBase64è§£ç ï¼Œå›åˆ°åŸæœ‰çš„æ ·å­ã€‚ åŠ å¯†ç®—æ³•ï¼š åŠ å¯†ç®—æ³•åˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œå…¶ä¸­**å¯¹ç§°åŠ å¯†ï¼ˆSymmetric Cryptographyï¼‰**æ¯”è¾ƒå¥½ç†è§£ï¼Œå°±åƒä¸€æŠŠé”é…äº†ä¸¤æŠŠé’¥åŒ™ä¸€æ ·ï¼Œè¿™ä¸¤æŠŠé’¥åŒ™ä½ å’Œåˆ«äººéƒ½æœ‰ä¸€æŠŠï¼Œç„¶åä½ ä»¬ç›´æ¥ä¼ é€’æ•°æ®ï¼Œéƒ½ä¼šæŠŠæ•°æ®ç”¨é”ç»™é”ä¸Šï¼Œ å°±ç®—ä¼ é€’çš„é€”ä¸­æœ‰äººæŠŠæ•°æ®çªƒå–äº†ï¼Œä¹Ÿæ²¡åŠæ³•è§£å¯†ï¼Œå› ä¸ºé’¥åŒ™åªæœ‰ä½ å’Œå¯¹æ–¹æœ‰ï¼Œæ²¡æœ‰é’¥åŒ™æ— æ³•è¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯è¿™æ ·æœ‰ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶è§£å¯†çš„å…³é”®åœ¨äºé’¥åŒ™æœ¬èº«ï¼Œé‚£ä¹ˆå¦‚æœæœ‰äººä¸ä»…çªƒå–äº†æ•°æ®ï¼Œè€Œä¸”å¯¹æ–¹é‚£è¾¹çš„æ²»å®‰ä¹Ÿä¸å¥½ï¼Œ äºæ˜¯é¡ºæ‰‹å°±å·èµ°äº†é’¥åŒ™ï¼Œé‚£ä½ ä»¬ä¹‹é—´å‘çš„æ•°æ®ä¸å°±å‡‰å‡‰äº†å—ã€‚ å› æ­¤ï¼Œ**éå¯¹ç§°åŠ å¯†ï¼ˆAsymmetric Cryptographyï¼‰**ç®—æ³•å‡ºç°äº†ï¼Œå®ƒå¹¶ä¸æ˜¯ç›´æ¥ç”Ÿæˆä¸€æŠŠé’¥åŒ™ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼Œç§é’¥åªèƒ½ç”±ä½ ä¿ç®¡ï¼Œè€Œå…¬é’¥äº¤ç»™å¯¹æ–¹æˆ–æ˜¯ä½ è¦å‘é€çš„ä»»ä½•äººéƒ½è¡Œï¼Œç°åœ¨ä½ éœ€è¦æŠŠæ•°æ®ä¼ ç»™å¯¹æ–¹ï¼Œ é‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªæ•°æ®åªèƒ½ä½¿ç”¨å¯¹åº”çš„å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œç›¸åï¼Œå¦‚æœå¯¹æ–¹éœ€è¦ç»™ä½ å‘é€æ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œè€Œæ•°æ®åªèƒ½ä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼Œè¿™æ ·çš„è¯å°±ç®—å¯¹æ–¹çš„å…¬é’¥è¢«çªƒå–ï¼Œé‚£ä¹ˆåˆ«äººå‘ç»™ä½ çš„æ•°æ®ä¹Ÿæ²¡åŠæ³•è§£å¯†å‡ºæ¥ï¼Œ å› ä¸ºéœ€è¦ç§é’¥æ‰èƒ½è§£å¯†ï¼Œè€Œåªæœ‰ä½ æ‰æœ‰ç§é’¥ã€‚ å› æ­¤ï¼Œéå¯¹ç§°åŠ å¯†çš„å®‰å…¨æ€§ä¼šæ›´é«˜ä¸€äº›ï¼ŒåŒ…æ‹¬HTTPSçš„éšç§ä¿¡æ¯æ­£æ˜¯ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ¥ä¿éšœä¼ è¾“æ•°æ®çš„å®‰å…¨ï¼ˆå½“ç„¶HTTPSå¹¶ä¸æ˜¯å•çº¯åœ°ä½¿ç”¨éå¯¹ç§°åŠ å¯†å®Œæˆçš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»äº†è§£ä¸€ä¸‹ï¼‰ å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†éƒ½æœ‰å¾ˆå¤šçš„ç®—æ³•ï¼Œæ¯”å¦‚å¯¹ç§°åŠ å¯†ï¼Œå°±æœ‰ï¼šDESã€IDEAã€RC2ï¼Œéå¯¹ç§°åŠ å¯†æœ‰ï¼šRSAã€DASã€ECC ä¸å¯é€†åŠ å¯†ç®—æ³•ï¼š å¸¸è§çš„ä¸å¯é€†åŠ å¯†ç®—æ³•æœ‰MD5, HMAC, SHA-1, SHA-224, SHA-256, SHA-384, å’ŒSHA-512, å…¶ä¸­SHA-224ã€SHA-256ã€SHA-384ï¼Œå’ŒSHA-512æˆ‘ä»¬å¯ä»¥ç»Ÿç§°ä¸ºSHA2åŠ å¯†ç®—æ³•ï¼Œ SHAåŠ å¯†ç®—æ³•çš„å®‰å…¨æ€§è¦æ¯”MD5æ›´é«˜ï¼Œè€ŒSHA2åŠ å¯†ç®—æ³•æ¯”SHA1çš„è¦é«˜ï¼Œå…¶ä¸­SHAåé¢çš„æ•°å­—è¡¨ç¤ºçš„æ˜¯åŠ å¯†åçš„å­—ç¬¦ä¸²é•¿åº¦ï¼ŒSHA1é»˜è®¤ä¼šäº§ç”Ÿä¸€ä¸ª160ä½çš„ä¿¡æ¯æ‘˜è¦ã€‚ç»è¿‡ä¸å¯é€†åŠ å¯†ç®—æ³•å¾—åˆ°çš„åŠ å¯†ç»“æœï¼Œæ˜¯æ— æ³•è§£å¯†å›å»çš„ï¼Œ ä¹Ÿå°±æ˜¯è¯´åŠ å¯†å‡ºæ¥æ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆäº†ã€‚æœ¬è´¨ä¸Šï¼Œå…¶å°±æ˜¯ä¸€ç§å“ˆå¸Œå‡½æ•°ï¼Œç”¨äºå¯¹ä¸€æ®µä¿¡æ¯äº§ç”Ÿæ‘˜è¦ï¼Œä»¥é˜²æ­¢è¢«ç¯¡æ”¹ã€‚ å®é™…ä¸Šè¿™ç§ç®—æ³•å°±å¸¸å¸¸è¢«ç”¨ä½œä¿¡æ¯æ‘˜è¦è®¡ç®—ï¼ŒåŒæ ·çš„æ•°æ®é€šè¿‡åŒæ ·çš„ç®—æ³•è®¡ç®—å¾—åˆ°çš„ç»“æœè‚¯å®šä¹Ÿä¸€æ ·ï¼Œè€Œå¦‚æœæ•°æ®è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆè®¡ç®—çš„ç»“æœè‚¯å®šå°±ä¸ä¸€æ ·äº†ã€‚ ","date":"5 March 2024","externalUrl":null,"permalink":"/entire-note/spring/","section":"Entire-Notes","summary":"åŸºäºSpringCloudAlibaba+Nacos+Feign+Seata+Sentinelä½œä¸ºå¾®æœåŠ¡è·¯çº¿å™è¿° #\rå‰è¨€ï¼šæœ¬æ¬¡SpringCloudå¾®æœåŠ¡å­¦ä¹ æ¶‰åŠNetFlixå’ŒAlibabaä¸¤ä¸åŒç‰ˆæœ¬ï¼Œä¸»è¦å¯¹åº”å…³ç³»ä¸ºï¼š\nå¾®æœåŠ¡åŸåˆ™ï¼šæ‰€æœ‰çš„æœåŠ¡éƒ½éœ€è¦ä¿è¯èŒè´£çš„å•ä¸€åŸåˆ™\nSpringCloudä½œä¸ºä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆï¼Œæ˜¯SOAçš„å»¶ç»­\nSpringCloud Alibaba æ˜¯éµå¾ªSpringCloudæ¥å¼€å‘çš„å¥—ä»¶ï¼ŒNacosäº¦ç„¶\næœåŠ¡æ³¨å†Œå’Œå‘ç° #\rEureka #\rEurekaèƒ½å¤Ÿè‡ªåŠ¨æ³¨å†Œå¹¶å‘ç°å¾®æœåŠ¡ï¼Œç„¶åå¯¹æœåŠ¡çš„çŠ¶æ€ã€ä¿¡æ¯è¿›è¡Œé›†ä¸­ç®¡ç†ï¼Œè¿™æ ·å½“æˆ‘ä»¬éœ€è¦è·å–å…¶ä»–æœåŠ¡çš„ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å‘Eurekaè¿›è¡ŒæŸ¥è¯¢å°±å¯ä»¥äº†ã€‚\né€šè¿‡EurekaæœåŠ¡å™¨è¿›è¡ŒæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œå®ƒçš„è´Ÿè½½å‡è¡¡åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå®é™…ä¸Šä¹‹å‰æ¼”ç¤ºçš„è´Ÿè½½å‡è¡¡æ˜¯ä¾é LoadBalancerå®ç°çš„ã€‚\nåœ¨2020å¹´å‰çš„SpringCloudç‰ˆæœ¬æ˜¯é‡‡ç”¨Ribbonä½œä¸ºè´Ÿè½½å‡è¡¡å®ç°ï¼Œä½†æ˜¯2020å¹´çš„ç‰ˆæœ¬ä¹‹åSpringCloudæŠŠRibbonç§»é™¤äº†ï¼Œè¿›è€Œç”¨è‡ªå·±ç¼–å†™çš„LoadBalanceræ›¿ä»£ã€‚\nå¦‚ä½•æ‰¾åˆ°æœåŠ¡ï¼Ÿ\nNacos #\rNacosæ³¨å†Œä¸­å¿ƒ #\råŠŸèƒ½ï¼š\næœåŠ¡æ³¨å†Œå‘ç° é…ç½®ä¸­å¿ƒ æœåŠ¡å…ƒæ•°æ®/å®ä¾‹å…ƒæ•°æ®ï¼šå¯ä»¥ç”¨äºæµé‡æ§åˆ¶ï¼ˆåœ¨å®ä¾‹çš„metadataï¼ˆå…ƒæ•°æ®ï¼‰ä¸­åŠ ä¸Šæ ‡ç­¾ä¿¡æ¯ã€‚é€šè¿‡IRuleè·å–Serveråˆ—è¡¨å¹¶æ ¹æ®è¿™äº›Serverä¸­å…ƒæ•°æ®çš„æ ‡ç­¾ä¿¡æ¯å†³å®šè·¯ç”±æƒ…å†µï¼‰ å±€åŸŸç½‘å†…æœåŠ¡ä¿¡æ¯ä¼ è¾“å¿« æœåŠ¡é›†ç¾¤åˆ†çº§æ¨¡å¼\næœåŠ¡-é›†ç¾¤-å®ä¾‹\nä¿®æ”¹ymlï¼š\nspring: cloud: nacos: server-addr: localhost:8848 discovery: cluster-name: ClUSTER-01 å¯¹æŒ‡å®šæœåŠ¡è¿›è¡Œé…ç½®","title":"å¾®æœåŠ¡åŸºç¡€çŸ¥è¯†","type":"entire-note"},{"content":"","date":"2 March 2024","externalUrl":null,"permalink":"/tags/oauth2/","section":"Tags","summary":"","title":"Oauth2","type":"tags"},{"content":"\rå¾®ä¿¡ç™»å½• #\rå‚è€ƒæ–‡ç« ï¼š\nVueç”ŸæˆäºŒç»´ç \næ„å»ºå¾®ä¿¡ç™»å½•æœåŠ¡å™¨ éªŒè¯åç«¯\nå¾®ä¿¡å¼€å‘å…¬ä¼—å¹³å°\næ•ˆæœå±•ç¤ºï¼š #\ré€šè¿‡å‰ç«¯ç”Ÿæˆçš„äºŒç»´ç ï¼š\nå‰ç«¯éƒ¨åˆ†ï¼ˆä½¿ç”¨Domæ¥åˆ›å»ºscriptèŠ‚ç‚¹ï¼‰ï¼š #\rcreateWxLoginQrCode(){ const script=document.createElement(\u0026#39;script\u0026#39;); script.type=\u0026#39;text/javascript\u0026#39;; script.src=\u0026#39;https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js\u0026#39;; const wxElement = document.body.appendChild(script) wxElement.onload = function () { var obj = new WxLogin({ id: \u0026#39;wxLoginCode\u0026#39;, // éœ€è¦æ˜¾ç¤ºçš„å®¹å™¨id appid: \u0026#39;\u0026#39;,// å…¬ä¼—å·appid wx******* scope: \u0026#39;snsapi_login\u0026#39;, // ç½‘é¡µé»˜è®¤å³å¯ redirect_uri: encodeURIComponent(\u0026#39; \u0026#39;), // æˆæƒæˆåŠŸåå›è°ƒçš„url state: Math.ceil(Math.random() * 1000), // å¯è®¾ç½®ä¸ºç®€å•çš„éšæœºæ•°åŠ sessionç”¨æ¥æ ¡éªŒ style: \u0026#39;black\u0026#39;, // æä¾›\u0026#34;black\u0026#34;ã€\u0026#34;white\u0026#34;å¯é€‰ã€‚äºŒç»´ç çš„æ ·å¼ href: \u0026#39;\u0026#39; // å¤–éƒ¨cssæ–‡ä»¶urlï¼Œéœ€è¦https }) } } }, mounted(){ this.createQrcode(); this.createWxLoginQrCode(); } } å¾®ä¿¡æœåŠ¡å™¨éªŒè¯éƒ¨åˆ† #\r/** * WeiXinLoginController å…³äºå¾®ä¿¡ç™»å½•ä»¥åŠäºŒç»´ç è¿”å›çš„æ‰€æœ‰æ§åˆ¶è·¯ç”± * * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ * @since 2024/3/2 23:19 */ @Slf4j @RestController @RequestMapping(\u0026#34;/weixin\u0026#34;) public class WeiXinLoginController { @Resource WeXinConfigProperties weXinConfigProperties; @GetMapping(\u0026#34;/wxLogin\u0026#34;) public void wxLoginPage(HttpServletResponse response) throws Exception{ String hostAddr = weXinConfigProperties.getHOST_ADDR(); String redirectUrl = URLEncoder.encode(hostAddr+\u0026#34;/weixin/wxCallBack\u0026#34;, StandardCharsets.UTF_8); //è¯¥è¯·æ±‚ç”¨äºè·å–codeï¼Œè·å–codeä¹‹åä¼šé‡å®šå‘åˆ°redirectUrlè·å–token String url = \u0026#34;https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxd10c3f9e60b4e00b\u0026amp;redirect_uri=\u0026#34; +redirectUrl+\u0026#34;\u0026amp;response_type=code\u0026amp;scope=snsapi_userinfo\u0026amp;state=STATE#wechat_redirect\u0026#34;; response.setContentType(\u0026#34;image/png\u0026#34;); //Hutoolç”¨äºç”Ÿæˆç™»å½•äºŒç»´ç  QrCodeUtil.generate(url,300,300,\u0026#34;jpg\u0026#34;,response.getOutputStream()); } @Resource WeiXinUtil weiXinUtil; //ç”¨ä¸Šä¸€æ­¥è·å–çš„codeå»è·å–token //ä»£ç†çš„è·¯å¾„ï¼Œå®é™…å¤„ç†codeæ˜¯åœ¨WeiXinLoginUser userInfo = weiXinUtil.getUserInfo(code);æ–¹æ³•ä¸­ @GetMapping(\u0026#34;/wxCallBack\u0026#34;) public String pcCallback(String code, String state, HttpServletRequest request, HttpServletResponse response, HttpSession session) throws IOException { log.info(\u0026#34;ç™»å½•è·³è½¬è¯·æ±‚ï¼š{}\u0026#34;,request.getRequestURI()); WeiXinLoginUser userInfo = weiXinUtil.getUserInfo(code); return JSONUtil.toJsonStr(userInfo); } //å¾®ä¿¡æ£€æŸ¥æ–¹æ¡ˆï¼š // å¼€å‘è€…é€šè¿‡æ£€éªŒsignatureå¯¹è¯·æ±‚è¿›è¡Œæ ¡éªŒï¼ˆä¸‹é¢æœ‰æ ¡éªŒæ–¹å¼ï¼‰ã€‚è‹¥ç¡®è®¤æ­¤æ¬¡GETè¯·æ±‚æ¥è‡ªå¾®ä¿¡æœåŠ¡å™¨ï¼Œè¯·åŸæ ·è¿”å›echostrå‚æ•°å†…å®¹ï¼Œåˆ™æ¥å…¥ç”Ÿæ•ˆï¼Œæˆä¸ºå¼€å‘è€…æˆåŠŸï¼Œå¦åˆ™æ¥å…¥å¤±è´¥ã€‚åŠ å¯†/æ ¡éªŒæµç¨‹å¦‚ä¸‹ï¼š // //1ï¼‰å°†tokenã€timestampã€nonceä¸‰ä¸ªå‚æ•°è¿›è¡Œå­—å…¸åºæ’åº // //2ï¼‰å°†ä¸‰ä¸ªå‚æ•°å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œsha1åŠ å¯† // //3ï¼‰å¼€å‘è€…è·å¾—åŠ å¯†åçš„å­—ç¬¦ä¸²å¯ä¸signatureå¯¹æ¯”ï¼Œæ ‡è¯†è¯¥è¯·æ±‚æ¥æºäºå¾®ä¿¡ @RequestMapping(\u0026#34;/wxCheck\u0026#34;) public String wxSignatureCheck( @RequestParam(value = \u0026#34;signature\u0026#34;) String signature, @RequestParam(value = \u0026#34;timestamp\u0026#34;) String timestamp, @RequestParam(value = \u0026#34;nonce\u0026#34;) String nonce, @RequestParam(value = \u0026#34;echostr\u0026#34;) String echostr) throws NoSuchAlgorithmException { log.info(\u0026#34;æ”¶åˆ°å¾®ä¿¡æ ¡éªŒè¯·æ±‚ï¼Œechostr:{}\u0026#34;,echostr); String token=\u0026#34;Rainy-Heights\u0026#34;; String[] str = new String[]{token, timestamp, nonce}; //æ’åº Arrays.sort(str); //æ‹¼æ¥å­—ç¬¦ä¸² StringBuilder buffer = new StringBuilder(); for (String s : str) { buffer.append(s); } MessageDigest messageDigest=MessageDigest.getInstance(\u0026#34;SHA-1\u0026#34;); //åˆ©ç”¨SHA-1åŠ å¯†ç®—æ³•å¯¹å­—ç¬¦ä¸²åŠ å¯†ï¼š byte[] digest = messageDigest.digest(buffer.toString().getBytes(StandardCharsets.UTF_8));//åŠ å¯†å¥½çš„ç› buffer.setLength(0);//æ¸…ç©ºæ•°æ® for (byte bit:digest){ String hex=Integer.toHexString(0xff\u0026amp;bit); if (hex.length()==1) { buffer.append(\u0026#39;0\u0026#39;); } else { buffer.append(hex); } } //ä¸ç­¾åä¸€è‡´æ—¶è¿”å› if (buffer.toString().equals(signature)){ return echostr; } else { return \u0026#34;404\u0026#34;; } } } å¤„ç†å›è°ƒé€»è¾‘ï¼Œä»£ç†æ–¹æ³•\n/** * WeiXinUtil * * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ * @since 2024/3/2 23:51 */ @Slf4j @Component public class WeiXinUtil { @Resource WeXinConfigProperties weXinConfigProperties; //å…·ä½“è·å–tokençš„æ“ä½œ public WeiXinLoginUser getUserInfo(String code) throws IOException { String APP_ID= weXinConfigProperties.getAPP_ID(); String APP_SECRET= weXinConfigProperties.getAPP_SECRET(); String responseResult = \u0026#34;\u0026#34;; log.info(\u0026#34;å›è°ƒè·å–codeï¼š{}\u0026#34;,code); //åˆ›å»ºå¯å…³é—­httpé“¾æ¥å®¢æˆ·ç«¯ CloseableHttpClient httpClient = HttpClients.createDefault(); String tokenUrl =\u0026#34;https://api.weixin.qq.com/sns/oauth2/access_token?appid=\u0026#34;+APP_ID+\u0026#34;\u0026amp;secret=\u0026#34; +APP_SECRET+\u0026#34;\u0026amp;code=\u0026#34;+code+\u0026#34;\u0026amp;grant_type=authorization_code\u0026#34;; HttpGet request = new HttpGet(tokenUrl); CloseableHttpResponse response = httpClient.execute(request); if (response.getStatusLine().getStatusCode() == 200){ responseResult = EntityUtils.toString(response.getEntity(),\u0026#34;UTF-8\u0026#34;); } log.info(\u0026#34;è·å–åˆ°responseResultï¼š{}\u0026#34;,responseResult); WeiXinTokenInfo tokenInfo = JSONUtil.toBean(responseResult,WeiXinTokenInfo.class); String userInfoURL = \u0026#34;https://api.weixin.qq.com/sns/userinfo?access_token=\u0026#34;+tokenInfo.getAccessToken()+\u0026#34;\u0026amp;openid=\u0026#34; +tokenInfo.getOpenid()+\u0026#34;\u0026amp;lang=zh_CN\u0026#34;; HttpGet request1 = new HttpGet(userInfoURL); CloseableHttpResponse response1 = httpClient.execute(request1); if (response1.getStatusLine().getStatusCode() == 200){ responseResult = EntityUtils.toString(response1.getEntity(),\u0026#34;UTF-8\u0026#34;); } log.info(\u0026#34;è·å–åˆ°userInfoResultï¼š{}\u0026#34;,responseResult); WeiXinLoginUser userInfo = JSONUtil.toBean(responseResult, WeiXinLoginUser.class); return userInfo; } } ç™»å½•ç”¨æˆ·å®ä½“ï¼ˆå¾®ä¿¡ç™»å½•æˆåŠŸåè¿”å›çš„ä¿¡æ¯ ï¼‰\n/** * WeiXinLoginUser * * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ * @since 2024/3/2 23:17 */ @Data public class WeiXinLoginUser { /** * å¾®ä¿¡æ‰«ç ç™»å½•åå°è¿”å›çš„æ˜¯jsonæ•°æ® * ä¾‹å¦‚: * { \u0026#34;openid\u0026#34;:\u0026#34;OPENID\u0026#34;, \u0026#34;nickname\u0026#34;:\u0026#34;NICKNAME\u0026#34;, \u0026#34;sex\u0026#34;:1, \u0026#34;province\u0026#34;:\u0026#34;PROVINCE\u0026#34;, \u0026#34;city\u0026#34;:\u0026#34;CITY\u0026#34;, \u0026#34;country\u0026#34;:\u0026#34;COUNTRY\u0026#34;, \u0026#34;headimgurl\u0026#34;: \u0026#34;http://wx.qlogo.cn/mmopen/g3MonUZtNHkdmzicIlibx6iaFqAc56vxLSUfpb6n5WKSYVY0ChQKkiaJSgQ1dZuTOgvLLrhJbERQQ4eMsv84eavHiaiceqxibJxCfHe/0\u0026#34;, \u0026#34;privilege\u0026#34;:[ \u0026#34;PRIVILEGE1\u0026#34;, \u0026#34;PRIVILEGE2\u0026#34; ], \u0026#34;unionid\u0026#34;: \u0026#34; o6_bmasdasdsad6_2sgVt7hMZOPfL\u0026#34; } */ private String openid; private String nickname; private Integer sex; private String province; private String city; private String country; private String headimgurl; private String privilege; private String unionid; } vueé¡µé¢ä»£ç éƒ¨åˆ†\n\u0026lt;script\u0026gt; import QRcode from \u0026#34;qrcodejs2\u0026#34; export default { data() { return {} }, methods: { // ç”ŸæˆäºŒç»´ç  createQrcode() { new QRcode(this.$refs[\u0026#39;qrcode-config\u0026#39;], { text: \u0026#34; https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxd10c3f9e60b4e00b\u0026amp;redirect_uri=https%3A%2F%2F6bbb1c69.r6.cpolar.top%2Fweixin%2FwxCallBack\u0026amp;response_type=code\u0026amp;scope=snsapi_userinfo\u0026amp;state=STATE#wechat_redirect\u0026#34;, // æ‰«äºŒç»´ç åè·å¾—çš„ä¿¡æ¯ width: 400, // å›¾ç‰‡å®½90pxï¼Œå·¦å³paddingå„4pxï¼Œè¾¹æ¡†å„1pxï¼Œ 100-8px-2px height: 400, // å›¾ç‰‡é«˜90pxï¼Œä¸Šä¸‹paddingå„4pxï¼Œè¾¹æ¡†å„1pxï¼Œ 100-8px-2px }) }, //ç”Ÿæˆå¾®ä¿¡ç™»å½•çš„äºŒç»´ç ï¼Œé‡‡ç”¨æ“ä½œdomçš„æ–¹å¼ï¼Œéæ’ä»¶ï¼Œå‚è€ƒé“¾æ¥ï¼šhttps://huaweicloud.csdn.net/654a0c1634bf9e25c799cae9.html?dp_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MTQ4MjI4OSwiZXhwIjoxNzEwMDAzNjgyLCJpYXQiOjE3MDkzOTg4ODIsInVzZXJuYW1lIjoicmFpbnloZWlnaHRzIn0.4jltqP2tCDn4xh25GWz11fMFOOa-xqGugND8f8Iqo5U createWxLoginQrCode() { const script = document.createElement(\u0026#39;script\u0026#39;); script.type = \u0026#39;text/javascript\u0026#39;; script.src = \u0026#39;https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js\u0026#39;; const wxElement = document.body.appendChild(script) wxElement.onload = function () { var obj = new WxLogin({ id: \u0026#39;wxLoginCode-\u0026#39;, // éœ€è¦æ˜¾ç¤ºçš„å®¹å™¨id appid: \u0026#39;wxd10c3f9e60b4e00b\u0026#39;,// å…¬ä¼—å·appid wx******* scope: \u0026#39;snsapi_login\u0026#39;, // ç½‘é¡µé»˜è®¤å³å¯ redirect_uri: encodeURIComponent(\u0026#39;https://2e79fece.r21.cpolar.top/weixin/wxCallBack\u0026#39;), // æˆæƒæˆåŠŸåå›è°ƒçš„url state: Math.ceil(Math.random() * 1000), // å¯è®¾ç½®ä¸ºç®€å•çš„éšæœºæ•°åŠ sessionç”¨æ¥æ ¡éªŒ style: \u0026#39;black\u0026#39;, //æä¾›\u0026#34;black\u0026#34;ã€\u0026#34;white\u0026#34;å¯é€‰ã€‚äºŒç»´ç çš„æ ·å¼ href: \u0026#39;\u0026#39; // å¤–éƒ¨cssæ–‡ä»¶urlï¼Œéœ€è¦https }) } } }, mounted() { this.createQrcode(); this.createWxLoginQrCode(); } } \u0026lt;/script\u0026gt; \u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;wxLogin\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;æ‰«ç ç™»å½•ï¼ŒäºŒç»´ç  1 åˆ†é’Ÿå†…æœ‰æ•ˆ\u0026lt;/h3\u0026gt; \u0026lt;!-- \u0026lt;login-code :size=\u0026#34;400\u0026#34; :text=\u0026#34;äºŒç»´ç \u0026#34;/\u0026gt; --\u0026gt; \u0026lt;div class=\u0026#34;img-box\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;qrcode-config\u0026#34; ref=\u0026#34;qrcode-config\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;img class=\u0026#34;qrcode-logo\u0026#34; width=\u0026#34;27\u0026#34; src=\u0026#34;../../assets/wx.jpg\u0026#34; alt=\u0026#34;é…ç½®æœåŠ¡å™¨\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div id=\u0026#34;wxLoginCode\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;style scoped\u0026gt; .wxLogin { align-content: center; text-align: center; margin-top: 50px; /* äºŒç»´ç å›¾ç‰‡å®¹å™¨,åŒ…æ‹¬äºŒç»´ç  + logo + è¾¹æ¡† */ .img-box { margin-left: 40%; align-items: center; text-align: center; padding-bottom: 8px; width: 400px; height: 400px; box-sizing: border-box; position: relative; } /* qrcodejs2 ç”Ÿæˆçš„äºŒç»´ç çš„å®¹å™¨ï¼Œçº¯äºŒç»´ç */ .qrcode-config { margin-top: 300px; align-items: center; border: 1px solid #e5e5e6; padding: 4px; border-radius: 4px; width: 400px; height: 400px; box-sizing: border-box; img { box-sizing: border-box; } } /*äºŒç»´ç ä¸­é—´çš„logo*/ .qrcode-logo { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 70px; } } \u0026lt;/style\u0026gt; ç›®å‰å°šæœªå®Œæˆçš„éƒ¨åˆ†ï¼š\näºŒç»´ç æ‰«æå®Œæˆåè¿”å›ç ä½10003ï¼Œæ¨æµ‹å¯èƒ½æ˜¯å¾®ä¿¡å¼€æ”¾å¹³å°æ²¡æœ‰åšå¥½ï¼Œåæ§½ï¼šå¾®ä¿¡å¼€æ”¾å¹³å°çš„ç½‘ç«™å¤ªå¤šäº†ï¼Œä¸€ä¼šå„¿å°ç¨‹åºä¸€ä¼šå„¿ç½‘ç«™åº”ç”¨ï¼Œåˆ†è¾¨ä¸æ¸…ï¼Œä¸æƒ³å†™\nå®Œæˆç™»å½•åçš„æˆæƒç æ¨¡å¼è·å–ç”¨æˆ·ä¿¡æ¯å¹¶æˆæƒéƒ¨åˆ†\n","date":"2 March 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/wexin-oauth/","section":"ç¬”è®°s","summary":"å¾®ä¿¡ç™»å½• #\rå‚è€ƒæ–‡ç« ï¼š\nVueç”ŸæˆäºŒç»´ç \næ„å»ºå¾®ä¿¡ç™»å½•æœåŠ¡å™¨ éªŒè¯åç«¯\nå¾®ä¿¡å¼€å‘å…¬ä¼—å¹³å°\næ•ˆæœå±•ç¤ºï¼š #\ré€šè¿‡å‰ç«¯ç”Ÿæˆçš„äºŒç»´ç ï¼š\nå‰ç«¯éƒ¨åˆ†ï¼ˆä½¿ç”¨Domæ¥åˆ›å»ºscriptèŠ‚ç‚¹ï¼‰ï¼š #\rcreateWxLoginQrCode(){ const script=document.createElement(\u0026#39;script\u0026#39;); script.type=\u0026#39;text/javascript\u0026#39;; script.src=\u0026#39;https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js\u0026#39;; const wxElement = document.body.appendChild(script) wxElement.onload = function () { var obj = new WxLogin({ id: \u0026#39;wxLoginCode\u0026#39;, // éœ€è¦æ˜¾ç¤ºçš„å®¹å™¨id appid: \u0026#39;\u0026#39;,// å…¬ä¼—å·appid wx******* scope: \u0026#39;snsapi_login\u0026#39;, // ç½‘é¡µé»˜è®¤å³å¯ redirect_uri: encodeURIComponent(\u0026#39; \u0026#39;), // æˆæƒæˆåŠŸåå›è°ƒçš„url state: Math.","title":"å¾®ä¿¡ç™»å½•","type":"ç¬”è®°"},{"content":"Java é€‰æ‰‹ä¸ºä»€ä¹ˆç”¨ Vscode äº†ï¼Ÿ\nç­”ï¼šè‹¦äº IDEA çš„å¯åŠ¨é€Ÿåº¦ï¼Œæœ¬äººçš„ç”µè„‘å¸¦ä¸åŠ¨äº†å¾ˆå¤šäº†ï¼Œå°±ç®—æ”¹äº†ç´¢å¼•å’Œ Mavenï¼Œç»å¸¸è¿˜æ˜¯è¦ç¼–è¾‘ jsï¼Œvueï¼Œhtml æ–‡ä»¶ï¼Œå°å…¨æ ˆè¾£é¸¡å§ï¼Œæ•…è€Œè½¬æˆ˜ Vscodeã€‚å¹¶ä¸å®Œå…¨å¼ƒå‘ IDEA\nç›®å‰è°ƒæ•™ Vscode è¿˜ç®—æŒºå¥½å“’å“ˆå“ˆï¼Œå¥½ç”¨å‘€ï¼ï¼ï¼\nè¿™é‡Œæˆ‘é€‰æ‹©äº†æœ¬åœ°çš„ Maven å’Œç”¨äºæ—¥è¯­çš„å­—ä½“()ï¼Œä¸»é¢˜é€‰ç”¨çš„æ˜¯ï¼šDefault Dark Modernï¼Œç›®å‰çœ‹èµ·æ¥è¿˜è¡Œï¼Œç»å…¸å°±æ˜¯å¥½ï¼Œé…åˆæˆ‘çš„èƒŒæ™¯å›¾ç‰‡å¾ˆæ­!\nå½“é€‰æ‹©ç¼–å†™ Spring åº”ç”¨ç¨‹åºæ—¶å¯é€‰ç”¨ Idea ä¸»é¢˜ï¼Œè¾ƒä¸ºæ¥è¿‘ Jetbrains å®¶æ—çš„ Idea,å­—ä½“é€‰ç”¨çš„æ˜¯ JetBrains å®¶æ—çš„ JetBrains Monoï¼Œnormal ç‰ˆï¼›\nç”±äºæ·»åŠ äº†é€‚ç”¨äº Idea çš„å¿«æ·é”®æ’ä»¶ï¼Œå¹³æ›¿ Idea éå¸¸ä¸æ»‘ã€‚\nèƒŒæ™¯ä¸»é¢˜æ’ä»¶ï¼šï¼ˆBackground-kasuteï¼‰\næ–‡ä»¶å›¾æ ‡ä¸»é¢˜ï¼š\nèƒŒæ™¯å›¾ï¼š\ré»„æ˜æ—¶åˆ»-é“å£æ—¶åˆ»\nè´´ä¸€ä¸‹ jsonï¼Œåšä¸ªå¤‡ä»½\n{ \u0026#34;markdown-image.github.repository\u0026#34;: \u0026#34;https://github.com/ToDreamr/img-cloud.git\u0026#34;, \u0026#34;markdown-image.github.cdn\u0026#34;: \u0026#34;https://cdn.jsdelivr.net/gh/Todreamr/img-cloud\u0026#34;, \u0026#34;markdown-image.github.token\u0026#34;: \u0026#34;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\u0026#34;, \u0026#34;RainbowBrackets.depreciation-notice\u0026#34;: false, \u0026#34;java.configuration.maven.userSettings\u0026#34;: \u0026#34;D://Program Files//apache-maven-3.9.4//conf//settings.xml\u0026#34;, \u0026#34;java.configuration.maven.globalSettings\u0026#34;: \u0026#34;D://Program Files//apache-maven-3.9.4//conf//settings.xml\u0026#34;, \u0026#34;maven.executable.path\u0026#34;: \u0026#34;D://Program Files//apache-maven-3.9.4//bin//mvn\u0026#34;, \u0026#34;workbench.iconTheme\u0026#34;: \u0026#34;eq-material-theme-icons-ocean\u0026#34;, \u0026#34;editor.mouseWheelZoom\u0026#34;: true, \u0026#34;editor.fontLigatures\u0026#34;: false, \u0026#34;editor.fontFamily\u0026#34;: \u0026#34;\u0026#39;JetBrains Mono\u0026#39;,\u0026#39;æ±‰ä»ªå­Ÿåº†æ±Ÿè¡Œä¹¦ W\u0026#39;\u0026#34;, \u0026#34;terminal.integrated.fontFamily\u0026#34;: \u0026#34;JetBrains Mono\u0026#34;, \u0026#34;files.trimTrailingWhitespace\u0026#34;: true, \u0026#34;vue.format.script.initialIndent\u0026#34;: true, \u0026#34;vue.format.style.initialIndent\u0026#34;: true, \u0026#34;editor.formatOnSave\u0026#34;: true, \u0026#34;workbench.settings.useSplitJSON\u0026#34;: true, \u0026#34;rest-client.fontWeight\u0026#34;: \u0026#34;normal\u0026#34;, \u0026#34;editor.fontWeight\u0026#34;: \u0026#34;normal\u0026#34;, \u0026#34;terminal.integrated.fontWeight\u0026#34;: \u0026#34;bold\u0026#34;, \u0026#34;files.autoSave\u0026#34;: \u0026#34;onFocusChange\u0026#34;, \u0026#34;workbench.editor.doubleClickTabToToggleEditorGroupSizes\u0026#34;: \u0026#34;off\u0026#34;, \u0026#34;latex-workshop.view.pdf.tab.editorGroup\u0026#34;: \u0026#34;current\u0026#34;, \u0026#34;editor.renderWhitespace\u0026#34;: \u0026#34;none\u0026#34;, \u0026#34;editor.codeActionsOnSave\u0026#34;: {}, \u0026#34;diffEditor.hideUnchangedRegions.enabled\u0026#34;: true, \u0026#34;workbench.preferredDarkColorTheme\u0026#34;: \u0026#34;Default Dark+\u0026#34;, \u0026#34;workbench.preferredHighContrastColorTheme\u0026#34;: \u0026#34;Default Dark+\u0026#34;, \u0026#34;workbench.editor.autoLockGroups\u0026#34;: { \u0026#34;mainThreadWebview-markdown.preview\u0026#34;: true }, \u0026#34;background.autoInstall\u0026#34;: true, \u0026#34;background.smoothImageRendering\u0026#34;: true, \u0026#34;background.backgroundBlur\u0026#34;: [ \u0026#34;0\u0026#34;, \u0026#34;300\u0026#34;, \u0026#34;300\u0026#34;, \u0026#34;300\u0026#34; ], \u0026#34;background.backgroundChangeTime\u0026#34;: [ 720, 720, 720, 720 ], \u0026#34;background.renderContentAboveBackground\u0026#34;: true, \u0026#34;editor.fontVariations\u0026#34;: false, \u0026#34;background.windowBackgrounds\u0026#34;: [ \u0026#34;https://pic3.zhimg.com/80/v2-e0c90dbe7ca8559256e37522f28b060e_1440w.webp\u0026#34;, \u0026#34;https://picx.zhimg.com/80/v2-479a753c747307bd93ad989bee373147_1440w.webp?source=2c26e567\u0026#34;, \u0026#34;https://pic1.zhimg.com/80/v2-6987babba6c51f77e73ec0134d4c53d0_1440w.webp\u0026#34;, \u0026#34;https://picx.zhimg.com/80/v2-01cb93ee2cc66a3d47d942725b240b4e_1440w.webp?source=1def8aca\u0026#34;, \u0026#34;https://pic2.zhimg.com/80/v2-b3f0b28e5d82fd34294b03bfc9cb6779_1440w.webp\u0026#34;, \u0026#34;https://pic2.zhimg.com/80/v2-c4386ee2d2c068c80792a7925d6b1607_1440w.webp\u0026#34;, \u0026#34;https://pic4.zhimg.com/80/v2-3df07d0898aab88f5cd6306c7ec25c8f_1440w.webp\u0026#34;, \u0026#34;https://pic4.zhimg.com/80/v2-d10e3a9e78d72d42f404eb6984bfe32b_1440w.webp\u0026#34; ], \u0026#34;[jsonc]\u0026#34;: { \u0026#34;editor.defaultFormatter\u0026#34;: \u0026#34;vscode.json-language-features\u0026#34; }, \u0026#34;cSpell.userWords\u0026#34;: [ \u0026#34;qrcodejs\u0026#34; ], \u0026#34;files.associations\u0026#34;: { \u0026#34;*.vue\u0026#34;: \u0026#34;vue\u0026#34; }, \u0026#34;workbench.tree.enableStickyScroll\u0026#34;: false, \u0026#34;workbench.editor.defaultBinaryEditor\u0026#34;: \u0026#34;default\u0026#34;, \u0026#34;terminal.integrated.defaultProfile.windows\u0026#34;: \u0026#34;PowerShell\u0026#34;, \u0026#34;terminal.integrated.enableVisualBell\u0026#34;: true, \u0026#34;terminal.integrated.localEchoStyle\u0026#34;: \u0026#34;dim\u0026#34;, \u0026#34;terminal.integrated.cursorBlinking\u0026#34;: true, \u0026#34;scm.defaultViewMode\u0026#34;: \u0026#34;tree\u0026#34;, \u0026#34;terminal.integrated.tabs.showActiveTerminal\u0026#34;: \u0026#34;singleTerminal\u0026#34; } maven ä¸€åˆ‡æ­£å¸¸ï¼š\n","date":"2 March 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/vscode/","section":"ç¬”è®°s","summary":"Java é€‰æ‰‹ä¸ºä»€ä¹ˆç”¨ Vscode äº†ï¼Ÿ\nç­”ï¼šè‹¦äº IDEA çš„å¯åŠ¨é€Ÿåº¦ï¼Œæœ¬äººçš„ç”µè„‘å¸¦ä¸åŠ¨äº†å¾ˆå¤šäº†ï¼Œå°±ç®—æ”¹äº†ç´¢å¼•å’Œ Mavenï¼Œç»å¸¸è¿˜æ˜¯è¦ç¼–è¾‘ jsï¼Œvueï¼Œhtml æ–‡ä»¶ï¼Œå°å…¨æ ˆè¾£é¸¡å§ï¼Œæ•…è€Œè½¬æˆ˜ Vscodeã€‚å¹¶ä¸å®Œå…¨å¼ƒå‘ IDEA\nç›®å‰è°ƒæ•™ Vscode è¿˜ç®—æŒºå¥½å“’å“ˆå“ˆï¼Œå¥½ç”¨å‘€ï¼ï¼ï¼\nè¿™é‡Œæˆ‘é€‰æ‹©äº†æœ¬åœ°çš„ Maven å’Œç”¨äºæ—¥è¯­çš„å­—ä½“()ï¼Œä¸»é¢˜é€‰ç”¨çš„æ˜¯ï¼šDefault Dark Modernï¼Œç›®å‰çœ‹èµ·æ¥è¿˜è¡Œï¼Œç»å…¸å°±æ˜¯å¥½ï¼Œé…åˆæˆ‘çš„èƒŒæ™¯å›¾ç‰‡å¾ˆæ­!\nå½“é€‰æ‹©ç¼–å†™ Spring åº”ç”¨ç¨‹åºæ—¶å¯é€‰ç”¨ Idea ä¸»é¢˜ï¼Œè¾ƒä¸ºæ¥è¿‘ Jetbrains å®¶æ—çš„ Idea,å­—ä½“é€‰ç”¨çš„æ˜¯ JetBrains å®¶æ—çš„ JetBrains Monoï¼Œnormal ç‰ˆï¼›","title":"è‡ªç”¨çš„Vscodeä¸ªäººè§‰å¾—è¿˜ç®—è€çœ‹çš„ä¸»é¢˜å’Œå­—ä½“ä»¥åŠç¼–ç ä¹ æƒ¯","type":"ç¬”è®°"},{"content":"","date":"23 February 2024","externalUrl":null,"permalink":"/tags/spring/","section":"Tags","summary":"","title":"Spring","type":"tags"},{"content":"\råŸºäºSpring6+JDK18çš„SpringSecurityç¯å¢ƒçš„é¡¹ç›®DEMO #\ré¡¹ç›®åœ°å€ï¼š\nToDreamr/security-community\råŸºäº Spring6+Vue+Jwt+JDK18ç¯å¢ƒçš„SpringSecurityç¤¾åŒºé¡¹ç›®\rJava 1\r0\råŸºæœ¬å®ç°çš„åŠŸèƒ½ #\rSecurityé€šè¿‡æ•°æ®åº“å®ç°è‡ªå®šä¹‰ç™»å½• é€šè¿‡è‡ªå·±æ·»åŠ çš„è¿‡æ»¤å™¨é“¾å®ŒæˆJWT+Tokençš„è¯·æ±‚æƒé™è®¤è¯ TokenåŠ å…¥Redisåšæ— çŠ¶æ€æ— Sessionå¤„ç† é‚®ç®±éªŒè¯ç æ”¶å‘åŠŸèƒ½ æ³¨æ„äº‹é¡¹ #\rsqlæ‰§è¡Œè„šæœ¬åœ¨é¡¹ç›®docæ–‡ä»¶ç›®å½•ä¸‹ï¼ŒSecurityåœ¨Spring6ä¸‹å·²ç»åºŸé™¤\né€šè¿‡WebSecurityAdaptoræ¥å®ç°HttpSecurityè¿™ä¸ªBeançš„é…ç½®æ³¨å…¥ã€‚\nç›®å‰åªæ”¯æŒLamdaè¡¨è¾¾å¼ã€‚\nè¯·åœ¨application.ymlä¸­è‡ªè¡Œé…ç½®è‡ªå·±çš„é‚®ç®±SMTPæœåŠ¡\né…ç½®æ¡ˆä¾‹ï¼š\n@Bean public SecurityFilterChain filterChain(HttpSecurity http) throws Exception { return http .authorizeHttpRequests(conf-\u0026gt;conf .requestMatchers(\u0026#34;/**\u0026#34;).permitAll() ) .formLogin(conf -\u0026gt; conf .loginProcessingUrl(\u0026#34;/auth/login\u0026#34;).permitAll() .successHandler(new LoginSuccessHandler(accountService,jwtUtils,stringRedisTemplate)) .failureHandler(new LoginFailureHandler()) ) .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class) .csrf(AbstractHttpConfigurer::disable)//å…³é—­è·¨åŸŸæ¼æ´é˜²å¾¡é…ç½® .logout(conf-\u0026gt;conf .logoutUrl(\u0026#34;/auth/logout\u0026#34;) .logoutSuccessHandler(new LogOutHandler(redisTemplate,jwtUtils))) .exceptionHandling(conf-\u0026gt;conf.accessDeniedHandler((request, response, accessDeniedException) -\u0026gt; System.out.println(\u0026#34;å½“å‰å¼‚å¸¸çš„ç™»å½•ä¿¡æ¯ï¼š\u0026#34;+accessDeniedException))) .build(); } æ­å»ºè¦ç‚¹ #\rç™»å½•ç”¨æˆ·å®ä½“å¿…é¡»å®ç°UserDetailsæ¥å£ï¼Œæ•°æ®å±‚ï¼Œä¸šåŠ¡å±‚ï¼ˆå®é™…å¤„ç†ç™»å½•é€»è¾‘ï¼Œä¿—ç§°Implï¼‰å¿…é¡»å®ç°\nUserDetailsServiceæ¥å£ï¼ŒåŒæ—¶é‡å†™\npublic UserDetails loadUserByUsername(String username) æ–¹æ³•ï¼›\nä¾‹å¦‚ï¼š\nImpl @Resource UserMapper userMapper; @Override public UserDetails loadUserByUsername(String username){ User user = userMapper.loadUserByUsername(username); if (user==null){ throw new UsernameNotFoundException(\u0026#34;ç”¨æˆ·åä¸å­˜åœ¨ï¼\u0026#34;); } User userDetails = new User(); userDetails.setUsername(username); userDetails.setPassword(user.getPassword()); return userDetails; } é€šè¿‡è‡ªå®šä¹‰çš„FilteråŒæ—¶ç»§æ‰¿ OncePerRequestFilter ç±»ï¼Œç±»ä¼¼äºç½‘å…³å¤„ç†Request+Response\næ§åˆ¶éç™»å½•çš„èµ„æºè¯·æ±‚æƒé™è®¤è¯ã€‚\nèŒƒå›´\tæè¿°\nicon\tè¦åœ¨æ—¶é—´çº¿è§†è§‰æ•ˆæœä¸­ä½¿ç”¨çš„å›¾æ ‡ã€‚\nheader\tæ¯ä¸ªæ¡ç›®çš„æ ‡é¢˜\nbadge\tæ”¾ç½®åœ¨å³ä¸Šè§’å¾½ç« å†…çš„æ–‡æœ¬\nsubheader\tæ¡ç›®çš„å‰¯æ ‡é¢˜\nTodreamr Repo\ræˆ‘çš„ä»£ç ä»“åº“\rToDreamr/todreamr.github.io\rPersonal Website\rJavaScript 0\r0\r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rå¤´éƒ¨æ ‡é¢˜ æ ‡ç­¾\rå‰¯æ ‡é¢˜\ræ ·å¼æµ‹è¯•\rJava\rPython\rLatex\rå›¾é›† äºŒæ¬¡å…ƒèµ›é«˜\ræ­¤ç”Ÿæ— æ‚”äºŒæ¬¡å…ƒ\r","date":"23 February 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/security/","section":"ç¬”è®°s","summary":"åŸºäºSpring6+JDK18çš„SpringSecurityç¯å¢ƒçš„é¡¹ç›®DEMO #\ré¡¹ç›®åœ°å€ï¼š\nToDreamr/security-community\råŸºäº Spring6+Vue+Jwt+JDK18ç¯å¢ƒçš„SpringSecurityç¤¾åŒºé¡¹ç›®\rJava 1\r0\råŸºæœ¬å®ç°çš„åŠŸèƒ½ #\rSecurityé€šè¿‡æ•°æ®åº“å®ç°è‡ªå®šä¹‰ç™»å½• é€šè¿‡è‡ªå·±æ·»åŠ çš„è¿‡æ»¤å™¨é“¾å®ŒæˆJWT+Tokençš„è¯·æ±‚æƒé™è®¤è¯ TokenåŠ å…¥Redisåšæ— çŠ¶æ€æ— Sessionå¤„ç† é‚®ç®±éªŒè¯ç æ”¶å‘åŠŸèƒ½ æ³¨æ„äº‹é¡¹ #\rsqlæ‰§è¡Œè„šæœ¬åœ¨é¡¹ç›®docæ–‡ä»¶ç›®å½•ä¸‹ï¼ŒSecurityåœ¨Spring6ä¸‹å·²ç»åºŸé™¤\né€šè¿‡WebSecurityAdaptoræ¥å®ç°HttpSecurityè¿™ä¸ªBeançš„é…ç½®æ³¨å…¥ã€‚\nç›®å‰åªæ”¯æŒLamdaè¡¨è¾¾å¼ã€‚\nè¯·åœ¨application.ymlä¸­è‡ªè¡Œé…ç½®è‡ªå·±çš„é‚®ç®±SMTPæœåŠ¡\né…ç½®æ¡ˆä¾‹ï¼š\n@Bean public SecurityFilterChain filterChain(HttpSecurity http) throws Exception { return http .","title":"Spring-Security","type":"ç¬”è®°"},{"content":"\rDockeré•œåƒåŸºæœ¬å‘½ä»¤ #\rsystemctl stop firewalld systemctl disable firewalld å¯åŠ¨Docker\nsystemctl start docker systemctl restart docker docker -v é…ç½®é•œåƒ\nsudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json \u0026lt;\u0026lt;- \u0026#39;EOF\u0026#39; { \u0026#34;registry-mirrors\u0026#34;:[\u0026#34;https://n0dwetq.mirror.aliyuncs.com\u0026#34;] } EOF sudo systemctl daemon-reload sudo systemctl restart docker é•œåƒæ“ä½œ\næ‹‰å–é•œåƒï¼š\ndocker pull images %æ‹‰å–é•œåƒ docker rmi %åˆ é™¤é•œåƒ docker save %ä¿å­˜é•œåƒ docker load %åŠ è½½é•œåƒ docker build %æ‰“åŒ…é•œåƒ docker save -o nginx.tar nginx:latest docker rmi naginx:latest docker load -i nginx.tar Dockerå®¹å™¨åŸºæœ¬æ“ä½œ #\rdocker psï¼šæŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨çŠ¶æ€\rdocker logs æŸ¥çœ‹å®¹å™¨çš„è¿è¡Œæ—¥å¿—\rdocker rm åˆ é™¤å®¹å™¨\rdocker exec è¿›å…¥å®¹å™¨ è¿è¡Œåœ¨å›ºå®šç«¯å£ #\r-name å‘½å\n-p ç«¯å£æ˜ å°„ï¼šè¿™æ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„ï¼Œç”±äºå®¹å™¨éš”ç¦»ï¼Œéœ€è¦å°†å®¹å™¨æ˜ å°„åˆ°æœåŠ¡ç«¯å£\n-p[å®¿ä¸»æœºç«¯å£]ï¼š[å®¹å™¨ç«¯å£]\n-d åå°è¿è¡Œ\nè¿›å…¥å®¹å™¨å†…éƒ¨(å°†ä¼šè¿›å…¥è¿è¡Œå®¹å™¨çš„Linuxéš”ç¦»ç¯å¢ƒ) #\rdocker exec -it image-name bash\rdocker stop image-name æ•°æ®å·ï¼ˆVolumeï¼‰ #\rä¸ºäº†è§£å†³è€¦åˆï¼Œåˆ›å»ºçš„æ–‡ä»¶å…³è”ç³»ç»Ÿï¼Œæƒ³è±¡é‡å­çº ç¼ \nå®ç°å…³è”çš„æ“ä½œç§°ä¸ºæŒ‚è½½\næ•°æ®å·å¯å®ç°æ–°æ—§æ•°æ®å…±äº«\nå‘½ä»¤ï¼š #\rdocker volume create volume-name #åˆ›å»ºæ•°æ®å· æ•°æ®å·æŒ‚è½½ï¼ˆ-vï¼‰ #\ræ¯”å¦‚ï¼š\ndocker run --name my-nginx -v volume-nginx:/root/html -p 80:80 nginx ä¹‹åå¯¹å®¹å™¨å†…æ–‡ä»¶çš„ä¿®æ”¹å³å¯é€šè¿‡æ•°æ®å·æ–‡ä»¶å’ŒSFTPæ–‡ä»¶ç³»ç»Ÿæ“ä½œè½¯ä»¶Temius/XShellä¿®æ”¹äº†ã€‚\næ„å»ºDockerFile #\ré•œåƒç»“æ„ #\rä»ç»“æ„çœ‹å‡ºï¼Œæ„å»ºé•œåƒéœ€è¦ä»ä¸‹å¾€ä¸Šé€å±‚æ„å»ºã€‚\nDockerFileç¼–å†™ #\rfrom ubuntu:20.04 #æ„å»ºåŸºç¡€é•œåƒï¼Œå¯ä»¥æ˜¯Linuxï¼Œä¹Ÿå¯ä»¥æ˜¯åˆ¶ä½œå¥½çš„é•œåƒ ENV JAVA_DIR=/usr/loval COPY ./jdk8.tar.gz $JAVA_DIR/ COPY ./docker-build.jar /tmp/application.jar RUN cd $JAVA_DIR \u0026amp;\u0026amp; tar -xf ./jdk8.tar.gz \\ \u0026amp;\u0026amp; mv ./jdk1.8.0_144 ./java8 ENV JAVA_HOME=${JAVA_HOME}$ ENV PATH=${JAVA_HOME/bin}$ EXPOSE 8081 ENTRYPOINT java -jar /tmp/application.jar docker build -t name:version . #\u0026#34;.\u0026#34;ä»£è¡¨DockerFileè·¯å¾„ DockerCompose #\rDocker Composeæ˜¯åŸºäºComposeæ–‡ä»¶ï¼ˆymlæ–‡ä»¶ï¼‰æ¥å¸®åŠ©å¿«é€Ÿéƒ¨ç½²çš„åˆ†å¸ƒå¼åº”ç”¨ã€‚\n","date":"8 February 2024","externalUrl":null,"permalink":"/docker/","section":"","summary":"Dockeré•œåƒåŸºæœ¬å‘½ä»¤ #\rsystemctl stop firewalld systemctl disable firewalld å¯åŠ¨Docker\nsystemctl start docker systemctl restart docker docker -v é…ç½®é•œåƒ\nsudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json \u0026lt;\u0026lt;- \u0026#39;EOF\u0026#39; { \u0026#34;registry-mirrors\u0026#34;:[\u0026#34;https://n0dwetq.mirror.aliyuncs.com\u0026#34;] } EOF sudo systemctl daemon-reload sudo systemctl restart docker é•œåƒæ“ä½œ","title":"Docker","type":"page"},{"content":"\ræ­å»ºæœ¬ç«™éŸ³ä¹ #\ræ­å»ºè¿‡ç¨‹ç»•äº†ä¸€äº›å¼¯å­ï¼Œåƒäº†å‰ç«¯çš„äºï¼Œä¸»è¦å€Ÿé‰´äº†\ré‡‘åœ£çš“ï¼Œå¾—çŸ¥äº†ç›®å‰ä¸»æµçš„åšå®¢éŸ³ä¹ä¾æ‰˜äºAPlayer\u0026amp;Meting JS,å‰è€…æ˜¯åµŒå…¥HTMLçš„éŸ³ä¹ç»„ä»¶åº“ï¼Œåè€…æ˜¯å¯ç”¨é€šè¿‡ç½‘æ˜“ï¼ŒQQéŸ³ä¹ç­‰ç½‘ç«™çš„éŸ³ä¹æ’ä»¶ï¼Œæœ¬ç½‘ç«™ä½œä¸ºé™æ€é¡µé¢ï¼Œæ•…åªéœ€é€šè¿‡CDNå¼•å…¥å³å¯\nç½‘ç«™æ­å»ºä¸»é¢˜ä¸ºBlowfishï¼Œåœ¨blog/layouts/shortcodesæ–‡ä»¶å¤¹ä¸‹æ·»åŠ album.htmlæ–‡ä»¶\nè¿™é‡Œé‡‡ç”¨çš„æ˜¯ç½‘æ˜“éŸ³ä¹çš„æ­Œå•ï¼Œè·å–æ­Œå•idè‡ªè¡Œä»\r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rç½‘æ˜“äº‘éŸ³ä¹æ­Œå•ä¸­è·å–\n\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/color-thief@2.2.5/js/color-thief.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;span style=\u0026#34;color:#111827\u0026#34;\u0026gt; \u0026lt;!--{{.Get 0}}ä½œä¸ºæ­Œå•å‚æ•°ç”±å¼•ç”¨ç»„ä»¶å¤„æ·»åŠ --\u0026gt; \u0026lt;meting-js server=\u0026#34;netease\u0026#34; type=\u0026#34;playlist\u0026#34; id=\u0026#34;{{.Get 0}}\u0026#34; autoplay=\u0026#34;true\u0026#34; listFolded=\u0026#34;true\u0026#34;\u0026gt;\u0026lt;/meting-js\u0026gt; \u0026lt;/span\u0026gt; \u0026lt;hr/\u0026gt; åœ¨åšå®¢ç¬”è®°ä¸­æ·»åŠ mdæ–‡ä»¶ #\ræ•ˆæœï¼š #\r","date":"7 February 2024","externalUrl":null,"permalink":"/entire-note/music_build/","section":"Entire-Notes","summary":"æ­å»ºæœ¬ç«™éŸ³ä¹ #\ræ­å»ºè¿‡ç¨‹ç»•äº†ä¸€äº›å¼¯å­ï¼Œåƒäº†å‰ç«¯çš„äºï¼Œä¸»è¦å€Ÿé‰´äº†\ré‡‘åœ£çš“ï¼Œå¾—çŸ¥äº†ç›®å‰ä¸»æµçš„åšå®¢éŸ³ä¹ä¾æ‰˜äºAPlayer\u0026amp;Meting JS,å‰è€…æ˜¯åµŒå…¥HTMLçš„éŸ³ä¹ç»„ä»¶åº“ï¼Œåè€…æ˜¯å¯ç”¨é€šè¿‡ç½‘æ˜“ï¼ŒQQéŸ³ä¹ç­‰ç½‘ç«™çš„éŸ³ä¹æ’ä»¶ï¼Œæœ¬ç½‘ç«™ä½œä¸ºé™æ€é¡µé¢ï¼Œæ•…åªéœ€é€šè¿‡CDNå¼•å…¥å³å¯\nç½‘ç«™æ­å»ºä¸»é¢˜ä¸ºBlowfishï¼Œåœ¨blog/layouts/shortcodesæ–‡ä»¶å¤¹ä¸‹æ·»åŠ album.htmlæ–‡ä»¶\nè¿™é‡Œé‡‡ç”¨çš„æ˜¯ç½‘æ˜“éŸ³ä¹çš„æ­Œå•ï¼Œè·å–æ­Œå•idè‡ªè¡Œä»\r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rç½‘æ˜“äº‘éŸ³ä¹æ­Œå•ä¸­è·å–\n\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/color-thief@2.2.5/js/color-thief.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;span style=\u0026#34;color:#111827\u0026#34;\u0026gt; \u0026lt;!--{{.Get 0}}ä½œä¸ºæ­Œå•å‚æ•°ç”±å¼•ç”¨ç»„ä»¶å¤„æ·»åŠ --\u0026gt; \u0026lt;meting-js server=\u0026#34;netease\u0026#34; type=\u0026#34;playlist\u0026#34; id=\u0026#34;{{.","title":"Music","type":"entire-note"},{"content":"\ræ­å»ºæœ¬ç«™éŸ³ä¹ #\ræ­å»ºè¿‡ç¨‹ç»•äº†ä¸€äº›å¼¯å­ï¼Œåƒäº†å‰ç«¯çš„äºï¼Œä¸»è¦å€Ÿé‰´äº†\ré‡‘åœ£çš“ï¼Œå¾—çŸ¥äº†ç›®å‰ä¸»æµçš„åšå®¢éŸ³ä¹ä¾æ‰˜äºAPlayer\u0026amp;Meting JS,å‰è€…æ˜¯åµŒå…¥HTMLçš„éŸ³ä¹ç»„ä»¶åº“ï¼Œåè€…æ˜¯å¯ç”¨é€šè¿‡ç½‘æ˜“ï¼ŒQQéŸ³ä¹ç­‰ç½‘ç«™çš„éŸ³ä¹æ’ä»¶ï¼Œæœ¬ç½‘ç«™ä½œä¸ºé™æ€é¡µé¢ï¼Œæ•…åªéœ€é€šè¿‡CDNå¼•å…¥å³å¯\nMeting Jså‚æ•°,\rå®˜æ–¹æ–‡æ¡£\n\u0026lt;!--MetingJSå‚æ•°è¯¦æƒ…--\u0026gt; \u0026lt;!-- id=\u0026#39;å¤–é“¾æ’­æ”¾å™¨id\u0026#39;,å¿…é¡»å‚æ•° type=[song=å•æ›², playlist=æ­Œå•, album=ä¸“è¾‘, search=æœç´¢ç»“æœ, artist=è‰ºæœ¯å®¶],å¿…é¡»å‚æ•° server=[netease=ç½‘æ˜“äº‘éŸ³ä¹, tencent=QQéŸ³ä¹, kugou=é…·ç‹—éŸ³ä¹, xiami=è™¾ç±³éŸ³ä¹, baidu=ç™¾åº¦éŸ³ä¹],å¿…é¡»å‚æ•° fixed=å¯ç”¨å›ºå®šæ¨¡å¼ï¼Œå›ºå®šåœ¨å·¦ä¸‹è§’,é»˜è®¤false mini=å¯ç”¨è¿·ä½ æ¨¡å¼,é»˜è®¤false preload=[none,metadata,auto] mutex=[äº’æ–¥é”ï¼Œé»˜è®¤true],é»˜è®¤false order=[random=éšæœºæ’­æ”¾,list=åˆ—è¡¨æ’­æ”¾] loop=[all=å…¨éƒ¨å¾ªç¯, one=å¾ªç¯ä¸€æ¬¡ ,none=ä¸å¾ªç¯] volume=[éŸ³é‡ï¼Œé»˜è®¤0.7] lrc-type=[æ­Œè¯ç±»å‹ï¼Œé»˜è®¤0] list-folded=[åˆ—è¡¨æ˜¯å¦æŠ˜å ï¼Œé»˜è®¤false] list-max-height=åˆ—è¡¨æœ€å¤§é«˜åº¦,é»˜è®¤340px storage-name=æœ¬åœ°å­˜å‚¨å­˜å‚¨å¯†é’¥ï¼Œç”¨äºå­˜å‚¨æ’­æ”¾å™¨è®¾ç½®,é»˜è®¤metingjs --\u0026gt; ç½‘ç«™æ­å»ºä¸»é¢˜ä¸ºBlowfishï¼Œåœ¨blog/layouts/shortcodesæ–‡ä»¶å¤¹ä¸‹æ·»åŠ album.htmlæ–‡ä»¶\nè¿™é‡Œé‡‡ç”¨çš„æ˜¯ç½‘æ˜“éŸ³ä¹çš„æ­Œå•ï¼Œè·å–æ­Œå•idè‡ªè¡Œä»\r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rç½‘æ˜“äº‘éŸ³ä¹æ­Œå•ä¸­è·å–\n\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/color-thief@2.2.5/js/color-thief.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;span style=\u0026#34;color:#111827\u0026#34;\u0026gt; \u0026lt;!--{{.Get 0}}ä½œä¸ºæ­Œå•å‚æ•°ç”±å¼•ç”¨ç»„ä»¶å¤„æ·»åŠ --\u0026gt; \u0026lt;meting-js server=\u0026#34;netease\u0026#34; type=\u0026#34;playlist\u0026#34; id=\u0026#34;{{.Get 0}}\u0026#34; autoplay=\u0026#34;true\u0026#34; listFolded=\u0026#34;true\u0026#34;\u0026gt;\u0026lt;/meting-js\u0026gt; \u0026lt;/span\u0026gt; \u0026lt;hr/\u0026gt; åœ¨åšå®¢ç¬”è®°ä¸­æ·»åŠ mdæ–‡ä»¶ #\ræ•ˆæœï¼š #\r","date":"7 February 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/music/","section":"ç¬”è®°s","summary":"æ­å»ºæœ¬ç«™éŸ³ä¹ #\ræ­å»ºè¿‡ç¨‹ç»•äº†ä¸€äº›å¼¯å­ï¼Œåƒäº†å‰ç«¯çš„äºï¼Œä¸»è¦å€Ÿé‰´äº†\ré‡‘åœ£çš“ï¼Œå¾—çŸ¥äº†ç›®å‰ä¸»æµçš„åšå®¢éŸ³ä¹ä¾æ‰˜äºAPlayer\u0026amp;Meting JS,å‰è€…æ˜¯åµŒå…¥HTMLçš„éŸ³ä¹ç»„ä»¶åº“ï¼Œåè€…æ˜¯å¯ç”¨é€šè¿‡ç½‘æ˜“ï¼ŒQQéŸ³ä¹ç­‰ç½‘ç«™çš„éŸ³ä¹æ’ä»¶ï¼Œæœ¬ç½‘ç«™ä½œä¸ºé™æ€é¡µé¢ï¼Œæ•…åªéœ€é€šè¿‡CDNå¼•å…¥å³å¯\nMeting Jså‚æ•°,\rå®˜æ–¹æ–‡æ¡£\n\u0026lt;!--MetingJSå‚æ•°è¯¦æƒ…--\u0026gt; \u0026lt;!-- id=\u0026#39;å¤–é“¾æ’­æ”¾å™¨id\u0026#39;,å¿…é¡»å‚æ•° type=[song=å•æ›², playlist=æ­Œå•, album=ä¸“è¾‘, search=æœç´¢ç»“æœ, artist=è‰ºæœ¯å®¶],å¿…é¡»å‚æ•° server=[netease=ç½‘æ˜“äº‘éŸ³ä¹, tencent=QQéŸ³ä¹, kugou=é…·ç‹—éŸ³ä¹, xiami=è™¾ç±³éŸ³ä¹, baidu=ç™¾åº¦éŸ³ä¹],å¿…é¡»å‚æ•° fixed=å¯ç”¨å›ºå®šæ¨¡å¼ï¼Œå›ºå®šåœ¨å·¦ä¸‹è§’,é»˜è®¤false mini=å¯ç”¨è¿·ä½ æ¨¡å¼,é»˜è®¤false preload=[none,metadata,auto] mutex=[äº’æ–¥é”ï¼Œé»˜è®¤true],é»˜è®¤false order=[random=éšæœºæ’­æ”¾,list=åˆ—è¡¨æ’­æ”¾] loop=[all=å…¨éƒ¨å¾ªç¯, one=å¾ªç¯ä¸€æ¬¡ ,none=ä¸å¾ªç¯] volume=[éŸ³é‡ï¼Œé»˜è®¤0.","title":"æœ¬ç«™Musicæ­å»ºç›¸å…³","type":"ç¬”è®°"},{"content":"\r","date":"29 January 2024","externalUrl":null,"permalink":"/music/","section":"","summary":"\r","title":"éŸ³ä¹","type":"page"},{"content":"Spring Cloud Netflix ä»‹ç»\rNetflixå¥—ä»¶ä¸­æœ‰Eurekaã€Ribbonã€Hystrixã€Zuulã€Feignäº”ä¸ªéå¸¸çŸ¥åçš„å¼€æºé¡¹ç›®ï¼Œåˆ†åˆ«è¢«ç”¨äºæœåŠ¡æ²»ç†ã€è´Ÿè½½å‡è¡¡ã€æœåŠ¡å®¹é”™ã€æœåŠ¡ç½‘å…³ã€æœåŠ¡é€šä¿¡ã€‚\n2018å¹´ï¼ŒNetflixå¥—ä»¶ä¸­çš„å¼€æºé¡¹ç›®é™†ç»­è¿›å…¥äº†ç»´æŠ¤æ¨¡å¼ã€‚\n2020å¹´12æœˆ22æ—¥ï¼ŒSpring Cloud 2020.0.0ç‰ˆæœ¬å‘å¸ƒï¼Œè¯¥ç‰ˆæœ¬ä¸­ç§»é™¤äº†Netflixå¥—ä»¶ä¸­çš„ç›¸å…³ä¾èµ–ã€‚\nSpring Cloud Alibaba ä»‹ç»\r2018å¹´7æœˆï¼ŒSpring Cloud Alibabaæ­£å¼å¼€æºï¼Œè¿›å…¥Spring Cloudå­µåŒ–å™¨ã€‚2018å¹´10æœˆï¼ŒSpring Cloud Alibabaå‘å¸ƒå¼€æºåçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚\nSpring Cloud Alibabaæä¾›çš„ç»„ä»¶å¦‚ä¸‹ï¼š\nSentinelï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸ä»…ä»…å¯ä»¥ä½œä¸ºæ–­è·¯å™¨ï¼Œä¹Ÿæ”¯æŒæµé‡æ§åˆ¶å’ŒæœåŠ¡é™çº§ã€‚\rNacosï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼ŒæœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½œä¸ºé…ç½®ä¸­å¿ƒã€‚\rRocketMQï¼šé˜¿é‡Œå·´å·´å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯å’Œæµè®¡ç®—å¹³å°ã€‚\rDubboï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œé«˜æ€§èƒ½Java RPCæ¡†æ¶ï¼ŒæœåŠ¡é€šä¿¡ç»„ä»¶ã€‚\rSeataï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½å¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚\rAlibaba Cloud ACMï¼šå…¶å‰èº«ä¸ºæ·˜å®å†…éƒ¨é…ç½®ä¸­å¿ƒDiamondï¼Œæ˜¯ä¸€æ¬¾åº”ç”¨é…ç½®ä¸­å¿ƒäº§å“ï¼Œéœ€ä»˜è´¹ã€‚\rAlibaba Cloud OSSï¼šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨OSSæ˜¯ä¸€æ¬¾æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ï¼Œéœ€ä»˜è´¹ã€‚\rAlibaba Cloud SMSï¼šé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ï¼Œéœ€ä»˜è´¹ã€‚\rAlibaba Cloud SchedulerXï¼šé˜¿é‡Œä¸­é—´ä»¶è‡ªç ”çš„åŸºäºAkkaæ¶æ„çš„æ–°ä¸€ä»£åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œéœ€ä»˜è´¹ã€‚\rspring-cloud å’Œ spring-cloud-alibaba çš„åŒºåˆ«\rSpring Cloudï¼šSpring å®˜æ–¹æä¾›çš„åˆ†å¸ƒå¼åº”ç”¨å¼€å‘çš„ä¸€å¥—å…±ç”¨æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ç†è§£æˆä¸€å¥—å¾®æœåŠ¡å¼€å‘çš„ç»Ÿä¸€çš„æŠ½è±¡ç¼–ç¨‹æ¨¡å‹ã€‚\rSpring Cloud Netflixï¼šåŸºäº Spring Cloud ç¼–ç¨‹æ¨¡å‹å®ç°çš„å¾®æœåŠ¡æ¡†æ¶ï¼Œæ˜¯æœ€æ—©æœŸçš„å¾®æœåŠ¡æ¡†æ¶ã€‚è¿‘å¹´æ¥ï¼ŒNetflix å®£å¸ƒå¤§å¤šæ•°ç»„ä»¶åœæ­¢ç»´æŠ¤ã€‚\rSpring Cloud Alibabaï¼šAlibaba æä¾›çš„åŸºäº Spring Cloud ç¼–ç¨‹æ¨¡å‹å®ç°çš„å¾®æœåŠ¡æ¡†æ¶ï¼Œå…¶æ‰€æœ‰ç»„ä»¶éƒ½æ¥è‡ªäºé˜¿é‡Œå·´å·´å¾®æœåŠ¡æŠ€æœ¯ï¼Œæ— è®ºæ˜¯è§£å†³æ–¹æ¡ˆå®Œæ•´æ€§ã€æŠ€æœ¯æˆç†Ÿåº¦ã€ç¤¾åŒºè¿˜æ˜¯æ–‡æ¡£èµ„æ–™ç­‰éƒ½å¯¹å›½å†…å¼€å‘è€…éå¸¸å‹å¥½ã€‚\rspring-cloudæ˜¯Springå®˜æ–¹æä¾›çš„å¾®æœåŠ¡å¼€å‘å·¥å…·ã€‚å®ƒåŸºäºSpring Bootæ„å»ºï¼Œæä¾›äº†ä¸€ç³»åˆ—æ¡†æ¶å’Œå·¥å…·å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¾®æœåŠ¡æ¶æ„ã€‚spring-cloudä¸»è¦åŒ…å«ä»¥ä¸‹ç»„ä»¶:\nEureka:æœåŠ¡æ³¨å†Œä¸­å¿ƒ,ç”¨äºæœåŠ¡æ³¨å†Œä¸å‘ç°ã€‚\rRibbon:è´Ÿè½½å‡è¡¡å™¨,åœ¨æœåŠ¡è°ƒç”¨æ–¹è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚\rFeign:å£°æ˜å¼ REST å®¢æˆ·ç«¯,ç®€åŒ– RESTful API çš„è°ƒç”¨ã€‚\rHystrix:ç†”æ–­å™¨,å®¹é”™ç®¡ç†å·¥å…·,é˜²æ­¢åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çº§è”æ•…éšœã€‚\rConfig:é…ç½®ä¸­å¿ƒ,é€šè¿‡ Git ä»“åº“ç»Ÿä¸€ç®¡ç†åº”ç”¨é…ç½®ã€‚\rBus:äº‹ä»¶æ€»çº¿,ç”¨äºå¹¿æ’­é…ç½®æ–‡ä»¶å˜æ›´äº‹ä»¶ã€‚\rSleuth:è°ƒç”¨é“¾ç›‘æ§ç³»ç»Ÿ,ç”¨äºè·Ÿè¸ªå¾®æœåŠ¡ä¸­çš„è°ƒç”¨é“¾ä¿¡æ¯ã€‚\rStream:æ¶ˆæ¯é©±åŠ¨å¾®æœåŠ¡,ç®€åŒ–æ¶ˆæ¯ç³»ç»Ÿçš„ä½¿ç”¨ã€‚\rZuul:API ç½‘å…³,ç”¨äºè®¤è¯ã€ç›‘æ§å’Œè·¯ç”±è½¬å‘ç­‰åŠŸèƒ½ã€‚\rGateway:æ–°çš„ API ç½‘å…³,å–ä»£ Zuulã€‚\ré™¤æ­¤ä¹‹å¤–ï¼Œspring-cloudè¿˜æ”¯æŒä¸ç¬¬ä¸‰æ–¹ç»„ä»¶çš„æ•´åˆï¼Œå¦‚:\nKubernetes:å®¹å™¨ç¼–æ’å¹³å°çš„æ•´åˆã€‚\rNetflixç»„ä»¶:Ribbonã€Hystrixã€Zuul ç­‰ã€‚\rZookeeper:æœåŠ¡æ³¨å†Œå‘ç°ä¸é…ç½®ä¸­å¿ƒçš„æ”¯æŒã€‚\rConsul:æœåŠ¡æ³¨å†Œå‘ç°ä¸é…ç½®ä¸­å¿ƒçš„æ”¯æŒã€‚\rspring-cloud-alibabaæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ç»„ä»¶ï¼Œä¸»è¦åŒ…å«äº†é˜¿é‡Œå·´å·´åœ¨å¾®æœåŠ¡æ–¹é¢çš„è‹¥å¹²å¼€æºäº§å“ï¼Œspring-cloud-alibabaä¸­çš„ä¸»è¦ç»„ä»¶æœ‰:\nNacos:ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚\rDubbo:é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ªé«˜æ€§èƒ½ Java RPC æ¡†æ¶ã€‚\rRocketMQ:ä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿ,åŸºäºé«˜å¯ç”¨åˆ†å¸ƒå¼é›†ç¾¤æŠ€æœ¯,æä¾›ä½å»¶æ—¶çš„ã€é«˜å¯é çš„æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…æœåŠ¡ã€‚\rSeata:é˜¿é‡Œå·´å·´å¼€æºäº§å“,ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½å¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚\rSentinel:é˜¿é‡Œå·´å·´å¼€æºäº§å“,ä¸€ä¸ªæ§åˆ¶å¾®æœåŠ¡æµé‡çš„å¼€æºæ¡†æ¶ã€‚\ré™¤æ­¤ä¹‹å¤–ï¼Œspring-cloud-alibabaè¿˜æ•´åˆäº†Spring Cloudä¸ä¸Šè¿°ç»„ä»¶ï¼Œæä¾›äº†æ›´åŠ å®Œå–„çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦åŒ…å«:\nService Discovery:åŒ…å« Nacos ä¸ Eureka çš„å‘ç°ç»„ä»¶ã€‚\rConfiguration:Nacos é…ç½®ä¸­å¿ƒç»„ä»¶ã€‚\rMessaging:RocketMQ æ¶ˆæ¯ä¸­é—´ä»¶çš„æ•´åˆã€‚\rDistributed Transaction:Seata çš„åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒã€‚\rCircuit Breaker:Sentinel çš„ç†”æ–­ä¸é™æµæ”¯æŒã€‚\rGateway:ä¸ Spring Cloud Gateway çš„æ•´åˆã€‚\rSpring Cloud Dubbo ä» 2021.0.1.0 èµ·å·²è¢«ç§»é™¤å‡ºä¸»å¹²ï¼Œä¸å†éšä¸»å¹²æ¼”è¿›ã€‚\n","date":"26 January 2024","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%BC%94%E8%BF%9B/","section":"ç¬”è®°s","summary":"Spring Cloud Netflix ä»‹ç»\rNetflixå¥—ä»¶ä¸­æœ‰Eurekaã€Ribbonã€Hystrixã€Zuulã€Feignäº”ä¸ªéå¸¸çŸ¥åçš„å¼€æºé¡¹ç›®ï¼Œåˆ†åˆ«è¢«ç”¨äºæœåŠ¡æ²»ç†ã€è´Ÿè½½å‡è¡¡ã€æœåŠ¡å®¹é”™ã€æœåŠ¡ç½‘å…³ã€æœåŠ¡é€šä¿¡ã€‚\n2018å¹´ï¼ŒNetflixå¥—ä»¶ä¸­çš„å¼€æºé¡¹ç›®é™†ç»­è¿›å…¥äº†ç»´æŠ¤æ¨¡å¼ã€‚\n2020å¹´12æœˆ22æ—¥ï¼ŒSpring Cloud 2020.0.0ç‰ˆæœ¬å‘å¸ƒï¼Œè¯¥ç‰ˆæœ¬ä¸­ç§»é™¤äº†Netflixå¥—ä»¶ä¸­çš„ç›¸å…³ä¾èµ–ã€‚\nSpring Cloud Alibaba ä»‹ç»\r2018å¹´7æœˆï¼ŒSpring Cloud Alibabaæ­£å¼å¼€æºï¼Œè¿›å…¥Spring Cloudå­µåŒ–å™¨ã€‚2018å¹´10æœˆï¼ŒSpring Cloud Alibabaå‘å¸ƒå¼€æºåçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚\nSpring Cloud Alibabaæä¾›çš„ç»„ä»¶å¦‚ä¸‹ï¼š\nSentinelï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸ä»…ä»…å¯ä»¥ä½œä¸ºæ–­è·¯å™¨ï¼Œä¹Ÿæ”¯æŒæµé‡æ§åˆ¶å’ŒæœåŠ¡é™çº§ã€‚\rNacosï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼ŒæœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½œä¸ºé…ç½®ä¸­å¿ƒã€‚\rRocketMQï¼šé˜¿é‡Œå·´å·´å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯å’Œæµè®¡ç®—å¹³å°ã€‚\rDubboï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œé«˜æ€§èƒ½Java RPCæ¡†æ¶ï¼ŒæœåŠ¡é€šä¿¡ç»„ä»¶ã€‚\rSeataï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½å¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚\rAlibaba Cloud ACMï¼šå…¶å‰èº«ä¸ºæ·˜å®å†…éƒ¨é…ç½®ä¸­å¿ƒDiamondï¼Œæ˜¯ä¸€æ¬¾åº”ç”¨é…ç½®ä¸­å¿ƒäº§å“ï¼Œéœ€ä»˜è´¹ã€‚\rAlibaba Cloud OSSï¼šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨OSSæ˜¯ä¸€æ¬¾æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ï¼Œéœ€ä»˜è´¹ã€‚\rAlibaba Cloud SMSï¼šé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ï¼Œéœ€ä»˜è´¹ã€‚\rAlibaba Cloud SchedulerXï¼šé˜¿é‡Œä¸­é—´ä»¶è‡ªç ”çš„åŸºäºAkkaæ¶æ„çš„æ–°ä¸€ä»£åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œéœ€ä»˜è´¹ã€‚\rspring-cloud å’Œ spring-cloud-alibaba çš„åŒºåˆ«\rSpring Cloudï¼šSpring å®˜æ–¹æä¾›çš„åˆ†å¸ƒå¼åº”ç”¨å¼€å‘çš„ä¸€å¥—å…±ç”¨æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ç†è§£æˆä¸€å¥—å¾®æœåŠ¡å¼€å‘çš„ç»Ÿä¸€çš„æŠ½è±¡ç¼–ç¨‹æ¨¡å‹ã€‚\rSpring Cloud Netflixï¼šåŸºäº Spring Cloud ç¼–ç¨‹æ¨¡å‹å®ç°çš„å¾®æœåŠ¡æ¡†æ¶ï¼Œæ˜¯æœ€æ—©æœŸçš„å¾®æœåŠ¡æ¡†æ¶ã€‚è¿‘å¹´æ¥ï¼ŒNetflix å®£å¸ƒå¤§å¤šæ•°ç»„ä»¶åœæ­¢ç»´æŠ¤ã€‚\rSpring Cloud Alibabaï¼šAlibaba æä¾›çš„åŸºäº Spring Cloud ç¼–ç¨‹æ¨¡å‹å®ç°çš„å¾®æœåŠ¡æ¡†æ¶ï¼Œå…¶æ‰€æœ‰ç»„ä»¶éƒ½æ¥è‡ªäºé˜¿é‡Œå·´å·´å¾®æœåŠ¡æŠ€æœ¯ï¼Œæ— è®ºæ˜¯è§£å†³æ–¹æ¡ˆå®Œæ•´æ€§ã€æŠ€æœ¯æˆç†Ÿåº¦ã€ç¤¾åŒºè¿˜æ˜¯æ–‡æ¡£èµ„æ–™ç­‰éƒ½å¯¹å›½å†…å¼€å‘è€…éå¸¸å‹å¥½ã€‚\rspring-cloudæ˜¯Springå®˜æ–¹æä¾›çš„å¾®æœåŠ¡å¼€å‘å·¥å…·ã€‚å®ƒåŸºäºSpring Bootæ„å»ºï¼Œæä¾›äº†ä¸€ç³»åˆ—æ¡†æ¶å’Œå·¥å…·å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¾®æœåŠ¡æ¶æ„ã€‚spring-cloudä¸»è¦åŒ…å«ä»¥ä¸‹ç»„ä»¶:","title":"NetFlixå’ŒSpringCloudAlibaba","type":"ç¬”è®°"},{"content":"","date":"15 November 2023","externalUrl":null,"permalink":"/life-about/","section":"Life-Abouts","summary":"","title":"Life-Abouts","type":"life-about"},{"content":"","date":"15 November 2023","externalUrl":null,"permalink":"/tags/%E7%94%9F%E6%B4%BB/","section":"Tags","summary":"","title":"ç”Ÿæ´»","type":"tags"},{"content":"\rä»Šå¤©æ˜¯æˆ‘çš„ç”Ÿæ—¥ #\rå…¶å®æ—©ä¸Šèµ·æ¥éƒ½ä¸è®°å¾—æˆ‘çš„ç”Ÿæ—¥äº†ï¼Œä½†æ˜¯å¾®ä¿¡è¿˜æ˜¯æœ‰å¥³æœ‹å‹å’Œå¦ˆå¦ˆå’Œçˆ¸çˆ¸è¿˜æœ‰å§å§çš„å…³å¿ƒé—®å€™ã€‚\nä¸‹é›¨çš„å¤©æ°”ï¼Œåœ¨å¥³æœ‹å‹çš„å‚¬ä¿ƒä¸‹å»æ‹¿äº†åŒ—æ ¡çš„å¿«é€’ï¼Œæ˜¯èŠ±ï¼Œæˆ‘çŒœåˆ°äº†ï¼Œä½†æ˜¯æ‰“å¼€è¿˜æ˜¯æƒŠè‰³åˆ°æˆ‘äº†ï¼Œç™½ç«ç‘°çœŸçš„å¤ªæ¼‚äº®äº†ï¼ï¼ï¼è°¢è°¢ä½ æˆ‘æœ€çˆ±çš„Miss Liu\nå›æ¥çš„æ—¶å€™ï¼ŒæŠŠèŠ±èŠ±ç«‹èµ·æ¥äº†ï¼Œé»„ç¯ç…§èµ·æ¥çœŸçš„å¤ªæœ‰æ°›å›´æ„Ÿäº†ã€‚\næœ€åæ”¶åˆ°äº†æœ‹å‹çš„è›‹ç³•ï¼Œå®åœ¨æ„ŸåŠ¨ï¼Œä½†æ²¡è¯´ä¸Šå‡ å¥è¯ï¼Œå¾ˆæ„ŸåŠ¨ï¼Œè°¢è°¢å¤§å®¶ğŸ˜¸ğŸ¦¢\næœ‹å‹é€çš„è›‹ç³•\nåœ¨é›¨ä¸­ï¼Œæˆ‘é€”å¾„åŒ—æ ¡çš„è·å¡˜ã€‚\n","date":"15 November 2023","externalUrl":null,"permalink":"/life-about/birth/","section":"Life-Abouts","summary":"ä»Šå¤©æ˜¯æˆ‘çš„ç”Ÿæ—¥ #\rå…¶å®æ—©ä¸Šèµ·æ¥éƒ½ä¸è®°å¾—æˆ‘çš„ç”Ÿæ—¥äº†ï¼Œä½†æ˜¯å¾®ä¿¡è¿˜æ˜¯æœ‰å¥³æœ‹å‹å’Œå¦ˆå¦ˆå’Œçˆ¸çˆ¸è¿˜æœ‰å§å§çš„å…³å¿ƒé—®å€™ã€‚\nä¸‹é›¨çš„å¤©æ°”ï¼Œåœ¨å¥³æœ‹å‹çš„å‚¬ä¿ƒä¸‹å»æ‹¿äº†åŒ—æ ¡çš„å¿«é€’ï¼Œæ˜¯èŠ±ï¼Œæˆ‘çŒœåˆ°äº†ï¼Œä½†æ˜¯æ‰“å¼€è¿˜æ˜¯æƒŠè‰³åˆ°æˆ‘äº†ï¼Œç™½ç«ç‘°çœŸçš„å¤ªæ¼‚äº®äº†ï¼ï¼ï¼è°¢è°¢ä½ æˆ‘æœ€çˆ±çš„Miss Liu\nå›æ¥çš„æ—¶å€™ï¼ŒæŠŠèŠ±èŠ±ç«‹èµ·æ¥äº†ï¼Œé»„ç¯ç…§èµ·æ¥çœŸçš„å¤ªæœ‰æ°›å›´æ„Ÿäº†ã€‚\næœ€åæ”¶åˆ°äº†æœ‹å‹çš„è›‹ç³•ï¼Œå®åœ¨æ„ŸåŠ¨ï¼Œä½†æ²¡è¯´ä¸Šå‡ å¥è¯ï¼Œå¾ˆæ„ŸåŠ¨ï¼Œè°¢è°¢å¤§å®¶ğŸ˜¸ğŸ¦¢\næœ‹å‹é€çš„è›‹ç³•\nåœ¨é›¨ä¸­ï¼Œæˆ‘é€”å¾„åŒ—æ ¡çš„è·å¡˜ã€‚","title":"æˆ‘çš„ç”Ÿæ—¥","type":"life-about"},{"content":"","date":"14 November 2023","externalUrl":null,"permalink":"/algorithm/","section":"Algorithms","summary":"","title":"Algorithms","type":"algorithm"},{"content":"","date":"14 November 2023","externalUrl":null,"permalink":"/tags/leetcode/","section":"Tags","summary":"","title":"Leetcode","type":"tags"},{"content":"\rè®¡ç®—åŒºé—´ä¹‹é—´çš„æ‰€æœ‰æ•°çš„ä¸ªä½æ•°ä¹‹å’Œ #\ræ€è·¯ï¼š æ€»ä½“ç”¨æ•°å­¦åŠæ³•ï¼Œ45å¾ªç¯ï¼Œè¡¥é½ä¸å…¨çš„åŒºé—´\n#include \u0026#34;class/head.h\u0026#34; //å¯¼å…¥ä¸‡èƒ½ä¾èµ– long long Sum(long long left,long long right,long long len) { long long left_sum=0,right_sum=0; long long left_len,right_len; left_len=right_len=0; if(left!=0)//è®¡ç®—å·¦è¡¥é½ { left_sum=((left-1)*left)/2.0; left_len=left; } if(right!=9)//è®¡ç®—å³è¡¥é½ { right_sum=((right+10)*(9-right))/2.0; right_len=9-right; } long long cnt=0;//è¡¨ç¤ºæœ‰å¤šå°‘ä¸ª45ï¼Œ cnt=(len+left_len+right_len)/10;//ç®—æ€»ä¸ªæ•° long long sum=0; sum=cnt*45-left_sum-right_sum; return sum; } int main() { long long m,n; scanf(\u0026#34;%lld %lld\u0026#34;,\u0026amp;m,\u0026amp;n); //é€šè¿‡è¡¥ä½æ¥æ±‚ long long left=m%10,right=n%10; long long sum=0; if(m\u0026gt;=0) sum=Sum(left,right,n-m+1); else if(n\u0026lt;=0) sum=Sum(-right,-left,n-m+1); else sum=Sum(0,right,n+1)+Sum(0,-left,-m+1); printf(\u0026#34;%lld\u0026#34;,sum); return 0; } ","date":"14 November 2023","externalUrl":null,"permalink":"/algorithm/%E7%AE%97%E6%B3%95/%E6%95%B0%E5%AD%A6/","section":"Algorithms","summary":"è®¡ç®—åŒºé—´ä¹‹é—´çš„æ‰€æœ‰æ•°çš„ä¸ªä½æ•°ä¹‹å’Œ #\ræ€è·¯ï¼š æ€»ä½“ç”¨æ•°å­¦åŠæ³•ï¼Œ45å¾ªç¯ï¼Œè¡¥é½ä¸å…¨çš„åŒºé—´\n#include \u0026#34;class/head.h\u0026#34; //å¯¼å…¥ä¸‡èƒ½ä¾èµ– long long Sum(long long left,long long right,long long len) { long long left_sum=0,right_sum=0; long long left_len,right_len; left_len=right_len=0; if(left!=0)//è®¡ç®—å·¦è¡¥é½ { left_sum=((left-1)*left)/2.0; left_len=left; } if(right!","title":"åŒºé—´ä¸ªä½å’Œ","type":"algorithm"},{"content":"é¢˜ç›®ï¼š\nä¸¤æ•°ä¹‹å’Œ\nä¸‰æ•°ä¹‹å’Œ\nclass Main{ //ä¸¤æ•°ä¹‹å’Œ public static int[] twoSum(int[] nums, int target) { //æ‰¾å‡ºå’Œä¸ºtargetçš„æ•°ç»„ä¸­å…ƒç´ çš„ä¸‹æ ‡ï¼š HashMap\u0026lt;Integer,Integer\u0026gt; dic=new HashMap\u0026lt;\u0026gt;();//å’Œ int index=0; int dicIndex=0; int len=nums.length; Set\u0026lt;Integer\u0026gt; list=new HashSet\u0026lt;\u0026gt;(); for (int i=0;i\u0026lt;len;i++){ dic.put(i,nums[i]); } while(index\u0026lt;len\u0026amp;\u0026amp;dicIndex\u0026lt;len){ //3,2,4 if (nums[index]+dic.get(dicIndex)==target\u0026amp;\u0026amp;index!=dicIndex){ list.add(index); list.add(dicIndex); } index++; if (index==len){ dicIndex++; index=0; } } int[]res=new int[list.size()]; index=0; for (Integer item:list){ res[index]=item; index++; } return res; } //ä¸‰æ•°ä¹‹å’Œï¼Œè¿”å›åŠ èµ·æ¥ç­‰äº0çš„ä¸‰å…ƒæ•°ç»„ public static List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; threeSum(int[] nums) { Arrays.sort(nums);//å…ˆæ’åºå†äºŒåˆ† int len = nums.length; //nums = [-1,0,1,2,-1,-4] //è¾“å‡ºï¼š[[-1,-1,2],[-1,0,1]] List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; res=new ArrayList\u0026lt;\u0026gt;(); for (int i = 0; i \u0026lt; len; i++) { if (nums[i]\u0026gt;0){ return res; } if (i \u0026gt; 0 \u0026amp;\u0026amp; nums[i] == nums[i - 1]) continue; int left=i+1; int right=len-1; //äºŒåˆ†æ³•ï¼š while (right\u0026gt;left){ if (nums[i]+nums[left]+nums[right]\u0026gt;0){ right--; } else if (nums[i] + nums[left] + nums[right] \u0026lt; 0) { left++; } else { ArrayList\u0026lt;Integer\u0026gt; tmpList = new ArrayList\u0026lt;\u0026gt;(); tmpList.add(nums[i]); tmpList.add(nums[left]); tmpList.add(nums[right]); res.add(tmpList); while (right\u0026gt;left\u0026amp;\u0026amp;nums[right]==nums[right-1]){ right--; } while (right\u0026gt;left\u0026amp;\u0026amp;nums[left]==nums[left+1]){ left++; } right--; left++; } } } return res; } public static void main(String[] args) { int []arr={2,7,11,15}; Arrays.stream(twoSum(arr, 9)).forEach(System.out::println); } } ","date":"14 November 2023","externalUrl":null,"permalink":"/algorithm/%E7%AE%97%E6%B3%95/%E6%95%B0%E4%B9%8B%E5%92%8C/","section":"Algorithms","summary":"é¢˜ç›®ï¼š\nä¸¤æ•°ä¹‹å’Œ\nä¸‰æ•°ä¹‹å’Œ\nclass Main{ //ä¸¤æ•°ä¹‹å’Œ public static int[] twoSum(int[] nums, int target) { //æ‰¾å‡ºå’Œä¸ºtargetçš„æ•°ç»„ä¸­å…ƒç´ çš„ä¸‹æ ‡ï¼š HashMap\u0026lt;Integer,Integer\u0026gt; dic=new HashMap\u0026lt;\u0026gt;();//å’Œ int index=0; int dicIndex=0; int len=nums.length; Set\u0026lt;Integer\u0026gt; list=new HashSet\u0026lt;\u0026gt;(); for (int i=0;i\u0026lt;len;i++){ dic.","title":"æ•°ä¹‹å’Œ","type":"algorithm"},{"content":"æ•´ä¸ªé¡¹ç›®å¾ˆç®€å•ï¼Œä¸»è¦éœ€è¦æ³¨æ„ç‰ˆæœ¬çš„é—®é¢˜,è¿™ä¹Ÿæ˜¯å¾®æœåŠ¡çš„ä¸»è¦é—®é¢˜\nå¯åŠ¨æˆåŠŸ\nè¿˜æ˜¯è´´ä¸€ä¸‹mavenå¥½\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;project xmlns=\u0026#34;http://maven.apache.org/POM/4.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\u0026#34;\u0026gt; \u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt; \u0026lt;parent\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-parent\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.0.2\u0026lt;/version\u0026gt; \u0026lt;relativePath/\u0026gt; \u0026lt;!-- lookup parent from repository --\u0026gt; \u0026lt;/parent\u0026gt; \u0026lt;groupId\u0026gt;com.example\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;eureka\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.0.1-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;name\u0026gt;eureka\u0026lt;/name\u0026gt; \u0026lt;description\u0026gt;eureka\u0026lt;/description\u0026gt; \u0026lt;properties\u0026gt; \u0026lt;java.version\u0026gt;17\u0026lt;/java.version\u0026gt; \u0026lt;/properties\u0026gt; \u0026lt;dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2022.0.1\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;/dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-test\u0026lt;/artifactId\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-bootstrap\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- spring cloud é»˜è®¤é…ç½®å¯åŠ¨å™¨ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-config\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- spring cloud Eureka Server å¯åŠ¨å™¨ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-netflix-eureka-server\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-netflix-eureka-client\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;build\u0026gt; \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/plugins\u0026gt; \u0026lt;/build\u0026gt; \u0026lt;/project\u0026gt; ","date":"11 November 2023","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/eureka/","section":"ç¬”è®°s","summary":"æ•´ä¸ªé¡¹ç›®å¾ˆç®€å•ï¼Œä¸»è¦éœ€è¦æ³¨æ„ç‰ˆæœ¬çš„é—®é¢˜,è¿™ä¹Ÿæ˜¯å¾®æœåŠ¡çš„ä¸»è¦é—®é¢˜\nå¯åŠ¨æˆåŠŸ\nè¿˜æ˜¯è´´ä¸€ä¸‹mavenå¥½\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;project xmlns=\u0026#34;http://maven.apache.org/POM/4.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\u0026#34;\u0026gt; \u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt; \u0026lt;parent\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-parent\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.0.2\u0026lt;/version\u0026gt; \u0026lt;relativePath/\u0026gt; \u0026lt;!-- lookup parent from repository --\u0026gt; \u0026lt;/parent\u0026gt; \u0026lt;groupId\u0026gt;com.example\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;eureka\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.0.1-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;name\u0026gt;eureka\u0026lt;/name\u0026gt; \u0026lt;description\u0026gt;eureka\u0026lt;/description\u0026gt; \u0026lt;properties\u0026gt; \u0026lt;java.","title":"Eureka","type":"ç¬”è®°"},{"content":"","date":"11 November 2023","externalUrl":null,"permalink":"/tags/%E9%9A%8F%E6%9C%BA/","section":"Tags","summary":"","title":"éšæœº","type":"tags"},{"content":"æ‡’å¾—ç‚¹ç‚¹äº†ï¼Œå†™ä¸ªè„šæœ¬ç»´æŠ¤ç¬”è®°\nç›®å‰æ¥çœ‹æ•ˆæœè¿˜è¡Œ\n","date":"11 November 2023","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E6%8E%A8%E9%80%81%E7%AC%94%E8%AE%B0/","section":"ç¬”è®°s","summary":"æ‡’å¾—ç‚¹ç‚¹äº†ï¼Œå†™ä¸ªè„šæœ¬ç»´æŠ¤ç¬”è®°\nç›®å‰æ¥çœ‹æ•ˆæœè¿˜è¡Œ","title":"å†™ç‚¹è„šæœ¬","type":"ç¬”è®°"},{"content":"ç”±äºä¹‹å‰Vscodeè¯¯åˆ è¿™ä¸ªåšå®¢çš„ç¬”è®°äº†ï¼Œç°åœ¨åˆè¦ä»ä»“åº“æ‹‰åŸæ¥çš„ç¬”è®°ï¼Œå®åœ¨æ˜¯çƒ¦å¿ƒã€‚\nç°åœ¨æ€»ç®—çŸ¥é“å¤‡ä»½çš„é‡è¦æ€§äº†ã€‚\nå¼€ç§‘æŠ€ä¹Ÿä¸è¡Œï¼Œgithubæ˜¯çœŸæ…¢å•Šï¼ï¼ï¼åˆè¦å…ˆfetchå†pushäº†ã€‚ã€‚ã€‚ã€‚\né¾Ÿç¥–å®—ï¼Œå¥½äº†æ²¡å•Šï¼ï¼ï¼\næ€»ç®—å¥½å’¯\n","date":"11 November 2023","externalUrl":null,"permalink":"/life-about/%E9%9A%8F%E8%AE%B0/","section":"Life-Abouts","summary":"ç”±äºä¹‹å‰Vscodeè¯¯åˆ è¿™ä¸ªåšå®¢çš„ç¬”è®°äº†ï¼Œç°åœ¨åˆè¦ä»ä»“åº“æ‹‰åŸæ¥çš„ç¬”è®°ï¼Œå®åœ¨æ˜¯çƒ¦å¿ƒã€‚\nç°åœ¨æ€»ç®—çŸ¥é“å¤‡ä»½çš„é‡è¦æ€§äº†ã€‚\nå¼€ç§‘æŠ€ä¹Ÿä¸è¡Œï¼Œgithubæ˜¯çœŸæ…¢å•Šï¼ï¼ï¼åˆè¦å…ˆfetchå†pushäº†ã€‚ã€‚ã€‚ã€‚\né¾Ÿç¥–å®—ï¼Œå¥½äº†æ²¡å•Šï¼ï¼ï¼\næ€»ç®—å¥½å’¯","title":"æ²¡å¤‡ä»½ç¬”è®°çš„åæœ","type":"life-about"},{"content":"","date":"11 November 2023","externalUrl":null,"permalink":"/tags/%E9%9A%8F%E8%AE%B0/","section":"Tags","summary":"","title":"éšè®°","type":"tags"},{"content":"","date":"8 November 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"","title":"ç¼–ç¨‹è¯­è¨€s","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\rè®¤è¯†RabbitMQ #\rç¯å¢ƒï¼šubangtu #\rè®¿é—®åè®®ï¼š amqp\näº†è§£å®‰è£…ï¼ˆåæ­£ä¹Ÿè®°ä¸ä½ï¼‰ï¼š\nsudo apt install erlang sudo apt install rabbitmq-server sudo rabbitmqctl status sudo rabbitmq-plugins enable rabbitmq_management sudo rabbitmqctl add_user ç”¨æˆ·å å¯†ç  sudo rabbitmqctl set_user_tags admin administrator è®¾è®¡æ¶æ„å›¾ï¼š\n**ç”Ÿäº§è€…ï¼ˆPublisherï¼‰å’Œæ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼š**ä¸ç”¨å¤šè¯´äº†å§ã€‚ **Channelï¼š**æˆ‘ä»¬çš„å®¢æˆ·ç«¯è¿æ¥éƒ½ä¼šä½¿ç”¨ä¸€ä¸ªChannelï¼Œå†é€šè¿‡Channelå»è®¿é—®åˆ°RabbitMQæœåŠ¡å™¨ï¼Œæ³¨æ„é€šä¿¡åè®®ä¸æ˜¯httpï¼Œè€Œæ˜¯amqpåè®®ã€‚ **Exchangeï¼š**ç±»ä¼¼äºäº¤æ¢æœºä¸€æ ·çš„å­˜åœ¨ï¼Œä¼šæ ¹æ®æˆ‘ä»¬çš„è¯·æ±‚ï¼Œè½¬å‘ç»™ç›¸åº”çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½å¯ä»¥ç»‘å®šåˆ°Exchangeä¸Šï¼Œè¿™æ ·Exchangeå°±å¯ä»¥å°†æ•°æ®è½¬å‘ç»™é˜Ÿåˆ—äº†ï¼Œå¯ä»¥å­˜åœ¨å¾ˆå¤šä¸ªï¼Œä¸åŒçš„Exchangeç±»å‹å¯ä»¥ç”¨äºå®ç°ä¸åŒæ¶ˆæ¯çš„æ¨¡å¼ã€‚ **Queueï¼š**æ¶ˆæ¯é˜Ÿåˆ—æœ¬ä½“ï¼Œç”Ÿäº§è€…æ‰€æœ‰çš„æ¶ˆæ¯éƒ½å­˜æ”¾åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…æ¶ˆè´¹è€…å–å‡ºã€‚ **Virtual Hostï¼š**æœ‰ç‚¹ç±»ä¼¼äºç¯å¢ƒéš”ç¦»ï¼Œä¸åŒç¯å¢ƒéƒ½å¯ä»¥å•ç‹¬é…ç½®ä¸€ä¸ªVirtual Hostï¼Œæ¯ä¸ªVirtual Hostå¯ä»¥åŒ…å«å¾ˆå¤šä¸ªExchangeå’ŒQueueï¼Œæ¯ä¸ªVirtual Hostç›¸äº’ä¹‹é—´ä¸å½±å“ã€‚\näº¤æ¢æœº #\räº¤æ¢æœºæœ‰æŒä¹…åŒ–å’ŒçŸ­æš‚åŒºåˆ†\né»˜è®¤äº¤æ¢æœºï¼šAMQP defaultï¼ŒæŸ¥æ‰¾æ–¹æ³•ï¼šæ ¹æ®åç§°æ¥ç¡®å®š æ™®é€šç›´è¿äº¤æ¢æœºï¼šè®©æŸä¸ªé˜Ÿåˆ—ç›´æ¥ç»‘å®šï¼ŒæŸ¥æ‰¾æ–¹æ³•ï¼šroutingKeyæŒ‡å®šå“ªä¸€ä¸ªé˜Ÿåˆ— åˆ›å»ºé˜Ÿåˆ— #\rè·å–æ¶ˆæ¯æ¨¡å¼ Ack Mode #\ræ‹’ç»æ¶ˆæ¯ï¼šNack mq true\nç¡®è®¤åº”ç­”ï¼šAck mq false\næ‹’ç»æ¶ˆæ¯ï¼šReject mq true/false\nRabbitMqæ•´åˆSpringBoot #\råˆ›å»ºé˜Ÿåˆ—ï¼š #\r@Configuration public class RabbitConfiguration { @Bean(\u0026#34;directExchange\u0026#34;) //å®šä¹‰äº¤æ¢æœºBeanï¼Œå¯ä»¥å¾ˆå¤šä¸ª public Exchange exchange(){ return ExchangeBuilder.directExchange(\u0026#34;amq.direct\u0026#34;).build(); } @Bean(\u0026#34;yydsQueue\u0026#34;) //å®šä¹‰æ¶ˆæ¯é˜Ÿåˆ— public Queue queue(){ return QueueBuilder .nonDurable(\u0026#34;my-rainy\u0026#34;) //éæŒä¹…åŒ–ç±»å‹ .build(); } @Bean(\u0026#34;binding\u0026#34;) public Binding binding(@Qualifier(\u0026#34;directExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue\u0026#34;) Queue queue){ //å°†æˆ‘ä»¬åˆšåˆšå®šä¹‰çš„äº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®š return BindingBuilder .bind(queue) //ç»‘å®šé˜Ÿåˆ— .to(exchange) //åˆ°äº¤æ¢æœº .with(\u0026#34;rainy\u0026#34;) //ä½¿ç”¨è‡ªå®šä¹‰çš„routingKey .noargs(); } //è½¬æ¢ä¸ºJsonå®ä½“æ•°æ® @Bean(name = \u0026#34;Jackson2JsonMessageConverter\u0026#34;) public Jackson2JsonMessageConverter jsonMessageConverter(){ return new Jackson2JsonMessageConverter(); } } åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œåˆ›å»ºäº†é˜Ÿåˆ—å¹¶ä¸”ç»‘å®šäº†routingkeyå’Œå¯¹åº”çš„äº¤æ¢æœºï¼ŒåŒæ—¶åŠ å…¥äº†è‡ªå®šä¹‰çš„jsonè½¬æ¢å™¨ä»¶\nå‘é€æ¶ˆæ¯ #\râ€”â€”\u0026gt; å€ŸåŠ©RabbitTemplate\n@SpringBootTest @Import(RabbitConfiguration.class) class RabbitmqDemoApplicationTests { //æ¶ˆæ¯è§£é‡Šå™¨ @Resource RabbitTemplate template; @Test void publisher() { //ä½¿ç”¨convertAndSendæ–¹æ³•ä¸€æ­¥åˆ°ä½ï¼Œå‚æ•°åŸºæœ¬å’Œä¹‹å‰æ˜¯ä¸€æ ·çš„ //æœ€åä¸€ä¸ªæ¶ˆæ¯æœ¬ä½“å¯ä»¥æ˜¯Objectç±»å‹ï¼ŒçœŸæ˜¯å¤§å¤§çš„æ–¹ä¾¿ template.convertAndSend(\u0026#34;amq.direct\u0026#34;, \u0026#34;rainy\u0026#34;, \u0026#34;Hello World!\u0026#34;);//å‘é€æ¶ˆæ¯ //å¦‚ä½•çŸ¥é“å‘é€çš„æ¶ˆæ¯æ˜¯å¦ç»è¿‡å¤„ç†äº†ï¼Ÿ Object ackMsg = template.convertSendAndReceive(\u0026#34;amq.direct\u0026#34;, \u0026#34;rainy\u0026#34;, \u0026#34;Hello World!\u0026#34;); } } å¤„ç†æ¶ˆæ¯ #\r/** * TestListener * ç›‘å¬å™¨ï¼Œå®é™…ä¸Šä½œä¸ºæ¶ˆè´¹è€… * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ * @since 2023/11/10 0:12 */ @Component //æ³¨å†Œä¸ºBean,ä½œä¸ºæ¥å—æ¶ˆæ¯åŒæ—¶å¤„ç†è¿”å›çš„ç›‘å¬å™¨ public class TestListener { @RabbitListener(queues = \u0026#34;rainy\u0026#34;) //å®šä¹‰æ­¤æ–¹æ³•ä¸ºé˜Ÿåˆ—rainyçš„ç›‘å¬å™¨ï¼Œä¸€æ—¦ç›‘å¬åˆ°æ–°çš„æ¶ˆæ¯ï¼Œå°±ä¼šæ¥å—å¹¶å¤„ç† public void test(Message message){ System.out.println(new String(message.getBody()));//æ‰“å°æ¶ˆæ¯ä½“,æ¶ˆæ¯payloadå¯ä»¥è‡ªåŠ¨è½¬æ¢æˆæ¶ˆæ¯å®ä½“ } @RabbitListener(queues = \u0026#34;rainy\u0026#34;) //å®šä¹‰æ­¤æ–¹æ³•ä¸ºé˜Ÿåˆ—rainyçš„ç›‘å¬å™¨ï¼Œä¸€æ—¦ç›‘å¬åˆ°æ–°çš„æ¶ˆæ¯ï¼Œå°±ä¼šæ¥å—å¹¶å¤„ç†ï¼ŒåŒæ—¶è¿˜è¦è¿”å›å“åº”ä¿¡æ¯ public String ackMsg(Message message){ System.out.println(new String(message.getBody()));//æ‰“å°æ¶ˆæ¯ä½“,æ¶ˆæ¯payloadå¯ä»¥è‡ªåŠ¨è½¬æ¢æˆæ¶ˆæ¯å®ä½“ return \u0026#34;å“åº”æˆåŠŸï¼\u0026#34;; } @RabbitListener(queues = \u0026#34;rainy\u0026#34;,messageConverter = \u0026#34;Jackson2JsonMessageConverter\u0026#34;) //å®šä¹‰æ­¤æ–¹æ³•ä¸ºé˜Ÿåˆ—rainyçš„ç›‘å¬å™¨ï¼Œä¸€æ—¦ç›‘å¬åˆ°æ–°çš„æ¶ˆæ¯ï¼Œå°±ä¼šæ¥å—å¹¶å¤„ç†ï¼ŒåŒæ—¶è¿˜è¦è¿”å›å“åº”ä¿¡æ¯ public String ackDTOMsg(Account message){ System.out.println(message);//æ‰“å°æ¶ˆæ¯ä½“,ä½¿ç”¨å®šä¹‰å¥½çš„jsonè½¬æ¢å™¨æ¥è½¬æ¢æ¶ˆæ¯ä¸­çš„jsonæ•°æ® return \u0026#34;å“åº”æˆåŠŸï¼\u0026#34;; } } æ¶ˆæ¯é˜Ÿåˆ— #\ræ­»ä¿¡é˜Ÿåˆ— #\råˆ¤å®šæ­»ä¿¡ï¼š\næ¶ˆæ¯è¢«æ‹’ç» æ¶ˆæ¯TTLè¿‡æœŸ é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦ï¼Œç›¸å½“äºè¢«æ‹’ç»reject æ­»ä¿¡é˜Ÿåˆ—åˆ›å»ºå’Œç›‘å¬å’Œæ­£å¸¸é˜Ÿåˆ—å·®ä¸å¤š\nRabbitMQæ”¯æŒå°†è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡è¢«æ¶ˆè´¹çš„æ¶ˆæ¯è‡ªåŠ¨åˆ é™¤ï¼Œè¿™éœ€è¦æ¶ˆæ¯é˜Ÿåˆ—è®¾å®šTTLå€¼ï¼Œå¦‚æœæ¶ˆæ¯çš„å­˜æ´»æ—¶é—´è¶…è¿‡äº†Time To Liveå€¼ï¼Œå°±ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œè‡ªåŠ¨åˆ é™¤åçš„æ¶ˆæ¯å¦‚æœæœ‰æ­»ä¿¡é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚\nå¦‚æœåˆ°è¾¾é˜Ÿåˆ—é•¿åº¦é™åˆ¶ï¼Œé‚£ä¹ˆæ¯æ¬¡æ’å…¥éƒ½ä¼šæŠŠä½äºé˜Ÿé¦–çš„æ¶ˆæ¯ä¸¢è¿›æ­»ä¿¡é˜Ÿåˆ—ï¼Œæ¥è…¾å‡ºç©ºé—´ç»™æ–°æ¥çš„æ¶ˆæ¯ã€‚\nå·¥ä½œé˜Ÿåˆ—æ¨¡å¼ #\rè½®è¯¢åˆ†å‘æ¶ˆæ¯ï¼šé»˜è®¤äº¤æ›¿åˆ†å‘æ¶ˆæ¯ï¼Œä½†æ¯ä¸ªæ¶ˆè´¹è€…éƒ½æœ‰ä¸€ä¸ªé¢„å…ˆè·å–æ•°é‡ï¼Œæœ€å¼€å§‹ä¸€æ¬¡æ€§è·å–æ•°é‡ä¸ä¸€å®šæ˜¯1\né…ç½®æ¶ˆè´¹è€…é¢„è·å–æ•°é‡ï¼š\n@Resource private CachingConnectionFactory connectionFactory; @Bean(name = \u0026#34;listenerContainer\u0026#34;) public SimpleRabbitListenerContainerFactory listenerContainer(){ SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory(); factory.setConnectionFactory(connectionFactory); factory.setPrefetchCount(1); //å°†PrefetchCountè®¾å®šä¸º1è¡¨ç¤ºä¸€æ¬¡åªèƒ½å–ä¸€ä¸ª return factory; } é…ç½®ç›‘å¬å™¨ï¼š\n//æŒ‡å®šçš„ç›‘å¬å™¨å·¥å‚å’Œæ¶ˆè´¹è€…æ•°é‡ @RabbitListener(queues = \u0026#34;rainy\u0026#34;,containerFactory = \u0026#34;listenerContainer\u0026#34;,concurrency = \u0026#34;10\u0026#34;) public void listenMsg(Message message){ System.out.println(message); } å‘å¸ƒè®¢é˜…æ¨¡å¼ #\ræ³¨æ„è¿™æ—¶å€™äº¤æ¢æœºå·²ç»å‘ç”Ÿå˜åŒ–äº†ï¼Œç›´è¿äº¤æ¢æœºä¸å¯è¡Œï¼Œéœ€è¦ä½¿ç”¨channel-exchangeä¸€å¯¹å¤šä¹Ÿå°±æ˜¯amq.finoutï¼Œæ‰‡å‡ºç±»å‹\nè·¯ç”±æ¨¡å¼ #\ré€šè¿‡è·¯ç”±æ¥ç¡®å®šç»‘å®šåˆ°å“ªäº›é˜Ÿåˆ—é‡Œé¢å»\né€šè¿‡æŒ‡å®šä¸åŒçš„routingkeyæ¥å®ç°\n@Configuration public class RabbitConfiguration { @Bean(\u0026#34;fanoutExchange\u0026#34;) public Exchange exchange(){ //æ³¨æ„è¿™é‡Œæ˜¯fanoutExchange return ExchangeBuilder.fanoutExchange(\u0026#34;amq.fanout\u0026#34;).build(); } @Bean(\u0026#34;yydsQueue1\u0026#34;) public Queue queue(){ return QueueBuilder.nonDurable(\u0026#34;yyds1\u0026#34;).build(); } @Bean(\u0026#34;binding\u0026#34;) public Binding binding(@Qualifier(\u0026#34;fanoutExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue1\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;yyds1\u0026#34;) .noargs(); } @Bean(\u0026#34;yydsQueue2\u0026#34;) public Queue queue2(){ return QueueBuilder.nonDurable(\u0026#34;yyds2\u0026#34;).build(); } @Bean(\u0026#34;binding2\u0026#34;) public Binding binding2(@Qualifier(\u0026#34;fanoutExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue2\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;yyds2\u0026#34;) .noargs(); } } ä¸»é¢˜æ¨¡å¼ trace #\ré€šè¿‡routingKeyçš„æ¨¡ç³ŠåŒ¹é…æ¥å®ç°ï¼Œå¸®åŠ©è¿›è¡Œæ—¥å¿—è¿½è¸ª\nç¬¬å››ç§äº¤æ¢æœºç±»å‹ï¼ˆä½¿ç”¨å¤´éƒ¨ä¿¡æ¯æ¥å®ç°è·¯ç”±æ¶ˆæ¯åˆ°é˜Ÿåˆ—ä¸­ï¼‰ #\rå·²ç»ä»‹ç»äº†ä¸‰ç§äº¤æ¢æœºç±»å‹ï¼Œç°åœ¨æ¥ä»‹ç»ä¸€ä¸‹ç¬¬å››ç§äº¤æ¢æœºç±»å‹headerï¼Œå®ƒæ˜¯æ ¹æ®å¤´éƒ¨ä¿¡æ¯æ¥å†³å®šçš„ï¼Œ åœ¨æˆ‘ä»¬å‘é€çš„æ¶ˆæ¯ä¸­æ˜¯å¯ä»¥æºå¸¦ä¸€äº›å¤´éƒ¨ä¿¡æ¯çš„ï¼ˆç±»ä¼¼äºHTTPï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™äº›å¤´éƒ¨ä¿¡æ¯æ¥å†³å®šè·¯ç”±åˆ°å“ªä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚\næ­å»ºé›†ç¾¤ #\rsudo rabbitmqctl stop_app sudo rabbitmqctl join_cluster rabbit@ubuntu-server sudo rabbitmqctl start_app SpringCloudæ¶ˆæ¯ç»„ä»¶ #\rKafKa?RabbitMq?\nå°è¯•æ­å»ºå¾®æœåŠ¡é¡¹ç›®\n","date":"7 November 2023","externalUrl":null,"permalink":"/entire-note/mq/","section":"Entire-Notes","summary":"è®¤è¯†RabbitMQ #\rç¯å¢ƒï¼šubangtu #\rè®¿é—®åè®®ï¼š amqp\näº†è§£å®‰è£…ï¼ˆåæ­£ä¹Ÿè®°ä¸ä½ï¼‰ï¼š\nsudo apt install erlang sudo apt install rabbitmq-server sudo rabbitmqctl status sudo rabbitmq-plugins enable rabbitmq_management sudo rabbitmqctl add_user ç”¨æˆ·å å¯†ç  sudo rabbitmqctl set_user_tags admin administrator è®¾è®¡æ¶æ„å›¾ï¼š","title":"RabbitMq","type":"entire-note"},{"content":"","date":"7 November 2023","externalUrl":null,"permalink":"/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/","section":"Tags","summary":"","title":"æ¶ˆæ¯é˜Ÿåˆ—","type":"tags"},{"content":"","date":"4 November 2023","externalUrl":null,"permalink":"/tags/vue/","section":"Tags","summary":"","title":"Vue","type":"tags"},{"content":"\rVue3 å“åº”å¼Apiå¼€å‘ç¬”è®° #\rç›®å½•ç»“æ„ï¼š #\rç”¨viteæ„å»ºçš„Vue3ç›®å½•ç»“æ„ï¼š\nsrc:\nè¿™é‡Œæ˜¯æˆ‘ä»¬è¦å¼€å‘çš„ç›®å½•ï¼ŒåŸºæœ¬ä¸Šè¦åšçš„äº‹æƒ…éƒ½åœ¨è¿™ä¸ªç›®å½•é‡Œã€‚é‡Œé¢åŒ…å«äº†å‡ ä¸ªç›®å½•åŠæ–‡ä»¶ï¼š\nassets: æ”¾ç½®ä¸€äº›å›¾ç‰‡ï¼Œå¦‚logoç­‰ã€‚ components: ç›®å½•é‡Œé¢æ”¾äº†ä¸€ä¸ªç»„ä»¶æ–‡ä»¶ï¼Œå¯ä»¥ä¸ç”¨ã€‚ App.vue: é¡¹ç›®å…¥å£æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å°†ç»„ä»¶å†™è¿™é‡Œï¼Œè€Œä¸ä½¿ç”¨ components ç›®å½•ã€‚ main.js: é¡¹ç›®çš„æ ¸å¿ƒæ–‡ä»¶ã€‚ index.css: æ ·å¼æ–‡ä»¶ã€‚ static\té™æ€èµ„æºç›®å½•ï¼Œå¦‚å›¾ç‰‡ã€å­—ä½“ç­‰ã€‚\npublic\tå…¬å…±èµ„æºç›®å½•ã€‚\npackage.json\té¡¹ç›®é…ç½®æ–‡ä»¶ã€‚\nvue3åˆ›å»ºåº”ç”¨ #\rå®é™…æ¡ˆä¾‹ #\rè¯­æ³•ï¼š const app = Vue.createApp({ /* é€‰é¡¹ */ }) ä¼ é€’ç»™ createApp çš„é€‰é¡¹ç”¨äºé…ç½®æ ¹ç»„ä»¶ã€‚åœ¨ä½¿ç”¨ mount() æŒ‚è½½åº”ç”¨æ—¶ï¼Œè¯¥ç»„ä»¶è¢«ç”¨ä½œæ¸²æŸ“çš„èµ·ç‚¹ã€‚\næ¡ˆä¾‹ï¼š\nVue.createApp(HelloVueApp).mount(\u0026#39;#hello-vue\u0026#39;) //createApp çš„å‚æ•°æ˜¯æ ¹ç»„ä»¶ï¼ˆHelloVueAppï¼‰ï¼Œåœ¨æŒ‚è½½åº”ç”¨æ—¶ï¼Œè¯¥ç»„ä»¶æ˜¯æ¸²æŸ“çš„èµ·ç‚¹ã€‚ ä¸€ä¸ªåº”ç”¨éœ€è¦è¢«æŒ‚è½½åˆ°ä¸€ä¸ª DOM å…ƒç´ ä¸­ï¼Œä»¥ä¸Šä»£ç ä½¿ç”¨ mount(\u0026rsquo;#hello-vue\u0026rsquo;) å°† Vue åº”ç”¨ HelloVueApp æŒ‚è½½åˆ° ä¸­ã€‚\nä¹Ÿå°±æ˜¯è¯´vue3æ˜¯æŠŠåº”ç”¨ç¨‹åºæŒ‚è½½åˆ°mountä¸‹é¢çš„èŠ‚ç‚¹ä¸Šçš„ï¼Œä½œä¸ºæ¸²æŸ“é¡µé¢çš„èµ·ç‚¹\ndataé€‰é¡¹ #\rdata é€‰é¡¹æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚Vue åœ¨åˆ›å»ºæ–°ç»„ä»¶å®ä¾‹çš„è¿‡ç¨‹ä¸­è°ƒç”¨æ­¤å‡½æ•°ã€‚å®ƒåº”è¯¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶å Vue ä¼šé€šè¿‡å“åº”æ€§ç³»ç»Ÿå°†å…¶åŒ…è£¹èµ·æ¥ï¼Œå¹¶ä»¥ $data çš„å½¢å¼å­˜å‚¨åœ¨ç»„ä»¶å®ä¾‹ä¸­ã€‚\nsetupé€‰é¡¹ #\rsetupåˆ›å»ºéå¸¸å‰é¢ï¼š\nå› æ­¤åœ¨setupä¸­å°†ä¸èƒ½ä½¿ç”¨thiså…³é”®å­—\n\u0026lt;script \u0026gt; import {ref,reactive} from \u0026#34;vue\u0026#34;; export default { name:\u0026#39;HelloWorld\u0026#39;, setup(){ let msg=\u0026#39;Hello World\u0026#39; let color=\u0026#39;red\u0026#39; let age=ref(20) //å£°æ˜å¯¹è±¡ï¼š let Person=reactive({ name:\u0026#34;å°æ˜\u0026#34;, age:20, school:\u0026#39;HNUST\u0026#39; }) return{msg,color,age,Person} }, } \u0026lt;/script\u0026gt; \u0026lt;template\u0026gt; \u0026lt;h1 style=\u0026#34;color: red;text-align: center\u0026#34;\u0026gt;{{msg}},æˆ‘ä»Šå¹´{{age}}å²å•¦ï¼\u0026lt;/h1\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;h2\u0026gt;{{Person}}\u0026lt;/h2\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;style scoped\u0026gt; \u0026lt;/style\u0026gt; æ‰€æœ‰çš„å˜é‡ï¼ˆæ•°æ®æˆ–è€…å‡½æ•°ï¼‰éƒ½å¿…é¡»è¿”å›å‡ºå»æ‰å¯ä»¥ä½¿ç”¨\nsetupè¯­æ³•ç³– #\r\u0026lt;script setup\u0026gt; //ä¸éœ€è¦æ‰‹åŠ¨returnï¼Œå†™å…¥å†…éƒ¨å°†ä¼šè‡ªåŠ¨return \u0026lt;/script\u0026gt; reactiveå’Œref #\ré»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®å¹¶ä¸æ˜¯å“åº”å¼çš„æ•°æ®ï¼Œéœ€è¦é€šè¿‡è¿™ä¸¤ä¸ªå…³é”®å­—æ¥å£°æ˜å“åº”å¼æ•°æ®\nå¯¹è±¡ç±»å‹ï¼šreactiveè¿”å›å“åº”å¼å¯¹è±¡\nåŸºæœ¬æ•°æ®ï¼šrefåŒ…äº†ä¸€å±‚å¯¹è±¡ï¼Œè®¿é—®æ•°æ®éœ€è¦é€šè¿‡.value,templateè®¿é—®æ—¶ä¸éœ€è¦\nå»ºè®®å£°æ˜æ•°æ®ç”¨refï¼Œæ— è®ºå¯¹è±¡è¿˜æ˜¯åŸå§‹æ•°æ®\n\u0026lt;script xmlns=\u0026#34;http://www.w3.org/1999/html\u0026#34; setup\u0026gt; import {ref, reactive, watch} from \u0026#34;vue\u0026#34;; name=\u0026#39;WatchParam\u0026#39; const count=ref(0); const clickTimes=ref(0); function button(){ clickTimes.value++; console.log(clickTimes) } //ç›‘å¬æ™®é€šå˜é‡ï¼š watch(clickTimes,(newV,OldV)=\u0026gt;{ count.value=newV console.log(count) }) \u0026lt;/script\u0026gt; \u0026lt;template\u0026gt; \u0026lt;button @click=\u0026#34;button\u0026#34;\u0026gt;ç‚¹å‡»è¿™ä¸ª +1\u0026lt;/button\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;h3\u0026gt;{{clickTimes}}\u0026lt;/h3\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;h3\u0026gt;{{count}}\u0026lt;/h3\u0026gt; \u0026lt;/template\u0026gt; ç»„åˆå¼API-computed #\r\u0026lt;script setup\u0026gt; //è®¡ç®—å±æ€§ import {computed, ref} from \u0026#34;vue\u0026#34;; const list=ref([1,2,3,4,5,6,7,8]) //åŸºäºlistæ´¾ç”Ÿæ•°æ® const res=computed(()=\u0026gt;{ return list.value.filter(item =\u0026gt;item\u0026gt;4) }) const arr=ref([]) const additem=()=\u0026gt;{ arr.value.push(\u0026#34;ç§‘ç›®ä¸‰å¿…è¿‡\u0026#34;) } \u0026lt;/script\u0026gt; \u0026lt;template\u0026gt; \u0026lt;h3\u0026gt;{{list}}\u0026lt;/h3\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;h3\u0026gt;{{res}}\u0026lt;/h3\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;h3\u0026gt;{{arr}}\u0026lt;/h3\u0026gt; \u0026lt;br/\u0026gt; \u0026lt;button @click=\u0026#34;additem\u0026#34;\u0026gt;ç‚¹å‡»æ·»åŠ æ•°æ®\u0026lt;/button\u0026gt; \u0026lt;/template\u0026gt; è¦æ±‚ï¼šè®¡ç®—å±æ€§ä¸è¦å»å¤„ç†è¯·æ±‚å’Œä¿®ç¨¿domæ ‘\nwatchå‡½æ•° #\rä¾¦å¯Ÿå•ä¸ªå…ƒç´ æˆ–è€…ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶ä¾¦å¬å¤šä¸ªæ•°æ®ä¹Ÿå¯\n\u0026lt;script setup\u0026gt; watch([clickTimes,count],(newV,OldV)=\u0026gt;{ count.value=newV console.log(OldV) console.log(count) }) \u0026lt;/script\u0026gt; ç«‹å³æ‰§è¡Œï¼šimmediate:true #\ræ·±å±‚ç›‘è§†ï¼šdeep:true æ‰€æœ‰å±æ€§éƒ½å°†ä¼šè¢«ç›‘å¬ #\rä¿®æ”¹æ‰å‡ºå‘ç›‘å¬çš„å›è°ƒå‡½æ•°ï¼š #\rwatch(()=\u0026gt;count,(newV,OldV)=\u0026gt;{ count.value=newV console.log(OldV) console.log(count) }) ç”Ÿå‘½å‘¨æœŸå‡½æ•° #\rcreatedå’ŒonMounted\nå¯¹åº”å…³ç³»\n\u0026lt;script setup\u0026gt; import {onMounted} from \u0026#34;vue\u0026#34;; onMounted(()=\u0026gt;{ console.log(\u0026#34;ç”Ÿå‘½å‘¨æœŸå‡½æ•°1\u0026#34;) }) onMounted(()=\u0026gt;{ console.log(\u0026#34;ç”Ÿå‘½å‘¨æœŸå‡½æ•°2\u0026#34;) }) \u0026lt;/script\u0026gt; çˆ¶å­é€šä¿¡ #\rçˆ¶ç»„ä»¶ç»‘å®šå±æ€§ä¼ å€¼ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡propsæ¥æ”¶å±æ€§\nç¼–è¯‘å™¨å®ï¼šdefineProps\nçˆ¶ç»„ä»¶åŠ¨æ€åŠ¨æ€ä¼ å€¼ï¼šv-model\nçˆ¶ç»„ä»¶å½¢æ€ï¼š\nè¿™å¼ å›¾ç‰‡é‡Œé¢ï¼Œæ‰€æœ‰çš„é—ä¼ å±æ€§éœ€è¦åœ¨å¼•ç”¨å­ç»„ä»¶çš„æ—¶å€™ä¸­å£°æ˜ï¼Œå­ç»„ä»¶å®šä¹‰çš„é€šä¿¡å‡½æ•°ä¹Ÿè¦åœ¨å¼•ç”¨æ—¶ç”¨**@+å‡½æ•°å**çš„æ–¹æ³•å£°æ˜ï¼\nå­ç»„ä»¶å½¢æ€ï¼š\n\u0026lt;script setup\u0026gt; import Son from \u0026#34;@/components/heredity/Son.vue\u0026#34;; import {ref} from \u0026#34;vue\u0026#34;; const money=ref(100); const earnMoney=()=\u0026gt;{ money.value+=100 } \u0026lt;/script\u0026gt; \u0026lt;template\u0026gt; \u0026lt;div\u0026gt;\u0026lt;h3\u0026gt;æˆ‘æ˜¯çˆ¶ç»„ä»¶\u0026lt;/h3\u0026gt;\u0026lt;button @click=\u0026#34;earnMoney\u0026#34;\u0026gt;èµšé’±ç»™å­©å­ä»¬\u0026lt;/button\u0026gt;\u0026lt;son car=\u0026#34;å®é©¬è½¦\u0026#34; :money=\u0026#34;money\u0026#34;/\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script setup\u0026gt; //ç¼–è¯‘å™¨å®ç»„ä»¶ const props=defineProps({ car: String, money:String }) \u0026lt;/script\u0026gt; \u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;son\u0026#34;\u0026gt;æˆ‘æ˜¯å­ç»„ä»¶\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;son\u0026#34;\u0026gt;é—äº§{{car}}\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;son\u0026#34;\u0026gt;çˆ¶äº²çš„é—äº§{{money}}\u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;style scoped\u0026gt; .son{ border: 1px solid black; padding: 30px; } \u0026lt;/style\u0026gt; å­ç»„ä»¶ä¼ é€’äº‹ä»¶ç»™çˆ¶ç»„ä»¶ #\rç†è®ºä¸Šæ¥è®²ï¼Œå­ç»„ä»¶ä¿®æ”¹çˆ¶ç»„ä»¶çš„å€¼æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ç”±äºçˆ¶ç»„ä»¶çš„å¯ä»¥å¼•ç”¨å¤šä¸ªå­ç»„ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªå­ç»„ä»¶æ”¹äº†çˆ¶ç»„ä»¶çš„å€¼åï¼Œ å…¶ä»–çš„å­ç»„ä»¶çš„æ•°æ®å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥ä¸æ¨èä½¿ç”¨å­ç»„ä»¶ä¿®æ”¹çˆ¶ç»„ä»¶çš„å€¼ï¼Œè€Œæ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­å®šä¹‰å±æ€§å’Œæ–¹æ³•ï¼Œåœ¨å­ç»„ä»¶ä¸­ä¿®æ”¹ã€‚\nå­ç»„ä»¶å†…éƒ¨é€šè¿‡emitè§¦å‘äº‹ä»¶ï¼Œå‰ææ˜¯å­ç»„ä»¶é€šè¿‡ç¼–è¯‘å™¨å®å£°æ˜äº†äº‹ä»¶\nå­ç»„ä»¶éƒ¨åˆ†ä¼ é€’äº‹ä»¶ï¼š\nconst emit=defineEmits([\u0026#39;consumeMoney\u0026#39;]) const consume=()=\u0026gt;{ emit(\u0026#39;consumeMoney\u0026#39;,5) } çˆ¶ç»„ä»¶éƒ¨åˆ†æ¥å—äº‹ä»¶ï¼š\n//ä¼ å…¥å‚æ•°ä¹Ÿå¯ä»¥æ¥æ”¶ const lessMoney=(args)=\u0026gt;{ money.value-=args; } \u0026lt;son car=\u0026#34;å®é©¬è½¦\u0026#34; :money=\u0026#34;money\u0026#34; @consumeMoney=\u0026#34;lessMoney\u0026#34;/\u0026gt;\u0026lt;/div\u0026gt; æ¨¡æ¿å¼•ç”¨ #\rrefæ ‡è¯†è·å–domæˆ–è€…ç»„ä»¶å®ä¾‹\nåˆ›å»º-\u0026gt;ç»‘å®š-\u0026gt;ä½¿ç”¨\n","date":"4 November 2023","externalUrl":null,"permalink":"/entire-note/vue/","section":"Entire-Notes","summary":"Vue3 å“åº”å¼Apiå¼€å‘ç¬”è®° #\rç›®å½•ç»“æ„ï¼š #\rç”¨viteæ„å»ºçš„Vue3ç›®å½•ç»“æ„ï¼š\nsrc:\nè¿™é‡Œæ˜¯æˆ‘ä»¬è¦å¼€å‘çš„ç›®å½•ï¼ŒåŸºæœ¬ä¸Šè¦åšçš„äº‹æƒ…éƒ½åœ¨è¿™ä¸ªç›®å½•é‡Œã€‚é‡Œé¢åŒ…å«äº†å‡ ä¸ªç›®å½•åŠæ–‡ä»¶ï¼š\nassets: æ”¾ç½®ä¸€äº›å›¾ç‰‡ï¼Œå¦‚logoç­‰ã€‚ components: ç›®å½•é‡Œé¢æ”¾äº†ä¸€ä¸ªç»„ä»¶æ–‡ä»¶ï¼Œå¯ä»¥ä¸ç”¨ã€‚ App.vue: é¡¹ç›®å…¥å£æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å°†ç»„ä»¶å†™è¿™é‡Œï¼Œè€Œä¸ä½¿ç”¨ components ç›®å½•ã€‚ main.js: é¡¹ç›®çš„æ ¸å¿ƒæ–‡ä»¶ã€‚ index.css: æ ·å¼æ–‡ä»¶ã€‚ static\té™æ€èµ„æºç›®å½•ï¼Œå¦‚å›¾ç‰‡ã€å­—ä½“ç­‰ã€‚\npublic\tå…¬å…±èµ„æºç›®å½•ã€‚\npackage.json\té¡¹ç›®é…ç½®æ–‡ä»¶ã€‚\nvue3åˆ›å»ºåº”ç”¨ #\rå®é™…æ¡ˆä¾‹ #\rè¯­æ³•ï¼š const app = Vue.","title":"Vue3 å“åº”å¼Apiå¼€å‘ç¬”è®°","type":"entire-note"},{"content":"\ré€šè¿‡GitHub+PicGo+CDNæ­å»ºè‡ªå·±çš„å›¾åºŠ #\rå›¾åºŠä¸€èˆ¬æ˜¯æŒ‡å‚¨å­˜å›¾ç‰‡çš„æœåŠ¡å™¨ï¼Œæœ‰å›½å†…å’Œå›½å¤–ä¹‹åˆ†ã€‚å›½å¤–çš„å›¾åºŠç”±äºæœ‰ ç©ºé—´è·ç¦»ç­‰å› ç´ å†³å®šè®¿é—®é€Ÿåº¦å¾ˆæ…¢å½±å“å›¾ç‰‡æ˜¾ç¤ºé€Ÿåº¦ã€‚å›½å†…ä¹Ÿåˆ†ä¸ºå•çº¿ç©ºé—´ã€ å¤šçº¿ç©ºé—´å’ŒcdnåŠ é€Ÿä¸‰ç§ã€‚# CDN æ˜¯æ„å»ºåœ¨æ•°æ®ç½‘ç»œä¸Šçš„ä¸€ç§åˆ†å¸ƒå¼çš„å†…å®¹åˆ†å‘ç½‘ã€‚ CDN çš„ä½œç”¨æ˜¯é‡‡ç”¨ æµåª’ä½“æœåŠ¡å™¨ é›†ç¾¤æŠ€æœ¯ï¼Œå…‹æœå•æœºç³»ç»Ÿè¾“å‡ºå¸¦å®½åŠå¹¶å‘èƒ½åŠ›ä¸è¶³çš„ç¼ºç‚¹ï¼Œå¯æå¤§æå‡ç³»ç»Ÿæ”¯æŒçš„ å¹¶å‘æµæ•°ç›®ï¼Œå‡å°‘æˆ–é¿å… å•ç‚¹å¤±æ•ˆå¸¦æ¥çš„ä¸è‰¯å½±å“ã€‚# githubæ­å»ºä»“åº“\nä¸‹è½½ PicGO é…ç½® CDN\nåˆ›å»ºä»“åº“ #\rPICGO #\ré…ç½®åŠ é€Ÿ\nå¦‚ä½•é…ç½®tokenï¼Ÿ\né¦–å…ˆåˆ°githubä¸Šé€‰æ‹©ç”Ÿæˆè‡ªå·±çš„tokenï¼š\nç‚¹å‡»é¦–é¡µé€‰æ‹©è®¾ç½®ï¼š\nä¸‹æ‹‰åˆ°develop settings\né€‰æ‹©ä¸‹æ–¹ç”ŸæˆGitHub tokenï¼š\nè¾“å…¥GitHub è´¦æˆ·å¯†ç ä¹‹åå¾—åˆ°token\nå°†tokenä¿å­˜å¥½ï¼Œç²˜è´´åˆ°PicGoé‡Œé¢å³å¯ã€‚\n","date":"3 November 2023","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E5%BA%8A/","section":"ç¬”è®°s","summary":"é€šè¿‡GitHub+PicGo+CDNæ­å»ºè‡ªå·±çš„å›¾åºŠ #\rå›¾åºŠä¸€èˆ¬æ˜¯æŒ‡å‚¨å­˜å›¾ç‰‡çš„æœåŠ¡å™¨ï¼Œæœ‰å›½å†…å’Œå›½å¤–ä¹‹åˆ†ã€‚å›½å¤–çš„å›¾åºŠç”±äºæœ‰ ç©ºé—´è·ç¦»ç­‰å› ç´ å†³å®šè®¿é—®é€Ÿåº¦å¾ˆæ…¢å½±å“å›¾ç‰‡æ˜¾ç¤ºé€Ÿåº¦ã€‚å›½å†…ä¹Ÿåˆ†ä¸ºå•çº¿ç©ºé—´ã€ å¤šçº¿ç©ºé—´å’ŒcdnåŠ é€Ÿä¸‰ç§ã€‚# CDN æ˜¯æ„å»ºåœ¨æ•°æ®ç½‘ç»œä¸Šçš„ä¸€ç§åˆ†å¸ƒå¼çš„å†…å®¹åˆ†å‘ç½‘ã€‚ CDN çš„ä½œç”¨æ˜¯é‡‡ç”¨ æµåª’ä½“æœåŠ¡å™¨ é›†ç¾¤æŠ€æœ¯ï¼Œå…‹æœå•æœºç³»ç»Ÿè¾“å‡ºå¸¦å®½åŠå¹¶å‘èƒ½åŠ›ä¸è¶³çš„ç¼ºç‚¹ï¼Œå¯æå¤§æå‡ç³»ç»Ÿæ”¯æŒçš„ å¹¶å‘æµæ•°ç›®ï¼Œå‡å°‘æˆ–é¿å… å•ç‚¹å¤±æ•ˆå¸¦æ¥çš„ä¸è‰¯å½±å“ã€‚# githubæ­å»ºä»“åº“\nä¸‹è½½ PicGO é…ç½® CDN\nåˆ›å»ºä»“åº“ #\rPICGO #\ré…ç½®åŠ é€Ÿ\nå¦‚ä½•é…ç½®tokenï¼Ÿ\né¦–å…ˆåˆ°githubä¸Šé€‰æ‹©ç”Ÿæˆè‡ªå·±çš„tokenï¼š\nç‚¹å‡»é¦–é¡µé€‰æ‹©è®¾ç½®ï¼š\nä¸‹æ‹‰åˆ°develop settings\né€‰æ‹©ä¸‹æ–¹ç”ŸæˆGitHub tokenï¼š","title":"æ­å»ºå›¾åºŠ","type":"ç¬”è®°"},{"content":"","date":"3 November 2023","externalUrl":null,"permalink":"/tags/%E6%9D%82%E8%AE%B0/","section":"Tags","summary":"","title":"æ‚è®°","type":"tags"},{"content":"\rC++å®ç°æ•°æ®ç»“æ„å’Œåˆæ­¥çš„è®¤è¯† #\ré‰´äºæœªæ¥æ•°æ®ç»“æ„å’Œç®—æ³•çš„å®ç°æˆ‘æƒ³é€šè¿‡ C++æ¥å®ç°ï¼Œç°åœ¨ç®€è¦æ€»ç»“ä¸‹ C++çš„å¸¸ç”¨æ–¹æ³•å’Œæ•°æ®ç»“æ„ç±»å‹\nå¤´æ–‡ä»¶å’Œæ–¹æ³•å£°æ˜ #\rç­‰åŒäº C è¯­è¨€\næ ‡å‡†è¾“å…¥è¾“å‡ºå‡½æ•° #\rstd::cout \u0026lt;\u0026lt; \u0026#34;Hello, World!\u0026#34; \u0026lt;\u0026lt; std::endl; å¼•å…¥ using namespace std;è¿™å¯ä»¥é¿å…å‡½æ•°è¦ä¸æ–­çš„æ·»åŠ å‰ç¼€\nusing namespace std; ... int input; cout\u0026lt;\u0026lt;\u0026#34;Hello world\u0026#34;\u0026lt;\u0026lt;endl;//è¾“å‡ºå‡½æ•° cin\u0026gt;\u0026gt;input; printf(\u0026#34;%d\u0026#34;,input); ... ä¼ é€’å‡½æ•°çš„ä¸åŒæ–¹å¼ #\rconst ä¿®é¥°æŒ‡é’ˆ #\rä¿®é¥°å¸¸é‡ ä¿®é¥°æŒ‡é’ˆ ä¿®é¥°å¸¸é‡å’ŒæŒ‡é’ˆ int main() { int a = 10; int b = 10; //constä¿®é¥°çš„æ˜¯æŒ‡é’ˆï¼ŒæŒ‡é’ˆæŒ‡å‘å¯ä»¥æ”¹ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸å¯ä»¥æ›´æ”¹ const int * p1 = \u0026amp;a; p1 = \u0026amp;b; //æ­£ç¡® //*p1 = 100; æŠ¥é”™ //constä¿®é¥°çš„æ˜¯å¸¸é‡ï¼ŒæŒ‡é’ˆæŒ‡å‘ä¸å¯ä»¥æ”¹ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å€¼å¯ä»¥æ›´æ”¹ int * const p2 = \u0026amp;a; //p2 = \u0026amp;b; //é”™è¯¯ *p2 = 100; //æ­£ç¡® //constæ—¢ä¿®é¥°æŒ‡é’ˆåˆä¿®é¥°å¸¸é‡ const int * const p3 = \u0026amp;a; //p3 = \u0026amp;b; //é”™è¯¯ //*p3 = 100; //é”™è¯¯ system(\u0026#34;pause\u0026#34;); return 0; } ç©ºæŒ‡é’ˆå’Œé‡æŒ‡é’ˆ #\rNUll Point #\rint main() { //æŒ‡é’ˆå˜é‡pæŒ‡å‘å†…å­˜åœ°å€ç¼–å·ä¸º0çš„ç©ºé—´ int * p = NULL; //è®¿é—®ç©ºæŒ‡é’ˆæŠ¥é”™ //å†…å­˜ç¼–å·0 ~255ä¸ºç³»ç»Ÿå ç”¨å†…å­˜ï¼Œä¸å…è®¸ç”¨æˆ·è®¿é—® cout \u0026lt;\u0026lt; *p \u0026lt;\u0026lt; endl; system(\u0026#34;pause\u0026#34;); return 0; } Wild Point #\rint main() { //æŒ‡é’ˆå˜é‡pæŒ‡å‘å†…å­˜åœ°å€ç¼–å·ä¸º0x1100çš„ç©ºé—´ int * p = (int *)0x1100; //è®¿é—®é‡æŒ‡é’ˆæŠ¥é”™ cout \u0026lt;\u0026lt; *p \u0026lt;\u0026lt; endl; system(\u0026#34;pause\u0026#34;); return 0; } æ•°ç»„ä½œä¸ºå‡½æ•°å±•ç¤ºï¼š #\rvoid array_print(int arr[],int len){ for (int i = 0; i \u0026lt; len; ++i) { cout\u0026lt;\u0026lt;arr[i]\u0026lt;\u0026lt;endl; } } void bubble_sort_(int * arr,int len){ for (int i = 0; i \u0026lt; len; ++i) { for (int j = i; j \u0026lt; len; ++j) { if (arr[i]\u0026gt;=arr[j]){ int tmp=arr[j]; arr[j]=arr[i]; arr[i]=tmp; } } } } int main(){ int arr[]={10,2,4,4,3,5,9,1,3}; bubble_sort_(arr,8); array_print(arr,8); } å½“æ•°ç»„åä¼ å…¥åˆ°å‡½æ•°ä½œä¸ºå‚æ•°æ—¶ï¼Œè¢«é€€åŒ–ä¸ºæŒ‡å‘é¦–å…ƒç´ çš„æŒ‡é’ˆ\nåˆ é™¤æ•°ç»„å…ƒç´ ç©ºé—´ #\rint arr[] = new[10];//å£°æ˜æ•°ç»„ delete[] arr;//é‡Šæ”¾æ•°ç»„ç©ºé—´ å†…å­˜å‘ç”Ÿå–æ¶ˆå’Œå›æ”¶ï¼š\nint *a=new int [10]; cout\u0026lt;\u0026lt;a\u0026lt;\u0026lt;endl; int *p=a; delete[] a; int *m=p; cout\u0026lt;\u0026lt;p\u0026lt;\u0026lt;endl; cout\u0026lt;\u0026lt;m\u0026lt;\u0026lt;endl; å¼•ç”¨ #\rè¯­æ³•ï¼š æ•°æ®ç±»å‹ \u0026amp;åˆ«å = åŸå\nä¾‹å­ï¼š\nint a = 10; int b = 20; //int \u0026amp;c; //é”™è¯¯ï¼Œå¼•ç”¨å¿…é¡»åˆå§‹åŒ– int \u0026amp;c = a; //ä¸€æ—¦åˆå§‹åŒ–åï¼Œå°±ä¸å¯ä»¥æ›´æ”¹ c = b; //è¿™æ˜¯èµ‹å€¼æ“ä½œï¼Œä¸æ˜¯æ›´æ”¹å¼•ç”¨ å‡½æ•°ä¼ å‚ï¼š #\r//1. å€¼ä¼ é€’ void mySwap01(int a, int b) { int temp = a; a = b; b = temp; } //2. åœ°å€ä¼ é€’ void mySwap02(int* a, int* b) { int temp = *a; *a = *b; *b = temp; } //3. å¼•ç”¨ä¼ é€’ void mySwap03(int\u0026amp; a, int\u0026amp; b) { int temp = a; a = b; b = temp; } å¼•ç”¨ä¼ å‚ï¼š\nclass RainyInteger { friend ostream \u0026amp;operator\u0026lt;\u0026lt;(ostream\u0026amp; out,RainyInteger rainyInteger); public: RainyInteger(){ //åˆå§‹åŒ–æ•°æ®ï¼š this-\u0026gt;rainy_num=0; } void speak(RainyInteger *r){ cout\u0026lt;\u0026lt;r-\u0026gt;rainy_num\u0026lt;\u0026lt;endl; } private: int rainy_num; }; main(){ RainyInteger integer; integer.speak(\u0026amp; integer); //ä¼ å…¥å¼•ç”¨è€Œä¸æ˜¯æŒ‡é’ˆï¼Œå¦åˆ™æŠ¥é”™ } ç±» #\ræ³¨æ„äº‹é¡¹ #\råœ¨ C++ä¸­å®ä¾‹åŒ–ä¸€ä¸ªç±»ä¸éœ€è¦ç”¨ newã€‚ä¹Ÿå¯ä»¥ç”¨ newï¼Œä½†æ˜¯åŒºåˆ«æ˜¯ï¼šä¸ä½¿ç”¨ newï¼Œå¼€è¾Ÿæ ˆç©ºé—´ï¼Œä½¿ç”¨ new å¼€è¾Ÿçš„ç©ºé—´ä¸ºå †ç©ºé—´ã€‚è¿™æ˜¾ç„¶æ˜¯å› ä¸ºç¨‹åºå‘˜åªæ“ä½œå †ç©ºé—´çš„åŸå› ä½¿ç„¶\nä¸ C è¯­è¨€ç»“æ„ä½“çš„åŒºåˆ«\nè®¿é—®æ§åˆ¶ç¬¦æ˜¯å”¯ä¸€åŒºåˆ«ï¼Œæ‰€æœ‰çš„ç»“æ„ä½“é»˜è®¤ publicï¼Œä½†æ˜¯ç±»åˆ™æ˜¯ private\nç±»çš„æ„é€ å‡½æ•°ï¼Œææ„å‡½æ•°å’Œæ‹·è´æ„é€ å‡½æ•°\né™æ€å˜é‡å’Œæˆå‘˜å˜é‡ #\ré™æ€å˜é‡è¯­æ³•ï¼šstatic æ•°æ®ç±»å‹ å˜é‡å\nç±»é‡Œé¢ï¼šç±»::å˜é‡å\næˆå‘˜å˜é‡è¯­æ³•ï¼šæ•°æ®ç±»å‹ å˜é‡å\né™æ€æ–¹æ³•ç±»ä¼¼ï¼ŒåŒæ—¶åœ¨å¤´æ–‡ä»¶é‡Œé¢å®šä¹‰çš„æ—¶å€™å¯ä»¥å…·æœ‰æ–¹æ³•ä½“\nä»£ç å¦‚ä¸‹ï¼š\nPeople.h using namespace std; class People { public: People(int age,string name){ this-\u0026gt;age=age; this-\u0026gt;name=name; } //ä½œç”¨å‡½æ•° void speak(People *p){ cout\u0026lt;\u0026lt;p-\u0026gt;name\u0026lt;\u0026lt;endl;//ç›¸å½“äºthis.name cout\u0026lt;\u0026lt;p-\u0026gt;age\u0026lt;\u0026lt;endl; } int age; string name; static string defaultName; static void defaultFunc(); }; People.cpp #include \u0026#34;People.h\u0026#34; //é™æ€å˜é‡ string People::defaultName; void People::defaultFunc() { } æ„é€ å‡½æ•°ï¼ˆConstructorï¼‰ #\ræ„é€ å‡½æ•°è¯­æ³•ï¼šç±»å(){}\nåœ¨å®šä¹‰æœ‰å‚æ„é€ å‡½æ•°åï¼Œä¸å†æä¾›æ— å‚æ„é€ å‡½æ•°\n#####ææ„å‡½æ•°ï¼ˆDestructorï¼‰ï¼Œé€š Java,å¯é‡è½½ï¼Œé‡Šæ”¾å†…å­˜æ—¶ä½¿ç”¨\nææ„å‡½æ•°è¯­æ³•ï¼š~ç±»å(){}\næ„é€ å‡½æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ä¹Ÿä¸å†™ void å‡½æ•°åç§°ä¸ç±»åç›¸åŒ æ„é€ å‡½æ•°å¯ä»¥æœ‰å‚æ•°ï¼Œå› æ­¤å¯ä»¥å‘ç”Ÿé‡è½½ ç¨‹åºåœ¨è°ƒç”¨å¯¹è±¡æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨æ„é€ ï¼Œæ— é¡»æ‰‹åŠ¨è°ƒç”¨,è€Œä¸”åªä¼šè°ƒç”¨ä¸€æ¬¡ æ‹·è´æ„é€ å‡½æ•° #\rå¦‚æœå±æ€§æœ‰åœ¨å †åŒºå¼€è¾Ÿçš„ï¼Œä¸€å®šè¦è‡ªå·±æä¾›æ‹·è´æ„é€ å‡½æ•°ï¼Œé˜²æ­¢æµ…æ‹·è´å¸¦æ¥çš„é—®é¢˜\n// // Created by Rainy-Heights on 2023/10/27. // #ifndef OBJECT_C_STUDENT_H #define OBJECT_C_STUDENT_H #include \u0026lt;iostream\u0026gt; using namespace std; class Student { public: Student(){ cout\u0026lt;\u0026lt;\u0026#34;è¿™æ˜¯æ— æ„é€ å‡½æ•°\u0026#34;\u0026lt;\u0026lt;endl; } Student(int age,string name){ cout\u0026lt;\u0026lt;\u0026#34;è¿™æ˜¯æœ‰å‚æ„é€ å‡½æ•°\u0026#34;\u0026lt;\u0026lt;endl; _stu_age=new int [age]; _stu_name=name; } //æ‹·è´æ„é€  å‡½æ•° Student(const Student \u0026amp;student){ cout\u0026lt;\u0026lt;\u0026#34;æ‹·è´æ„é€ å‡½æ•°\u0026#34;\u0026lt;\u0026lt;endl; _stu_name=student._stu_name; _stu_age=new int [*student._stu_age];//æŒ‡å‘å¯¹è±¡çš„å€¼ï¼Œè¿™é‡Œè¿˜æ˜¯å®ç°äº†å€¼çš„æ‹·è´ } ~Student(){ cout\u0026lt;\u0026lt;\u0026#34;ææ„å‡½æ•°\u0026#34;\u0026lt;\u0026lt;endl; } public: int *_stu_age; string _stu_name; }; #endif //OBJECT_C_STUDENT_H ==å¦‚æœç”¨æˆ·å®šä¹‰æœ‰å‚æ„é€ å‡½æ•°ï¼Œc++ä¸åœ¨æä¾›é»˜è®¤æ— å‚æ„é€ ==ï¼Œä½†æ˜¯ä¼šæä¾›é»˜è®¤æ‹·è´æ„é€ \n==å¦‚æœç”¨æˆ·å®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼Œc++ä¸ä¼šå†æä¾›å…¶ä»–æ„é€ å‡½æ•°==\nthis æŒ‡é’ˆ #\ræˆå‘˜å‡½æ•°è®¿é—®æ—¶å€™çš„éšå½¢çš„ this æŒ‡é’ˆå˜é‡\nthis å¯¹äºç±»æ¥è¯´å°±æ˜¯è‡ªå·±çš„åœ°å€\nä¾‹å¦‚ï¼š\nRainyInteger * getAddr(){ return this; } å‹å…ƒ #\rç›¸å½“äºå†…éƒ¨æ ‡å¿—ä¸º friend å³å¯è®¿é—®ç§æœ‰æˆå‘˜\nå…¨å±€å‡½æ•°ä½œä¸ºå‹å…ƒï¼š class StrictBoy{ friend void func(StrictBoy * strictBoy); public: StrictBoy(){ this-\u0026gt;girlFriend=\u0026#34;å¥³æœ‹å‹\u0026#34;; this-\u0026gt;money=520; } private: String girlFriend; public: int money; void func(StrictBoy * strictBoy){ cout\u0026lt;\u0026lt;strictBoy.girlFriend\u0026lt;\u0026lt;endl;//å¯ä»¥è®¿é—®ç§æœ‰çš„å˜é‡äº†ï¼Œç‰›å¤´äººæ—¢è§†æ„Ÿ } }; ç±»ä½œä¸ºå‹å…ƒ class Building; class goodGay { public: goodGay(); void visit(); private: Building *building; }; class Building { //å‘Šè¯‰ç¼–è¯‘å™¨ goodGayç±»æ˜¯Buildingç±»çš„å¥½æœ‹å‹ï¼Œå¯ä»¥è®¿é—®åˆ°Buildingç±»ä¸­ç§æœ‰å†…å®¹ friend class goodGay; public: Building(); public: string m_SittingRoom; //å®¢å… private: string m_BedRoom;//å§å®¤ }; Building::Building() { this-\u0026gt;m_SittingRoom = \u0026#34;å®¢å…\u0026#34;; this-\u0026gt;m_BedRoom = \u0026#34;å§å®¤\u0026#34;; } goodGay::goodGay() { building = new Building; } void goodGay::visit() { cout \u0026lt;\u0026lt; \u0026#34;å¥½åŸºå‹æ­£åœ¨è®¿é—®\u0026#34; \u0026lt;\u0026lt; building-\u0026gt;m_SittingRoom \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;å¥½åŸºå‹æ­£åœ¨è®¿é—®\u0026#34; \u0026lt;\u0026lt; building-\u0026gt;m_BedRoom \u0026lt;\u0026lt; endl; } void test01() { goodGay gg; gg.visit(); } int main(){ test01(); system(\u0026#34;pause\u0026#34;); return 0; } æˆå‘˜å‡½æ•°ä½œä¸ºå‹å…ƒï¼š class Building; class goodGay { public: goodGay(); void visit(); //åªè®©visitå‡½æ•°ä½œä¸ºBuildingçš„å¥½æœ‹å‹ï¼Œå¯ä»¥å‘è®¿é—®Buildingä¸­ç§æœ‰å†…å®¹ void visit2(); private: Building *building; }; class Building { //å‘Šè¯‰ç¼–è¯‘å™¨ goodGayç±»ä¸­çš„visitæˆå‘˜å‡½æ•° æ˜¯Buildingå¥½æœ‹å‹ï¼Œå¯ä»¥è®¿é—®ç§æœ‰å†…å®¹ friend void goodGay::visit(); public: Building(); public: string m_SittingRoom; //å®¢å… private: string m_BedRoom;//å§å®¤ }; Building::Building() { this-\u0026gt;m_SittingRoom = \u0026#34;å®¢å…\u0026#34;; this-\u0026gt;m_BedRoom = \u0026#34;å§å®¤\u0026#34;; } goodGay::goodGay() { building = new Building; } void goodGay::visit() { cout \u0026lt;\u0026lt; \u0026#34;å¥½åŸºå‹æ­£åœ¨è®¿é—®\u0026#34; \u0026lt;\u0026lt; building-\u0026gt;m_SittingRoom \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;å¥½åŸºå‹æ­£åœ¨è®¿é—®\u0026#34; \u0026lt;\u0026lt; building-\u0026gt;m_BedRoom \u0026lt;\u0026lt; endl; } void goodGay::visit2() { cout \u0026lt;\u0026lt; \u0026#34;å¥½åŸºå‹æ­£åœ¨è®¿é—®\u0026#34; \u0026lt;\u0026lt; building-\u0026gt;m_SittingRoom \u0026lt;\u0026lt; endl; //cout \u0026lt;\u0026lt; \u0026#34;å¥½åŸºå‹æ­£åœ¨è®¿é—®\u0026#34; \u0026lt;\u0026lt; building-\u0026gt;m_BedRoom \u0026lt;\u0026lt; endl; } void test01() { goodGay gg; gg.visit(); } int main(){ test01(); system(\u0026#34;pause\u0026#34;); return 0; } è¿ç®—ç¬¦é‡è½½ï¼š #\rä½œç”¨ï¼šå®ç°å¯¹ç±»å˜é‡çš„è‡ªå®šä¹‰è¿ç®—æ–¹æ³•\nå¯å®ç°é‡è½½çš„è¿ç®—ç¬¦ï¼š\nåŠ å·è¿ç®—ç¬¦ å·¦ç§»è¿ç®—ç¬¦ é€’å¢è¿ç®—ç¬¦ èµ‹å€¼è¿ç®—ç¬¦ å…³ç³»è¿ç®—ç¬¦ å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦ //è¿™é‡Œæ˜¯è¡¨ç¤ºå¯¹è¾“å‡ºæµé‡Œé¢çš„æ“ä½œç¬¦å®ç°é‡è½½ ostream\u0026amp; operator-(ostream\u0026amp; out,Person\u0026amp; p){ out\u0026lt;\u0026lt;\u0026#34;é€šè¿‡å‹å…ƒå®ç°å¯¹ç§æœ‰å˜é‡çš„è®¿é—®\u0026#34;\u0026lt;\u0026lt;p.m_A\u0026lt;\u0026lt;p.m_B; } è¡¨ç¤ºçš„æ„ä¹‰å°±æ˜¯å¯¹ç¬¦å·è¿›è¡Œäº†è‡ªå®šä¹‰\næ¡ˆä¾‹\nå®ç°è‡ªå·±çš„æ•°æ®ç±»å‹ #\ré›¨å±±çš„æ•´å‹æ•°æ® class RainyInteger { friend ostream \u0026amp;operator\u0026lt;\u0026lt;(ostream\u0026amp; out,RainyInteger rainyInteger); public: RainyInteger(){ //åˆå§‹åŒ–æ•°æ®ï¼š this-\u0026gt;rainy_num=0; } //å‰ç½®++æ“ä½œ RainyInteger\u0026amp; operator++(){ rainy_num++; return *this; } //åè‡ªå¢æ“ä½œï¼š??? RainyInteger\u0026amp; operator++(int){ RainyInteger tmp= *this; rainy_num++; return tmp; } void speak(RainyInteger *r){ cout\u0026lt;\u0026lt;r-\u0026gt;rainy_num\u0026lt;\u0026lt;endl; } private: int rainy_num; }; å†…è”å‡½æ•° inline #\rinline int max(int a,int b){ } ç»§æ‰¿ #\rè¯­æ³•ï¼šclass å­ç±» : ç»§æ‰¿æ–¹å¼ çˆ¶ç±»\nclass Father{ }; class Child1: public Father; class Child2: private Father; class Child3: protected Father; æ„é€ å’Œææ„é¡ºåºï¼š #\rå­ç±»ç»§æ‰¿è‡ªçˆ¶ç±»ä¹‹åï¼Œè°ƒç”¨å­çš„æ„é€ å‡½æ•°å°†ä¼šé€ æˆçˆ¶ç±»çš„æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼Œææ„å‡½æ•°åˆ™ç›¸åï¼Œå› ä¸ºæ¸…ç†å…ˆä»æœ€å°çš„å­ç±»å¼€å§‹æ¸…ç†ã€‚\nè±å½¢ç»§æ‰¿é—®é¢˜ #\rç®€è€Œè¨€ä¹‹å°±æ˜¯çˆ¶ç±»è¢«å¤šä¸ªå­ç±»ç»§æ‰¿ï¼Œå¤šä¸ªå­ç±»è¢«æŸä¸€ä¸ªå­™å­ç±»åŒæ—¶ç»§æ‰¿ï¼Œå¯¼è‡´å¾—é—®é¢˜æ˜¯ä½¿å¾—å½“å­™å­ç±»ç»§æ‰¿ä¸¤ä¸ªå­ç±»ä¸­å«æœ‰ç›¸åŒå˜é‡æˆ–è€…å­—æ®µæ—¶é€ æˆäºŒä¹‰\nç¤ºæ„å›¾ï¼š\nè§£å†³åŠæ³•-\u0026gt;è™šç»§æ‰¿ å…³é”®å­—ï¼švirtural\nåœ¨åŸºç±»çš„ä¸¤ä¸ªå­ç±»ä¸­ç»§æ‰¿åŸºç±»æ—¶ï¼Œä½¿ç”¨ virtual å…³é”®å­—ã€‚è™šç»§æ‰¿åŸºç±»ã€‚ä½¿å¾—åŸºç±»çš„å±æ€§æˆå‘˜åªæœ‰ä¸€ä»½ã€‚\nclass Animal { public: int m_Age; }; class Sheep : virtual public Animal {}; class Tuo : virtual public Animal {}; class SheepTuo : public Sheep, public Tuo {}; ç»§æ‰¿ä¹‹åå­ç±»è·å¾—äº†ä»€ä¹ˆï¼Ÿ #\rå…¬å…±å˜é‡å’Œæ–¹æ³•è‚¯å®šæ˜¯è·å¾—äº†ã€‚\nåŒæ—¶ï¼š\nçˆ¶ç±»ä¸­ç§æœ‰æˆå‘˜ä¹Ÿæ˜¯è¢«å­ç±»ç»§æ‰¿ä¸‹å»äº†ï¼Œåªæ˜¯ç”±ç¼–è¯‘å™¨ç»™éšè—åè®¿é—®ä¸åˆ°\nå¤šæ€ #\ré™æ€å¤šæ€: å‡½æ•°é‡è½½ å’Œ è¿ç®—ç¬¦é‡è½½å±äºé™æ€å¤šæ€ï¼Œå¤ç”¨å‡½æ•°å åŠ¨æ€å¤šæ€: æ´¾ç”Ÿç±»å’Œè™šå‡½æ•°å®ç°è¿è¡Œæ—¶å¤šæ€ åŒºåˆ«ï¼š\né™æ€å¤šæ€çš„å‡½æ•°åœ°å€æ—©ç»‘å®š - ç¼–è¯‘é˜¶æ®µç¡®å®šå‡½æ•°åœ°å€ åŠ¨æ€å¤šæ€çš„å‡½æ•°åœ°å€æ™šç»‘å®š - è¿è¡Œé˜¶æ®µç¡®å®šå‡½æ•°åœ°å€ class Animal { public: //Speakå‡½æ•°å°±æ˜¯è™šå‡½æ•° //å‡½æ•°å‰é¢åŠ ä¸Švirtualå…³é”®å­—ï¼Œå˜æˆè™šå‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¸èƒ½ç¡®å®šå‡½æ•°è°ƒç”¨äº†ã€‚ virtual void speak() { cout \u0026lt;\u0026lt; \u0026#34;åŠ¨ç‰©åœ¨è¯´è¯\u0026#34; \u0026lt;\u0026lt; endl; } }; class Cat :public Animal { public: void speak() { cout \u0026lt;\u0026lt; \u0026#34;å°çŒ«åœ¨è¯´è¯\u0026#34; \u0026lt;\u0026lt; endl; } }; class Dog :public Animal { public: void speak() { cout \u0026lt;\u0026lt; \u0026#34;å°ç‹—åœ¨è¯´è¯\u0026#34; \u0026lt;\u0026lt; endl; } }; //æˆ‘ä»¬å¸Œæœ›ä¼ å…¥ä»€ä¹ˆå¯¹è±¡ï¼Œé‚£ä¹ˆå°±è°ƒç”¨ä»€ä¹ˆå¯¹è±¡çš„å‡½æ•° //å¦‚æœå‡½æ•°åœ°å€åœ¨ç¼–è¯‘é˜¶æ®µå°±èƒ½ç¡®å®šï¼Œé‚£ä¹ˆé™æ€è”ç¼– //å¦‚æœå‡½æ•°åœ°å€åœ¨è¿è¡Œé˜¶æ®µæ‰èƒ½ç¡®å®šï¼Œå°±æ˜¯åŠ¨æ€è”ç¼– void DoSpeak(Animal \u0026amp; animal) { animal.speak(); } // //å¤šæ€æ»¡è¶³æ¡ä»¶ï¼š //1ã€æœ‰ç»§æ‰¿å…³ç³» //2ã€å­ç±»é‡å†™çˆ¶ç±»ä¸­çš„è™šå‡½æ•° //å¤šæ€ä½¿ç”¨ï¼š //çˆ¶ç±»æŒ‡é’ˆæˆ–å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ void test01() { Cat cat; DoSpeak(cat); Dog dog; DoSpeak(dog); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } è™šå‡½æ•°å’Œçº¯è™šææ„ #\råœ¨å¤šæ€ä¸­ï¼Œé€šå¸¸çˆ¶ç±»ä¸­è™šå‡½æ•°çš„å®ç°æ˜¯æ¯«æ— æ„ä¹‰çš„ï¼Œä¸»è¦éƒ½æ˜¯è°ƒç”¨å­ç±»é‡å†™çš„å†…å®¹\nå› æ­¤å¯ä»¥å°†è™šå‡½æ•°æ”¹ä¸ºçº¯è™šå‡½æ•°\nçº¯è™šå‡½æ•°è¯­æ³•ï¼švirtual è¿”å›å€¼ç±»å‹ å‡½æ•°å ï¼ˆå‚æ•°åˆ—è¡¨ï¼‰= 0 ;\nå½“ç±»ä¸­æœ‰äº†çº¯è™šå‡½æ•°ï¼Œè¿™ä¸ªç±»ä¹Ÿç§°ä¸º==æŠ½è±¡ç±»==\nè™šå‡½æ•°çš„å‰æï¼š #\r-\nåŸºç±»ï¼Œæ´¾ç”Ÿç±»æ‹¥æœ‰åŸå‹ç›¸åŒçš„æˆå‘˜å‡½æ•° virtual å…³é”®å­— è™šææ„å‡½æ•° #\r-\nè™šææ„å‡½æ•°æ˜¯ä¸ºäº†è§£å†³åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œå¹¶ç”¨åŸºç±»çš„æŒ‡é’ˆé”€æ¯æ´¾ç”Ÿç±»å¯¹è±¡ çº¯è™šå‡½æ•° #\rå¤šæ€ä½¿ç”¨æ—¶ï¼Œå¦‚æœå­ç±»ä¸­æœ‰å±æ€§å¼€è¾Ÿåˆ°å †åŒºï¼Œé‚£ä¹ˆçˆ¶ç±»æŒ‡é’ˆåœ¨é‡Šæ”¾æ—¶æ— æ³•è°ƒç”¨åˆ°å­ç±»çš„ææ„ä»£ç \nè§£å†³æ–¹å¼ï¼šå°†çˆ¶ç±»ä¸­çš„ææ„å‡½æ•°æ”¹ä¸ºè™šææ„æˆ–è€…çº¯è™šææ„\nè™šææ„å’Œçº¯è™šææ„å…±æ€§ï¼š\nå¯ä»¥è§£å†³çˆ¶ç±»æŒ‡é’ˆé‡Šæ”¾å­ç±»å¯¹è±¡ éƒ½éœ€è¦æœ‰å…·ä½“çš„å‡½æ•°å®ç° è™šææ„å’Œçº¯è™šææ„åŒºåˆ«ï¼š\nå¦‚æœæ˜¯çº¯è™šææ„ï¼Œè¯¥ç±»å±äºæŠ½è±¡ç±»ï¼Œæ— æ³•å®ä¾‹åŒ–å¯¹è±¡ è™šææ„è¯­æ³•ï¼š\nvirtual ~ç±»å(){}\nçº¯è™šææ„è¯­æ³•ï¼š\nvirtual ~ç±»å() = 0;\nç±»å::~ç±»å(){}\n-\nçº¯è™šå‡½æ•°æ²¡æœ‰å‡½æ•°ä½“ï¼Œå…¶ä½œç”¨å®åœ¨åŸºç±»ä¸­ä¸ºæ´¾ç”Ÿç±»ä¿ç•™ä¸€ä¸ªå‡½æ•°æ¥å£ï¼Œæ–¹ä¾¿æ´¾ç”Ÿç±»æ ¹æ®éœ€è¦å¯¹å®ƒå®ç°ï¼Œå®ç°å¤šæ€ã€‚ å‡½æ•°çš„å¯å˜é•¿å‚æ•°ï¼š\nflaot avg(int size,...){ } C++æ¨¡æ¿ #\rå‡½æ•°æ¨¡æ¿ #\rå»ºç«‹ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œå…¶å‡½æ•°è¿”å›å€¼ç±»å‹å’Œå½¢å‚ç±»å‹å¯ä»¥ä¸å…·ä½“åˆ¶å®šï¼Œç”¨ä¸€ä¸ªè™šæ‹Ÿçš„ç±»å‹æ¥ä»£è¡¨ã€‚\ntemplate\u0026lt;typename T\u0026gt; å‡½æ•°å£°æ˜æˆ–å®šä¹‰ template â€” å£°æ˜åˆ›å»ºæ¨¡æ¿\ntypename â€” è¡¨é¢å…¶åé¢çš„ç¬¦å·æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç”¨ class ä»£æ›¿\nT â€” é€šç”¨çš„æ•°æ®ç±»å‹ï¼Œåç§°å¯ä»¥æ›¿æ¢ï¼Œé€šå¸¸ä¸ºå¤§å†™å­—æ¯\nçœ‹èµ·æ¥å’Œ java é‡Œé¢çš„æ³›å‹æ¯”è¾ƒåƒ\næ³¨æ„äº‹é¡¹ï¼š\nè‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œå¿…é¡»æ¨å¯¼å‡ºä¸€è‡´çš„æ•°æ®ç±»å‹ T,æ‰å¯ä»¥ä½¿ç”¨ æ¨¡æ¿å¿…é¡»è¦ç¡®å®šå‡º T çš„æ•°æ®ç±»å‹ï¼Œæ‰å¯ä»¥ä½¿ç”¨ //1ã€æŒ‡å®šä¼ å…¥çš„ç±»å‹ void printPerson1(Person\u0026lt;string, int\u0026gt; \u0026amp;p) { p.showPerson(); } void test01() { Person \u0026lt;string, int \u0026gt;p(\u0026#34;å­™æ‚Ÿç©º\u0026#34;, 100); printPerson1(p); } ç±»æ¨¡æ¿æˆå‘˜ç±»å¤–å®ç°ï¼š\n#include \u0026lt;string\u0026gt; //ç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; class Person { public: //æˆå‘˜å‡½æ•°ç±»å†…å£°æ˜ Person(T1 name, T2 age); void showPerson(); public: T1 m_Name; T2 m_Age; }; //æ„é€ å‡½æ•° ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; Person\u0026lt;T1, T2\u0026gt;::Person(T1 name, T2 age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } //æˆå‘˜å‡½æ•° ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; void Person\u0026lt;T1, T2\u0026gt;::showPerson() { cout \u0026lt;\u0026lt; \u0026#34;å§“å: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„:\u0026#34; \u0026lt;\u0026lt; this-\u0026gt;m_Age \u0026lt;\u0026lt; endl; } STL åŸºæœ¬è®¤è¯† #\rSTL(Standard Template Library,æ ‡å‡†æ¨¡æ¿åº“) STL ä»å¹¿ä¹‰ä¸Šåˆ†ä¸º: å®¹å™¨(container) ç®—æ³•(algorithm) è¿­ä»£å™¨(iterator) å®¹å™¨å’Œç®—æ³•ä¹‹é—´é€šè¿‡è¿­ä»£å™¨è¿›è¡Œæ— ç¼è¿æ¥ã€‚ STL å‡ ä¹æ‰€æœ‰çš„ä»£ç éƒ½é‡‡ç”¨äº†æ¨¡æ¿ç±»æˆ–è€…æ¨¡æ¿å‡½æ•° STL å¤§ä½“åˆ†ä¸ºå…­å¤§ç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯:å®¹å™¨ã€ç®—æ³•ã€è¿­ä»£å™¨ã€ä»¿å‡½æ•°ã€é€‚é…å™¨ï¼ˆé…æ¥å™¨ï¼‰ã€ç©ºé—´é…ç½®å™¨\nå®¹å™¨ï¼šå„ç§æ•°æ®ç»“æ„ï¼Œå¦‚ vectorã€listã€dequeã€setã€map ç­‰,ç”¨æ¥å­˜æ”¾æ•°æ®ã€‚ ç®—æ³•ï¼šå„ç§å¸¸ç”¨çš„ç®—æ³•ï¼Œå¦‚ sortã€findã€copyã€for_each ç­‰ è¿­ä»£å™¨ï¼šæ‰®æ¼”äº†å®¹å™¨ä¸ç®—æ³•ä¹‹é—´çš„èƒ¶åˆå‰‚ã€‚ ä»¿å‡½æ•°ï¼šè¡Œä¸ºç±»ä¼¼å‡½æ•°ï¼Œå¯ä½œä¸ºç®—æ³•çš„æŸç§ç­–ç•¥ã€‚ é€‚é…å™¨ï¼šä¸€ç§ç”¨æ¥ä¿®é¥°å®¹å™¨æˆ–è€…ä»¿å‡½æ•°æˆ–è¿­ä»£å™¨æ¥å£çš„ä¸œè¥¿ã€‚ ç©ºé—´é…ç½®å™¨ï¼šè´Ÿè´£ç©ºé—´çš„é…ç½®ä¸ç®¡ç†ã€‚ å®¹å™¨ï¼šç½®ç‰©ä¹‹æ‰€ä¹Ÿ\nSTL å®¹å™¨å°±æ˜¯å°†è¿ç”¨æœ€å¹¿æ³›çš„ä¸€äº›æ•°æ®ç»“æ„å®ç°å‡ºæ¥\nå¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼šæ•°ç»„, é“¾è¡¨,æ ‘, æ ˆ, é˜Ÿåˆ—, é›†åˆ, æ˜ å°„è¡¨ ç­‰\nè¿™äº›å®¹å™¨åˆ†ä¸ºåºåˆ—å¼å®¹å™¨å’Œå…³è”å¼å®¹å™¨ä¸¤ç§:\nåºåˆ—å¼å®¹å™¨:å¼ºè°ƒå€¼çš„æ’åºï¼Œåºåˆ—å¼å®¹å™¨ä¸­çš„æ¯ä¸ªå…ƒç´ å‡æœ‰å›ºå®šçš„ä½ç½®ã€‚ å…³è”å¼å®¹å™¨:äºŒå‰æ ‘ç»“æ„ï¼Œå„å…ƒç´ ä¹‹é—´æ²¡æœ‰ä¸¥æ ¼çš„ç‰©ç†ä¸Šçš„é¡ºåºå…³ç³»\nç®—æ³•ï¼šé—®é¢˜ä¹‹è§£æ³•ä¹Ÿ\næœ‰é™çš„æ­¥éª¤ï¼Œè§£å†³é€»è¾‘æˆ–æ•°å­¦ä¸Šçš„é—®é¢˜ï¼Œè¿™ä¸€é—¨å­¦ç§‘æˆ‘ä»¬å«åšç®—æ³•(Algorithms)\nç®—æ³•åˆ†ä¸º:è´¨å˜ç®—æ³•å’Œéè´¨å˜ç®—æ³•ã€‚\nè´¨å˜ç®—æ³•ï¼šæ˜¯æŒ‡è¿ç®—è¿‡ç¨‹ä¸­ä¼šæ›´æ”¹åŒºé—´å†…çš„å…ƒç´ çš„å†…å®¹ã€‚ä¾‹å¦‚æ‹·è´ï¼Œæ›¿æ¢ï¼Œåˆ é™¤ç­‰ç­‰\néè´¨å˜ç®—æ³•ï¼šæ˜¯æŒ‡è¿ç®—è¿‡ç¨‹ä¸­ä¸ä¼šæ›´æ”¹åŒºé—´å†…çš„å…ƒç´ å†…å®¹ï¼Œä¾‹å¦‚æŸ¥æ‰¾ã€è®¡æ•°ã€éå†ã€å¯»æ‰¾æå€¼ç­‰ç­‰\nè¿­ä»£å™¨ï¼šå®¹å™¨å’Œç®—æ³•ä¹‹é—´ç²˜åˆå‰‚\næä¾›ä¸€ç§æ–¹æ³•ï¼Œä½¿ä¹‹èƒ½å¤Ÿä¾åºå¯»è®¿æŸä¸ªå®¹å™¨æ‰€å«çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆæ— éœ€æš´éœ²è¯¥å®¹å™¨çš„å†…éƒ¨è¡¨ç¤ºæ–¹å¼ã€‚\næ¯ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±ä¸“å±çš„è¿­ä»£å™¨\nè¿­ä»£å™¨ä½¿ç”¨éå¸¸ç±»ä¼¼äºæŒ‡é’ˆï¼Œåˆå­¦é˜¶æ®µæˆ‘ä»¬å¯ä»¥å…ˆç†è§£è¿­ä»£å™¨ä¸ºæŒ‡é’ˆ\nå¸¸è§çš„å®¹å™¨ #\r","date":"27 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/c++/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"C++å®ç°æ•°æ®ç»“æ„å’Œåˆæ­¥çš„è®¤è¯† #\ré‰´äºæœªæ¥æ•°æ®ç»“æ„å’Œç®—æ³•çš„å®ç°æˆ‘æƒ³é€šè¿‡ C++æ¥å®ç°ï¼Œç°åœ¨ç®€è¦æ€»ç»“ä¸‹ C++çš„å¸¸ç”¨æ–¹æ³•å’Œæ•°æ®ç»“æ„ç±»å‹\nå¤´æ–‡ä»¶å’Œæ–¹æ³•å£°æ˜ #\rç­‰åŒäº C è¯­è¨€\næ ‡å‡†è¾“å…¥è¾“å‡ºå‡½æ•° #\rstd::cout \u0026lt;\u0026lt; \u0026#34;Hello, World!\u0026#34; \u0026lt;\u0026lt; std::endl; å¼•å…¥ using namespace std;è¿™å¯ä»¥é¿å…å‡½æ•°è¦ä¸æ–­çš„æ·»åŠ å‰ç¼€\nusing namespace std; ... int input; cout\u0026lt;\u0026lt;\u0026#34;Hello world\u0026#34;\u0026lt;\u0026lt;endl;//è¾“å‡ºå‡½æ•° cin\u0026gt;\u0026gt;input; printf(\u0026#34;%d\u0026#34;,input); .","title":"C++","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\rç½‘ä¸Šçš„æœ‹å‹ä»¬ #\rä¸‹ä¸€æ›²\rå½“ä½ çš„ç«™ç‚¹å¤±æ•ˆæ—¶ï¼Œæœ¬ç«™ä¼šå®šæœŸæ›´æ–°åˆ é™¤ã€‚\rä¸ä½ åˆ†äº«æˆ‘çš„çœ¼ç›\rPer aspera ad astra Â· å¯»æ­¤è‹¦æ—… ç»ˆè¾¾æ˜Ÿè¾°\ré‡‘åœ£çš“\ræˆ‘å–œæ¬¢å¬èŠ±å¼€çš„å£°éŸ³ï¼Œæ›´æƒ³è‡ªç”±åœ°æ·±æƒ…åœ°å‘¼å¸\rz3475\ræ³› ACGN çˆ±å¥½è€…ï¼Œå–œæ¬¢ä¸šä½™å†™ç‚¹å°ä½œå“æ”¹å–„ç”Ÿæ´»\rAncientElement\ræ˜¥æ±Ÿæ½®æ°´è¿æµ·å¹³ï¼Œæµ·ä¸Šæ˜æœˆå…±æ½®ç”Ÿ\rPinpeçš„äº‘ç«¯\rä¸€ä¸ªå±äºè‡ªå·±çš„äº‘æœµã€‚\rå°æ£‰å°¾å·´\rå…³å¿ƒå‰ç«¯æŠ€æœ¯ã€ä¸ªäººæˆé•¿ã€å¥³æ€§ä¸»ä¹‰å’Œå†…å®¹åˆ›ä½œ\rå®å­åšå®¢\räººç”Ÿå¾—æ„é¡»å°½æ¬¢\rä¸¨æµ…ç¬‘å®‰ç„¶ä¸¨\rç”Ÿæ´»ä¸æ­¢çœ¼å‰çš„è‹Ÿä¸”ï¼Œè¿˜æœ‰è¯—å’Œè¿œæ–¹\rè‰æ–¹å—\rè¿˜æ²¡æœ‰åå­—çš„æŠ˜è…¾äºº\ræœ¬ç«™åšå®¢ä»“åº“åœ°å€ï¼š\nToDreamr/todreamr.github.io\rPersonal Website\rJavaScript 0\r0\r1. å…³äºå‹æƒ…é“¾æ¥ #\rInternet æ˜¯ä¸€å¼ å¤§ç½‘ï¼Œè€Œå‹æƒ…é“¾æ¥æ˜¯ä¸€æ ¹è››ä¸ï¼ŒæŠŠæœ¬ç«™å’Œå¹¿å¤§åšå®¢ç¾¤è½è¿æ¥èµ·æ¥ã€‚é€šè¿‡å‹æƒ…é“¾æ¥ï¼Œä½ å¯ä»¥å‘ç°æ›´å¤šä¸ªäººç½‘ç«™ã€‚\n1.1 å¦‚ä½•ç”³è¯·å‹é“¾ï¼Ÿ #\rè¦æƒ³è®©ä½ çš„å‹é“¾å‡ºç°åœ¨æ­¤å¤„ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š\nå‘æˆ‘ï¼ˆ 484510171@qq.comæˆ– amixrip@163.comï¼‰å‘é€ç”µå­é‚®ä»¶\nåœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€\nç›¸åº”åœ°ï¼Œå¦‚æœä½ çš„ç½‘ç«™ä¹Ÿæœ‰å‹é“¾åŒºï¼Œè¯·æŠŠæœ¬ç«™æ”¾å…¥ã€‚\n1.2 å¿…è¦ä¿¡æ¯ #\rä½ çš„é‚®ä»¶æˆ–ç•™è¨€éœ€åŒ…å«ä»¥ä¸‹å­—æ®µï¼š\nname\tç½‘ç«™å link\tç½‘ç«™é“¾æ¥ avatar\tå¤´åƒåœ°å€ description\tä»‹ç» ä¸‰è¯­å­—æ®µç¤ºä¾‹ï¼š\nname\tç½‘ç«™å\nWebsite name\nlink\tç½‘ç«™é“¾æ¥\navatar\tå¤´åƒåœ°å€\ndescription\tä»‹ç»\nDescription ç´¹ä»‹\nä¸ºä¿è¯ç®€æ´ä¼˜é›…ï¼Œè¯·è¨€ç®€æ„èµ…åœ°å¡«å†™descritionå­—æ®µã€‚\nè‹¥æœ‰ç–‘é—®ï¼Œè¯·ç•™è¨€æˆ–å‘é‚®ç®±ã€‚\n\u0026hellip;\n","date":"27 October 2023","externalUrl":null,"permalink":"/friend/","section":"","summary":"ç½‘ä¸Šçš„æœ‹å‹ä»¬ #\rä¸‹ä¸€æ›²\rå½“ä½ çš„ç«™ç‚¹å¤±æ•ˆæ—¶ï¼Œæœ¬ç«™ä¼šå®šæœŸæ›´æ–°åˆ é™¤ã€‚\rä¸ä½ åˆ†äº«æˆ‘çš„çœ¼ç›\rPer aspera ad astra Â· å¯»æ­¤è‹¦æ—… ç»ˆè¾¾æ˜Ÿè¾°\ré‡‘åœ£çš“\ræˆ‘å–œæ¬¢å¬èŠ±å¼€çš„å£°éŸ³ï¼Œæ›´æƒ³è‡ªç”±åœ°æ·±æƒ…åœ°å‘¼å¸\rz3475\ræ³› ACGN çˆ±å¥½è€…ï¼Œå–œæ¬¢ä¸šä½™å†™ç‚¹å°ä½œå“æ”¹å–„ç”Ÿæ´»\rAncientElement\ræ˜¥æ±Ÿæ½®æ°´è¿æµ·å¹³ï¼Œæµ·ä¸Šæ˜æœˆå…±æ½®ç”Ÿ\rPinpeçš„äº‘ç«¯\rä¸€ä¸ªå±äºè‡ªå·±çš„äº‘æœµã€‚\rå°æ£‰å°¾å·´\rå…³å¿ƒå‰ç«¯æŠ€æœ¯ã€ä¸ªäººæˆé•¿ã€å¥³æ€§ä¸»ä¹‰å’Œå†…å®¹åˆ›ä½œ\rå®å­åšå®¢\räººç”Ÿå¾—æ„é¡»å°½æ¬¢\rä¸¨æµ…ç¬‘å®‰ç„¶ä¸¨\rç”Ÿæ´»ä¸æ­¢çœ¼å‰çš„è‹Ÿä¸”ï¼Œè¿˜æœ‰è¯—å’Œè¿œæ–¹\rè‰æ–¹å—\rè¿˜æ²¡æœ‰åå­—çš„æŠ˜è…¾äºº\ræœ¬ç«™åšå®¢ä»“åº“åœ°å€ï¼š","title":"friend","type":"page"},{"content":"","date":"27 October 2023","externalUrl":null,"permalink":"/tags/%E6%9C%8B%E5%8F%8B%E4%BB%AC/","section":"Tags","summary":"","title":"æœ‹å‹ä»¬","type":"tags"},{"content":"","date":"27 October 2023","externalUrl":null,"permalink":"/tags/%E8%AF%AD%E8%A8%80/","section":"Tags","summary":"","title":"è¯­è¨€","type":"tags"},{"content":"","date":"25 October 2023","externalUrl":null,"permalink":"/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/","section":"Tags","summary":"","title":"é¢è¯•é¢˜","type":"tags"},{"content":"\ré¢˜ç›® #\réš¾ç‚¹ï¼šåˆå¹¶\nè§£å†³æ–¹æ³•ï¼š\nå®ä½“ç±»ï¼š\npackage com.atguigu; import lombok.AllArgsConstructor; import lombok.Data; /** * com.atguigu.ItemDO * * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ * @since 2023/10/25 14:45 */ @Data @AllArgsConstructor public class ItemDO { int id;//10011 int type;//å…·ä½“ä¸ç¡®å®š double score;//[0ï¼Œ1000] @Override public String toString() { return \u0026#34;ItemDO{\u0026#34; + \u0026#34;id=\u0026#34; + id + \u0026#34;, type=\u0026#34; + type + \u0026#34;, score=\u0026#34; + score + \u0026#39;\\n\u0026#39;+ \u0026#39;}\u0026#39;; } } æ–¹æ³•ï¼š\npackage com.atguigu; import java.util.*; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; import java.util.concurrent.TimeUnit; import java.util.stream.Collectors; /** * com.atguigu.ItemRank * * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ * @since 2023/10/25 14:46 */ public class ItemRank { private static ExecutorService executorService= Executors.newFixedThreadPool(2); public static List\u0026lt;ItemDO\u0026gt; rerank(List\u0026lt;ItemDO\u0026gt; itemList) throws InterruptedException { List\u0026lt;Integer\u0026gt; type=new ArrayList\u0026lt;\u0026gt;(); for (ItemDO itemDO:itemList) { type.add(itemDO.type);//æ·»åŠ ç±»å‹ï¼Œè¿™å¯ä»¥ç”¨åœ¨ç±»å‹æ•°ç›®ä¸ç¡®å®šæ—¶å€™çš„éå†æ–¹æ³• } //åˆ†ç»„ Map\u0026lt;Integer, List\u0026lt;ItemDO\u0026gt;\u0026gt; group = itemList.stream().collect(Collectors.groupingBy(ItemDO::getType)); //æ’åº Runnable sort=()-\u0026gt;{ group.forEach((key, value) -\u0026gt; value.sort((o1, o2) -\u0026gt; (int) (o2.getScore()-o1.getScore()))); }; List\u0026lt;ItemDO\u0026gt; res=new ArrayList\u0026lt;\u0026gt;(); Runnable merge=()-\u0026gt;{ //åˆå¹¶æ’åºä¾æ®ï¼š Map\u0026lt;Integer,Integer\u0026gt; typeSort=new HashMap\u0026lt;\u0026gt;();//æŒ‰ç…§åŸæ¥çš„ä½ç½®å¡«è¿›å» for (Integer integer:group.keySet()) { typeSort.put(integer,0); } typeSort.keySet().forEach(System.out::println); //åˆå¹¶ç»“æœ for (int i=0;i\u0026lt;type.size();i++) { Integer curType= type.get(i);//å½“å‰çš„ç±»å‹ List\u0026lt;ItemDO\u0026gt; tmp=group.get(curType); Integer index = typeSort.get(curType); res.add(tmp.get(index)); typeSort.put(curType,index+1); } }; executorService.submit(sort); executorService.submit(merge); executorService.awaitTermination(3, TimeUnit.SECONDS); executorService.shutdown(); return res; } } ","date":"25 October 2023","externalUrl":null,"permalink":"/entire-note/%E9%9D%A2%E8%AF%95%E9%A2%98/%E6%9F%90%E4%B8%AA%E7%BE%A4%E9%87%8C%E7%9A%84/","section":"Entire-Notes","summary":"é¢˜ç›® #\réš¾ç‚¹ï¼šåˆå¹¶\nè§£å†³æ–¹æ³•ï¼š\nå®ä½“ç±»ï¼š\npackage com.atguigu; import lombok.AllArgsConstructor; import lombok.Data; /** * com.atguigu.ItemDO * * @author æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ * @since 2023/10/25 14:45 */ @Data @AllArgsConstructor public class ItemDO { int id;//10011 int type;//å…·ä½“ä¸ç¡®å®š double score;//[0ï¼Œ1000] @Override public String toString() { return \u0026#34;ItemDO{\u0026#34; + \u0026#34;id=\u0026#34; + id + \u0026#34;, type=\u0026#34; + type + \u0026#34;, score=\u0026#34; + score + \u0026#39;\\n\u0026#39;+ \u0026#39;}\u0026#39;; } } æ–¹æ³•ï¼š","title":"é¢è¯•é¢˜","type":"entire-note"},{"content":"CAFE BABE -\u0026gt;è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª.classæ–‡ä»¶\nç±»åŠ è½½æœºåˆ¶ #\rç±»åŠ è½½çš„æ¡ä»¶ï¼š\nä½¿ç”¨newå…³é”®å­—åˆ›å»ºå¯¹è±¡æ—¶ ä½¿ç”¨æŸä¸ªç±»çš„é™æ€æˆå‘˜ï¼ˆåŒ…æ‹¬æ–¹æ³•å’Œå­—æ®µï¼‰çš„æ—¶å€™ï¼ˆå½“ç„¶ï¼Œfinalç±»å‹çš„é™æ€å­—æ®µæœ‰å¯èƒ½åœ¨ç¼–è¯‘çš„æ—¶å€™è¢«æ”¾åˆ°äº†å½“å‰ç±»çš„å¸¸é‡æ± ä¸­ï¼Œè¿™ç§æƒ…å†µä¸‹æ˜¯ä¸ä¼šè§¦å‘è‡ªåŠ¨åŠ è½½çš„ï¼‰ ä½¿ç”¨åå°„å¯¹ç±»ä¿¡æ¯è¿›è¡Œè·å–çš„æ—¶å€™ï¼ˆä¹‹å‰çš„æ•°æ®åº“é©±åŠ¨å°±æ˜¯è¿™æ ·çš„ï¼‰ åŠ è½½ä¸€ä¸ªç±»çš„å­ç±»æ—¶ åŠ è½½æ¥å£çš„å®ç°ç±»ï¼Œä¸”æ¥å£å¸¦æœ‰defaultçš„æ–¹æ³•é»˜è®¤å®ç°æ—¶ å­—èŠ‚ç æŒ‡ä»¤ #\rå…ˆè¿”å›ç»“æœå†è¿›è¡Œè‡ªå¢æˆ–è€…å…ˆè‡ªå¢å†ç»™å‡ºç»“æœ\nAsmå­—èŠ‚ç æ¡†æ¶ #\råŠé€€ï¼Œè¿˜æ˜¯ç®—äº†ã€‚ã€‚ã€‚\nSpringå®ç°çš„CGLibå°±æ˜¯åŸºäºè¿™ä¸ªå®ç°çš„ã€‚\nç±»åŠ è½½æœºåˆ¶ #\r","date":"24 October 2023","externalUrl":null,"permalink":"/entire-note/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/","section":"Entire-Notes","summary":"CAFE BABE -\u0026gt;è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª.classæ–‡ä»¶\nç±»åŠ è½½æœºåˆ¶ #\rç±»åŠ è½½çš„æ¡ä»¶ï¼š\nä½¿ç”¨newå…³é”®å­—åˆ›å»ºå¯¹è±¡æ—¶ ä½¿ç”¨æŸä¸ªç±»çš„é™æ€æˆå‘˜ï¼ˆåŒ…æ‹¬æ–¹æ³•å’Œå­—æ®µï¼‰çš„æ—¶å€™ï¼ˆå½“ç„¶ï¼Œfinalç±»å‹çš„é™æ€å­—æ®µæœ‰å¯èƒ½åœ¨ç¼–è¯‘çš„æ—¶å€™è¢«æ”¾åˆ°äº†å½“å‰ç±»çš„å¸¸é‡æ± ä¸­ï¼Œè¿™ç§æƒ…å†µä¸‹æ˜¯ä¸ä¼šè§¦å‘è‡ªåŠ¨åŠ è½½çš„ï¼‰ ä½¿ç”¨åå°„å¯¹ç±»ä¿¡æ¯è¿›è¡Œè·å–çš„æ—¶å€™ï¼ˆä¹‹å‰çš„æ•°æ®åº“é©±åŠ¨å°±æ˜¯è¿™æ ·çš„ï¼‰ åŠ è½½ä¸€ä¸ªç±»çš„å­ç±»æ—¶ åŠ è½½æ¥å£çš„å®ç°ç±»ï¼Œä¸”æ¥å£å¸¦æœ‰defaultçš„æ–¹æ³•é»˜è®¤å®ç°æ—¶ å­—èŠ‚ç æŒ‡ä»¤ #\rå…ˆè¿”å›ç»“æœå†è¿›è¡Œè‡ªå¢æˆ–è€…å…ˆè‡ªå¢å†ç»™å‡ºç»“æœ\nAsmå­—èŠ‚ç æ¡†æ¶ #\råŠé€€ï¼Œè¿˜æ˜¯ç®—äº†ã€‚ã€‚ã€‚\nSpringå®ç°çš„CGLibå°±æ˜¯åŸºäºè¿™ä¸ªå®ç°çš„ã€‚\nç±»åŠ è½½æœºåˆ¶ #\r","title":"ç±»åŠ è½½","type":"entire-note"},{"content":"","date":"24 October 2023","externalUrl":null,"permalink":"/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/","section":"Tags","summary":"","title":"è™šæ‹Ÿæœº","type":"tags"},{"content":"\rå¼•ç”¨ç±»å‹ #\rå¼ºå¼•ç”¨ï¼šnew Object(); #\rJVMä¸ä¼šéšæ„å›æ”¶å¼ºå¼•ç”¨å¯¹è±¡\nç›¸åï¼Œå°†ä¼šå°è¯•å›æ”¶è½¯å¼•ç”¨\nè½¯å¼•ç”¨ï¼š #\rSoftReference\u0026lt;Object\u0026gt; soft=new SoftReference(); è®¾ç½®å†…å­˜å¤§å°ï¼š-Xms -Xmx\nReferenceQueue\u0026lt;Object\u0026gt; queue = new ReferenceQueue\u0026lt;\u0026gt;(); SoftReference\u0026lt;Object\u0026gt; reference = new SoftReference\u0026lt;\u0026gt;(new Object(), queue); System.out.println(reference); try{ List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); while (true) list.add(new String(\u0026#34;lbwnb\u0026#34;)); }catch (Throwable t){ System.out.println(\u0026#34;å‘ç”Ÿäº†å†…å­˜æº¢å‡ºï¼\u0026#34;+t.getMessage()); System.out.println(\u0026#34;è½¯å¼•ç”¨å¯¹è±¡ï¼š\u0026#34;+reference.get()); System.out.println(queue.poll()); } å¼±å¼•ç”¨ï¼š #\rReferenceQueue\u0026lt;Object\u0026gt; queue = new ReferenceQueue\u0026lt;\u0026gt;(); SoftReference\u0026lt;Object\u0026gt; reference = new SoftReference\u0026lt;\u0026gt;(new Object(), queue); WeakReference\u0026lt;Object\u0026gt; weakReference=new WeakReference\u0026lt;\u0026gt;(new Object(),queue); System.gc(); System.out.println(reference.get()); System.out.println(weakReference.get()); WeakHashMap #\rå½“å¼•ç”¨å˜é‡è¢«æ–­å¼€çš„æ—¶å€™ï¼Œè¿™ä¸ªå“ˆå¸Œå°†ä¼šè¢«æ–­å¼€\nè™šå¼•ç”¨ PhantomReference #\rç›´æ¥æ ‡è¯†,è™šå¼•ç”¨ç›¸å½“äºæ²¡æœ‰å¼•ç”¨ï¼Œéšæ—¶éƒ½æœ‰å¯èƒ½ä¼šè¢«å›æ”¶ã€‚\n","date":"24 October 2023","externalUrl":null,"permalink":"/entire-note/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%85%83%E7%A9%BA%E9%97%B4/%E5%85%83%E7%A9%BA%E9%97%B4/","section":"Entire-Notes","summary":"å¼•ç”¨ç±»å‹ #\rå¼ºå¼•ç”¨ï¼šnew Object(); #\rJVMä¸ä¼šéšæ„å›æ”¶å¼ºå¼•ç”¨å¯¹è±¡\nç›¸åï¼Œå°†ä¼šå°è¯•å›æ”¶è½¯å¼•ç”¨\nè½¯å¼•ç”¨ï¼š #\rSoftReference\u0026lt;Object\u0026gt; soft=new SoftReference(); è®¾ç½®å†…å­˜å¤§å°ï¼š-Xms -Xmx\nReferenceQueue\u0026lt;Object\u0026gt; queue = new ReferenceQueue\u0026lt;\u0026gt;(); SoftReference\u0026lt;Object\u0026gt; reference = new SoftReference\u0026lt;\u0026gt;(new Object(), queue); System.out.println(reference); try{ List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); while (true) list.","title":"å…ƒç©ºé—´å’Œå¼•ç”¨æ–¹å¼","type":"entire-note"},{"content":"\rå…¨éƒ¨æ–‡ç« \rMySQLä¸€äº›å¸¸è¯†å’Œå‡½æ•°\r15 October 2024\u0026middot;2 åˆ†é’Ÿ\rOracleæ•°æ®åº“\r15 October 2024\u0026middot;4 åˆ†é’Ÿ\rUbuntuæ“ä½œç³»ç»Ÿ\r15 October 2024\u0026middot;1 åˆ†é’Ÿ\rç¨‹åºè®¾è®¡ä¸­ä½¿ç”¨åˆ°çš„ä¸€äº›å›¾\r15 October 2024\u0026middot;1 åˆ†é’Ÿ\ré¢è¯•ç»å†\r15 October 2024\u0026middot;2 åˆ†é’Ÿ\ré¢è¯•\rHelp\r30 April 2024\u0026middot;1 åˆ†é’Ÿ\rå¸®åŠ©æ–‡æ¡£\rä»£ç éšæƒ³å½•ç®—æ³•åˆè¾‘\r19 March 2024\u0026middot;1 åˆ†é’Ÿ\rç®—æ³•\ræŠ½è±¡æ•°æ®ç±»å‹ADT\r18 March 2024\u0026middot;2 åˆ†é’Ÿ\rè¦æ±‚ç†Ÿè®°\rMysql-Redis\r15 March 2024\u0026middot;8 åˆ†é’Ÿ\rä¸»ä»éƒ¨åˆ†\rMacä½“éªŒç‰ˆ\r14 March 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rçˆ¬è™«æµ…è®°\r13 March 2024\u0026middot;2 åˆ†é’Ÿ\rç¬”è®°\rWalineè¯„è®ºç³»ç»Ÿ\r11 March 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rè®¡ç®—æœºç§‘å­¦åŸºç¡€\r9 March 2024\u0026middot;3 åˆ†é’Ÿ\rè¦æ±‚ç†Ÿè®°\rä½¿ç”¨ä¸»ä»æ¨¡å¼æ­å»ºä¸€ä¸ªSocketç½‘ç»œé€šä¿¡æ¨¡å‹\r6 March 2024\u0026middot;1 åˆ†é’Ÿ\rNio\rå¾®æœåŠ¡åŸºç¡€çŸ¥è¯†\r5 March 2024\u0026middot;2 åˆ†é’Ÿ\rå¾®æœåŠ¡\rå¾®ä¿¡ç™»å½•\r2 March 2024\u0026middot;4 åˆ†é’Ÿ\rOauth2\rè‡ªç”¨çš„Vscodeä¸ªäººè§‰å¾—è¿˜ç®—è€çœ‹çš„ä¸»é¢˜å’Œå­—ä½“ä»¥åŠç¼–ç ä¹ æƒ¯\r2 March 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rSpring-Security\r23 February 2024\u0026middot;1 åˆ†é’Ÿ\rSpring\rDocker\r8 February 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rMusic\r7 February 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\ræœ¬ç«™Musicæ­å»ºç›¸å…³\r7 February 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\réŸ³ä¹\r29 January 2024\rNetFlixå’ŒSpringCloudAlibaba\r26 January 2024\u0026middot;1 åˆ†é’Ÿ\rå¾®æœåŠ¡\ræˆ‘çš„ç”Ÿæ—¥\r15 November 2023\u0026middot;1 åˆ†é’Ÿ\rç”Ÿæ´»\råŒºé—´ä¸ªä½å’Œ\r14 November 2023\u0026middot;1 åˆ†é’Ÿ\rLeetcode\ræ•°ä¹‹å’Œ\r14 November 2023\u0026middot;1 åˆ†é’Ÿ\rLeetcode\rEureka\r11 November 2023\u0026middot;1 åˆ†é’Ÿ\rå¾®æœåŠ¡\rå†™ç‚¹è„šæœ¬\r11 November 2023\u0026middot;1 åˆ†é’Ÿ\réšæœº\ræ²¡å¤‡ä»½ç¬”è®°çš„åæœ\r11 November 2023\u0026middot;1 åˆ†é’Ÿ\réšè®°\rRabbitMq\r7 November 2023\u0026middot;2 åˆ†é’Ÿ\ræ¶ˆæ¯é˜Ÿåˆ—\rVue3 å“åº”å¼Apiå¼€å‘ç¬”è®°\r4 November 2023\u0026middot;2 åˆ†é’Ÿ\rVue\ræ­å»ºå›¾åºŠ\r3 November 2023\u0026middot;1 åˆ†é’Ÿ\ræ‚è®°\rC++\r27 October 2023\u0026middot;6 åˆ†é’Ÿ\rè¯­è¨€\rfriend\r27 October 2023\u0026middot;1 åˆ†é’Ÿ\ræœ‹å‹ä»¬\ré¢è¯•é¢˜\r25 October 2023\u0026middot;1 åˆ†é’Ÿ\ré¢è¯•é¢˜\rç±»åŠ è½½\r24 October 2023\u0026middot;1 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\rå…ƒç©ºé—´å’Œå¼•ç”¨æ–¹å¼\r24 October 2023\u0026middot;1 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\rLatexè¯­æ³•\r19 October 2023\u0026middot;1 åˆ†é’Ÿ\rLatex\rJvm\r12 October 2023\u0026middot;2 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\råƒåœ¾å›æ”¶æœºåˆ¶\r12 October 2023\u0026middot;1 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\rçŠ¶æ€æœº\r12 October 2023\u0026middot;1 åˆ†é’Ÿ\rç¡¬ä»¶è¯­è¨€\rå­¦ä¹ è®¡åˆ’\r10 October 2023\u0026middot;1 åˆ†é’Ÿ\rè§„åˆ’\rå¹¶å‘è¿›é˜¶\r9 October 2023\u0026middot;4 åˆ†é’Ÿ\rå¹¶å‘ç¼–ç¨‹\rJava-Concurrent\r9 October 2023\u0026middot;3 åˆ†é’Ÿ\rå¹¶å‘ç¼–ç¨‹\rå¦‚ä½•é€šè¿‡hugoæ­å»ºè‡ªå·±çš„åšå®¢\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\ræ‚è®°\rç§‘å­¦ä¸Šç½‘\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\ræ‚è®°\rå¯¹è±¡é—´çš„å…³ç³»\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rJava SE\rå…³é”®å­—\r3 October 2023\u0026middot;5 åˆ†é’Ÿ\rJava SE\rå®ä¾‹åŒ–Node\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rJava SE\ræ•°æ®ç»“æ„ç¯‡\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rç®—æ³•\råº”è¯¥æ²¡äººæ¥è¿™é‡Œå§\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rThreadLocal\r3 October 2023\u0026middot;2 åˆ†é’Ÿ\rJava SE\rRedis\r3 October 2023\u0026middot;2 åˆ†é’Ÿ\rç¼“å­˜\rHello Friend\r3 October 2003\u0026middot;1 åˆ†é’Ÿ\rPost\r1 January 0001\u0026middot;52 åˆ†é’Ÿ\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rDocker\r1 January 0001\u0026middot;7 åˆ†é’Ÿ\rMysql\r1 January 0001\u0026middot;6 åˆ†é’Ÿ\rNetty\r1 January 0001\u0026middot;17 åˆ†é’Ÿ\rNIO\r1 January 0001\u0026middot;22 åˆ†é’Ÿ\rRabbitMq\r1 January 0001\u0026middot;7 åˆ†é’Ÿ\rSpringCloud 1\r1 January 0001\u0026middot;9 åˆ†é’Ÿ\rSpringCloud 2\r1 January 0001\u0026middot;11 åˆ†é’Ÿ\rSpringCloud 3\r1 January 0001\u0026middot;10 åˆ†é’Ÿ\råšå®¢ç»Ÿè®¡\råˆ›å»ºå‹\r1 January 0001\u0026middot;4 åˆ†é’Ÿ\räºŒåˆ†æ³•\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rå°é¢æµ‹è¯•\r1 January 0001\rå¤æ‚åº¦\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rå“ˆå¸Œç¯‡\r1 January 0001\u0026middot;2 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rç»“æ„å‹\r1 January 0001\u0026middot;5 åˆ†é’Ÿ\ré“¾è¡¨çš„åŸºæœ¬æ“ä½œ\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ré“¾è¡¨ç¯‡\r1 January 0001\u0026middot;3 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rèºæ—‹çŸ©é˜µ\r1 January 0001\u0026middot;2 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ré¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™\r1 January 0001\u0026middot;4 åˆ†é’Ÿ\rä¹¦å½±éŸ³\rè¡Œä¸ºå‹\r1 January 0001\u0026middot;7 åˆ†é’Ÿ\rç§»é™¤å…ƒç´ \r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ræœ‰åºæ•°ç»„çš„å¹³æ–¹\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ré•¿åº¦æœ€å°çš„æ•°ç»„\r1 January 0001\u0026middot;2 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\r","date":"21 October 2023","externalUrl":null,"permalink":"/all/","section":"","summary":"\rå…¨éƒ¨æ–‡ç« \rMySQLä¸€äº›å¸¸è¯†å’Œå‡½æ•°\r15 October 2024\u0026middot;2 åˆ†é’Ÿ\rOracleæ•°æ®åº“\r15 October 2024\u0026middot;4 åˆ†é’Ÿ\rUbuntuæ“ä½œç³»ç»Ÿ\r15 October 2024\u0026middot;1 åˆ†é’Ÿ\rç¨‹åºè®¾è®¡ä¸­ä½¿ç”¨åˆ°çš„ä¸€äº›å›¾\r15 October 2024\u0026middot;1 åˆ†é’Ÿ\ré¢è¯•ç»å†\r15 October 2024\u0026middot;2 åˆ†é’Ÿ\ré¢è¯•\rHelp\r30 April 2024\u0026middot;1 åˆ†é’Ÿ\rå¸®åŠ©æ–‡æ¡£\rä»£ç éšæƒ³å½•ç®—æ³•åˆè¾‘\r19 March 2024\u0026middot;1 åˆ†é’Ÿ\rç®—æ³•\ræŠ½è±¡æ•°æ®ç±»å‹ADT\r18 March 2024\u0026middot;2 åˆ†é’Ÿ\rè¦æ±‚ç†Ÿè®°\rMysql-Redis\r15 March 2024\u0026middot;8 åˆ†é’Ÿ\rä¸»ä»éƒ¨åˆ†\rMacä½“éªŒç‰ˆ\r14 March 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rçˆ¬è™«æµ…è®°\r13 March 2024\u0026middot;2 åˆ†é’Ÿ\rç¬”è®°\rWalineè¯„è®ºç³»ç»Ÿ\r11 March 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rè®¡ç®—æœºç§‘å­¦åŸºç¡€\r9 March 2024\u0026middot;3 åˆ†é’Ÿ\rè¦æ±‚ç†Ÿè®°\rä½¿ç”¨ä¸»ä»æ¨¡å¼æ­å»ºä¸€ä¸ªSocketç½‘ç»œé€šä¿¡æ¨¡å‹\r6 March 2024\u0026middot;1 åˆ†é’Ÿ\rNio\rå¾®æœåŠ¡åŸºç¡€çŸ¥è¯†\r5 March 2024\u0026middot;2 åˆ†é’Ÿ\rå¾®æœåŠ¡\rå¾®ä¿¡ç™»å½•\r2 March 2024\u0026middot;4 åˆ†é’Ÿ\rOauth2\rè‡ªç”¨çš„Vscodeä¸ªäººè§‰å¾—è¿˜ç®—è€çœ‹çš„ä¸»é¢˜å’Œå­—ä½“ä»¥åŠç¼–ç ä¹ æƒ¯\r2 March 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rSpring-Security\r23 February 2024\u0026middot;1 åˆ†é’Ÿ\rSpring\rDocker\r8 February 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\rMusic\r7 February 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\ræœ¬ç«™Musicæ­å»ºç›¸å…³\r7 February 2024\u0026middot;1 åˆ†é’Ÿ\rç¬”è®°\réŸ³ä¹\r29 January 2024\rNetFlixå’ŒSpringCloudAlibaba\r26 January 2024\u0026middot;1 åˆ†é’Ÿ\rå¾®æœåŠ¡\ræˆ‘çš„ç”Ÿæ—¥\r15 November 2023\u0026middot;1 åˆ†é’Ÿ\rç”Ÿæ´»\råŒºé—´ä¸ªä½å’Œ\r14 November 2023\u0026middot;1 åˆ†é’Ÿ\rLeetcode\ræ•°ä¹‹å’Œ\r14 November 2023\u0026middot;1 åˆ†é’Ÿ\rLeetcode\rEureka\r11 November 2023\u0026middot;1 åˆ†é’Ÿ\rå¾®æœåŠ¡\rå†™ç‚¹è„šæœ¬\r11 November 2023\u0026middot;1 åˆ†é’Ÿ\réšæœº\ræ²¡å¤‡ä»½ç¬”è®°çš„åæœ\r11 November 2023\u0026middot;1 åˆ†é’Ÿ\réšè®°\rRabbitMq\r7 November 2023\u0026middot;2 åˆ†é’Ÿ\ræ¶ˆæ¯é˜Ÿåˆ—\rVue3 å“åº”å¼Apiå¼€å‘ç¬”è®°\r4 November 2023\u0026middot;2 åˆ†é’Ÿ\rVue\ræ­å»ºå›¾åºŠ\r3 November 2023\u0026middot;1 åˆ†é’Ÿ\ræ‚è®°\rC++\r27 October 2023\u0026middot;6 åˆ†é’Ÿ\rè¯­è¨€\rfriend\r27 October 2023\u0026middot;1 åˆ†é’Ÿ\ræœ‹å‹ä»¬\ré¢è¯•é¢˜\r25 October 2023\u0026middot;1 åˆ†é’Ÿ\ré¢è¯•é¢˜\rç±»åŠ è½½\r24 October 2023\u0026middot;1 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\rå…ƒç©ºé—´å’Œå¼•ç”¨æ–¹å¼\r24 October 2023\u0026middot;1 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\rLatexè¯­æ³•\r19 October 2023\u0026middot;1 åˆ†é’Ÿ\rLatex\rJvm\r12 October 2023\u0026middot;2 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\råƒåœ¾å›æ”¶æœºåˆ¶\r12 October 2023\u0026middot;1 åˆ†é’Ÿ\rè™šæ‹Ÿæœº\rçŠ¶æ€æœº\r12 October 2023\u0026middot;1 åˆ†é’Ÿ\rç¡¬ä»¶è¯­è¨€\rå­¦ä¹ è®¡åˆ’\r10 October 2023\u0026middot;1 åˆ†é’Ÿ\rè§„åˆ’\rå¹¶å‘è¿›é˜¶\r9 October 2023\u0026middot;4 åˆ†é’Ÿ\rå¹¶å‘ç¼–ç¨‹\rJava-Concurrent\r9 October 2023\u0026middot;3 åˆ†é’Ÿ\rå¹¶å‘ç¼–ç¨‹\rå¦‚ä½•é€šè¿‡hugoæ­å»ºè‡ªå·±çš„åšå®¢\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\ræ‚è®°\rç§‘å­¦ä¸Šç½‘\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\ræ‚è®°\rå¯¹è±¡é—´çš„å…³ç³»\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rJava SE\rå…³é”®å­—\r3 October 2023\u0026middot;5 åˆ†é’Ÿ\rJava SE\rå®ä¾‹åŒ–Node\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rJava SE\ræ•°æ®ç»“æ„ç¯‡\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rç®—æ³•\råº”è¯¥æ²¡äººæ¥è¿™é‡Œå§\r3 October 2023\u0026middot;1 åˆ†é’Ÿ\rThreadLocal\r3 October 2023\u0026middot;2 åˆ†é’Ÿ\rJava SE\rRedis\r3 October 2023\u0026middot;2 åˆ†é’Ÿ\rç¼“å­˜\rHello Friend\r3 October 2003\u0026middot;1 åˆ†é’Ÿ\rPost\r1 January 0001\u0026middot;52 åˆ†é’Ÿ\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rDocker\r1 January 0001\u0026middot;7 åˆ†é’Ÿ\rMysql\r1 January 0001\u0026middot;6 åˆ†é’Ÿ\rNetty\r1 January 0001\u0026middot;17 åˆ†é’Ÿ\rNIO\r1 January 0001\u0026middot;22 åˆ†é’Ÿ\rRabbitMq\r1 January 0001\u0026middot;7 åˆ†é’Ÿ\rSpringCloud 1\r1 January 0001\u0026middot;9 åˆ†é’Ÿ\rSpringCloud 2\r1 January 0001\u0026middot;11 åˆ†é’Ÿ\rSpringCloud 3\r1 January 0001\u0026middot;10 åˆ†é’Ÿ\råšå®¢ç»Ÿè®¡\råˆ›å»ºå‹\r1 January 0001\u0026middot;4 åˆ†é’Ÿ\räºŒåˆ†æ³•\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rå°é¢æµ‹è¯•\r1 January 0001\rå¤æ‚åº¦\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rå“ˆå¸Œç¯‡\r1 January 0001\u0026middot;2 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rç»“æ„å‹\r1 January 0001\u0026middot;5 åˆ†é’Ÿ\ré“¾è¡¨çš„åŸºæœ¬æ“ä½œ\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ré“¾è¡¨ç¯‡\r1 January 0001\u0026middot;3 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\rèºæ—‹çŸ©é˜µ\r1 January 0001\u0026middot;2 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ré¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™\r1 January 0001\u0026middot;4 åˆ†é’Ÿ\rä¹¦å½±éŸ³\rè¡Œä¸ºå‹\r1 January 0001\u0026middot;7 åˆ†é’Ÿ\rç§»é™¤å…ƒç´ \r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ræœ‰åºæ•°ç»„çš„å¹³æ–¹\r1 January 0001\u0026middot;1 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\ré•¿åº¦æœ€å°çš„æ•°ç»„\r1 January 0001\u0026middot;2 åˆ†é’Ÿ\rä»£ç éšæƒ³å½•\r","title":"å…¨éƒ¨","type":"page"},{"content":"","date":"19 October 2023","externalUrl":null,"permalink":"/tags/latex/","section":"Tags","summary":"","title":"Latex","type":"tags"},{"content":"\rç¯å¢ƒè®¾ç½®ï¼š #\r\\begin{center} \\end{center} è¿™æ ·å°±æ˜¯ä¸€ä¸ªç¯å¢ƒï¼Œæ‰€æœ‰çš„éƒ½æ˜¯éš”ç¦»çš„ã€‚\nå¤´éƒ¨æ–‡ä»¶ #\r\\documentclass{setting} \\usepackage[utf8]{inputenc} \\usepackage[T1]{fontenc} \\usepackage{graphicx} \\usepackage[]{setspace} åœ¨å¤´éƒ¨è®¾ç½®æ–‡ä»¶æ’ç‰ˆæ ·å¼ï¼Œå¯¼å…¥ä¾èµ–åŒ…ï¼ŒåŸºæœ¬åœ¨æœ¬åœ°\nè¿è¡Œéƒ¨åˆ† #\r\\begin{document} é€‰æ‹©åˆé€‚çš„ç¼–è¯‘å™¨æ‰å¯ä»¥ç¼–è¯‘ï¼Œå¦åˆ™å‡ºé”™\nå¯¼å…¥è‡ªå®šä¹‰å¼æ · #\ræ›´æ–°å‘½ä»¤ï¼štexhash å¼æ ·æ–‡ä»¶çš„åç¼€ï¼š.clsæ–‡ä»¶ï¼Œåœ¨é‡Œé¢è‡ªå®šä¹‰å‘½ä»¤å’Œæ ·å¼å®ç°æ’ç‰ˆå¸ƒå±€\nä¾‹å¦‚ä¸‹é¢ï¼š\n\\newcommand{\\role}[2]{ {\\par \\textit{#1} ~ #2 \\par} \\vspace{0.5ex} } \\newcommand{\\biInfo}[2]{ {#1 \\quad #2} } \\newcommand{\\tripleInfo}[3]{ {#1 \\quad #2 \\quad #3} } ","date":"19 October 2023","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/latex/","section":"ç¬”è®°s","summary":"\rç¯å¢ƒè®¾ç½®ï¼š #\r\\begin{center} \\end{center} è¿™æ ·å°±æ˜¯ä¸€ä¸ªç¯å¢ƒï¼Œæ‰€æœ‰çš„éƒ½æ˜¯éš”ç¦»çš„ã€‚\nå¤´éƒ¨æ–‡ä»¶ #\r\\documentclass{setting} \\usepackage[utf8]{inputenc} \\usepackage[T1]{fontenc} \\usepackage{graphicx} \\usepackage[]{setspace} åœ¨å¤´éƒ¨è®¾ç½®æ–‡ä»¶æ’ç‰ˆæ ·å¼ï¼Œå¯¼å…¥ä¾èµ–åŒ…ï¼ŒåŸºæœ¬åœ¨æœ¬åœ°\nè¿è¡Œéƒ¨åˆ† #\r\\begin{document} é€‰æ‹©åˆé€‚çš„ç¼–è¯‘å™¨æ‰å¯ä»¥ç¼–è¯‘ï¼Œå¦åˆ™å‡ºé”™\nå¯¼å…¥è‡ªå®šä¹‰å¼æ · #\ræ›´æ–°å‘½ä»¤ï¼štexhash å¼æ ·æ–‡ä»¶çš„åç¼€ï¼š.clsæ–‡ä»¶ï¼Œåœ¨é‡Œé¢è‡ªå®šä¹‰å‘½ä»¤å’Œæ ·å¼å®ç°æ’ç‰ˆå¸ƒå±€\nä¾‹å¦‚ä¸‹é¢ï¼š\n\\newcommand{\\role}[2]{ {\\par \\textit{#1} ~ #2 \\par} \\vspace{0.5ex} } \\newcommand{\\biInfo}[2]{ {#1 \\quad #2} } \\newcommand{\\tripleInfo}[3]{ {#1 \\quad #2 \\quad #3} } ","title":"Latexè¯­æ³•","type":"ç¬”è®°"},{"content":"\ræ¦‚è¿° #\rJVM æ˜¯æ¨¡æ‹Ÿç‰©ç†æœºå®ç°çš„å°† javac ç¼–è¯‘ä¸º.class æ–‡ä»¶ï¼Œjvm æ”¯æŒå¹³å°æ— å…³æ€§ã€‚ class æ–‡ä»¶é€šè¿‡ç±»åŠ è½½å™¨-ã€‹è§£é‡Šå™¨-ã€‹ç¡¬ä»¶æ²Ÿé€š\nJvm åŸºäº HotSpot è™šæ‹Ÿæœºæ¶æ„åŒæ—¶ä¹Ÿæ˜¯åŸºäºæ ˆå®ç°çš„ã€‚ä¸ C è¯­è¨€ä¸åŒï¼Œä¸åŒæ¶æ„çš„æ“ä½œç³»ç»Ÿç¼–è¯‘è¾“å‡ºçš„æ–‡ä»¶ä¸åŒï¼Œjvm ç¼–è¯‘åäº§ç”Ÿçš„ æ–‡ä»¶å®Œå…¨ç›¸åŒã€‚\nç”±äºæ‰§è¡Œä¸€æ®µç¨‹åºéœ€è¦ä¸æ–­åœ°ç¼–è¯‘å’Œåç¼–è¯‘ï¼Œå°†çƒ­ç‚¹æ‰§è¡Œçš„ä»£ä¹°æŸœå†…ä¸ºçƒ­ç‚¹ä»£ç å†è½¬æ¢ä¸ºæœºå™¨ç æé«˜æ‰§è¡Œæ•ˆç‡ã€‚åŒæ—¶ jdk1.2 ä¹‹åæ”¯æŒä½¿ç”¨ JNI æ¥ è°ƒç”¨ C/C++ä»£ç æå‡ä»£ç æ‰§è¡Œæ•ˆç‡\næŒ‡ä»¤ #\råŸºæœ¬æ•°æ®ç»“æ„ï¼šå †æ ˆ+é˜Ÿåˆ—\nå¸¸è§çš„ç¼–è¯‘å‘½ä»¤ï¼š\njavap -g :vars xxx.java\nåç¼–è¯‘ï¼š javap -v .class æ–‡ä»¶åœ°å€\nåç¼–è¯‘åçš„ä»£ç æ ˆé¡¶å…ƒç´ ä½œä¸ºæ“ä½œæ•°ï¼Œå½“éœ€è¦ä¿å­˜å˜é‡çš„æ—¶å€™ï¼Œè¿›å…¥é˜Ÿåˆ—\néƒ¨åˆ†å˜é‡æŸäº›å…³é”®å­—æ— æ³•ä¿å­˜å°†ä¼šä¿å­˜åˆ°å¸¸é‡æ± é‡Œé¢ã€‚ä¾‹å¦‚ bipush åªæ”¯æŒå•å­—èŠ‚æ•°æ®\nç¯å¢ƒéƒ¨ç½² #\rLinux ä¸‹ä¸‹è½½ç›¸å…³ä¾èµ–\nsudo yum install build-essential libxrender-dev xorg-dev libasound2-dev libcups2-dev gawk zip libxtst-dev libxi-dev libxt-dev gobjc gcc ç¯å¢ƒï¼š\nmake\njdk ç¯å¢ƒï¼šopen-jdk8\nLinux ä¸‹ç¼–è¯‘ç»“æœï¼š\nç¼–è¯‘ Hello Worldï¼š\næ‰‹åŠ¨ç¼–è¯‘ jdk8 éƒ¨åˆ† #\rJVM å†…å­˜ç®¡ç† #\rC/C++å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é€šè¿‡ä½¿ç”¨ç”³è¯·å†…å­˜çš„æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡æˆ–æ˜¯å­˜æ”¾æŸäº›æ•°æ®ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿå¸¦æ¥äº†ä¸€äº›é¢å¤–çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¦åœ¨ä½•æ—¶é‡Šæ”¾è¿™äº›å†…å­˜ï¼Œæ€ä¹ˆæ‰èƒ½ä½¿å¾—å†…å­˜çš„ä½¿ç”¨æœ€é«˜æ•ˆï¼Œ\u0026gt; å› æ­¤ï¼Œå†…å­˜ç®¡ ç†æ˜¯ä¸€ä¸ªéå¸¸ä¸¥è‚ƒçš„é—®é¢˜ã€‚\n#include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; int main(){ //åŠ¨æ€ç”³è¯·4ä¸ªintå¤§å°çš„å†…å­˜ç©ºé—´ int* memory = malloc(sizeof(int) * 4); //ä¿®æ”¹ç¬¬ä¸€ä¸ªintç©ºé—´çš„å€¼ memory[0] = 10; //ä¿®æ”¹ç¬¬äºŒä¸ªintç©ºé—´çš„å€¼ memory[1] = 2; //éå†å†…å­˜åŒºåŸŸä¸­æ‰€æœ‰çš„å€¼ for (int i = 0;i \u0026lt; 4;i++){ printf(\u0026#34;%d \u0026#34;, memory[i]); } //é‡Šæ”¾æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åŒºåŸŸ free(memory); //æœ€åå°†æŒ‡é’ˆèµ‹å€¼ä¸ºNULL memory = NULL; } ä¸€æ—¦å‡ºç°å†…å­˜é—®é¢˜ï¼Œæˆ‘ä»¬å°±æ— æ³•åƒ C/C++é‚£æ ·å¯¹æ‰€ç®¡ç†çš„å†…å­˜è¿›è¡Œåˆç†åœ°å¤„ç†ï¼Œå› ä¸ºæ‰€æœ‰çš„å†…å­˜æ“ä½œéƒ½æ˜¯ç”± JVM åœ¨è¿›è¡Œï¼Œåªæœ‰äº†è§£äº† JVM çš„å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿåœ¨å‡ºç°å†…å­˜ç›¸å…³é—®é¢˜æ—¶æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚\nJNI #\rè°ƒç”¨æœ¬åœ°æ–¹æ³•ï¼Œè°ƒç”¨ C è¯­è¨€ï¼Œå…³é”®å­— native,é€šè¿‡é™æ€ä»£ç å—è°ƒç”¨ C/C++çš„å®ç°éƒ¨åˆ†\npublic static void main(String[] args) { System.out.println(sum(1,2)); } private static native int sum(int a, int b);//åŸç”Ÿçš„æ–¹æ³•ä¸å¯ä»¥å…·æœ‰å‡½æ•°å®ç° å†…å­˜åŒºåŸŸåˆ’åˆ†\nå†…å­˜åŒºåŸŸåˆ’åˆ†ä¸ºï¼šæ–¹æ³•åŒºï¼ˆçº¿ç¨‹å…±äº«ï¼‰ï¼Œå †ï¼ˆçº¿ç¨‹å…±äº«ï¼‰ï¼Œè™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œç¨‹åºè®¡æ•°å™¨\næ–¹æ³•åŒºå’Œå †æ ˆéš JVM ç”Ÿæ¶ˆï¼Œè™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œç¨‹åºè®¡æ•°å™¨ä¸å…±äº«å½¼æ­¤\nç¨‹åºè®¡æ•°å™¨ ï¼šä½œä¸ºå†…å­˜åœ°å€ï¼Œæ¯ä¸ªåœ°å€æŒ‡å‘ä¸‹ä¸€æ¡å³å°†æŒ‡ä»¤æ‰§è¡Œï¼Œè‡ªåŠ¨æ›´æ–°ï¼Œåœ¨ jvm å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶æ”¹å˜æ—¶æ”¹å˜å€¼ç¡®å®šæŒ‡ä»¤ä½ç½® public static void main(String[] args) { System.out.println(sum(1,2)); }\nprivate static native int sum(int a, int b);//åŸç”Ÿçš„æ–¹æ³•ä¸å¯ä»¥å…·æœ‰å‡½æ•°å®ç°\nè™šæ‹Ÿæœºæ ˆ ï¼ˆå…³é”®éƒ¨åˆ†ï¼‰ï¼Œå†…æ¬¡å½“ java è™šæ‹Ÿæœºåˆ›å»ºçš„æ—¶å€™å³å¯åŒæ­¥ä¸€ä¸ªæ ˆå¸§ï¼ˆæ ˆé‡Œé¢çš„å…ƒç´ ï¼‰ï¼Œæ ˆå¸§åŒ…å«äº†å½“å‰æ–¹æ³•çš„ä¸€äº›å…ƒç´ ä¿¡æ¯ï¼šï¼ˆå±€éƒ¨å˜é‡è¡¨ï¼Œæ“ä½œæ•°æ ˆï¼ŒåŠ¨æ€é“¾æ¥ï¼Œæ–¹æ³•å‡ºå£ï¼‰\nè™šæ‹Ÿæœºæ ˆï¼ˆçº¿ç¨‹ç§æœ‰ï¼‰ #\ræ¯ä¸ªæ ˆå¸§ä¿å­˜ä¸€ä¸ªå¯ä»¥æŒ‡å‘å½“å‰æ–¹æ³•æ‰€åœ¨ç±» çš„å¸¸é‡æ± ï¼Œç›®çš„æ˜¯ï¼šå½“å‰æ–¹æ³• 8 ä¸­å¦‚æœéœ€è¦è°ƒç”¨å…¶ä»–æ–¹æ³•çš„æ—¶å€™ï¼Œèƒ½å¤Ÿä»è¿è¡Œæ—¶å¸¸é‡æ± ä¸­æ‰¾åˆ°å¯¹åº”çš„ç¬¦å·å¼•ç”¨ï¼Œç„¶åå°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œ ç„¶åå°±èƒ½ç›´æ¥è°ƒç”¨å¯¹åº”æ–¹æ³•ï¼Œè¿™å°±æ˜¯åŠ¨æ€é“¾æ¥\nåœ¨è™šæ‹Ÿæœºæ ˆé‡Œé¢æ‰§è¡Œçš„è¡Œä¸ºå°±æ˜¯å¯¹æ–¹æ³•ä¸æ–­å‹æ ˆå‡ºæ ˆçš„è¿‡ç¨‹ï¼Œåªæœ‰å½“æ‰€æœ‰æ–¹æ³•å‡ºæ ˆä¹‹åæ‰å¯ä»¥æ‰§è¡Œä¸»å‡½æ•°æ ˆ\nå †ï¼ˆçº¿ç¨‹å…±äº«ï¼‰ #\rä½œä¸ºè™šæ‹Ÿæœºä¸­æœ€å¤§çš„ä¸€å—å†…å­˜ç©ºé—´ï¼ŒåŒºåŸŸèŒè´£æ˜¯ä½œä¸ºå­˜æ”¾å¯¹è±¡å’Œæ•°ç»„ï¼Œåƒåœ¾å›æ”¶å™¨ä¹Ÿä½œç”¨äºæ­¤\næ–¹æ³•åŒºï¼ˆçº¿ç¨‹å…±äº«ï¼‰ï¼ˆé‡ç‚¹ï¼‰ #\ræ‰€æœ‰ç¨‹åºå…±äº«åŒºåŸŸï¼Œå­˜å‚¨ç±»ä¿¡æ¯ï¼Œé™æ€å˜é‡ï¼ŒåŠ¨æ€ç¼–è¯‘ç¼“å­˜éƒ¨åˆ†ï¼Œåˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼šç±»ä¿¡æ¯è¡¨+è¿è¡Œæ—¶å¸¸é‡æ± \nç¼–è¯‘ç”Ÿæˆçš„å¸¸é‡ä¹Ÿå¯ä»¥åŠ å…¥å¸¸é‡æ± é‡Œé¢ã€‚\né¢è¯•é¢˜ï¼šString çš„å¸¸é‡æ± ï¼Œå¸¸é‡æ± ä¼˜åŒ–\n//String a=\u0026#34;I am a student\u0026#34;; // String b=\u0026#34;I am a student\u0026#34;; // String a=new String(\u0026#34;I am a student\u0026#34;); // String b=new String(\u0026#34;I am a student\u0026#34;); String a=new String(\u0026#34;I am \u0026#34;)+new String(\u0026#34;a student\u0026#34;); String b=new String(\u0026#34;I am \u0026#34;)+new String(\u0026#34;a student\u0026#34;); System.out.println(a.intern()==b.intern()); System.out.println(a.equals(b)); new æ–¹å¼ #\rpublic static void main(String[] args) { String str1 = new String(\u0026#34;abc\u0026#34;); String str2 = new String(\u0026#34;abc\u0026#34;); System.out.println(str1 == str2); System.out.println(str1.equals(str2)); } %ä½¿ç”¨==åˆ¤æ–­æ—¶ï¼Œæ¯”è¾ƒåœ°å€å¾—åˆ°çš„ç»“æœfalse %è€Œä½¿ç”¨equalsæ—¶å› ä¸ºæ¯”è¾ƒçš„æ˜¯å€¼ï¼Œæ‰€ä»¥å¾—åˆ°true ç›´æ¥æ–¹å¼ #\rpublic static void main(String[] args) { String str1 = \u0026#34;abc\u0026#34;; String str2 = \u0026#34;abc\u0026#34;; System.out.println(str1 == str2);//æ³¨æ„è¿™é‡Œä¸æ˜¯é€šè¿‡newçš„æ–¹å¼ï¼Œæ‰€ä»¥ä¸ºäº†æ€§èƒ½JVMä¼šé€šè¿‡å¸¸é‡æ± æŒ‡å‘è¿™ä¸€å— System.out.println(str1.equals(str2)); } %æ˜¯å› ä¸ºæˆ‘ä»¬ç›´æ¥ä½¿ç”¨åŒå¼•å·èµ‹å€¼ %ä¼šå…ˆåœ¨å¸¸é‡æ± ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™å°†å¼•ç”¨ç›´æ¥æŒ‡å‘è¯¥å­—ç¬¦ä¸²ï¼› %è‹¥ä¸å­˜åœ¨ï¼Œåˆ™åœ¨å¸¸é‡æ± ä¸­ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå†å°†å¼•ç”¨æŒ‡å‘è¯¥å­—ç¬¦ä¸²ï¼š intern æ–¹æ³•(native æ–¹æ³•ã€‚åº•å±‚å®ç°æ˜¯ C++) #\rpublic static void main(String[] args) { //ä¸èƒ½ç›´æ¥å†™\u0026#34;abc\u0026#34;ï¼ŒåŒå¼•å·çš„å½¢å¼ï¼Œå†™äº†å°±ç›´æ¥åœ¨å¸¸é‡æ± é‡Œé¢å§abcåˆ›å¥½äº† String str1 = new String(\u0026#34;ab\u0026#34;)+new String(\u0026#34;c\u0026#34;); String str2 = new String(\u0026#34;ab\u0026#34;)+new String(\u0026#34;c\u0026#34;); System.out.println(str1.intern() == str2.intern()); System.out.println(str1.equals(str2)); } ï¼ˆçº¿ç¨‹ç‹¬æœ‰ï¼‰ç¨‹åºè®¡æ•°å™¨ï¼šä¿å­˜å½“å‰ç¨‹åºçš„æ‰§è¡Œä½ç½®ã€‚ ï¼ˆçº¿ç¨‹ç‹¬æœ‰ï¼‰è™šæ‹Ÿæœºæ ˆï¼šé€šè¿‡æ ˆå¸§ï¼Œå¤šçº¿ç¨‹é‡Œé¢çš„ markword å°±ç»´æŠ¤åœ¨è¿™é‡Œï¼Œæ¥ç»´æŒæ–¹æ³•è°ƒç”¨é¡ºåºï¼Œå¸®åŠ©æ§åˆ¶ç¨‹åºæœ‰åºè¿è¡Œã€‚ ï¼ˆçº¿ç¨‹ç‹¬æœ‰ï¼‰æœ¬åœ°æ–¹æ³•æ ˆï¼šåŒä¸Šï¼Œä½œç”¨ä¸æœ¬åœ°æ–¹æ³•ã€‚ å †ï¼šæ‰€æœ‰çš„å¯¹è±¡å’Œæ•°ç»„éƒ½åœ¨è¿™é‡Œä¿å­˜ã€‚ æ–¹æ³•åŒºï¼šç±»ä¿¡æ¯ã€å³æ—¶ç¼–è¯‘å™¨çš„ä»£ç ç¼“å­˜ã€è¿è¡Œæ—¶å¸¸é‡æ± ã€‚ å†…å­˜çˆ†ç‚¸å’Œçˆ†æ ˆ #\rint[]arr=new int[Integer.MAX_VALUE]; ä¸‹é¢æ¥ä¸ªé‡ç£…çš„å“ˆå“ˆï¼Œç›´æ¥çˆ†æ ˆ 4 ä¸ª G\nstatic class Test{ } public static void main(String[] args) { List\u0026lt;Test\u0026gt; list = new ArrayList\u0026lt;\u0026gt;(); while (true){ list.add(new Test()); //æ— é™åˆ›å»ºTestå¯¹è±¡å¹¶ä¸¢è¿›Listä¸­ } } å¥½å®¶ä¼™ï¼Œæˆ‘è¿™é‡Œç›´æ¥ new äº†ä¸€äº¿ä¸ª Test å¯¹è±¡ è™šæ‹Ÿæœºæ ˆæ˜¯æœ‰é™åˆ¶çš„ï¼Œæ— çº¿é€’å½’å‹æ ˆå°†ä¼šå¯¼è‡´è™šæ‹Ÿæœºæ ˆçˆ†ç‚¸\nç”³è¯·å †å¤–å†…å­˜ #\rField unsafeField= Unsafe.class.getDeclaredFields()[0]; unsafeField.setAccessible(true); Unsafe unsafe= (Unsafe) unsafeField.get(null); long memory = unsafe.allocateMemory(4); unsafe.putInt(memory,123); System.out.println(unsafe.getAddress(memory)); è·å–ç±»ä¸­å®šä¹‰çš„å±æ€§ #\rClass.getField(properties name) //è·å–å½“å‰ç±»çš„å±æ€§ Class.getSuperClass().getDeclaredField(properties name) //è·å–å½“å‰ç±»çš„çˆ¶ç±»çš„ä¿¡æ¯ ","date":"12 October 2023","externalUrl":null,"permalink":"/entire-note/%E8%99%9A%E6%8B%9F%E6%9C%BA/jvm/","section":"Entire-Notes","summary":"æ¦‚è¿° #\rJVM æ˜¯æ¨¡æ‹Ÿç‰©ç†æœºå®ç°çš„å°† javac ç¼–è¯‘ä¸º.class æ–‡ä»¶ï¼Œjvm æ”¯æŒå¹³å°æ— å…³æ€§ã€‚ class æ–‡ä»¶é€šè¿‡ç±»åŠ è½½å™¨-ã€‹è§£é‡Šå™¨-ã€‹ç¡¬ä»¶æ²Ÿé€š\nJvm åŸºäº HotSpot è™šæ‹Ÿæœºæ¶æ„åŒæ—¶ä¹Ÿæ˜¯åŸºäºæ ˆå®ç°çš„ã€‚ä¸ C è¯­è¨€ä¸åŒï¼Œä¸åŒæ¶æ„çš„æ“ä½œç³»ç»Ÿç¼–è¯‘è¾“å‡ºçš„æ–‡ä»¶ä¸åŒï¼Œjvm ç¼–è¯‘åäº§ç”Ÿçš„ æ–‡ä»¶å®Œå…¨ç›¸åŒã€‚\nç”±äºæ‰§è¡Œä¸€æ®µç¨‹åºéœ€è¦ä¸æ–­åœ°ç¼–è¯‘å’Œåç¼–è¯‘ï¼Œå°†çƒ­ç‚¹æ‰§è¡Œçš„ä»£ä¹°æŸœå†…ä¸ºçƒ­ç‚¹ä»£ç å†è½¬æ¢ä¸ºæœºå™¨ç æé«˜æ‰§è¡Œæ•ˆç‡ã€‚åŒæ—¶ jdk1.2 ä¹‹åæ”¯æŒä½¿ç”¨ JNI æ¥ è°ƒç”¨ C/C++ä»£ç æå‡ä»£ç æ‰§è¡Œæ•ˆç‡\næŒ‡ä»¤ #\råŸºæœ¬æ•°æ®ç»“æ„ï¼šå †æ ˆ+é˜Ÿåˆ—\nå¸¸è§çš„ç¼–è¯‘å‘½ä»¤ï¼š","title":"Jvm","type":"entire-note"},{"content":"\råƒåœ¾å›æ”¶æœºåˆ¶ #\rå¼•ç”¨è®¡æ•°æ³• #\råˆ›å»ºå¼•ç”¨å˜é‡\nå¾ªç¯å¼•ç”¨,å½“å¯¹è±¡æˆä¸ºnullå°±æ²¡åŠæ³•äº†\nå¯è¾¾æ€§åˆ†æç®—æ³•ï¼š\næœ€ç»ˆåˆ¤å®šè¿‡ç¨‹ï¼Œæ­¤è¿‡ç¨‹å¯ä»¥æœ€åæŒ½ç•™å¯¹è±¡\né‡å†™finalizeæ–¹æ³•ï¼Œæœ€åå¯ä»¥æ•‘èµè¢«gcçš„å¯¹è±¡\næ¯”å¦‚ä¸‹é¢è¿™ä¸ªæƒ…å†µ\næ³¨æ„ï¼š\nåŒæ—¶ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½ç”Ÿæ•ˆä¸€æ¬¡ï¼Œèº²å¾—è¿‡åˆä¸€èº²ä¸è¿‡åäº”\nåˆ†ä»£æ”¶é›†æœºåˆ¶: #\ræ–¹æ³•åŒºä½¿ç”¨æ°¸ä¹…ä»£å®ç°\nåƒåœ¾æ”¶é›†ä¹Ÿåˆ†ä¸ºï¼š Minor GC - æ¬¡è¦åƒåœ¾å›æ”¶ï¼Œä¸»è¦è¿›è¡Œæ–°ç”Ÿä»£åŒºåŸŸçš„åƒåœ¾æ”¶é›†ã€‚\nè§¦å‘æ¡ä»¶ï¼šæ–°ç”Ÿä»£çš„EdenåŒºå®¹é‡å·²æ»¡æ—¶ã€‚\nMajor GC - ä¸»è¦åƒåœ¾å›æ”¶ï¼Œä¸»è¦è¿›è¡Œè€å¹´ä»£çš„åƒåœ¾æ”¶é›†ã€‚\nFull GC - å®Œå…¨åƒåœ¾å›æ”¶ï¼Œå¯¹æ•´ä¸ªJavaå †å†…å­˜å’Œæ–¹æ³•åŒºè¿›è¡Œåƒåœ¾å›æ”¶ã€‚\nè§¦å‘æ¡ä»¶1ï¼šæ¯æ¬¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¹³å‡å¤§å°å¤§äºè€å¹´ä»£å‰©ä½™ç©ºé—´\nè§¦å‘æ¡ä»¶2ï¼šMinor GCåå­˜æ´»çš„å¯¹è±¡è¶…è¿‡äº†è€å¹´ä»£å‰©ä½™ç©ºé—´\nè§¦å‘æ¡ä»¶3ï¼šæ°¸ä¹…ä»£å†…å­˜ä¸è¶³ï¼ˆJDK8ä¹‹å‰ï¼‰\nè§¦å‘æ¡ä»¶4ï¼šæ‰‹åŠ¨è°ƒç”¨System.gc()æ–¹æ³•\nåœ¨JDK8ä¹‹å‰ï¼Œä½¿ç”¨ æ°¸ä¹…ä»£ä¿å­˜ç±»å’Œå…ƒæ•°æ® ï¼ˆmetaï¼‰ä¿¡æ¯ï¼Œç±»åŠ è½½æ—¶äº§ç”ŸåŒæ—¶å…¨ç¨‹JVMä¸ä¼šä¸»åŠ¨è¿›è¡Œæ¸…é™¤ï¼Œæœ€ç»ˆå°†ä¼šå¯¼è‡´OOMå¼‚å¸¸ï¼›\nJava8 ä¸­ï¼Œæ°¸ä¹…ä»£å·²ç»è¢«ç§»é™¤ï¼Œè¢«ä¸€ä¸ªç§°ä¸ºâ€œå…ƒæ•°æ®åŒºâ€ï¼ˆå…ƒç©ºé—´ï¼‰çš„åŒºåŸŸæ‰€å–ä»£ã€‚å…ƒç©ºé—´ çš„æœ¬è´¨å’Œæ°¸ä¹…ä»£ç±»ä¼¼ï¼Œå…ƒç©ºé—´ä¸æ°¸ä¹…ä»£ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šå…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨ æœ¬åœ°å†…å­˜ã€‚å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç©ºé—´çš„å¤§å°ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶ã€‚ç±»çš„å…ƒæ•°æ®æ”¾å…¥ native memory, å­—ç¬¦ä¸²æ± å’Œç±»çš„é™æ€å˜é‡æ”¾å…¥ java å †ä¸­ï¼Œè¿™æ ·å¯ä»¥åŠ è½½å¤šå°‘ç±»çš„å…ƒæ•°æ®å°±ä¸å†ç”± MaxPermSize æ§åˆ¶, è€Œç”±ç³»ç»Ÿçš„å®é™…å¯ç”¨ç©ºé—´æ¥æ§åˆ¶\næ‰“å°GCæ—¥å¿—\nVMé€‰é¡¹: -XX:PrintGCDetails\nMinor GCæµç¨‹\næ ‡è®°å¤åˆ¶ç®—æ³•ï¼š #\ræ ‡è®°æ¸…é™¤ç®—æ³• åˆ©ç”¨GCç®—æ³•ï¼Œæ ‡è®°å›æ”¶å¯¹è±¡æ¸…é™¤ï¼Œä½†æ˜¯ä¼šé€ æˆå†…å­˜ç©ºéš™ï¼Œå†…å­˜åˆ©ç”¨ç‡ä½\næ ‡è®°å¤åˆ¶ç®—æ³•ï¼šè§£å†³å†…å­˜åˆ©ç”¨ç‡ä½çš„é—®é¢˜\næ ‡è®°æ•´ç†ç®—æ³•ï¼š\nåœ¨ä¸€æ¬¡GCä¹‹åä»ç„¶å­˜åœ¨å¤§é‡çš„è€å¹´ä»£,æ•ˆç‡è¾ƒä½ï¼Œå°†ä¼šå‡ºç°ç¨‹åºåœé¡¿\nåƒåœ¾æ”¶é›†å™¨å®ç°ï¼š #\rSerialæ”¶é›†å™¨ #\rå½“å‰åƒåœ¾æ”¶é›†å™¨å®ç° #\rå¹¶å‘åƒåœ¾æ”¶é›†å™¨CMS #\råƒåœ¾æ¸…ç†è¿‡ç¨‹ä¸­ä¸ä¼šæ‰“æ–­å…¶ä»–çº¿ç¨‹\n","date":"12 October 2023","externalUrl":null,"permalink":"/entire-note/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/","section":"Entire-Notes","summary":"åƒåœ¾å›æ”¶æœºåˆ¶ #\rå¼•ç”¨è®¡æ•°æ³• #\råˆ›å»ºå¼•ç”¨å˜é‡\nå¾ªç¯å¼•ç”¨,å½“å¯¹è±¡æˆä¸ºnullå°±æ²¡åŠæ³•äº†\nå¯è¾¾æ€§åˆ†æç®—æ³•ï¼š\næœ€ç»ˆåˆ¤å®šè¿‡ç¨‹ï¼Œæ­¤è¿‡ç¨‹å¯ä»¥æœ€åæŒ½ç•™å¯¹è±¡\né‡å†™finalizeæ–¹æ³•ï¼Œæœ€åå¯ä»¥æ•‘èµè¢«gcçš„å¯¹è±¡\næ¯”å¦‚ä¸‹é¢è¿™ä¸ªæƒ…å†µ\næ³¨æ„ï¼š\nåŒæ—¶ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½ç”Ÿæ•ˆä¸€æ¬¡ï¼Œèº²å¾—è¿‡åˆä¸€èº²ä¸è¿‡åäº”\nåˆ†ä»£æ”¶é›†æœºåˆ¶: #\ræ–¹æ³•åŒºä½¿ç”¨æ°¸ä¹…ä»£å®ç°\nåƒåœ¾æ”¶é›†ä¹Ÿåˆ†ä¸ºï¼š Minor GC - æ¬¡è¦åƒåœ¾å›æ”¶ï¼Œä¸»è¦è¿›è¡Œæ–°ç”Ÿä»£åŒºåŸŸçš„åƒåœ¾æ”¶é›†ã€‚\nè§¦å‘æ¡ä»¶ï¼šæ–°ç”Ÿä»£çš„EdenåŒºå®¹é‡å·²æ»¡æ—¶ã€‚\nMajor GC - ä¸»è¦åƒåœ¾å›æ”¶ï¼Œä¸»è¦è¿›è¡Œè€å¹´ä»£çš„åƒåœ¾æ”¶é›†ã€‚\nFull GC - å®Œå…¨åƒåœ¾å›æ”¶ï¼Œå¯¹æ•´ä¸ªJavaå †å†…å­˜å’Œæ–¹æ³•åŒºè¿›è¡Œåƒåœ¾å›æ”¶ã€‚","title":"åƒåœ¾å›æ”¶æœºåˆ¶","type":"entire-note"},{"content":"","date":"12 October 2023","externalUrl":null,"permalink":"/tags/%E7%A1%AC%E4%BB%B6%E8%AF%AD%E8%A8%80/","section":"Tags","summary":"","title":"ç¡¬ä»¶è¯­è¨€","type":"tags"},{"content":"\ræœ‰é™çŠ¶æ€æœº #\rå¯„å­˜å™¨å’Œç»„åˆæ—¶åºé€»è¾‘ç”µè·¯æ„æˆç¡¬ä»¶æ—¶åºé€»è¾‘ç”µè·¯\nç‰¹ç‚¹ï¼šåªèƒ½åœ¨æ—¶é’Ÿæ²¿å‘ç”Ÿè·³å˜æ—¶æ‰èƒ½å®ŒæˆçŠ¶æ€è½¬ç§»ï¼ŒçŠ¶æ€æœºå¯ä»¥åœ¨æ—¶é’Ÿè·³å˜æ—¶å®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚\nçŠ¶æ€æœºçš„ç»“æ„ #\rçŠ¶æ€å¯„å­˜å™¨ç”±ä¸€ç»„å¯„å­˜å™¨æ„æˆ,nä¸ªå¯„å­˜å™¨å¯å­˜å‚¨2^nä¸ªçŠ¶æ€\nè¾“å‡ºå–å†³äºçŠ¶æ€å’Œè¾“å…¥æ—¶ï¼Œè¿™æ ·çš„çŠ¶æ€æœºç§°ä¸ºMealyçŠ¶æ€æœºï¼Œåªå’Œå½“å‰çŠ¶æ€æœ‰å…³çš„ç§°ä¸ºMooreçŠ¶æ€æœº\næè¿°æœ‰é™çŠ¶æ€æœºçš„æ–¹æ³•ï¼š alwaysè¯­å¥å’Œcaseè¯­å¥\n","date":"12 October 2023","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/vhdl/","section":"ç¬”è®°s","summary":"æœ‰é™çŠ¶æ€æœº #\rå¯„å­˜å™¨å’Œç»„åˆæ—¶åºé€»è¾‘ç”µè·¯æ„æˆç¡¬ä»¶æ—¶åºé€»è¾‘ç”µè·¯\nç‰¹ç‚¹ï¼šåªèƒ½åœ¨æ—¶é’Ÿæ²¿å‘ç”Ÿè·³å˜æ—¶æ‰èƒ½å®ŒæˆçŠ¶æ€è½¬ç§»ï¼ŒçŠ¶æ€æœºå¯ä»¥åœ¨æ—¶é’Ÿè·³å˜æ—¶å®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚\nçŠ¶æ€æœºçš„ç»“æ„ #\rçŠ¶æ€å¯„å­˜å™¨ç”±ä¸€ç»„å¯„å­˜å™¨æ„æˆ,nä¸ªå¯„å­˜å™¨å¯å­˜å‚¨2^nä¸ªçŠ¶æ€\nè¾“å‡ºå–å†³äºçŠ¶æ€å’Œè¾“å…¥æ—¶ï¼Œè¿™æ ·çš„çŠ¶æ€æœºç§°ä¸ºMealyçŠ¶æ€æœºï¼Œåªå’Œå½“å‰çŠ¶æ€æœ‰å…³çš„ç§°ä¸ºMooreçŠ¶æ€æœº\næè¿°æœ‰é™çŠ¶æ€æœºçš„æ–¹æ³•ï¼š alwaysè¯­å¥å’Œcaseè¯­å¥","title":"çŠ¶æ€æœº","type":"ç¬”è®°"},{"content":"","date":"10 October 2023","externalUrl":null,"permalink":"/tags/%E8%A7%84%E5%88%92/","section":"Tags","summary":"","title":"è§„åˆ’","type":"tags"},{"content":"\rå¿…é¡»å®Œæˆï¼ #\r1:ä¸»çº¿å­¦ä¹ å†…å®¹ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¡ç®—æœºç½‘ç»œï¼ˆç†è®ºï¼‰ï¼Œåˆ†å¸ƒå¼å¾®æœåŠ¡ï¼Œå®‰å…¨æ¡†æ¶ï¼ˆSpring-Security)\n2:æ”¯çº¿å­¦ä¹ å†…å®¹ï¼ŒRBACæƒé™æ§åˆ¶ï¼Œé˜²XSSæ”»å‡»ï¼ŒJVMè™šæ‹Ÿæœºï¼Œ ElasticSearchæœç´¢å¼•æ“ï¼ˆELKï¼‰ã€‚Zookeeper,Dubboã€‚å®¹å™¨æŠ€æœ¯Dockerï¼ŒK8sã€‚\n3ï¼šæ·±å…¥äº†è§£ï¼ˆåº•å±‚ï¼‰ï¼šRedisåº•å±‚æ•°æ®ç»“æ„ä¸å®ç°ï¼ŒRedisé›†ç¾¤ï¼Œå“¨å…µæ¨¡å¼ï¼ŒRedisåè®®ï¼ŒMysqléš”ç¦»çº§åˆ«ï¼Œæ—¥å¿—ï¼Œé”ï¼Œäº‹åŠ¡\n2024.2.23æ—¥ï¼Œä¸Šè¿°70%å®Œæˆï¼Œæ¥ä¸‹æ¥åº”è¯¥å®Œæˆï¼š\r2024.3.20æ—¥ï¼Œéœ€è¦å­¦ä¹ 2ï¼Œ3,å­¦ä¹ ç®—æ³•ï¼Œä¿®æ”¹ç®€å†\r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rç´§è¦ä»»åŠ¡ ä»£ç éšæƒ³å½•-ç®—æ³•-è®¡ç®—æœºçŸ¥è¯†å¤ä¹ \r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rå­¦æœŸä»»åŠ¡ å¤§å‚\ræ¯•ä¸š\rå®Œæˆä»¥ä¸‹ä»»åŠ¡\rç®€å†æŠ•é€’\rç®—æ³•\rå­¦ä¹ åˆ†å¸ƒå¼äº‹åŠ¡Seata\rå­¦ä¹ Redisé›†ç¾¤+Mysqlç´¢å¼•\rå­¦ä¹ è®¡ç®—æœºç½‘ç»œä¸“ä¸šè¯¾\rå­¦ä¹ TCP/UDP\rå›¾é›† äºŒæ¬¡å…ƒèµ›é«˜\ræ­¤ç”Ÿæ— æ‚”äºŒæ¬¡å…ƒ\r2023.10.24è§„å®šä»»åŠ¡ï¼š\nå­¦ä¹ å†…å®¹ è®¡åˆ’æ—¥æœŸ æ˜¯å¦å®Œæˆ å»¶æœŸ Redisé»‘é©¬ç‚¹è¯„é¡¹ç›®å®Œç»“ è¿™å­¦æœŸ âœ”ï¸ âŒ æ¶ˆæ¯é˜Ÿåˆ— è¿™å­¦æœŸ âœ”ï¸ âŒ SpringSecurityå®‰å…¨æ¡†æ¶ è¿™å­¦æœŸ âœ”ï¸ âŒ Redisåº•å±‚ è¿™å­¦æœŸ âŒ âŒ JUC è¿™å­¦æœŸ âœ”ï¸ âŒ JVM è¿™å­¦æœŸ âœ”ï¸ âŒ GateWay è¿™å­¦æœŸ âœ”ï¸ âŒ Nacos è¿™å­¦æœŸ âœ”ï¸ âŒ å¾®æœåŠ¡ è¿™å­¦æœŸ âœ”ï¸ âŒ æ•°æ®ç»“æ„-å›¾ï¼Œå“ˆå¸Œ è¿™å­¦æœŸ âŒ âŒ ","date":"10 October 2023","externalUrl":null,"permalink":"/tasks/","section":"","summary":"å¿…é¡»å®Œæˆï¼ #\r1:ä¸»çº¿å­¦ä¹ å†…å®¹ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¡ç®—æœºç½‘ç»œï¼ˆç†è®ºï¼‰ï¼Œåˆ†å¸ƒå¼å¾®æœåŠ¡ï¼Œå®‰å…¨æ¡†æ¶ï¼ˆSpring-Security)\n2:æ”¯çº¿å­¦ä¹ å†…å®¹ï¼ŒRBACæƒé™æ§åˆ¶ï¼Œé˜²XSSæ”»å‡»ï¼ŒJVMè™šæ‹Ÿæœºï¼Œ ElasticSearchæœç´¢å¼•æ“ï¼ˆELKï¼‰ã€‚Zookeeper,Dubboã€‚å®¹å™¨æŠ€æœ¯Dockerï¼ŒK8sã€‚\n3ï¼šæ·±å…¥äº†è§£ï¼ˆåº•å±‚ï¼‰ï¼šRedisåº•å±‚æ•°æ®ç»“æ„ä¸å®ç°ï¼ŒRedisé›†ç¾¤ï¼Œå“¨å…µæ¨¡å¼ï¼ŒRedisåè®®ï¼ŒMysqléš”ç¦»çº§åˆ«ï¼Œæ—¥å¿—ï¼Œé”ï¼Œäº‹åŠ¡\n2024.2.23æ—¥ï¼Œä¸Šè¿°70%å®Œæˆï¼Œæ¥ä¸‹æ¥åº”è¯¥å®Œæˆï¼š\r2024.3.20æ—¥ï¼Œéœ€è¦å­¦ä¹ 2ï¼Œ3,å­¦ä¹ ç®—æ³•ï¼Œä¿®æ”¹ç®€å†\r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rç´§è¦ä»»åŠ¡ ä»£ç éšæƒ³å½•-ç®—æ³•-è®¡ç®—æœºçŸ¥è¯†å¤ä¹ \r\u003c?xml version=\"1.0\" standalone=\"no\"?\u003e\u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e\rå­¦æœŸä»»åŠ¡ å¤§å‚\ræ¯•ä¸š\rå®Œæˆä»¥ä¸‹ä»»åŠ¡\rç®€å†æŠ•é€’\rç®—æ³•\rå­¦ä¹ åˆ†å¸ƒå¼äº‹åŠ¡Seata\rå­¦ä¹ Redisé›†ç¾¤+Mysqlç´¢å¼•\rå­¦ä¹ è®¡ç®—æœºç½‘ç»œä¸“ä¸šè¯¾\rå­¦ä¹ TCP/UDP\rå›¾é›† äºŒæ¬¡å…ƒèµ›é«˜\ræ­¤ç”Ÿæ— æ‚”äºŒæ¬¡å…ƒ\r2023.","title":"å­¦ä¹ è®¡åˆ’","type":"page"},{"content":"","date":"9 October 2023","externalUrl":null,"permalink":"/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/","section":"Tags","summary":"","title":"å¹¶å‘ç¼–ç¨‹","type":"tags"},{"content":"\rçº¿ç¨‹æ±  #\rnew Threadç¼ºç‚¹ï¼šé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼Œæµªè´¹äº†çº¿ç¨‹èµ„æºï¼ŒçŸ­æ—¶é—´åˆ›å»ºå¤§é‡çº¿ç¨‹å’Œé”€æ¯ çº¿ç¨‹æ± æ˜¯æœ‰é™å¯é‡å¤ä½¿ç”¨çš„çº¿ç¨‹ï¼Œç”¨å®Œéœ€è¦å½’è¿˜\n//æ„é€ æ–¹æ³•ï¼Œå«æœ‰ä¸ƒä¸ªå‚æ•° public ThreadPoolExecutor(int corePoolSize,//æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° int maximumPoolSize,//æœ€å¤§çº¿ç¨‹æ± å¤§å° long keepAliveTime,//çº¿ç¨‹æœ€å¤§ç©ºé—²æ—¶é—´ TimeUnit unit,//æœ€å¤§ç©ºé—²æ—¶é—´å•ä½ BlockingQueue\u0026lt;Runnable\u0026gt; workQueue//çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ï¼Œå½“è¶…å‡ºæœ€å¤§å®¹é‡æ—¶ï¼Œä»»åŠ¡è¿›å…¥ç­‰å¾…é˜Ÿåˆ—) { this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(),//çº¿ç¨‹åˆ›å»ºå·¥å‚ï¼Œå¯è‡ªå®šä¹‰ defaultHandler//æ‹’ç»ç­–ç•¥ï¼Œå®åœ¨ä¸èƒ½åŠ å…¥æ–°çš„ä»»åŠ¡æ—¶ï¼Œæ‹’ç»ä»»åŠ¡); } æ ¹æ®CPUç±»å‹åˆ†é…çº¿ç¨‹æ± å¤§å° #\rThreadPoolExecutor #\rpublic static void main(String[] args) throws InterruptedException { ThreadPoolExecutor executor = new ThreadPoolExecutor(2, 4, //2ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸º4ä¸ª 3, TimeUnit.SECONDS, //æœ€å¤§ç©ºé—²æ—¶é—´ä¸º3ç§’é’Ÿ new ArrayBlockingQueue\u0026lt;\u0026gt;(2)); //è¿™é‡Œä½¿ç”¨å®¹é‡ä¸º2çš„ArrayBlockingQueueé˜Ÿåˆ— for (int i = 0; i \u0026lt; 6; i++) { //å¼€å§‹6ä¸ªä»»åŠ¡ int finalI = i; executor.execute(() -\u0026gt; { try { System.out.println(Thread.currentThread().getName()+\u0026#34; å¼€å§‹æ‰§è¡Œï¼ï¼ˆ\u0026#34;+ finalI); TimeUnit.SECONDS.sleep(1); System.out.println(Thread.currentThread().getName()+\u0026#34; å·²ç»“æŸï¼ï¼ˆ\u0026#34;+finalI); } catch (InterruptedException e) { e.printStackTrace(); } }); } TimeUnit.SECONDS.sleep(1); //çœ‹çœ‹å½“å‰çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡ System.out.println(\u0026#34;çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡ï¼š\u0026#34;+executor.getPoolSize()); TimeUnit.SECONDS.sleep(5); //ç­‰åˆ°è¶…è¿‡ç©ºé—²æ—¶é—´ System.out.println(\u0026#34;çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡ï¼š\u0026#34;+executor.getPoolSize()); executor.shutdownNow(); //ä½¿ç”¨å®Œçº¿ç¨‹æ± è®°å¾—å…³é—­ï¼Œä¸ç„¶ç¨‹åºä¸ä¼šç»“æŸï¼Œå®ƒä¼šå–æ¶ˆæ‰€æœ‰ç­‰å¾…ä¸­çš„ä»»åŠ¡ä»¥åŠè¯•å›¾ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå…³é—­åï¼Œæ— æ³•å†æäº¤ä»»åŠ¡ï¼Œä¸€å¾‹æ‹’ç» //executor.shutdown(); åŒæ ·å¯ä»¥å…³é—­ï¼Œä½†æ˜¯ä¼šæ‰§è¡Œå®Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡å†å…³é—­ } } ArrayBlockingQueue #\rä½œä¸ºæœ‰ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼Œå…·æœ‰å“åº”çš„å®¹é‡ï¼Œå¯ä»¥è‡ªè¡Œè®¾ç½®ï¼Œå¯¹æ¯”SynchronousQueueæ²¡æœ‰å®¹é‡ï¼Œé€‰è¿™ä¸ªä¼šå‡ºç°çˆ†æ ˆçš„é—®é¢˜ï¼ŒåŸå›  æ˜¯çº¿ç¨‹æ± ThreadPoolExecutorå‘ç°å®¹é‡è¶…å‡ºæ—¶ä¼špollçº¿ç¨‹ï¼Œä½†SynchronousQueueæ²¡æœ‰å®¹é‡pollæ— æ„ä¹‰ã€‚ åœ¨çº¿ç¨‹æ± é‡Œé¢çš„ç­‰å¾…é˜Ÿåˆ—éœ€è¦å…·æœ‰å®¹é‡ã€‚\nçº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥ #\rçº¿ç¨‹æ± è¶…è¿‡æœ€å¤§çš„å®¹é‡æ—¶ï¼Œéœ€è¦æ‹’ç»è¿™ä¸ªä»»åŠ¡ã€‚\nAbortPolicy(default): ç›´æ¥æŠ›å¼‚å¸¸ CallerRunsPolicy: ç›´æ¥è®©æäº¤ä»»åŠ¡çš„çº¿ç¨‹è¿è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œå¦‚æœå‘ä¸»çº¿ç¨‹æäº¤äº†ä»»åŠ¡å°±è®©ä¸»çº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œè°æäº¤è°æ‰§è¡Œ DiscardOldestPolicy: ä¸¢å¼ƒé˜Ÿåˆ—ä¸­æœ€è¿‘çš„ä»»åŠ¡ï¼Œæ›¿æ¢ä¸ºå½“å‰ä»»åŠ¡ DiscardPolicy: Do nothing è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥å’Œçº¿ç¨‹ç”Ÿäº§å·¥å‚ ä»»åŠ¡è¿‡ç¨‹å‡ºç°å¼‚å¸¸ï¼Œçº¿ç¨‹æ± å½“ä¸­æ‰§è¡Œä»»åŠ¡æ—¶å‘ç”Ÿå¼‚å¸¸ï¼Œçº¿ç¨‹å°†ä¼šè‡ªåŠ¨é”€æ¯\nExecutorService #\rå¯ä»¥ä½¿ç”¨Executorså·¥å…·ç±»æ¥å¿«é€Ÿåˆ›å»ºçº¿ç¨‹æ± ï¼š\nExecutorService executor = Executors.newFixedThreadPool(2); //ç›´æ¥åˆ›å»ºä¸€ä¸ªå›ºå®šå®¹é‡çš„çº¿ç¨‹æ±  ExecutorServiceæœ¬è´¨å†…éƒ¨å®ç°å…¶å®æ˜¯ThreadPoolExecutorï¼Œæ‰€ä»¥åˆ›å»ºçš„çº¿ç¨‹éƒ½ä¸æ˜¯æ ¸å¿ƒçº¿ç¨‹\n//å†…éƒ¨å®ç° public static ExecutorService newFixedThreadPool(int nThreads) { return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue\u0026lt;Runnable\u0026gt;()); } ç›´æ¥å°†æœ€å¤§çº¿ç¨‹å’Œæ ¸å¿ƒçº¿ç¨‹æ•°é‡è®¾å®šä¸ºä¸€æ ·çš„ï¼Œå¹¶ä¸”ç­‰å¾…æ—¶é—´ä¸º0ï¼Œå› ä¸ºå‹æ ¹ä¸éœ€è¦ï¼Œå¹¶ä¸”é‡‡ç”¨çš„æ˜¯ä¸€ä¸ªæ— ç•Œçš„LinkedBlockingQueueä½œä¸ºç­‰å¾…é˜Ÿåˆ—ã€‚\n//åˆ›å»ºå•ä¸ªçº¿ç¨‹ public static ExecutorService newSingleThreadExecutor() { return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue\u0026lt;Runnable\u0026gt;())); } è¿™é‡Œå¹¶ä¸æ˜¯ç›´æ¥åˆ›å»ºçš„ä¸€ä¸ªThreadPoolExecutorå¯¹è±¡ï¼Œè€Œæ˜¯å¥—äº†ä¸€å±‚FinalizableDelegatedExecutorServiceï¼Œç›®çš„æ˜¯å†…éƒ¨å¥—äº†ä¸€å±‚ï¼Œå¤–éƒ¨ä¸å¯è§ï¼Œä¸å¯ä¿®æ”¹ï¼Œä¿è¯å®‰å…¨æ€§\nç”±äºexecutorServiceå†…éƒ¨ç›´æ¥æœ€å¤§å®¹é‡ä¸ºInteger.\tMAX_VALUE,éå¸¸å¤§ï¼Œä¸å®‰å…¨\nnewCachedThreadPool #\ræ³¨æ„ç”Ÿæˆçš„çº¿ç¨‹æ± é‡Œé¢éƒ½ä¸æ˜¯æ ¸å¿ƒçº¿ç¨‹ï¼ŒåŒæ—¶æœ€å¤§å®¹é‡éå¸¸å¤§ï¼Œéœ€è¦æ…ç”¨\næ‰§è¡Œå¸¦è¿”å›å€¼çš„ä»»åŠ¡ï¼š #\rExecutorServiceæ‰§è¡Œä»»åŠ¡æœ‰ä¸¤ç§æ–¹æ³•ï¼šsubmitå’Œexecute\næ¥å—è¿”å›å€¼çš„åªæœ‰submit\npublic static void main(String[] args) throws InterruptedException, ExecutionException { ExecutorService executorService=Executors.newSingleThreadExecutor(); Future\u0026lt;String\u0026gt; future= executorService.submit(()-\u0026gt;{ TimeUnit.SECONDS.sleep(3); return \u0026#34;ä½ å¥½ä¸–ç•Œ\u0026#34;; }); System.out.println(future.cancel(true));//å–æ¶ˆä»»åŠ¡ï¼Œè¿™æ—¶å€™é‡Œé¢çš„å­—ä¸²å°†ä¸ä¼šå†è¿”å›å‡ºæ¥ executorService.shutdown(); System.out.println(future.get()); } å®šæ—¶ä»»åŠ¡ScheduledThreadPoolExecutor #\rScheduledThreadPoolExecutor executor=new ScheduledThreadPoolExecutor(1); // executor.schedule(()-\u0026gt; System.out.println(\u0026#34;å¼€å§‹å®šæ—¶ä»»åŠ¡\u0026#34;),3,TimeUnit.SECONDS); // ScheduledFuture\u0026lt;String\u0026gt; scheduledFuture=executor.schedule(()-\u0026gt; \u0026#34;å¼€å§‹å®šæ—¶ä»»åŠ¡\u0026#34;,3,TimeUnit.SECONDS); // System.out.println(scheduledFuture.isDone()); //å›ºå®šé¢‘ç‡è¿›è¡Œå®šæ—¶è®¡åˆ’ï¼š executor.scheduleAtFixedRate(()-\u0026gt; System.out.println(\u0026#34;hello!\u0026#34;),3,1,TimeUnit.SECONDS); // executor.shutdown(); çº¿ç¨‹å»¶è¿Ÿçº¿ç¨‹æ± ï¼šScheduledWithFixedDelay protected void finalize() { //åœ¨GCæ—¶ï¼Œä¼šæ‰§è¡Œfinalizeæ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¸­ä¼šå…³é—­æ‰çº¿ç¨‹æ± ï¼Œé‡Šæ”¾èµ„æº super.shutdown(); } çº¿ç¨‹æ± å®ç°åŸç† #\r//è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬æŒ‡å®šçš„é˜»å¡é˜Ÿåˆ— private final BlockingQueue\u0026lt;Runnable\u0026gt; workQueue; //å†æ¬¡æé†’ï¼Œè¿™é‡Œæ²¡åŠ é”ï¼ï¼è¯¥æœ‰ä»€ä¹ˆæ„è¯†ä¸ç”¨æˆ‘è¯´äº†å§ï¼Œæ‰€ä»¥è¯´ctlæ‰ä¼šä½¿ç”¨åŸå­ç±»ã€‚ public void execute(Runnable command) { if (command == null) throw new NullPointerException(); //å¦‚æœä»»åŠ¡ä¸ºnullï¼Œé‚£æ‰§è¡Œä¸ªå¯‚å¯ï¼Œæ‰€ä»¥è¯´ç›´æ¥ç©ºæŒ‡é’ˆ int c = ctl.get(); //è·å–ctlçš„å€¼ï¼Œä¸€ä¼šè¦è¯»å–ä¿¡æ¯çš„ if (workerCountOf(c) \u0026lt; corePoolSize) { //åˆ¤æ–­å·¥ä½œçº¿ç¨‹æ•°é‡æ˜¯å¦å°äºæ ¸å¿ƒçº¿ç¨‹æ•° if (addWorker(command, true)) //å¦‚æœæ˜¯ï¼Œé‚£ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œç›´æ¥åŠ æ–°çš„çº¿ç¨‹æ‰§è¡Œï¼Œç„¶åè¿”å›å³å¯ return; c = ctl.get(); //å¦‚æœçº¿ç¨‹æ·»åŠ å¤±è´¥ï¼ˆæœ‰å¯èƒ½å…¶ä»–çº¿ç¨‹ä¹Ÿåœ¨å¯¹çº¿ç¨‹æ± è¿›è¡Œæ“ä½œï¼‰ï¼Œé‚£å°±æ›´æ–°ä¸€ä¸‹cçš„å€¼ } if (isRunning(c) \u0026amp;\u0026amp; workQueue.offer(command)) { //ç»§ç»­åˆ¤æ–­ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ± æ˜¯è¿è¡ŒçŠ¶æ€ï¼Œé‚£å°±å°è¯•å‘é˜»å¡é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„ç­‰å¾…ä»»åŠ¡ int recheck = ctl.get(); //å†æ¬¡è·å–ctlçš„å€¼ if (! isRunning(recheck) \u0026amp;\u0026amp; remove(command)) //è¿™é‡Œæ˜¯å†æ¬¡ç¡®è®¤å½“å‰çº¿ç¨‹æ± æ˜¯å¦å…³é—­ï¼Œå¦‚æœæ·»åŠ ç­‰å¾…ä»»åŠ¡åçº¿ç¨‹æ± å…³é—­äº†ï¼Œé‚£å°±æŠŠåˆšåˆšåŠ è¿›å»ä»»åŠ¡çš„åˆæ‹¿å‡ºæ¥ reject(command); //ç„¶åç›´æ¥æ‹’ç»å½“å‰ä»»åŠ¡çš„æäº¤ï¼ˆä¼šæ ¹æ®æˆ‘ä»¬çš„æ‹’ç»ç­–ç•¥å†³å®šå¦‚ä½•è¿›è¡Œæ‹’ç»æ“ä½œï¼‰ else if (workerCountOf(recheck) == 0) //å¦‚æœè¿™ä¸ªæ—¶å€™çº¿ç¨‹æ± ä¾ç„¶åœ¨è¿è¡ŒçŠ¶æ€ï¼Œé‚£ä¹ˆå°±æ£€æŸ¥ä¸€ä¸‹å½“å‰å·¥ä½œçº¿ç¨‹æ•°æ˜¯å¦ä¸º0ï¼Œå¦‚æœæ˜¯é‚£å°±ç›´æ¥æ·»åŠ æ–°çº¿ç¨‹æ‰§è¡Œ addWorker(null, false); //æ·»åŠ ä¸€ä¸ªæ–°çš„éæ ¸å¿ƒçº¿ç¨‹ï¼Œä½†æ˜¯æ³¨æ„æ²¡æ·»åŠ ä»»åŠ¡ //å…¶ä»–æƒ…å†µå°±å•¥ä¹Ÿä¸ç”¨åšäº† } else if (!addWorker(command, false)) //è¿™ç§æƒ…å†µè¦ä¹ˆå°±æ˜¯çº¿ç¨‹æ± æ²¡æœ‰è¿è¡Œï¼Œè¦ä¹ˆå°±æ˜¯é˜Ÿåˆ—æ»¡äº†ï¼ŒæŒ‰ç…§æˆ‘ä»¬ä¹‹å‰çš„è§„åˆ™ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°å·²æ»¡ä¸”é˜Ÿåˆ—å·²æ»¡ï¼Œé‚£ä¹ˆä¼šç›´æ¥æ·»åŠ æ–°çš„éæ ¸å¿ƒçº¿ç¨‹ï¼Œä½†æ˜¯å¦‚æœå·²ç»æ·»åŠ åˆ°æœ€å¤§æ•°é‡ï¼Œè¿™é‡Œè‚¯å®šæ˜¯ä¼šå¤±è´¥çš„ reject(command); //ç¡®å®è£…ä¸ä¸‹äº†ï¼Œåªèƒ½æ‹’ç» } addWorkerå®ç° #\rprivate boolean addWorker(Runnable firstTask, boolean core) { //è¿™é‡Œç»™æœ€å¤–å±‚å¾ªç¯æ‰“äº†ä¸ªæ ‡ç­¾ï¼Œæ–¹ä¾¿ä¸€ä¼šçš„è·³è½¬æ“ä½œ retry: for (;;) { //æ— é™å¾ªç¯ï¼Œè€å¥—è·¯äº†ï¼Œæ³¨æ„è¿™é‡Œå…¨ç¨‹æ²¡åŠ é” int c = ctl.get(); //è·å–ctlå€¼ int rs = runStateOf(c); //è§£æå½“å‰çš„è¿è¡ŒçŠ¶æ€ // Check if queue empty only if necessary. if (rs \u0026gt;= SHUTDOWN \u0026amp;\u0026amp; //åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦ä¸æ˜¯å¤„äºè¿è¡ŒçŠ¶æ€ ! (rs == SHUTDOWN \u0026amp;\u0026amp; //å¦‚æœä¸æ˜¯è¿è¡ŒçŠ¶æ€ï¼Œåˆ¤æ–­çº¿ç¨‹æ˜¯SHUTDOWNçŠ¶æ€å¹¶ã€ä»»åŠ¡ä¸ä¸ºnullã€ç­‰å¾…é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œåªè¦æœ‰å…¶ä¸­ä¸€è€…ä¸æ»¡è¶³ï¼Œç›´æ¥è¿”å›falseï¼Œæ·»åŠ å¤±è´¥ firstTask == null \u0026amp;\u0026amp; ! workQueue.isEmpty())) return false; for (;;) { //å†…å±‚åˆä¸€è½®æ— é™å¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯æ˜¯ä¸ºäº†å°†çº¿ç¨‹è®¡æ•°å¢åŠ ï¼Œç„¶åæ‰å¯ä»¥çœŸæ­£åœ°æ·»åŠ ä¸€ä¸ªæ–°çš„çº¿ç¨‹ int wc = workerCountOf(c); //è§£æå½“å‰çš„å·¥ä½œçº¿ç¨‹æ•°é‡ if (wc \u0026gt;= CAPACITY || wc \u0026gt;= (core ? corePoolSize : maximumPoolSize)) //åˆ¤æ–­ä¸€ä¸‹è¿˜è£…å¾—ä¸‹ä¸ï¼Œå¦‚æœè£…å¾—ä¸‹ï¼Œçœ‹çœ‹æ˜¯æ ¸å¿ƒçº¿ç¨‹è¿˜æ˜¯éæ ¸å¿ƒçº¿ç¨‹ï¼Œå¦‚æœæ˜¯æ ¸å¿ƒçº¿ç¨‹ï¼Œä¸èƒ½å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°çš„é™åˆ¶ï¼Œå¦‚æœæ˜¯éæ ¸å¿ƒçº¿ç¨‹ï¼Œä¸èƒ½å¤§äºæœ€å¤§çº¿ç¨‹æ•°é™åˆ¶ return false; if (compareAndIncrementWorkerCount(c)) //CASè‡ªå¢çº¿ç¨‹è®¡æ•°ï¼Œå¦‚æœå¢åŠ æˆåŠŸï¼Œä»»åŠ¡å®Œæˆï¼Œç›´æ¥è·³å‡ºç»§ç»­ break retry; //æ³¨æ„è¿™é‡Œè¦ç›´æ¥è·³å‡ºæœ€å¤–å±‚å¾ªç¯ï¼Œæ‰€ä»¥ç”¨åˆ°äº†æ ‡ç­¾ï¼ˆç±»ä¼¼äºgotoè¯­å¥ï¼‰ c = ctl.get(); // å¦‚æœCASå¤±è´¥ï¼Œæ›´æ–°ä¸€ä¸‹cçš„å€¼ if (runStateOf(c) != rs) //å¦‚æœCASå¤±è´¥çš„åŸå› æ˜¯å› ä¸ºçº¿ç¨‹æ± çŠ¶æ€å’Œä¸€å¼€å§‹çš„ä¸ä¸€æ ·äº†ï¼Œé‚£ä¹ˆå°±é‡æ–°ä»å¤–å±‚å¾ªç¯å†æ¥ä¸€æ¬¡ continue retry; //æ³¨æ„è¿™é‡Œè¦ç›´æ¥ä»æœ€å¤–å±‚å¾ªç¯ç»§ç»­ï¼Œæ‰€ä»¥ç”¨åˆ°äº†æ ‡ç­¾ï¼ˆç±»ä¼¼äºgotoè¯­å¥ï¼‰ // å¦‚æœæ˜¯å…¶ä»–åŸå› å¯¼è‡´çš„CASå¤±è´¥ï¼Œé‚£åªå¯èƒ½æ˜¯å…¶ä»–çº¿ç¨‹åŒæ—¶åœ¨è‡ªå¢ï¼Œæ‰€ä»¥é‡æ–°å†æ¥ä¸€æ¬¡å†…å±‚å¾ªç¯ } } //å¥½äº†ï¼Œçº¿ç¨‹è®¡æ•°è‡ªå¢ä¹Ÿå®Œäº†ï¼Œæ¥ç€å°±æ˜¯æ·»åŠ æ–°çš„å·¥ä½œçº¿ç¨‹äº† boolean workerStarted = false; //å·¥ä½œçº¿ç¨‹æ˜¯å¦å·²å¯åŠ¨ boolean workerAdded = false; //å·¥ä½œçº¿ç¨‹æ˜¯å¦å·²æ·»åŠ  Worker w = null; //æš‚æ—¶ç†è§£ä¸ºå·¥ä½œçº¿ç¨‹ï¼Œåˆ«æ€¥ï¼Œæˆ‘ä»¬ä¹‹åä¼šè§£è¯»Workerç±» try { w = new Worker(firstTask); //åˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹ï¼Œä¼ å…¥æˆ‘ä»¬æäº¤çš„ä»»åŠ¡ final Thread t = w.thread; //æ‹¿åˆ°å·¥ä½œçº¿ç¨‹ä¸­å°è£…çš„Threadå¯¹è±¡ if (t != null) { //å¦‚æœçº¿ç¨‹ä¸ä¸ºnullï¼Œé‚£å°±å¯ä»¥å®‰æ’å¹²æ´»äº† final ReentrantLock mainLock = this.mainLock; //åˆæ˜¯ReentrantLockåŠ é”ç¯èŠ‚ï¼Œè¿™é‡Œå¼€å§‹å°±æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è¿›å…¥äº† mainLock.lock(); try { // Recheck while holding lock. // Back out on ThreadFactory failure or if // shut down before lock acquired. int rs = runStateOf(ctl.get()); //è·å–å½“å‰çº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€ if (rs \u0026lt; SHUTDOWN || (rs == SHUTDOWN \u0026amp;\u0026amp; firstTask == null)) { //åªæœ‰å½“å‰çº¿ç¨‹æ± æ˜¯æ­£åœ¨è¿è¡ŒçŠ¶æ€ï¼Œæˆ–æ˜¯SHUTDOWNçŠ¶æ€ä¸”firstTaskä¸ºç©ºï¼Œé‚£ä¹ˆå°±ç»§ç»­ if (t.isAlive()) // æ£€æŸ¥ä¸€ä¸‹çº¿ç¨‹æ˜¯å¦æ­£åœ¨è¿è¡ŒçŠ¶æ€ throw new IllegalThreadStateException(); //å¦‚æœæ˜¯é‚£è‚¯å®šæ˜¯ä¸èƒ½è¿è¡Œæˆ‘ä»¬çš„ä»»åŠ¡çš„ workers.add(w); //ç›´æ¥å°†æ–°åˆ›å»ºçš„Workä¸¢è¿› workers é›†åˆä¸­ int s = workers.size(); //çœ‹çœ‹å½“å‰workersçš„å¤§å° if (s \u0026gt; largestPoolSize) //è¿™é‡Œæ˜¯è®°å½•çº¿ç¨‹æ± è¿è¡Œä»¥æ¥ï¼Œå†å²ä¸Šçš„æœ€å¤šçº¿ç¨‹æ•° largestPoolSize = s; workerAdded = true; //å·¥ä½œçº¿ç¨‹å·²æ·»åŠ  } } finally { mainLock.unlock(); //è§£é” } if (workerAdded) { t.start(); //å¯åŠ¨çº¿ç¨‹ workerStarted = true; //å·¥ä½œçº¿ç¨‹å·²å¯åŠ¨ } } } finally { if (! workerStarted) //å¦‚æœçº¿ç¨‹åœ¨ä¸Šé¢çš„å¯åŠ¨è¿‡ç¨‹ä¸­å¤±è´¥äº† addWorkerFailed(w); //å°†wç§»å‡ºworkerså¹¶å°†è®¡æ•°å™¨-1ï¼Œæœ€åå¦‚æœçº¿ç¨‹æ± æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œä¼šå°è¯•åŠ é€Ÿç»ˆæ­¢çº¿ç¨‹æ±  } return workerStarted; //è¿”å›æ˜¯å¦æˆåŠŸ } å¹¶å‘å·¥å…·ç±» #\rè®¡æ•°å™¨é”ï¼ˆCountDownLatchï¼‰ #\rå¤šä»»åŠ¡åŒæ­¥ç¥å™¨ã€‚å®ƒå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆå·¥ä½œ,å…¸å‹åº”ç”¨åœºæ™¯ï¼šå¤šä¸ªçº¿ç¨‹åˆ†æ®µç›¸åŠ æœ€åç»Ÿè®¡æ‰€æœ‰çº¿ç¨‹çš„å’Œ\nè¦å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªå¾ˆéº»çƒ¦çš„åœ°æ–¹ï¼Œæˆ‘ä»¬ä¸çŸ¥é“ä»»åŠ¡åˆ°åº•ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå®Œæ¯•ï¼Œé‚£ä¹ˆå¯å¦å°†æœ€ç»ˆç»Ÿè®¡å»¶è¿Ÿä¸€å®šæ—¶é—´è¿›è¡Œå‘¢ï¼Ÿä½†æ˜¯æœ€ç»ˆç»Ÿè®¡æ— è®ºå»¶è¿Ÿå¤šä¹…è¿›è¡Œï¼Œ è¦ä¹ˆä¸èƒ½ä¿è¯æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆï¼Œè¦ä¹ˆå¯èƒ½æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆäº†è€Œè¿™é‡Œè¿˜åœ¨ç­‰ã€‚\npublic static void main(String[] args) throws InterruptedException { CountDownLatch latch=new CountDownLatch(20); for (int i = 0; i \u0026lt; 20; i++) { int finalI=i; new Thread(()-\u0026gt;{ try { Thread.sleep((long) (2000 * new Random().nextDouble())); System.out.println(\u0026#34;ä»»åŠ¡\u0026#34;+finalI+\u0026#34;å®Œæˆ\u0026#34;); }catch (InterruptedException e){ e.printStackTrace(); } latch.countDown(); //æ¯æ‰§è¡Œä¸€æ¬¡è®¡æ•°å™¨éƒ½ä¼š-1 }).start(); } //å¼€å§‹ç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹å®Œæˆï¼Œå½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œæ¢å¤è¿è¡Œ latch.await(); //è¿™ä¸ªæ“ä½œå¯ä»¥åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œä¸€èµ·ç­‰å¾…ï¼Œè¿™é‡Œåªæ¼”ç¤ºäº†ä¸€ä¸ª System.out.println(\u0026#34;æ‰€æœ‰å­ä»»åŠ¡éƒ½å®Œæˆï¼ä»»åŠ¡å®Œæˆï¼ï¼ï¼\u0026#34;); } ä¾‹å­ï¼š ç”¨å››ä¸ªçº¿ç¨‹å®ç°å¯¹1åˆ°10000å®Œæˆç´¯è®¡åŠ å’Œ\npublic static void main(String[] args) throws InterruptedException { long begin=System.currentTimeMillis(); CountDownLatch latch=new CountDownLatch(4); int res[]=new int[4]; for (int i = 0; i \u0026lt; 4; i++) { int finalI=i; new Thread(()-\u0026gt;{ int sum=0; int numbersPerThread = (int) Math.ceil((double) 100/ 4); int startNumber = finalI * numbersPerThread + 1; int endNumber = (finalI + 1) * numbersPerThread; for (int j =startNumber ; j \u0026lt;=endNumber; j++) { sum+=j; } System.out.println(sum); res[finalI]=sum; latch.countDown(); //æ¯æ‰§è¡Œä¸€æ¬¡è®¡æ•°å™¨éƒ½ä¼š-1 }).start(); } //å¼€å§‹ç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹å®Œæˆï¼Œå½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œæ¢å¤è¿è¡Œ latch.await(); //è¿™ä¸ªæ“ä½œå¯ä»¥åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œä¸€èµ·ç­‰å¾…ï¼Œè¿™é‡Œåªæ¼”ç¤ºäº†ä¸€ä¸ª int result=0; for (Integer integer:res) { result+=integer; } long end=System.currentTimeMillis(); System.out.println(\u0026#34;æ‰€æœ‰å­ä»»åŠ¡éƒ½å®Œæˆï¼ä»»åŠ¡å®Œæˆ,ç»“æœæ˜¯\u0026#34;+result+\u0026#34;èŠ±è´¹æ—¶é—´ï¼š\u0026#34;+(end-begin)+\u0026#34;ms\u0026#34;); } å®ç°æ•ˆæœï¼š å…±äº«é”æ˜¯çº¿ç¨‹å…±äº«çš„ï¼ŒåŒä¸€æ—¶åˆ»èƒ½æœ‰å¤šä¸ªçº¿ç¨‹æ‹¥æœ‰å…±äº«é”ã€‚ å¦‚æœä¸€ä¸ªçº¿ç¨‹åˆšè·å–äº†å…±äº«é”ï¼Œé‚£ä¹ˆåœ¨å…¶ä¹‹åç­‰å¾…çš„çº¿ç¨‹ä¹Ÿå¾ˆæœ‰å¯èƒ½èƒ½å¤Ÿè·å–åˆ°é”ï¼Œæ‰€ä»¥å¾—ä¼ æ’­ä¸‹å»ç»§ç»­å°è¯•å”¤é†’åé¢çš„ç»“ç‚¹ï¼Œä¸åƒç‹¬å é”ï¼Œç‹¬å çš„å‹æ ¹ä¸éœ€è¦è€ƒè™‘è¿™äº›ã€‚ å¦‚æœä¸€ä¸ªçº¿ç¨‹åˆšé‡Šæ”¾äº†é”ï¼Œä¸ç®¡æ˜¯ç‹¬å é”è¿˜æ˜¯å…±äº«é”ï¼Œéƒ½éœ€è¦å”¤é†’åç»­ç­‰å¾…ç»“ç‚¹çš„çº¿ç¨‹ã€‚ å®ç°åŸç†ï¼š\nåœ¨å·¥å…·æ„å»ºçš„æ—¶å€™åˆ›å»ºå¤šä¸ªå…±äº«é”ï¼Œè°ƒç”¨countDownï¼ˆï¼‰è°ƒç”¨æ—¶å°±å¯ä»¥å‡å»ä¸€æŠŠé”ï¼Œå½“stateå‡ä¸º0æ—¶å³å¯è·å–å…±äº«é”ï¼Œå®ç°æ–¹å¼æ˜¯é€šè¿‡ é“¾è¡¨å‘åç»§èŠ‚ç‚¹ä¸€ä¸ªä¸ªä»ç­‰å¾…çŠ¶æ€å”¤é†’\nå¾ªç¯å±éšœCyclicBarrier #\rå¾ªç¯å±éšœä¼šä¸æ–­é˜»æŒ¡çº¿ç¨‹ï¼Œç›´åˆ°è¢«é˜»æŒ¡çš„çº¿ç¨‹è¶³å¤Ÿå¤šæ—¶ï¼Œæ‰èƒ½ä¸€èµ·å†²ç ´å±éšœï¼Œå¹¶ä¸”åœ¨ å†²ç ´å±éšœæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åšä¸€äº›å…¶ä»–çš„ä»»åŠ¡ã€‚è¿™å’Œäººå¤šåŠ›é‡å¤§çš„é“ç†æ˜¯å·®ä¸å¤šçš„ï¼Œå½“äººè¶³å¤Ÿå¤šæ—¶æ–¹èƒ½å†²ç ´é˜»ç¢ï¼Œ åˆ°è¾¾ç¾å¥½çš„æ˜å¤©ã€‚å½“ç„¶ï¼Œå±éšœç”±äºæ˜¯å¯å¾ªç¯çš„ï¼Œæ‰€ä»¥å®ƒåœ¨è¢«å†²ç ´åï¼Œä¼šé‡æ–°å¼€å§‹è®¡æ•°ï¼Œç»§ç»­é˜»æŒ¡åç»­çš„çº¿ç¨‹ï¼š\nCyclicBarrier barrier = new CyclicBarrier(5); //åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸º5çš„å¾ªç¯å±éšœ å±éšœæœ€å¤§å®¹é‡ï¼šparties ç‰¹ç‚¹ï¼šç­‰å¾…çº¿ç¨‹å†²ç ´é˜»ç¢çš„æ—¶å€™æ‰å¯ä»¥ ä¸€èµ·å®Œæˆä»»åŠ¡ï¼Œå®Œæˆä»»åŠ¡ä¹‹åç»§ç»­ç­‰å¾…ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡è¾¾åˆ°æœ€å¤§å€¼ ã€‚\nå½“awaitçŠ¶æ€ä¸‹çš„çº¿ç¨‹è¢«ä¸­æ–­ï¼Œå±éšœå°†ä¼šè¢«ç ´åï¼Œè¿™ä¸€è½®ä¸èƒ½ä½¿ç”¨ï¼Œé™¤éé‡æ–°å¼€å§‹\nä¿¡å·é‡ Semaphore #\ré™åˆ¶ä¿¡å·å®¹é‡ï¼Œåœ¨ä¸€æ®µä»»åŠ¡ä¸­ï¼Œè¦æ±‚ åªèƒ½éƒ¨åˆ†çº¿ç¨‹å®Œæˆè¿™æ®µå·¥ä½œçš„æ—¶å€™å®Œæˆ\nçº¿ç¨‹ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢ Exchanger #\rå®ç°ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢çš„é€šä¿¡ï¼Œåªæœ‰å½“ä¸¤ä¸ªçº¿ç¨‹å®Œæˆäº¤æ¢ä¹‹åæ‰å¯ä»¥å®Œæˆä»»åŠ¡ï¼Œå¦åˆ™çº¿ç¨‹é˜»å¡ã€‚\nFork/Joinæ¡†æ¶ #\rForkJoinPool pool = new ForkJoinPool();\nforkæŒ‡çš„æ˜¯åˆ’åˆ†ä»»åŠ¡ï¼Œä»»åŠ¡çº¦åˆ†è¶Šç»† joinæŒ‡çš„æ˜¯åŠ å…¥ä»»åŠ¡ï¼Œä»»åŠ¡å¼€å§‹æ‰§è¡Œ END #\r","date":"9 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/%E8%BF%9B%E9%98%B6/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"çº¿ç¨‹æ±  #\rnew Threadç¼ºç‚¹ï¼šé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼Œæµªè´¹äº†çº¿ç¨‹èµ„æºï¼ŒçŸ­æ—¶é—´åˆ›å»ºå¤§é‡çº¿ç¨‹å’Œé”€æ¯ çº¿ç¨‹æ± æ˜¯æœ‰é™å¯é‡å¤ä½¿ç”¨çš„çº¿ç¨‹ï¼Œç”¨å®Œéœ€è¦å½’è¿˜\n//æ„é€ æ–¹æ³•ï¼Œå«æœ‰ä¸ƒä¸ªå‚æ•° public ThreadPoolExecutor(int corePoolSize,//æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° int maximumPoolSize,//æœ€å¤§çº¿ç¨‹æ± å¤§å° long keepAliveTime,//çº¿ç¨‹æœ€å¤§ç©ºé—²æ—¶é—´ TimeUnit unit,//æœ€å¤§ç©ºé—²æ—¶é—´å•ä½ BlockingQueue\u0026lt;Runnable\u0026gt; workQueue//çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ï¼Œå½“è¶…å‡ºæœ€å¤§å®¹é‡æ—¶ï¼Œä»»åŠ¡è¿›å…¥ç­‰å¾…é˜Ÿåˆ—) { this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(),//çº¿ç¨‹åˆ›å»ºå·¥å‚ï¼Œå¯è‡ªå®šä¹‰ defaultHandler//æ‹’ç»ç­–ç•¥ï¼Œå®åœ¨ä¸èƒ½åŠ å…¥æ–°çš„ä»»åŠ¡æ—¶ï¼Œæ‹’ç»ä»»åŠ¡); } æ ¹æ®CPUç±»å‹åˆ†é…çº¿ç¨‹æ± å¤§å° #\rThreadPoolExecutor #\rpublic static void main(String[] args) throws InterruptedException { ThreadPoolExecutor executor = new ThreadPoolExecutor(2, 4, //2ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸º4ä¸ª 3, TimeUnit.","title":"å¹¶å‘è¿›é˜¶","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\rJava å¹¶å‘ç¼–ç¨‹ #\rè½»é‡çº§é”ï¼š #\ræ£€æŸ¥å½“å‰å¯¹è±¡çš„mark wordæ˜¯å¦æœ‰è¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼Œå‡å¦‚æ²¡æœ‰å°±ä¼šåœ¨å½“å‰æ ˆå¸§é‡Œé¢å»ºç«‹ä¸€ä¸ª é”è®°å½•ï¼Œå¤åˆ¶å¹¶å­˜å‚¨å½“å‰å¯¹è±¡çš„mark word ä¿¡æ¯ã€‚\nä¸åƒé‡é‡çº§é”éœ€è¦å‘ç³»ç»Ÿç”³è¯·äº’æ–¥é‡ï¼Œ\nCASï¼ˆæ— é”ç®—æ³•ï¼‰ #\ræ˜¾ç„¶ï¼Œå½“caså¤±è´¥çš„æ—¶å€™ï¼Œè¯´æ˜æœ‰çº¿ç¨‹è¿›å…¥äº†è¿™ä¸ªåŒæ­¥ä»£ç å—ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè™šæ‹Ÿæœºå°†ä¼šæ£€æŸ¥ å½“å‰å¯¹è±¡çš„mark wordæ˜¯å¦æŒ‡å‘å½“å‰å¯¹è±¡çš„æ ˆå¸§ï¼Œæ˜¯çš„è¯å°±è¯´æ˜å½“å‰å·²ç»è·å¾—é”ï¼Œå¦åˆ™ä¸æ˜¯-ã€‹é€€åŒ–ä¸ºé‡é‡çº§é”(ä¸å¯é€†) è§£é”æ—¶ï¼ŒåŒæ ·ä½¿ç”¨CASç®—æ³•æ“ä½œï¼ŒåŒæ—¶å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹\nåå‘é” #\rå½“æŸä¸ªé”é¢‘ç¹çš„è¢«åŒä¸€ä¸ªçº¿ç¨‹è·å–ï¼Œå¯¹è½»é‡çº§é”è¿›è¡Œä¼˜åŒ–ï¼Œæ‰€ä»¥åå‘é”ä¸“é—¨ä¸ºå•ä¸ªçº¿ç¨‹æœåŠ¡ï¼Œæ­¤æ—¶ï¼Œæ— é¡»å†è¿›è¡ŒCASæ“ä½œï¼Œå½“å…¶ä»–çº¿ç¨‹ åˆå¼€å§‹æŠ¢é”ï¼Œåå‘é”å¯èƒ½é€€åŒ–ä¸ºè½»é‡çº§é”ã€‚æ³¨æ„å½“è°ƒç”¨å¯¹è±¡çš„hashCodeï¼ˆï¼‰æ–¹æ³•ï¼Œç”±äºmark word æ•°æ®ç»“æ„æ— æ³• ä¿å­˜hashå€¼ï¼Œåå‘é”ç›´æ¥é€€åŒ–ä¸ºè½»é‡çº§é”ã€‚\né”çš„é€€åŒ–ä¸å¯é€†\né”æ¶ˆé™¤å’Œé”ä¼˜åŒ– #\rä»£ç å—ä¸­æœ‰å¯èƒ½ä¸ä¼šæ€»æ˜¯å‡ºç°è¯·æ±‚é”å’Œé‡Šæ”¾é”çš„é—®é¢˜ï¼Œï¼ˆæ¯”å¦‚å¾ªç¯ä¸­åŠ é”ï¼‰ï¼Œæ­¤æ—¶é”ä¸ºäº†ä¼˜åŒ–å‡ºç°é”æ¶ˆé™¤å’Œé”ä¼˜åŒ–\nJavaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰ #\rä¸»å†…å­˜ï¼š å­˜æ”¾å¯¹è±¡å®ä¾‹çš„éƒ¨åˆ† å·¥ä½œå†…å­˜ï¼šè™šæ‹Ÿæœºæ ˆçš„éƒ¨åˆ†ï¼Œæ”¾å…¥cpuçš„é«˜é€Ÿç¼“å­˜é‡Œé¢ã€‚ è‡ªå¢æ“ä½œä¸æ˜¯ç”±ä¸€ä¸ªæŒ‡ä»¤å®ç°çš„ï¼ï¼ï¼åŒ…æ‹¬è·å–ï¼Œä¿®æ”¹å’Œä¿å­˜\nclass Test{ private static volatile int sum=0;//æˆå‘˜å˜é‡,è¿™æ ·çš„å˜é‡å¿…é¡»æ˜¯å½“å‰çš„å¯¹è±¡æ‰€æ‹¥æœ‰çš„ //åŠ å…¥äº†volatileå…³é”®å­—ä¹‹åï¼Œçº¿ç¨‹ä¹‹é—´å¯ä»¥æ„ŸçŸ¥å½¼æ­¤çš„å€¼ @Test void LockTestAdd() throws InterruptedException { //æ²¡æœ‰åŠ é”çš„æ—¶å€™ï¼Œç”±äºçº¿ç¨‹ä¹‹é—´ä¸èƒ½æ„ŸçŸ¥å¯¹æ–¹çš„å€¼ï¼Œæœ€ç»ˆç»“æ„å¯èƒ½ä¸ä¼šæ˜¯200 Thread th1 = new Thread(() -\u0026gt; { for (int i = 0; i \u0026lt; 100; i++) sum++; }); Thread th2 = new Thread(() -\u0026gt; { for (int i = 0; i \u0026lt; 100; i++) sum++; }); th1.start(); th2.start(); Thread.sleep(100); System.out.println(sum); } } é‡æ’åº #\rç”±äºJVMè™šæ‹Ÿæœºå’Œç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼ŒæŒ‡ä»¤å¯èƒ½å‡ºç°é‡æ’åºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å¯èƒ½å‡ºç°ä¸ç¬¦åˆé¢„æœŸçš„æƒ…å†µ\nvolatileå…³é”®å­—ï¼ˆæ— æ³•ä¿è¯åŸå­æ€§ï¼Œä½†èƒ½ä¿è¯å¯è§æ€§ï¼‰ #\rloadå’Œsaveæ“ä½œï¼Œå°†ä¸»å†…å­˜ä¸­çš„å˜é‡æ‹·è´åˆ°æœ¬åœ°ï¼Œåªå¯¹æœ¬åœ°å˜é‡è¿›è¡Œæ“ä½œã€‚\nvolatileå®ç°åŸç†å°±æ˜¯æ”¹å˜æˆå‘˜å˜é‡æ—¶ï¼Œsaveçš„å·¥ä½œåŒºçš„å˜é‡æ— æ•ˆã€‚é‡æ–°æ›´æ–°ä¸»å†…å­˜ä¸­çš„å˜é‡å€¼ï¼Œ volatileå…³é”®å­—ä¼šç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚\nclass VolatileTest{ private static volatile int sum=0;//æˆå‘˜å˜é‡,è¿™æ ·çš„å˜é‡å¿…é¡»æ˜¯å½“å‰çš„å¯¹è±¡æ‰€æ‹¥æœ‰çš„ //åŠ å…¥äº†volatileå…³é”®å­—ä¹‹åï¼Œçº¿ç¨‹ä¹‹é—´å¯ä»¥æ„ŸçŸ¥å½¼æ­¤çš„å€¼,ä½†è¿˜æ˜¯æ— æ³•ä¿è¯åŸå­æ€§æ“ä½œï¼Œä¸èƒ½è¾¾åˆ°é¢„æœŸæ•ˆæœ @Test void LockTestAdd() throws InterruptedException { //æ²¡æœ‰åŠ é”çš„æ—¶å€™ï¼Œç”±äºçº¿ç¨‹ä¹‹é—´ä¸èƒ½æ„ŸçŸ¥å¯¹æ–¹çš„å€¼ï¼Œæœ€ç»ˆç»“æ„å¯èƒ½ä¸ä¼šæ˜¯200 Thread th1 = new Thread(() -\u0026gt; { for (int i = 0; i \u0026lt; 1000; i++) sum++; }); Thread th2 = new Thread(() -\u0026gt; { for (int i = 0; i \u0026lt; 1000; i++) { sum++; } }); th1.start(); th2.start(); Thread.sleep(100); System.out.println(sum); } } JVMç¼–è¯‘å™¨ä¸‹é¢çš„é¡ºåºæ‰§è¡Œï¼š\nHappens Before åŸåˆ™ï¼ˆä¹‹å‰çš„å¯¹ä¹‹åçš„å¯è§ï¼‰ #\rç¨‹åºæ¬¡åºè§„åˆ™ï¼Œç›‘è§†å™¨é”åŸåˆ™ï¼Œvolatileå…³é”®å­—åŸåˆ™ï¼ˆå†™æ“ä½œåœ¨è¯»æ“ä½œä¹‹å‰ï¼‰ï¼Œ\nstart(çº¿ç¨‹å¯åŠ¨è§„åˆ™) #\rAçº¿ç¨‹ç”¨startè°ƒç”¨Bçº¿ç¨‹ï¼Œé‚£ä¹ˆAåœ¨Bä¹‹å‰ï¼ˆA happens before Bï¼‰\njoinçº¿ç¨‹åŠ å…¥è§„åˆ™ #\rAçº¿ç¨‹joinçº¿ç¨‹Bï¼Œé‚£ä¹ˆBåœ¨Aä¹‹å‰ï¼ˆB happens before Aï¼‰\nç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« #\rç¨‹åºè½¯ä»¶ \u0026gt; è¿›ç¨‹ \u0026gt; çº¿ç¨‹\né”çš„æ¡†ï¼šLock #\rä¸ºäº†ä»£æ›¿ä¼ ç»Ÿçš„synchronized,notify,wait,notifyAllå…³é”®å­—ï¼ŒLockæ¥å£-\u0026gt;ReentrantLockå¯é‡å…¥é”\nå¯é‡å…¥é”ï¼ˆæ’ä»–é”ï¼‰ #\rå¤šæ¬¡åŠ é”ï¼Œå…¶ä»–çº¿ç¨‹æƒ³è¦å¾—åˆ°é”éœ€è¦æŠŠå¤šæ¬¡çš„é”é‡Šæ”¾æ‰å¯ä»¥è·å–è¿™æŠŠé”\nå½“å­˜åœ¨çº¿ç¨‹æƒ³è¦è·å–é”ä½†æ˜¯é”æ²¡æœ‰é‡Šæ”¾çš„æ—¶å€™ï¼Œæ­¤æ—¶è¿™äº›çº¿ç¨‹å°†ä¼šè¿›å…¥çº¿ç¨‹é˜Ÿåˆ—é‡Œé¢\nå…¬å¹³é”å’Œéå…¬å¹³é”ï¼ˆAQSï¼‰ #\rå…¬å¹³é”å§‹ç»ˆä¿æŒå…ˆåˆ°å…ˆå¾—åˆ°é”ï¼Œéå…¬å¹³é”åˆ™æ˜¯åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­æ‰€æœ‰ç­‰å¾…çº¿ç¨‹åŒæ—¶å°è¯•è·å–é”ï¼Œè·å–ä¸åˆ°åˆ™å†æ¬¡è¿›å…¥ç­‰å¾…é˜Ÿåˆ—\nReentrantLock lock=new ReentrantLock(false);//å…¬å¹³é”ä¸ä¸€å®šæ€»æ˜¯ä¿æŒå…¬å¹³ã€‚é˜Ÿåˆ—åŒæ­¥å™¨ Runnable runnable=()-\u0026gt;{ System.out.println(Thread.currentThread().getName() + \u0026#34;å¼€å§‹å°è¯•è·å–é”èµ„æº\u0026#34;); lock.lock(); System.out.println(Thread.currentThread().getName() + \u0026#34;æˆåŠŸğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºğŸ˜ºè·å–é”èµ„æº\u0026#34;); lock.unlock(); }; for (int i = 0; i \u0026lt; 10; i++) { new Thread(runnable,\u0026#34;T\u0026#34;+i).start(); } è¯»å†™é”ï¼š #\ré™¤äº†å¯é‡å…¥é”ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§ç±»å‹çš„é”å«åšè¯»å†™é”ï¼Œå½“ç„¶å®ƒå¹¶ä¸æ˜¯ä¸“é—¨ç”¨ä½œè¯»å†™æ“ä½œçš„é”ï¼Œ å®ƒå’Œå¯é‡å…¥é”ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œå¯é‡å…¥é”æ˜¯ä¸€ç§æ’ä»–é”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å¾—åˆ°é”ä¹‹åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¿…é¡»ç­‰å¾…å…¶é‡Šæ”¾é”ï¼Œå¦åˆ™ä¸€å¾‹ä¸å…è®¸è·å–åˆ°é”ã€‚è€Œè¯»å†™é”åœ¨åŒä¸€æ—¶é—´ï¼Œæ˜¯å¯ä»¥è®©å¤šä¸ªçº¿ç¨‹è·å–åˆ°é”çš„ï¼Œå®ƒå…¶å®å°±æ˜¯é’ˆå¯¹äºè¯»å†™åœºæ™¯è€Œå‡ºç°çš„ã€‚\nè¯»å†™é”ç»´æŠ¤äº†ä¸€ä¸ªè¯»é”å’Œä¸€ä¸ªå†™é”ï¼Œè¿™ä¸¤ä¸ªé”çš„æœºåˆ¶æ˜¯ä¸åŒçš„ã€‚\nè¯»é”ï¼šåœ¨æ²¡æœ‰ä»»ä½•çº¿ç¨‹å ç”¨å†™é”çš„æƒ…å†µä¸‹ï¼ŒåŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŠ è¯»é”ã€‚\nå†™é”ï¼šåœ¨æ²¡æœ‰ä»»ä½•çº¿ç¨‹å ç”¨è¯»é”çš„æƒ…å†µä¸‹ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åŠ å†™é”ã€‚\næ˜¾ç„¶è¯»é”æ˜¯å¯ä»¥é‡å¤è·å–çš„ä½†æ˜¯å†™é”ä¸èƒ½ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹åŒæ—¶æ‹¥æœ‰å†™é”å’Œè¯»é”çš„æ—¶å€™ï¼Œå…ˆç”³è¯·è¯»é” ç„¶åé‡Šæ”¾å†™é”ï¼Œæ­¤æ—¶å…¶ä»–çš„çº¿ç¨‹åˆå¯ä»¥è·å–è¯»é”ï¼Œåªå‰©ä¸‹è¯»é”ï¼Œæ­¤æ—¶ç§°ä¹‹ä¸ºâ€œé”é™çº§â€ã€‚ åœ¨ä»…ä»…æŒæœ‰è¯»é”çš„æ—¶å€™å»ç”³è¯·å†™é”ï¼Œç§°ä¸ºâ€œé”å‡çº§â€ï¼Œè¿™æ—¶å€™ReentryReadWriteLockç±»ä¸æ”¯æŒã€‚\né˜Ÿåˆ—åŒæ­¥å™¨AQSï¼ˆAbstractQueuedSynchronizerï¼‰ #\rç»§æ‰¿å…³ç³»ï¼šLock-\u0026gt; Sync -\u0026gt; AbstractQueuedSynchronizer\nå¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸‹çš„ABAé—®é¢˜ #\r//ABAé—®é¢˜çš„ç‰ˆæœ¬å·è§£å†³æ–¹æ³• AtomicReference\u0026lt;String\u0026gt; atomicReference=new AtomicReference\u0026lt;\u0026gt;(\u0026#34;A\u0026#34;); System.out.println(atomicReference.compareAndSet(\u0026#34;a\u0026#34;, \u0026#34;c\u0026#34;)); String hello = \u0026#34;hello\u0026#34;; String world = \u0026#34;world\u0026#34;; Runnable r=()-\u0026gt;{ System.out.println(atomicReference.compareAndSet(\u0026#34;A\u0026#34;, \u0026#34;B\u0026#34;)); }; for (int i = 0; i \u0026lt; 100; i++) { new Thread(r).start(); } å¯ä»¥çœ‹åˆ°å¤šä¸ªçº¿ç¨‹å°è¯•å»ä¿®æ”¹çš„æ—¶å€™å‡ºç°äº†ä¸€ä¸ªtrue\nè§£å†³åŠæ³•ï¼šæ·»åŠ ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡ä¿®æ”¹çš„æ—¶å€™å¯¹ç‰ˆæœ¬å·ï¼ˆstampï¼‰è¿›è¡Œä¿®æ­£\nå¹¶å‘å®¹å™¨ #\ræ¯”å¦‚åœ¨å¯¹é“¾è¡¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰å®Œæˆå¯¹é“¾è¡¨æ‰©å®¹ä¹‹å‰ï¼Œå…¶ä»–çº¿ç¨‹æ’é˜Ÿï¼Œéæ³•æ’å…¥å…ƒç´ ï¼Œå°±ä¼šé€ æˆæ•°ç»„è¶Šç•Œçš„æŠ¥é”™ã€‚\nConcurrentHashMap:åœ¨jdk1.7ä¹‹å‰çš„å®ç°æ–¹æ³•ï¼Œæ¯”å¦‚åœ¨åŸå­ç±»é‡Œé¢å®ç°LongAdderå…·æœ‰å‹åŠ›åˆ†æ•£çš„æ€æƒ³ï¼Œæé«˜äº†æ€§èƒ½ï¼Œé€‰æ‹©å°†æ•°æ®ä¸€æ®µä¸€æ®µçš„å­˜å‚¨ï¼Œè¿™æ ·å°±å‡å°‘äº†ç­‰å¾…ï¼Œå½“çº¿ç¨‹è®¿é—®é”çš„æ—¶å€™åªå ç”¨é”çš„ä¸€å°éƒ¨åˆ† jdk8ä¹‹åï¼Œå®ç°æ–¹æ³•æ˜¯é€šè¿‡casç®—æ³•é…åˆé”æœºåˆ¶å®ç°çš„ã€‚ç”±äºHashMapåˆ©ç”¨äº†å“ˆå¸Œè¡¨ï¼Œå®¹é‡è¶Šå¤§ï¼ŒåŠ é”çš„ç²’åº¦å°±ä¼šè¶Šç»†ã€‚ //åŸå­ç±»çš„æµ‹è¯•æ“ä½œ //ABAé—®é¢˜çš„ç‰ˆæœ¬å·è§£å†³æ–¹æ³• CopyOnWriteArrayList\u0026lt;Object\u0026gt; objects = new CopyOnWriteArrayList\u0026lt;\u0026gt;(); //è¯»å–ä¸åŠ é”ï¼Œå†™æ•°æ®éœ€è¦åŠ é”ï¼Œæ‰€ä»¥æ€§èƒ½è¿˜è¡Œ //ä¸“ç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å®¹å™¨ LinkedList\u0026lt;Object\u0026gt; list = new LinkedList\u0026lt;\u0026gt;();//æ²¡æœ‰å‘ç”Ÿå¹¶å‘å¼‚å¸¸ ArrayList\u0026lt;Object\u0026gt; list1 = new ArrayList\u0026lt;\u0026gt;(); ConcurrentHashMap\u0026lt;Integer, String\u0026gt; map = new ConcurrentHashMap\u0026lt;\u0026gt;(); HashMap\u0026lt;Integer, String\u0026gt; hashMap = new HashMap\u0026lt;\u0026gt;(); Runnable r=()-\u0026gt;{ for (int j = 0; j \u0026lt; 100; j++) { int finalI=j; objects.add(\u0026#34;aaa\u0026#34;); map.put(finalI,\u0026#34;aaa\u0026#34;); hashMap.put(finalI,\u0026#34;aaa\u0026#34;); } }; for (int i = 0; i \u0026lt; 100; i++) { new Thread(r).start(); } TimeUnit.SECONDS.sleep(1); é˜»å¡é˜Ÿåˆ—ï¼ˆBlokingQueueï¼‰ #\rç”Ÿäº§è€…æ¶ˆè´¹ä¹‹æ¨¡å‹ï¼š\n//æµ‹è¯•é˜»å¡é˜Ÿåˆ—å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ BlockingQueue\u0026lt;Object\u0026gt; queue=new ArrayBlockingQueue\u0026lt;\u0026gt;(1);//çª—å£åªèƒ½æ”¾ä¸€ä¸ªèœï¼Œé˜»å¡é˜Ÿåˆ—çš„å®¹é‡ Runnable supplier=()-\u0026gt;{ while (true){ try { String name = Thread.currentThread().getName(); System.err.println(time()+\u0026#34;ç”Ÿäº§è€…\u0026#34;+name+\u0026#34;æ­£åœ¨å‡†å¤‡é¤å“\u0026#34;); TimeUnit.SECONDS.sleep(3); System.err.println(time()+\u0026#34;ç”Ÿäº§è€…\u0026#34;+name+\u0026#34;å·²å‡ºé¤\u0026#34;); queue.put(new Object()); }catch (InterruptedException e){ e.printStackTrace(); break; } } }; Runnable consumer=()-\u0026gt;{ while (true){ try { String name = Thread.currentThread().getName(); System.out.println(time()+\u0026#34;æ¶ˆè´¹è€…\u0026#34;+name+\u0026#34;æ­£åœ¨ç­‰å¾…é¤å“\u0026#34;); queue.take(); System.out.println(time()+\u0026#34;æ¶ˆè´¹è€…\u0026#34;+name+\u0026#34;å·²å–é¤\u0026#34;); TimeUnit.SECONDS.sleep(4); System.out.println(time()+\u0026#34;æ¶ˆè´¹è€…\u0026#34;+name+\u0026#34;å·²åƒå®Œ\u0026#34;); }catch (InterruptedException e){ e.printStackTrace(); break; } } }; for (int i = 0; i \u0026lt; 2; i++) { new Thread(supplier,\u0026#34;supplier\u0026#34;+i).start(); } for (int i = 0; i \u0026lt; 3; i++) { new Thread(consumer,\u0026#34;consumer\u0026#34;+i).start(); } } public static String time(){ SimpleDateFormat format = new SimpleDateFormat(\u0026#34;HH:mm:ss\u0026#34;); return \u0026#34;[\u0026#34;+format.format(new Date())+\u0026#34;]\u0026#34;; } å¸¸è§çš„é˜»å¡é˜Ÿåˆ—ï¼šArrayBlokingQueue(æœ‰ç•Œç¼“å†²é˜»å¡é˜Ÿåˆ—),SynchronousQueue(æ— ç¼“å†²é˜»å¡é˜Ÿåˆ—),LinkedBlokingQueue(æ— ç•Œå¸¦ç¼“å†²é˜»å¡é˜Ÿåˆ—)\npublic boolean offer(E e) { Objects.requireNonNull(e);//æ£€æŸ¥å½“å‰çš„é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º final ReentrantLock lock = this.lock;//å¯¹å½“å‰çº¿ç¨‹åŠ é” lock.lock(); try { if (count == items.length) return false; else { enqueue(e); return true; } } finally { lock.unlock(); } } public E take() throws InterruptedException { final ReentrantLock lock = this.lock; lock.lockInterruptibly(); try { while (count == 0) notEmpty.await();//å½“å½“å‰çº¿ç¨‹è¯»å–åˆ°é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œç”±äºtakeæ“ä½œæ—¶é˜»å¡çš„ï¼Œéœ€è¦æŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œç­‰å¾…ç›´åˆ°é˜Ÿåˆ—é‡Œé¢æœ‰å€¼ return dequeue(); } finally { lock.unlock(); } } SynchronousQueue(æ²¡æœ‰ä»»ä½•å®¹é‡ï¼Œæ’å…¥å’Œå–å‡ºæ˜¯ä¸€ä¸€å¯¹åº”çš„) #\rSynchronousQueue\u0026lt;String\u0026gt; queue=new SynchronousQueue\u0026lt;\u0026gt;(); new Thread(()-\u0026gt;{ try { System.out.println(queue.take()); } catch (InterruptedException e) { throw new RuntimeException(e); } }).start(); queue.put(\u0026#34;sss\u0026#34;); è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é˜Ÿåˆ—ï¼Œå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæŠ½è±¡ç±»Transferï¼ˆputå’Œtakeæ“ä½œç³…åˆåœ¨ä¸€èµ·äº†ï¼‰ï¼Œ é‡Œé¢æœ‰ä¸€ä¸ªæ–¹æ³•ï¼štransferï¼ˆE e,bolean timed,long nanosï¼‰ç›´æ¥é€šè¿‡ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹æ¥å®ç°æ•°æ®çš„ä¼ é€’ã€‚ å½“æ–°çš„å…ƒç´ putè¿›å»çº¿ç¨‹å°†ä¼šé˜»å¡ã€‚ç›´åˆ°å…ƒç´ è¢«takeã€‚åŒæ—¶è¿™ä¸ªç±»ç»´æŠ¤äº†å…¬å¹³é”å’Œéå…¬å¹³é”ä¸¤ç§æ–¹æ³•ã€‚\nå½“å½“å‰é˜Ÿåˆ—é‡Œé¢æœ‰å…ƒç´ ä½†æ˜¯æ²¡æœ‰çº¿ç¨‹æ¥å–å…ƒç´ æ—¶å€™ï¼Œå°±ä¼šå¼€å¯è‡ªæ—‹ï¼Œå½“è‡ªæ—‹ä¸€å®šæ¬¡æ•°ä¹‹åè¿˜æ²¡æœ‰æ¥å–å°±ä¼šæŒ‚èµ·\nPriorityBlockingQueueä¼˜å…ˆé˜Ÿåˆ— #\ræ„é€ æ–¹æ³•ï¼šPriorityQueue queue=new PriorityQueue(10,Integer::compare);\nä¼ å…¥å®¹é‡å’Œå‡½æ•°é€»è¾‘ï¼ˆä¼˜å…ˆé€»è¾‘ï¼‰\nDelayQueueå»¶æ—¶é˜Ÿåˆ— #\rç‰¹æ®Šåœ°æ–¹ï¼šå­˜å‚¨çš„å…ƒç´ å¿…é¡»æ˜¯ç»§æ‰¿è‡ªDelayedæ¥å£çš„ç±»ï¼ŒåŒæ—¶å…ƒç´ ç±»å¿…é¡»å®ç°Delayedæ¥å£ã€‚\nä½¿ç”¨æ—¶å¯ä»¥å®ç°å»¶æ—¶å‡ºé˜Ÿï¼ŒæŒ‰ç…§åŒæ—¶çš„æ—¶å€™æŒ‰ç…§ä¼˜å…ˆçº§ï¼ˆè‡ªå·±å®ç°ï¼‰è¿›è¡Œå‡ºé˜Ÿï¼Œè¿™æ ·å°±å¯ä»¥å®ç°ç¼“å­˜äº†ã€‚\nåº•å±‚å®ç°ï¼š\npublic class DelayQueue\u0026lt;E extends Delayed\u0026gt; extends AbstractQueue\u0026lt;E\u0026gt; implements BlockingQueue\u0026lt;E\u0026gt; { private final transient ReentrantLock lock = new ReentrantLock(); private final PriorityQueue\u0026lt;E\u0026gt; q = new PriorityQueue\u0026lt;E\u0026gt;(); //é€šè¿‡å†…éƒ¨ç»´æŠ¤çš„ä¼˜å…ˆé˜Ÿåˆ—æ¥å®ç°å…ƒç´ çš„å­˜å‚¨ï¼Œè€Œä¸æ˜¯æœ¬èº«è¿›è¡Œå­˜å‚¨ } ä¸»è¦å¸¸è§çš„é˜»å¡é˜Ÿåˆ—æ€»ç»“å¦‚ä¸‹ï¼š #\rArrayBlokingQueueåº•å±‚é€šè¿‡æ•°ç»„å®ç°çš„é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥è®¾ç½®åˆå§‹çš„å®¹é‡ï¼Œæ¢å¥è¯å®¹é‡æ˜¯å›ºå®šçš„ LinkedTransferQueue SynchronousQueueè¦æ±‚å…¥é˜Ÿå’Œå‡ºé˜Ÿå¿…é¡»åŒæ—¶è¿›è¡Œï¼Œä¸€ä¸€å¯¹åº”ï¼ŒåŸå› æ˜¯å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæŠ½è±¡ç±»tansferï¼Œéœ€è¦ç­‰åˆ°æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…åŒæ—¶åˆ°é½æ‰å¯ä»¥å®Œæˆäº¤æ¥å·¥ä½œï¼Œæ”¯æŒå…¬å¹³å’Œéå…¬å¹³ PriorityBlokingQueueä¼˜å…ˆé˜Ÿåˆ—ï¼Œå…ƒç´ çš„è·å–é¡ºåºæŒ‰ç…§ä¼˜å…ˆçº§å†³å®š DelayQueueèƒ½å¤Ÿå®ç°å»¶è¿Ÿè·å–å…ƒç´ ï¼ŒåŒæ ·æ”¯æŒä¼˜å…ˆçº§ï¼Œè¦æ±‚åŠ å…¥çš„å…ƒç´ å¿…é¡»ç»§æ‰¿Delayedæ¥å£ æ•°æ®å­—å…¸ #\rå¸¸è§çš„å¸¸ç”¨çš„æ•°æ®ï¼Œå…·æœ‰åˆ†çº§çš„ç‰¹ç‚¹ï¼Œç°åœ¨å°†æ¯”å¦‚çœä»½å¿å¸‚åœ°ç‚¹çš„ä¿¡æ¯ç»´æŠ¤æˆä¸€å¼ è¡¨å°±å¯ä»¥æ˜¯å®ç° æ®å­—å…¸ï¼Œé€šå¸¸å…·æœ‰idï¼Œparent_idè¿™äº›å­—æ®µï¼Œç»´æŠ¤çˆ¶çº§å’Œå­çº§çš„å…³ç³»ã€‚\nå…³äºElementUiçš„æ•°æ®å­—å…¸çš„æ˜¾ç¤ºæ–¹æ³•å°±æ˜¯æ£€æŸ¥hasChildrenå­—æ®µçš„å€¼è¿›è¡Œæ¸²æŸ“\nçº¿ç¨‹æ±  #\rå¼•å…¥åŸå› ï¼šé¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¯¹ç³»ç»Ÿèµ„æºçš„æµªè´¹ååˆ†ä¸¥é‡ï¼Œä¸ºäº†åˆç†åˆ†é…å’Œè°ƒç”¨ç³»ç»Ÿèµ„æºï¼Œäº§ç”Ÿäº†çº¿ç¨‹æ± çš„æŠ€æœ¯\nå®ç°åŸç†ï¼šå°†å·²åˆ›å»ºçš„çº¿ç¨‹å¤ç”¨ï¼Œåˆ©ç”¨æ± åŒ–æŠ€æœ¯ï¼Œå°±åƒæ•°æ®åº“è¿æ¥æ± ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºå¾ˆå¤šä¸ªçº¿ç¨‹ï¼Œç„¶ååå¤åœ°ä½¿ç”¨è¿™äº›çº¿ç¨‹ï¼Œè€Œä¸å¯¹å®ƒä»¬è¿›è¡Œé”€æ¯ã€‚\nç”±äºçº¿ç¨‹æ± å¯ä»¥åå¤åˆ©ç”¨å·²æœ‰çº¿ç¨‹æ‰§è¡Œå¤šçº¿ç¨‹æ“ä½œï¼Œæ‰€ä»¥å®ƒä¸€èˆ¬æ˜¯æœ‰å®¹é‡é™åˆ¶çš„ï¼Œå½“æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¤„äºå·¥ä½œçŠ¶æ€æ—¶ï¼Œé‚£ä¹ˆæ–°çš„å¤šçº¿ç¨‹è¯·æ±‚ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªçº¿ç¨‹ç©ºé—²å‡ºæ¥ä¸ºæ­¢ï¼Œå®é™…ä¸Šè¿™é‡Œå°±ä¼šç”¨åˆ°æˆ‘ä»¬ä¹‹å‰è®²è§£çš„é˜»å¡é˜Ÿåˆ—ã€‚\n","date":"9 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/%E5%B9%B6%E5%8F%91/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"Java å¹¶å‘ç¼–ç¨‹ #\rè½»é‡çº§é”ï¼š #\ræ£€æŸ¥å½“å‰å¯¹è±¡çš„mark wordæ˜¯å¦æœ‰è¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼Œå‡å¦‚æ²¡æœ‰å°±ä¼šåœ¨å½“å‰æ ˆå¸§é‡Œé¢å»ºç«‹ä¸€ä¸ª é”è®°å½•ï¼Œå¤åˆ¶å¹¶å­˜å‚¨å½“å‰å¯¹è±¡çš„mark word ä¿¡æ¯ã€‚\nä¸åƒé‡é‡çº§é”éœ€è¦å‘ç³»ç»Ÿç”³è¯·äº’æ–¥é‡ï¼Œ\nCASï¼ˆæ— é”ç®—æ³•ï¼‰ #\ræ˜¾ç„¶ï¼Œå½“caså¤±è´¥çš„æ—¶å€™ï¼Œè¯´æ˜æœ‰çº¿ç¨‹è¿›å…¥äº†è¿™ä¸ªåŒæ­¥ä»£ç å—ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè™šæ‹Ÿæœºå°†ä¼šæ£€æŸ¥ å½“å‰å¯¹è±¡çš„mark wordæ˜¯å¦æŒ‡å‘å½“å‰å¯¹è±¡çš„æ ˆå¸§ï¼Œæ˜¯çš„è¯å°±è¯´æ˜å½“å‰å·²ç»è·å¾—é”ï¼Œå¦åˆ™ä¸æ˜¯-ã€‹é€€åŒ–ä¸ºé‡é‡çº§é”(ä¸å¯é€†) è§£é”æ—¶ï¼ŒåŒæ ·ä½¿ç”¨CASç®—æ³•æ“ä½œï¼ŒåŒæ—¶å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹\nåå‘é” #\rå½“æŸä¸ªé”é¢‘ç¹çš„è¢«åŒä¸€ä¸ªçº¿ç¨‹è·å–ï¼Œå¯¹è½»é‡çº§é”è¿›è¡Œä¼˜åŒ–ï¼Œæ‰€ä»¥åå‘é”ä¸“é—¨ä¸ºå•ä¸ªçº¿ç¨‹æœåŠ¡ï¼Œæ­¤æ—¶ï¼Œæ— é¡»å†è¿›è¡ŒCASæ“ä½œï¼Œå½“å…¶ä»–çº¿ç¨‹ åˆå¼€å§‹æŠ¢é”ï¼Œåå‘é”å¯èƒ½é€€åŒ–ä¸ºè½»é‡çº§é”ã€‚æ³¨æ„å½“è°ƒç”¨å¯¹è±¡çš„hashCodeï¼ˆï¼‰æ–¹æ³•ï¼Œç”±äºmark word æ•°æ®ç»“æ„æ— æ³• ä¿å­˜hashå€¼ï¼Œåå‘é”ç›´æ¥é€€åŒ–ä¸ºè½»é‡çº§é”ã€‚\né”çš„é€€åŒ–ä¸å¯é€†\né”æ¶ˆé™¤å’Œé”ä¼˜åŒ– #\rä»£ç å—ä¸­æœ‰å¯èƒ½ä¸ä¼šæ€»æ˜¯å‡ºç°è¯·æ±‚é”å’Œé‡Šæ”¾é”çš„é—®é¢˜ï¼Œï¼ˆæ¯”å¦‚å¾ªç¯ä¸­åŠ é”ï¼‰ï¼Œæ­¤æ—¶é”ä¸ºäº†ä¼˜åŒ–å‡ºç°é”æ¶ˆé™¤å’Œé”ä¼˜åŒ–\nJavaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰ #\rä¸»å†…å­˜ï¼š å­˜æ”¾å¯¹è±¡å®ä¾‹çš„éƒ¨åˆ† å·¥ä½œå†…å­˜ï¼šè™šæ‹Ÿæœºæ ˆçš„éƒ¨åˆ†ï¼Œæ”¾å…¥cpuçš„é«˜é€Ÿç¼“å­˜é‡Œé¢ã€‚ è‡ªå¢æ“ä½œä¸æ˜¯ç”±ä¸€ä¸ªæŒ‡ä»¤å®ç°çš„ï¼ï¼ï¼åŒ…æ‹¬è·å–ï¼Œä¿®æ”¹å’Œä¿å­˜","title":"Java-Concurrent","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\rå¦‚ä½•é€šè¿‡Hugoè¿™ä¸ªæ¡†æ¶æ¥æ­å»ºä¸€æ¬¾å±äºè‡ªå·±çš„åšå®¢å‘¢ï¼Ÿ #\rè§‚å‰æé†’ï¼šè¿™ç¯‡ç¬”è®°å€Ÿé‰´äº†ä¸‹é¢ä¸¤ä¸ªä½œè€…ï¼š\nä¸€æ˜¯ï¼š\rå°æ£‰å°¾å·´\näº‹ä»¶å¥‘æœº #\ræˆ‘å…¶å®åŸæœ¬å°±çŸ¥é“githubçš„pagesè‡ªåŠ¨éƒ¨ç½²åšå®¢åŠŸèƒ½ï¼Œå½“æ—¶å¤§äºŒä¸ç†Ÿç»ƒï¼Œä»Šå¤©ç›®ç¹ä¸“ä¸šå¤§ä½¬çš„åšå®¢ï¼Œè‡ªç„¶ä¹Ÿå°±é‡æ–°æèµ·æ¥äº†ã€‚\nå¦‚ä¸‹å°±æ˜¯å¤§ä½¬çš„åšå®¢ï¼ˆè¿™ä¸ªä¸»é¢˜æœ¬æ¥å°è¯•ç”¨ï¼Œåç»­å‘ç°æ¯”è¾ƒèŠ±å“¨å°±ä¸é‡‡ç”¨äº†ï¼‰\næœ¬äººæ­å»ºçš„åšå®¢ï¼š\nç¬¬ä¸€æ­¥ä¸‹è½½HuGoæ¡†æ¶ï¼š #\rä»¥Windowsä¸ºä¾‹ï¼šåªéœ€æ‰“å¼€CMDæ‰§è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤\nwinget install Hugo.Hugo.Extended ç­‰å¾…ä¸‹è½½å®Œæˆé‡å¯Shellå‘½ä»¤çª—å£å³å¯ï¼ŒHugoå°†ä¼šè‡ªåŠ¨é…ç½®ç¯å¢ƒå˜é‡ã€‚\næ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸï¼š\nhugo version ç¬¬äºŒéƒ¨åˆ›å»ºHugoåšå®¢é¡¹ç›® #\råªéœ€è¦åœ¨æ–‡ä»¶å¤¹ä¸‹é¢æ–°å»ºç»ˆç«¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œhugoå°†ä¼šè‡ªåŠ¨åˆ›å»ºä½ çš„é¡¹ç›®åç§°æ–‡ä»¶å¤¹ ï¼ŒåŒæ—¶å¼¹å‡ºä¸€ä¸ªä¸»é¢˜é“¾æ¥\nhugo new site +ä½ çš„é¡¹ç›®åç§° ç°åœ¨ä½ éœ€è¦è¿›å…¥ä½ çš„é¡¹ç›®ä¹Ÿå°±æ˜¯å‘½ä»¤ï¼š cd ä½ çš„é¡¹ç›®åç§°\nåŒæ—¶å°†é¡¹ç›®æ³¨å†Œä¸ºgitæ ¹\ngit init ä¾‹å¦‚ï¼š ç‚¹å‡»\rhttps://themes.gohugo.io/.è¿™ä¸ªé“¾æ¥\nå¦‚ä¸‹å°±æ˜¯ä¸€äº›ä¸»é¢˜äº†ï¼š\néšæ„é€‰å–ä¸€ä¸ªä¹‹åç‚¹å‡»Downloadå°±ä¼šè¿›å…¥ä¸»é¢˜çš„githubä»“åº“ï¼Œç„¶åéœ€è¦\næ¯”å¦‚è¿™ä¸ªï¼š\næ‰§è¡Œinstall the theme é‡Œé¢çš„å‘½ä»¤\ngit submodule add git@github.com:MeiK2333/github-style.git themes/github-style ä¸‹è½½çš„ä¸»é¢˜æ’ä»¶å°†ä¼šè¿›å…¥themesç›®å½•é‡Œé¢:\næ¥ç€æ‹·è´exampleSiteç›®å½•ä¸‹é¢çš„content,static,config.tomlåˆ°è‡ªå·±çš„é¡¹ç›®é‡Œé¢è¦†ç›–è‡ªå·±é¡¹ç›®çš„ç›®å½•ã€‚åŒæ—¶è®°å¾—åˆ é™¤hugo.tomlé…ç½®æ–‡ä»¶\nç¬¬ä¸‰æ­¥ï¼Œå‡ ä¸ªé‡è¦çš„å‘½ä»¤ #\rç¬¬ä¸€ä¸ªæ˜¯ï¼šhugo server:ç±»ä¼¼äºnpm run serve/dev å°†ä¼šéƒ¨ç½²é¡¹ç›®ï¼Œè¿™æ—¶å€™è‡ªå·±è®¿é—®\rhttp://127.0.0.1:1313/å°±å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„ç½‘ç«™ ç¬¬äºŒä¸ªæ˜¯ï¼šhugo new æ–‡ä»¶è·¯å¾„+æ–‡ä»¶åç§°.mdåˆ™æ˜¯åˆ›å»ºç¬”è®°ï¼Œhugoå°†ä¼šè‡ªä¸»åˆ›å»ºæ–‡æ¡£ ç¬¬ä¸‰ä¸ªæ˜¯ï¼šhugo ,hugoå°†ä¼šç¼–è¯‘markdownæ–‡ä»¶ä¸ºhtmlæ–‡ä»¶å­˜å‚¨åˆ°publicæ–‡ä»¶å¤¹ä¸‹é¢åŒæ—¶éƒ¨ç½²åˆ°ç½‘ç«™ä¸Š æœ€åä¸€æ­¥ #\rå°†publicæ³¨å†Œä¸ºgitæ ¹ç»‘å®šgithubä¸Šä½ çš„ä»“åº“åŒæ—¶æäº¤æ–‡ä»¶å³å¯ã€‚\næ„Ÿè°¢\n","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E5%BB%BA%E7%AB%99%E7%9B%B8%E5%85%B3/","section":"ç¬”è®°s","summary":"å¦‚ä½•é€šè¿‡Hugoè¿™ä¸ªæ¡†æ¶æ¥æ­å»ºä¸€æ¬¾å±äºè‡ªå·±çš„åšå®¢å‘¢ï¼Ÿ #\rè§‚å‰æé†’ï¼šè¿™ç¯‡ç¬”è®°å€Ÿé‰´äº†ä¸‹é¢ä¸¤ä¸ªä½œè€…ï¼š\nä¸€æ˜¯ï¼š\rå°æ£‰å°¾å·´\näº‹ä»¶å¥‘æœº #\ræˆ‘å…¶å®åŸæœ¬å°±çŸ¥é“githubçš„pagesè‡ªåŠ¨éƒ¨ç½²åšå®¢åŠŸèƒ½ï¼Œå½“æ—¶å¤§äºŒä¸ç†Ÿç»ƒï¼Œä»Šå¤©ç›®ç¹ä¸“ä¸šå¤§ä½¬çš„åšå®¢ï¼Œè‡ªç„¶ä¹Ÿå°±é‡æ–°æèµ·æ¥äº†ã€‚\nå¦‚ä¸‹å°±æ˜¯å¤§ä½¬çš„åšå®¢ï¼ˆè¿™ä¸ªä¸»é¢˜æœ¬æ¥å°è¯•ç”¨ï¼Œåç»­å‘ç°æ¯”è¾ƒèŠ±å“¨å°±ä¸é‡‡ç”¨äº†ï¼‰\næœ¬äººæ­å»ºçš„åšå®¢ï¼š\nç¬¬ä¸€æ­¥ä¸‹è½½HuGoæ¡†æ¶ï¼š #\rä»¥Windowsä¸ºä¾‹ï¼šåªéœ€æ‰“å¼€CMDæ‰§è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤\nwinget install Hugo.Hugo.Extended ç­‰å¾…ä¸‹è½½å®Œæˆé‡å¯Shellå‘½ä»¤çª—å£å³å¯ï¼ŒHugoå°†ä¼šè‡ªåŠ¨é…ç½®ç¯å¢ƒå˜é‡ã€‚\næ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸï¼š\nhugo version ç¬¬äºŒéƒ¨åˆ›å»ºHugoåšå®¢é¡¹ç›® #\råªéœ€è¦åœ¨æ–‡ä»¶å¤¹ä¸‹é¢æ–°å»ºç»ˆç«¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œhugoå°†ä¼šè‡ªåŠ¨åˆ›å»ºä½ çš„é¡¹ç›®åç§°æ–‡ä»¶å¤¹ ï¼ŒåŒæ—¶å¼¹å‡ºä¸€ä¸ªä¸»é¢˜é“¾æ¥\nhugo new site +ä½ çš„é¡¹ç›®åç§° ç°åœ¨ä½ éœ€è¦è¿›å…¥ä½ çš„é¡¹ç›®ä¹Ÿå°±æ˜¯å‘½ä»¤ï¼š cd ä½ çš„é¡¹ç›®åç§°","title":"å¦‚ä½•é€šè¿‡hugoæ­å»ºè‡ªå·±çš„åšå®¢","type":"ç¬”è®°"},{"content":"\rå…ˆæ”¾ä¸€å¼ è·³å¢™æˆåŠŸçš„ç”»é¢ï¼š #\rç§‘å­¦ä¸Šç½‘éš¾å—ï¼Ÿ #\rç»“è®ºï¼šå¾ˆç®€å•ï¼ï¼ï¼\né¦–å…ˆæ˜¯æˆ‘åœ¨é…ç½®ä»£ç†æ—¶å€™å‘ç°çš„å‡ ä¸ªå¥½çš„ç«™ç‚¹ï¼šå¦‚ä¸‹ #\rç§‘å­¦ä¸Šç½‘ä¸»è¦æœ‰ä¸¤ä¸ªä»£ç†æ–¹æ³•ï¼Œä½†å®é™…å†…æ ¸åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼š\nè¿™é‡Œæœ‰å…³äºä¸¤ä¸ªä¸åŒçš„ç¿»å¢™æ–¹æ³•çš„è¯´æ˜é“¾æ¥ #\rç¬¬ä¸€ä¸ªï¼š\nç¬¬äºŒä¸ªï¼š\nå‚è€ƒé“¾æ¥ï¼š\rSSRé…ç½®è¯´æ˜ ssré“¾æ¥æ–¹å¼\nå¦‚ä½•ç¿»å¢™å•Šï¼Œè¯´äº†é‚£ä¹ˆå¤šã€‚ #\rç¬¬ä¸€æ­¥ï¼šä¸‹è½½ #\rä¸‹è½½é“¾æ¥ è“è‰²æ¬¾ï¼ˆä¸æ¨èï¼Œæœ¬æ–‡ä¹Ÿä¸é‡‡ç”¨ï¼‰ï¼š\rShadowsocksR\rç„¶åç‚¹å‡»zipä¸‹è½½å³å¯ã€‚ssçš„å¥½å¤„æ˜¯æ²¡è¢«å¢™ï¼Œå¯ä»¥ç›´æ¥åˆ°gitä¸Šä¸‹è½½ã€‚\nçº¢è‰²æ¬¾ï¼ˆå¼ºçƒˆæ¨èï¼ï¼ï¼ï¼‰ï¼šè¿™é‡Œæˆ‘ç›´æ¥æ”¾ä¸Šzipï¼Œå› ä¸ºå›½å†…æ— æ³•ä¸‹è½½ï¼Œæˆ‘å·²ç»æå‰ç¿»å¢™ä¸‹è½½å¥½å’¯ã€‚ #\rä¸‹å¥½åï¼š #\rå…ˆå¤åˆ¶ä¸‹é¢çš„é“¾æ¥ï¼Œç„¶åç‚¹å‡»ShadowssocksR-dotnet4.0.exeï¼ï¼ï¼ï¼ #\ré¦–å…ˆå‡†å¤‡å¥½ssré“¾æ¥ã€‚è¿™ä¸ªæ–¹æ³•æœ€ç®€å•ã€‚ #\rssr://Y20xLWhrLmh1dGFvbm9kZTIudG9wOjEyNDA1OmF1dGhfYWVzMTI4X3 NoYTE6Y2hhY2hhMjAtaWV0ZjpodHRwX3NpbXBsZTpTSFZVWVc5RGJHOTFaQS8_b 2Jmc3BhcmFtPU16WmhNV0V6TWpVd05TNXRhV055YjNOdlpuUXVZMjl0JnByb3RvcGFyYW0 9TXpJMU1EVTZTSEF6VlVVNE5YTmhWMjl2UjFOTlJnJnJlbWFya3M9NmFhWjVyaXZJQzBnU1VWUVRDQXRJ Rk5UTDFOVFVpQXRJREExJmdyb3VwPTVhU0g1NVNvVVZIdnZKb3pORFF6T1RVMk5qRXk è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç”¨SSR,å½±æ¢­çš„ç²‰çº¢è‰²é£æœºã€‚\nå‡ºç°é£æœºå›¾æ ‡åï¼Œå·¦é”®ç‚¹å‡»å®ƒï¼ï¼ï¼\né€‰æ‹©å‰ªè´´æ¿å¯¼å…¥SSRé“¾æ¥ã€‚\nä»£ç†è§„åˆ™è®¾ç½®ä¸ºå…¨å±€ï¼š #\r#\ré€‰æ‹©PACä¸ºç»•è¿‡å¸¸è§å³å¯ã€‚ #\ræ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«ä¸Šç½‘å•¦ï¼ #\rå¯ä»¥çœ‹åˆ°å·¦ä¸‹è§’IPåœ°å€ä¹Ÿæ˜¯é¦™æ¸¯çš„ #\ræœ€åï¼Œæ³¨æ„å®‰å…¨ï¼Œä¸Šç½‘æ„‰å¿«ï¼ #\r","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/vpn-ssr/","section":"ç¬”è®°s","summary":"å…ˆæ”¾ä¸€å¼ è·³å¢™æˆåŠŸçš„ç”»é¢ï¼š #\rç§‘å­¦ä¸Šç½‘éš¾å—ï¼Ÿ #\rç»“è®ºï¼šå¾ˆç®€å•ï¼ï¼ï¼\né¦–å…ˆæ˜¯æˆ‘åœ¨é…ç½®ä»£ç†æ—¶å€™å‘ç°çš„å‡ ä¸ªå¥½çš„ç«™ç‚¹ï¼šå¦‚ä¸‹ #\rç§‘å­¦ä¸Šç½‘ä¸»è¦æœ‰ä¸¤ä¸ªä»£ç†æ–¹æ³•ï¼Œä½†å®é™…å†…æ ¸åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼š\nè¿™é‡Œæœ‰å…³äºä¸¤ä¸ªä¸åŒçš„ç¿»å¢™æ–¹æ³•çš„è¯´æ˜é“¾æ¥ #\rç¬¬ä¸€ä¸ªï¼š\nç¬¬äºŒä¸ªï¼š\nå‚è€ƒé“¾æ¥ï¼š\rSSRé…ç½®è¯´æ˜ ssré“¾æ¥æ–¹å¼\nå¦‚ä½•ç¿»å¢™å•Šï¼Œè¯´äº†é‚£ä¹ˆå¤šã€‚ #\rç¬¬ä¸€æ­¥ï¼šä¸‹è½½ #\rä¸‹è½½é“¾æ¥ è“è‰²æ¬¾ï¼ˆä¸æ¨èï¼Œæœ¬æ–‡ä¹Ÿä¸é‡‡ç”¨ï¼‰ï¼š\rShadowsocksR\rç„¶åç‚¹å‡»zipä¸‹è½½å³å¯ã€‚ssçš„å¥½å¤„æ˜¯æ²¡è¢«å¢™ï¼Œå¯ä»¥ç›´æ¥åˆ°gitä¸Šä¸‹è½½ã€‚\nçº¢è‰²æ¬¾ï¼ˆå¼ºçƒˆæ¨èï¼ï¼ï¼ï¼‰ï¼šè¿™é‡Œæˆ‘ç›´æ¥æ”¾ä¸Šzipï¼Œå› ä¸ºå›½å†…æ— æ³•ä¸‹è½½ï¼Œæˆ‘å·²ç»æå‰ç¿»å¢™ä¸‹è½½å¥½å’¯ã€‚ #\rä¸‹å¥½åï¼š #\rå…ˆå¤åˆ¶ä¸‹é¢çš„é“¾æ¥ï¼Œç„¶åç‚¹å‡»ShadowssocksR-dotnet4.0.exeï¼ï¼ï¼ï¼ #\ré¦–å…ˆå‡†å¤‡å¥½ssré“¾æ¥ã€‚è¿™ä¸ªæ–¹æ³•æœ€ç®€å•ã€‚ #\rssr://Y20xLWhrLmh1dGFvbm9kZTIudG9wOjEyNDA1OmF1dGhfYWVzMTI4X3 NoYTE6Y2hhY2hhMjAtaWV0ZjpodHRwX3NpbXBsZTpTSFZVWVc5RGJHOTFaQS8_b 2Jmc3BhcmFtPU16WmhNV0V6TWpVd05TNXRhV055YjNOdlpuUXVZMjl0JnByb3RvcGFyYW0 9TXpJMU1EVTZTSEF6VlVVNE5YTmhWMjl2UjFOTlJnJnJlbWFya3M9NmFhWjVyaXZJQzBnU1VWUVRDQXRJ Rk5UTDFOVFVpQXRJREExJmdyb3VwPTVhU0g1NVNvVVZIdnZKb3pORFF6T1RVMk5qRXk è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç”¨SSR,å½±æ¢­çš„ç²‰çº¢è‰²é£æœºã€‚","title":"ç§‘å­¦ä¸Šç½‘","type":"ç¬”è®°"},{"content":"","date":"3 October 2023","externalUrl":null,"permalink":"/tags/java-se/","section":"Tags","summary":"","title":"Java SE","type":"tags"},{"content":"1 ç»¼è¿° åœ¨Javaä¸­å¯¹è±¡ä¸å¯¹è±¡çš„å…³ç³»æ€»ä½“åˆ†ä¸ºå››ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼šä¾èµ–ã€å…³è”ã€èšåˆå’Œç»„åˆã€‚\nï¼ˆ1ï¼‰ä¾èµ–(Dependency)å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´çš„è”æ¥ã€‚ä¾èµ–å…³ç³»è¡¨ç¤ºä¸€ä¸ªç±»ä¾èµ–äºå¦ä¸€ä¸ªç±»çš„å®šä¹‰ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œä¾èµ–å…³ç³»åœ¨Javaè¯­è¨€ä¸­ä½“ç°ä¸ºå±€åŸŸå˜é‡ã€æ–¹æ³•çš„å½¢å‚ï¼Œæˆ–è€…å¯¹é™æ€æ–¹æ³•çš„è°ƒç”¨ã€‚ ï¼ˆ2ï¼‰å…³è”(Associationï¼‰å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´çš„è”æ¥ï¼Œå®ƒä½¿ä¸€ä¸ªç±»çŸ¥é“å¦ä¸€ä¸ªç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚å…³è”å¯ä»¥æ˜¯åŒå‘çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å•å‘çš„ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œå…³è”å…³ç³»ä¸€èˆ¬ä½¿ç”¨æˆå‘˜å˜é‡æ¥å®ç° ï¼ˆ3ï¼‰èšåˆ(Aggregation) å…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯å¼ºçš„å…³è”å…³ç³»ã€‚èšåˆæ˜¯æ•´ä½“å’Œä¸ªä½“ä¹‹é—´çš„å…³ç³» ï¼ˆ4ï¼‰ç»„åˆ(Composition) å…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯æ¯”èšåˆå…³ç³»å¼ºçš„å…³ç³»ã€‚å®ƒè¦æ±‚æ™®é€šçš„èšåˆå…³ç³»ä¸­ä»£è¡¨æ•´ä½“çš„å¯¹è±¡è´Ÿè´£ä»£è¡¨éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»„åˆå…³ç³»æ˜¯ä¸èƒ½å…±äº«çš„\nä¾èµ–ï¼š #\rä¸ªç±»Aä½¿ç”¨åˆ°äº†å¦ä¸€ä¸ªç±»Bï¼Œè€Œè¿™ç§ä½¿ç”¨å…³ç³»æ˜¯å…·æœ‰å¶ç„¶æ€§çš„ã€ä¸´æ—¶æ€§çš„ã€éå¸¸å¼±çš„ï¼Œä½†æ˜¯Bç±»çš„å˜åŒ–ä¼šå½±å“åˆ°A\nå…³è”ï¼š #\rå…³è”æ˜¯ä¸€ç§â€œæ‹¥æœ‰â€çš„å…³ç³»ã€‚è¡¨ç°åœ¨ä»£ç ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªç±»åŒ…å«å¦ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œé€šå¸¸è¡¨ç°ä¸ºè¢«å…³è”ç±»ä»¥ç±»å±æ€§çš„å½¢å¼å‡ºç°åœ¨å…³è”ç±»çš„ç±»å®šä¹‰ä¸­ï¼Œä¹Ÿå¯ä»¥è¡¨ç°ä¸ºå…³è”ç±»å¼•ç”¨äº†ä¸€ä¸ªç±»å‹ä¸ºè¢«å…³è”ç±»çš„å…¨å±€å˜é‡ã€‚å…³è”å¯ä»¥ä½¿å•å‘çš„ï¼Œä¹Ÿå¯ä»¥ä½¿åŒå‘çš„ã€‚ä¾èµ–å’Œå…³è”çš„åŒºåˆ«åœ¨äºä¾èµ–æ˜¯ä½¿ç”¨ï¼Œå…³è”æ˜¯æ‹¥æœ‰.\nèšåˆ #\rèšåˆæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œå®ƒæ˜¯ä¸€ç§å¼ºå…³è”å…³ç³»ï¼ˆhas-aï¼‰;èšåˆå…³ç³»æ˜¯æ•´ä½“å’Œä¸ªä½“/éƒ¨åˆ†ä¹‹é—´çš„å…³ç³»;å…³è”å…³ç³»çš„ä¸¤ä¸ªç±»å¤„äºåŒä¸€ä¸ªå±‚æ¬¡ä¸Š,è€Œèšåˆå…³ç³»çš„ä¸¤ä¸ªç±»å¤„äºä¸åŒçš„å±‚æ¬¡ä¸Š,ä¸€ä¸ªæ˜¯æ•´ä½“,ä¸€ä¸ªæ˜¯ä¸ªä½“/éƒ¨åˆ†;åœ¨èšåˆå…³ç³»ä¸­,ä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡æœ‰å¯èƒ½ä¼šè¢«å¤šä¸ªä»£è¡¨æ•´ä½“çš„å¯¹è±¡æ‰€å…±äº«;è¡¨ç°åœ¨ä»£ç å±‚é¢ä¸Šå°±æ˜¯åœ¨æ„é€ å™¨åˆå§‹åŒ–æ—¶å°†ä¸¤ä¸ªç±»å…³è”èµ·æ¥\nç»„åˆ #\rç»„åˆä¹Ÿæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼ˆis-aï¼‰,ä½†å®ƒæ˜¯æ¯”èšåˆå…³ç³»æ›´å¼ºçš„å…³ç³».ç»„åˆå…³ç³»è¦æ±‚èšåˆå…³ç³»ä¸­ä»£è¡¨æ•´ä½“çš„å¯¹è±¡è¦è´Ÿè´£ä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ;ç»„åˆå…³ç³»ä¸èƒ½å…±äº«;åœ¨ç»„åˆå…³ç³»ä¸­,å¦‚æœä»£è¡¨æ•´ä½“çš„å¯¹è±¡è¢«é”€æ¯æˆ–ç ´å,é‚£ä¹ˆä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡ä¹Ÿä¸€å®šä¼šè¢«é”€æ¯æˆ–ç ´å,è€Œèšåœ¨åˆå…³ç³»ä¸­,ä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡åˆ™æœ‰å¯èƒ½è¢«å¤šä¸ªä»£è¡¨æ•´ä½“çš„å¯¹è±¡æ‰€å…±äº«,è€Œä¸ä¸€å®šä¼šéšç€æŸä¸ªä»£è¡¨æ•´ä½“çš„å¯¹è±¡è¢«é”€æ¯æˆ–ç ´åè€Œè¢«é”€æ¯æˆ–ç ´å;\n","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/javase/object/%E5%AF%B9%E8%B1%A1%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"1 ç»¼è¿° åœ¨Javaä¸­å¯¹è±¡ä¸å¯¹è±¡çš„å…³ç³»æ€»ä½“åˆ†ä¸ºå››ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼šä¾èµ–ã€å…³è”ã€èšåˆå’Œç»„åˆã€‚\nï¼ˆ1ï¼‰ä¾èµ–(Dependency)å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´çš„è”æ¥ã€‚ä¾èµ–å…³ç³»è¡¨ç¤ºä¸€ä¸ªç±»ä¾èµ–äºå¦ä¸€ä¸ªç±»çš„å®šä¹‰ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œä¾èµ–å…³ç³»åœ¨Javaè¯­è¨€ä¸­ä½“ç°ä¸ºå±€åŸŸå˜é‡ã€æ–¹æ³•çš„å½¢å‚ï¼Œæˆ–è€…å¯¹é™æ€æ–¹æ³•çš„è°ƒç”¨ã€‚ ï¼ˆ2ï¼‰å…³è”(Associationï¼‰å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´çš„è”æ¥ï¼Œå®ƒä½¿ä¸€ä¸ªç±»çŸ¥é“å¦ä¸€ä¸ªç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚å…³è”å¯ä»¥æ˜¯åŒå‘çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å•å‘çš„ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œå…³è”å…³ç³»ä¸€èˆ¬ä½¿ç”¨æˆå‘˜å˜é‡æ¥å®ç° ï¼ˆ3ï¼‰èšåˆ(Aggregation) å…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯å¼ºçš„å…³è”å…³ç³»ã€‚èšåˆæ˜¯æ•´ä½“å’Œä¸ªä½“ä¹‹é—´çš„å…³ç³» ï¼ˆ4ï¼‰ç»„åˆ(Composition) å…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯æ¯”èšåˆå…³ç³»å¼ºçš„å…³ç³»ã€‚å®ƒè¦æ±‚æ™®é€šçš„èšåˆå…³ç³»ä¸­ä»£è¡¨æ•´ä½“çš„å¯¹è±¡è´Ÿè´£ä»£è¡¨éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç»„åˆå…³ç³»æ˜¯ä¸èƒ½å…±äº«çš„\nä¾èµ–ï¼š #\rä¸ªç±»Aä½¿ç”¨åˆ°äº†å¦ä¸€ä¸ªç±»Bï¼Œè€Œè¿™ç§ä½¿ç”¨å…³ç³»æ˜¯å…·æœ‰å¶ç„¶æ€§çš„ã€ä¸´æ—¶æ€§çš„ã€éå¸¸å¼±çš„ï¼Œä½†æ˜¯Bç±»çš„å˜åŒ–ä¼šå½±å“åˆ°A\nå…³è”ï¼š #\rå…³è”æ˜¯ä¸€ç§â€œæ‹¥æœ‰â€çš„å…³ç³»ã€‚è¡¨ç°åœ¨ä»£ç ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªç±»åŒ…å«å¦ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œé€šå¸¸è¡¨ç°ä¸ºè¢«å…³è”ç±»ä»¥ç±»å±æ€§çš„å½¢å¼å‡ºç°åœ¨å…³è”ç±»çš„ç±»å®šä¹‰ä¸­ï¼Œä¹Ÿå¯ä»¥è¡¨ç°ä¸ºå…³è”ç±»å¼•ç”¨äº†ä¸€ä¸ªç±»å‹ä¸ºè¢«å…³è”ç±»çš„å…¨å±€å˜é‡ã€‚å…³è”å¯ä»¥ä½¿å•å‘çš„ï¼Œä¹Ÿå¯ä»¥ä½¿åŒå‘çš„ã€‚ä¾èµ–å’Œå…³è”çš„åŒºåˆ«åœ¨äºä¾èµ–æ˜¯ä½¿ç”¨ï¼Œå…³è”æ˜¯æ‹¥æœ‰.\nèšåˆ #\rèšåˆæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œå®ƒæ˜¯ä¸€ç§å¼ºå…³è”å…³ç³»ï¼ˆhas-aï¼‰;èšåˆå…³ç³»æ˜¯æ•´ä½“å’Œä¸ªä½“/éƒ¨åˆ†ä¹‹é—´çš„å…³ç³»;å…³è”å…³ç³»çš„ä¸¤ä¸ªç±»å¤„äºåŒä¸€ä¸ªå±‚æ¬¡ä¸Š,è€Œèšåˆå…³ç³»çš„ä¸¤ä¸ªç±»å¤„äºä¸åŒçš„å±‚æ¬¡ä¸Š,ä¸€ä¸ªæ˜¯æ•´ä½“,ä¸€ä¸ªæ˜¯ä¸ªä½“/éƒ¨åˆ†;åœ¨èšåˆå…³ç³»ä¸­,ä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡æœ‰å¯èƒ½ä¼šè¢«å¤šä¸ªä»£è¡¨æ•´ä½“çš„å¯¹è±¡æ‰€å…±äº«;è¡¨ç°åœ¨ä»£ç å±‚é¢ä¸Šå°±æ˜¯åœ¨æ„é€ å™¨åˆå§‹åŒ–æ—¶å°†ä¸¤ä¸ªç±»å…³è”èµ·æ¥\nç»„åˆ #\rç»„åˆä¹Ÿæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼ˆis-aï¼‰,ä½†å®ƒæ˜¯æ¯”èšåˆå…³ç³»æ›´å¼ºçš„å…³ç³».ç»„åˆå…³ç³»è¦æ±‚èšåˆå…³ç³»ä¸­ä»£è¡¨æ•´ä½“çš„å¯¹è±¡è¦è´Ÿè´£ä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ;ç»„åˆå…³ç³»ä¸èƒ½å…±äº«;åœ¨ç»„åˆå…³ç³»ä¸­,å¦‚æœä»£è¡¨æ•´ä½“çš„å¯¹è±¡è¢«é”€æ¯æˆ–ç ´å,é‚£ä¹ˆä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡ä¹Ÿä¸€å®šä¼šè¢«é”€æ¯æˆ–ç ´å,è€Œèšåœ¨åˆå…³ç³»ä¸­,ä»£è¡¨ä¸ªä½“/éƒ¨åˆ†çš„å¯¹è±¡åˆ™æœ‰å¯èƒ½è¢«å¤šä¸ªä»£è¡¨æ•´ä½“çš„å¯¹è±¡æ‰€å…±äº«,è€Œä¸ä¸€å®šä¼šéšç€æŸä¸ªä»£è¡¨æ•´ä½“çš„å¯¹è±¡è¢«é”€æ¯æˆ–ç ´åè€Œè¢«é”€æ¯æˆ–ç ´å;","title":"å¯¹è±¡é—´çš„å…³ç³»","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"Javaä¸­å¸¸ç”¨çš„å…³é”®å­—æœ‰ä»¥ä¸‹åˆ†ç±»ï¼š è®¿é—®æ§åˆ¶ private protected public\nç±»,æ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦ abstract class extends final implements interface native new static strictfp synchronized transient volatile\nç¨‹åºæ§åˆ¶ break continue return do while if else for instanceof switch case default\nå¼‚å¸¸å¤„ç† try cathc throw throws\nåŒ…ç›¸å…³ import package\nåŸºæœ¬ç±»å‹ boolean byte char double float int long short null true false\nå˜é‡å¼•ç”¨ super this void ä¿ç•™å­— goto const\nè¯¦ç»†è§£é‡Šï¼š\nè®¿é—®æ§åˆ¶ private ç§æœ‰çš„ private å…³é”®å­—æ˜¯è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œå¯ä»¥åº”ç”¨äºç±»ã€æ–¹æ³•æˆ–å­—æ®µï¼ˆåœ¨ç±»ä¸­å£°æ˜çš„å˜é‡ï¼‰ã€‚ åªèƒ½åœ¨å£°æ˜ privateï¼ˆå†…éƒ¨ï¼‰ç±»ã€æ–¹æ³•æˆ–å­—æ®µçš„ç±»ä¸­å¼•ç”¨è¿™äº›ç±»ã€æ–¹æ³•æˆ–å­—æ®µã€‚åœ¨ç±»çš„å¤–éƒ¨æˆ–è€…å¯¹äºå­ç±»è€Œè¨€ï¼Œå®ƒä»¬æ˜¯ä¸å¯è§çš„ã€‚ æ‰€æœ‰ç±»æˆå‘˜çš„é»˜è®¤è®¿é—®èŒƒå›´éƒ½æ˜¯ package è®¿é—®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤éå­˜åœ¨ç‰¹å®šçš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œå¦åˆ™ï¼Œå¯ä»¥ä»åŒä¸€ä¸ªåŒ…ä¸­çš„ä»»ä½•ç±»è®¿é—®ç±»æˆå‘˜ã€‚\nprotected å—ä¿æŠ¤çš„ protected å…³é”®å­—æ˜¯å¯ä»¥åº”ç”¨äºç±»ã€æ–¹æ³•æˆ–å­—æ®µï¼ˆåœ¨ç±»ä¸­å£°æ˜çš„å˜é‡ï¼‰çš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ã€‚å¯ä»¥åœ¨å£°æ˜ protected ç±»ã€æ–¹æ³•æˆ–å­—æ®µçš„ç±»ã€åŒä¸€ä¸ªåŒ…ä¸­çš„å…¶ä»–ä»»ä½•ç±»ä»¥åŠä»»ä½•å­ç±»ï¼ˆæ— è®ºå­ç±»æ˜¯åœ¨å“ªä¸ªåŒ…ä¸­å£°æ˜çš„ï¼‰ä¸­å¼•ç”¨è¿™äº›ç±»ã€æ–¹æ³•æˆ–å­—æ®µã€‚æ‰€æœ‰ç±»æˆå‘˜çš„é»˜è®¤è®¿é—®èŒƒå›´éƒ½æ˜¯ package è®¿é—®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤éå­˜åœ¨ç‰¹å®šçš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œå¦åˆ™ï¼Œå¯ä»¥ä»åŒä¸€ä¸ªåŒ…ä¸­çš„ä»»ä½•ç±»è®¿é—®ç±»æˆå‘˜ã€‚\npublic å…¬å…±çš„ public å…³é”®å­—æ˜¯å¯ä»¥åº”ç”¨äºç±»ã€æ–¹æ³•æˆ–å­—æ®µï¼ˆåœ¨ç±»ä¸­å£°æ˜çš„å˜é‡ï¼‰çš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ã€‚ å¯èƒ½åªä¼šåœ¨å…¶ä»–ä»»ä½•ç±»æˆ–åŒ…ä¸­å¼•ç”¨ public ç±»ã€æ–¹æ³•æˆ–å­—æ®µã€‚æ‰€æœ‰ç±»æˆå‘˜çš„é»˜è®¤è®¿é—®èŒƒå›´éƒ½æ˜¯ package è®¿é—®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤éå­˜åœ¨ç‰¹å®šçš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦ï¼Œå¦åˆ™ï¼Œå¯ä»¥ä»åŒä¸€ä¸ªåŒ…ä¸­çš„ä»»ä½•ç±»è®¿é—®ç±»æˆå‘˜ã€‚\n4ï¼‰æ€»ç»“ è‡ªèº«\tåŒåŒ…å­ç±»\tä¸åŒåŒ…å­ç±»\tåŒåŒ…ç±»\tå…¶ä»–ç±» public\tå¯è®¿é—®\tå¯ç»§æ‰¿\tå¯ç»§æ‰¿\tå¯è®¿é—®\tå¯è®¿é—® protected\tå¯è®¿é—®\tå¯ç»§æ‰¿\tå¯ç»§æ‰¿\tå¯è®¿é—®\tä¸å¯è®¿é—® private\tå¯è®¿é—®\tä¸å¯ç»§æ‰¿\tä¸å¯ç»§æ‰¿\tä¸å¯è®¿é—®\tä¸å¯è®¿é—® defaule(ä¸å†™)\tå¯è®¿é—®\tå¯ç»§æ‰¿\tä¸å¯ç»§æ‰¿\tå¯è®¿é—®\tä¸å¯è®¿é—®\nç±»ã€æ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦ abstract å£°æ˜æŠ½è±¡ abstractå…³é”®å­—å¯ä»¥ä¿®æ”¹ç±»æˆ–æ–¹æ³•ã€‚abstractç±»å¯ä»¥æ‰©å±•ï¼ˆå¢åŠ å­ç±»ï¼‰ï¼Œä½†ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ã€‚abstractæ–¹æ³•ä¸åœ¨å£°æ˜å®ƒçš„ç±»ä¸­å®ç°ï¼Œä½†å¿…é¡»åœ¨æŸä¸ªå­ç±»ä¸­é‡å†™ã€‚é‡‡ç”¨ abstractæ–¹æ³•çš„ç±»æœ¬æ¥å°±æ˜¯æŠ½è±¡ç±»ï¼Œå¹¶ä¸”å¿…é¡»å£°æ˜ä¸ºabstractã€‚\nclassç±» class å…³é”®å­—ç”¨æ¥å£°æ˜æ–°çš„ Java ç±»ï¼Œè¯¥ç±»æ˜¯ç›¸å…³å˜é‡å’Œ/æˆ–æ–¹æ³•çš„é›†åˆã€‚ç±»æ˜¯é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡æ–¹æ³•çš„åŸºæœ¬æ„é€ å•ä½ã€‚ç±»é€šå¸¸ä»£è¡¨æŸç§å®é™…å®ä½“ï¼Œå¦‚å‡ ä½•å½¢çŠ¶æˆ–äººã€‚ç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚è¦ä½¿ç”¨ç±»ï¼Œé€šå¸¸ä½¿ç”¨ new æ“ä½œç¬¦å°†ç±»çš„å¯¹è±¡å®ä¾‹åŒ–ï¼Œç„¶åè°ƒç”¨ç±»çš„æ–¹æ³•æ¥è®¿é—®ç±»çš„åŠŸèƒ½ã€‚\nextends ç»§æ‰¿ã€æ‰©å±• extends å…³é”®å­—ç”¨åœ¨ class æˆ– interface å£°ä¸­ï¼Œç”¨äºæŒ‡ç¤ºæ‰€å£°æ˜çš„ç±»æˆ–æ¥å£æ˜¯å…¶åç§°åè·Ÿæœ‰ extends å…³é”®å­—çš„ç±»æˆ–æ¥å£çš„å­ç±»ã€‚å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰ public å’Œ protected å˜é‡å’Œæ–¹æ³•ã€‚ å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„ä»»ä½•é final æ–¹æ³•ã€‚ä¸€ä¸ªç±»åªèƒ½æ‰©å±•ä¸€ä¸ªå…¶ä»–ç±»ã€‚\nfinal æœ€ç»ˆã€ä¸å¯æ”¹å˜ final å…³é”®å­—å¯ä»¥åº”ç”¨äºç±»ï¼Œä»¥æŒ‡ç¤ºä¸èƒ½æ‰©å±•è¯¥ç±»ï¼ˆä¸èƒ½æœ‰å­ç±»ï¼‰ã€‚final å…³é”®å­—å¯ä»¥åº”ç”¨äºæ–¹æ³•ï¼Œä»¥æŒ‡ç¤ºåœ¨å­ç±»ä¸­ä¸èƒ½é‡å†™æ­¤æ–¹æ³•ã€‚ä¸€ä¸ªç±»ä¸èƒ½åŒæ—¶æ˜¯ abstract åˆæ˜¯ finalã€‚abstract æ„å‘³ç€å¿…é¡»æ‰©å±•ç±»ï¼Œfinal æ„å‘³ç€ä¸èƒ½æ‰©å±•ç±»ã€‚ä¸€ä¸ªæ–¹æ³•ä¸èƒ½åŒæ—¶æ˜¯ abstract åˆæ˜¯ finalã€‚abstract æ„å‘³ç€å¿…é¡»é‡å†™æ–¹æ³•ï¼Œfinal æ„å‘³ç€ä¸èƒ½é‡å†™æ–¹æ³•ã€‚\nimplementså®ç° implements å…³é”®å­—åœ¨ class å£°æ˜ä¸­ä½¿ç”¨ï¼Œä»¥æŒ‡ç¤ºæ‰€å£°æ˜çš„ç±»æä¾›äº†åœ¨ implements å…³é”®å­—åé¢çš„åç§°æ‰€æŒ‡å®šçš„æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚ç±»å¿…é¡»æä¾›åœ¨æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚\ninterface æ¥å£ interface å…³é”®å­—ç”¨æ¥å£°æ˜æ–°çš„ Java æ¥å£ï¼Œæ¥å£æ˜¯æ–¹æ³•çš„é›†åˆã€‚\næ¥å£æ˜¯ Java è¯­è¨€çš„ä¸€é¡¹å¼ºå¤§åŠŸèƒ½ã€‚ä»»ä½•ç±»éƒ½å¯å£°æ˜å®ƒå®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ï¼Œè¿™æ„å‘³ç€å®ƒå®ç°äº†åœ¨è¿™äº›æ¥å£ä¸­æ‰€å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ã€‚\nå®ç°äº†æ¥å£çš„ä»»ä½•ç±»éƒ½å¿…é¡»æä¾›åœ¨è¯¥æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚\nnative æœ¬åœ° native å…³é”®å­—å¯ä»¥åº”ç”¨äºæ–¹æ³•ï¼Œä»¥æŒ‡ç¤ºè¯¥æ–¹æ³•æ˜¯ç”¨ Java ä»¥å¤–çš„è¯­è¨€å®ç°çš„ã€‚\nnew æ–°,åˆ›å»º new å…³é”®å­—ç”¨äºåˆ›å»ºç±»çš„æ–°å®ä¾‹ã€‚\nnew å…³é”®å­—åé¢çš„å‚æ•°å¿…é¡»æ˜¯ç±»åï¼Œå¹¶ä¸”ç±»åçš„åé¢å¿…é¡»æ˜¯ä¸€ç»„æ„é€ æ–¹æ³•å‚æ•°ï¼ˆå¿…é¡»å¸¦æ‹¬å·ï¼‰ã€‚\nå‚æ•°é›†åˆå¿…é¡»ä¸ç±»çš„æ„é€ æ–¹æ³•çš„ç­¾ååŒ¹é…ã€‚\n= å·¦ä¾§çš„å˜é‡çš„ç±»å‹å¿…é¡»ä¸è¦å®ä¾‹åŒ–çš„ç±»æˆ–æ¥å£å…·æœ‰èµ‹å€¼å…¼å®¹å…³ç³»ã€‚\nstatic é™æ€ static å…³é”®å­—å¯ä»¥åº”ç”¨äºå†…éƒ¨ç±»ï¼ˆåœ¨å¦ä¸€ä¸ªç±»ä¸­å®šä¹‰çš„ç±»ï¼‰ã€æ–¹æ³•æˆ–å­—æ®µï¼ˆç±»çš„æˆå‘˜å˜é‡ï¼‰ã€‚ é€šå¸¸ï¼Œstatic å…³é”®å­—æ„å‘³ç€åº”ç”¨å®ƒçš„å®ä½“åœ¨å£°æ˜è¯¥å®ä½“çš„ç±»çš„ä»»ä½•ç‰¹å®šå®ä¾‹å¤–éƒ¨å¯ç”¨ã€‚\nstaticï¼ˆå†…éƒ¨ï¼‰ç±»å¯ä»¥è¢«å…¶ä»–ç±»å®ä¾‹åŒ–å’Œå¼•ç”¨ï¼ˆå³ä½¿å®ƒæ˜¯é¡¶çº§ç±»ï¼‰ã€‚\nstatic å­—æ®µï¼ˆç±»çš„æˆå‘˜å˜é‡ï¼‰åœ¨ç±»çš„æ‰€æœ‰å®ä¾‹ä¸­åªå­˜åœ¨ä¸€æ¬¡ã€‚\nå¯ä»¥ä»ç±»çš„å¤–éƒ¨è°ƒç”¨ static æ–¹æ³•ï¼Œè€Œä¸ç”¨é¦–å…ˆå®ä¾‹åŒ–è¯¥ç±»ã€‚è¿™æ ·çš„å¼•ç”¨å§‹ç»ˆåŒ…æ‹¬ç±»åä½œä¸ºæ–¹æ³•è°ƒç”¨çš„é™å®šç¬¦ã€‚\næ¨¡å¼ï¼špublic final static varName = ; é€šå¸¸ç”¨äºå£°æ˜å¯ä»¥åœ¨ç±»çš„å¤–éƒ¨ä½¿ç”¨çš„ç±»å¸¸é‡ã€‚åœ¨å¼•ç”¨è¿™æ ·çš„ç±»å¸¸é‡æ—¶éœ€è¦ç”¨ç±»ååŠ ä»¥é™å®šã€‚\nstrictfp ä¸¥æ ¼,ç²¾å‡† strictfpçš„æ„æ€æ˜¯FP-strictï¼Œä¹Ÿå°±æ˜¯è¯´ç²¾ç¡®æµ®ç‚¹çš„æ„æ€ã€‚åœ¨Javaè™šæ‹Ÿæœºè¿›è¡Œæµ®ç‚¹è¿ç®—æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šstrictfpå…³é”®å­—æ—¶ï¼ŒJavaçš„ç¼–è¯‘å™¨ä»¥åŠè¿è¡Œç¯å¢ƒåœ¨å¯¹æµ®ç‚¹è¿ç®—çš„è¡¨è¾¾å¼æ˜¯é‡‡å–ä¸€ç§è¿‘ä¼¼äºæˆ‘è¡Œæˆ‘ç´ çš„è¡Œä¸ºæ¥å®Œæˆè¿™äº›æ“ä½œï¼Œä»¥è‡´äºå¾—åˆ°çš„ç»“æœå¾€å¾€æ— æ³•ä»¤äººæ»¡æ„ã€‚è€Œä¸€æ—¦ä½¿ç”¨äº†strictfpæ¥å£°æ˜ä¸€ä¸ªç±»ã€æ¥å£æˆ–è€…æ–¹æ³•æ—¶ï¼Œé‚£ä¹ˆæ‰€å£°æ˜çš„èŒƒå›´å†…Javaçš„ç¼–è¯‘å™¨ä»¥åŠè¿è¡Œç¯å¢ƒä¼šå®Œå…¨ä¾ç…§æµ®ç‚¹è§„èŒƒIEEE-754æ¥æ‰§è¡Œã€‚å› æ­¤å¦‚æœæƒ³è®©æµ®ç‚¹è¿ç®—æ›´åŠ ç²¾ç¡®ï¼Œè€Œä¸”ä¸ä¼šå› ä¸ºä¸åŒçš„ç¡¬ä»¶å¹³å°æ‰€æ‰§è¡Œçš„ç»“æœä¸ä¸€è‡´çš„è¯ï¼Œé‚£å°±è¯·ç”¨å…³é”®å­—strictfpã€‚ å¯ä»¥å°†ä¸€ä¸ªç±»ã€æ¥å£ä»¥åŠæ–¹æ³•å£°æ˜ä¸ºstrictfpï¼Œä½†æ˜¯ä¸å…è®¸å¯¹æ¥å£ä¸­çš„æ–¹æ³•ä»¥åŠæ„é€ å‡½æ•°å£°æ˜strictfpå…³é”®å­—\nsynchronizedçº¿ç¨‹ã€åŒæ­¥ synchronized å…³é”®å­—å¯ä»¥åº”ç”¨äºæ–¹æ³•æˆ–è¯­å¥å—ï¼Œå¹¶ä¸ºä¸€æ¬¡åªåº”ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„å…³é”®ä»£ç æ®µæä¾›ä¿æŠ¤ã€‚ synchronized å…³é”®å­—å¯é˜²æ­¢ä»£ç çš„å…³é”®ä»£ç æ®µä¸€æ¬¡è¢«å¤šä¸ªçº¿ç¨‹æ‰§è¡Œã€‚\nå¦‚æœåº”ç”¨äºé™æ€æ–¹æ³•ï¼Œé‚£ä¹ˆï¼Œå½“è¯¥æ–¹æ³•ä¸€æ¬¡ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œæ•´ä¸ªç±»å°†è¢«é”å®šã€‚\nå¦‚æœåº”ç”¨äºå®ä¾‹æ–¹æ³•ï¼Œé‚£ä¹ˆï¼Œå½“è¯¥æ–¹æ³•ä¸€æ¬¡ç”±ä¸€ä¸ªçº¿ç¨‹è®¿é—®æ—¶ï¼Œè¯¥å®ä¾‹å°†è¢«é”å®šã€‚\nå¦‚æœåº”ç”¨äºå¯¹è±¡æˆ–æ•°ç»„ï¼Œå½“å…³è”çš„ä»£ç å—ä¸€æ¬¡ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå¯¹è±¡æˆ–æ•°ç»„å°†è¢«é”å®šã€‚\ninstanceof å®ä¾‹ instanceof å…³é”®å­—ç”¨æ¥ç¡®å®šå¯¹è±¡æ‰€å±çš„ç±»ã€‚\ntransient çŸ­æš‚ transient å…³é”®å­—å¯ä»¥åº”ç”¨äºç±»çš„æˆå‘˜å˜é‡ï¼Œä»¥ä¾¿æŒ‡å‡ºè¯¥æˆå‘˜å˜é‡ä¸åº”åœ¨åŒ…å«å®ƒçš„ç±»å®ä¾‹å·²åºåˆ—åŒ–æ—¶è¢«åºåˆ—åŒ–ã€‚\nå½“ä¸€ä¸ªå¯¹è±¡è¢«ä¸²è¡ŒåŒ–çš„æ—¶å€™ï¼Œtransientå‹å˜é‡çš„å€¼ä¸åŒ…æ‹¬åœ¨ä¸²è¡ŒåŒ–çš„è¡¨ç¤ºä¸­ï¼Œç„¶è€Œétransientå‹çš„å˜é‡æ˜¯è¢«åŒ…æ‹¬è¿›å»çš„ã€‚\nJavaçš„serializationæä¾›äº†ä¸€ç§æŒä¹…åŒ–å¯¹è±¡å®ä¾‹çš„æœºåˆ¶ã€‚å½“æŒä¹…åŒ–å¯¹è±¡æ—¶ï¼Œå¯èƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡æ•°æ®æˆå‘˜ï¼Œæˆ‘ä»¬ä¸æƒ³ç”¨serializationæœºåˆ¶æ¥ä¿å­˜å®ƒã€‚ä¸ºäº†åœ¨ä¸€ä¸ªç‰¹å®šå¯¹è±¡çš„ä¸€ä¸ªåŸŸä¸Šå…³é—­serializationï¼Œå¯ä»¥åœ¨è¿™ä¸ªåŸŸå‰åŠ ä¸Šå…³é”®å­—transientã€‚ transientæ˜¯Javaè¯­è¨€çš„å…³é”®å­—ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªåŸŸä¸æ˜¯è¯¥å¯¹è±¡ä¸²è¡ŒåŒ–çš„ä¸€éƒ¨åˆ†ã€‚å½“ä¸€ä¸ªå¯¹è±¡è¢«ä¸²è¡ŒåŒ–çš„æ—¶å€™ï¼Œtransientå‹å˜é‡çš„å€¼ä¸åŒ…æ‹¬åœ¨ä¸²è¡ŒåŒ–çš„è¡¨ç¤ºä¸­ï¼Œç„¶è€Œétransientå‹çš„å˜é‡æ˜¯è¢«åŒ…æ‹¬è¿›å»çš„ã€‚\nvolatile æ˜“å¤± volatile å…³é”®å­—ç”¨äºè¡¨ç¤ºå¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å¼‚æ­¥ä¿®æ”¹çš„æˆå‘˜å˜é‡ã€‚ æ³¨æ„ï¼švolatile å…³é”®å­—åœ¨è®¸å¤š Java è™šæ‹Ÿæœºä¸­éƒ½æ²¡æœ‰å®ç°ã€‚ volatile çš„ç›®æ ‡ç”¨é€”æ˜¯ä¸ºäº†ç¡®ä¿æ‰€æœ‰çº¿ç¨‹æ‰€çœ‹åˆ°çš„æŒ‡å®šå˜é‡çš„å€¼éƒ½æ˜¯ç›¸åŒçš„ã€‚\nJava è¯­è¨€ä¸­çš„ volatile å˜é‡å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ç§ â€œç¨‹åº¦è¾ƒè½»çš„ synchronizedâ€ï¼›ä¸ synchronized å—ç›¸æ¯”ï¼Œvolatile å˜é‡æ‰€éœ€çš„ç¼–ç è¾ƒå°‘ï¼Œå¹¶ä¸”è¿è¡Œæ—¶å¼€é”€ä¹Ÿè¾ƒå°‘ï¼Œä½†æ˜¯å®ƒæ‰€èƒ½å®ç°çš„åŠŸèƒ½ä¹Ÿä»…æ˜¯ synchronized çš„ä¸€éƒ¨åˆ†ã€‚\nç¨‹åºæ§åˆ¶è¯­å¥ break è·³å‡ºï¼Œä¸­æ–­ break å…³é”®å­—ç”¨äºæå‰é€€å‡º forã€while æˆ– do å¾ªç¯ï¼Œæˆ–è€…åœ¨ switch è¯­å¥ä¸­ç”¨æ¥ç»“æŸ case å—ã€‚ break æ€»æ˜¯é€€å‡ºæœ€æ·±å±‚çš„ whileã€forã€do æˆ– switch è¯­å¥ã€‚\ncontinue ç»§ç»­ continue å…³é”®å­—ç”¨æ¥è·³è½¬åˆ° forã€while æˆ– do å¾ªç¯çš„ä¸‹ä¸€ä¸ªè¿­ä»£ã€‚ continue æ€»æ˜¯è·³åˆ°æœ€æ·±å±‚ whileã€for æˆ– do è¯­å¥çš„ä¸‹ä¸€ä¸ªè¿­ä»£ã€‚\nreturn è¿”å› return å…³é”®å­—ä¼šå¯¼è‡´æ–¹æ³•è¿”å›åˆ°è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼Œä»è€Œä¼ é€’ä¸è¿”å›æ–¹æ³•çš„è¿”å›ç±»å‹åŒ¹é…çš„å€¼ã€‚ å¦‚æœæ–¹æ³•å…·æœ‰é void çš„è¿”å›ç±»å‹ï¼Œreturn è¯­å¥å¿…é¡»å…·æœ‰ç›¸åŒæˆ–å…¼å®¹ç±»å‹çš„å‚æ•°ã€‚\ndo è¿è¡Œ do å…³é”®å­—ç”¨äºæŒ‡å®šä¸€ä¸ªåœ¨æ¯æ¬¡è¿­ä»£ç»“æŸæ—¶æ£€æŸ¥å…¶æ¡ä»¶çš„å¾ªç¯ã€‚ do å¾ªç¯ä½“è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚\næ¡ä»¶è¡¨è¾¾å¼åé¢å¿…é¡»æœ‰åˆ†å·ã€‚\nwhile å¾ªç¯ while å…³é”®å­—ç”¨äºæŒ‡å®šä¸€ä¸ªåªè¦æ¡ä»¶ä¸ºçœŸå°±ä¼šé‡å¤çš„å¾ªç¯ã€‚\nif å¦‚æœ if å…³é”®å­—æŒ‡ç¤ºæœ‰æ¡ä»¶åœ°æ‰§è¡Œä»£ç å—ã€‚æ¡ä»¶çš„è®¡ç®—ç»“æœå¿…é¡»æ˜¯å¸ƒå°”å€¼ã€‚\nif è¯­å¥å¯ä»¥æœ‰å¯é€‰çš„ else å­å¥ï¼Œè¯¥å­å¥åŒ…å«æ¡ä»¶ä¸º false æ—¶å°†æ‰§è¡Œçš„ä»£ç ã€‚\nåŒ…å« boolean æ“ä½œæ•°çš„è¡¨è¾¾å¼åªèƒ½åŒ…å« boolean æ“ä½œæ•°ã€‚\nelse å¦åˆ™ else å…³é”®å­—æ€»æ˜¯åœ¨ if-else è¯­å¥ä¸­ä¸ if å…³é”®å­—ç»“åˆä½¿ç”¨ã€‚else å­å¥æ˜¯å¯é€‰çš„ï¼Œå¦‚æœ if æ¡ä»¶ä¸º falseï¼Œåˆ™æ‰§è¡Œè¯¥å­å¥ã€‚\nfor å¾ªç¯ for å…³é”®å­—ç”¨äºæŒ‡å®šä¸€ä¸ªåœ¨æ¯æ¬¡è¿­ä»£ç»“æŸå‰æ£€æŸ¥å…¶æ¡ä»¶çš„å¾ªç¯ã€‚\nfor è¯­å¥çš„å½¢å¼ä¸º for(initialize; condition; increment)\næ§ä»¶æµè¿›å…¥ for è¯­å¥æ—¶ï¼Œå°†æ‰§è¡Œä¸€æ¬¡ initialize è¯­å¥ã€‚\næ¯æ¬¡æ‰§è¡Œå¾ªç¯ä½“ä¹‹å‰å°†è®¡ç®— condition çš„ç»“æœã€‚å¦‚æœ condition ä¸º trueï¼Œåˆ™æ‰§è¡Œå¾ªç¯ä½“ã€‚\næ¯æ¬¡æ‰§è¡Œå¾ªç¯ä½“ä¹‹åï¼Œåœ¨è®¡ç®—ä¸‹ä¸€ä¸ªè¿­ä»£çš„ condition ä¹‹å‰ï¼Œå°†æ‰§è¡Œ increment è¯­å¥ã€‚\nswitch è§‚å¯Ÿ switch è¯­å¥ç”¨äºåŸºäºæŸä¸ªè¡¨è¾¾å¼é€‰æ‹©æ‰§è¡Œå¤šä¸ªä»£ç å—ä¸­çš„æŸä¸€ä¸ªã€‚ switch æ¡ä»¶çš„è®¡ç®—ç»“æœå¿…é¡»ç­‰äº byteã€charã€short æˆ– intã€‚\nå¦‚æœæ²¡æœ‰ break è¯­å¥ï¼Œæ‰§è¡Œæµå°†è¿›å…¥æ‰€æœ‰åé¢çš„ case å’Œ/æˆ– default å—ã€‚\ncase è¿”å›è§‚å¯Ÿé‡Œçš„ç»“æœ case ç”¨æ¥æ ‡è®° switch è¯­å¥ä¸­çš„æ¯ä¸ªåˆ†æ”¯ã€‚ case å—æ²¡æœ‰éšå¼ç»“æŸç‚¹ã€‚break è¯­å¥é€šå¸¸åœ¨æ¯ä¸ª case å—æœ«å°¾ä½¿ç”¨ï¼Œç”¨äºé€€å‡º switch è¯­å¥ã€‚\nå¦‚æœæ²¡æœ‰ break è¯­å¥ï¼Œæ‰§è¡Œæµå°†è¿›å…¥æ‰€æœ‰åé¢çš„ case å’Œ/æˆ– default å—ã€‚\ndefault é»˜è®¤ default å…³é”®å­—ç”¨æ¥æ ‡è®° switch è¯­å¥ä¸­çš„é»˜è®¤åˆ†æ”¯ã€‚ default å—æ²¡æœ‰éšå¼ç»“æŸç‚¹ã€‚break è¯­å¥é€šå¸¸åœ¨æ¯ä¸ª case æˆ– default å—çš„æœ«å°¾ä½¿ç”¨ï¼Œä»¥ä¾¿åœ¨å®Œæˆå—æ—¶é€€å‡º switch è¯­å¥ã€‚\nå¦‚æœæ²¡æœ‰ default è¯­å¥ï¼Œå…¶å‚æ•°ä¸ä»»ä½• case å—éƒ½ä¸åŒ¹é…çš„ switch è¯­å¥å°†ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚\né”™è¯¯å¤„ç† try æ•è·å¼‚å¸¸ try å…³é”®å­—ç”¨äºåŒ…å«å¯èƒ½å¼•å‘å¼‚å¸¸çš„è¯­å¥å—ã€‚ æ¯ä¸ª try å—éƒ½å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ª catch æˆ– finally å­å¥ã€‚\nå¦‚æœæŸä¸ªç‰¹å®šå¼‚å¸¸ç±»æœªè¢«ä»»ä½• catch å­å¥å¤„ç†ï¼Œè¯¥å¼‚å¸¸å°†æ²¿ç€è°ƒç”¨æ ˆé€’å½’åœ°ä¼ æ’­åˆ°ä¸‹ä¸€ä¸ªå°é—­ try å—ã€‚å¦‚æœä»»ä½•å°é—­ try å—éƒ½æœªæ•è·åˆ°å¼‚å¸¸ï¼ŒJava è§£é‡Šå™¨å°†é€€å‡ºï¼Œå¹¶æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯å’Œå †æ ˆè·Ÿè¸ªä¿¡æ¯ã€‚\ncatch å¤„ç†å¼‚å¸¸ catch å…³é”®å­—ç”¨æ¥åœ¨ try-catch æˆ– try-catch-finally è¯­å¥ä¸­å®šä¹‰å¼‚å¸¸å¤„ç†å—ã€‚ å¼€å§‹å’Œç»“æŸæ ‡è®° { å’Œ } æ˜¯ catch å­å¥è¯­æ³•çš„ä¸€éƒ¨åˆ†ï¼Œå³ä½¿è¯¥å­å¥åªåŒ…å«ä¸€ä¸ªè¯­å¥ï¼Œä¹Ÿä¸èƒ½çœç•¥è¿™ä¸¤ä¸ªæ ‡è®°ã€‚\næ¯ä¸ª try å—éƒ½å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ª catch æˆ– finally å­å¥ã€‚\nå¦‚æœæŸä¸ªç‰¹å®šå¼‚å¸¸ç±»æœªè¢«ä»»ä½• catch å­å¥å¤„ç†ï¼Œè¯¥å¼‚å¸¸å°†æ²¿ç€è°ƒç”¨æ ˆé€’å½’åœ°ä¼ æ’­åˆ°ä¸‹ä¸€ä¸ªå°é—­ try å—ã€‚å¦‚æœä»»ä½•å°é—­ try å—éƒ½æœªæ•è·åˆ°å¼‚å¸¸ï¼ŒJava è§£é‡Šå™¨å°†é€€å‡ºï¼Œå¹¶æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯å’Œå †æ ˆè·Ÿè¸ªä¿¡æ¯ã€‚\nthrow æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ throw å…³é”®å­—ç”¨äºå¼•å‘å¼‚å¸¸ã€‚ throw è¯­å¥å°† java.lang.Throwable ä½œä¸ºå‚æ•°ã€‚Throwable åœ¨è°ƒç”¨æ ˆä¸­å‘ä¸Šä¼ æ’­ï¼Œç›´åˆ°è¢«é€‚å½“çš„ catch å—æ•è·ã€‚\nthrows å£°æ˜ä¸€ä¸ªå¼‚å¸¸å¯èƒ½è¢«æŠ›å‡º throws å…³é”®å­—å¯ä»¥åº”ç”¨äºæ–¹æ³•ï¼Œä»¥ä¾¿æŒ‡å‡ºæ–¹æ³•å¼•å‘äº†ç‰¹å®šç±»å‹çš„å¼‚å¸¸ã€‚ throws å…³é”®å­—å°†é€—å·åˆ†éš”çš„ java.lang.Throwables åˆ—è¡¨ä½œä¸ºå‚æ•°ã€‚\nå¼•å‘é RuntimeException å¼‚å¸¸çš„ä»»ä½•æ–¹æ³•è¿˜å¿…é¡»åœ¨æ–¹æ³•å£°æ˜ä¸­ä½¿ç”¨ throws ä¿®é¥°ç¬¦æ¥å£°æ˜å®ƒå¼•å‘çš„å¼‚å¸¸ã€‚\nè¦åœ¨ try-catch å—ä¸­åŒ…å«å¸¦ throws å­å¥çš„æ–¹æ³•çš„è°ƒç”¨ï¼Œå¿…é¡»æä¾›è¯¥æ–¹æ³•çš„è°ƒç”¨è€…ã€‚\nfinallyå¼‚å¸¸å¤„ç†è¡¥å…… ä¸ç®¡æœ‰æ— å¼‚å¸¸å‘ç”Ÿï¼Œfinallyå—ä¸­çš„ä»£ç æ€»ä¼šæ‰§è¡Œ åŒ…ç›¸å…³ import å¼•å…¥ import å…³é”®å­—ä½¿ä¸€ä¸ªåŒ…ä¸­çš„ä¸€ä¸ªæˆ–æ‰€æœ‰ç±»åœ¨å½“å‰ Java æºæ–‡ä»¶ä¸­å¯è§ã€‚å¯ä»¥ä¸ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»åæ¥å¼•ç”¨å¯¼å…¥çš„ç±»ã€‚ å½“å¤šä¸ªåŒ…åŒ…å«åŒåçš„ç±»æ—¶ï¼Œè®¸å¤š Java ç¨‹åºå‘˜åªä½¿ç”¨ç‰¹å®šçš„ import è¯­å¥ï¼ˆæ²¡æœ‰â€œ*â€ï¼‰æ¥é¿å…ä¸ç¡®å®šæ€§ã€‚\npackage åŒ… package å…³é”®å­—æŒ‡å®šåœ¨ Java æºæ–‡ä»¶ä¸­å£°æ˜çš„ç±»æ‰€é©»ç•™çš„ Java åŒ…ã€‚ package è¯­å¥ï¼ˆå¦‚æœå‡ºç°ï¼‰å¿…é¡»æ˜¯ Java æºæ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªéæ³¨é‡Šæ€§æ–‡æœ¬ã€‚\nä¾‹:java.lang.Objectã€‚\nå¦‚æœ Java æºæ–‡ä»¶ä¸åŒ…å« package è¯­å¥ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­å®šä¹‰çš„ç±»å°†ä½äºâ€œé»˜è®¤åŒ…â€ä¸­ã€‚è¯·æ³¨æ„ï¼Œä¸èƒ½ä»éé»˜è®¤åŒ…ä¸­çš„ç±»å¼•ç”¨é»˜è®¤åŒ…ä¸­çš„ç±»ã€‚\nåŸºæœ¬ç±»å‹ boolean å¸ƒå°”å‹ boolean æ˜¯ Java åŸå§‹ç±»å‹ã€‚boolean å˜é‡çš„å€¼å¯ä»¥æ˜¯ true æˆ– falseã€‚ boolean å˜é‡åªèƒ½ä»¥ true æˆ– false ä½œä¸ºå€¼ã€‚boolean ä¸èƒ½ä¸æ•°å­—ç±»å‹ç›¸äº’è½¬æ¢ã€‚\nåŒ…å« boolean æ“ä½œæ•°çš„è¡¨è¾¾å¼åªèƒ½åŒ…å« boolean æ“ä½œæ•°ã€‚\nBoolean ç±»æ˜¯ boolean åŸå§‹ç±»å‹çš„åŒ…è£…å¯¹è±¡ç±»ã€‚\nbyte å­—èŠ‚å‹ byte æ˜¯ Java åŸå§‹ç±»å‹ã€‚byte å¯å­˜å‚¨åœ¨ [-128, 127] èŒƒå›´ä»¥å†…çš„æ•´æ•°å€¼ã€‚ Byte ç±»æ˜¯ byte åŸå§‹ç±»å‹çš„åŒ…è£…å¯¹è±¡ç±»ã€‚å®ƒå®šä¹‰ä»£è¡¨æ­¤ç±»å‹çš„å€¼çš„èŒƒå›´çš„ MIN_VALUE å’Œ MAX_VALUE å¸¸é‡ã€‚\nJava ä¸­çš„æ‰€æœ‰æ•´æ•°å€¼éƒ½æ˜¯ 32 ä½çš„ int å€¼ï¼Œé™¤éå€¼åé¢æœ‰ l æˆ– Lï¼ˆå¦‚ 235Lï¼‰ï¼Œè¿™è¡¨ç¤ºè¯¥å€¼åº”è§£é‡Šä¸º longã€‚\nchar å­—ç¬¦å‹ char æ˜¯ Java åŸå§‹ç±»å‹ã€‚char å˜é‡å¯ä»¥å­˜å‚¨ä¸€ä¸ª Unicode å­—ç¬¦ã€‚ å¯ä»¥ä½¿ç”¨ä¸‹åˆ— char å¸¸é‡ï¼š\\b - ç©ºæ ¼, \\f - æ¢é¡µ, \\n - æ¢è¡Œ, \\r - å›è½¦, \\t - æ°´å¹³åˆ¶è¡¨ç¬¦, â€™ - å•å¼•å·, \u0026quot; - åŒå¼•å·, \\ - åæ–œæ , \\xxx - é‡‡ç”¨ xxx ç¼–ç çš„ Latin-1 å­—ç¬¦ã€‚\\x å’Œ \\xx å‡ä¸ºåˆæ³•å½¢å¼ï¼Œä½†å¯èƒ½å¼•èµ·æ··æ·†ã€‚ \\uxxxx - é‡‡ç”¨åå…­è¿›åˆ¶ç¼–ç  xxxx çš„ Unicode å­—ç¬¦ã€‚\nCharacter ç±»åŒ…å«ä¸€äº›å¯ç”¨æ¥å¤„ç† char å˜é‡çš„ static æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•åŒ…æ‹¬ isDigit()ã€isLetter()ã€isWhitespace() å’Œ toUpperCase()ã€‚\nchar å€¼æ²¡æœ‰ç¬¦å·ã€‚\ndouble åŒç²¾åº¦ double æ˜¯ Java åŸå§‹ç±»å‹ã€‚double å˜é‡å¯ä»¥å­˜å‚¨åŒç²¾åº¦æµ®ç‚¹å€¼ã€‚ ç”±äºæµ®ç‚¹æ•°æ®ç±»å‹æ˜¯å®é™…æ•°å€¼çš„è¿‘ä¼¼å€¼ï¼Œå› æ­¤ï¼Œä¸€èˆ¬ä¸è¦å¯¹æµ®ç‚¹æ•°å€¼è¿›è¡Œæ˜¯å¦ç›¸ç­‰çš„æ¯”è¾ƒã€‚\nJava æµ®ç‚¹æ•°å€¼å¯ä»£è¡¨æ— ç©·å¤§å’Œ NaNï¼ˆéæ•°å€¼ï¼‰ã€‚Double åŒ…è£…å¯¹è±¡ç±»ç”¨æ¥å®šä¹‰å¸¸é‡ MIN_VALUEã€MAX_VALUEã€NEGATIVE_INFINITYã€POSITIVE_INFINITY å’Œ NaNã€‚\nfloat æµ®ç‚¹ float æ˜¯ Java åŸå§‹ç±»å‹ã€‚float å˜é‡å¯ä»¥å­˜å‚¨å•ç²¾åº¦æµ®ç‚¹å€¼ã€‚ ä½¿ç”¨æ­¤å…³é”®å­—æ—¶åº”éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š\nJava ä¸­çš„æµ®ç‚¹æ–‡å­—å§‹ç»ˆé»˜è®¤ä¸ºåŒç²¾åº¦ã€‚è¦æŒ‡å®šå•ç²¾åº¦æ–‡å­—å€¼ï¼Œåº”åœ¨æ•°å€¼ååŠ ä¸Š f æˆ– Fï¼Œå¦‚ 0.01fã€‚\nç”±äºæµ®ç‚¹æ•°æ®ç±»å‹æ˜¯å®é™…æ•°å€¼çš„è¿‘ä¼¼å€¼ï¼Œå› æ­¤ï¼Œä¸€èˆ¬ä¸è¦å¯¹æµ®ç‚¹æ•°å€¼è¿›è¡Œæ˜¯å¦ç›¸ç­‰çš„æ¯”è¾ƒã€‚\nJava æµ®ç‚¹æ•°å€¼å¯ä»£è¡¨æ— ç©·å¤§å’Œ NaNï¼ˆéæ•°å€¼ï¼‰ã€‚Float åŒ…è£…å¯¹è±¡ç±»ç”¨æ¥å®šä¹‰å¸¸é‡ MIN_VALUEã€MAX_VALUEã€NEGATIVE_INFINITYã€POSITIVE_INFINITY å’Œ NaNã€‚\nint æ•´å‹ int æ˜¯ Java åŸå§‹ç±»å‹ã€‚int å˜é‡å¯ä»¥å­˜å‚¨ 32 ä½çš„æ•´æ•°å€¼ã€‚ Integer ç±»æ˜¯ int åŸå§‹ç±»å‹çš„åŒ…è£…å¯¹è±¡ç±»ã€‚å®ƒå®šä¹‰ä»£è¡¨æ­¤ç±»å‹çš„å€¼çš„èŒƒå›´çš„ MIN_VALUE å’Œ MAX_VALUE å¸¸é‡ã€‚\nJava ä¸­çš„æ‰€æœ‰æ•´æ•°å€¼éƒ½æ˜¯ 32 ä½çš„ int å€¼ï¼Œé™¤éå€¼åé¢æœ‰ l æˆ– Lï¼ˆå¦‚ 235Lï¼‰ï¼Œè¿™è¡¨ç¤ºè¯¥å€¼åº”è§£é‡Šä¸º longã€‚\nlong é•¿æ•´å‹ long æ˜¯ Java åŸå§‹ç±»å‹ã€‚long å˜é‡å¯ä»¥å­˜å‚¨ 64 ä½çš„å¸¦ç¬¦å·æ•´æ•°ã€‚ Long ç±»æ˜¯ long åŸå§‹ç±»å‹çš„åŒ…è£…å¯¹è±¡ç±»ã€‚å®ƒå®šä¹‰ä»£è¡¨æ­¤ç±»å‹çš„å€¼çš„èŒƒå›´çš„ MIN_VALUE å’Œ MAX_VALUE å¸¸é‡ã€‚\nJava ä¸­çš„æ‰€æœ‰æ•´æ•°å€¼éƒ½æ˜¯ 32 ä½çš„ int å€¼ï¼Œé™¤éå€¼åé¢æœ‰ l æˆ– Lï¼ˆå¦‚ 235Lï¼‰ï¼Œè¿™è¡¨ç¤ºè¯¥å€¼åº”è§£é‡Šä¸º longã€‚\nshort çŸ­æ•´å‹ short æ˜¯ Java åŸå§‹ç±»å‹ã€‚short å˜é‡å¯ä»¥å­˜å‚¨ 16 ä½å¸¦ç¬¦å·çš„æ•´æ•°ã€‚ Short ç±»æ˜¯ short åŸå§‹ç±»å‹çš„åŒ…è£…å¯¹è±¡ç±»ã€‚å®ƒå®šä¹‰ä»£è¡¨æ­¤ç±»å‹çš„å€¼çš„èŒƒå›´çš„ MIN_VALUE å’Œ MAX_VALUE å¸¸é‡ã€‚\nJava ä¸­çš„æ‰€æœ‰æ•´æ•°å€¼éƒ½æ˜¯ 32 ä½çš„ int å€¼ï¼Œé™¤éå€¼åé¢æœ‰ l æˆ– Lï¼ˆå¦‚ 235Lï¼‰ï¼Œè¿™è¡¨ç¤ºè¯¥å€¼åº”è§£é‡Šä¸º longã€‚\nnull ç©º null æ˜¯ Java çš„ä¿ç•™å­—ï¼Œè¡¨ç¤ºæ— å€¼ã€‚ å°† null èµ‹ç»™éåŸå§‹å˜é‡ç›¸å½“äºé‡Šæ”¾è¯¥å˜é‡å…ˆå‰æ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚\nä¸èƒ½å°† null èµ‹ç»™åŸå§‹ç±»å‹ï¼ˆbyteã€shortã€intã€longã€charã€floatã€doubleã€booleanï¼‰å˜é‡ã€‚\ntrue çœŸ true å…³é”®å­—è¡¨ç¤º boolean å˜é‡çš„ä¸¤ä¸ªåˆæ³•å€¼ä¸­çš„ä¸€ä¸ªã€‚\nfalse å‡ false å…³é”®å­—ä»£è¡¨ boolean å˜é‡çš„ä¸¤ä¸ªåˆæ³•å€¼ä¹‹ä¸€ã€‚\nåŸºæœ¬æ•°æ®ç±»å‹æ€»ç»“ å…³äºJavaæ•°æ®ç±»å‹ï¼Œæˆ‘ä¹Ÿä¸“é—¨å†™è¿‡ä¸€ç¯‡æ€»ç»“æ€§åšå®¢ï¼šJavaæ•°æ®ç±»å‹\nå˜é‡å¼•ç”¨ super çˆ¶ç±»,è¶…ç±» super å…³é”®å­—ç”¨äºå¼•ç”¨ä½¿ç”¨è¯¥å…³é”®å­—çš„ç±»çš„è¶…ç±»ã€‚ ä½œä¸ºç‹¬ç«‹è¯­å¥å‡ºç°çš„ super è¡¨ç¤ºè°ƒç”¨è¶…ç±»çš„æ„é€ æ–¹æ³•ã€‚\nsuper.\u0026lt; methodName \u0026gt;() è¡¨ç¤ºè°ƒç”¨è¶…ç±»çš„æ–¹æ³•ã€‚åªæœ‰åœ¨å¦‚ä¸‹æƒ…å†µä¸­æ‰éœ€è¦é‡‡ç”¨è¿™ç§ç”¨æ³•ï¼šè¦è°ƒç”¨åœ¨è¯¥ç±»ä¸­è¢«é‡å†™çš„æ–¹æ³•ï¼Œä»¥ä¾¿æŒ‡å®šåº”å½“è°ƒç”¨åœ¨è¶…ç±»ä¸­çš„è¯¥æ–¹æ³•ã€‚\nthis æœ¬ç±» this å…³é”®å­—ç”¨äºå¼•ç”¨å½“å‰å®ä¾‹ã€‚ å½“å¼•ç”¨å¯èƒ½ä¸æ˜ç¡®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ this å…³é”®å­—æ¥å¼•ç”¨å½“å‰çš„å®ä¾‹ã€‚\nvoid æ— è¿”å›å€¼ void å…³é”®å­—è¡¨ç¤º null ç±»å‹ã€‚ void å¯ä»¥ç”¨ä½œæ–¹æ³•çš„è¿”å›ç±»å‹ï¼Œä»¥æŒ‡ç¤ºè¯¥æ–¹æ³•ä¸è¿”å›å€¼ã€‚\nä¿ç•™å­— æ­£ç¡®è¯†åˆ«javaè¯­è¨€çš„å…³é”®å­—ï¼ˆkeywordï¼‰å’Œä¿ç•™å­—ï¼ˆreserved wordï¼‰æ˜¯ååˆ†é‡è¦çš„ã€‚Javaçš„å…³é”®å­—å¯¹javaçš„ç¼–è¯‘å™¨æœ‰ç‰¹æ®Šçš„æ„ä¹‰ï¼Œä»–ä»¬ç”¨æ¥è¡¨ç¤ºä¸€ç§æ•°æ®ç±»å‹ï¼Œæˆ–è€…è¡¨ç¤ºç¨‹åºçš„ç»“æ„ç­‰ã€‚ä¿ç•™å­—æ˜¯ä¸ºjavaé¢„ç•™çš„å…³é”®å­—ï¼Œä»–ä»¬è™½ç„¶ç°åœ¨æ²¡æœ‰ä½œä¸ºå…³é”®å­—ï¼Œä½†åœ¨ä»¥åçš„å‡çº§ç‰ˆæœ¬ä¸­æœ‰å¯èƒ½ä½œä¸ºå…³é”®å­—ã€‚ è¯†åˆ«javaè¯­è¨€çš„å…³é”®å­—ï¼Œä¸è¦å’Œå…¶ä»–è¯­è¨€å¦‚c/c++çš„å…³é”®å­—æ··æ·†ã€‚ constå’Œgotoæ˜¯javaçš„ä¿ç•™å­—ã€‚ æ‰€æœ‰çš„å…³é”®å­—éƒ½æ˜¯å°å†™\ngoto è·³è½¬ goto ä¿ç•™å…³é”®å­—ï¼Œä½†æ— ä»»ä½•ä½œç”¨ã€‚ç»“æ„åŒ–ç¨‹åºè®¾è®¡å®Œå…¨ä¸éœ€è¦ goto è¯­å¥å³å¯å®Œæˆå„ç§æµç¨‹ï¼Œè€Œ goto è¯­å¥çš„ä½¿ç”¨å¾€å¾€ä¼šä½¿ç¨‹åºçš„å¯è¯»æ€§é™ä½ï¼Œæ‰€ä»¥ Java ä¸å…è®¸ goto è·³è½¬ã€‚\nconst é™æ€ const ä¿ç•™å­—ï¼Œæ˜¯ä¸€ä¸ªç±»å‹ä¿®é¥°ç¬¦ï¼Œä½¿ç”¨constå£°æ˜çš„å¯¹è±¡ä¸èƒ½æ›´æ–°ã€‚ä¸finalæŸäº›ç±»ä¼¼ã€‚\nnative æœ¬åœ° Javaä¸æ˜¯å®Œç¾çš„ï¼ŒJavaçš„ä¸è¶³é™¤äº†ä½“ç°åœ¨è¿è¡Œé€Ÿåº¦ä¸Šè¦æ¯”ä¼ ç»Ÿçš„C++æ…¢è®¸å¤šä¹‹å¤–ï¼ŒJavaæ— æ³•ç›´æ¥è®¿é—®åˆ°æ“ä½œç³»ç»Ÿåº•å±‚ï¼ˆå¦‚ç³»ç»Ÿç¡¬ä»¶ç­‰)ï¼Œä¸ºæ­¤Javaä½¿ç”¨nativeæ–¹æ³•æ¥æ‰©å±•Javaç¨‹åºçš„åŠŸèƒ½ã€‚\nå¯ä»¥å°†nativeæ–¹æ³•æ¯”ä½œJavaç¨‹åºåŒï¼£ç¨‹åºçš„æ¥å£ï¼Œå…¶å®ç°æ­¥éª¤ï¼š\nï¼‘ã€åœ¨Javaä¸­å£°æ˜native()æ–¹æ³•ï¼Œç„¶åç¼–è¯‘ï¼›\nï¼’ã€ç”¨javahäº§ç”Ÿä¸€ä¸ª.hæ–‡ä»¶ï¼›\nï¼“ã€å†™ä¸€ä¸ª.cppæ–‡ä»¶å®ç°nativeå¯¼å‡ºæ–¹æ³•ï¼Œå…¶ä¸­éœ€è¦åŒ…å«ç¬¬äºŒæ­¥äº§ç”Ÿçš„.hæ–‡ä»¶ï¼ˆæ³¨æ„å…¶ä¸­åˆåŒ…å«äº†JDKå¸¦çš„jni.hæ–‡ä»¶ï¼‰ï¼›\nï¼”ã€å°†ç¬¬ä¸‰æ­¥çš„.cppæ–‡ä»¶ç¼–è¯‘æˆåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼›\nï¼•ã€åœ¨Javaä¸­ç”¨System.loadLibrary()æ–¹æ³•åŠ è½½ç¬¬å››æ­¥äº§ç”Ÿçš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œè¿™ä¸ªnative()æ–¹æ³•å°±å¯ä»¥åœ¨Javaä¸­è¢«è®¿é—®äº†ã€‚\n","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/javase/words/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"Javaä¸­å¸¸ç”¨çš„å…³é”®å­—æœ‰ä»¥ä¸‹åˆ†ç±»ï¼š è®¿é—®æ§åˆ¶ private protected public\nç±»,æ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦ abstract class extends final implements interface native new static strictfp synchronized transient volatile\nç¨‹åºæ§åˆ¶ break continue return do while if else for instanceof switch case default","title":"å…³é”®å­—","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\rå¦‚ä½•ä» Java ä¸­çš„ LinkedList ç±»å¤–éƒ¨å£°æ˜ Node ç±»å‹ï¼Ÿ #\ræ ‡ç­¾ java linked-list å¦‚ä½•å£°æ˜ Node ç±»å‹çš„å˜é‡ï¼Ÿ Nodeæ˜¯LinkedListçš„å†…éƒ¨ç±»ï¼Œåœ¨æˆ‘æ­£åœ¨ç¼–å†™çš„ç¨‹åºçš„mainæ–¹æ³•ä¸­ï¼Œæˆ‘æƒ³åˆ›å»ºä¸€ä¸ªNodeå˜é‡ã€‚ä½†åœ¨ä¸‹é¢ä»£ç ç‰‡æ®µçš„æœ€åä¸€è¡Œä¸­ï¼Œæˆ‘æ”¶åˆ°é”™è¯¯æ¶ˆæ¯â€œNose åœ¨ LinkedList ä¸­å…·æœ‰ç§æœ‰(private)è®¿é—®æƒé™â€ã€‚ä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½ä½¿ç”¨ Node ç±»å‹ï¼Ÿ\nimport java.util.LinkedList; public class MinSplit { public static long leastAmount; public static void main(String args[]) { LinkedList list = new LinkedList(); LinkedList.Node node = new LinkedList.Node(); æœ€ä½³ç­”æ¡ˆ å› ä¸ºå®ƒè¢«å£°æ˜ä¸ºç§æœ‰(private)ã€‚å®ƒæ˜¯ LinkedList ç±»çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œæ‚¨æ²¡æœ‰ç†ç”±åˆ›å»ºå®ä¾‹ã€‚æ˜¾ç„¶ï¼Œè¿™æ˜¯ Java å›¢é˜Ÿç»è¿‡æ·±æ€ç†Ÿè™‘çš„è®¾è®¡å†³å®šï¼Œæ—¨åœ¨ä¿æŒ API çš„æ•´æ´å¹¶é¿å…ç”±äºäººä»¬ç ´ååˆ—è¡¨æ•°æ®ç»“æ„è€Œå¯¼è‡´çš„é—®é¢˜ã€‚ å¦‚æœæ‚¨æƒ³è¦å®ä¾‹åŒ– Node ç±»ä»¥ä¾¿å¯ä»¥å¯¹ LinkedList æ‰§è¡ŒæŸç§æ“ä½œï¼Œè¯·å†è€ƒè™‘ä¸€ä¸‹ã€‚æ²¡æœ‰ä»»ä½•å…¬å…±(public) API ä»¥å…è®¸æ‚¨å°† Node æ·»åŠ åˆ° LinkedList æˆ–ä½¿ç”¨å®ƒçš„æ–¹å¼å…¬å¼€ Node ç±»å‹ä»»ä½•å…¶ä»–æ–¹å¼ã€‚æ‚¨å¯èƒ½éœ€è¦ä»å¤´å¼€å§‹å®ç°æ‚¨è‡ªå·±çš„é“¾è¡¨ç±»ã€‚ å¦‚æœæ‚¨å¸Œæœ›å°† Node ç±»ç”¨äºå…¶ä»–ç›®çš„ï¼Œæ‚¨åº”è¯¥å£°æ˜ä¸€ä¸ªæ–°ç±»æˆ–åœ¨ç¬¬ 3 æ–¹åº“ä¸­æŸ¥æ‰¾åˆé€‚çš„ç±»ã€‚\nä»LinkedListçš„æºç ä¸­å¯çœ‹å‡ºï¼ŒNodeæ˜¯LinkedListï¼ˆåŒå‘é“¾è¡¨ï¼‰çš„ç§æœ‰åŒ–å†…éƒ¨ç±»ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ï¼Œæ›´ä¸å¯èƒ½è¢«å®ä¾‹åŒ– #\rå…·ä½“å‚è€ƒ\n","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/javase/node/%E5%AE%9E%E4%BE%8B%E5%8C%96node/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"å¦‚ä½•ä» Java ä¸­çš„ LinkedList ç±»å¤–éƒ¨å£°æ˜ Node ç±»å‹ï¼Ÿ #\ræ ‡ç­¾ java linked-list å¦‚ä½•å£°æ˜ Node ç±»å‹çš„å˜é‡ï¼Ÿ Nodeæ˜¯LinkedListçš„å†…éƒ¨ç±»ï¼Œåœ¨æˆ‘æ­£åœ¨ç¼–å†™çš„ç¨‹åºçš„mainæ–¹æ³•ä¸­ï¼Œæˆ‘æƒ³åˆ›å»ºä¸€ä¸ªNodeå˜é‡ã€‚ä½†åœ¨ä¸‹é¢ä»£ç ç‰‡æ®µçš„æœ€åä¸€è¡Œä¸­ï¼Œæˆ‘æ”¶åˆ°é”™è¯¯æ¶ˆæ¯â€œNose åœ¨ LinkedList ä¸­å…·æœ‰ç§æœ‰(private)è®¿é—®æƒé™â€ã€‚ä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½ä½¿ç”¨ Node ç±»å‹ï¼Ÿ\nimport java.util.LinkedList; public class MinSplit { public static long leastAmount; public static void main(String args[]) { LinkedList list = new LinkedList(); LinkedList.","title":"å®ä¾‹åŒ–Node","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\ræ•°ç»„ï¼š #\r1 public class Demo1_Array { 2 public static void main(String[] args) { 3 String [] array=new String[5];//éœ€è¦åˆå§‹åŒ–é•¿åº¦ 4 array[0]=\u0026#34;hello\u0026#34;; 5 array[1]=\u0026#34;world\u0026#34;; 6 array[4]=\u0026#34;Mufasa\u0026#34;; 7 // array[5]=\u0026#34;right or not\u0026#34;;//ArrayIndexOutOfBoundsException 8 for(String str:array){ 9 System.out.print(str+\u0026#34;ã€\u0026#34;);//helloã€worldã€nullã€nullã€Mufasaã€ 10 } 11 } 12 } 1 public class Demo1_Array2 { 2 public static void main(String[] args) { 3 String [] array={\u0026#34;hello\u0026#34;,\u0026#34;world\u0026#34;,null,null,\u0026#34;Mufasa\u0026#34;};//å®ä¾‹åŒ–\u0026amp;èµ‹å€¼ 4 array = (String[])resizeArray(array,10); 5 for(String str:array){ 6 System.out.print(str+\u0026#34;ã€\u0026#34;);//helloã€worldã€nullã€nullã€Mufasaã€ 7 } 8 } 9 10 private static Object resizeArray(Object oldArray, int newSize) {//æ•°ç»„æ‰©å®¹ï¼ï¼ï¼çœŸéº»çƒ¦ï¼Œè¿˜åˆ©ç”¨åå°„æœºåˆ¶æ¥å®ç° 11 int oldSize = java.lang.reflect.Array.getLength(oldArray);//è·å–æ—§æ•°ç»„é•¿åº¦,å‘ä¸Šè½¬å‹ï¼ï¼ï¼ 12 // int oldSize =oldArray.length;//æ— æ³•åœ¨æ­¤ä½¿ç”¨ï¼Œå› ä¸ºarrayå†…å®¹çš„æ˜¯ä¸å®šç±»å‹ 13 Class elementType = oldArray.getClass().getComponentType();//è·å–å¯¹è±¡ç±»åˆ« 14 Object newArray = java.lang.reflect.Array.newInstance(elementType,newSize);//åˆ©ç”¨Javaçš„åå°„æœºåˆ¶å®ä¾‹åŒ–æ–°æ•°ç»„ 15 int preserveLength = Math.min(oldSize, newSize);//åˆ¤æ–­æ˜¯å¦éœ€è¦copyæ•°æ® 16 if (preserveLength \u0026gt; 0) 17 System.arraycopy(oldArray, 0, newArray, 0, preserveLength); 18 return newArray;//oldArrayåˆ‡æ–­ç´¢å¼•æˆä¸ºåƒåœ¾ç”±Runtime.getRuntime().gc();å›æ”¶å¤„ç† 19 } 20 } å…·ä½“å‚è€ƒèµ„æ–™ #\r","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/javase/datastruct/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"æ•°ç»„ï¼š #\r1 public class Demo1_Array { 2 public static void main(String[] args) { 3 String [] array=new String[5];//éœ€è¦åˆå§‹åŒ–é•¿åº¦ 4 array[0]=\u0026#34;hello\u0026#34;; 5 array[1]=\u0026#34;world\u0026#34;; 6 array[4]=\u0026#34;Mufasa\u0026#34;; 7 // array[5]=\u0026#34;right or not\u0026#34;;//ArrayIndexOutOfBoundsException 8 for(String str:array){ 9 System.","title":"æ•°æ®ç»“æ„ç¯‡","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\rHi ï¼Œä½ å¥½ï¼ #\rä½ å¥½ï¼Œæˆ‘æ˜¯æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œï¼Œæˆ‘æ˜¯è¿™ä¸ªåšå®¢çš„ä½œè€…ã€‚æˆ‘è¿™æ ·åšæ˜¯ä¸ºäº†è®°å½•ä¹‹å‰å­¦ä¹ çš„ç¬”è®° å› ä¸ºæˆ‘åŸºæœ¬å¾ˆéš¾è®°ä½æˆ‘å­¦è¿‡çš„ä¸œè¥¿\u0026hellip;. æˆ‘å…³å¿ƒåç«¯æŠ€æœ¯ï¼Œä¹Ÿå–œæ¬¢åšä¸€äº›å‰ç«¯æ•ˆæœï¼Œæˆ‘å¶å°”å†™ä¸€äº›ç¬”è®°å’Œå¿ƒå¾—å¹¶ä¸”å®šæœŸåˆ†äº«åˆ°\rå“”å“©å“”å“©å’Œæˆ‘çš„\rè¯­é›€é¢‘é“ ä¸–ç•Œå……æ»¡äº†å¾ˆå¤šä¸ç¡®å®šçš„ä¸œè¥¿ï¼Œå¸Œæœ›å¤§å®¶ä¿æŒç‹¬ç«‹çš„æ€è€ƒã€‚å¦‚æœä½ å¥½å¥‡\ræˆ‘ç›®å‰åœ¨åšçš„äº‹æƒ…,ä¹Ÿå¯ä»¥äº†è§£æ›´å¤š\rå…³äºæˆ‘çš„ä¿¡æ¯ã€‚\nè¿™ä¸ªåšå®¢ç½‘ç«™åœ¨ä¸‹é¢çš„æ”¯æŒä¸‹å®Œæˆ\nç™½å¤©/å¤œæ™š æ¨¡å¼, ä¾èµ–äº\rUIè®¾è®¡ éå¸¸æ„Ÿè°¢ä¸‹é¢çš„å‡ ä¸ªç½‘ç«™æ”¯æŒæˆ‘\rInter UI font,ç”±\rRasmus Anderssonåˆ¶ä½œ éå¸¸æ„Ÿè°¢è¿™ä½æä¾›çš„å¸®åŠ©\rPrismJS ä»¥åŠæˆ‘åŒä¸“ä¸šçš„å‰è¾ˆï¼š\rAncientElement æ‰€ä»¥ï¼Œå¸Œæœ›ä½ åœ¨è¿™å„¿å¯ä»¥ç©çš„å¼€å¿ƒï¼ï¼ï¼\næœ¬äººç®€å†ï¼š #\r107706430_p0_hu46370d4ccd3481872546da16224d0daa_1972225_288x288_fill_box_center_3\næ±‚èŒï¼ˆé•¿æœŸæœ‰æ•ˆï¼‰\râ†˜ æœ¬äººç®€å†\r2024å¹´3æœˆ09æ—¥\rÂ· 12:01\n","date":"3 October 2023","externalUrl":null,"permalink":"/info/","section":"","summary":"Hi ï¼Œä½ å¥½ï¼ #\rä½ å¥½ï¼Œæˆ‘æ˜¯æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œï¼Œæˆ‘æ˜¯è¿™ä¸ªåšå®¢çš„ä½œè€…ã€‚æˆ‘è¿™æ ·åšæ˜¯ä¸ºäº†è®°å½•ä¹‹å‰å­¦ä¹ çš„ç¬”è®° å› ä¸ºæˆ‘åŸºæœ¬å¾ˆéš¾è®°ä½æˆ‘å­¦è¿‡çš„ä¸œè¥¿\u0026hellip;. æˆ‘å…³å¿ƒåç«¯æŠ€æœ¯ï¼Œä¹Ÿå–œæ¬¢åšä¸€äº›å‰ç«¯æ•ˆæœï¼Œæˆ‘å¶å°”å†™ä¸€äº›ç¬”è®°å’Œå¿ƒå¾—å¹¶ä¸”å®šæœŸåˆ†äº«åˆ°\rå“”å“©å“”å“©å’Œæˆ‘çš„\rè¯­é›€é¢‘é“ ä¸–ç•Œå……æ»¡äº†å¾ˆå¤šä¸ç¡®å®šçš„ä¸œè¥¿ï¼Œå¸Œæœ›å¤§å®¶ä¿æŒç‹¬ç«‹çš„æ€è€ƒã€‚å¦‚æœä½ å¥½å¥‡\ræˆ‘ç›®å‰åœ¨åšçš„äº‹æƒ…,ä¹Ÿå¯ä»¥äº†è§£æ›´å¤š\rå…³äºæˆ‘çš„ä¿¡æ¯ã€‚\nè¿™ä¸ªåšå®¢ç½‘ç«™åœ¨ä¸‹é¢çš„æ”¯æŒä¸‹å®Œæˆ\nç™½å¤©/å¤œæ™š æ¨¡å¼, ä¾èµ–äº\rUIè®¾è®¡ éå¸¸æ„Ÿè°¢ä¸‹é¢çš„å‡ ä¸ªç½‘ç«™æ”¯æŒæˆ‘\rInter UI font,ç”±\rRasmus Anderssonåˆ¶ä½œ éå¸¸æ„Ÿè°¢è¿™ä½æä¾›çš„å¸®åŠ©\rPrismJS ä»¥åŠæˆ‘åŒä¸“ä¸šçš„å‰è¾ˆï¼š\rAncientElement æ‰€ä»¥ï¼Œå¸Œæœ›ä½ åœ¨è¿™å„¿å¯ä»¥ç©çš„å¼€å¿ƒï¼ï¼ï¼\næœ¬äººç®€å†ï¼š #\r107706430_p0_hu46370d4ccd3481872546da16224d0daa_1972225_288x288_fill_box_center_3","title":"åº”è¯¥æ²¡äººæ¥è¿™é‡Œå§","type":"page"},{"content":"ç‰¹ç‚¹ï¼šçº¿ç¨‹éš”ç¦»ï¼Œç›¸äº’æ˜¯éš”ç¦»çš„ï¼Œä¸å½±å“çš„,æ¯ä¸ªçº¿ç¨‹éƒ½è‡ªå·±ç©è‡ªå·±çš„ï¼Œåªæ“ä½œè‡ªå·±çš„å•ç‹¬çš„å˜é‡å‰¯æœ¬\nå†…éƒ¨ç»´æŠ¤çš„æ˜¯ThreadLocalMapï¼Œæ‰€ä»¥æœ‰keyå’Œvalue\nå½“keyæŒ‡å‘çš„å€¼ä¸ºnullæ—¶ï¼Œvalueä¸è¢«æ¸…ç†ï¼Œç”±äºkeyæ˜¯å¼±å¼•ç”¨ï¼Œæ­¤æ—¶å°±ä¼šé€ æˆå†…å­˜æ³„éœ²ï¼Œæ‰€ä»¥å¿…é¡»è¦é€šè¿‡ThreadLocalé‡Œé¢çš„removeæ–¹æ³•æ‰‹åŠ¨åˆ é™¤å€¼ï¼Œé¿å…å†…å­˜æ³„éœ²ã€‚\nThreadLocalMapé‡Œé¢é¢ç”±ä¸€ä¸ªä¸ªç”±æ•°ç»„ç»„æˆçš„key-valueï¼Œç»„æˆäº†Entry ç”±ThreadLocalæ¥è®¾ç½®å€¼ï¼Œåˆ é™¤å€¼\nå¼±å¼•ç”¨éå¸¸å®¹æ˜“GCï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æ³„éœ²ï¼Œæ‰€ä»¥éœ€è¦å°†keyä¸ºnullçš„entryæ¸…é™¤\nå¼•ç”¨å…³ç³»ï¼šThread-\u0026gt; ThreadLocal-\u0026gt;Entryï¼ˆå¼±ï¼‰-\u0026gt;keyï¼ˆå¼±ï¼‰-\u0026gt;value(å¼º)ï¼ˆä¸æ¸…é™¤æ—¶å®¹æ˜“å‘ç”Ÿå†…å­˜æ³„éœ²ï¼‰\n//å†…éƒ¨ç±»ï¼Œå®=å®ç° static ThreadLocalMap createInheritedMap(ThreadLocalMap parentMap) { return new ThreadLocalMap(parentMap); } static class ThreadLocalMap { static class Entry extends WeakReference\u0026lt;ThreadLocal\u0026lt;?\u0026gt;\u0026gt; { /** The value associated with this ThreadLocal. */ Object value; Entry(ThreadLocal\u0026lt;?\u0026gt; k, Object v) { super(k); value = v; } } private static final int INITIAL_CAPACITY = 16; private Entry[] table; private int size = 0; private int threshold; // Default to 0 private void setThreshold(int len) { threshold = len * 2 / 3; } private static int nextIndex(int i, int len) { return ((i + 1 \u0026lt; len) ? i + 1 : 0); } private static int prevIndex(int i, int len) { return ((i - 1 \u0026gt;= 0) ? i - 1 : len - 1); } ThreadLocalMap(ThreadLocal\u0026lt;?\u0026gt; firstKey, Object firstValue) { table = new Entry[INITIAL_CAPACITY]; int i = firstKey.threadLocalHashCode \u0026amp; (INITIAL_CAPACITY - 1); table[i] = new Entry(firstKey, firstValue); size = 1; setThreshold(INITIAL_CAPACITY); } private ThreadLocalMap(ThreadLocalMap parentMap) { Entry[] parentTable = parentMap.table; int len = parentTable.length; setThreshold(len); table = new Entry[len]; for (Entry e : parentTable) { if (e != null) { @SuppressWarnings(\u0026#34;unchecked\u0026#34;) ThreadLocal\u0026lt;Object\u0026gt; key = (ThreadLocal\u0026lt;Object\u0026gt;) e.get(); if (key != null) { Object value = key.childValue(e.value); Entry c = new Entry(key, value); int h = key.threadLocalHashCode \u0026amp; (len - 1); while (table[h] != null) h = nextIndex(h, len); table[h] = c; size++; } } } } } ","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/javase/threadlocal/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"ç‰¹ç‚¹ï¼šçº¿ç¨‹éš”ç¦»ï¼Œç›¸äº’æ˜¯éš”ç¦»çš„ï¼Œä¸å½±å“çš„,æ¯ä¸ªçº¿ç¨‹éƒ½è‡ªå·±ç©è‡ªå·±çš„ï¼Œåªæ“ä½œè‡ªå·±çš„å•ç‹¬çš„å˜é‡å‰¯æœ¬\nå†…éƒ¨ç»´æŠ¤çš„æ˜¯ThreadLocalMapï¼Œæ‰€ä»¥æœ‰keyå’Œvalue\nå½“keyæŒ‡å‘çš„å€¼ä¸ºnullæ—¶ï¼Œvalueä¸è¢«æ¸…ç†ï¼Œç”±äºkeyæ˜¯å¼±å¼•ç”¨ï¼Œæ­¤æ—¶å°±ä¼šé€ æˆå†…å­˜æ³„éœ²ï¼Œæ‰€ä»¥å¿…é¡»è¦é€šè¿‡ThreadLocalé‡Œé¢çš„removeæ–¹æ³•æ‰‹åŠ¨åˆ é™¤å€¼ï¼Œé¿å…å†…å­˜æ³„éœ²ã€‚\nThreadLocalMapé‡Œé¢é¢ç”±ä¸€ä¸ªä¸ªç”±æ•°ç»„ç»„æˆçš„key-valueï¼Œç»„æˆäº†Entry ç”±ThreadLocalæ¥è®¾ç½®å€¼ï¼Œåˆ é™¤å€¼\nå¼±å¼•ç”¨éå¸¸å®¹æ˜“GCï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æ³„éœ²ï¼Œæ‰€ä»¥éœ€è¦å°†keyä¸ºnullçš„entryæ¸…é™¤\nå¼•ç”¨å…³ç³»ï¼šThread-\u0026gt; ThreadLocal-\u0026gt;Entryï¼ˆå¼±ï¼‰-\u0026gt;keyï¼ˆå¼±ï¼‰-\u0026gt;value(å¼º)ï¼ˆä¸æ¸…é™¤æ—¶å®¹æ˜“å‘ç”Ÿå†…å­˜æ³„éœ²ï¼‰\n//å†…éƒ¨ç±»ï¼Œå®=å®ç° static ThreadLocalMap createInheritedMap(ThreadLocalMap parentMap) { return new ThreadLocalMap(parentMap); } static class ThreadLocalMap { static class Entry extends WeakReference\u0026lt;ThreadLocal\u0026lt;?\u0026gt;\u0026gt; { /** The value associated with this ThreadLocal.","title":"ThreadLocal","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"\rRediså­¦ä¹ ï¼š #\ré€šç”¨å‘½ä»¤ #\rä¸è¦åœ¨ä¸»èŠ‚ç‚¹ç”¨ï¼škeys param å‘½ä»¤æ¥æŸ¥è¯¢ï¼Œè¿™æŸ¥è¯¢é€Ÿç‡å¾ˆæ…¢ï¼Œå•çº¿ç¨‹å°†ä¼šè¢«é˜»å¡ del paramï¼ˆå¯ä»¥æ˜¯å¤šä¸ªå‚æ•°ï¼‰ :åˆ é™¤æŒ‡å®šçš„key exists param(åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨) expire key time :è®¾ç½®æœ‰æ•ˆæœŸæ—¶é—´ ttl key :æŸ¥çœ‹keyçš„æœ‰æ•ˆæœŸ\nStringç±»å‹ #\ræœ€ç®€å•çš„Redisæ•°æ®ç±»å‹ï¼Œvalueï¼šstring,int,floatï¼›æœ€å¤§ç©ºé—´ä¸è¶…è¿‡512M set key value get key\nMset æ‰¹é‡ æ·»åŠ key-value\nMgetæ‰¹é‡è·å–\næ•°å€¼ç±»å‹ï¼šincr ï¼šè®©å˜é‡è‡ªå¢åŠ ä¸€\nincrby numï¼šæŒ‰ç…§æ­¥é•¿å¢åŠ \nsetnx:ä¸å­˜åœ¨ keyæ‰å¯ä»¥æ·»åŠ è¿™ä¸ªkey\nå¦‚ä½•åŒºåˆ†ä¸åŒçš„keyï¼Ÿ #\råˆ©ç”¨å±‚çº§ç»“æ„æ¥è¡¨æ˜tableï¼Œä»¥åçš„å¤§éƒ¨åˆ†ä¸šåŠ¡éƒ½æ˜¯ç”¨å±‚çº§ç»“æ„æ¥å±•ç°å’Œå¸ƒå±€çš„ï¼\nHashç±»å‹ #\rå“ˆå¸Œç±»å‹ï¼Œä¹Ÿå«åšæ•£åˆ—ï¼ŒHashçš„valueæ˜¯ä¸€ä¸ªæ— é¡»å­—å…¸ï¼Œç±»ä¼¼äºHashMapçš„ç»“æ„ã€‚\nå…·æœ‰fieldè¿™ä¸€ä¸ªå­—æ®µï¼Œè¿™æ˜¯ä¸ä¸€æ ·çš„ã€‚\nListç±»å‹ #\rç±»ä¼¼äº LinkedList(ä¹Ÿå°±æ˜¯åŒå‘é“¾è¡¨)\næœ‰åº å…ƒç´ å¯é‡å¤ æ’å…¥åˆ é™¤å¿« æŸ¥è¯¢é€Ÿåº¦ä¸€èˆ¬ Lpush key elementï¼šå‘å·¦ä¾§æ’å…¥å…ƒç´  è¿”å›åˆ—è¡¨é•¿åº¦ï¼Œç›¸åº”çš„å‘å³è¾¹ï¼šRpush key element\nLpop key:ç§»é™¤å·¦ä¾§ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›nil\nBlop/Brpop key times:é˜»å¡é˜Ÿåˆ—çš„æ’å…¥ ,åŠ ä¸Šé˜»å¡æ—¶é—´\nå¦‚ä½•ç”¨Listæ¥æ¨¡æ‹Ÿæ ˆï¼Ÿ\nå…¥å£å’Œå‡ºå£ä¸€èµ·ã€‚Lpushå’ŒLpop\næ¨¡æ‹Ÿé˜Ÿåˆ—ï¼Ÿ\nå…¥å£å’Œå‡ºå£ä¸åœ¨ä¸€èµ·ã€‚Lpushå’ŒRpop\næ¨¡æ‹Ÿé˜»å¡é˜Ÿåˆ—ï¼Ÿ\nå…¥å£å‡ºå£ä¸åœ¨ä¸€è¾¹ï¼Œå–çš„æ—¶å€™ç”¨é˜»å¡Brpop/Blpop\nSetç±»å‹ #\rç±»ä¼¼äºHashSetï¼Œå¯ä»¥çœ‹ä½œæ˜¯valueä¸ºnullçš„hashMapã€‚\nSadd key member:æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ã€‚\nSrem key member:åˆ é™¤å…ƒç´ \nSmembersï¼šè·å–æ‰€æœ‰å…ƒç´ \nSinter key1 key2:æ±‚å–äº¤é›†\nSdiffï¼šæ±‚å·®é›†\nSunion:æ±‚å¹¶é›†\nScard:æ±‚å…ƒç´ ä¸ªæ•°\nSismenber key member:æ˜¯å¦æ˜¯æˆå‘˜\nSortedSet #\rzrank key member:æ’åä»0å¼€å§‹è®¡ç®—\nzcount key min max:ç»Ÿè®¡åŒºé—´æ•°é‡\n#\rRediså®é™…å¼€å‘æ—¶åºåˆ—åŒ–çš„é—®é¢˜ #\rSessionå…±äº«é—®é¢˜ï¼ŒåŸºäºRediså®ç°çš„Sessionæ•°æ®æ•°æ®å…±äº« #\rå¤šå°TomcatæœåŠ¡å™¨ï¼Œæ¯ä¸€å°éƒ½æœ‰ä¸åŒçš„Sessionç©ºé—´ï¼Œå°†ä¼šå­˜åœ¨å…±äº«é—®é¢˜,äº’ç›¸æ‹·è´å…·æœ‰æ—¶é—´å»¶è¿Ÿå’Œç©ºé—´æµªè´¹çš„é—®é¢˜ã€‚\nè§£å†³æ–¹æ¡ˆï¼šRedisæ•°æ®å…±äº«\ncodeä½œä¸ºkeyæ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œå°†ä¼šè¦†ç›–ï¼Œæ‰€æœ‰é€‰ç”¨Phoneä½œä¸ºkeyï¼Œä½¿ç”¨Hashç»“æ„æ¥å­˜å‚¨ï¼Œ å†…å­˜å ç”¨ä¹Ÿä¼šæ¯”è¾ƒå°‘ç›¸å¯¹äºStringç±»å‹ï¼Œä½¿ç”¨éšæœºtokenä½œä¸ºkeyæ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€‚ ç°åœ¨tokenä½œä¸ºç™»å½•å‡­è¯ï¼Œè¿”å›tokenç»™å®¢æˆ·ç«¯\nç¼“å­˜ï¼šæµè§ˆå™¨ç¼“å­˜-\u0026gt;åº”ç”¨å±‚ç¼“å­˜ï¼ˆRedisï¼ŒNginx,Tomcat\u0026hellip;å„ç§ç¼“å­˜ï¼‰-\u0026gt;æ•°æ®åº“ç¼“å­˜ï¼Œæ ¹æ®ç´¢å¼•æ¥è¿›è¡Œç¼“å­˜ï¼Œå‡å°‘ç£ç›˜IO\nä¼˜ç‚¹ï¼šé™ä½åç«¯è´Ÿè½½ï¼Œæé«˜è¯»å†™é€Ÿç‡ï¼Œé™ä½å“åº”æ—¶é—´ æˆæœ¬ï¼šæ•°æ®ä¸€è‡´æ€§æˆæœ¬ï¼Œå½“æ•°æ®åº“å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç¼“å­˜æœªè·Ÿæ–°ï¼Œå°±ä¼šå‡ºç°ä¸ä¸€è‡´ï¼Œ ä»£ç ç»´æŠ¤æˆæœ¬ä¹Ÿä¼šæé«˜ï¼Œä¸ºäº†é«˜å¯ç”¨ï¼Œè¿ç»´æˆæœ¬ä¹Ÿä¼šæé«˜\nç¼“å­˜æ›´æ–°ç­–ç•¥ï¼š #\rå†…å­˜æ·˜æ±°ï¼Œè¶…æ—¶å‰”é™¤(ä½ä¸€è‡´æ€§)ï¼Œä¸»åŠ¨æ›´æ–°ï¼ˆé«˜ä¸€è‡´æ€§ï¼‰\nä¸»åŠ¨æ›´æ–°ï¼š\n1è°ƒç”¨è€…æ›´æ–°æ•°æ®åº“æ—¶åŒæ—¶æ›´æ–°ç¼“å­˜ï¼›ï¼ˆå¯æ§æ€§æœ€é«˜ï¼‰\n2 ç¼“å­˜å’Œæ•°æ®åº“æ•´åˆä¸ºä¸€ä¸ªæœåŠ¡ï¼›\n3 è°ƒç”¨åªæ“ä½œï¼Œç‹¬ç«‹å¼‚æ­¥çº¿ç¨‹æŒä¹…åŒ–åˆ°æ•°æ®åº“,ä»è€Œå®ç°ç¼“å­˜å’Œæ•°æ®åº“ä¸€è‡´\nåˆ é™¤ç¼“å­˜ï¼ˆæ— æ•ˆæ“ä½œå¤ªå¤šï¼‰è€Œä¸æ˜¯æ›´æ–°ç¼“å­˜ï¼Œå•ä½“é¡¹ç›®éœ€è¦å°†ç¼“å­˜å’Œæ•°æ®åº“æ”¾åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œè€ƒè™‘çº¿ç¨‹å®‰å…¨ Cache Aside Patternï¼ˆè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼‰ ç¼“å­˜ç©¿é€ï¼š #\rè¯·æ±‚å®¢æˆ·ç«¯æ•°æ®ä¸­ï¼Œç¼“å­˜é‡Œé¢å’Œæ•°æ®åº“é‡Œé¢æ•°æ®éƒ½ä¸å­˜åœ¨ï¼Œè¯·æ±‚éƒ½æ‰“åˆ°æ•°æ®åº“ä¸Šé¢äº†\nè§£å†³åŠæ³•ï¼šå¸ƒéš†è¿‡æ»¤å™¨ï¼ˆå†…å­˜å ç”¨å°‘ï¼‰ï¼Œç¼“å­˜ç©ºå¯¹è±¡æˆ–è€…nullï¼ˆé¢å¤–å†…å­˜æ¶ˆè€—ï¼Œå¯èƒ½é€ æˆçŸ­æœŸä¸ä¸€è‡´ï¼‰ ä¸»åŠ¨æ·»åŠ  å¯¹IDçš„å¤æ‚åº¦\nç¼“å­˜é›ªå´© #\rå¾ˆå¤škeyåŒæ—¶å¤±æ•ˆ\nç¼“å­˜å‡»ç©¿ #\rçƒ­ç‚¹keyçªç„¶å¤±æ•ˆï¼Œæ— æ•ˆçƒ­ç‚¹æ•°æ®ç»™æ•°æ®åº“å¸¦æ¥å·¨å¤§å‹åŠ›\n1ï¼šä½¿ç”¨äº’æ–¥é”æ¥å†™å…¥ç¼“å­˜ï¼Œä½†æ˜¯äº’ç›¸ç­‰å¾…æ—¶é—´æ¯”è¾ƒé•¿ï¼Œæ€§èƒ½è¾ƒå·®\n2ï¼šé€»è¾‘è¿‡æœŸTTL=-1\né€‰æ‹©ä¸€è‡´æ€§è¿˜æ˜¯å¯ç”¨æ€§\nå…¨å±€å”¯ä¸€ IDç”Ÿæˆå™¨ UUIDï¼šæ²¡æœ‰æ»¡è¶³ç‰¹æ€§ ï¼ŒRedisIdï¼šæ•°å­—ç±»å‹ï¼Œsnowflakeï¼šç®—æ³•ï¼Œç»´æŠ¤æœºå™¨ID\nå¤šçº¿ç¨‹ä¸‹é«˜å¹¶å‘è¶…å–é—®é¢˜æ˜¯æ€ä¹ˆå‘ç”Ÿçš„ #\rå½“çº¿ç¨‹æ‰£å‡æ—¶å€™ï¼Œå¤šçº¿ç¨‹æŸ¥è¯¢åº“å­˜ï¼Œæ‰£å‡åº“å­˜ä¹‹å‰ï¼Œç›´æ¥ä¸€ä¸ªæ•°æ®ç”¨ä¸¤æ¬¡ï¼Œä½¿å¾—å‡ºç°å¹¶å‘å®‰å…¨é—®é¢˜ã€‚\né”çš„ä»‹ç»ï¼š #\ræ‚²è§‚é”ï¼š #\ræ‚²è§‚é”\nä¾‹å¦‚synchronized å’Œlockï¼Œè®¤ä¸ºçº¿ç¨‹å®‰å…¨é—®é¢˜ä¸€å®šä¼šå‘ç”Ÿï¼Œåœ¨æ“ä½œæ•°æ®ä¹‹å‰ä¸€å®šè¦è·å¾—é”ä¹‹åæ‰æ‰§è¡Œ\nä¹è§‚é”\nè®¤ä¸ºçº¿ç¨‹å®‰å…¨é—®é¢˜ä¸ä¸€å®šä¼šå‘ç”Ÿï¼Œå¤šæ•°æƒ…å†µä¸å‘ç”Ÿï¼Œä¸åŠ é”ï¼Œ åœ¨çº¿ç¨‹åšæ•°æ®æ›´æ–°æ—¶è¿›è¡Œæ•°æ®åˆ¤æ–­ï¼Œçœ‹ä¹‹å‰çš„åˆ¤æ–­æ•°æ®æ˜¯å¦å‘ç”Ÿä¿®æ”¹ï¼Œæ€§èƒ½ç›¸è¾ƒäºä¹è§‚é”å¥½\né‚£æ€ä¹ˆåˆ¤æ–­ä¹‹å‰çš„æ•°æ®æ˜¯å¦å‘ç”Ÿäº†ä¿®æ”¹å‘¢ï¼Ÿ\n1ï¼šç‰ˆæœ¬å·æ³•ï¼ˆæœ€å¹¿æ³›ï¼‰ ç»™æ•°æ®åŠ ä¸Šç‰ˆæœ¬å·ï¼ŒåŒæ—¶åœ¨ä¿®æ”¹æ—¶ä¸ä»…è¦æŸ¥è¯¢ç‰ˆæœ¬å·åŒæ—¶è¿˜è¦ä¿®æ”¹ç‰ˆæœ¬å·\n2ï¼šCASæ–¹æ³•ï¼Œå‡å¦‚æ•°æ®æœ¬èº«å…·æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆæ•°æ®æœ¬æ·±å°±å¯ä»¥ä½œä¸ºç‰ˆæœ¬å·\n3ï¼šåˆ†æ®µé”ï¼Œè§£å†³æˆåŠŸç‡è¾ƒä½çš„é—®é¢˜ï¼Œå®é™…ç§’æ€è¿˜è¦å¯¹ç§’æ€è¿›è¡Œä¼˜åŒ–ï¼Œä¸å¯¹æ•°æ®åº“é€ æˆå‹åŠ›\né›†ç¾¤æ¨¡å¼ä¸‹çš„å¹¶å‘å®‰å…¨é—®é¢˜ï¼š\nå½“å‡ºç°é›†ç¾¤å’Œè´Ÿè½½å‡è¡¡æ—¶ï¼Œå¯èƒ½å‡ºç°äº¤å‰æ‰§è¡Œï¼Œé”å¤±æ•ˆäº†ï¼Œè¿™å°±æ˜¯åˆ†å¸ƒå¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜\né”ç›‘è§†å™¨ä¸æ˜¯åŒä¸€ä¸ª\nå‡ºç°äº†ä¸¤å¥—JVMï¼Œé”ç›‘è§†å™¨å…·æœ‰ä¸åŒçš„ï¼Œè¿™å°†ä¼šå¯¼è‡´å‡ºç°å¹¶å‘å®‰å…¨é—®é¢˜\n==ã€‹è§£å†³åŠæ³•ï¼šåˆ†å¸ƒå¼é”\nä¸€äººä¸€å• #\råˆ†å¸ƒå¼é” #\rå®ç°åŸç†ï¼šä¸åŒçš„JVMé‡‡ç”¨åŒä¸€ä¸ªJVM\nåˆ†å¸ƒå¼é”ç‰¹ç‚¹ï¼šå¤šè¿›ç¨‹å¯è§åŒæ—¶æ—¶äº’æ–¥çš„é”ï¼Œé«˜å¯ç”¨æ€§ï¼Œé«˜å¹¶å‘ï¼ˆé«˜æ€§èƒ½ï¼‰ï¼Œå®‰å…¨æ€§ï¼Œæ˜¯å¦ä¼šäº§ç”Ÿæ­»é”\næ˜¯å¦æ»¡è¶³å¯é‡å…¥æ€§ï¼Ÿï¼ˆä¸æ˜¯é‡ç‚¹ï¼‰\nåˆ†å¸ƒå¼é”çš„å®ç°\nå®ç°æ–¹å¼ï¼šMysql Redis Zookeeper\nmysql:åˆ©ç”¨mysqlæœ¬èº«çš„äº’æ–¥é”æœºåˆ¶ï¼Œredis:åˆ©ç”¨setnxè¿™æ ·çš„äº’æ–¥å‘½ä»¤ï¼Œåˆ©ç”¨keyçš„è¿‡æœŸæ—¶é—´æ¥è§£å†³å®‰å…¨é—®é¢˜ã€‚\nzookeeper åˆ©ç”¨å”¯ä¸€èŠ‚ç‚¹å’Œæœ‰åºæ€§æ¥å®ç°äº’æ–¥é”ã€‚é«˜å¯ç”¨æ€§è¿˜æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œå®‰å…¨æ€§è¾ƒå¥½\nåŸºäºRediså®ç°åˆ†å¸ƒå¼é”ï¼š #\r127.0.0.1:6379\u0026gt; help set SET key value [EX seconds|PX milliseconds|EXAT timestamp|PXAT milliseconds-timestamp|KEEPTTL] [NX|XX] [GET] summary: Set the string value of a key since: 1.0.0 group: string 127.0.0.1:6379\u0026gt; set lock thread EX 10 NX OK 127.0.0.1:6379\u0026gt; set lock thread EX 10 NX (nil) 127.0.0.1:6379\u0026gt; ttl lock (integer) -2 å®ç°å°†ä¼šæ˜¯éé˜»å¡å¼çš„åˆ†å¸ƒå¼é”\næç«¯æƒ…å†µçº¿ç¨‹å‡ºç°å¹¶å‘å®‰å…¨é—®é¢˜ã€‚\nè§£å†³åŠæ³•ï¼šé‡Šæ”¾é”çš„æ—¶å€™éœ€è¦è¿›è¡Œæ£€æŸ¥ï¼Œçœ‹è‡ªå·±çš„é”æ ‡è¯†æ˜¯å¦å’Œä¹‹å‰è·å–çš„ä¸€æ ·ã€‚\nåªè¦redisé”å‘ç”Ÿäº†è¶…æ—¶é‡Šæ”¾å°±æœ‰å¯èƒ½å‘ç”Ÿå¹¶å‘é—®é¢˜ã€‚\nä¾‹å¦‚FullGcæ—¶ï¼Œå‘ç”Ÿé˜»å¡å°±ä¼šå‡ºç°å¹¶å‘é—®é¢˜ï¼Œæ‰€ä»¥é‡Šæ”¾é”å’Œåˆ¤æ–­é”æ ‡è¯†å¿…é¡»æ˜¯åŸå­æ€§çš„ï¼Œå¿…é¡»åŒæ—¶\nç”¨Luaè„šæœ¬æ¥è§£å†³åŸå­æ€§é—®é¢˜ #\råˆ©ç”¨çœ‹é—¨ç‹—è§£å†³é”è¶…æ—¶é‡Šæ”¾çš„é—®é¢˜\nRedissoné—®é¢˜(å‘µå‘µï¼Œè¿™æ˜¯ä¸€ä¸ªæŠŠåˆ†å¸ƒå¼é”å®ç°å¥½çš„å¼€æºæ¡†æ¶) #\rredisson åˆ†å¸ƒå¼é”åŸç†ï¼š #\rå¯é‡å…¥ï¼šåˆ©ç”¨hashç»“æ„æ¥è®°å½•çº¿ç¨‹idå’Œé‡å…¥æ¬¡æ•°ï¼Œç±»ä¼¼äºReentryLock\nå¯é‡è¯•ï¼šåˆ©ç”¨ä¿¡å·é‡å®ç°ç­‰å¾…å’Œè·å–é”å¤±è´¥çš„é‡è¯•æœºåˆ¶\nè¶…æ—¶ç»­çº¦ï¼šåˆ©ç”¨çœ‹é—¨ç‹—ï¼Œåœ¨è·å–é”ä¹‹åï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œå°±è‡ªåŠ¨ç»­çº¦ï¼Œé”æ»¡è¡€å¤æ´»ã€‚\nåˆ†å¸ƒå¼é”çš„ä¸»ä»ä¸€è‡´æ€§é—®é¢˜ã€‚ #\råˆ©ç”¨redissonçš„multi lockæ¥å®ç°\nåˆ©ç”¨Redisæ¥ä¼˜åŒ–ç§’æ€ #\rä½¿ç”¨Setç±»å‹ï¼Œè§£å†³å”¯ä¸€æ€§é—®é¢˜ã€‚luaè„šæœ¬æ¥è§£å†³é”é‡Šæ”¾å’Œäº‹åŠ¡æäº¤çš„åŸå­æ€§é—®é¢˜\nå°†ä¸‹å•ä¿¡æ¯æ·»åŠ åˆ°é˜»å¡é˜Ÿåˆ—é‡Œé¢\nWindowsç›¸å…³å‘½ä»¤ï¼š #\ræŸ¥æ‰¾å¹¶è®°å½•éœ€è¦æ€æ­»çš„è¿›ç¨‹å·ç ï¼š netstat -ano\næŸ¥æ‰¾ç«¯å£ï¼šnetstat -ano|findstr [Port]\næŸ¥æ‰¾åç§°ï¼štasklist |findstr [PID]\næ€æ­»è¿›ç¨‹ï¼š taskkill -f -pid [PID]\n#\ræ¶ˆæ¯é˜Ÿåˆ—ã€Message Queueã€‘:ã€RabbitMq Kafka RedisQã€‘ #\råŸºäºRediså®ç°çš„å¼‚æ­¥é˜»å¡é˜Ÿåˆ—å­˜åœ¨jvmå†…å­˜æº¢å‡ºé—®é¢˜ï¼ŒåŸºäºæ­¤å®ç°äº†æ¶ˆæ¯é˜Ÿåˆ—ã€‚\næ¶ˆæ¯é˜Ÿåˆ—ï¼šå­˜å‚¨å’Œç®¡ç†æ¶ˆæ¯ï¼Œç§°ä¸ºæ¶ˆæ¯ä»£ç†ï¼ˆmessage brokerï¼‰\nç”Ÿäº§è€…:å‘é€æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—\næ¶ˆè´¹è€…ï¼šä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¹¶å¤„ç†\nåŸºäºRedis-Listç»“æ„æ¥æ¨¡æ‹Ÿæ¶ˆæ¯é˜Ÿåˆ— #\rBLpush+BRpop/BRpush+BLpop\nç‹¬ç«‹äºJVMï¼Œä¸ä¾èµ–äºæœºå™¨ï¼Œå…·å¤‡æ•°æ®æŒä¹…åŒ–ï¼Œæ»¡è¶³æ¶ˆæ¯çš„æœ‰åºæ€§ã€‚ æ— æ³•é¿å…æ¶ˆæ¯ä¸¢å¤±ï¼Œåªæ”¯æŒå•æ¶ˆè´¹è€…ã€‚\nåŸºäºPubSubçš„æ¶ˆæ¯é˜Ÿåˆ— #\rå‘å¸ƒ-è®¢é˜…æ¨¡å¼\næ”¯æŒå¤šç”Ÿäº§å’Œå¤šæ¶ˆè´¹ï¼špublish subscribeï¼ŒpsubscribeåŒ¹é…ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼\nä¸æ”¯æŒæ¶ˆæ¯æŒä¹…åŒ–ï¼Œæ— æ³•é¿å…æ¶ˆæ¯ä¸¢å¤±ï¼ˆå½“å®¢æˆ·ç«¯å®•æœºæ—¶ï¼Œä¸æ¥å—æ¶ˆæ¯ï¼Œæ¶ˆæ¯å°†ä¼šä¸¢å¤±ï¼‰ï¼Œæ¶ˆæ¯å †ç§¯æœ‰ä¸Šé™ã€‚\nåŸºäºStreamçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚åŸºäºRedis-5.0å®ç° #\rXADD key [é˜Ÿåˆ—æ˜¯å¦åˆ›å»º] [æ¶ˆæ¯é˜Ÿåˆ—æœ€å¤§ä¸Šé™] [ID] [filed] [value] XREAD [count] [block sec] streams [key] [id] xgroup creat key groupName ID æ¶ˆæ¯å¯å›æº¯ï¼Œå¯é˜»å¡è¯»å–ï¼Œå¯è¢«å¤šä¸ªæ¶ˆè´¹è€…è¯»å–ï¼Œæœ‰æ¼è¯»çš„é£é™© å•è¯ï¼špending:å¾…å®š\næ¶ˆè´¹è€…ç»„ï¼š #\ræ¶ˆæ¯åˆ†æµ æ¶ˆæ¯æ ‡è¯†ï¼ˆç¡®ä¿æ¶ˆæ¯éƒ½ä¼šè¢«æ¶ˆè´¹ï¼‰ æ¶ˆæ¯ç¡®è®¤ï¼ˆæ¶ˆæ¯å¤„äºpendingçŠ¶æ€ï¼Œå­˜å…¥listä¸­ï¼Œéœ€è¦å¾—åˆ°ç¡®è®¤ ï¼‰\nxgroup create/destory/delconsumer key groupName ID [\u0026ldquo;mkstream\u0026rdquo;]\nåŸºäºstreamæ¥å®ç°çš„æ¶ˆè´¹è€…ç»„ï¼Œ è¯»å–æ¶ˆæ¯éƒ½æ˜¯ä»pending-listä¸­è¯»å–æ¶ˆæ¯ï¼Œå®ç°æ–¹æ³•æ˜¯é€šè¿‡idè¿›è¡Œç­›é€‰\næ¶ˆæ¯è¯»å–ä¹‹åå¿…é¡»è¿›è¡Œç¡®è®¤ï¼Œå‚æ•°ä¸ºæ¶ˆæ¯idï¼Œç¡®è®¤ä¹‹åæ¶ˆæ¯idå°†ä¼šè¢«æ¶ˆæ¯é˜Ÿåˆ—ç§»é™¤\næ¶ˆè´¹è€…ç»„çš„åç§°ä¸€èˆ¬ä¼ä¸šç¯å¢ƒä¸‹éƒ½æ˜¯å†™åœ¨ymlæ–‡ä»¶é‡Œé¢\nä¸‰ç§æ¶ˆæ¯é˜Ÿåˆ—List PubSub Stream è§£å†³æ–¹æ¡ˆçš„åŒºåˆ« #\rå‘å¸ƒè¾¾äººæ¢åº— #\rå¯¹ä¸¤å¼ è¡¨å»è¿›è¡Œè¡¨çš„è®¾è®¡ï¼š\nåˆ©ç”¨Zsortæ¥ä½œä¸ºç‚¹èµå’Œæ’è¡Œæ¦œæ•°æ®ç»“æ„ ç›¸å…³å‘½ä»¤ï¼šzadd member score ,zscore memberï¼Œzrange key from to\nå…³æ³¨æ¨é€ï¼ŒFeedæµï¼Œæä¾›æ²‰æµ¸å¼ä½“éªŒ #\rå¸¸è§çš„ä¸¤ç§å®ç°æ¨¡å¼ï¼š\ntimelineï¼šæ ¸å¿ƒéœ€è¦å¸¦ä¸Šæ—¶é—´æˆ³ï¼Œä¸åšå†…å®¹ç­›é€‰ï¼Œä¿¡æ¯å…¨é¢ï¼Œå®ç°ç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯ä¿¡æ¯å™ªéŸ³æ¯”è¾ƒå¤š\nå®ç°æ–¹å¼ï¼šæ‹‰æ¨¡å¼ï¼Œæ¨æ¨¡å¼ï¼Œæ¨æ‹‰ç»“åˆ\næ‹‰æ¨¡å¼ï¼ˆè¯»æ‰©æ•£ï¼‰ï¼šç¼ºç‚¹æ˜¯å»¶è¿Ÿé«˜\næ¨æ¨¡å¼\næ¨æ‹‰ç»“åˆï¼š æ”¶ä»¶ç®±ä½¿ç”¨redisæ¥å®ç°ï¼ŒæŸ¥è¯¢redisæŸ¥è¯¢æ”¶ä»¶ç®±æ•°æ®æ—¶éœ€è¦å®ç°åˆ†é¡µæŸ¥è¯¢ï¼Œlistï¼Œsoretedsetï¼Œæ•°æ®çš„è§’æ ‡ä¼šå‘ç”Ÿå˜æ¢ï¼ŒæŒ‰ç…§ä¼ ç»Ÿçš„åˆ†é¡µæ–¹æ¡ˆå°†ä¼šå‡ºç°é”™è¯¯\næ™ºèƒ½æ’åºï¼šé’ˆå¯¹ç”¨æˆ·ä½¿ç”¨ä¹ æƒ¯åšä¸€äº›ç®—æ³•ï¼Œå°½é‡æ¥è¿‘ç”¨æˆ·ä½¿ç”¨ä¹ æƒ¯ï¼Œä½†å½“ç”¨æˆ·ä¹ æƒ¯ä¸ç®—æ³•ä¸å¯¹ç§°æ—¶ï¼Œå°†ä¼šå‡ºç°åä½œç”¨\n","date":"3 October 2023","externalUrl":null,"permalink":"/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/%E7%BC%93%E5%AD%98/","section":"ç¼–ç¨‹è¯­è¨€s","summary":"Rediså­¦ä¹ ï¼š #\ré€šç”¨å‘½ä»¤ #\rä¸è¦åœ¨ä¸»èŠ‚ç‚¹ç”¨ï¼škeys param å‘½ä»¤æ¥æŸ¥è¯¢ï¼Œè¿™æŸ¥è¯¢é€Ÿç‡å¾ˆæ…¢ï¼Œå•çº¿ç¨‹å°†ä¼šè¢«é˜»å¡ del paramï¼ˆå¯ä»¥æ˜¯å¤šä¸ªå‚æ•°ï¼‰ :åˆ é™¤æŒ‡å®šçš„key exists param(åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨) expire key time :è®¾ç½®æœ‰æ•ˆæœŸæ—¶é—´ ttl key :æŸ¥çœ‹keyçš„æœ‰æ•ˆæœŸ\nStringç±»å‹ #\ræœ€ç®€å•çš„Redisæ•°æ®ç±»å‹ï¼Œvalueï¼šstring,int,floatï¼›æœ€å¤§ç©ºé—´ä¸è¶…è¿‡512M set key value get key\nMset æ‰¹é‡ æ·»åŠ key-value","title":"Redis","type":"ç¼–ç¨‹è¯­è¨€"},{"content":"","date":"3 October 2023","externalUrl":null,"permalink":"/tags/%E7%BC%93%E5%AD%98/","section":"Tags","summary":"","title":"ç¼“å­˜","type":"tags"},{"content":" æˆ‘çš„åå­—æ˜¯æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œï¼Œæˆ‘æ˜¯è¿™ä¸ªåšå®¢çš„ä½œè€…ã€‚æˆ‘è¿™æ ·åšæ˜¯ä¸ºäº†è®°å½•ä¹‹å‰å­¦ä¹ çš„ç¬”è®°ï¼Œè¿™æ ·å¾ˆæœ‰æˆå°±æ„Ÿã€‚ æˆ‘ä»¬éƒ½çŸ¥é“åœ¨ç½‘ç»œä¸Šå¼€å§‹åšä¸€äº›äº‹æƒ…æœ‰å¤šéš¾ï¼Œå°¤å…¶æ˜¯ç°åœ¨ã€‚ä½†æ˜¯ï¼Œä¸ºäº†è‡ªå·±çš„å¤´å‘æ²¡æœ‰ç™½æ‰ï¼ŒåŠ æ²¹å§ï¼Œå¤§å®¶ï¼\nâ€” æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ S01E01\n","date":"3 October 2003","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/post/","section":"ç¬”è®°s","summary":"æˆ‘çš„åå­—æ˜¯æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œï¼Œæˆ‘æ˜¯è¿™ä¸ªåšå®¢çš„ä½œè€…ã€‚æˆ‘è¿™æ ·åšæ˜¯ä¸ºäº†è®°å½•ä¹‹å‰å­¦ä¹ çš„ç¬”è®°ï¼Œè¿™æ ·å¾ˆæœ‰æˆå°±æ„Ÿã€‚ æˆ‘ä»¬éƒ½çŸ¥é“åœ¨ç½‘ç»œä¸Šå¼€å§‹åšä¸€äº›äº‹æƒ…æœ‰å¤šéš¾ï¼Œå°¤å…¶æ˜¯ç°åœ¨ã€‚ä½†æ˜¯ï¼Œä¸ºäº†è‡ªå·±çš„å¤´å‘æ²¡æœ‰ç™½æ‰ï¼ŒåŠ æ²¹å§ï¼Œå¤§å®¶ï¼\nâ€” æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ S01E01","title":"Hello Friend","type":"ç¬”è®°"},{"content":"","date":"3 October 2003","externalUrl":null,"permalink":"/tags/post/","section":"Tags","summary":"","title":"Post","type":"tags"},{"content":"\rC++æé«˜ç¼–ç¨‹ #\ræœ¬é˜¶æ®µä¸»è¦é’ˆå¯¹C++==æ³›å‹ç¼–ç¨‹==å’Œ==STL==æŠ€æœ¯åšè¯¦ç»†è®²è§£ï¼Œæ¢è®¨C++æ›´æ·±å±‚çš„ä½¿ç”¨ 1 æ¨¡æ¿ #\r1.1 æ¨¡æ¿çš„æ¦‚å¿µ #\ræ¨¡æ¿å°±æ˜¯å»ºç«‹é€šç”¨çš„æ¨¡å…·ï¼Œå¤§å¤§æé«˜å¤ç”¨æ€§\næ¨¡æ¿çš„ç‰¹ç‚¹ï¼š\næ¨¡æ¿ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ¡†æ¶ æ¨¡æ¿çš„é€šç”¨å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ 1.2 å‡½æ•°æ¨¡æ¿ #\rC++å¦ä¸€ç§ç¼–ç¨‹æ€æƒ³ç§°ä¸º ==æ³›å‹ç¼–ç¨‹== ï¼Œä¸»è¦åˆ©ç”¨çš„æŠ€æœ¯å°±æ˜¯æ¨¡æ¿\nC++æä¾›ä¸¤ç§æ¨¡æ¿æœºåˆ¶:å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿\n1.2.1 å‡½æ•°æ¨¡æ¿è¯­æ³• #\rå‡½æ•°æ¨¡æ¿ä½œç”¨ï¼š\nå»ºç«‹ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œå…¶å‡½æ•°è¿”å›å€¼ç±»å‹å’Œå½¢å‚ç±»å‹å¯ä»¥ä¸å…·ä½“åˆ¶å®šï¼Œç”¨ä¸€ä¸ªè™šæ‹Ÿçš„ç±»å‹æ¥ä»£è¡¨ã€‚\nè¯­æ³•ï¼š\ntemplate\u0026lt;typename T\u0026gt; å‡½æ•°å£°æ˜æˆ–å®šä¹‰ è§£é‡Šï¼š\ntemplate \u0026mdash; å£°æ˜åˆ›å»ºæ¨¡æ¿\ntypename \u0026mdash; è¡¨é¢å…¶åé¢çš„ç¬¦å·æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç”¨classä»£æ›¿\nT \u0026mdash; é€šç”¨çš„æ•°æ®ç±»å‹ï¼Œåç§°å¯ä»¥æ›¿æ¢ï¼Œé€šå¸¸ä¸ºå¤§å†™å­—æ¯\nç¤ºä¾‹ï¼š\n//äº¤æ¢æ•´å‹å‡½æ•° void swapInt(int\u0026amp; a, int\u0026amp; b) { int temp = a; a = b; b = temp; } //äº¤æ¢æµ®ç‚¹å‹å‡½æ•° void swapDouble(double\u0026amp; a, double\u0026amp; b) { double temp = a; a = b; b = temp; } //åˆ©ç”¨æ¨¡æ¿æä¾›é€šç”¨çš„äº¤æ¢å‡½æ•° template\u0026lt;typename T\u0026gt; void mySwap(T\u0026amp; a, T\u0026amp; b) { T temp = a; a = b; b = temp; } void test01() { int a = 10; int b = 20; //swapInt(a, b); //åˆ©ç”¨æ¨¡æ¿å®ç°äº¤æ¢ //1ã€è‡ªåŠ¨ç±»å‹æ¨å¯¼ mySwap(a, b); //2ã€æ˜¾ç¤ºæŒ‡å®šç±»å‹ mySwap\u0026lt;int\u0026gt;(a, b); cout \u0026lt;\u0026lt; \u0026#34;a = \u0026#34; \u0026lt;\u0026lt; a \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;b = \u0026#34; \u0026lt;\u0026lt; b \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå‡½æ•°æ¨¡æ¿åˆ©ç”¨å…³é”®å­— template ä½¿ç”¨å‡½æ•°æ¨¡æ¿æœ‰ä¸¤ç§æ–¹å¼ï¼šè‡ªåŠ¨ç±»å‹æ¨å¯¼ã€æ˜¾ç¤ºæŒ‡å®šç±»å‹ æ¨¡æ¿çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜å¤ç”¨æ€§ï¼Œå°†ç±»å‹å‚æ•°åŒ– 1.2.2 å‡½æ•°æ¨¡æ¿æ³¨æ„äº‹é¡¹ #\ræ³¨æ„äº‹é¡¹ï¼š\nè‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œå¿…é¡»æ¨å¯¼å‡ºä¸€è‡´çš„æ•°æ®ç±»å‹T,æ‰å¯ä»¥ä½¿ç”¨\næ¨¡æ¿å¿…é¡»è¦ç¡®å®šå‡ºTçš„æ•°æ®ç±»å‹ï¼Œæ‰å¯ä»¥ä½¿ç”¨\nç¤ºä¾‹ï¼š\n//åˆ©ç”¨æ¨¡æ¿æä¾›é€šç”¨çš„äº¤æ¢å‡½æ•° template\u0026lt;class T\u0026gt; void mySwap(T\u0026amp; a, T\u0026amp; b) { T temp = a; a = b; b = temp; } // 1ã€è‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œå¿…é¡»æ¨å¯¼å‡ºä¸€è‡´çš„æ•°æ®ç±»å‹T,æ‰å¯ä»¥ä½¿ç”¨ void test01() { int a = 10; int b = 20; char c = \u0026#39;c\u0026#39;; mySwap(a, b); // æ­£ç¡®ï¼Œå¯ä»¥æ¨å¯¼å‡ºä¸€è‡´çš„T //mySwap(a, c); // é”™è¯¯ï¼Œæ¨å¯¼ä¸å‡ºä¸€è‡´çš„Tç±»å‹ } // 2ã€æ¨¡æ¿å¿…é¡»è¦ç¡®å®šå‡ºTçš„æ•°æ®ç±»å‹ï¼Œæ‰å¯ä»¥ä½¿ç”¨ template\u0026lt;class T\u0026gt; void func() { cout \u0026lt;\u0026lt; \u0026#34;func è°ƒç”¨\u0026#34; \u0026lt;\u0026lt; endl; } void test02() { //func(); //é”™è¯¯ï¼Œæ¨¡æ¿ä¸èƒ½ç‹¬ç«‹ä½¿ç”¨ï¼Œå¿…é¡»ç¡®å®šå‡ºTçš„ç±»å‹ func\u0026lt;int\u0026gt;(); //åˆ©ç”¨æ˜¾ç¤ºæŒ‡å®šç±»å‹çš„æ–¹å¼ï¼Œç»™Tä¸€ä¸ªç±»å‹ï¼Œæ‰å¯ä»¥ä½¿ç”¨è¯¥æ¨¡æ¿ } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nä½¿ç”¨æ¨¡æ¿æ—¶å¿…é¡»ç¡®å®šå‡ºé€šç”¨æ•°æ®ç±»å‹Tï¼Œå¹¶ä¸”èƒ½å¤Ÿæ¨å¯¼å‡ºä¸€è‡´çš„ç±»å‹ 1.2.3 å‡½æ•°æ¨¡æ¿æ¡ˆä¾‹ #\ræ¡ˆä¾‹æè¿°ï¼š\nåˆ©ç”¨å‡½æ•°æ¨¡æ¿å°è£…ä¸€ä¸ªæ’åºçš„å‡½æ•°ï¼Œå¯ä»¥å¯¹ä¸åŒæ•°æ®ç±»å‹æ•°ç»„è¿›è¡Œæ’åº æ’åºè§„åˆ™ä»å¤§åˆ°å°ï¼Œæ’åºç®—æ³•ä¸ºé€‰æ‹©æ’åº åˆ†åˆ«åˆ©ç”¨charæ•°ç»„å’Œintæ•°ç»„è¿›è¡Œæµ‹è¯• ç¤ºä¾‹ï¼š\n//äº¤æ¢çš„å‡½æ•°æ¨¡æ¿ template\u0026lt;typename T\u0026gt; void mySwap(T \u0026amp;a, T\u0026amp;b) { T temp = a; a = b; b = temp; } template\u0026lt;class T\u0026gt; // ä¹Ÿå¯ä»¥æ›¿æ¢æˆtypename //åˆ©ç”¨é€‰æ‹©æ’åºï¼Œè¿›è¡Œå¯¹æ•°ç»„ä»å¤§åˆ°å°çš„æ’åº void mySort(T arr[], int len) { for (int i = 0; i \u0026lt; len; i++) { int max = i; //æœ€å¤§æ•°çš„ä¸‹æ ‡ for (int j = i + 1; j \u0026lt; len; j++) { if (arr[max] \u0026lt; arr[j]) { max = j; } } if (max != i) //å¦‚æœæœ€å¤§æ•°çš„ä¸‹æ ‡ä¸æ˜¯iï¼Œäº¤æ¢ä¸¤è€… { mySwap(arr[max], arr[i]); } } } template\u0026lt;typename T\u0026gt; void printArray(T arr[], int len) { for (int i = 0; i \u0026lt; len; i++) { cout \u0026lt;\u0026lt; arr[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } void test01() { //æµ‹è¯•charæ•°ç»„ char charArr[] = \u0026#34;bdcfeagh\u0026#34;; int num = sizeof(charArr) / sizeof(char); mySort(charArr, num); printArray(charArr, num); } void test02() { //æµ‹è¯•intæ•°ç»„ int intArr[] = { 7, 5, 8, 1, 3, 9, 2, 4, 6 }; int num = sizeof(intArr) / sizeof(int); mySort(intArr, num); printArray(intArr, num); } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šæ¨¡æ¿å¯ä»¥æé«˜ä»£ç å¤ç”¨ï¼Œéœ€è¦ç†Ÿç»ƒæŒæ¡\n1.2.4 æ™®é€šå‡½æ•°ä¸å‡½æ•°æ¨¡æ¿çš„åŒºåˆ« #\ræ™®é€šå‡½æ•°ä¸å‡½æ•°æ¨¡æ¿åŒºåˆ«ï¼š\næ™®é€šå‡½æ•°è°ƒç”¨æ—¶å¯ä»¥å‘ç”Ÿè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆéšå¼ç±»å‹è½¬æ¢ï¼‰ å‡½æ•°æ¨¡æ¿è°ƒç”¨æ—¶ï¼Œå¦‚æœåˆ©ç”¨è‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œä¸ä¼šå‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ å¦‚æœåˆ©ç”¨æ˜¾ç¤ºæŒ‡å®šç±»å‹çš„æ–¹å¼ï¼Œå¯ä»¥å‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ ç¤ºä¾‹ï¼š\n//æ™®é€šå‡½æ•° int myAdd01(int a, int b) { return a + b; } //å‡½æ•°æ¨¡æ¿ template\u0026lt;class T\u0026gt; T myAdd02(T a, T b) { return a + b; } //ä½¿ç”¨å‡½æ•°æ¨¡æ¿æ—¶ï¼Œå¦‚æœç”¨è‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œä¸ä¼šå‘ç”Ÿè‡ªåŠ¨ç±»å‹è½¬æ¢,å³éšå¼ç±»å‹è½¬æ¢ void test01() { int a = 10; int b = 20; char c = \u0026#39;c\u0026#39;; cout \u0026lt;\u0026lt; myAdd01(a, c) \u0026lt;\u0026lt; endl; //æ­£ç¡®ï¼Œå°†charç±»å‹çš„\u0026#39;c\u0026#39;éšå¼è½¬æ¢ä¸ºintç±»å‹ \u0026#39;c\u0026#39; å¯¹åº” ASCIIç  99 //myAdd02(a, c); // æŠ¥é”™ï¼Œä½¿ç”¨è‡ªåŠ¨ç±»å‹æ¨å¯¼æ—¶ï¼Œä¸ä¼šå‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ myAdd02\u0026lt;int\u0026gt;(a, c); //æ­£ç¡®ï¼Œå¦‚æœç”¨æ˜¾ç¤ºæŒ‡å®šç±»å‹ï¼Œå¯ä»¥å‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå»ºè®®ä½¿ç”¨æ˜¾ç¤ºæŒ‡å®šç±»å‹çš„æ–¹å¼ï¼Œè°ƒç”¨å‡½æ•°æ¨¡æ¿ï¼Œå› ä¸ºå¯ä»¥è‡ªå·±ç¡®å®šé€šç”¨ç±»å‹T\n1.2.5 æ™®é€šå‡½æ•°ä¸å‡½æ•°æ¨¡æ¿çš„è°ƒç”¨è§„åˆ™ #\rè°ƒç”¨è§„åˆ™å¦‚ä¸‹ï¼š\nå¦‚æœå‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°éƒ½å¯ä»¥å®ç°ï¼Œä¼˜å…ˆè°ƒç”¨æ™®é€šå‡½æ•° å¯ä»¥é€šè¿‡ç©ºæ¨¡æ¿å‚æ•°åˆ—è¡¨æ¥å¼ºåˆ¶è°ƒç”¨å‡½æ•°æ¨¡æ¿ å‡½æ•°æ¨¡æ¿ä¹Ÿå¯ä»¥å‘ç”Ÿé‡è½½ å¦‚æœå‡½æ•°æ¨¡æ¿å¯ä»¥äº§ç”Ÿæ›´å¥½çš„åŒ¹é…,ä¼˜å…ˆè°ƒç”¨å‡½æ•°æ¨¡æ¿ ç¤ºä¾‹ï¼š\n//æ™®é€šå‡½æ•°ä¸å‡½æ•°æ¨¡æ¿è°ƒç”¨è§„åˆ™ void myPrint(int a, int b) { cout \u0026lt;\u0026lt; \u0026#34;è°ƒç”¨çš„æ™®é€šå‡½æ•°\u0026#34; \u0026lt;\u0026lt; endl; } template\u0026lt;typename T\u0026gt; void myPrint(T a, T b) { cout \u0026lt;\u0026lt; \u0026#34;è°ƒç”¨çš„æ¨¡æ¿\u0026#34; \u0026lt;\u0026lt; endl; } template\u0026lt;typename T\u0026gt; void myPrint(T a, T b, T c) { cout \u0026lt;\u0026lt; \u0026#34;è°ƒç”¨é‡è½½çš„æ¨¡æ¿\u0026#34; \u0026lt;\u0026lt; endl; } void test01() { //1ã€å¦‚æœå‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°éƒ½å¯ä»¥å®ç°ï¼Œä¼˜å…ˆè°ƒç”¨æ™®é€šå‡½æ•° // æ³¨æ„ å¦‚æœå‘Šè¯‰ç¼–è¯‘å™¨ æ™®é€šå‡½æ•°æ˜¯æœ‰çš„ï¼Œä½†åªæ˜¯å£°æ˜æ²¡æœ‰å®ç°ï¼Œæˆ–è€…ä¸åœ¨å½“å‰æ–‡ä»¶å†…å®ç°ï¼Œå°±ä¼šæŠ¥é”™æ‰¾ä¸åˆ° int a = 10; int b = 20; myPrint(a, b); //è°ƒç”¨æ™®é€šå‡½æ•° //2ã€å¯ä»¥é€šè¿‡ç©ºæ¨¡æ¿å‚æ•°åˆ—è¡¨æ¥å¼ºåˆ¶è°ƒç”¨å‡½æ•°æ¨¡æ¿ myPrint\u0026lt;\u0026gt;(a, b); //è°ƒç”¨å‡½æ•°æ¨¡æ¿ //3ã€å‡½æ•°æ¨¡æ¿ä¹Ÿå¯ä»¥å‘ç”Ÿé‡è½½ int c = 30; myPrint(a, b, c); //è°ƒç”¨é‡è½½çš„å‡½æ•°æ¨¡æ¿ //4ã€ å¦‚æœå‡½æ•°æ¨¡æ¿å¯ä»¥äº§ç”Ÿæ›´å¥½çš„åŒ¹é…,ä¼˜å…ˆè°ƒç”¨å‡½æ•°æ¨¡æ¿ char c1 = \u0026#39;a\u0026#39;; char c2 = \u0026#39;b\u0026#39;; myPrint(c1, c2); //è°ƒç”¨å‡½æ•°æ¨¡æ¿ } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šæ—¢ç„¶æä¾›äº†å‡½æ•°æ¨¡æ¿ï¼Œæœ€å¥½å°±ä¸è¦æä¾›æ™®é€šå‡½æ•°ï¼Œå¦åˆ™å®¹æ˜“å‡ºç°äºŒä¹‰æ€§\n1.2.6 æ¨¡æ¿çš„å±€é™æ€§ #\rå±€é™æ€§ï¼š\næ¨¡æ¿çš„é€šç”¨æ€§å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ ä¾‹å¦‚ï¼š\ntemplate\u0026lt;class T\u0026gt; void f(T a, T b) { a = b; } åœ¨ä¸Šè¿°ä»£ç ä¸­æä¾›çš„èµ‹å€¼æ“ä½œï¼Œå¦‚æœä¼ å…¥çš„aå’Œbæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå°±æ— æ³•å®ç°äº†\nå†ä¾‹å¦‚ï¼š\ntemplate\u0026lt;class T\u0026gt; void f(T a, T b) { if(a \u0026gt; b) { ... } } åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœTçš„æ•°æ®ç±»å‹ä¼ å…¥çš„æ˜¯åƒPersonè¿™æ ·çš„è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œä¹Ÿæ— æ³•æ­£å¸¸è¿è¡Œ\nå› æ­¤C++ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œæä¾›æ¨¡æ¿çš„é‡è½½ï¼Œå¯ä»¥ä¸ºè¿™äº›ç‰¹å®šçš„ç±»å‹æä¾›å…·ä½“åŒ–çš„æ¨¡æ¿\nç¤ºä¾‹ï¼š\n#include\u0026lt;iostream\u0026gt; using namespace std; #include \u0026lt;string\u0026gt; class Person { public: Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } string m_Name; int m_Age; }; //æ™®é€šå‡½æ•°æ¨¡æ¿ template\u0026lt;class T\u0026gt; bool myCompare(T\u0026amp; a, T\u0026amp; b) { if (a == b) { return true; } else { return false; } } //å…·ä½“åŒ–ï¼Œæ˜¾ç¤ºå…·ä½“åŒ–çš„åŸå‹å’Œå®šæ„æ€ä»¥template\u0026lt;\u0026gt;å¼€å¤´ï¼Œå¹¶é€šè¿‡åç§°æ¥æŒ‡å‡ºç±»å‹ //å…·ä½“åŒ–ä¼˜å…ˆäºå¸¸è§„æ¨¡æ¿ template\u0026lt;\u0026gt; bool myCompare(Person \u0026amp;p1, Person \u0026amp;p2) { if ( p1.m_Name == p2.m_Name \u0026amp;\u0026amp; p1.m_Age == p2.m_Age) { return true; } else { return false; } } void test01() { int a = 10; int b = 20; //å†…ç½®æ•°æ®ç±»å‹å¯ä»¥ç›´æ¥ä½¿ç”¨é€šç”¨çš„å‡½æ•°æ¨¡æ¿ bool ret = myCompare(a, b); if (ret) { cout \u0026lt;\u0026lt; \u0026#34;a == b \u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;a != b \u0026#34; \u0026lt;\u0026lt; endl; } } void test02() { Person p1(\u0026#34;Tom\u0026#34;, 10); Person p2(\u0026#34;Tom\u0026#34;, 10); //è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œä¸ä¼šè°ƒç”¨æ™®é€šçš„å‡½æ•°æ¨¡æ¿ //å¯ä»¥åˆ›å»ºå…·ä½“åŒ–çš„Personæ•°æ®ç±»å‹çš„æ¨¡æ¿ï¼Œç”¨äºç‰¹æ®Šå¤„ç†è¿™ä¸ªç±»å‹ bool ret = myCompare(p1, p2); if (ret) { cout \u0026lt;\u0026lt; \u0026#34;p1 == p2 \u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;p1 != p2 \u0026#34; \u0026lt;\u0026lt; endl; } } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nåˆ©ç”¨å…·ä½“åŒ–çš„æ¨¡æ¿ï¼Œå¯ä»¥è§£å†³è‡ªå®šä¹‰ç±»å‹çš„é€šç”¨åŒ– å­¦ä¹ æ¨¡æ¿å¹¶ä¸æ˜¯ä¸ºäº†å†™æ¨¡æ¿ï¼Œè€Œæ˜¯åœ¨STLèƒ½å¤Ÿè¿ç”¨ç³»ç»Ÿæä¾›çš„æ¨¡æ¿ 1.3 ç±»æ¨¡æ¿ #\r1.3.1 ç±»æ¨¡æ¿è¯­æ³• #\rç±»æ¨¡æ¿ä½œç”¨ï¼š\nå»ºç«‹ä¸€ä¸ªé€šç”¨ç±»ï¼Œç±»ä¸­çš„æˆå‘˜ æ•°æ®ç±»å‹å¯ä»¥ä¸å…·ä½“åˆ¶å®šï¼Œç”¨ä¸€ä¸ªè™šæ‹Ÿçš„ç±»å‹æ¥ä»£è¡¨ã€‚ è¯­æ³•ï¼š\ntemplate\u0026lt;typename T\u0026gt; ç±» è§£é‡Šï¼š\ntemplate \u0026mdash; å£°æ˜åˆ›å»ºæ¨¡æ¿\ntypename \u0026mdash; è¡¨é¢å…¶åé¢çš„ç¬¦å·æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç”¨classä»£æ›¿\nT \u0026mdash; é€šç”¨çš„æ•°æ®ç±»å‹ï¼Œåç§°å¯ä»¥æ›¿æ¢ï¼Œé€šå¸¸ä¸ºå¤§å†™å­—æ¯\nç¤ºä¾‹ï¼š\n#include \u0026lt;string\u0026gt; //ç±»æ¨¡æ¿ template\u0026lt;class NameType, class AgeType\u0026gt; class Person { public: Person(NameType name, AgeType age) { this-\u0026gt;mName = name; this-\u0026gt;mAge = age; } void showPerson() { cout \u0026lt;\u0026lt; \u0026#34;name: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;mName \u0026lt;\u0026lt; \u0026#34; age: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;mAge \u0026lt;\u0026lt; endl; } public: NameType mName; AgeType mAge; }; void test01() { // æŒ‡å®šNameType ä¸ºstringç±»å‹ï¼ŒAgeType ä¸º intç±»å‹ Person\u0026lt;string, int\u0026gt;P1(\u0026#34;å­™æ‚Ÿç©º\u0026#34;, 999); P1.showPerson(); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šç±»æ¨¡æ¿å’Œå‡½æ•°æ¨¡æ¿è¯­æ³•ç›¸ä¼¼ï¼Œåœ¨å£°æ˜æ¨¡æ¿templateåé¢åŠ ç±»ï¼Œæ­¤ç±»ç§°ä¸ºç±»æ¨¡æ¿\n1.3.2 ç±»æ¨¡æ¿ä¸å‡½æ•°æ¨¡æ¿åŒºåˆ« #\rç±»æ¨¡æ¿ä¸å‡½æ•°æ¨¡æ¿åŒºåˆ«ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š\nç±»æ¨¡æ¿æ²¡æœ‰è‡ªåŠ¨ç±»å‹æ¨å¯¼çš„ä½¿ç”¨æ–¹å¼ ç±»æ¨¡æ¿åœ¨æ¨¡æ¿å‚æ•°åˆ—è¡¨ä¸­å¯ä»¥æœ‰é»˜è®¤å‚æ•° ç¤ºä¾‹ï¼š\n#include \u0026lt;string\u0026gt; //ç±»æ¨¡æ¿ template\u0026lt;class NameType, class AgeType = int\u0026gt; class Person { public: Person(NameType name, AgeType age) { this-\u0026gt;mName = name; this-\u0026gt;mAge = age; } void showPerson() { cout \u0026lt;\u0026lt; \u0026#34;name: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;mName \u0026lt;\u0026lt; \u0026#34; age: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;mAge \u0026lt;\u0026lt; endl; } public: NameType mName; AgeType mAge; }; //1ã€ç±»æ¨¡æ¿æ²¡æœ‰è‡ªåŠ¨ç±»å‹æ¨å¯¼çš„ä½¿ç”¨æ–¹å¼ void test01() { // Person p(\u0026#34;å­™æ‚Ÿç©º\u0026#34;, 1000); // é”™è¯¯ ç±»æ¨¡æ¿ä½¿ç”¨æ—¶å€™ï¼Œä¸å¯ä»¥ç”¨è‡ªåŠ¨ç±»å‹æ¨å¯¼ Person \u0026lt;string ,int\u0026gt;p(\u0026#34;å­™æ‚Ÿç©º\u0026#34;, 1000); //å¿…é¡»ä½¿ç”¨æ˜¾ç¤ºæŒ‡å®šç±»å‹çš„æ–¹å¼ï¼Œä½¿ç”¨ç±»æ¨¡æ¿ p.showPerson(); } //2ã€ç±»æ¨¡æ¿åœ¨æ¨¡æ¿å‚æ•°åˆ—è¡¨ä¸­å¯ä»¥æœ‰é»˜è®¤å‚æ•° void test02() { Person \u0026lt;string\u0026gt; p(\u0026#34;çŒªå…«æˆ’\u0026#34;, 999); //ç±»æ¨¡æ¿ä¸­çš„æ¨¡æ¿å‚æ•°åˆ—è¡¨ å¯ä»¥æŒ‡å®šé»˜è®¤å‚æ•° p.showPerson(); } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nç±»æ¨¡æ¿ä½¿ç”¨åªèƒ½ç”¨æ˜¾ç¤ºæŒ‡å®šç±»å‹æ–¹å¼ ç±»æ¨¡æ¿ä¸­çš„æ¨¡æ¿å‚æ•°åˆ—è¡¨å¯ä»¥æœ‰é»˜è®¤å‚æ•° 1.3.3 ç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°åˆ›å»ºæ—¶æœº #\rç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°å’Œæ™®é€šç±»ä¸­æˆå‘˜å‡½æ•°åˆ›å»ºæ—¶æœºæ˜¯æœ‰åŒºåˆ«çš„ï¼š\næ™®é€šç±»ä¸­çš„æˆå‘˜å‡½æ•°ä¸€å¼€å§‹å°±å¯ä»¥åˆ›å»º ç±»æ¨¡æ¿ä¸­çš„æˆå‘˜å‡½æ•°åœ¨è°ƒç”¨æ—¶æ‰åˆ›å»º ç¤ºä¾‹ï¼š\nclass Person1 { public: void showPerson1() { cout \u0026lt;\u0026lt; \u0026#34;Person1 show\u0026#34; \u0026lt;\u0026lt; endl; } }; class Person2 { public: void showPerson2() { cout \u0026lt;\u0026lt; \u0026#34;Person2 show\u0026#34; \u0026lt;\u0026lt; endl; } }; template\u0026lt;class T\u0026gt; class MyClass { public: T obj; //ç±»æ¨¡æ¿ä¸­çš„æˆå‘˜å‡½æ•°ï¼Œå¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±åˆ›å»ºçš„ï¼Œè€Œæ˜¯åœ¨æ¨¡æ¿è°ƒç”¨æ—¶å†ç”Ÿæˆ void fun1() { obj.showPerson1(); } void fun2() { obj.showPerson2(); } }; void test01() { MyClass\u0026lt;Person1\u0026gt; m; m.fun1(); //m.fun2();//ç¼–è¯‘ä¼šå‡ºé”™ï¼Œè¯´æ˜å‡½æ•°è°ƒç”¨æ‰ä¼šå»åˆ›å»ºæˆå‘˜å‡½æ•° } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šç±»æ¨¡æ¿ä¸­çš„æˆå‘˜å‡½æ•°å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±åˆ›å»ºçš„ï¼Œåœ¨è°ƒç”¨æ—¶æ‰å»åˆ›å»º\n1.3.4 ç±»æ¨¡æ¿å¯¹è±¡åšå‡½æ•°å‚æ•° #\rå­¦ä¹ ç›®æ ‡ï¼š\nç±»æ¨¡æ¿å®ä¾‹åŒ–å‡ºçš„å¯¹è±¡ï¼Œå‘å‡½æ•°ä¼ å‚çš„æ–¹å¼ ä¸€å…±æœ‰ä¸‰ç§ä¼ å…¥æ–¹å¼ï¼š\næŒ‡å®šä¼ å…¥çš„ç±»å‹ \u0026mdash; ç›´æ¥æ˜¾ç¤ºå¯¹è±¡çš„æ•°æ®ç±»å‹ å‚æ•°æ¨¡æ¿åŒ– \u0026mdash; å°†å¯¹è±¡ä¸­çš„å‚æ•°å˜ä¸ºæ¨¡æ¿è¿›è¡Œä¼ é€’ æ•´ä¸ªç±»æ¨¡æ¿åŒ– \u0026mdash; å°†è¿™ä¸ªå¯¹è±¡ç±»å‹ æ¨¡æ¿åŒ–è¿›è¡Œä¼ é€’ ç¤ºä¾‹ï¼š\n#include \u0026lt;string\u0026gt; //ç±»æ¨¡æ¿ template\u0026lt;class NameType, class AgeType = int\u0026gt; class Person { public: Person(NameType name, AgeType age) { this-\u0026gt;mName = name; this-\u0026gt;mAge = age; } void showPerson() { cout \u0026lt;\u0026lt; \u0026#34;name: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;mName \u0026lt;\u0026lt; \u0026#34; age: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;mAge \u0026lt;\u0026lt; endl; } public: NameType mName; AgeType mAge; }; //1ã€æŒ‡å®šä¼ å…¥çš„ç±»å‹ void printPerson1(Person\u0026lt;string, int\u0026gt; \u0026amp;p) { p.showPerson(); } void test01() { Person \u0026lt;string, int \u0026gt;p(\u0026#34;å­™æ‚Ÿç©º\u0026#34;, 100); printPerson1(p); } //2ã€å‚æ•°æ¨¡æ¿åŒ– template \u0026lt;class T1, class T2\u0026gt; void printPerson2(Person\u0026lt;T1, T2\u0026gt;\u0026amp;p) { p.showPerson(); cout \u0026lt;\u0026lt; \u0026#34;T1çš„ç±»å‹ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; typeid(T1).name() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;T2çš„ç±»å‹ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; typeid(T2).name() \u0026lt;\u0026lt; endl; } void test02() { Person \u0026lt;string, int \u0026gt;p(\u0026#34;çŒªå…«æˆ’\u0026#34;, 90); printPerson2(p); } //3ã€æ•´ä¸ªç±»æ¨¡æ¿åŒ– template\u0026lt;class T\u0026gt; void printPerson3(T \u0026amp; p) { cout \u0026lt;\u0026lt; \u0026#34;Tçš„ç±»å‹ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; typeid(T).name() \u0026lt;\u0026lt; endl; p.showPerson(); } void test03() { Person \u0026lt;string, int \u0026gt;p(\u0026#34;å”åƒ§\u0026#34;, 30); printPerson3(p); } int main() { test01(); test02(); test03(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\né€šè¿‡ç±»æ¨¡æ¿åˆ›å»ºçš„å¯¹è±¡ï¼Œå¯ä»¥æœ‰ä¸‰ç§æ–¹å¼å‘å‡½æ•°ä¸­è¿›è¡Œä¼ å‚ ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›æ˜¯ç¬¬ä¸€ç§ï¼šæŒ‡å®šä¼ å…¥çš„ç±»å‹ 1.3.5 ç±»æ¨¡æ¿ä¸ç»§æ‰¿ #\rå½“ç±»æ¨¡æ¿ç¢°åˆ°ç»§æ‰¿æ—¶ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š\nå½“å­ç±»ç»§æ‰¿çš„çˆ¶ç±»æ˜¯ä¸€ä¸ªç±»æ¨¡æ¿æ—¶ï¼Œå­ç±»åœ¨å£°æ˜çš„æ—¶å€™ï¼Œè¦æŒ‡å®šå‡ºçˆ¶ç±»ä¸­Tçš„ç±»å‹ å¦‚æœä¸æŒ‡å®šï¼Œç¼–è¯‘å™¨æ— æ³•ç»™å­ç±»åˆ†é…å†…å­˜ å¦‚æœæƒ³çµæ´»æŒ‡å®šå‡ºçˆ¶ç±»ä¸­Tçš„ç±»å‹ï¼Œå­ç±»ä¹Ÿéœ€å˜ä¸ºç±»æ¨¡æ¿ ç¤ºä¾‹ï¼š\ntemplate\u0026lt;class T\u0026gt; class Base { T m; }; //class Son:public Base //é”™è¯¯ï¼Œc++ç¼–è¯‘éœ€è¦ç»™å­ç±»åˆ†é…å†…å­˜ï¼Œå¿…é¡»çŸ¥é“çˆ¶ç±»ä¸­Tçš„ç±»å‹æ‰å¯ä»¥å‘ä¸‹ç»§æ‰¿ class Son :public Base\u0026lt;int\u0026gt; //å¿…é¡»æŒ‡å®šä¸€ä¸ªç±»å‹ { }; void test01() { Son c; } //ç±»æ¨¡æ¿ç»§æ‰¿ç±»æ¨¡æ¿ ,å¯ä»¥ç”¨T2æŒ‡å®šçˆ¶ç±»ä¸­çš„Tç±»å‹ template\u0026lt;class T1, class T2\u0026gt; class Son2 :public Base\u0026lt;T2\u0026gt; { public: Son2() { cout \u0026lt;\u0026lt; typeid(T1).name() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; typeid(T2).name() \u0026lt;\u0026lt; endl; } }; void test02() { Son2\u0026lt;int, char\u0026gt; child1; } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå¦‚æœçˆ¶ç±»æ˜¯ç±»æ¨¡æ¿ï¼Œå­ç±»éœ€è¦æŒ‡å®šå‡ºçˆ¶ç±»ä¸­Tçš„æ•°æ®ç±»å‹\n1.3.6 ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°ç±»å¤–å®ç° #\rå­¦ä¹ ç›®æ ‡ï¼šèƒ½å¤ŸæŒæ¡ç±»æ¨¡æ¿ä¸­çš„æˆå‘˜å‡½æ•°ç±»å¤–å®ç°\nç¤ºä¾‹ï¼š\n#include \u0026lt;string\u0026gt; //ç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; class Person { public: //æˆå‘˜å‡½æ•°ç±»å†…å£°æ˜ Person(T1 name, T2 age); void showPerson(); public: T1 m_Name; T2 m_Age; }; //æ„é€ å‡½æ•° ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; Person\u0026lt;T1, T2\u0026gt;::Person(T1 name, T2 age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } //æˆå‘˜å‡½æ•° ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; void Person\u0026lt;T1, T2\u0026gt;::showPerson() { cout \u0026lt;\u0026lt; \u0026#34;å§“å: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„:\u0026#34; \u0026lt;\u0026lt; this-\u0026gt;m_Age \u0026lt;\u0026lt; endl; } void test01() { Person\u0026lt;string, int\u0026gt; p(\u0026#34;Tom\u0026#34;, 20); p.showPerson(); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°ç±»å¤–å®ç°æ—¶ï¼Œéœ€è¦åŠ ä¸Šæ¨¡æ¿å‚æ•°åˆ—è¡¨\n1.3.7 ç±»æ¨¡æ¿åˆ†æ–‡ä»¶ç¼–å†™ #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°åˆ†æ–‡ä»¶ç¼–å†™äº§ç”Ÿçš„é—®é¢˜ä»¥åŠè§£å†³æ–¹å¼ é—®é¢˜ï¼š\nç±»æ¨¡æ¿ä¸­æˆå‘˜å‡½æ•°åˆ›å»ºæ—¶æœºæ˜¯åœ¨è°ƒç”¨é˜¶æ®µï¼Œå¯¼è‡´åˆ†æ–‡ä»¶ç¼–å†™æ—¶é“¾æ¥ä¸åˆ° è§£å†³ï¼š\nè§£å†³æ–¹å¼1ï¼šç›´æ¥åŒ…å«.cppæºæ–‡ä»¶ è§£å†³æ–¹å¼2ï¼šå°†å£°æ˜å’Œå®ç°å†™åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶æ›´æ”¹åç¼€åä¸º.hppï¼Œhppæ˜¯çº¦å®šçš„åç§°ï¼Œå¹¶ä¸æ˜¯å¼ºåˆ¶ ç¤ºä¾‹ï¼š\nperson.hppä¸­ä»£ç ï¼š\n#pragma once #include \u0026lt;iostream\u0026gt; using namespace std; #include \u0026lt;string\u0026gt; template\u0026lt;class T1, class T2\u0026gt; class Person { public: Person(T1 name, T2 age); void showPerson(); public: T1 m_Name; T2 m_Age; }; //æ„é€ å‡½æ•° ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; Person\u0026lt;T1, T2\u0026gt;::Person(T1 name, T2 age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } //æˆå‘˜å‡½æ•° ç±»å¤–å®ç° template\u0026lt;class T1, class T2\u0026gt; void Person\u0026lt;T1, T2\u0026gt;::showPerson() { cout \u0026lt;\u0026lt; \u0026#34;å§“å: \u0026#34; \u0026lt;\u0026lt; this-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„:\u0026#34; \u0026lt;\u0026lt; this-\u0026gt;m_Age \u0026lt;\u0026lt; endl; } ç±»æ¨¡æ¿åˆ†æ–‡ä»¶ç¼–å†™.cppä¸­ä»£ç \n#include\u0026lt;iostream\u0026gt; using namespace std; //#include \u0026#34;person.h\u0026#34; #include \u0026#34;person.cpp\u0026#34; //è§£å†³æ–¹å¼1ï¼ŒåŒ…å«cppæºæ–‡ä»¶ //è§£å†³æ–¹å¼2ï¼Œå°†å£°æ˜å’Œå®ç°å†™åˆ°ä¸€èµ·ï¼Œæ–‡ä»¶åç¼€åæ”¹ä¸º.hpp #include \u0026#34;person.hpp\u0026#34; void test01() { Person\u0026lt;string, int\u0026gt; p(\u0026#34;Tom\u0026#34;, 10); p.showPerson(); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šä¸»æµçš„è§£å†³æ–¹å¼æ˜¯ç¬¬äºŒç§ï¼Œå°†ç±»æ¨¡æ¿æˆå‘˜å‡½æ•°å†™åˆ°ä¸€èµ·ï¼Œå¹¶å°†åç¼€åæ”¹ä¸º.hpp\n1.3.8 ç±»æ¨¡æ¿ä¸å‹å…ƒ #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡ç±»æ¨¡æ¿é…åˆå‹å…ƒå‡½æ•°çš„ç±»å†…å’Œç±»å¤–å®ç° å…¨å±€å‡½æ•°ç±»å†…å®ç° - ç›´æ¥åœ¨ç±»å†…å£°æ˜å‹å…ƒå³å¯\nå…¨å±€å‡½æ•°ç±»å¤–å®ç° - éœ€è¦æå‰è®©ç¼–è¯‘å™¨çŸ¥é“å…¨å±€å‡½æ•°çš„å­˜åœ¨\nç¤ºä¾‹ï¼š\n#include \u0026lt;string\u0026gt; //2ã€å…¨å±€å‡½æ•°é…åˆå‹å…ƒ ç±»å¤–å®ç° - å…ˆåšå‡½æ•°æ¨¡æ¿å£°æ˜ï¼Œä¸‹æ–¹åœ¨åšå‡½æ•°æ¨¡æ¿å®šä¹‰ï¼Œåœ¨åšå‹å…ƒ template\u0026lt;class T1, class T2\u0026gt; class Person; //å¦‚æœå£°æ˜äº†å‡½æ•°æ¨¡æ¿ï¼Œå¯ä»¥å°†å®ç°å†™åˆ°åé¢ï¼Œå¦åˆ™éœ€è¦å°†å®ç°ä½“å†™åˆ°ç±»çš„å‰é¢è®©ç¼–è¯‘å™¨æå‰çœ‹åˆ° //template\u0026lt;class T1, class T2\u0026gt; void printPerson2(Person\u0026lt;T1, T2\u0026gt; \u0026amp; p); template\u0026lt;class T1, class T2\u0026gt; void printPerson2(Person\u0026lt;T1, T2\u0026gt; \u0026amp; p) { cout \u0026lt;\u0026lt; \u0026#34;ç±»å¤–å®ç° ---- å§“åï¼š \u0026#34; \u0026lt;\u0026lt; p.m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š\u0026#34; \u0026lt;\u0026lt; p.m_Age \u0026lt;\u0026lt; endl; } template\u0026lt;class T1, class T2\u0026gt; class Person { //1ã€å…¨å±€å‡½æ•°é…åˆå‹å…ƒ ç±»å†…å®ç° friend void printPerson(Person\u0026lt;T1, T2\u0026gt; \u0026amp; p) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; p.m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š\u0026#34; \u0026lt;\u0026lt; p.m_Age \u0026lt;\u0026lt; endl; } //å…¨å±€å‡½æ•°é…åˆå‹å…ƒ ç±»å¤–å®ç° friend void printPerson2\u0026lt;\u0026gt;(Person\u0026lt;T1, T2\u0026gt; \u0026amp; p); public: Person(T1 name, T2 age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } private: T1 m_Name; T2 m_Age; }; //1ã€å…¨å±€å‡½æ•°åœ¨ç±»å†…å®ç° void test01() { Person \u0026lt;string, int \u0026gt;p(\u0026#34;Tom\u0026#34;, 20); printPerson(p); } //2ã€å…¨å±€å‡½æ•°åœ¨ç±»å¤–å®ç° void test02() { Person \u0026lt;string, int \u0026gt;p(\u0026#34;Jerry\u0026#34;, 30); printPerson2(p); } int main() { //test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå»ºè®®å…¨å±€å‡½æ•°åšç±»å†…å®ç°ï¼Œç”¨æ³•ç®€å•ï¼Œè€Œä¸”ç¼–è¯‘å™¨å¯ä»¥ç›´æ¥è¯†åˆ«\n1.3.9 ç±»æ¨¡æ¿æ¡ˆä¾‹ #\ræ¡ˆä¾‹æè¿°: å®ç°ä¸€ä¸ªé€šç”¨çš„æ•°ç»„ç±»ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š\nå¯ä»¥å¯¹å†…ç½®æ•°æ®ç±»å‹ä»¥åŠè‡ªå®šä¹‰æ•°æ®ç±»å‹çš„æ•°æ®è¿›è¡Œå­˜å‚¨ å°†æ•°ç»„ä¸­çš„æ•°æ®å­˜å‚¨åˆ°å †åŒº æ„é€ å‡½æ•°ä¸­å¯ä»¥ä¼ å…¥æ•°ç»„çš„å®¹é‡ æä¾›å¯¹åº”çš„æ‹·è´æ„é€ å‡½æ•°ä»¥åŠoperator=é˜²æ­¢æµ…æ‹·è´é—®é¢˜ æä¾›å°¾æ’æ³•å’Œå°¾åˆ æ³•å¯¹æ•°ç»„ä¸­çš„æ•°æ®è¿›è¡Œå¢åŠ å’Œåˆ é™¤ å¯ä»¥é€šè¿‡ä¸‹æ ‡çš„æ–¹å¼è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´  å¯ä»¥è·å–æ•°ç»„ä¸­å½“å‰å…ƒç´ ä¸ªæ•°å’Œæ•°ç»„çš„å®¹é‡ ç¤ºä¾‹ï¼š\nmyArray.hppä¸­ä»£ç \n#pragma once #include \u0026lt;iostream\u0026gt; using namespace std; template\u0026lt;class T\u0026gt; class MyArray { public: //æ„é€ å‡½æ•° MyArray(int capacity) { this-\u0026gt;m_Capacity = capacity; this-\u0026gt;m_Size = 0; pAddress = new T[this-\u0026gt;m_Capacity]; } //æ‹·è´æ„é€  MyArray(const MyArray \u0026amp; arr) { this-\u0026gt;m_Capacity = arr.m_Capacity; this-\u0026gt;m_Size = arr.m_Size; this-\u0026gt;pAddress = new T[this-\u0026gt;m_Capacity]; for (int i = 0; i \u0026lt; this-\u0026gt;m_Size; i++) { //å¦‚æœTä¸ºå¯¹è±¡ï¼Œè€Œä¸”è¿˜åŒ…å«æŒ‡é’ˆï¼Œå¿…é¡»éœ€è¦é‡è½½ = æ“ä½œç¬¦ï¼Œå› ä¸ºè¿™ä¸ªç­‰å·ä¸æ˜¯ æ„é€  è€Œæ˜¯èµ‹å€¼ï¼Œ // æ™®é€šç±»å‹å¯ä»¥ç›´æ¥= ä½†æ˜¯æŒ‡é’ˆç±»å‹éœ€è¦æ·±æ‹·è´ this-\u0026gt;pAddress[i] = arr.pAddress[i]; } } //é‡è½½= æ“ä½œç¬¦ é˜²æ­¢æµ…æ‹·è´é—®é¢˜ MyArray\u0026amp; operator=(const MyArray\u0026amp; myarray) { if (this-\u0026gt;pAddress != NULL) { delete[] this-\u0026gt;pAddress; this-\u0026gt;m_Capacity = 0; this-\u0026gt;m_Size = 0; } this-\u0026gt;m_Capacity = myarray.m_Capacity; this-\u0026gt;m_Size = myarray.m_Size; this-\u0026gt;pAddress = new T[this-\u0026gt;m_Capacity]; for (int i = 0; i \u0026lt; this-\u0026gt;m_Size; i++) { this-\u0026gt;pAddress[i] = myarray[i]; } return *this; } //é‡è½½[] æ“ä½œç¬¦ arr[0] T\u0026amp; operator [](int index) { return this-\u0026gt;pAddress[index]; //ä¸è€ƒè™‘è¶Šç•Œï¼Œç”¨æˆ·è‡ªå·±å»å¤„ç† } //å°¾æ’æ³• void Push_back(const T \u0026amp; val) { if (this-\u0026gt;m_Capacity == this-\u0026gt;m_Size) { return; } this-\u0026gt;pAddress[this-\u0026gt;m_Size] = val; this-\u0026gt;m_Size++; } //å°¾åˆ æ³• void Pop_back() { if (this-\u0026gt;m_Size == 0) { return; } this-\u0026gt;m_Size--; } //è·å–æ•°ç»„å®¹é‡ int getCapacity() { return this-\u0026gt;m_Capacity; } //è·å–æ•°ç»„å¤§å° int\tgetSize() { return this-\u0026gt;m_Size; } //ææ„ ~MyArray() { if (this-\u0026gt;pAddress != NULL) { delete[] this-\u0026gt;pAddress; this-\u0026gt;pAddress = NULL; this-\u0026gt;m_Capacity = 0; this-\u0026gt;m_Size = 0; } } private: T * pAddress; //æŒ‡å‘ä¸€ä¸ªå †ç©ºé—´ï¼Œè¿™ä¸ªç©ºé—´å­˜å‚¨çœŸæ­£çš„æ•°æ® int m_Capacity; //å®¹é‡ int m_Size; // å¤§å° }; ç±»æ¨¡æ¿æ¡ˆä¾‹â€”æ•°ç»„ç±»å°è£….cppä¸­\n#include \u0026#34;myArray.hpp\u0026#34; #include \u0026lt;string\u0026gt; void printIntArray(MyArray\u0026lt;int\u0026gt;\u0026amp; arr) { for (int i = 0; i \u0026lt; arr.getSize(); i++) { cout \u0026lt;\u0026lt; arr[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //æµ‹è¯•å†…ç½®æ•°æ®ç±»å‹ void test01() { MyArray\u0026lt;int\u0026gt; array1(10); for (int i = 0; i \u0026lt; 10; i++) { array1.Push_back(i); } cout \u0026lt;\u0026lt; \u0026#34;array1æ‰“å°è¾“å‡ºï¼š\u0026#34; \u0026lt;\u0026lt; endl; printIntArray(array1); cout \u0026lt;\u0026lt; \u0026#34;array1çš„å¤§å°ï¼š\u0026#34; \u0026lt;\u0026lt; array1.getSize() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;array1çš„å®¹é‡ï¼š\u0026#34; \u0026lt;\u0026lt; array1.getCapacity() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;--------------------------\u0026#34; \u0026lt;\u0026lt; endl; MyArray\u0026lt;int\u0026gt; array2(array1); array2.Pop_back(); cout \u0026lt;\u0026lt; \u0026#34;array2æ‰“å°è¾“å‡ºï¼š\u0026#34; \u0026lt;\u0026lt; endl; printIntArray(array2); cout \u0026lt;\u0026lt; \u0026#34;array2çš„å¤§å°ï¼š\u0026#34; \u0026lt;\u0026lt; array2.getSize() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;array2çš„å®¹é‡ï¼š\u0026#34; \u0026lt;\u0026lt; array2.getCapacity() \u0026lt;\u0026lt; endl; } //æµ‹è¯•è‡ªå®šä¹‰æ•°æ®ç±»å‹ class Person { public: Person() {} Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } public: string m_Name; int m_Age; }; void printPersonArray(MyArray\u0026lt;Person\u0026gt;\u0026amp; personArr) { for (int i = 0; i \u0026lt; personArr.getSize(); i++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š\u0026#34; \u0026lt;\u0026lt; personArr[i].m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34; \u0026lt;\u0026lt; personArr[i].m_Age \u0026lt;\u0026lt; endl; } } void test02() { //åˆ›å»ºæ•°ç»„ MyArray\u0026lt;Person\u0026gt; pArray(10); Person p1(\u0026#34;å­™æ‚Ÿç©º\u0026#34;, 30); Person p2(\u0026#34;éŸ©ä¿¡\u0026#34;, 20); Person p3(\u0026#34;å¦²å·±\u0026#34;, 18); Person p4(\u0026#34;ç‹æ˜­å›\u0026#34;, 15); Person p5(\u0026#34;èµµäº‘\u0026#34;, 24); //æ’å…¥æ•°æ® pArray.Push_back(p1); pArray.Push_back(p2); pArray.Push_back(p3); pArray.Push_back(p4); pArray.Push_back(p5); printPersonArray(pArray); cout \u0026lt;\u0026lt; \u0026#34;pArrayçš„å¤§å°ï¼š\u0026#34; \u0026lt;\u0026lt; pArray.getSize() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;pArrayçš„å®¹é‡ï¼š\u0026#34; \u0026lt;\u0026lt; pArray.getCapacity() \u0026lt;\u0026lt; endl; } int main() { //test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nèƒ½å¤Ÿåˆ©ç”¨æ‰€å­¦çŸ¥è¯†ç‚¹å®ç°é€šç”¨çš„æ•°ç»„\n2 STLåˆè¯† #\r2.1 STLçš„è¯ç”Ÿ #\ré•¿ä¹…ä»¥æ¥ï¼Œè½¯ä»¶ç•Œä¸€ç›´å¸Œæœ›å»ºç«‹ä¸€ç§å¯é‡å¤åˆ©ç”¨çš„ä¸œè¥¿\nC++çš„é¢å‘å¯¹è±¡å’Œæ³›å‹ç¼–ç¨‹æ€æƒ³ï¼Œç›®çš„å°±æ˜¯å¤ç”¨æ€§çš„æå‡\nå¤§å¤šæƒ…å†µä¸‹ï¼Œæ•°æ®ç»“æ„å’Œç®—æ³•éƒ½æœªèƒ½æœ‰ä¸€å¥—æ ‡å‡†,å¯¼è‡´è¢«è¿«ä»äº‹å¤§é‡é‡å¤å·¥ä½œ\nä¸ºäº†å»ºç«‹æ•°æ®ç»“æ„å’Œç®—æ³•çš„ä¸€å¥—æ ‡å‡†,è¯ç”Ÿäº†STL\nâ€‹\n2.2 STLåŸºæœ¬æ¦‚å¿µ #\rSTL(Standard Template Library,æ ‡å‡†æ¨¡æ¿åº“) STL ä»å¹¿ä¹‰ä¸Šåˆ†ä¸º: å®¹å™¨(container) ç®—æ³•(algorithm) è¿­ä»£å™¨(iterator) å®¹å™¨å’Œç®—æ³•ä¹‹é—´é€šè¿‡è¿­ä»£å™¨è¿›è¡Œæ— ç¼è¿æ¥ã€‚ STL å‡ ä¹æ‰€æœ‰çš„ä»£ç éƒ½é‡‡ç”¨äº†æ¨¡æ¿ç±»æˆ–è€…æ¨¡æ¿å‡½æ•° 2.3 STLå…­å¤§ç»„ä»¶ #\rSTLå¤§ä½“åˆ†ä¸ºå…­å¤§ç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯:å®¹å™¨ã€ç®—æ³•ã€è¿­ä»£å™¨ã€ä»¿å‡½æ•°ã€é€‚é…å™¨ï¼ˆé…æ¥å™¨ï¼‰ã€ç©ºé—´é…ç½®å™¨\nå®¹å™¨ï¼šå„ç§æ•°æ®ç»“æ„ï¼Œå¦‚vectorã€listã€dequeã€setã€mapç­‰,ç”¨æ¥å­˜æ”¾æ•°æ®ã€‚ ç®—æ³•ï¼šå„ç§å¸¸ç”¨çš„ç®—æ³•ï¼Œå¦‚sortã€findã€copyã€for_eachç­‰ è¿­ä»£å™¨ï¼šæ‰®æ¼”äº†å®¹å™¨ä¸ç®—æ³•ä¹‹é—´çš„èƒ¶åˆå‰‚ã€‚ ä»¿å‡½æ•°ï¼šè¡Œä¸ºç±»ä¼¼å‡½æ•°ï¼Œå¯ä½œä¸ºç®—æ³•çš„æŸç§ç­–ç•¥ã€‚ é€‚é…å™¨ï¼šä¸€ç§ç”¨æ¥ä¿®é¥°å®¹å™¨æˆ–è€…ä»¿å‡½æ•°æˆ–è¿­ä»£å™¨æ¥å£çš„ä¸œè¥¿ã€‚ ç©ºé—´é…ç½®å™¨ï¼šè´Ÿè´£ç©ºé—´çš„é…ç½®ä¸ç®¡ç†ã€‚ 2.4 STLä¸­å®¹å™¨ã€ç®—æ³•ã€è¿­ä»£å™¨ #\r**å®¹å™¨ï¼š**ç½®ç‰©ä¹‹æ‰€ä¹Ÿ\nSTLå®¹å™¨å°±æ˜¯å°†è¿ç”¨æœ€å¹¿æ³›çš„ä¸€äº›æ•°æ®ç»“æ„å®ç°å‡ºæ¥\nå¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼šæ•°ç»„, é“¾è¡¨,æ ‘, æ ˆ, é˜Ÿåˆ—, é›†åˆ, æ˜ å°„è¡¨ ç­‰\nè¿™äº›å®¹å™¨åˆ†ä¸ºåºåˆ—å¼å®¹å™¨å’Œå…³è”å¼å®¹å™¨ä¸¤ç§:\nâ€‹\tåºåˆ—å¼å®¹å™¨:å¼ºè°ƒå€¼çš„æ’åºï¼Œåºåˆ—å¼å®¹å™¨ä¸­çš„æ¯ä¸ªå…ƒç´ å‡æœ‰å›ºå®šçš„ä½ç½®ã€‚ å…³è”å¼å®¹å™¨:äºŒå‰æ ‘ç»“æ„ï¼Œå„å…ƒç´ ä¹‹é—´æ²¡æœ‰ä¸¥æ ¼çš„ç‰©ç†ä¸Šçš„é¡ºåºå…³ç³»\n**ç®—æ³•ï¼š**é—®é¢˜ä¹‹è§£æ³•ä¹Ÿ\næœ‰é™çš„æ­¥éª¤ï¼Œè§£å†³é€»è¾‘æˆ–æ•°å­¦ä¸Šçš„é—®é¢˜ï¼Œè¿™ä¸€é—¨å­¦ç§‘æˆ‘ä»¬å«åšç®—æ³•(Algorithms)\nç®—æ³•åˆ†ä¸º:è´¨å˜ç®—æ³•å’Œéè´¨å˜ç®—æ³•ã€‚\nè´¨å˜ç®—æ³•ï¼šæ˜¯æŒ‡è¿ç®—è¿‡ç¨‹ä¸­ä¼šæ›´æ”¹åŒºé—´å†…çš„å…ƒç´ çš„å†…å®¹ã€‚ä¾‹å¦‚æ‹·è´ï¼Œæ›¿æ¢ï¼Œåˆ é™¤ç­‰ç­‰\néè´¨å˜ç®—æ³•ï¼šæ˜¯æŒ‡è¿ç®—è¿‡ç¨‹ä¸­ä¸ä¼šæ›´æ”¹åŒºé—´å†…çš„å…ƒç´ å†…å®¹ï¼Œä¾‹å¦‚æŸ¥æ‰¾ã€è®¡æ•°ã€éå†ã€å¯»æ‰¾æå€¼ç­‰ç­‰\n**è¿­ä»£å™¨ï¼š**å®¹å™¨å’Œç®—æ³•ä¹‹é—´ç²˜åˆå‰‚\næä¾›ä¸€ç§æ–¹æ³•ï¼Œä½¿ä¹‹èƒ½å¤Ÿä¾åºå¯»è®¿æŸä¸ªå®¹å™¨æ‰€å«çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆæ— éœ€æš´éœ²è¯¥å®¹å™¨çš„å†…éƒ¨è¡¨ç¤ºæ–¹å¼ã€‚\næ¯ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±ä¸“å±çš„è¿­ä»£å™¨\nè¿­ä»£å™¨ä½¿ç”¨éå¸¸ç±»ä¼¼äºæŒ‡é’ˆï¼Œåˆå­¦é˜¶æ®µæˆ‘ä»¬å¯ä»¥å…ˆç†è§£è¿­ä»£å™¨ä¸ºæŒ‡é’ˆ\nè¿­ä»£å™¨ç§ç±»ï¼š\nç§ç±» åŠŸèƒ½ æ”¯æŒè¿ç®— è¾“å…¥è¿­ä»£å™¨ å¯¹æ•°æ®çš„åªè¯»è®¿é—® åªè¯»ï¼Œæ”¯æŒ++ã€==ã€ï¼= è¾“å‡ºè¿­ä»£å™¨ å¯¹æ•°æ®çš„åªå†™è®¿é—® åªå†™ï¼Œæ”¯æŒ++ å‰å‘è¿­ä»£å™¨ è¯»å†™æ“ä½œï¼Œå¹¶èƒ½å‘å‰æ¨è¿›è¿­ä»£å™¨ è¯»å†™ï¼Œæ”¯æŒ++ã€==ã€ï¼= åŒå‘è¿­ä»£å™¨ è¯»å†™æ“ä½œï¼Œå¹¶èƒ½å‘å‰å’Œå‘åæ“ä½œ è¯»å†™ï¼Œæ”¯æŒ++ã€\u0026ndash;ï¼Œ éšæœºè®¿é—®è¿­ä»£å™¨ è¯»å†™æ“ä½œï¼Œå¯ä»¥ä»¥è·³è·ƒçš„æ–¹å¼è®¿é—®ä»»æ„æ•°æ®ï¼ŒåŠŸèƒ½æœ€å¼ºçš„è¿­ä»£å™¨ è¯»å†™ï¼Œæ”¯æŒ++ã€\u0026ndash;ã€[n]ã€-nã€\u0026lt;ã€\u0026lt;=ã€\u0026gt;ã€\u0026gt;= å¸¸ç”¨çš„å®¹å™¨ä¸­è¿­ä»£å™¨ç§ç±»ä¸ºåŒå‘è¿­ä»£å™¨ï¼Œå’Œéšæœºè®¿é—®è¿­ä»£å™¨\n2.5 å®¹å™¨ç®—æ³•è¿­ä»£å™¨åˆè¯† #\räº†è§£STLä¸­å®¹å™¨ã€ç®—æ³•ã€è¿­ä»£å™¨æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬åˆ©ç”¨ä»£ç æ„Ÿå—STLçš„é­…åŠ›\nSTLä¸­æœ€å¸¸ç”¨çš„å®¹å™¨ä¸ºVectorï¼Œå¯ä»¥ç†è§£ä¸ºæ•°ç»„ï¼Œä¸‹é¢æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å‘è¿™ä¸ªå®¹å™¨ä¸­æ’å…¥æ•°æ®ã€å¹¶éå†è¿™ä¸ªå®¹å™¨\n2.5.1 vectorå­˜æ”¾å†…ç½®æ•°æ®ç±»å‹ #\rå®¹å™¨ï¼š vector\nç®—æ³•ï¼š for_each\nè¿­ä»£å™¨ï¼š vector\u0026lt;int\u0026gt;::iterator\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; void MyPrint(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; endl; } void test01() { //åˆ›å»ºvectorå®¹å™¨å¯¹è±¡ï¼Œå¹¶ä¸”é€šè¿‡æ¨¡æ¿å‚æ•°æŒ‡å®šå®¹å™¨ä¸­å­˜æ”¾çš„æ•°æ®çš„ç±»å‹ vector\u0026lt;int\u0026gt; v; //å‘å®¹å™¨ä¸­æ”¾æ•°æ® v.push_back(10); v.push_back(20); v.push_back(30); v.push_back(40); //æ¯ä¸€ä¸ªå®¹å™¨éƒ½æœ‰è‡ªå·±çš„è¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æ˜¯ç”¨æ¥éå†å®¹å™¨ä¸­çš„å…ƒç´  //v.begin()è¿”å›è¿­ä»£å™¨ï¼Œè¿™ä¸ªè¿­ä»£å™¨æŒ‡å‘å®¹å™¨ä¸­ç¬¬ä¸€ä¸ªæ•°æ® //v.end()è¿”å›è¿­ä»£å™¨ï¼Œè¿™ä¸ªè¿­ä»£å™¨æŒ‡å‘å®¹å™¨å…ƒç´ çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½® //vector\u0026lt;int\u0026gt;::iterator æ‹¿åˆ°vector\u0026lt;int\u0026gt;è¿™ç§å®¹å™¨çš„è¿­ä»£å™¨ç±»å‹ vector\u0026lt;int\u0026gt;::iterator pBegin = v.begin(); vector\u0026lt;int\u0026gt;::iterator pEnd = v.end(); //ç¬¬ä¸€ç§éå†æ–¹å¼ï¼š while (pBegin != pEnd) { cout \u0026lt;\u0026lt; *pBegin \u0026lt;\u0026lt; endl; pBegin++; } //ç¬¬äºŒç§éå†æ–¹å¼ï¼š for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; //ç¬¬ä¸‰ç§éå†æ–¹å¼ï¼š //ä½¿ç”¨STLæä¾›æ ‡å‡†éå†ç®—æ³• å¤´æ–‡ä»¶ algorithm for_each(v.begin(), v.end(), MyPrint); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } 2.5.2 Vectorå­˜æ”¾è‡ªå®šä¹‰æ•°æ®ç±»å‹ #\rå­¦ä¹ ç›®æ ‡ï¼švectorä¸­å­˜æ”¾è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå¹¶æ‰“å°è¾“å‡º\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;string\u0026gt; //è‡ªå®šä¹‰æ•°æ®ç±»å‹ class Person { public: Person(string name, int age) { mName = name; mAge = age; } public: string mName; int mAge; }; //å­˜æ”¾å¯¹è±¡ void test01() { vector\u0026lt;Person\u0026gt; v; //åˆ›å»ºæ•°æ® Person p1(\u0026#34;aaa\u0026#34;, 10); Person p2(\u0026#34;bbb\u0026#34;, 20); Person p3(\u0026#34;ccc\u0026#34;, 30); Person p4(\u0026#34;ddd\u0026#34;, 40); Person p5(\u0026#34;eee\u0026#34;, 50); v.push_back(p1); v.push_back(p2); v.push_back(p3); v.push_back(p4); v.push_back(p5); for (vector\u0026lt;Person\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;Name:\u0026#34; \u0026lt;\u0026lt; (*it).mName \u0026lt;\u0026lt; \u0026#34; Age:\u0026#34; \u0026lt;\u0026lt; (*it).mAge \u0026lt;\u0026lt; endl; } } //æ”¾å¯¹è±¡æŒ‡é’ˆ void test02() { vector\u0026lt;Person*\u0026gt; v; //åˆ›å»ºæ•°æ® Person p1(\u0026#34;aaa\u0026#34;, 10); Person p2(\u0026#34;bbb\u0026#34;, 20); Person p3(\u0026#34;ccc\u0026#34;, 30); Person p4(\u0026#34;ddd\u0026#34;, 40); Person p5(\u0026#34;eee\u0026#34;, 50); v.push_back(\u0026amp;p1); v.push_back(\u0026amp;p2); v.push_back(\u0026amp;p3); v.push_back(\u0026amp;p4); v.push_back(\u0026amp;p5); for (vector\u0026lt;Person*\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { Person * p = (*it); cout \u0026lt;\u0026lt; \u0026#34;Name:\u0026#34; \u0026lt;\u0026lt; p-\u0026gt;mName \u0026lt;\u0026lt; \u0026#34; Age:\u0026#34; \u0026lt;\u0026lt; (*it)-\u0026gt;mAge \u0026lt;\u0026lt; endl; } } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } 2.5.3 Vectorå®¹å™¨åµŒå¥—å®¹å™¨ #\rå­¦ä¹ ç›®æ ‡ï¼šå®¹å™¨ä¸­åµŒå¥—å®¹å™¨ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰æ•°æ®è¿›è¡Œéå†è¾“å‡º\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; //å®¹å™¨åµŒå¥—å®¹å™¨ void test01() { vector\u0026lt; vector\u0026lt;int\u0026gt; \u0026gt; v; vector\u0026lt;int\u0026gt; v1; vector\u0026lt;int\u0026gt; v2; vector\u0026lt;int\u0026gt; v3; vector\u0026lt;int\u0026gt; v4; for (int i = 0; i \u0026lt; 4; i++) { v1.push_back(i + 1); v2.push_back(i + 2); v3.push_back(i + 3); v4.push_back(i + 4); } //å°†å®¹å™¨å…ƒç´ æ’å…¥åˆ°vector vä¸­ v.push_back(v1); v.push_back(v2); v.push_back(v3); v.push_back(v4); for (vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { for (vector\u0026lt;int\u0026gt;::iterator vit = (*it).begin(); vit != (*it).end(); vit++) { cout \u0026lt;\u0026lt; *vit \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } 3 STL- å¸¸ç”¨å®¹å™¨ #\r3.1 stringå®¹å™¨ #\r3.1.1 stringåŸºæœ¬æ¦‚å¿µ #\ræœ¬è´¨ï¼š\nstringæ˜¯C++é£æ ¼çš„å­—ç¬¦ä¸²ï¼Œè€Œstringæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç±» stringå’Œchar * åŒºåˆ«ï¼š\nchar * æ˜¯ä¸€ä¸ªæŒ‡é’ˆ stringæ˜¯ä¸€ä¸ªç±»ï¼Œç±»å†…éƒ¨å°è£…äº†char*ï¼Œç®¡ç†è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæ˜¯ä¸€ä¸ªchar*å‹çš„å®¹å™¨ã€‚ ç‰¹ç‚¹ï¼š\nstring ç±»å†…éƒ¨å°è£…äº†å¾ˆå¤šæˆå‘˜æ–¹æ³•\nä¾‹å¦‚ï¼šæŸ¥æ‰¾findï¼Œæ‹·è´copyï¼Œåˆ é™¤delete æ›¿æ¢replaceï¼Œæ’å…¥insert\nstringç®¡ç†char*æ‰€åˆ†é…çš„å†…å­˜ï¼Œä¸ç”¨æ‹…å¿ƒå¤åˆ¶è¶Šç•Œå’Œå–å€¼è¶Šç•Œç­‰ï¼Œç”±ç±»å†…éƒ¨è¿›è¡Œè´Ÿè´£\n3.1.2 stringæ„é€ å‡½æ•° #\ræ„é€ å‡½æ•°åŸå‹ï¼š\nstring(); //åˆ›å»ºä¸€ä¸ªç©ºçš„å­—ç¬¦ä¸² ä¾‹å¦‚: string str; string(const char* s);\t//ä½¿ç”¨å­—ç¬¦ä¸²såˆå§‹åŒ– string(const string\u0026amp; str); //ä½¿ç”¨ä¸€ä¸ªstringå¯¹è±¡åˆå§‹åŒ–å¦ä¸€ä¸ªstringå¯¹è±¡ string(int n, char c); //ä½¿ç”¨nä¸ªå­—ç¬¦cåˆå§‹åŒ– ç¤ºä¾‹ï¼š\n#include \u0026lt;string\u0026gt; //stringæ„é€  void test01() { string s1; //åˆ›å»ºç©ºå­—ç¬¦ä¸²ï¼Œè°ƒç”¨æ— å‚æ„é€ å‡½æ•° cout \u0026lt;\u0026lt; \u0026#34;str1 = \u0026#34; \u0026lt;\u0026lt; s1 \u0026lt;\u0026lt; endl; const char* str = \u0026#34;hello world\u0026#34;; string s2(str); //æŠŠc_stringè½¬æ¢æˆäº†string cout \u0026lt;\u0026lt; \u0026#34;str2 = \u0026#34; \u0026lt;\u0026lt; s2 \u0026lt;\u0026lt; endl; string s3(s2); //è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° cout \u0026lt;\u0026lt; \u0026#34;str3 = \u0026#34; \u0026lt;\u0026lt; s3 \u0026lt;\u0026lt; endl; string s4(10, \u0026#39;a\u0026#39;); cout \u0026lt;\u0026lt; \u0026#34;str3 = \u0026#34; \u0026lt;\u0026lt; s3 \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šstringçš„å¤šç§æ„é€ æ–¹å¼æ²¡æœ‰å¯æ¯”æ€§ï¼Œçµæ´»ä½¿ç”¨å³å¯\n3.1.3 stringèµ‹å€¼æ“ä½œ #\råŠŸèƒ½æè¿°ï¼š\nç»™stringå­—ç¬¦ä¸²è¿›è¡Œèµ‹å€¼ èµ‹å€¼çš„å‡½æ•°åŸå‹ï¼š\nstring\u0026amp; operator=(const char* s); //char*ç±»å‹å­—ç¬¦ä¸² èµ‹å€¼ç»™å½“å‰çš„å­—ç¬¦ä¸² string\u0026amp; operator=(const string \u0026amp;s); //æŠŠå­—ç¬¦ä¸²sèµ‹ç»™å½“å‰çš„å­—ç¬¦ä¸² string\u0026amp; operator=(char c); //å­—ç¬¦èµ‹å€¼ç»™å½“å‰çš„å­—ç¬¦ä¸² string\u0026amp; assign(const char *s); //æŠŠå­—ç¬¦ä¸²sèµ‹ç»™å½“å‰çš„å­—ç¬¦ä¸² string\u0026amp; assign(const char *s, int n); //æŠŠå­—ç¬¦ä¸²sçš„å‰nä¸ªå­—ç¬¦èµ‹ç»™å½“å‰çš„å­—ç¬¦ä¸² string\u0026amp; assign(const string \u0026amp;s); //æŠŠå­—ç¬¦ä¸²sèµ‹ç»™å½“å‰å­—ç¬¦ä¸² string\u0026amp; assign(int n, char c); //ç”¨nä¸ªå­—ç¬¦cèµ‹ç»™å½“å‰å­—ç¬¦ä¸² ç¤ºä¾‹ï¼š\n//èµ‹å€¼ void test01() { string str1; str1 = \u0026#34;hello world\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;str1 = \u0026#34; \u0026lt;\u0026lt; str1 \u0026lt;\u0026lt; endl; string str2; str2 = str1; cout \u0026lt;\u0026lt; \u0026#34;str2 = \u0026#34; \u0026lt;\u0026lt; str2 \u0026lt;\u0026lt; endl; string str3; str3 = \u0026#39;a\u0026#39;; cout \u0026lt;\u0026lt; \u0026#34;str3 = \u0026#34; \u0026lt;\u0026lt; str3 \u0026lt;\u0026lt; endl; string str4; str4.assign(\u0026#34;hello c++\u0026#34;); cout \u0026lt;\u0026lt; \u0026#34;str4 = \u0026#34; \u0026lt;\u0026lt; str4 \u0026lt;\u0026lt; endl; string str5; str5.assign(\u0026#34;hello c++\u0026#34;,5); cout \u0026lt;\u0026lt; \u0026#34;str5 = \u0026#34; \u0026lt;\u0026lt; str5 \u0026lt;\u0026lt; endl; string str6; str6.assign(str5); cout \u0026lt;\u0026lt; \u0026#34;str6 = \u0026#34; \u0026lt;\u0026lt; str6 \u0026lt;\u0026lt; endl; string str7; str7.assign(5, \u0026#39;x\u0026#39;); cout \u0026lt;\u0026lt; \u0026#34;str7 = \u0026#34; \u0026lt;\u0026lt; str7 \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nâ€‹\tstringçš„èµ‹å€¼æ–¹å¼å¾ˆå¤šï¼Œoperator= è¿™ç§æ–¹å¼æ˜¯æ¯”è¾ƒå®ç”¨çš„\n3.1.4 stringå­—ç¬¦ä¸²æ‹¼æ¥ #\råŠŸèƒ½æè¿°ï¼š\nå®ç°åœ¨å­—ç¬¦ä¸²æœ«å°¾æ‹¼æ¥å­—ç¬¦ä¸² å‡½æ•°åŸå‹ï¼š\nstring\u0026amp; operator+=(const char* str); //é‡è½½+=æ“ä½œç¬¦ string\u0026amp; operator+=(const char c); //é‡è½½+=æ“ä½œç¬¦ string\u0026amp; operator+=(const string\u0026amp; str); //é‡è½½+=æ“ä½œç¬¦ string\u0026amp; append(const char *s); //æŠŠå­—ç¬¦ä¸²sè¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²ç»“å°¾ string\u0026amp; append(const char *s, int n); //æŠŠå­—ç¬¦ä¸²sçš„å‰nä¸ªå­—ç¬¦è¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²ç»“å°¾ string\u0026amp; append(const string \u0026amp;s); //åŒoperator+=(const string\u0026amp; str) string\u0026amp; append(const string \u0026amp;s, int pos, int n);//å­—ç¬¦ä¸²sä¸­ä»poså¼€å§‹çš„nä¸ªå­—ç¬¦è¿æ¥åˆ°å­—ç¬¦ä¸²ç»“å°¾ ç¤ºä¾‹ï¼š\n//å­—ç¬¦ä¸²æ‹¼æ¥ void test01() { string str1 = \u0026#34;æˆ‘\u0026#34;; str1 += \u0026#34;çˆ±ç©æ¸¸æˆ\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;str1 = \u0026#34; \u0026lt;\u0026lt; str1 \u0026lt;\u0026lt; endl; str1 += \u0026#39;:\u0026#39;; cout \u0026lt;\u0026lt; \u0026#34;str1 = \u0026#34; \u0026lt;\u0026lt; str1 \u0026lt;\u0026lt; endl; string str2 = \u0026#34;LOL DNF\u0026#34;; str1 += str2; cout \u0026lt;\u0026lt; \u0026#34;str1 = \u0026#34; \u0026lt;\u0026lt; str1 \u0026lt;\u0026lt; endl; string str3 = \u0026#34;I\u0026#34;; str3.append(\u0026#34; love \u0026#34;); str3.append(\u0026#34;game abcde\u0026#34;, 4); //str3.append(str2); str3.append(str2, 4, 3); // ä»ä¸‹æ ‡4ä½ç½®å¼€å§‹ ï¼Œæˆªå–3ä¸ªå­—ç¬¦ï¼Œæ‹¼æ¥åˆ°å­—ç¬¦ä¸²æœ«å°¾ cout \u0026lt;\u0026lt; \u0026#34;str3 = \u0026#34; \u0026lt;\u0026lt; str3 \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå­—ç¬¦ä¸²æ‹¼æ¥çš„é‡è½½ç‰ˆæœ¬å¾ˆå¤šï¼Œåˆå­¦é˜¶æ®µè®°ä½å‡ ç§å³å¯\n3.1.5 stringæŸ¥æ‰¾å’Œæ›¿æ¢ #\råŠŸèƒ½æè¿°ï¼š\næŸ¥æ‰¾ï¼šæŸ¥æ‰¾æŒ‡å®šå­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨ æ›¿æ¢ï¼šåœ¨æŒ‡å®šçš„ä½ç½®æ›¿æ¢å­—ç¬¦ä¸² å‡½æ•°åŸå‹ï¼š\nint find(const string\u0026amp; str, int pos = 0) const; //æŸ¥æ‰¾strç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®,ä»poså¼€å§‹æŸ¥æ‰¾ int find(const char* s, int pos = 0) const; //æŸ¥æ‰¾sç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®,ä»poså¼€å§‹æŸ¥æ‰¾ int find(const char* s, int pos, int n) const; //ä»posä½ç½®æŸ¥æ‰¾sçš„å‰nä¸ªå­—ç¬¦ç¬¬ä¸€æ¬¡ä½ç½® int find(const char c, int pos = 0) const; //æŸ¥æ‰¾å­—ç¬¦cç¬¬ä¸€æ¬¡å‡ºç°ä½ç½® int rfind(const string\u0026amp; str, int pos = npos) const; //æŸ¥æ‰¾stræœ€åä¸€æ¬¡ä½ç½®,ä»poså¼€å§‹æŸ¥æ‰¾ int rfind(const char* s, int pos = npos) const; //æŸ¥æ‰¾sæœ€åä¸€æ¬¡å‡ºç°ä½ç½®,ä»poså¼€å§‹æŸ¥æ‰¾ int rfind(const char* s, int pos, int n) const; //ä»posæŸ¥æ‰¾sçš„å‰nä¸ªå­—ç¬¦æœ€åä¸€æ¬¡ä½ç½® int rfind(const char c, int pos = 0) const; //æŸ¥æ‰¾å­—ç¬¦cæœ€åä¸€æ¬¡å‡ºç°ä½ç½® string\u0026amp; replace(int pos, int n, const string\u0026amp; str); //æ›¿æ¢ä»poså¼€å§‹nä¸ªå­—ç¬¦ä¸ºå­—ç¬¦ä¸²str string\u0026amp; replace(int pos, int n,const char* s); //æ›¿æ¢ä»poså¼€å§‹çš„nä¸ªå­—ç¬¦ä¸ºå­—ç¬¦ä¸²s ç¤ºä¾‹ï¼š\n//æŸ¥æ‰¾å’Œæ›¿æ¢ void test01() { //æŸ¥æ‰¾ string str1 = \u0026#34;abcdefgde\u0026#34;; int pos = str1.find(\u0026#34;de\u0026#34;); if (pos == -1) { cout \u0026lt;\u0026lt; \u0026#34;æœªæ‰¾åˆ°\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;pos = \u0026#34; \u0026lt;\u0026lt; pos \u0026lt;\u0026lt; endl; } pos = str1.rfind(\u0026#34;de\u0026#34;); cout \u0026lt;\u0026lt; \u0026#34;pos = \u0026#34; \u0026lt;\u0026lt; pos \u0026lt;\u0026lt; endl; } void test02() { //æ›¿æ¢ string str1 = \u0026#34;abcdefgde\u0026#34;; str1.replace(1, 3, \u0026#34;1111\u0026#34;); cout \u0026lt;\u0026lt; \u0026#34;str1 = \u0026#34; \u0026lt;\u0026lt; str1 \u0026lt;\u0026lt; endl; } int main() { //test01(); //test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nfindæŸ¥æ‰¾æ˜¯ä»å·¦å¾€åï¼Œrfindä»å³å¾€å·¦ findæ‰¾åˆ°å­—ç¬¦ä¸²åè¿”å›æŸ¥æ‰¾çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä½ç½®ï¼Œæ‰¾ä¸åˆ°è¿”å›-1 replaceåœ¨æ›¿æ¢æ—¶ï¼Œè¦æŒ‡å®šä»å“ªä¸ªä½ç½®èµ·ï¼Œå¤šå°‘ä¸ªå­—ç¬¦ï¼Œæ›¿æ¢æˆä»€ä¹ˆæ ·çš„å­—ç¬¦ä¸² 3.1.6 stringå­—ç¬¦ä¸²æ¯”è¾ƒ #\råŠŸèƒ½æè¿°ï¼š\nå­—ç¬¦ä¸²ä¹‹é—´çš„æ¯”è¾ƒ æ¯”è¾ƒæ–¹å¼ï¼š\nå­—ç¬¦ä¸²æ¯”è¾ƒæ˜¯æŒ‰å­—ç¬¦çš„ASCIIç è¿›è¡Œå¯¹æ¯” = è¿”å› 0\n\u0026gt; è¿”å› 1\n\u0026lt; è¿”å› -1\nå‡½æ•°åŸå‹ï¼š\nint compare(const string \u0026amp;s) const; //ä¸å­—ç¬¦ä¸²sæ¯”è¾ƒ int compare(const char *s) const; //ä¸å­—ç¬¦ä¸²sæ¯”è¾ƒ ç¤ºä¾‹ï¼š\n//å­—ç¬¦ä¸²æ¯”è¾ƒ void test01() { string s1 = \u0026#34;hello\u0026#34;; string s2 = \u0026#34;aello\u0026#34;; int ret = s1.compare(s2); if (ret == 0) { cout \u0026lt;\u0026lt; \u0026#34;s1 ç­‰äº s2\u0026#34; \u0026lt;\u0026lt; endl; } else if (ret \u0026gt; 0) { cout \u0026lt;\u0026lt; \u0026#34;s1 å¤§äº s2\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;s1 å°äº s2\u0026#34; \u0026lt;\u0026lt; endl; } } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå­—ç¬¦ä¸²å¯¹æ¯”ä¸»è¦æ˜¯ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œåˆ¤æ–­è°å¤§è°å°çš„æ„ä¹‰å¹¶ä¸æ˜¯å¾ˆå¤§\n3.1.7 stringå­—ç¬¦å­˜å– #\rstringä¸­å•ä¸ªå­—ç¬¦å­˜å–æ–¹å¼æœ‰ä¸¤ç§\nchar\u0026amp; operator[](int n); //é€šè¿‡[]æ–¹å¼å–å­—ç¬¦ char\u0026amp; at(int n); //é€šè¿‡atæ–¹æ³•è·å–å­—ç¬¦ ç¤ºä¾‹ï¼š\nvoid test01() { string str = \u0026#34;hello world\u0026#34;; for (int i = 0; i \u0026lt; str.size(); i++) { cout \u0026lt;\u0026lt; str[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; str.size(); i++) { cout \u0026lt;\u0026lt; str.at(i) \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; //å­—ç¬¦ä¿®æ”¹ str[0] = \u0026#39;x\u0026#39;; str.at(1) = \u0026#39;x\u0026#39;; cout \u0026lt;\u0026lt; str \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šstringå­—ç¬¦ä¸²ä¸­å•ä¸ªå­—ç¬¦å­˜å–æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ©ç”¨ [ ] æˆ– at\n3.1.8 stringæ’å…¥å’Œåˆ é™¤ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹stringå­—ç¬¦ä¸²è¿›è¡Œæ’å…¥å’Œåˆ é™¤å­—ç¬¦æ“ä½œ å‡½æ•°åŸå‹ï¼š\nstring\u0026amp; insert(int pos, const char* s); //æ’å…¥å­—ç¬¦ä¸² string\u0026amp; insert(int pos, const string\u0026amp; str); //æ’å…¥å­—ç¬¦ä¸² string\u0026amp; insert(int pos, int n, char c); //åœ¨æŒ‡å®šä½ç½®æ’å…¥nä¸ªå­—ç¬¦c string\u0026amp; erase(int pos, int n = npos); //åˆ é™¤ä»Poså¼€å§‹çš„nä¸ªå­—ç¬¦ ç¤ºä¾‹ï¼š\n//å­—ç¬¦ä¸²æ’å…¥å’Œåˆ é™¤ void test01() { string str = \u0026#34;hello\u0026#34;; str.insert(1, \u0026#34;111\u0026#34;); cout \u0026lt;\u0026lt; str \u0026lt;\u0026lt; endl; str.erase(1, 3); //ä»1å·ä½ç½®å¼€å§‹3ä¸ªå­—ç¬¦ cout \u0026lt;\u0026lt; str \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**æ’å…¥å’Œåˆ é™¤çš„èµ·å§‹ä¸‹æ ‡éƒ½æ˜¯ä»0å¼€å§‹\n3.1.9 stringå­ä¸² #\råŠŸèƒ½æè¿°ï¼š\nä»å­—ç¬¦ä¸²ä¸­è·å–æƒ³è¦çš„å­ä¸² å‡½æ•°åŸå‹ï¼š\nstring substr(int pos = 0, int n = npos) const; //è¿”å›ç”±poså¼€å§‹çš„nä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸² ç¤ºä¾‹ï¼š\n//å­ä¸² void test01() { string str = \u0026#34;abcdefg\u0026#34;; string subStr = str.substr(1, 3); cout \u0026lt;\u0026lt; \u0026#34;subStr = \u0026#34; \u0026lt;\u0026lt; subStr \u0026lt;\u0026lt; endl; string email = \u0026#34;hello@sina.com\u0026#34;; int pos = email.find(\u0026#34;@\u0026#34;); string username = email.substr(0, pos); cout \u0026lt;\u0026lt; \u0026#34;username: \u0026#34; \u0026lt;\u0026lt; username \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**çµæ´»çš„è¿ç”¨æ±‚å­ä¸²åŠŸèƒ½ï¼Œå¯ä»¥åœ¨å®é™…å¼€å‘ä¸­è·å–æœ‰æ•ˆçš„ä¿¡æ¯\n3.2 vectorå®¹å™¨ #\r3.2.1 vectoråŸºæœ¬æ¦‚å¿µ #\råŠŸèƒ½ï¼š\nvectoræ•°æ®ç»“æ„å’Œæ•°ç»„éå¸¸ç›¸ä¼¼ï¼Œä¹Ÿç§°ä¸ºå•ç«¯æ•°ç»„ vectorä¸æ™®é€šæ•°ç»„åŒºåˆ«ï¼š\nä¸åŒä¹‹å¤„åœ¨äºæ•°ç»„æ˜¯é™æ€ç©ºé—´ï¼Œè€Œvectorå¯ä»¥åŠ¨æ€æ‰©å±• åŠ¨æ€æ‰©å±•ï¼š\nå¹¶ä¸æ˜¯åœ¨åŸç©ºé—´ä¹‹åç»­æ¥æ–°ç©ºé—´ï¼Œè€Œæ˜¯æ‰¾æ›´å¤§çš„å†…å­˜ç©ºé—´ï¼Œç„¶åå°†åŸæ•°æ®æ‹·è´æ–°ç©ºé—´ï¼Œé‡Šæ”¾åŸç©ºé—´ vectorå®¹å™¨çš„è¿­ä»£å™¨æ˜¯æ”¯æŒéšæœºè®¿é—®çš„è¿­ä»£å™¨ 3.2.2 vectoræ„é€ å‡½æ•° #\råŠŸèƒ½æè¿°ï¼š\nåˆ›å»ºvectorå®¹å™¨ å‡½æ•°åŸå‹ï¼š\nvector\u0026lt;T\u0026gt; v; //é‡‡ç”¨æ¨¡æ¿å®ç°ç±»å®ç°ï¼Œé»˜è®¤æ„é€ å‡½æ•° vector(v.begin(), v.end()); //å°†v[begin(), end())åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº«ã€‚ vector(n, elem); //æ„é€ å‡½æ•°å°†nä¸ªelemæ‹·è´ç»™æœ¬èº«ã€‚ vector(const vector \u0026amp;vec); //æ‹·è´æ„é€ å‡½æ•°ã€‚ ç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; void printVector(vector\u0026lt;int\u0026gt;\u0026amp; v) { for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } void test01() { vector\u0026lt;int\u0026gt; v1; //æ— å‚æ„é€  for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); } printVector(v1); vector\u0026lt;int\u0026gt; v2(v1.begin(), v1.end()); printVector(v2); vector\u0026lt;int\u0026gt; v3(10, 100); printVector(v3); vector\u0026lt;int\u0026gt; v4(v3); printVector(v4); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**vectorçš„å¤šç§æ„é€ æ–¹å¼æ²¡æœ‰å¯æ¯”æ€§ï¼Œçµæ´»ä½¿ç”¨å³å¯\n3.2.3 vectorèµ‹å€¼æ“ä½œ #\råŠŸèƒ½æè¿°ï¼š\nç»™vectorå®¹å™¨è¿›è¡Œèµ‹å€¼ å‡½æ•°åŸå‹ï¼š\nvector\u0026amp; operator=(const vector \u0026amp;vec);//é‡è½½ç­‰å·æ“ä½œç¬¦\nassign(beg, end); //å°†[beg, end)åŒºé—´ä¸­çš„æ•°æ®æ‹·è´èµ‹å€¼ç»™æœ¬èº«ã€‚\nassign(n, elem); //å°†nä¸ªelemæ‹·è´èµ‹å€¼ç»™æœ¬èº«ã€‚\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; void printVector(vector\u0026lt;int\u0026gt;\u0026amp; v) { for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //èµ‹å€¼æ“ä½œ void test01() { vector\u0026lt;int\u0026gt; v1; //æ— å‚æ„é€  for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); } printVector(v1); vector\u0026lt;int\u0026gt;v2; v2 = v1; printVector(v2); vector\u0026lt;int\u0026gt;v3; v3.assign(v1.begin(), v1.end()); printVector(v3); vector\u0026lt;int\u0026gt;v4; v4.assign(10, 100); printVector(v4); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š vectorèµ‹å€¼æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨operator=ï¼Œæˆ–è€…assignéƒ½å¯ä»¥\n3.2.4 vectorå®¹é‡å’Œå¤§å° #\råŠŸèƒ½æè¿°ï¼š\nå¯¹vectorå®¹å™¨çš„å®¹é‡å’Œå¤§å°æ“ä½œ å‡½æ•°åŸå‹ï¼š\nempty(); //åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º\ncapacity(); //å®¹å™¨çš„å®¹é‡\nsize(); //è¿”å›å®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•°\nresize(int num); //é‡æ–°æŒ‡å®šå®¹å™¨çš„é•¿åº¦ä¸ºnumï¼Œè‹¥å®¹å™¨å˜é•¿ï¼Œåˆ™ä»¥é»˜è®¤å€¼å¡«å……æ–°ä½ç½®ã€‚\nâ€‹\t//å¦‚æœå®¹å™¨å˜çŸ­ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨é•¿åº¦çš„å…ƒç´ è¢«åˆ é™¤ã€‚\nresize(int num, elem); //é‡æ–°æŒ‡å®šå®¹å™¨çš„é•¿åº¦ä¸ºnumï¼Œè‹¥å®¹å™¨å˜é•¿ï¼Œåˆ™ä»¥elemå€¼å¡«å……æ–°ä½ç½®ã€‚\nâ€‹\t//å¦‚æœå®¹å™¨å˜çŸ­ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨é•¿åº¦çš„å…ƒç´ è¢«åˆ é™¤\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; void printVector(vector\u0026lt;int\u0026gt;\u0026amp; v) { for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } void test01() { vector\u0026lt;int\u0026gt; v1; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); } printVector(v1); if (v1.empty()) { cout \u0026lt;\u0026lt; \u0026#34;v1ä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;v1ä¸ä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;v1çš„å®¹é‡ = \u0026#34; \u0026lt;\u0026lt; v1.capacity() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;v1çš„å¤§å° = \u0026#34; \u0026lt;\u0026lt; v1.size() \u0026lt;\u0026lt; endl; } //resize é‡æ–°æŒ‡å®šå¤§å° ï¼Œè‹¥æŒ‡å®šçš„æ›´å¤§ï¼Œé»˜è®¤ç”¨0å¡«å……æ–°ä½ç½®ï¼Œå¯ä»¥åˆ©ç”¨é‡è½½ç‰ˆæœ¬æ›¿æ¢é»˜è®¤å¡«å…… v1.resize(15,10); printVector(v1); //resize é‡æ–°æŒ‡å®šå¤§å° ï¼Œè‹¥æŒ‡å®šçš„æ›´å°ï¼Œè¶…å‡ºéƒ¨åˆ†å…ƒç´ è¢«åˆ é™¤ v1.resize(5); printVector(v1); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nåˆ¤æ–­æ˜¯å¦ä¸ºç©º \u0026mdash; empty è¿”å›å…ƒç´ ä¸ªæ•° \u0026mdash; size è¿”å›å®¹å™¨å®¹é‡ \u0026mdash; capacity é‡æ–°æŒ‡å®šå¤§å° \u0026mdash; resize 3.2.5 vectoræ’å…¥å’Œåˆ é™¤ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹vectorå®¹å™¨è¿›è¡Œæ’å…¥ã€åˆ é™¤æ“ä½œ å‡½æ•°åŸå‹ï¼š\npush_back(ele); //å°¾éƒ¨æ’å…¥å…ƒç´ ele pop_back(); //åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´  insert(const_iterator pos, ele); //è¿­ä»£å™¨æŒ‡å‘ä½ç½®posæ’å…¥å…ƒç´ ele insert(const_iterator pos, int count,ele);//è¿­ä»£å™¨æŒ‡å‘ä½ç½®posæ’å…¥countä¸ªå…ƒç´ ele erase(const_iterator pos); //åˆ é™¤è¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´  erase(const_iterator start, const_iterator end);//åˆ é™¤è¿­ä»£å™¨ä»startåˆ°endä¹‹é—´çš„å…ƒç´  clear(); //åˆ é™¤å®¹å™¨ä¸­æ‰€æœ‰å…ƒç´  ç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; void printVector(vector\u0026lt;int\u0026gt;\u0026amp; v) { for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //æ’å…¥å’Œåˆ é™¤ void test01() { vector\u0026lt;int\u0026gt; v1; //å°¾æ’ v1.push_back(10); v1.push_back(20); v1.push_back(30); v1.push_back(40); v1.push_back(50); printVector(v1); //å°¾åˆ  v1.pop_back(); printVector(v1); //æ’å…¥ v1.insert(v1.begin(), 100); printVector(v1); v1.insert(v1.begin(), 2, 1000); printVector(v1); //åˆ é™¤ v1.erase(v1.begin()); printVector(v1); //æ¸…ç©º v1.erase(v1.begin(), v1.end()); v1.clear(); printVector(v1); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå°¾æ’ \u0026mdash; push_back å°¾åˆ  \u0026mdash; pop_back æ’å…¥ \u0026mdash; insert (ä½ç½®è¿­ä»£å™¨) åˆ é™¤ \u0026mdash; erase ï¼ˆä½ç½®è¿­ä»£å™¨ï¼‰ æ¸…ç©º \u0026mdash; clear 3.2.6 vectoræ•°æ®å­˜å– #\råŠŸèƒ½æè¿°ï¼š\nå¯¹vectorä¸­çš„æ•°æ®çš„å­˜å–æ“ä½œ å‡½æ•°åŸå‹ï¼š\nat(int idx); //è¿”å›ç´¢å¼•idxæ‰€æŒ‡çš„æ•°æ® operator[]; //è¿”å›ç´¢å¼•idxæ‰€æŒ‡çš„æ•°æ® front(); //è¿”å›å®¹å™¨ä¸­ç¬¬ä¸€ä¸ªæ•°æ®å…ƒç´  back(); //è¿”å›å®¹å™¨ä¸­æœ€åä¸€ä¸ªæ•°æ®å…ƒç´  ç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; void test01() { vector\u0026lt;int\u0026gt;v1; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); } for (int i = 0; i \u0026lt; v1.size(); i++) { cout \u0026lt;\u0026lt; v1[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; v1.size(); i++) { cout \u0026lt;\u0026lt; v1.at(i) \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;v1çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; v1.front() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;v1çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; v1.back() \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\né™¤äº†ç”¨è¿­ä»£å™¨è·å–vectorå®¹å™¨ä¸­å…ƒç´ ï¼Œ[ ]å’Œatä¹Ÿå¯ä»¥ frontè¿”å›å®¹å™¨ç¬¬ä¸€ä¸ªå…ƒç´  backè¿”å›å®¹å™¨æœ€åä¸€ä¸ªå…ƒç´  3.2.7 vectoräº’æ¢å®¹å™¨ #\råŠŸèƒ½æè¿°ï¼š\nå®ç°ä¸¤ä¸ªå®¹å™¨å†…å…ƒç´ è¿›è¡Œäº’æ¢ å‡½æ•°åŸå‹ï¼š\nswap(vec); // å°†vecä¸æœ¬èº«çš„å…ƒç´ äº’æ¢ ç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; void printVector(vector\u0026lt;int\u0026gt;\u0026amp; v) { for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } void test01() { vector\u0026lt;int\u0026gt;v1; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); } printVector(v1); vector\u0026lt;int\u0026gt;v2; for (int i = 10; i \u0026gt; 0; i--) { v2.push_back(i); } printVector(v2); //äº’æ¢å®¹å™¨ cout \u0026lt;\u0026lt; \u0026#34;äº’æ¢å\u0026#34; \u0026lt;\u0026lt; endl; v1.swap(v2); printVector(v1); printVector(v2); } void test02() { vector\u0026lt;int\u0026gt; v; for (int i = 0; i \u0026lt; 100000; i++) { v.push_back(i); } cout \u0026lt;\u0026lt; \u0026#34;vçš„å®¹é‡ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; v.capacity() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;vçš„å¤§å°ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; v.size() \u0026lt;\u0026lt; endl; v.resize(3); cout \u0026lt;\u0026lt; \u0026#34;vçš„å®¹é‡ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; v.capacity() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;vçš„å¤§å°ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; v.size() \u0026lt;\u0026lt; endl; //æ”¶ç¼©å†…å­˜ vector\u0026lt;int\u0026gt;(v).swap(v); //åŒ¿åå¯¹è±¡ cout \u0026lt;\u0026lt; \u0026#34;vçš„å®¹é‡ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; v.capacity() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;vçš„å¤§å°ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; v.size() \u0026lt;\u0026lt; endl; } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šswapå¯ä»¥ä½¿ä¸¤ä¸ªå®¹å™¨äº’æ¢ï¼Œå¯ä»¥è¾¾åˆ°å®ç”¨çš„æ”¶ç¼©å†…å­˜æ•ˆæœ\n3.2.8 vectoré¢„ç•™ç©ºé—´ #\råŠŸèƒ½æè¿°ï¼š\nå‡å°‘vectoråœ¨åŠ¨æ€æ‰©å±•å®¹é‡æ—¶çš„æ‰©å±•æ¬¡æ•° å‡½æ•°åŸå‹ï¼š\nreserve(int len);//å®¹å™¨é¢„ç•™lenä¸ªå…ƒç´ é•¿åº¦ï¼Œé¢„ç•™ä½ç½®ä¸åˆå§‹åŒ–ï¼Œå…ƒç´ ä¸å¯è®¿é—®ã€‚\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; void test01() { vector\u0026lt;int\u0026gt; v; //é¢„ç•™ç©ºé—´ v.reserve(100000); int num = 0; int* p = NULL; for (int i = 0; i \u0026lt; 100000; i++) { v.push_back(i); if (p != \u0026amp;v[0]) { p = \u0026amp;v[0]; num++; } } cout \u0026lt;\u0026lt; \u0026#34;num:\u0026#34; \u0026lt;\u0026lt; num \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå¦‚æœæ•°æ®é‡è¾ƒå¤§ï¼Œå¯ä»¥ä¸€å¼€å§‹åˆ©ç”¨reserveé¢„ç•™ç©ºé—´\n3.3 dequeå®¹å™¨ #\r3.3.1 dequeå®¹å™¨åŸºæœ¬æ¦‚å¿µ #\råŠŸèƒ½ï¼š\nåŒç«¯æ•°ç»„ï¼Œå¯ä»¥å¯¹å¤´ç«¯è¿›è¡Œæ’å…¥åˆ é™¤æ“ä½œ dequeä¸vectoråŒºåˆ«ï¼š\nvectorå¯¹äºå¤´éƒ¨çš„æ’å…¥åˆ é™¤æ•ˆç‡ä½ï¼Œæ•°æ®é‡è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ dequeç›¸å¯¹è€Œè¨€ï¼Œå¯¹å¤´éƒ¨çš„æ’å…¥åˆ é™¤é€Ÿåº¦å›æ¯”vectorå¿« vectorè®¿é—®å…ƒç´ æ—¶çš„é€Ÿåº¦ä¼šæ¯”dequeå¿«,è¿™å’Œä¸¤è€…å†…éƒ¨å®ç°æœ‰å…³ dequeå†…éƒ¨å·¥ä½œåŸç†:\ndequeå†…éƒ¨æœ‰ä¸ªä¸­æ§å™¨ï¼Œç»´æŠ¤æ¯æ®µç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œç¼“å†²åŒºä¸­å­˜æ”¾çœŸå®æ•°æ®\nä¸­æ§å™¨ç»´æŠ¤çš„æ˜¯æ¯ä¸ªç¼“å†²åŒºçš„åœ°å€ï¼Œä½¿å¾—ä½¿ç”¨dequeæ—¶åƒä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´\ndequeå®¹å™¨çš„è¿­ä»£å™¨ä¹Ÿæ˜¯æ”¯æŒéšæœºè®¿é—®çš„ 3.3.2 dequeæ„é€ å‡½æ•° #\råŠŸèƒ½æè¿°ï¼š\ndequeå®¹å™¨æ„é€  å‡½æ•°åŸå‹ï¼š\ndeque\u0026lt;T\u0026gt; deqT; //é»˜è®¤æ„é€ å½¢å¼ deque(beg, end); //æ„é€ å‡½æ•°å°†[beg, end)åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº«ã€‚ deque(n, elem); //æ„é€ å‡½æ•°å°†nä¸ªelemæ‹·è´ç»™æœ¬èº«ã€‚ deque(const deque \u0026amp;deq); //æ‹·è´æ„é€ å‡½æ•° ç¤ºä¾‹ï¼š\n#include \u0026lt;deque\u0026gt; void printDeque(const deque\u0026lt;int\u0026gt;\u0026amp; d) { for (deque\u0026lt;int\u0026gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //dequeæ„é€  void test01() { deque\u0026lt;int\u0026gt; d1; //æ— å‚æ„é€ å‡½æ•° for (int i = 0; i \u0026lt; 10; i++) { d1.push_back(i); } printDeque(d1); deque\u0026lt;int\u0026gt; d2(d1.begin(),d1.end()); printDeque(d2); deque\u0026lt;int\u0026gt;d3(10,100); printDeque(d3); deque\u0026lt;int\u0026gt;d4 = d3; printDeque(d4); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**dequeå®¹å™¨å’Œvectorå®¹å™¨çš„æ„é€ æ–¹å¼å‡ ä¹ä¸€è‡´ï¼Œçµæ´»ä½¿ç”¨å³å¯\n3.3.3 dequeèµ‹å€¼æ“ä½œ #\råŠŸèƒ½æè¿°ï¼š\nç»™dequeå®¹å™¨è¿›è¡Œèµ‹å€¼ å‡½æ•°åŸå‹ï¼š\ndeque\u0026amp; operator=(const deque \u0026amp;deq); //é‡è½½ç­‰å·æ“ä½œç¬¦\nassign(beg, end); //å°†[beg, end)åŒºé—´ä¸­çš„æ•°æ®æ‹·è´èµ‹å€¼ç»™æœ¬èº«ã€‚\nassign(n, elem); //å°†nä¸ªelemæ‹·è´èµ‹å€¼ç»™æœ¬èº«ã€‚\nç¤ºä¾‹ï¼š\n#include \u0026lt;deque\u0026gt; void printDeque(const deque\u0026lt;int\u0026gt;\u0026amp; d) { for (deque\u0026lt;int\u0026gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //èµ‹å€¼æ“ä½œ void test01() { deque\u0026lt;int\u0026gt; d1; for (int i = 0; i \u0026lt; 10; i++) { d1.push_back(i); } printDeque(d1); deque\u0026lt;int\u0026gt;d2; d2 = d1; printDeque(d2); deque\u0026lt;int\u0026gt;d3; d3.assign(d1.begin(), d1.end()); printDeque(d3); deque\u0026lt;int\u0026gt;d4; d4.assign(10, 100); printDeque(d4); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šdequeèµ‹å€¼æ“ä½œä¹Ÿä¸vectorç›¸åŒï¼Œéœ€ç†Ÿç»ƒæŒæ¡\n3.3.4 dequeå¤§å°æ“ä½œ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹dequeå®¹å™¨çš„å¤§å°è¿›è¡Œæ“ä½œ å‡½æ•°åŸå‹ï¼š\ndeque.empty(); //åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º\ndeque.size(); //è¿”å›å®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•°\ndeque.resize(num); //é‡æ–°æŒ‡å®šå®¹å™¨çš„é•¿åº¦ä¸ºnum,è‹¥å®¹å™¨å˜é•¿ï¼Œåˆ™ä»¥é»˜è®¤å€¼å¡«å……æ–°ä½ç½®ã€‚\nâ€‹\t//å¦‚æœå®¹å™¨å˜çŸ­ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨é•¿åº¦çš„å…ƒç´ è¢«åˆ é™¤ã€‚\ndeque.resize(num, elem); //é‡æ–°æŒ‡å®šå®¹å™¨çš„é•¿åº¦ä¸ºnum,è‹¥å®¹å™¨å˜é•¿ï¼Œåˆ™ä»¥elemå€¼å¡«å……æ–°ä½ç½®ã€‚\nâ€‹ //å¦‚æœå®¹å™¨å˜çŸ­ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨é•¿åº¦çš„å…ƒç´ è¢«åˆ é™¤ã€‚\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;deque\u0026gt; void printDeque(const deque\u0026lt;int\u0026gt;\u0026amp; d) { for (deque\u0026lt;int\u0026gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //å¤§å°æ“ä½œ void test01() { deque\u0026lt;int\u0026gt; d1; for (int i = 0; i \u0026lt; 10; i++) { d1.push_back(i); } printDeque(d1); //åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º if (d1.empty()) { cout \u0026lt;\u0026lt; \u0026#34;d1ä¸ºç©º!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;d1ä¸ä¸ºç©º!\u0026#34; \u0026lt;\u0026lt; endl; //ç»Ÿè®¡å¤§å° cout \u0026lt;\u0026lt; \u0026#34;d1çš„å¤§å°ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; d1.size() \u0026lt;\u0026lt; endl; } //é‡æ–°æŒ‡å®šå¤§å° d1.resize(15, 1); printDeque(d1); d1.resize(5); printDeque(d1); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\ndequeæ²¡æœ‰å®¹é‡çš„æ¦‚å¿µ åˆ¤æ–­æ˜¯å¦ä¸ºç©º \u0026mdash; empty è¿”å›å…ƒç´ ä¸ªæ•° \u0026mdash; size é‡æ–°æŒ‡å®šä¸ªæ•° \u0026mdash; resize 3.3.5 deque æ’å…¥å’Œåˆ é™¤ #\råŠŸèƒ½æè¿°ï¼š\nå‘dequeå®¹å™¨ä¸­æ’å…¥å’Œåˆ é™¤æ•°æ® å‡½æ•°åŸå‹ï¼š\nä¸¤ç«¯æ’å…¥æ“ä½œï¼š\npush_back(elem); //åœ¨å®¹å™¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ªæ•°æ® push_front(elem); //åœ¨å®¹å™¨å¤´éƒ¨æ’å…¥ä¸€ä¸ªæ•°æ® pop_back(); //åˆ é™¤å®¹å™¨æœ€åä¸€ä¸ªæ•°æ® pop_front(); //åˆ é™¤å®¹å™¨ç¬¬ä¸€ä¸ªæ•°æ® æŒ‡å®šä½ç½®æ“ä½œï¼š\ninsert(pos,elem); //åœ¨posä½ç½®æ’å…¥ä¸€ä¸ªelemå…ƒç´ çš„æ‹·è´ï¼Œè¿”å›æ–°æ•°æ®çš„ä½ç½®ã€‚\ninsert(pos,n,elem); //åœ¨posä½ç½®æ’å…¥nä¸ªelemæ•°æ®ï¼Œæ— è¿”å›å€¼ã€‚\ninsert(pos,beg,end); //åœ¨posä½ç½®æ’å…¥[beg,end)åŒºé—´çš„æ•°æ®ï¼Œæ— è¿”å›å€¼ã€‚\nclear(); //æ¸…ç©ºå®¹å™¨çš„æ‰€æœ‰æ•°æ®\nerase(beg,end); //åˆ é™¤[beg,end)åŒºé—´çš„æ•°æ®ï¼Œè¿”å›ä¸‹ä¸€ä¸ªæ•°æ®çš„ä½ç½®ã€‚\nerase(pos); //åˆ é™¤posä½ç½®çš„æ•°æ®ï¼Œè¿”å›ä¸‹ä¸€ä¸ªæ•°æ®çš„ä½ç½®ã€‚\nâ€‹\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;deque\u0026gt; void printDeque(const deque\u0026lt;int\u0026gt;\u0026amp; d) { for (deque\u0026lt;int\u0026gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //ä¸¤ç«¯æ“ä½œ void test01() { deque\u0026lt;int\u0026gt; d; //å°¾æ’ d.push_back(10); d.push_back(20); //å¤´æ’ d.push_front(100); d.push_front(200); printDeque(d); //å°¾åˆ  d.pop_back(); //å¤´åˆ  d.pop_front(); printDeque(d); } //æ’å…¥ void test02() { deque\u0026lt;int\u0026gt; d; d.push_back(10); d.push_back(20); d.push_front(100); d.push_front(200); printDeque(d); d.insert(d.begin(), 1000); printDeque(d); d.insert(d.begin(), 2,10000); printDeque(d); deque\u0026lt;int\u0026gt;d2; d2.push_back(1); d2.push_back(2); d2.push_back(3); d.insert(d.begin(), d2.begin(), d2.end()); printDeque(d); } //åˆ é™¤ void test03() { deque\u0026lt;int\u0026gt; d; d.push_back(10); d.push_back(20); d.push_front(100); d.push_front(200); printDeque(d); d.erase(d.begin()); printDeque(d); d.erase(d.begin(), d.end()); d.clear(); printDeque(d); } int main() { //test01(); //test02(); test03(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\næ’å…¥å’Œåˆ é™¤æä¾›çš„ä½ç½®æ˜¯è¿­ä»£å™¨ï¼ å°¾æ’ \u0026mdash; push_back å°¾åˆ  \u0026mdash; pop_back å¤´æ’ \u0026mdash; push_front å¤´åˆ  \u0026mdash; pop_front 3.3.6 deque æ•°æ®å­˜å– #\råŠŸèƒ½æè¿°ï¼š\nå¯¹deque ä¸­çš„æ•°æ®çš„å­˜å–æ“ä½œ å‡½æ•°åŸå‹ï¼š\nat(int idx); //è¿”å›ç´¢å¼•idxæ‰€æŒ‡çš„æ•°æ® operator[]; //è¿”å›ç´¢å¼•idxæ‰€æŒ‡çš„æ•°æ® front(); //è¿”å›å®¹å™¨ä¸­ç¬¬ä¸€ä¸ªæ•°æ®å…ƒç´  back(); //è¿”å›å®¹å™¨ä¸­æœ€åä¸€ä¸ªæ•°æ®å…ƒç´  ç¤ºä¾‹ï¼š\n#include \u0026lt;deque\u0026gt; void printDeque(const deque\u0026lt;int\u0026gt;\u0026amp; d) { for (deque\u0026lt;int\u0026gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //æ•°æ®å­˜å– void test01() { deque\u0026lt;int\u0026gt; d; d.push_back(10); d.push_back(20); d.push_front(100); d.push_front(200); for (int i = 0; i \u0026lt; d.size(); i++) { cout \u0026lt;\u0026lt; d[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; d.size(); i++) { cout \u0026lt;\u0026lt; d.at(i) \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;front:\u0026#34; \u0026lt;\u0026lt; d.front() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;back:\u0026#34; \u0026lt;\u0026lt; d.back() \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\né™¤äº†ç”¨è¿­ä»£å™¨è·å–dequeå®¹å™¨ä¸­å…ƒç´ ï¼Œ[ ]å’Œatä¹Ÿå¯ä»¥ frontè¿”å›å®¹å™¨ç¬¬ä¸€ä¸ªå…ƒç´  backè¿”å›å®¹å™¨æœ€åä¸€ä¸ªå…ƒç´  3.3.7 deque æ’åº #\råŠŸèƒ½æè¿°ï¼š\nåˆ©ç”¨ç®—æ³•å®ç°å¯¹dequeå®¹å™¨è¿›è¡Œæ’åº ç®—æ³•ï¼š\nsort(iterator beg, iterator end) //å¯¹begå’ŒendåŒºé—´å†…å…ƒç´ è¿›è¡Œæ’åº ç¤ºä¾‹ï¼š\n#include \u0026lt;deque\u0026gt; #include \u0026lt;algorithm\u0026gt; void printDeque(const deque\u0026lt;int\u0026gt;\u0026amp; d) { for (deque\u0026lt;int\u0026gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } void test01() { deque\u0026lt;int\u0026gt; d; d.push_back(10); d.push_back(20); d.push_front(100); d.push_front(200); printDeque(d); sort(d.begin(), d.end()); printDeque(d); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šsortç®—æ³•éå¸¸å®ç”¨ï¼Œä½¿ç”¨æ—¶åŒ…å«å¤´æ–‡ä»¶ algorithmå³å¯\n3.4 æ¡ˆä¾‹-è¯„å§”æ‰“åˆ† #\r3.4.1 æ¡ˆä¾‹æè¿° #\ræœ‰5åé€‰æ‰‹ï¼šé€‰æ‰‹ABCDEï¼Œ10ä¸ªè¯„å§”åˆ†åˆ«å¯¹æ¯ä¸€åé€‰æ‰‹æ‰“åˆ†ï¼Œå»é™¤æœ€é«˜åˆ†ï¼Œå»é™¤è¯„å§”ä¸­æœ€ä½åˆ†ï¼Œå–å¹³å‡åˆ†ã€‚\n3.4.2 å®ç°æ­¥éª¤ #\råˆ›å»ºäº”åé€‰æ‰‹ï¼Œæ”¾åˆ°vectorä¸­ éå†vectorå®¹å™¨ï¼Œå–å‡ºæ¥æ¯ä¸€ä¸ªé€‰æ‰‹ï¼Œæ‰§è¡Œforå¾ªç¯ï¼Œå¯ä»¥æŠŠ10ä¸ªè¯„åˆ†æ‰“åˆ†å­˜åˆ°dequeå®¹å™¨ä¸­ sortç®—æ³•å¯¹dequeå®¹å™¨ä¸­åˆ†æ•°æ’åºï¼Œå»é™¤æœ€é«˜å’Œæœ€ä½åˆ† dequeå®¹å™¨éå†ä¸€éï¼Œç´¯åŠ æ€»åˆ† è·å–å¹³å‡åˆ† ç¤ºä¾‹ä»£ç ï¼š\n//é€‰æ‰‹ç±» class Person { public: Person(string name, int score) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Score = score; } string m_Name; //å§“å int m_Score; //å¹³å‡åˆ† }; void createPerson(vector\u0026lt;Person\u0026gt;\u0026amp;v) { string nameSeed = \u0026#34;ABCDE\u0026#34;; for (int i = 0; i \u0026lt; 5; i++) { string name = \u0026#34;é€‰æ‰‹\u0026#34;; name += nameSeed[i]; int score = 0; Person p(name, score); //å°†åˆ›å»ºçš„personå¯¹è±¡ æ”¾å…¥åˆ°å®¹å™¨ä¸­ v.push_back(p); } } //æ‰“åˆ† void setScore(vector\u0026lt;Person\u0026gt;\u0026amp;v) { for (vector\u0026lt;Person\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { //å°†è¯„å§”çš„åˆ†æ•° æ”¾å…¥åˆ°dequeå®¹å™¨ä¸­ deque\u0026lt;int\u0026gt;d; for (int i = 0; i \u0026lt; 10; i++) { int score = rand() % 41 + 60; // 60 ~ 100 d.push_back(score); } //cout \u0026lt;\u0026lt; \u0026#34;é€‰æ‰‹ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; æ‰“åˆ†ï¼š \u0026#34; \u0026lt;\u0026lt; endl; //for (deque\u0026lt;int\u0026gt;::iterator dit = d.begin(); dit != d.end(); dit++) //{ //\tcout \u0026lt;\u0026lt; *dit \u0026lt;\u0026lt; \u0026#34; \u0026#34;; //} //cout \u0026lt;\u0026lt; endl; //æ’åº sort(d.begin(), d.end()); //å»é™¤æœ€é«˜å’Œæœ€ä½åˆ† d.pop_back(); d.pop_front(); //å–å¹³å‡åˆ† int sum = 0; for (deque\u0026lt;int\u0026gt;::iterator dit = d.begin(); dit != d.end(); dit++) { sum += *dit; //ç´¯åŠ æ¯ä¸ªè¯„å§”çš„åˆ†æ•° } int avg = sum / d.size(); //å°†å¹³å‡åˆ† èµ‹å€¼ç»™é€‰æ‰‹èº«ä¸Š it-\u0026gt;m_Score = avg; } } void showScore(vector\u0026lt;Person\u0026gt;\u0026amp;v) { for (vector\u0026lt;Person\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹³å‡åˆ†ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Score \u0026lt;\u0026lt; endl; } } int main() { //éšæœºæ•°ç§å­ srand((unsigned int)time(NULL)); //1ã€åˆ›å»º5åé€‰æ‰‹ vector\u0026lt;Person\u0026gt;v; //å­˜æ”¾é€‰æ‰‹å®¹å™¨ createPerson(v); //æµ‹è¯• //for (vector\u0026lt;Person\u0026gt;::iterator it = v.begin(); it != v.end(); it++) //{ //\tcout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; (*it).m_Name \u0026lt;\u0026lt; \u0026#34; åˆ†æ•°ï¼š \u0026#34; \u0026lt;\u0026lt; (*it).m_Score \u0026lt;\u0026lt; endl; //} //2ã€ç»™5åé€‰æ‰‹æ‰“åˆ† setScore(v); //3ã€æ˜¾ç¤ºæœ€åå¾—åˆ† showScore(v); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š é€‰å–ä¸åŒçš„å®¹å™¨æ“ä½œæ•°æ®ï¼Œå¯ä»¥æå‡ä»£ç çš„æ•ˆç‡\n3.5 stackå®¹å™¨ #\r3.5.1 stack åŸºæœ¬æ¦‚å¿µ #\ræ¦‚å¿µï¼šstackæ˜¯ä¸€ç§å…ˆè¿›åå‡º(First In Last Out,FILO)çš„æ•°æ®ç»“æ„ï¼Œå®ƒåªæœ‰ä¸€ä¸ªå‡ºå£\næ ˆä¸­åªæœ‰é¡¶ç«¯çš„å…ƒç´ æ‰å¯ä»¥è¢«å¤–ç•Œä½¿ç”¨ï¼Œå› æ­¤æ ˆä¸å…è®¸æœ‰éå†è¡Œä¸º\næ ˆä¸­è¿›å…¥æ•°æ®ç§°ä¸º \u0026mdash; å…¥æ ˆ push\næ ˆä¸­å¼¹å‡ºæ•°æ®ç§°ä¸º \u0026mdash; å‡ºæ ˆ pop\nç”Ÿæ´»ä¸­çš„æ ˆï¼š\n3.5.2 stack å¸¸ç”¨æ¥å£ #\råŠŸèƒ½æè¿°ï¼šæ ˆå®¹å™¨å¸¸ç”¨çš„å¯¹å¤–æ¥å£\næ„é€ å‡½æ•°ï¼š\nstack\u0026lt;T\u0026gt; stk; //stacké‡‡ç”¨æ¨¡æ¿ç±»å®ç°ï¼Œ stackå¯¹è±¡çš„é»˜è®¤æ„é€ å½¢å¼ stack(const stack \u0026amp;stk); //æ‹·è´æ„é€ å‡½æ•° èµ‹å€¼æ“ä½œï¼š\nstack\u0026amp; operator=(const stack \u0026amp;stk); //é‡è½½ç­‰å·æ“ä½œç¬¦ æ•°æ®å­˜å–ï¼š\npush(elem); //å‘æ ˆé¡¶æ·»åŠ å…ƒç´  pop(); //ä»æ ˆé¡¶ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´  top(); //è¿”å›æ ˆé¡¶å…ƒç´  å¤§å°æ“ä½œï¼š\nempty(); //åˆ¤æ–­å †æ ˆæ˜¯å¦ä¸ºç©º size(); //è¿”å›æ ˆçš„å¤§å° ç¤ºä¾‹ï¼š\n#include \u0026lt;stack\u0026gt; //æ ˆå®¹å™¨å¸¸ç”¨æ¥å£ void test01() { //åˆ›å»ºæ ˆå®¹å™¨ æ ˆå®¹å™¨å¿…é¡»ç¬¦åˆå…ˆè¿›åå‡º stack\u0026lt;int\u0026gt; s; //å‘æ ˆä¸­æ·»åŠ å…ƒç´ ï¼Œå«åš å‹æ ˆ å…¥æ ˆ s.push(10); s.push(20); s.push(30); while (!s.empty()) { //è¾“å‡ºæ ˆé¡¶å…ƒç´  cout \u0026lt;\u0026lt; \u0026#34;æ ˆé¡¶å…ƒç´ ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; s.top() \u0026lt;\u0026lt; endl; //å¼¹å‡ºæ ˆé¡¶å…ƒç´  s.pop(); } cout \u0026lt;\u0026lt; \u0026#34;æ ˆçš„å¤§å°ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; s.size() \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå…¥æ ˆ \u0026mdash; push å‡ºæ ˆ \u0026mdash; pop è¿”å›æ ˆé¡¶ \u0026mdash; top åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º \u0026mdash; empty è¿”å›æ ˆå¤§å° \u0026mdash; size 3.6 queue å®¹å™¨ #\r3.6.1 queue åŸºæœ¬æ¦‚å¿µ #\ræ¦‚å¿µï¼šQueueæ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡º(First In First Out,FIFO)çš„æ•°æ®ç»“æ„ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‡ºå£\né˜Ÿåˆ—å®¹å™¨å…è®¸ä»ä¸€ç«¯æ–°å¢å…ƒç´ ï¼Œä»å¦ä¸€ç«¯ç§»é™¤å…ƒç´ \né˜Ÿåˆ—ä¸­åªæœ‰é˜Ÿå¤´å’Œé˜Ÿå°¾æ‰å¯ä»¥è¢«å¤–ç•Œä½¿ç”¨ï¼Œå› æ­¤é˜Ÿåˆ—ä¸å…è®¸æœ‰éå†è¡Œä¸º\né˜Ÿåˆ—ä¸­è¿›æ•°æ®ç§°ä¸º \u0026mdash; å…¥é˜Ÿ push\né˜Ÿåˆ—ä¸­å‡ºæ•°æ®ç§°ä¸º \u0026mdash; å‡ºé˜Ÿ pop\nç”Ÿæ´»ä¸­çš„é˜Ÿåˆ—ï¼š\n3.6.2 queue å¸¸ç”¨æ¥å£ #\råŠŸèƒ½æè¿°ï¼šæ ˆå®¹å™¨å¸¸ç”¨çš„å¯¹å¤–æ¥å£\næ„é€ å‡½æ•°ï¼š\nqueue\u0026lt;T\u0026gt; que; //queueé‡‡ç”¨æ¨¡æ¿ç±»å®ç°ï¼Œqueueå¯¹è±¡çš„é»˜è®¤æ„é€ å½¢å¼ queue(const queue \u0026amp;que); //æ‹·è´æ„é€ å‡½æ•° èµ‹å€¼æ“ä½œï¼š\nqueue\u0026amp; operator=(const queue \u0026amp;que); //é‡è½½ç­‰å·æ“ä½œç¬¦ æ•°æ®å­˜å–ï¼š\npush(elem); //å¾€é˜Ÿå°¾æ·»åŠ å…ƒç´  pop(); //ä»é˜Ÿå¤´ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´  back(); //è¿”å›æœ€åä¸€ä¸ªå…ƒç´  front(); //è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´  å¤§å°æ“ä½œï¼š\nempty(); //åˆ¤æ–­å †æ ˆæ˜¯å¦ä¸ºç©º size(); //è¿”å›æ ˆçš„å¤§å° ç¤ºä¾‹ï¼š\n#include \u0026lt;queue\u0026gt; #include \u0026lt;string\u0026gt; class Person { public: Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } string m_Name; int m_Age; }; void test01() { //åˆ›å»ºé˜Ÿåˆ— queue\u0026lt;Person\u0026gt; q; //å‡†å¤‡æ•°æ® Person p1(\u0026#34;å”åƒ§\u0026#34;, 30); Person p2(\u0026#34;å­™æ‚Ÿç©º\u0026#34;, 1000); Person p3(\u0026#34;çŒªå…«æˆ’\u0026#34;, 900); Person p4(\u0026#34;æ²™åƒ§\u0026#34;, 800); //å‘é˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´  å…¥é˜Ÿæ“ä½œ q.push(p1); q.push(p2); q.push(p3); q.push(p4); //é˜Ÿåˆ—ä¸æä¾›è¿­ä»£å™¨ï¼Œæ›´ä¸æ”¯æŒéšæœºè®¿é—®\twhile (!q.empty()) { //è¾“å‡ºé˜Ÿå¤´å…ƒç´  cout \u0026lt;\u0026lt; \u0026#34;é˜Ÿå¤´å…ƒç´ -- å§“åï¼š \u0026#34; \u0026lt;\u0026lt; q.front().m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34;\u0026lt;\u0026lt; q.front().m_Age \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;é˜Ÿå°¾å…ƒç´ -- å§“åï¼š \u0026#34; \u0026lt;\u0026lt; q.back().m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34; \u0026lt;\u0026lt; q.back().m_Age \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; endl; //å¼¹å‡ºé˜Ÿå¤´å…ƒç´  q.pop(); } cout \u0026lt;\u0026lt; \u0026#34;é˜Ÿåˆ—å¤§å°ä¸ºï¼š\u0026#34; \u0026lt;\u0026lt; q.size() \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå…¥é˜Ÿ \u0026mdash; push å‡ºé˜Ÿ \u0026mdash; pop è¿”å›é˜Ÿå¤´å…ƒç´  \u0026mdash; front è¿”å›é˜Ÿå°¾å…ƒç´  \u0026mdash; back åˆ¤æ–­é˜Ÿæ˜¯å¦ä¸ºç©º \u0026mdash; empty è¿”å›é˜Ÿåˆ—å¤§å° \u0026mdash; size 3.7 listå®¹å™¨ #\r3.7.1 liståŸºæœ¬æ¦‚å¿µ #\r**åŠŸèƒ½ï¼š**å°†æ•°æ®è¿›è¡Œé“¾å¼å­˜å‚¨\né“¾è¡¨ï¼ˆlistï¼‰æ˜¯ä¸€ç§ç‰©ç†å­˜å‚¨å•å…ƒä¸Šéè¿ç»­çš„å­˜å‚¨ç»“æ„ï¼Œæ•°æ®å…ƒç´ çš„é€»è¾‘é¡ºåºæ˜¯é€šè¿‡é“¾è¡¨ä¸­çš„æŒ‡é’ˆé“¾æ¥å®ç°çš„\né“¾è¡¨çš„ç»„æˆï¼šé“¾è¡¨ç”±ä¸€ç³»åˆ—ç»“ç‚¹ç»„æˆ\nç»“ç‚¹çš„ç»„æˆï¼šä¸€ä¸ªæ˜¯å­˜å‚¨æ•°æ®å…ƒç´ çš„æ•°æ®åŸŸï¼Œå¦ä¸€ä¸ªæ˜¯å­˜å‚¨ä¸‹ä¸€ä¸ªç»“ç‚¹åœ°å€çš„æŒ‡é’ˆåŸŸ\nSTLä¸­çš„é“¾è¡¨æ˜¯ä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨\nç”±äºé“¾è¡¨çš„å­˜å‚¨æ–¹å¼å¹¶ä¸æ˜¯è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤é“¾è¡¨listä¸­çš„è¿­ä»£å™¨åªæ”¯æŒå‰ç§»å’Œåç§»ï¼Œå±äºåŒå‘è¿­ä»£å™¨\nlistçš„ä¼˜ç‚¹ï¼š\né‡‡ç”¨åŠ¨æ€å­˜å‚¨åˆ†é…ï¼Œä¸ä¼šé€ æˆå†…å­˜æµªè´¹å’Œæº¢å‡º é“¾è¡¨æ‰§è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œååˆ†æ–¹ä¾¿ï¼Œä¿®æ”¹æŒ‡é’ˆå³å¯ï¼Œä¸éœ€è¦ç§»åŠ¨å¤§é‡å…ƒç´  listçš„ç¼ºç‚¹ï¼š\né“¾è¡¨çµæ´»ï¼Œä½†æ˜¯ç©ºé—´(æŒ‡é’ˆåŸŸ) å’Œ æ—¶é—´ï¼ˆéå†ï¼‰é¢å¤–è€—è´¹è¾ƒå¤§ Listæœ‰ä¸€ä¸ªé‡è¦çš„æ€§è´¨ï¼Œæ’å…¥æ“ä½œå’Œåˆ é™¤æ“ä½œéƒ½ä¸ä¼šé€ æˆåŸæœ‰listè¿­ä»£å™¨çš„å¤±æ•ˆï¼Œè¿™åœ¨vectoræ˜¯ä¸æˆç«‹çš„ã€‚\næ€»ç»“ï¼šSTLä¸­Listå’Œvectoræ˜¯ä¸¤ä¸ªæœ€å¸¸è¢«ä½¿ç”¨çš„å®¹å™¨ï¼Œå„æœ‰ä¼˜ç¼ºç‚¹\n3.7.2 listæ„é€ å‡½æ•° #\råŠŸèƒ½æè¿°ï¼š\nåˆ›å»ºlistå®¹å™¨ å‡½æ•°åŸå‹ï¼š\nlist\u0026lt;T\u0026gt; lst; //listé‡‡ç”¨é‡‡ç”¨æ¨¡æ¿ç±»å®ç°,å¯¹è±¡çš„é»˜è®¤æ„é€ å½¢å¼ï¼š list(beg,end); //æ„é€ å‡½æ•°å°†[beg, end)åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº«ã€‚ list(n,elem); //æ„é€ å‡½æ•°å°†nä¸ªelemæ‹·è´ç»™æœ¬èº«ã€‚ list(const list \u0026amp;lst); //æ‹·è´æ„é€ å‡½æ•°ã€‚ ç¤ºä¾‹ï¼š\n#include \u0026lt;list\u0026gt; void printList(const list\u0026lt;int\u0026gt;\u0026amp; L) { for (list\u0026lt;int\u0026gt;::const_iterator it = L.begin(); it != L.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } void test01() { list\u0026lt;int\u0026gt;L1; L1.push_back(10); L1.push_back(20); L1.push_back(30); L1.push_back(40); printList(L1); list\u0026lt;int\u0026gt;L2(L1.begin(),L1.end()); printList(L2); list\u0026lt;int\u0026gt;L3(L2); printList(L3); list\u0026lt;int\u0026gt;L4(10, 1000); printList(L4); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šlistæ„é€ æ–¹å¼åŒå…¶ä»–å‡ ä¸ªSTLå¸¸ç”¨å®¹å™¨ï¼Œç†Ÿç»ƒæŒæ¡å³å¯\n3.7.3 list èµ‹å€¼å’Œäº¤æ¢ #\råŠŸèƒ½æè¿°ï¼š\nç»™listå®¹å™¨è¿›è¡Œèµ‹å€¼ï¼Œä»¥åŠäº¤æ¢listå®¹å™¨ å‡½æ•°åŸå‹ï¼š\nassign(beg, end); //å°†[beg, end)åŒºé—´ä¸­çš„æ•°æ®æ‹·è´èµ‹å€¼ç»™æœ¬èº«ã€‚ assign(n, elem); //å°†nä¸ªelemæ‹·è´èµ‹å€¼ç»™æœ¬èº«ã€‚ list\u0026amp; operator=(const list \u0026amp;lst); //é‡è½½ç­‰å·æ“ä½œç¬¦ swap(lst); //å°†lstä¸æœ¬èº«çš„å…ƒç´ äº’æ¢ã€‚ ç¤ºä¾‹ï¼š\n#include \u0026lt;list\u0026gt; void printList(const list\u0026lt;int\u0026gt;\u0026amp; L) { for (list\u0026lt;int\u0026gt;::const_iterator it = L.begin(); it != L.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //èµ‹å€¼å’Œäº¤æ¢ void test01() { list\u0026lt;int\u0026gt;L1; L1.push_back(10); L1.push_back(20); L1.push_back(30); L1.push_back(40); printList(L1); //èµ‹å€¼ list\u0026lt;int\u0026gt;L2; L2 = L1; printList(L2); list\u0026lt;int\u0026gt;L3; L3.assign(L2.begin(), L2.end()); printList(L3); list\u0026lt;int\u0026gt;L4; L4.assign(10, 100); printList(L4); } //äº¤æ¢ void test02() { list\u0026lt;int\u0026gt;L1; L1.push_back(10); L1.push_back(20); L1.push_back(30); L1.push_back(40); list\u0026lt;int\u0026gt;L2; L2.assign(10, 100); cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢å‰ï¼š \u0026#34; \u0026lt;\u0026lt; endl; printList(L1); printList(L2); cout \u0026lt;\u0026lt; endl; L1.swap(L2); cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢åï¼š \u0026#34; \u0026lt;\u0026lt; endl; printList(L1); printList(L2); } int main() { //test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šlistèµ‹å€¼å’Œäº¤æ¢æ“ä½œèƒ½å¤Ÿçµæ´»è¿ç”¨å³å¯\n3.7.4 list å¤§å°æ“ä½œ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹listå®¹å™¨çš„å¤§å°è¿›è¡Œæ“ä½œ å‡½æ•°åŸå‹ï¼š\nsize(); //è¿”å›å®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•°\nempty(); //åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º\nresize(num); //é‡æ–°æŒ‡å®šå®¹å™¨çš„é•¿åº¦ä¸ºnumï¼Œè‹¥å®¹å™¨å˜é•¿ï¼Œåˆ™ä»¥é»˜è®¤å€¼å¡«å……æ–°ä½ç½®ã€‚\nâ€‹\t//å¦‚æœå®¹å™¨å˜çŸ­ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨é•¿åº¦çš„å…ƒç´ è¢«åˆ é™¤ã€‚\nresize(num, elem); //é‡æ–°æŒ‡å®šå®¹å™¨çš„é•¿åº¦ä¸ºnumï¼Œè‹¥å®¹å™¨å˜é•¿ï¼Œåˆ™ä»¥elemå€¼å¡«å……æ–°ä½ç½®ã€‚\nâ€‹\t//å¦‚æœå®¹å™¨å˜çŸ­ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨é•¿åº¦çš„å…ƒç´ è¢«åˆ é™¤ã€‚\rç¤ºä¾‹ï¼š\n#include \u0026lt;list\u0026gt; void printList(const list\u0026lt;int\u0026gt;\u0026amp; L) { for (list\u0026lt;int\u0026gt;::const_iterator it = L.begin(); it != L.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //å¤§å°æ“ä½œ void test01() { list\u0026lt;int\u0026gt;L1; L1.push_back(10); L1.push_back(20); L1.push_back(30); L1.push_back(40); if (L1.empty()) { cout \u0026lt;\u0026lt; \u0026#34;L1ä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;L1ä¸ä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;L1çš„å¤§å°ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; L1.size() \u0026lt;\u0026lt; endl; } //é‡æ–°æŒ‡å®šå¤§å° L1.resize(10); printList(L1); L1.resize(2); printList(L1); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nåˆ¤æ–­æ˜¯å¦ä¸ºç©º \u0026mdash; empty è¿”å›å…ƒç´ ä¸ªæ•° \u0026mdash; size é‡æ–°æŒ‡å®šä¸ªæ•° \u0026mdash; resize 3.7.5 list æ’å…¥å’Œåˆ é™¤ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹listå®¹å™¨è¿›è¡Œæ•°æ®çš„æ’å…¥å’Œåˆ é™¤ å‡½æ•°åŸå‹ï¼š\npush_back(elem);//åœ¨å®¹å™¨å°¾éƒ¨åŠ å…¥ä¸€ä¸ªå…ƒç´  pop_back();//åˆ é™¤å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´  push_front(elem);//åœ¨å®¹å™¨å¼€å¤´æ’å…¥ä¸€ä¸ªå…ƒç´  pop_front();//ä»å®¹å™¨å¼€å¤´ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´  insert(pos,elem);//åœ¨posä½ç½®æ’elemå…ƒç´ çš„æ‹·è´ï¼Œè¿”å›æ–°æ•°æ®çš„ä½ç½®ã€‚ insert(pos,n,elem);//åœ¨posä½ç½®æ’å…¥nä¸ªelemæ•°æ®ï¼Œæ— è¿”å›å€¼ã€‚ insert(pos,beg,end);//åœ¨posä½ç½®æ’å…¥[beg,end)åŒºé—´çš„æ•°æ®ï¼Œæ— è¿”å›å€¼ã€‚ clear();//ç§»é™¤å®¹å™¨çš„æ‰€æœ‰æ•°æ® erase(beg,end);//åˆ é™¤[beg,end)åŒºé—´çš„æ•°æ®ï¼Œè¿”å›ä¸‹ä¸€ä¸ªæ•°æ®çš„ä½ç½®ã€‚ erase(pos);//åˆ é™¤posä½ç½®çš„æ•°æ®ï¼Œè¿”å›ä¸‹ä¸€ä¸ªæ•°æ®çš„ä½ç½®ã€‚ remove(elem);//åˆ é™¤å®¹å™¨ä¸­æ‰€æœ‰ä¸elemå€¼åŒ¹é…çš„å…ƒç´ ã€‚ ç¤ºä¾‹ï¼š\n#include \u0026lt;list\u0026gt; void printList(const list\u0026lt;int\u0026gt;\u0026amp; L) { for (list\u0026lt;int\u0026gt;::const_iterator it = L.begin(); it != L.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //æ’å…¥å’Œåˆ é™¤ void test01() { list\u0026lt;int\u0026gt; L; //å°¾æ’ L.push_back(10); L.push_back(20); L.push_back(30); //å¤´æ’ L.push_front(100); L.push_front(200); L.push_front(300); printList(L); //å°¾åˆ  L.pop_back(); printList(L); //å¤´åˆ  L.pop_front(); printList(L); //æ’å…¥ list\u0026lt;int\u0026gt;::iterator it = L.begin(); L.insert(++it, 1000); printList(L); //åˆ é™¤ it = L.begin(); L.erase(++it); printList(L); //ç§»é™¤ L.push_back(10000); L.push_back(10000); L.push_back(10000); printList(L); L.remove(10000); printList(L); //æ¸…ç©º L.clear(); printList(L); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå°¾æ’ \u0026mdash; push_back å°¾åˆ  \u0026mdash; pop_back å¤´æ’ \u0026mdash; push_front å¤´åˆ  \u0026mdash; pop_front æ’å…¥ \u0026mdash; insert åˆ é™¤ \u0026mdash; erase ç§»é™¤ \u0026mdash; remove æ¸…ç©º \u0026mdash; clear 3.7.6 list æ•°æ®å­˜å– #\råŠŸèƒ½æè¿°ï¼š\nå¯¹listå®¹å™¨ä¸­æ•°æ®è¿›è¡Œå­˜å– å‡½æ•°åŸå‹ï¼š\nfront(); //è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ back(); //è¿”å›æœ€åä¸€ä¸ªå…ƒç´ ã€‚ ç¤ºä¾‹ï¼š\n#include \u0026lt;list\u0026gt; //æ•°æ®å­˜å– void test01() { list\u0026lt;int\u0026gt;L1; L1.push_back(10); L1.push_back(20); L1.push_back(30); L1.push_back(40); //cout \u0026lt;\u0026lt; L1.at(0) \u0026lt;\u0026lt; endl;//é”™è¯¯ ä¸æ”¯æŒatè®¿é—®æ•°æ® //cout \u0026lt;\u0026lt; L1[0] \u0026lt;\u0026lt; endl; //é”™è¯¯ ä¸æ”¯æŒ[]æ–¹å¼è®¿é—®æ•°æ® cout \u0026lt;\u0026lt; \u0026#34;ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; L1.front() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;æœ€åä¸€ä¸ªå…ƒç´ ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; L1.back() \u0026lt;\u0026lt; endl; //listå®¹å™¨çš„è¿­ä»£å™¨æ˜¯åŒå‘è¿­ä»£å™¨ï¼Œä¸æ”¯æŒéšæœºè®¿é—® list\u0026lt;int\u0026gt;::iterator it = L1.begin(); //it = it + 1;//é”™è¯¯ï¼Œä¸å¯ä»¥è·³è·ƒè®¿é—®ï¼Œå³ä½¿æ˜¯+1 } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nlistå®¹å™¨ä¸­ä¸å¯ä»¥é€šè¿‡[]æˆ–è€…atæ–¹å¼è®¿é—®æ•°æ® è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´  \u0026mdash; front è¿”å›æœ€åä¸€ä¸ªå…ƒç´  \u0026mdash; back 3.7.7 list åè½¬å’Œæ’åº #\råŠŸèƒ½æè¿°ï¼š\nå°†å®¹å™¨ä¸­çš„å…ƒç´ åè½¬ï¼Œä»¥åŠå°†å®¹å™¨ä¸­çš„æ•°æ®è¿›è¡Œæ’åº å‡½æ•°åŸå‹ï¼š\nreverse(); //åè½¬é“¾è¡¨ sort(); //é“¾è¡¨æ’åº ç¤ºä¾‹ï¼š\nvoid printList(const list\u0026lt;int\u0026gt;\u0026amp; L) { for (list\u0026lt;int\u0026gt;::const_iterator it = L.begin(); it != L.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } bool myCompare(int val1 , int val2) { return val1 \u0026gt; val2; } //åè½¬å’Œæ’åº void test01() { list\u0026lt;int\u0026gt; L; L.push_back(90); L.push_back(30); L.push_back(20); L.push_back(70); printList(L); //åè½¬å®¹å™¨çš„å…ƒç´  L.reverse(); printList(L); //æ’åº L.sort(); //é»˜è®¤çš„æ’åºè§„åˆ™ ä»å°åˆ°å¤§ printList(L); L.sort(myCompare); //æŒ‡å®šè§„åˆ™ï¼Œä»å¤§åˆ°å° printList(L); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nåè½¬ \u0026mdash; reverse æ’åº \u0026mdash; sort ï¼ˆæˆå‘˜å‡½æ•°ï¼‰ 3.7.8 æ’åºæ¡ˆä¾‹ #\ræ¡ˆä¾‹æè¿°ï¼šå°†Personè‡ªå®šä¹‰æ•°æ®ç±»å‹è¿›è¡Œæ’åºï¼ŒPersonä¸­å±æ€§æœ‰å§“åã€å¹´é¾„ã€èº«é«˜\næ’åºè§„åˆ™ï¼šæŒ‰ç…§å¹´é¾„è¿›è¡Œå‡åºï¼Œå¦‚æœå¹´é¾„ç›¸åŒæŒ‰ç…§èº«é«˜è¿›è¡Œé™åº\nç¤ºä¾‹ï¼š\n#include \u0026lt;list\u0026gt; #include \u0026lt;string\u0026gt; class Person { public: Person(string name, int age , int height) { m_Name = name; m_Age = age; m_Height = height; } public: string m_Name; //å§“å int m_Age; //å¹´é¾„ int m_Height; //èº«é«˜ }; bool ComparePerson(Person\u0026amp; p1, Person\u0026amp; p2) { if (p1.m_Age == p2.m_Age) { return p1.m_Height \u0026gt; p2.m_Height; } else { return p1.m_Age \u0026lt; p2.m_Age; } } void test01() { list\u0026lt;Person\u0026gt; L; Person p1(\u0026#34;åˆ˜å¤‡\u0026#34;, 35 , 175); Person p2(\u0026#34;æ›¹æ“\u0026#34;, 45 , 180); Person p3(\u0026#34;å­™æƒ\u0026#34;, 40 , 170); Person p4(\u0026#34;èµµäº‘\u0026#34;, 25 , 190); Person p5(\u0026#34;å¼ é£\u0026#34;, 35 , 160); Person p6(\u0026#34;å…³ç¾½\u0026#34;, 35 , 200); L.push_back(p1); L.push_back(p2); L.push_back(p3); L.push_back(p4); L.push_back(p5); L.push_back(p6); for (list\u0026lt;Person\u0026gt;::iterator it = L.begin(); it != L.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Age \u0026lt;\u0026lt; \u0026#34; èº«é«˜ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Height \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; \u0026#34;---------------------------------\u0026#34; \u0026lt;\u0026lt; endl; L.sort(ComparePerson); //æ’åº for (list\u0026lt;Person\u0026gt;::iterator it = L.begin(); it != L.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Age \u0026lt;\u0026lt; \u0026#34; èº«é«˜ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Height \u0026lt;\u0026lt; endl; } } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå¯¹äºè‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå¿…é¡»è¦æŒ‡å®šæ’åºè§„åˆ™ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¸çŸ¥é“å¦‚ä½•è¿›è¡Œæ’åº\né«˜çº§æ’åºåªæ˜¯åœ¨æ’åºè§„åˆ™ä¸Šå†è¿›è¡Œä¸€æ¬¡é€»è¾‘è§„åˆ™åˆ¶å®šï¼Œå¹¶ä¸å¤æ‚\n3.8 set/ multiset å®¹å™¨ #\r3.8.1 setåŸºæœ¬æ¦‚å¿µ #\rç®€ä»‹ï¼š\næ‰€æœ‰å…ƒç´ éƒ½ä¼šåœ¨æ’å…¥æ—¶è‡ªåŠ¨è¢«æ’åº æœ¬è´¨ï¼š\nset/multisetå±äºå…³è”å¼å®¹å™¨ï¼Œåº•å±‚ç»“æ„æ˜¯ç”¨äºŒå‰æ ‘å®ç°ã€‚ setå’ŒmultisetåŒºåˆ«ï¼š\nsetä¸å…è®¸å®¹å™¨ä¸­æœ‰é‡å¤çš„å…ƒç´  multisetå…è®¸å®¹å™¨ä¸­æœ‰é‡å¤çš„å…ƒç´  3.8.2 setæ„é€ å’Œèµ‹å€¼ #\råŠŸèƒ½æè¿°ï¼šåˆ›å»ºsetå®¹å™¨ä»¥åŠèµ‹å€¼\næ„é€ ï¼š\nset\u0026lt;T\u0026gt; st; //é»˜è®¤æ„é€ å‡½æ•°ï¼š set(const set \u0026amp;st); //æ‹·è´æ„é€ å‡½æ•° èµ‹å€¼ï¼š\nset\u0026amp; operator=(const set \u0026amp;st); //é‡è½½ç­‰å·æ“ä½œç¬¦ ç¤ºä¾‹ï¼š\n#include \u0026lt;set\u0026gt; void printSet(set\u0026lt;int\u0026gt; \u0026amp; s) { for (set\u0026lt;int\u0026gt;::iterator it = s.begin(); it != s.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //æ„é€ å’Œèµ‹å€¼ void test01() { set\u0026lt;int\u0026gt; s1; s1.insert(10); s1.insert(30); s1.insert(20); s1.insert(40); printSet(s1); //æ‹·è´æ„é€  set\u0026lt;int\u0026gt;s2(s1); printSet(s2); //èµ‹å€¼ set\u0026lt;int\u0026gt;s3; s3 = s2; printSet(s3); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nsetå®¹å™¨æ’å…¥æ•°æ®æ—¶ç”¨insert setå®¹å™¨æ’å…¥æ•°æ®çš„æ•°æ®ä¼šè‡ªåŠ¨æ’åº 3.8.3 setå¤§å°å’Œäº¤æ¢ #\råŠŸèƒ½æè¿°ï¼š\nç»Ÿè®¡setå®¹å™¨å¤§å°ä»¥åŠäº¤æ¢setå®¹å™¨ å‡½æ•°åŸå‹ï¼š\nsize(); //è¿”å›å®¹å™¨ä¸­å…ƒç´ çš„æ•°ç›® empty(); //åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º swap(st); //äº¤æ¢ä¸¤ä¸ªé›†åˆå®¹å™¨ ç¤ºä¾‹ï¼š\n#include \u0026lt;set\u0026gt; void printSet(set\u0026lt;int\u0026gt; \u0026amp; s) { for (set\u0026lt;int\u0026gt;::iterator it = s.begin(); it != s.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //å¤§å° void test01() { set\u0026lt;int\u0026gt; s1; s1.insert(10); s1.insert(30); s1.insert(20); s1.insert(40); if (s1.empty()) { cout \u0026lt;\u0026lt; \u0026#34;s1ä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;s1ä¸ä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;s1çš„å¤§å°ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; s1.size() \u0026lt;\u0026lt; endl; } } //äº¤æ¢ void test02() { set\u0026lt;int\u0026gt; s1; s1.insert(10); s1.insert(30); s1.insert(20); s1.insert(40); set\u0026lt;int\u0026gt; s2; s2.insert(100); s2.insert(300); s2.insert(200); s2.insert(400); cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢å‰\u0026#34; \u0026lt;\u0026lt; endl; printSet(s1); printSet(s2); cout \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢å\u0026#34; \u0026lt;\u0026lt; endl; s1.swap(s2); printSet(s1); printSet(s2); } int main() { //test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nç»Ÿè®¡å¤§å° \u0026mdash; size åˆ¤æ–­æ˜¯å¦ä¸ºç©º \u0026mdash; empty äº¤æ¢å®¹å™¨ \u0026mdash; swap 3.8.4 setæ’å…¥å’Œåˆ é™¤ #\råŠŸèƒ½æè¿°ï¼š\nsetå®¹å™¨è¿›è¡Œæ’å…¥æ•°æ®å’Œåˆ é™¤æ•°æ® å‡½æ•°åŸå‹ï¼š\ninsert(elem); //åœ¨å®¹å™¨ä¸­æ’å…¥å…ƒç´ ã€‚ clear(); //æ¸…é™¤æ‰€æœ‰å…ƒç´  erase(pos); //åˆ é™¤posè¿­ä»£å™¨æ‰€æŒ‡çš„å…ƒç´ ï¼Œè¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚ erase(beg, end); //åˆ é™¤åŒºé—´[beg,end)çš„æ‰€æœ‰å…ƒç´  ï¼Œè¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚ erase(elem); //åˆ é™¤å®¹å™¨ä¸­å€¼ä¸ºelemçš„å…ƒç´ ã€‚ ç¤ºä¾‹ï¼š\n#include \u0026lt;set\u0026gt; void printSet(set\u0026lt;int\u0026gt; \u0026amp; s) { for (set\u0026lt;int\u0026gt;::iterator it = s.begin(); it != s.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } //æ’å…¥å’Œåˆ é™¤ void test01() { set\u0026lt;int\u0026gt; s1; //æ’å…¥ s1.insert(10); s1.insert(30); s1.insert(20); s1.insert(40); printSet(s1); //åˆ é™¤ s1.erase(s1.begin()); printSet(s1); s1.erase(30); printSet(s1); //æ¸…ç©º //s1.erase(s1.begin(), s1.end()); s1.clear(); printSet(s1); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\næ’å…¥ \u0026mdash; insert åˆ é™¤ \u0026mdash; erase æ¸…ç©º \u0026mdash; clear 3.8.5 setæŸ¥æ‰¾å’Œç»Ÿè®¡ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹setå®¹å™¨è¿›è¡ŒæŸ¥æ‰¾æ•°æ®ä»¥åŠç»Ÿè®¡æ•°æ® å‡½æ•°åŸå‹ï¼š\nfind(key); //æŸ¥æ‰¾keyæ˜¯å¦å­˜åœ¨,è‹¥å­˜åœ¨ï¼Œè¿”å›è¯¥é”®çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼›è‹¥ä¸å­˜åœ¨ï¼Œè¿”å›set.end(); count(key); //ç»Ÿè®¡keyçš„å…ƒç´ ä¸ªæ•° ç¤ºä¾‹ï¼š\n#include \u0026lt;set\u0026gt; //æŸ¥æ‰¾å’Œç»Ÿè®¡ void test01() { set\u0026lt;int\u0026gt; s1; //æ’å…¥ s1.insert(10); s1.insert(30); s1.insert(20); s1.insert(40); //æŸ¥æ‰¾ set\u0026lt;int\u0026gt;::iterator pos = s1.find(30); if (pos != s1.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°äº†å…ƒç´  ï¼š \u0026#34; \u0026lt;\u0026lt; *pos \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æœªæ‰¾åˆ°å…ƒç´ \u0026#34; \u0026lt;\u0026lt; endl; } //ç»Ÿè®¡ int num = s1.count(30); cout \u0026lt;\u0026lt; \u0026#34;num = \u0026#34; \u0026lt;\u0026lt; num \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\næŸ¥æ‰¾ \u0026mdash; find ï¼ˆè¿”å›çš„æ˜¯è¿­ä»£å™¨ï¼‰ ç»Ÿè®¡ \u0026mdash; count ï¼ˆå¯¹äºsetï¼Œç»“æœä¸º0æˆ–è€…1ï¼‰ 3.8.6 setå’ŒmultisetåŒºåˆ« #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡setå’Œmultisetçš„åŒºåˆ« åŒºåˆ«ï¼š\nsetä¸å¯ä»¥æ’å…¥é‡å¤æ•°æ®ï¼Œè€Œmultisetå¯ä»¥ setæ’å…¥æ•°æ®çš„åŒæ—¶ä¼šè¿”å›æ’å…¥ç»“æœï¼Œè¡¨ç¤ºæ’å…¥æ˜¯å¦æˆåŠŸ multisetä¸ä¼šæ£€æµ‹æ•°æ®ï¼Œå› æ­¤å¯ä»¥æ’å…¥é‡å¤æ•°æ® ç¤ºä¾‹ï¼š\n#include \u0026lt;set\u0026gt; //setå’ŒmultisetåŒºåˆ« void test01() { set\u0026lt;int\u0026gt; s; pair\u0026lt;set\u0026lt;int\u0026gt;::iterator, bool\u0026gt; ret = s.insert(10); if (ret.second) { cout \u0026lt;\u0026lt; \u0026#34;ç¬¬ä¸€æ¬¡æ’å…¥æˆåŠŸ!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;ç¬¬ä¸€æ¬¡æ’å…¥å¤±è´¥!\u0026#34; \u0026lt;\u0026lt; endl; } ret = s.insert(10); if (ret.second) { cout \u0026lt;\u0026lt; \u0026#34;ç¬¬äºŒæ¬¡æ’å…¥æˆåŠŸ!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;ç¬¬äºŒæ¬¡æ’å…¥å¤±è´¥!\u0026#34; \u0026lt;\u0026lt; endl; } //multiset multiset\u0026lt;int\u0026gt; ms; ms.insert(10); ms.insert(10); for (multiset\u0026lt;int\u0026gt;::iterator it = ms.begin(); it != ms.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå¦‚æœä¸å…è®¸æ’å…¥é‡å¤æ•°æ®å¯ä»¥åˆ©ç”¨set å¦‚æœéœ€è¦æ’å…¥é‡å¤æ•°æ®åˆ©ç”¨multiset 3.8.7 pairå¯¹ç»„åˆ›å»º #\råŠŸèƒ½æè¿°ï¼š\næˆå¯¹å‡ºç°çš„æ•°æ®ï¼Œåˆ©ç”¨å¯¹ç»„å¯ä»¥è¿”å›ä¸¤ä¸ªæ•°æ® ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼š\npair\u0026lt;type, type\u0026gt; p ( value1, value2 ); pair\u0026lt;type, type\u0026gt; p = make_pair( value1, value2 ); ç¤ºä¾‹ï¼š\n#include \u0026lt;string\u0026gt; //å¯¹ç»„åˆ›å»º void test01() { pair\u0026lt;string, int\u0026gt; p(string(\u0026#34;Tom\u0026#34;), 20); cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; p.first \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34; \u0026lt;\u0026lt; p.second \u0026lt;\u0026lt; endl; pair\u0026lt;string, int\u0026gt; p2 = make_pair(\u0026#34;Jerry\u0026#34;, 10); cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; p2.first \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34; \u0026lt;\u0026lt; p2.second \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nä¸¤ç§æ–¹å¼éƒ½å¯ä»¥åˆ›å»ºå¯¹ç»„ï¼Œè®°ä½ä¸€ç§å³å¯\n3.8.8 setå®¹å™¨æ’åº #\rå­¦ä¹ ç›®æ ‡ï¼š\nsetå®¹å™¨é»˜è®¤æ’åºè§„åˆ™ä¸ºä»å°åˆ°å¤§ï¼ŒæŒæ¡å¦‚ä½•æ”¹å˜æ’åºè§„åˆ™ ä¸»è¦æŠ€æœ¯ç‚¹ï¼š\nåˆ©ç”¨ä»¿å‡½æ•°ï¼Œå¯ä»¥æ”¹å˜æ’åºè§„åˆ™ ç¤ºä¾‹ä¸€ setå­˜æ”¾å†…ç½®æ•°æ®ç±»å‹\n#include \u0026lt;set\u0026gt; class MyCompare { public: bool operator()(int v1, int v2) { return v1 \u0026gt; v2; } }; void test01() { set\u0026lt;int\u0026gt; s1; s1.insert(10); s1.insert(40); s1.insert(20); s1.insert(30); s1.insert(50); //é»˜è®¤ä»å°åˆ°å¤§ for (set\u0026lt;int\u0026gt;::iterator it = s1.begin(); it != s1.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; //æŒ‡å®šæ’åºè§„åˆ™ set\u0026lt;int,MyCompare\u0026gt; s2; s2.insert(10); s2.insert(40); s2.insert(20); s2.insert(30); s2.insert(50); for (set\u0026lt;int, MyCompare\u0026gt;::iterator it = s2.begin(); it != s2.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šåˆ©ç”¨ä»¿å‡½æ•°å¯ä»¥æŒ‡å®šsetå®¹å™¨çš„æ’åºè§„åˆ™\nç¤ºä¾‹äºŒ setå­˜æ”¾è‡ªå®šä¹‰æ•°æ®ç±»å‹\n#include \u0026lt;set\u0026gt; #include \u0026lt;string\u0026gt; class Person { public: Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } string m_Name; int m_Age; }; class comparePerson { public: bool operator()(const Person\u0026amp; p1, const Person \u0026amp;p2) { //æŒ‰ç…§å¹´é¾„è¿›è¡Œæ’åº é™åº return p1.m_Age \u0026gt; p2.m_Age; } }; void test01() { set\u0026lt;Person, comparePerson\u0026gt; s; Person p1(\u0026#34;åˆ˜å¤‡\u0026#34;, 23); Person p2(\u0026#34;å…³ç¾½\u0026#34;, 27); Person p3(\u0026#34;å¼ é£\u0026#34;, 25); Person p4(\u0026#34;èµµäº‘\u0026#34;, 21); s.insert(p1); s.insert(p2); s.insert(p3); s.insert(p4); for (set\u0026lt;Person, comparePerson\u0026gt;::iterator it = s.begin(); it != s.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Age \u0026lt;\u0026lt; endl; } } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå¯¹äºè‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œsetå¿…é¡»æŒ‡å®šæ’åºè§„åˆ™æ‰å¯ä»¥æ’å…¥æ•°æ®\n3.9 map/ multimapå®¹å™¨ #\r3.9.1 mapåŸºæœ¬æ¦‚å¿µ #\rç®€ä»‹ï¼š\nmapä¸­æ‰€æœ‰å…ƒç´ éƒ½æ˜¯pair pairä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºkeyï¼ˆé”®å€¼ï¼‰ï¼Œèµ·åˆ°ç´¢å¼•ä½œç”¨ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸ºvalueï¼ˆå®å€¼ï¼‰ æ‰€æœ‰å…ƒç´ éƒ½ä¼šæ ¹æ®å…ƒç´ çš„é”®å€¼è‡ªåŠ¨æ’åº æœ¬è´¨ï¼š\nmap/multimapå±äºå…³è”å¼å®¹å™¨ï¼Œåº•å±‚ç»“æ„æ˜¯ç”¨äºŒå‰æ ‘å®ç°ã€‚ ä¼˜ç‚¹ï¼š\nå¯ä»¥æ ¹æ®keyå€¼å¿«é€Ÿæ‰¾åˆ°valueå€¼ mapå’ŒmultimapåŒºåˆ«ï¼š\nmapä¸å…è®¸å®¹å™¨ä¸­æœ‰é‡å¤keyå€¼å…ƒç´  multimapå…è®¸å®¹å™¨ä¸­æœ‰é‡å¤keyå€¼å…ƒç´  3.9.2 mapæ„é€ å’Œèµ‹å€¼ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹mapå®¹å™¨è¿›è¡Œæ„é€ å’Œèµ‹å€¼æ“ä½œ å‡½æ•°åŸå‹ï¼š\næ„é€ ï¼š\nmap\u0026lt;T1, T2\u0026gt; mp; //mapé»˜è®¤æ„é€ å‡½æ•°: map(const map \u0026amp;mp); //æ‹·è´æ„é€ å‡½æ•° èµ‹å€¼ï¼š\nmap\u0026amp; operator=(const map \u0026amp;mp); //é‡è½½ç­‰å·æ“ä½œç¬¦ ç¤ºä¾‹ï¼š\n#include \u0026lt;map\u0026gt; void printMap(map\u0026lt;int,int\u0026gt;\u0026amp;m) { for (map\u0026lt;int, int\u0026gt;::iterator it = m.begin(); it != m.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;key = \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;first \u0026lt;\u0026lt; \u0026#34; value = \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;second \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; } void test01() { map\u0026lt;int,int\u0026gt;m; //é»˜è®¤æ„é€  m.insert(pair\u0026lt;int, int\u0026gt;(1, 10)); m.insert(pair\u0026lt;int, int\u0026gt;(2, 20)); m.insert(pair\u0026lt;int, int\u0026gt;(3, 30)); printMap(m); map\u0026lt;int, int\u0026gt;m2(m); //æ‹·è´æ„é€  printMap(m2); map\u0026lt;int, int\u0026gt;m3; m3 = m2; //èµ‹å€¼ printMap(m3); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šmapä¸­æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æˆå¯¹å‡ºç°ï¼Œæ’å…¥æ•°æ®æ—¶å€™è¦ä½¿ç”¨å¯¹ç»„\n3.9.3 mapå¤§å°å’Œäº¤æ¢ #\råŠŸèƒ½æè¿°ï¼š\nç»Ÿè®¡mapå®¹å™¨å¤§å°ä»¥åŠäº¤æ¢mapå®¹å™¨ å‡½æ•°åŸå‹ï¼š\nsize(); //è¿”å›å®¹å™¨ä¸­å…ƒç´ çš„æ•°ç›® empty(); //åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º swap(st); //äº¤æ¢ä¸¤ä¸ªé›†åˆå®¹å™¨ ç¤ºä¾‹ï¼š\n#include \u0026lt;map\u0026gt; void printMap(map\u0026lt;int,int\u0026gt;\u0026amp;m) { for (map\u0026lt;int, int\u0026gt;::iterator it = m.begin(); it != m.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;key = \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;first \u0026lt;\u0026lt; \u0026#34; value = \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;second \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; } void test01() { map\u0026lt;int, int\u0026gt;m; m.insert(pair\u0026lt;int, int\u0026gt;(1, 10)); m.insert(pair\u0026lt;int, int\u0026gt;(2, 20)); m.insert(pair\u0026lt;int, int\u0026gt;(3, 30)); if (m.empty()) { cout \u0026lt;\u0026lt; \u0026#34;mä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;mä¸ä¸ºç©º\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;mçš„å¤§å°ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; m.size() \u0026lt;\u0026lt; endl; } } //äº¤æ¢ void test02() { map\u0026lt;int, int\u0026gt;m; m.insert(pair\u0026lt;int, int\u0026gt;(1, 10)); m.insert(pair\u0026lt;int, int\u0026gt;(2, 20)); m.insert(pair\u0026lt;int, int\u0026gt;(3, 30)); map\u0026lt;int, int\u0026gt;m2; m2.insert(pair\u0026lt;int, int\u0026gt;(4, 100)); m2.insert(pair\u0026lt;int, int\u0026gt;(5, 200)); m2.insert(pair\u0026lt;int, int\u0026gt;(6, 300)); cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢å‰\u0026#34; \u0026lt;\u0026lt; endl; printMap(m); printMap(m2); cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢å\u0026#34; \u0026lt;\u0026lt; endl; m.swap(m2); printMap(m); printMap(m2); } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nç»Ÿè®¡å¤§å° \u0026mdash; size åˆ¤æ–­æ˜¯å¦ä¸ºç©º \u0026mdash; empty äº¤æ¢å®¹å™¨ \u0026mdash; swap 3.9.4 mapæ’å…¥å’Œåˆ é™¤ #\råŠŸèƒ½æè¿°ï¼š\nmapå®¹å™¨è¿›è¡Œæ’å…¥æ•°æ®å’Œåˆ é™¤æ•°æ® å‡½æ•°åŸå‹ï¼š\ninsert(elem); //åœ¨å®¹å™¨ä¸­æ’å…¥å…ƒç´ ã€‚ clear(); //æ¸…é™¤æ‰€æœ‰å…ƒç´  erase(pos); //åˆ é™¤posè¿­ä»£å™¨æ‰€æŒ‡çš„å…ƒç´ ï¼Œè¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚ erase(beg, end); //åˆ é™¤åŒºé—´[beg,end)çš„æ‰€æœ‰å…ƒç´  ï¼Œè¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚ erase(key); //åˆ é™¤å®¹å™¨ä¸­å€¼ä¸ºkeyçš„å…ƒç´ ã€‚ ç¤ºä¾‹ï¼š\n#include \u0026lt;map\u0026gt; void printMap(map\u0026lt;int,int\u0026gt;\u0026amp;m) { for (map\u0026lt;int, int\u0026gt;::iterator it = m.begin(); it != m.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;key = \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;first \u0026lt;\u0026lt; \u0026#34; value = \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;second \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; } void test01() { //æ’å…¥ map\u0026lt;int, int\u0026gt; m; //ç¬¬ä¸€ç§æ’å…¥æ–¹å¼ m.insert(pair\u0026lt;int, int\u0026gt;(1, 10)); //ç¬¬äºŒç§æ’å…¥æ–¹å¼ m.insert(make_pair(2, 20)); //ç¬¬ä¸‰ç§æ’å…¥æ–¹å¼ m.insert(map\u0026lt;int, int\u0026gt;::value_type(3, 30)); //ç¬¬å››ç§æ’å…¥æ–¹å¼ m[4] = 40; printMap(m); //åˆ é™¤ m.erase(m.begin()); printMap(m); m.erase(3); printMap(m); //æ¸…ç©º m.erase(m.begin(),m.end()); m.clear(); printMap(m); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nmapæ’å…¥æ–¹å¼å¾ˆå¤šï¼Œè®°ä½å…¶ä¸€å³å¯ æ’å…¥ \u0026mdash; insert åˆ é™¤ \u0026mdash; erase æ¸…ç©º \u0026mdash; clear 3.9.5 mapæŸ¥æ‰¾å’Œç»Ÿè®¡ #\råŠŸèƒ½æè¿°ï¼š\nå¯¹mapå®¹å™¨è¿›è¡ŒæŸ¥æ‰¾æ•°æ®ä»¥åŠç»Ÿè®¡æ•°æ® å‡½æ•°åŸå‹ï¼š\nfind(key); //æŸ¥æ‰¾keyæ˜¯å¦å­˜åœ¨,è‹¥å­˜åœ¨ï¼Œè¿”å›è¯¥é”®çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼›è‹¥ä¸å­˜åœ¨ï¼Œè¿”å›set.end(); count(key); //ç»Ÿè®¡keyçš„å…ƒç´ ä¸ªæ•° ç¤ºä¾‹ï¼š\n#include \u0026lt;map\u0026gt; //æŸ¥æ‰¾å’Œç»Ÿè®¡ void test01() { map\u0026lt;int, int\u0026gt;m; m.insert(pair\u0026lt;int, int\u0026gt;(1, 10)); m.insert(pair\u0026lt;int, int\u0026gt;(2, 20)); m.insert(pair\u0026lt;int, int\u0026gt;(3, 30)); //æŸ¥æ‰¾ map\u0026lt;int, int\u0026gt;::iterator pos = m.find(3); if (pos != m.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°äº†å…ƒç´  key = \u0026#34; \u0026lt;\u0026lt; (*pos).first \u0026lt;\u0026lt; \u0026#34; value = \u0026#34; \u0026lt;\u0026lt; (*pos).second \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æœªæ‰¾åˆ°å…ƒç´ \u0026#34; \u0026lt;\u0026lt; endl; } //ç»Ÿè®¡ int num = m.count(3); cout \u0026lt;\u0026lt; \u0026#34;num = \u0026#34; \u0026lt;\u0026lt; num \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\næŸ¥æ‰¾ \u0026mdash; find ï¼ˆè¿”å›çš„æ˜¯è¿­ä»£å™¨ï¼‰ ç»Ÿè®¡ \u0026mdash; count ï¼ˆå¯¹äºmapï¼Œç»“æœä¸º0æˆ–è€…1ï¼‰ 3.9.6 mapå®¹å™¨æ’åº #\rå­¦ä¹ ç›®æ ‡ï¼š\nmapå®¹å™¨é»˜è®¤æ’åºè§„åˆ™ä¸º æŒ‰ç…§keyå€¼è¿›è¡Œ ä»å°åˆ°å¤§æ’åºï¼ŒæŒæ¡å¦‚ä½•æ”¹å˜æ’åºè§„åˆ™ ä¸»è¦æŠ€æœ¯ç‚¹:\nåˆ©ç”¨ä»¿å‡½æ•°ï¼Œå¯ä»¥æ”¹å˜æ’åºè§„åˆ™ ç¤ºä¾‹ï¼š\n#include \u0026lt;map\u0026gt; class MyCompare { public: bool operator()(int v1, int v2) { return v1 \u0026gt; v2; } }; void test01() { //é»˜è®¤ä»å°åˆ°å¤§æ’åº //åˆ©ç”¨ä»¿å‡½æ•°å®ç°ä»å¤§åˆ°å°æ’åº map\u0026lt;int, int, MyCompare\u0026gt; m; m.insert(make_pair(1, 10)); m.insert(make_pair(2, 20)); m.insert(make_pair(3, 30)); m.insert(make_pair(4, 40)); m.insert(make_pair(5, 50)); for (map\u0026lt;int, int, MyCompare\u0026gt;::iterator it = m.begin(); it != m.end(); it++) { cout \u0026lt;\u0026lt; \u0026#34;key:\u0026#34; \u0026lt;\u0026lt; it-\u0026gt;first \u0026lt;\u0026lt; \u0026#34; value:\u0026#34; \u0026lt;\u0026lt; it-\u0026gt;second \u0026lt;\u0026lt; endl; } } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nåˆ©ç”¨ä»¿å‡½æ•°å¯ä»¥æŒ‡å®šmapå®¹å™¨çš„æ’åºè§„åˆ™ å¯¹äºè‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œmapå¿…é¡»è¦æŒ‡å®šæ’åºè§„åˆ™,åŒsetå®¹å™¨ 3.10 æ¡ˆä¾‹-å‘˜å·¥åˆ†ç»„ #\r3.10.1 æ¡ˆä¾‹æè¿° #\rå…¬å¸ä»Šå¤©æ‹›è˜äº†10ä¸ªå‘˜å·¥ï¼ˆABCDEFGHIJï¼‰ï¼Œ10åå‘˜å·¥è¿›å…¥å…¬å¸ä¹‹åï¼Œéœ€è¦æŒ‡æ´¾å‘˜å·¥åœ¨é‚£ä¸ªéƒ¨é—¨å·¥ä½œ å‘˜å·¥ä¿¡æ¯æœ‰: å§“å å·¥èµ„ç»„æˆï¼›éƒ¨é—¨åˆ†ä¸ºï¼šç­–åˆ’ã€ç¾æœ¯ã€ç ”å‘ éšæœºç»™10åå‘˜å·¥åˆ†é…éƒ¨é—¨å’Œå·¥èµ„ é€šè¿‡multimapè¿›è¡Œä¿¡æ¯çš„æ’å…¥ key(éƒ¨é—¨ç¼–å·) value(å‘˜å·¥) åˆ†éƒ¨é—¨æ˜¾ç¤ºå‘˜å·¥ä¿¡æ¯ 3.10.2 å®ç°æ­¥éª¤ #\råˆ›å»º10åå‘˜å·¥ï¼Œæ”¾åˆ°vectorä¸­ éå†vectorå®¹å™¨ï¼Œå–å‡ºæ¯ä¸ªå‘˜å·¥ï¼Œè¿›è¡Œéšæœºåˆ†ç»„ åˆ†ç»„åï¼Œå°†å‘˜å·¥éƒ¨é—¨ç¼–å·ä½œä¸ºkeyï¼Œå…·ä½“å‘˜å·¥ä½œä¸ºvalueï¼Œæ”¾å…¥åˆ°multimapå®¹å™¨ä¸­ åˆ†éƒ¨é—¨æ˜¾ç¤ºå‘˜å·¥ä¿¡æ¯ æ¡ˆä¾‹ä»£ç ï¼š\n#include\u0026lt;iostream\u0026gt; using namespace std; #include \u0026lt;vector\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;map\u0026gt; #include \u0026lt;ctime\u0026gt; /* - å…¬å¸ä»Šå¤©æ‹›è˜äº†10ä¸ªå‘˜å·¥ï¼ˆABCDEFGHIJï¼‰ï¼Œ10åå‘˜å·¥è¿›å…¥å…¬å¸ä¹‹åï¼Œéœ€è¦æŒ‡æ´¾å‘˜å·¥åœ¨é‚£ä¸ªéƒ¨é—¨å·¥ä½œ - å‘˜å·¥ä¿¡æ¯æœ‰: å§“å å·¥èµ„ç»„æˆï¼›éƒ¨é—¨åˆ†ä¸ºï¼šç­–åˆ’ã€ç¾æœ¯ã€ç ”å‘ - éšæœºç»™10åå‘˜å·¥åˆ†é…éƒ¨é—¨å’Œå·¥èµ„ - é€šè¿‡multimapè¿›è¡Œä¿¡æ¯çš„æ’å…¥ key(éƒ¨é—¨ç¼–å·) value(å‘˜å·¥) - åˆ†éƒ¨é—¨æ˜¾ç¤ºå‘˜å·¥ä¿¡æ¯ */ #define CEHUA 0 #define MEISHU 1 #define YANFA 2 class Worker { public: string m_Name; int m_Salary; }; void createWorker(vector\u0026lt;Worker\u0026gt;\u0026amp;v) { string nameSeed = \u0026#34;ABCDEFGHIJ\u0026#34;; for (int i = 0; i \u0026lt; 10; i++) { Worker worker; worker.m_Name = \u0026#34;å‘˜å·¥\u0026#34;; worker.m_Name += nameSeed[i]; worker.m_Salary = rand() % 10000 + 10000; // 10000 ~ 19999 //å°†å‘˜å·¥æ”¾å…¥åˆ°å®¹å™¨ä¸­ v.push_back(worker); } } //å‘˜å·¥åˆ†ç»„ void setGroup(vector\u0026lt;Worker\u0026gt;\u0026amp;v,multimap\u0026lt;int,Worker\u0026gt;\u0026amp;m) { for (vector\u0026lt;Worker\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { //äº§ç”Ÿéšæœºéƒ¨é—¨ç¼–å· int deptId = rand() % 3; // 0 1 2 //å°†å‘˜å·¥æ’å…¥åˆ°åˆ†ç»„ä¸­ //keyéƒ¨é—¨ç¼–å·ï¼Œvalueå…·ä½“å‘˜å·¥ m.insert(make_pair(deptId, *it)); } } void showWorkerByGourp(multimap\u0026lt;int,Worker\u0026gt;\u0026amp;m) { // 0 A B C 1 D E 2 F G ... cout \u0026lt;\u0026lt; \u0026#34;ç­–åˆ’éƒ¨é—¨ï¼š\u0026#34; \u0026lt;\u0026lt; endl; multimap\u0026lt;int,Worker\u0026gt;::iterator pos = m.find(CEHUA); int count = m.count(CEHUA); // ç»Ÿè®¡å…·ä½“äººæ•° int index = 0; for (; pos != m.end() \u0026amp;\u0026amp; index \u0026lt; count; pos++ , index++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; pos-\u0026gt;second.m_Name \u0026lt;\u0026lt; \u0026#34; å·¥èµ„ï¼š \u0026#34; \u0026lt;\u0026lt; pos-\u0026gt;second.m_Salary \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; \u0026#34;----------------------\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;ç¾æœ¯éƒ¨é—¨ï¼š \u0026#34; \u0026lt;\u0026lt; endl; pos = m.find(MEISHU); count = m.count(MEISHU); // ç»Ÿè®¡å…·ä½“äººæ•° index = 0; for (; pos != m.end() \u0026amp;\u0026amp; index \u0026lt; count; pos++, index++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; pos-\u0026gt;second.m_Name \u0026lt;\u0026lt; \u0026#34; å·¥èµ„ï¼š \u0026#34; \u0026lt;\u0026lt; pos-\u0026gt;second.m_Salary \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; \u0026#34;----------------------\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;ç ”å‘éƒ¨é—¨ï¼š \u0026#34; \u0026lt;\u0026lt; endl; pos = m.find(YANFA); count = m.count(YANFA); // ç»Ÿè®¡å…·ä½“äººæ•° index = 0; for (; pos != m.end() \u0026amp;\u0026amp; index \u0026lt; count; pos++, index++) { cout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; pos-\u0026gt;second.m_Name \u0026lt;\u0026lt; \u0026#34; å·¥èµ„ï¼š \u0026#34; \u0026lt;\u0026lt; pos-\u0026gt;second.m_Salary \u0026lt;\u0026lt; endl; } } int main() { srand((unsigned int)time(NULL)); //1ã€åˆ›å»ºå‘˜å·¥ vector\u0026lt;Worker\u0026gt;vWorker; createWorker(vWorker); //2ã€å‘˜å·¥åˆ†ç»„ multimap\u0026lt;int, Worker\u0026gt;mWorker; setGroup(vWorker, mWorker); //3ã€åˆ†ç»„æ˜¾ç¤ºå‘˜å·¥ showWorkerByGourp(mWorker); ////æµ‹è¯• //for (vector\u0026lt;Worker\u0026gt;::iterator it = vWorker.begin(); it != vWorker.end(); it++) //{ //\tcout \u0026lt;\u0026lt; \u0026#34;å§“åï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å·¥èµ„ï¼š \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Salary \u0026lt;\u0026lt; endl; //} system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nå½“æ•°æ®ä»¥é”®å€¼å¯¹å½¢å¼å­˜åœ¨ï¼Œå¯ä»¥è€ƒè™‘ç”¨map æˆ– multimap 4 STL- å‡½æ•°å¯¹è±¡ #\r4.1 å‡½æ•°å¯¹è±¡ #\r4.1.1 å‡½æ•°å¯¹è±¡æ¦‚å¿µ #\ræ¦‚å¿µï¼š\né‡è½½å‡½æ•°è°ƒç”¨æ“ä½œç¬¦çš„ç±»ï¼Œå…¶å¯¹è±¡å¸¸ç§°ä¸ºå‡½æ•°å¯¹è±¡ å‡½æ•°å¯¹è±¡ä½¿ç”¨é‡è½½çš„()æ—¶ï¼Œè¡Œä¸ºç±»ä¼¼å‡½æ•°è°ƒç”¨ï¼Œä¹Ÿå«ä»¿å‡½æ•° æœ¬è´¨ï¼š\nå‡½æ•°å¯¹è±¡(ä»¿å‡½æ•°)æ˜¯ä¸€ä¸ªç±»ï¼Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°\n4.1.2 å‡½æ•°å¯¹è±¡ä½¿ç”¨ #\rç‰¹ç‚¹ï¼š\nå‡½æ•°å¯¹è±¡åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥åƒæ™®é€šå‡½æ•°é‚£æ ·è°ƒç”¨, å¯ä»¥æœ‰å‚æ•°ï¼Œå¯ä»¥æœ‰è¿”å›å€¼ å‡½æ•°å¯¹è±¡è¶…å‡ºæ™®é€šå‡½æ•°çš„æ¦‚å¿µï¼Œå‡½æ•°å¯¹è±¡å¯ä»¥æœ‰è‡ªå·±çš„çŠ¶æ€ å‡½æ•°å¯¹è±¡å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ ç¤ºä¾‹:\n#include \u0026lt;string\u0026gt; //1ã€å‡½æ•°å¯¹è±¡åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥åƒæ™®é€šå‡½æ•°é‚£æ ·è°ƒç”¨, å¯ä»¥æœ‰å‚æ•°ï¼Œå¯ä»¥æœ‰è¿”å›å€¼ class MyAdd { public : int operator()(int v1,int v2) { return v1 + v2; } }; void test01() { MyAdd myAdd; cout \u0026lt;\u0026lt; myAdd(10, 10) \u0026lt;\u0026lt; endl; } //2ã€å‡½æ•°å¯¹è±¡å¯ä»¥æœ‰è‡ªå·±çš„çŠ¶æ€ class MyPrint { public: MyPrint() { count = 0; } void operator()(string test) { cout \u0026lt;\u0026lt; test \u0026lt;\u0026lt; endl; count++; //ç»Ÿè®¡ä½¿ç”¨æ¬¡æ•° } int count; //å†…éƒ¨è‡ªå·±çš„çŠ¶æ€ }; void test02() { MyPrint myPrint; myPrint(\u0026#34;hello world\u0026#34;); myPrint(\u0026#34;hello world\u0026#34;); myPrint(\u0026#34;hello world\u0026#34;); cout \u0026lt;\u0026lt; \u0026#34;myPrintè°ƒç”¨æ¬¡æ•°ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; myPrint.count \u0026lt;\u0026lt; endl; } //3ã€å‡½æ•°å¯¹è±¡å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ void doPrint(MyPrint \u0026amp;mp , string test) { mp(test); } void test03() { MyPrint myPrint; doPrint(myPrint, \u0026#34;Hello C++\u0026#34;); } int main() { //test01(); //test02(); test03(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\nä»¿å‡½æ•°å†™æ³•éå¸¸çµæ´»ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’ã€‚ 4.2 è°“è¯ #\r4.2.1 è°“è¯æ¦‚å¿µ #\ræ¦‚å¿µï¼š\nè¿”å›boolç±»å‹çš„ä»¿å‡½æ•°ç§°ä¸ºè°“è¯ å¦‚æœoperator()æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå«åšä¸€å…ƒè°“è¯ å¦‚æœoperator()æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå«åšäºŒå…ƒè°“è¯ 4.2.2 ä¸€å…ƒè°“è¯ #\rç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; //1.ä¸€å…ƒè°“è¯ struct GreaterFive{ bool operator()(int val) { return val \u0026gt; 5; } }; void test01() { vector\u0026lt;int\u0026gt; v; for (int i = 0; i \u0026lt; 10; i++) { v.push_back(i); } vector\u0026lt;int\u0026gt;::iterator it = find_if(v.begin(), v.end(), GreaterFive()); if (it == v.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ²¡æ‰¾åˆ°!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°:\u0026#34; \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; endl; } } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå‚æ•°åªæœ‰ä¸€ä¸ªçš„è°“è¯ï¼Œç§°ä¸ºä¸€å…ƒè°“è¯\n4.2.3 äºŒå…ƒè°“è¯ #\rç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; //äºŒå…ƒè°“è¯ class MyCompare { public: bool operator()(int num1, int num2) { return num1 \u0026gt; num2; } }; void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(10); v.push_back(40); v.push_back(20); v.push_back(30); v.push_back(50); //é»˜è®¤ä»å°åˆ°å¤§ sort(v.begin(), v.end()); for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;----------------------------\u0026#34; \u0026lt;\u0026lt; endl; //ä½¿ç”¨å‡½æ•°å¯¹è±¡æ”¹å˜ç®—æ³•ç­–ç•¥ï¼Œæ’åºä»å¤§åˆ°å° sort(v.begin(), v.end(), MyCompare()); for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå‚æ•°åªæœ‰ä¸¤ä¸ªçš„è°“è¯ï¼Œç§°ä¸ºäºŒå…ƒè°“è¯\n4.3 å†…å»ºå‡½æ•°å¯¹è±¡ #\r4.3.1 å†…å»ºå‡½æ•°å¯¹è±¡æ„ä¹‰ #\ræ¦‚å¿µï¼š\nSTLå†…å»ºäº†ä¸€äº›å‡½æ•°å¯¹è±¡ åˆ†ç±»:\nç®—æœ¯ä»¿å‡½æ•°\nå…³ç³»ä»¿å‡½æ•°\né€»è¾‘ä»¿å‡½æ•°\nç”¨æ³•ï¼š\nè¿™äº›ä»¿å‡½æ•°æ‰€äº§ç”Ÿçš„å¯¹è±¡ï¼Œç”¨æ³•å’Œä¸€èˆ¬å‡½æ•°å®Œå…¨ç›¸åŒ ä½¿ç”¨å†…å»ºå‡½æ•°å¯¹è±¡ï¼Œéœ€è¦å¼•å…¥å¤´æ–‡ä»¶ #include\u0026lt;functional\u0026gt; 4.3.2 ç®—æœ¯ä»¿å‡½æ•° #\råŠŸèƒ½æè¿°ï¼š\nå®ç°å››åˆ™è¿ç®— å…¶ä¸­negateæ˜¯ä¸€å…ƒè¿ç®—ï¼Œå…¶ä»–éƒ½æ˜¯äºŒå…ƒè¿ç®— ä»¿å‡½æ•°åŸå‹ï¼š\ntemplate\u0026lt;class T\u0026gt; T plus\u0026lt;T\u0026gt; //åŠ æ³•ä»¿å‡½æ•° template\u0026lt;class T\u0026gt; T minus\u0026lt;T\u0026gt; //å‡æ³•ä»¿å‡½æ•° template\u0026lt;class T\u0026gt; T multiplies\u0026lt;T\u0026gt; //ä¹˜æ³•ä»¿å‡½æ•° template\u0026lt;class T\u0026gt; T divides\u0026lt;T\u0026gt; //é™¤æ³•ä»¿å‡½æ•° template\u0026lt;class T\u0026gt; T modulus\u0026lt;T\u0026gt; //å–æ¨¡ä»¿å‡½æ•° template\u0026lt;class T\u0026gt; T negate\u0026lt;T\u0026gt; //å–åä»¿å‡½æ•° ç¤ºä¾‹ï¼š\n#include \u0026lt;functional\u0026gt; //negate void test01() { negate\u0026lt;int\u0026gt; n; cout \u0026lt;\u0026lt; n(50) \u0026lt;\u0026lt; endl; } //plus void test02() { plus\u0026lt;int\u0026gt; p; cout \u0026lt;\u0026lt; p(10, 20) \u0026lt;\u0026lt; endl; } int main() { test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šä½¿ç”¨å†…å»ºå‡½æ•°å¯¹è±¡æ—¶ï¼Œéœ€è¦å¼•å…¥å¤´æ–‡ä»¶ #include \u0026lt;functional\u0026gt;\n4.3.3 å…³ç³»ä»¿å‡½æ•° #\råŠŸèƒ½æè¿°ï¼š\nå®ç°å…³ç³»å¯¹æ¯” ä»¿å‡½æ•°åŸå‹ï¼š\ntemplate\u0026lt;class T\u0026gt; bool equal_to\u0026lt;T\u0026gt; //ç­‰äº template\u0026lt;class T\u0026gt; bool not_equal_to\u0026lt;T\u0026gt; //ä¸ç­‰äº template\u0026lt;class T\u0026gt; bool greater\u0026lt;T\u0026gt; //å¤§äº template\u0026lt;class T\u0026gt; bool greater_equal\u0026lt;T\u0026gt; //å¤§äºç­‰äº template\u0026lt;class T\u0026gt; bool less\u0026lt;T\u0026gt; //å°äº template\u0026lt;class T\u0026gt; bool less_equal\u0026lt;T\u0026gt; //å°äºç­‰äº ç¤ºä¾‹ï¼š\n#include \u0026lt;functional\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; class MyCompare { public: bool operator()(int v1,int v2) { return v1 \u0026gt; v2; } }; void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(10); v.push_back(30); v.push_back(50); v.push_back(40); v.push_back(20); for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; //è‡ªå·±å®ç°ä»¿å‡½æ•° //sort(v.begin(), v.end(), MyCompare()); //STLå†…å»ºä»¿å‡½æ•° å¤§äºä»¿å‡½æ•° sort(v.begin(), v.end(), greater\u0026lt;int\u0026gt;()); for (vector\u0026lt;int\u0026gt;::iterator it = v.begin(); it != v.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šå…³ç³»ä»¿å‡½æ•°ä¸­æœ€å¸¸ç”¨çš„å°±æ˜¯greater\u0026lt;\u0026gt;å¤§äº\n4.3.4 é€»è¾‘ä»¿å‡½æ•° #\råŠŸèƒ½æè¿°ï¼š\nå®ç°é€»è¾‘è¿ç®— å‡½æ•°åŸå‹ï¼š\ntemplate\u0026lt;class T\u0026gt; bool logical_and\u0026lt;T\u0026gt; //é€»è¾‘ä¸ template\u0026lt;class T\u0026gt; bool logical_or\u0026lt;T\u0026gt; //é€»è¾‘æˆ– template\u0026lt;class T\u0026gt; bool logical_not\u0026lt;T\u0026gt; //é€»è¾‘é ç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;functional\u0026gt; #include \u0026lt;algorithm\u0026gt; void test01() { vector\u0026lt;bool\u0026gt; v; v.push_back(true); v.push_back(false); v.push_back(true); v.push_back(false); for (vector\u0026lt;bool\u0026gt;::iterator it = v.begin();it!= v.end();it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; //é€»è¾‘é å°†vå®¹å™¨æ¬è¿åˆ°v2ä¸­ï¼Œå¹¶æ‰§è¡Œé€»è¾‘éè¿ç®— vector\u0026lt;bool\u0026gt; v2; v2.resize(v.size()); transform(v.begin(), v.end(), v2.begin(), logical_not\u0026lt;bool\u0026gt;()); for (vector\u0026lt;bool\u0026gt;::iterator it = v2.begin(); it != v2.end(); it++) { cout \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šé€»è¾‘ä»¿å‡½æ•°å®é™…åº”ç”¨è¾ƒå°‘ï¼Œäº†è§£å³å¯\n5 STL- å¸¸ç”¨ç®—æ³• #\ræ¦‚è¿°:\nç®—æ³•ä¸»è¦æ˜¯ç”±å¤´æ–‡ä»¶\u0026lt;algorithm\u0026gt; \u0026lt;functional\u0026gt; \u0026lt;numeric\u0026gt;ç»„æˆã€‚\n\u0026lt;algorithm\u0026gt;æ˜¯æ‰€æœ‰STLå¤´æ–‡ä»¶ä¸­æœ€å¤§çš„ä¸€ä¸ªï¼ŒèŒƒå›´æ¶‰åŠåˆ°æ¯”è¾ƒã€ äº¤æ¢ã€æŸ¥æ‰¾ã€éå†æ“ä½œã€å¤åˆ¶ã€ä¿®æ”¹ç­‰ç­‰\n\u0026lt;numeric\u0026gt;ä½“ç§¯å¾ˆå°ï¼ŒåªåŒ…æ‹¬å‡ ä¸ªåœ¨åºåˆ—ä¸Šé¢è¿›è¡Œç®€å•æ•°å­¦è¿ç®—çš„æ¨¡æ¿å‡½æ•°\n\u0026lt;functional\u0026gt;å®šä¹‰äº†ä¸€äº›æ¨¡æ¿ç±»,ç”¨ä»¥å£°æ˜å‡½æ•°å¯¹è±¡ã€‚\n5.1 å¸¸ç”¨éå†ç®—æ³• #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡å¸¸ç”¨çš„éå†ç®—æ³• ç®—æ³•ç®€ä»‹ï¼š\nfor_each //éå†å®¹å™¨ transform //æ¬è¿å®¹å™¨åˆ°å¦ä¸€ä¸ªå®¹å™¨ä¸­ 5.1.1 for_each #\råŠŸèƒ½æè¿°ï¼š\nå®ç°éå†å®¹å™¨ å‡½æ•°åŸå‹ï¼š\nfor_each(iterator beg, iterator end, _func); // éå†ç®—æ³• éå†å®¹å™¨å…ƒç´ \n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// _func å‡½æ•°æˆ–è€…å‡½æ•°å¯¹è±¡\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; //æ™®é€šå‡½æ•° void print01(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } //å‡½æ•°å¯¹è±¡ class print02 { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; //for_eachç®—æ³•åŸºæœ¬ç”¨æ³• void test01() { vector\u0026lt;int\u0026gt; v; for (int i = 0; i \u0026lt; 10; i++) { v.push_back(i); } //éå†ç®—æ³• for_each(v.begin(), v.end(), print01); cout \u0026lt;\u0026lt; endl; for_each(v.begin(), v.end(), print02()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**for_eachåœ¨å®é™…å¼€å‘ä¸­æ˜¯æœ€å¸¸ç”¨éå†ç®—æ³•ï¼Œéœ€è¦ç†Ÿç»ƒæŒæ¡\n5.1.2 transform #\råŠŸèƒ½æè¿°ï¼š\næ¬è¿å®¹å™¨åˆ°å¦ä¸€ä¸ªå®¹å™¨ä¸­ å‡½æ•°åŸå‹ï¼š\ntransform(iterator beg1, iterator end1, iterator beg2, _func); //beg1 æºå®¹å™¨å¼€å§‹è¿­ä»£å™¨\n//end1 æºå®¹å™¨ç»“æŸè¿­ä»£å™¨\n//beg2 ç›®æ ‡å®¹å™¨å¼€å§‹è¿­ä»£å™¨\n//_func å‡½æ•°æˆ–è€…å‡½æ•°å¯¹è±¡\nç¤ºä¾‹ï¼š\n#include\u0026lt;vector\u0026gt; #include\u0026lt;algorithm\u0026gt; //å¸¸ç”¨éå†ç®—æ³• æ¬è¿ transform class TransForm { public: int operator()(int val) { return val; } }; class MyPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt;v; for (int i = 0; i \u0026lt; 10; i++) { v.push_back(i); } vector\u0026lt;int\u0026gt;vTarget; //ç›®æ ‡å®¹å™¨ vTarget.resize(v.size()); // ç›®æ ‡å®¹å™¨éœ€è¦æå‰å¼€è¾Ÿç©ºé—´ transform(v.begin(), v.end(), vTarget.begin(), TransForm()); for_each(vTarget.begin(), vTarget.end(), MyPrint()); } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š æ¬è¿çš„ç›®æ ‡å®¹å™¨å¿…é¡»è¦æå‰å¼€è¾Ÿç©ºé—´ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸æ¬è¿\n5.2 å¸¸ç”¨æŸ¥æ‰¾ç®—æ³• #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡å¸¸ç”¨çš„æŸ¥æ‰¾ç®—æ³• ç®—æ³•ç®€ä»‹ï¼š\nfind //æŸ¥æ‰¾å…ƒç´  find_if //æŒ‰æ¡ä»¶æŸ¥æ‰¾å…ƒç´  adjacent_find //æŸ¥æ‰¾ç›¸é‚»é‡å¤å…ƒç´  binary_search //äºŒåˆ†æŸ¥æ‰¾æ³• count //ç»Ÿè®¡å…ƒç´ ä¸ªæ•° count_if //æŒ‰æ¡ä»¶ç»Ÿè®¡å…ƒç´ ä¸ªæ•° 5.2.1 find #\råŠŸèƒ½æè¿°ï¼š\næŸ¥æ‰¾æŒ‡å®šå…ƒç´ ï¼Œæ‰¾åˆ°è¿”å›æŒ‡å®šå…ƒç´ çš„è¿­ä»£å™¨ï¼Œæ‰¾ä¸åˆ°è¿”å›ç»“æŸè¿­ä»£å™¨end() å‡½æ•°åŸå‹ï¼š\nfind(iterator beg, iterator end, value); // æŒ‰å€¼æŸ¥æ‰¾å…ƒç´ ï¼Œæ‰¾åˆ°è¿”å›æŒ‡å®šä½ç½®è¿­ä»£å™¨ï¼Œæ‰¾ä¸åˆ°è¿”å›ç»“æŸè¿­ä»£å™¨ä½ç½®\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// value æŸ¥æ‰¾çš„å…ƒç´ \nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;string\u0026gt; void test01() { vector\u0026lt;int\u0026gt; v; for (int i = 0; i \u0026lt; 10; i++) { v.push_back(i + 1); } //æŸ¥æ‰¾å®¹å™¨ä¸­æ˜¯å¦æœ‰ 5 è¿™ä¸ªå…ƒç´  vector\u0026lt;int\u0026gt;::iterator it = find(v.begin(), v.end(), 5); if (it == v.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ²¡æœ‰æ‰¾åˆ°!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°:\u0026#34; \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; endl; } } class Person { public: Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } //é‡è½½== bool operator==(const Person\u0026amp; p) { if (this-\u0026gt;m_Name == p.m_Name \u0026amp;\u0026amp; this-\u0026gt;m_Age == p.m_Age) { return true; } return false; } public: string m_Name; int m_Age; }; void test02() { vector\u0026lt;Person\u0026gt; v; //åˆ›å»ºæ•°æ® Person p1(\u0026#34;aaa\u0026#34;, 10); Person p2(\u0026#34;bbb\u0026#34;, 20); Person p3(\u0026#34;ccc\u0026#34;, 30); Person p4(\u0026#34;ddd\u0026#34;, 40); v.push_back(p1); v.push_back(p2); v.push_back(p3); v.push_back(p4); vector\u0026lt;Person\u0026gt;::iterator it = find(v.begin(), v.end(), p2); if (it == v.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ²¡æœ‰æ‰¾åˆ°!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°å§“å:\u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„: \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Age \u0026lt;\u0026lt; endl; } } æ€»ç»“ï¼š åˆ©ç”¨findå¯ä»¥åœ¨å®¹å™¨ä¸­æ‰¾æŒ‡å®šçš„å…ƒç´ ï¼Œè¿”å›å€¼æ˜¯è¿­ä»£å™¨\n5.2.2 find_if #\råŠŸèƒ½æè¿°ï¼š\næŒ‰æ¡ä»¶æŸ¥æ‰¾å…ƒç´  å‡½æ•°åŸå‹ï¼š\nfind_if(iterator beg, iterator end, _Pred); // æŒ‰å€¼æŸ¥æ‰¾å…ƒç´ ï¼Œæ‰¾åˆ°è¿”å›æŒ‡å®šä½ç½®è¿­ä»£å™¨ï¼Œæ‰¾ä¸åˆ°è¿”å›ç»“æŸè¿­ä»£å™¨ä½ç½®\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// _Pred å‡½æ•°æˆ–è€…è°“è¯ï¼ˆè¿”å›boolç±»å‹çš„ä»¿å‡½æ•°ï¼‰\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;string\u0026gt; //å†…ç½®æ•°æ®ç±»å‹ class GreaterFive { public: bool operator()(int val) { return val \u0026gt; 5; } }; void test01() { vector\u0026lt;int\u0026gt; v; for (int i = 0; i \u0026lt; 10; i++) { v.push_back(i + 1); } vector\u0026lt;int\u0026gt;::iterator it = find_if(v.begin(), v.end(), GreaterFive()); if (it == v.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ²¡æœ‰æ‰¾åˆ°!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°å¤§äº5çš„æ•°å­—:\u0026#34; \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; endl; } } //è‡ªå®šä¹‰æ•°æ®ç±»å‹ class Person { public: Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } public: string m_Name; int m_Age; }; class Greater20 { public: bool operator()(Person \u0026amp;p) { return p.m_Age \u0026gt; 20; } }; void test02() { vector\u0026lt;Person\u0026gt; v; //åˆ›å»ºæ•°æ® Person p1(\u0026#34;aaa\u0026#34;, 10); Person p2(\u0026#34;bbb\u0026#34;, 20); Person p3(\u0026#34;ccc\u0026#34;, 30); Person p4(\u0026#34;ddd\u0026#34;, 40); v.push_back(p1); v.push_back(p2); v.push_back(p3); v.push_back(p4); vector\u0026lt;Person\u0026gt;::iterator it = find_if(v.begin(), v.end(), Greater20()); if (it == v.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ²¡æœ‰æ‰¾åˆ°!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°å§“å:\u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Name \u0026lt;\u0026lt; \u0026#34; å¹´é¾„: \u0026#34; \u0026lt;\u0026lt; it-\u0026gt;m_Age \u0026lt;\u0026lt; endl; } } int main() { //test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼šfind_ifæŒ‰æ¡ä»¶æŸ¥æ‰¾ä½¿æŸ¥æ‰¾æ›´åŠ çµæ´»ï¼Œæä¾›çš„ä»¿å‡½æ•°å¯ä»¥æ”¹å˜ä¸åŒçš„ç­–ç•¥\n5.2.3 adjacent_find #\råŠŸèƒ½æè¿°ï¼š\næŸ¥æ‰¾ç›¸é‚»é‡å¤å…ƒç´  å‡½æ•°åŸå‹ï¼š\nadjacent_find(iterator beg, iterator end); // æŸ¥æ‰¾ç›¸é‚»é‡å¤å…ƒç´ ,è¿”å›ç›¸é‚»å…ƒç´ çš„ç¬¬ä¸€ä¸ªä½ç½®çš„è¿­ä»£å™¨\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(1); v.push_back(2); v.push_back(5); v.push_back(2); v.push_back(4); v.push_back(4); v.push_back(3); //æŸ¥æ‰¾ç›¸é‚»é‡å¤å…ƒç´  vector\u0026lt;int\u0026gt;::iterator it = adjacent_find(v.begin(), v.end()); if (it == v.end()) { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾ä¸åˆ°!\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°ç›¸é‚»é‡å¤å…ƒç´ ä¸º:\u0026#34; \u0026lt;\u0026lt; *it \u0026lt;\u0026lt; endl; } } æ€»ç»“ï¼šé¢è¯•é¢˜ä¸­å¦‚æœå‡ºç°æŸ¥æ‰¾ç›¸é‚»é‡å¤å…ƒç´ ï¼Œè®°å¾—ç”¨STLä¸­çš„adjacent_findç®—æ³•\n5.2.4 binary_search #\råŠŸèƒ½æè¿°ï¼š\næŸ¥æ‰¾æŒ‡å®šå…ƒç´ æ˜¯å¦å­˜åœ¨ å‡½æ•°åŸå‹ï¼š\nbool binary_search(iterator beg, iterator end, value); // æŸ¥æ‰¾æŒ‡å®šçš„å…ƒç´ ï¼ŒæŸ¥åˆ° è¿”å›true å¦åˆ™false\n// æ³¨æ„: åœ¨æ— åºåºåˆ—ä¸­ä¸å¯ç”¨\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// value æŸ¥æ‰¾çš„å…ƒç´ \nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; void test01() { vector\u0026lt;int\u0026gt;v; for (int i = 0; i \u0026lt; 10; i++) { v.push_back(i); } //äºŒåˆ†æŸ¥æ‰¾ bool ret = binary_search(v.begin(), v.end(),2); if (ret) { cout \u0026lt;\u0026lt; \u0026#34;æ‰¾åˆ°äº†\u0026#34; \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; \u0026#34;æœªæ‰¾åˆ°\u0026#34; \u0026lt;\u0026lt; endl; } } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**äºŒåˆ†æŸ¥æ‰¾æ³•æŸ¥æ‰¾æ•ˆç‡å¾ˆé«˜ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯æŸ¥æ‰¾çš„å®¹å™¨ä¸­å…ƒç´ å¿…é¡»çš„æœ‰åºåºåˆ—\n5.2.5 count #\råŠŸèƒ½æè¿°ï¼š\nç»Ÿè®¡å…ƒç´ ä¸ªæ•° å‡½æ•°åŸå‹ï¼š\ncount(iterator beg, iterator end, value); // ç»Ÿè®¡å…ƒç´ å‡ºç°æ¬¡æ•°\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// value ç»Ÿè®¡çš„å…ƒç´ \nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; //å†…ç½®æ•°æ®ç±»å‹ void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(1); v.push_back(2); v.push_back(4); v.push_back(5); v.push_back(3); v.push_back(4); v.push_back(4); int num = count(v.begin(), v.end(), 4); cout \u0026lt;\u0026lt; \u0026#34;4çš„ä¸ªæ•°ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; num \u0026lt;\u0026lt; endl; } //è‡ªå®šä¹‰æ•°æ®ç±»å‹ class Person { public: Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } bool operator==(const Person \u0026amp; p) { if (this-\u0026gt;m_Age == p.m_Age) { return true; } else { return false; } } string m_Name; int m_Age; }; void test02() { vector\u0026lt;Person\u0026gt; v; Person p1(\u0026#34;åˆ˜å¤‡\u0026#34;, 35); Person p2(\u0026#34;å…³ç¾½\u0026#34;, 35); Person p3(\u0026#34;å¼ é£\u0026#34;, 35); Person p4(\u0026#34;èµµäº‘\u0026#34;, 30); Person p5(\u0026#34;æ›¹æ“\u0026#34;, 25); v.push_back(p1); v.push_back(p2); v.push_back(p3); v.push_back(p4); v.push_back(p5); Person p(\u0026#34;è¯¸è‘›äº®\u0026#34;,35); int num = count(v.begin(), v.end(), p); cout \u0026lt;\u0026lt; \u0026#34;num = \u0026#34; \u0026lt;\u0026lt; num \u0026lt;\u0026lt; endl; } int main() { //test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š ç»Ÿè®¡è‡ªå®šä¹‰æ•°æ®ç±»å‹æ—¶å€™ï¼Œéœ€è¦é…åˆé‡è½½ operator==\n5.2.6 count_if #\råŠŸèƒ½æè¿°ï¼š\næŒ‰æ¡ä»¶ç»Ÿè®¡å…ƒç´ ä¸ªæ•° å‡½æ•°åŸå‹ï¼š\ncount_if(iterator beg, iterator end, _Pred); // æŒ‰æ¡ä»¶ç»Ÿè®¡å…ƒç´ å‡ºç°æ¬¡æ•°\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// _Pred è°“è¯\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; class Greater4 { public: bool operator()(int val) { return val \u0026gt;= 4; } }; //å†…ç½®æ•°æ®ç±»å‹ void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(1); v.push_back(2); v.push_back(4); v.push_back(5); v.push_back(3); v.push_back(4); v.push_back(4); int num = count_if(v.begin(), v.end(), Greater4()); cout \u0026lt;\u0026lt; \u0026#34;å¤§äº4çš„ä¸ªæ•°ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; num \u0026lt;\u0026lt; endl; } //è‡ªå®šä¹‰æ•°æ®ç±»å‹ class Person { public: Person(string name, int age) { this-\u0026gt;m_Name = name; this-\u0026gt;m_Age = age; } string m_Name; int m_Age; }; class AgeLess35 { public: bool operator()(const Person \u0026amp;p) { return p.m_Age \u0026lt; 35; } }; void test02() { vector\u0026lt;Person\u0026gt; v; Person p1(\u0026#34;åˆ˜å¤‡\u0026#34;, 35); Person p2(\u0026#34;å…³ç¾½\u0026#34;, 35); Person p3(\u0026#34;å¼ é£\u0026#34;, 35); Person p4(\u0026#34;èµµäº‘\u0026#34;, 30); Person p5(\u0026#34;æ›¹æ“\u0026#34;, 25); v.push_back(p1); v.push_back(p2); v.push_back(p3); v.push_back(p4); v.push_back(p5); int num = count_if(v.begin(), v.end(), AgeLess35()); cout \u0026lt;\u0026lt; \u0026#34;å°äº35å²çš„ä¸ªæ•°ï¼š\u0026#34; \u0026lt;\u0026lt; num \u0026lt;\u0026lt; endl; } int main() { //test01(); test02(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**æŒ‰å€¼ç»Ÿè®¡ç”¨countï¼ŒæŒ‰æ¡ä»¶ç»Ÿè®¡ç”¨count_if\n5.3 å¸¸ç”¨æ’åºç®—æ³• #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡å¸¸ç”¨çš„æ’åºç®—æ³• ç®—æ³•ç®€ä»‹ï¼š\nsort //å¯¹å®¹å™¨å†…å…ƒç´ è¿›è¡Œæ’åº random_shuffle //æ´—ç‰Œ æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ éšæœºè°ƒæ•´æ¬¡åº merge // å®¹å™¨å…ƒç´ åˆå¹¶ï¼Œå¹¶å­˜å‚¨åˆ°å¦ä¸€å®¹å™¨ä¸­ reverse // åè½¬æŒ‡å®šèŒƒå›´çš„å…ƒç´  5.3.1 sort #\råŠŸèƒ½æè¿°ï¼š\nå¯¹å®¹å™¨å†…å…ƒç´ è¿›è¡Œæ’åº å‡½æ•°åŸå‹ï¼š\nsort(iterator beg, iterator end, _Pred); // æŒ‰å€¼æŸ¥æ‰¾å…ƒç´ ï¼Œæ‰¾åˆ°è¿”å›æŒ‡å®šä½ç½®è¿­ä»£å™¨ï¼Œæ‰¾ä¸åˆ°è¿”å›ç»“æŸè¿­ä»£å™¨ä½ç½®\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// _Pred è°“è¯\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; void myPrint(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(10); v.push_back(30); v.push_back(50); v.push_back(20); v.push_back(40); //sorté»˜è®¤ä»å°åˆ°å¤§æ’åº sort(v.begin(), v.end()); for_each(v.begin(), v.end(), myPrint); cout \u0026lt;\u0026lt; endl; //ä»å¤§åˆ°å°æ’åº sort(v.begin(), v.end(), greater\u0026lt;int\u0026gt;()); for_each(v.begin(), v.end(), myPrint); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**sortå±äºå¼€å‘ä¸­æœ€å¸¸ç”¨çš„ç®—æ³•ä¹‹ä¸€ï¼Œéœ€ç†Ÿç»ƒæŒæ¡\n5.3.2 random_shuffle #\råŠŸèƒ½æè¿°ï¼š\næ´—ç‰Œ æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ éšæœºè°ƒæ•´æ¬¡åº å‡½æ•°åŸå‹ï¼š\nrandom_shuffle(iterator beg, iterator end); // æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ éšæœºè°ƒæ•´æ¬¡åº\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;ctime\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { srand((unsigned int)time(NULL)); vector\u0026lt;int\u0026gt; v; for(int i = 0 ; i \u0026lt; 10;i++) { v.push_back(i); } for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; //æ‰“ä¹±é¡ºåº random_shuffle(v.begin(), v.end()); for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**random_shuffleæ´—ç‰Œç®—æ³•æ¯”è¾ƒå®ç”¨ï¼Œä½¿ç”¨æ—¶è®°å¾—åŠ éšæœºæ•°ç§å­\n5.3.3 merge #\råŠŸèƒ½æè¿°ï¼š\nä¸¤ä¸ªå®¹å™¨å…ƒç´ åˆå¹¶ï¼Œå¹¶å­˜å‚¨åˆ°å¦ä¸€å®¹å™¨ä¸­ å‡½æ•°åŸå‹ï¼š\nmerge(iterator beg1, iterator end1, iterator beg2, iterator end2, iterator dest); // å®¹å™¨å…ƒç´ åˆå¹¶ï¼Œå¹¶å­˜å‚¨åˆ°å¦ä¸€å®¹å™¨ä¸­\n// æ³¨æ„: ä¸¤ä¸ªå®¹å™¨å¿…é¡»æ˜¯æœ‰åºçš„\n// beg1 å®¹å™¨1å¼€å§‹è¿­ä»£å™¨ // end1 å®¹å™¨1ç»“æŸè¿­ä»£å™¨ // beg2 å®¹å™¨2å¼€å§‹è¿­ä»£å™¨ // end2 å®¹å™¨2ç»“æŸè¿­ä»£å™¨ // dest ç›®æ ‡å®¹å™¨å¼€å§‹è¿­ä»£å™¨\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v1; vector\u0026lt;int\u0026gt; v2; for (int i = 0; i \u0026lt; 10 ; i++) { v1.push_back(i); v2.push_back(i + 1); } vector\u0026lt;int\u0026gt; vtarget; //ç›®æ ‡å®¹å™¨éœ€è¦æå‰å¼€è¾Ÿç©ºé—´ vtarget.resize(v1.size() + v2.size()); //åˆå¹¶ éœ€è¦ä¸¤ä¸ªæœ‰åºåºåˆ— merge(v1.begin(), v1.end(), v2.begin(), v2.end(), vtarget.begin()); for_each(vtarget.begin(), vtarget.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**mergeåˆå¹¶çš„ä¸¤ä¸ªå®¹å™¨å¿…é¡»çš„æœ‰åºåºåˆ—\n5.3.4 reverse #\råŠŸèƒ½æè¿°ï¼š\nå°†å®¹å™¨å†…å…ƒç´ è¿›è¡Œåè½¬ å‡½æ•°åŸå‹ï¼š\nreverse(iterator beg, iterator end); // åè½¬æŒ‡å®šèŒƒå›´çš„å…ƒç´ \n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(10); v.push_back(30); v.push_back(50); v.push_back(20); v.push_back(40); cout \u0026lt;\u0026lt; \u0026#34;åè½¬å‰ï¼š \u0026#34; \u0026lt;\u0026lt; endl; for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;åè½¬åï¼š \u0026#34; \u0026lt;\u0026lt; endl; reverse(v.begin(), v.end()); for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**reverseåè½¬åŒºé—´å†…å…ƒç´ ï¼Œé¢è¯•é¢˜å¯èƒ½æ¶‰åŠåˆ°\n5.4 å¸¸ç”¨æ‹·è´å’Œæ›¿æ¢ç®—æ³• #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡å¸¸ç”¨çš„æ‹·è´å’Œæ›¿æ¢ç®—æ³• ç®—æ³•ç®€ä»‹ï¼š\ncopy // å®¹å™¨å†…æŒ‡å®šèŒƒå›´çš„å…ƒç´ æ‹·è´åˆ°å¦ä¸€å®¹å™¨ä¸­ replace // å°†å®¹å™¨å†…æŒ‡å®šèŒƒå›´çš„æ—§å…ƒç´ ä¿®æ”¹ä¸ºæ–°å…ƒç´  replace_if // å®¹å™¨å†…æŒ‡å®šèŒƒå›´æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ›¿æ¢ä¸ºæ–°å…ƒç´  swap // äº’æ¢ä¸¤ä¸ªå®¹å™¨çš„å…ƒç´  5.4.1 copy #\råŠŸèƒ½æè¿°ï¼š\nå®¹å™¨å†…æŒ‡å®šèŒƒå›´çš„å…ƒç´ æ‹·è´åˆ°å¦ä¸€å®¹å™¨ä¸­ å‡½æ•°åŸå‹ï¼š\ncopy(iterator beg, iterator end, iterator dest); // æŒ‰å€¼æŸ¥æ‰¾å…ƒç´ ï¼Œæ‰¾åˆ°è¿”å›æŒ‡å®šä½ç½®è¿­ä»£å™¨ï¼Œæ‰¾ä¸åˆ°è¿”å›ç»“æŸè¿­ä»£å™¨ä½ç½®\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// dest ç›®æ ‡èµ·å§‹è¿­ä»£å™¨\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v1; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i + 1); } vector\u0026lt;int\u0026gt; v2; v2.resize(v1.size()); copy(v1.begin(), v1.end(), v2.begin()); for_each(v2.begin(), v2.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**åˆ©ç”¨copyç®—æ³•åœ¨æ‹·è´æ—¶ï¼Œç›®æ ‡å®¹å™¨è®°å¾—æå‰å¼€è¾Ÿç©ºé—´\n5.4.2 replace #\råŠŸèƒ½æè¿°ï¼š\nå°†å®¹å™¨å†…æŒ‡å®šèŒƒå›´çš„æ—§å…ƒç´ ä¿®æ”¹ä¸ºæ–°å…ƒç´  å‡½æ•°åŸå‹ï¼š\nreplace(iterator beg, iterator end, oldvalue, newvalue); // å°†åŒºé—´å†…æ—§å…ƒç´  æ›¿æ¢æˆ æ–°å…ƒç´ \n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// oldvalue æ—§å…ƒç´ \n// newvalue æ–°å…ƒç´ \nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(20); v.push_back(30); v.push_back(20); v.push_back(40); v.push_back(50); v.push_back(10); v.push_back(20); cout \u0026lt;\u0026lt; \u0026#34;æ›¿æ¢å‰ï¼š\u0026#34; \u0026lt;\u0026lt; endl; for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; //å°†å®¹å™¨ä¸­çš„20 æ›¿æ¢æˆ 2000 cout \u0026lt;\u0026lt; \u0026#34;æ›¿æ¢åï¼š\u0026#34; \u0026lt;\u0026lt; endl; replace(v.begin(), v.end(), 20,2000); for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**replaceä¼šæ›¿æ¢åŒºé—´å†…æ»¡è¶³æ¡ä»¶çš„å…ƒç´ \n5.4.3 replace_if #\råŠŸèƒ½æè¿°:\nå°†åŒºé—´å†…æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œæ›¿æ¢æˆæŒ‡å®šå…ƒç´  å‡½æ•°åŸå‹ï¼š\nreplace_if(iterator beg, iterator end, _pred, newvalue); // æŒ‰æ¡ä»¶æ›¿æ¢å…ƒç´ ï¼Œæ»¡è¶³æ¡ä»¶çš„æ›¿æ¢æˆæŒ‡å®šå…ƒç´ \n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// _pred è°“è¯\n// newvalue æ›¿æ¢çš„æ–°å…ƒç´ \nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; class ReplaceGreater30 { public: bool operator()(int val) { return val \u0026gt;= 30; } }; void test01() { vector\u0026lt;int\u0026gt; v; v.push_back(20); v.push_back(30); v.push_back(20); v.push_back(40); v.push_back(50); v.push_back(10); v.push_back(20); cout \u0026lt;\u0026lt; \u0026#34;æ›¿æ¢å‰ï¼š\u0026#34; \u0026lt;\u0026lt; endl; for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; //å°†å®¹å™¨ä¸­å¤§äºç­‰äºçš„30 æ›¿æ¢æˆ 3000 cout \u0026lt;\u0026lt; \u0026#34;æ›¿æ¢åï¼š\u0026#34; \u0026lt;\u0026lt; endl; replace_if(v.begin(), v.end(), ReplaceGreater30(), 3000); for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**replace_ifæŒ‰æ¡ä»¶æŸ¥æ‰¾ï¼Œå¯ä»¥åˆ©ç”¨ä»¿å‡½æ•°çµæ´»ç­›é€‰æ»¡è¶³çš„æ¡ä»¶\n5.4.4 swap #\råŠŸèƒ½æè¿°ï¼š\näº’æ¢ä¸¤ä¸ªå®¹å™¨çš„å…ƒç´  å‡½æ•°åŸå‹ï¼š\nswap(container c1, container c2); // äº’æ¢ä¸¤ä¸ªå®¹å™¨çš„å…ƒç´ \n// c1å®¹å™¨1\n// c2å®¹å™¨2\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v1; vector\u0026lt;int\u0026gt; v2; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); v2.push_back(i+100); } cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢å‰ï¼š \u0026#34; \u0026lt;\u0026lt; endl; for_each(v1.begin(), v1.end(), myPrint()); cout \u0026lt;\u0026lt; endl; for_each(v2.begin(), v2.end(), myPrint()); cout \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;äº¤æ¢åï¼š \u0026#34; \u0026lt;\u0026lt; endl; swap(v1, v2); for_each(v1.begin(), v1.end(), myPrint()); cout \u0026lt;\u0026lt; endl; for_each(v2.begin(), v2.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**swapäº¤æ¢å®¹å™¨æ—¶ï¼Œæ³¨æ„äº¤æ¢çš„å®¹å™¨è¦åŒç§ç±»å‹\n5.5 å¸¸ç”¨ç®—æœ¯ç”Ÿæˆç®—æ³• #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡å¸¸ç”¨çš„ç®—æœ¯ç”Ÿæˆç®—æ³• æ³¨æ„ï¼š\nç®—æœ¯ç”Ÿæˆç®—æ³•å±äºå°å‹ç®—æ³•ï¼Œä½¿ç”¨æ—¶åŒ…å«çš„å¤´æ–‡ä»¶ä¸º #include \u0026lt;numeric\u0026gt; ç®—æ³•ç®€ä»‹ï¼š\naccumulate // è®¡ç®—å®¹å™¨å…ƒç´ ç´¯è®¡æ€»å’Œ\nfill // å‘å®¹å™¨ä¸­æ·»åŠ å…ƒç´ \nâ€‹\n5.5.1 accumulate #\råŠŸèƒ½æè¿°ï¼š\nè®¡ç®—åŒºé—´å†… å®¹å™¨å…ƒç´ ç´¯è®¡æ€»å’Œ å‡½æ•°åŸå‹ï¼š\naccumulate(iterator beg, iterator end, value); // è®¡ç®—å®¹å™¨å…ƒç´ ç´¯è®¡æ€»å’Œ\n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// value èµ·å§‹å€¼\nç¤ºä¾‹ï¼š\n#include \u0026lt;numeric\u0026gt; #include \u0026lt;vector\u0026gt; void test01() { vector\u0026lt;int\u0026gt; v; for (int i = 0; i \u0026lt;= 100; i++) { v.push_back(i); } int total = accumulate(v.begin(), v.end(), 0); cout \u0026lt;\u0026lt; \u0026#34;total = \u0026#34; \u0026lt;\u0026lt; total \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**accumulateä½¿ç”¨æ—¶å¤´æ–‡ä»¶æ³¨æ„æ˜¯ numericï¼Œè¿™ä¸ªç®—æ³•å¾ˆå®ç”¨\n5.5.2 fill #\råŠŸèƒ½æè¿°ï¼š\nå‘å®¹å™¨ä¸­å¡«å……æŒ‡å®šçš„å…ƒç´  å‡½æ•°åŸå‹ï¼š\nfill(iterator beg, iterator end, value); // å‘å®¹å™¨ä¸­å¡«å……å…ƒç´ \n// beg å¼€å§‹è¿­ä»£å™¨\n// end ç»“æŸè¿­ä»£å™¨\n// value å¡«å……çš„å€¼\nç¤ºä¾‹ï¼š\n#include \u0026lt;numeric\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v; v.resize(10); //å¡«å…… fill(v.begin(), v.end(), 100); for_each(v.begin(), v.end(), myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } **æ€»ç»“ï¼š**åˆ©ç”¨fillå¯ä»¥å°†å®¹å™¨åŒºé—´å†…å…ƒç´ å¡«å……ä¸º æŒ‡å®šçš„å€¼\n5.6 å¸¸ç”¨é›†åˆç®—æ³• #\rå­¦ä¹ ç›®æ ‡ï¼š\næŒæ¡å¸¸ç”¨çš„é›†åˆç®—æ³• ç®—æ³•ç®€ä»‹ï¼š\nset_intersection // æ±‚ä¸¤ä¸ªå®¹å™¨çš„äº¤é›†\nset_union // æ±‚ä¸¤ä¸ªå®¹å™¨çš„å¹¶é›†\nset_difference // æ±‚ä¸¤ä¸ªå®¹å™¨çš„å·®é›†\nâ€‹\n5.6.1 set_intersection #\råŠŸèƒ½æè¿°ï¼š\næ±‚ä¸¤ä¸ªå®¹å™¨çš„äº¤é›† å‡½æ•°åŸå‹ï¼š\nset_intersection(iterator beg1, iterator end1, iterator beg2, iterator end2, iterator dest); // æ±‚ä¸¤ä¸ªé›†åˆçš„äº¤é›†\n// æ³¨æ„:ä¸¤ä¸ªé›†åˆå¿…é¡»æ˜¯æœ‰åºåºåˆ—\n// beg1 å®¹å™¨1å¼€å§‹è¿­ä»£å™¨ // end1 å®¹å™¨1ç»“æŸè¿­ä»£å™¨ // beg2 å®¹å™¨2å¼€å§‹è¿­ä»£å™¨ // end2 å®¹å™¨2ç»“æŸè¿­ä»£å™¨ // dest ç›®æ ‡å®¹å™¨å¼€å§‹è¿­ä»£å™¨\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v1; vector\u0026lt;int\u0026gt; v2; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); v2.push_back(i+5); } vector\u0026lt;int\u0026gt; vTarget; //å–ä¸¤ä¸ªé‡Œé¢è¾ƒå°çš„å€¼ç»™ç›®æ ‡å®¹å™¨å¼€è¾Ÿç©ºé—´ vTarget.resize(min(v1.size(), v2.size())); //è¿”å›ç›®æ ‡å®¹å™¨çš„æœ€åä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨åœ°å€ vector\u0026lt;int\u0026gt;::iterator itEnd = set_intersection(v1.begin(), v1.end(), v2.begin(), v2.end(), vTarget.begin()); for_each(vTarget.begin(), itEnd, myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\næ±‚äº¤é›†çš„ä¸¤ä¸ªé›†åˆå¿…é¡»çš„æœ‰åºåºåˆ— ç›®æ ‡å®¹å™¨å¼€è¾Ÿç©ºé—´éœ€è¦ä»ä¸¤ä¸ªå®¹å™¨ä¸­å–å°å€¼ set_intersectionè¿”å›å€¼æ—¢æ˜¯äº¤é›†ä¸­æœ€åä¸€ä¸ªå…ƒç´ çš„ä½ç½® 5.6.2 set_union #\råŠŸèƒ½æè¿°ï¼š\næ±‚ä¸¤ä¸ªé›†åˆçš„å¹¶é›† å‡½æ•°åŸå‹ï¼š\nset_union(iterator beg1, iterator end1, iterator beg2, iterator end2, iterator dest); // æ±‚ä¸¤ä¸ªé›†åˆçš„å¹¶é›†\n// æ³¨æ„:ä¸¤ä¸ªé›†åˆå¿…é¡»æ˜¯æœ‰åºåºåˆ—\n// beg1 å®¹å™¨1å¼€å§‹è¿­ä»£å™¨ // end1 å®¹å™¨1ç»“æŸè¿­ä»£å™¨ // beg2 å®¹å™¨2å¼€å§‹è¿­ä»£å™¨ // end2 å®¹å™¨2ç»“æŸè¿­ä»£å™¨ // dest ç›®æ ‡å®¹å™¨å¼€å§‹è¿­ä»£å™¨\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v1; vector\u0026lt;int\u0026gt; v2; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); v2.push_back(i+5); } vector\u0026lt;int\u0026gt; vTarget; //å–ä¸¤ä¸ªå®¹å™¨çš„å’Œç»™ç›®æ ‡å®¹å™¨å¼€è¾Ÿç©ºé—´ vTarget.resize(v1.size() + v2.size()); //è¿”å›ç›®æ ‡å®¹å™¨çš„æœ€åä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨åœ°å€ vector\u0026lt;int\u0026gt;::iterator itEnd = set_union(v1.begin(), v1.end(), v2.begin(), v2.end(), vTarget.begin()); for_each(vTarget.begin(), itEnd, myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\næ±‚å¹¶é›†çš„ä¸¤ä¸ªé›†åˆå¿…é¡»çš„æœ‰åºåºåˆ— ç›®æ ‡å®¹å™¨å¼€è¾Ÿç©ºé—´éœ€è¦ä¸¤ä¸ªå®¹å™¨ç›¸åŠ  set_unionè¿”å›å€¼æ—¢æ˜¯å¹¶é›†ä¸­æœ€åä¸€ä¸ªå…ƒç´ çš„ä½ç½® 5.6.3 set_difference #\råŠŸèƒ½æè¿°ï¼š\næ±‚ä¸¤ä¸ªé›†åˆçš„å·®é›† å‡½æ•°åŸå‹ï¼š\nset_difference(iterator beg1, iterator end1, iterator beg2, iterator end2, iterator dest); // æ±‚ä¸¤ä¸ªé›†åˆçš„å·®é›†\n// æ³¨æ„:ä¸¤ä¸ªé›†åˆå¿…é¡»æ˜¯æœ‰åºåºåˆ—\n// beg1 å®¹å™¨1å¼€å§‹è¿­ä»£å™¨ // end1 å®¹å™¨1ç»“æŸè¿­ä»£å™¨ // beg2 å®¹å™¨2å¼€å§‹è¿­ä»£å™¨ // end2 å®¹å™¨2ç»“æŸè¿­ä»£å™¨ // dest ç›®æ ‡å®¹å™¨å¼€å§‹è¿­ä»£å™¨\nâ€‹\nç¤ºä¾‹ï¼š\n#include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; class myPrint { public: void operator()(int val) { cout \u0026lt;\u0026lt; val \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } }; void test01() { vector\u0026lt;int\u0026gt; v1; vector\u0026lt;int\u0026gt; v2; for (int i = 0; i \u0026lt; 10; i++) { v1.push_back(i); v2.push_back(i+5); } vector\u0026lt;int\u0026gt; vTarget; //å–ä¸¤ä¸ªé‡Œé¢è¾ƒå¤§çš„å€¼ç»™ç›®æ ‡å®¹å™¨å¼€è¾Ÿç©ºé—´ vTarget.resize( max(v1.size() , v2.size())); //è¿”å›ç›®æ ‡å®¹å™¨çš„æœ€åä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨åœ°å€ cout \u0026lt;\u0026lt; \u0026#34;v1ä¸v2çš„å·®é›†ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; endl; vector\u0026lt;int\u0026gt;::iterator itEnd = set_difference(v1.begin(), v1.end(), v2.begin(), v2.end(), vTarget.begin()); for_each(vTarget.begin(), itEnd, myPrint()); cout \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;v2ä¸v1çš„å·®é›†ä¸ºï¼š \u0026#34; \u0026lt;\u0026lt; endl; itEnd = set_difference(v2.begin(), v2.end(), v1.begin(), v1.end(), vTarget.begin()); for_each(vTarget.begin(), itEnd, myPrint()); cout \u0026lt;\u0026lt; endl; } int main() { test01(); system(\u0026#34;pause\u0026#34;); return 0; } æ€»ç»“ï¼š\næ±‚å·®é›†çš„ä¸¤ä¸ªé›†åˆå¿…é¡»çš„æœ‰åºåºåˆ— ç›®æ ‡å®¹å™¨å¼€è¾Ÿç©ºé—´éœ€è¦ä»ä¸¤ä¸ªå®¹å™¨å–è¾ƒå¤§å€¼ set_differenceè¿”å›å€¼æ—¢æ˜¯å·®é›†ä¸­æœ€åä¸€ä¸ªå…ƒç´ çš„ä½ç½® ","date":"1 January 0001","externalUrl":null,"permalink":"/doc/cpp/","section":"Docs","summary":"C++æé«˜ç¼–ç¨‹ #\ræœ¬é˜¶æ®µä¸»è¦é’ˆå¯¹C++==æ³›å‹ç¼–ç¨‹==å’Œ==STL==æŠ€æœ¯åšè¯¦ç»†è®²è§£ï¼Œæ¢è®¨C++æ›´æ·±å±‚çš„ä½¿ç”¨ 1 æ¨¡æ¿ #\r1.1 æ¨¡æ¿çš„æ¦‚å¿µ #\ræ¨¡æ¿å°±æ˜¯å»ºç«‹é€šç”¨çš„æ¨¡å…·ï¼Œå¤§å¤§æé«˜å¤ç”¨æ€§\næ¨¡æ¿çš„ç‰¹ç‚¹ï¼š\næ¨¡æ¿ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ¡†æ¶ æ¨¡æ¿çš„é€šç”¨å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ 1.2 å‡½æ•°æ¨¡æ¿ #\rC++å¦ä¸€ç§ç¼–ç¨‹æ€æƒ³ç§°ä¸º ==æ³›å‹ç¼–ç¨‹== ï¼Œä¸»è¦åˆ©ç”¨çš„æŠ€æœ¯å°±æ˜¯æ¨¡æ¿\nC++æä¾›ä¸¤ç§æ¨¡æ¿æœºåˆ¶:å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿\n1.2.1 å‡½æ•°æ¨¡æ¿è¯­æ³• #\rå‡½æ•°æ¨¡æ¿ä½œç”¨ï¼š\nå»ºç«‹ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œå…¶å‡½æ•°è¿”å›å€¼ç±»å‹å’Œå½¢å‚ç±»å‹å¯ä»¥ä¸å…·ä½“åˆ¶å®šï¼Œç”¨ä¸€ä¸ªè™šæ‹Ÿçš„ç±»å‹æ¥ä»£è¡¨ã€‚\nè¯­æ³•ï¼š\ntemplate\u0026lt;typename T\u0026gt; å‡½æ•°å£°æ˜æˆ–å®šä¹‰ è§£é‡Šï¼š","title":"","type":"doc"},{"content":"\rè®¸åˆ©ä¼Ÿ #\r","date":"1 January 0001","externalUrl":null,"permalink":"/interview/","section":"","summary":"\rè®¸åˆ©ä¼Ÿ #\r","title":"","type":"page"},{"content":"\rå‘èª“ï¼š #\ræœ¬äººå°†ä¼šå‚åŠ æ ¡æ‹›å’Œç ”ç©¶ç”Ÿè€ƒè¯•ä¸­ï¼Œä¸ºä¹‹åŠªåŠ›ï¼è°¦è™šå‘å­¦è€Œä¸æ˜¯ä¸‰å¤©æ‰“é±¼ä¸¤å¤©æ™’ç½‘\n","date":"1 January 0001","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/%E5%BF%83%E8%B7%AF%E5%8E%86%E7%A8%8B/","section":"ç¬”è®°s","summary":"å‘èª“ï¼š #\ræœ¬äººå°†ä¼šå‚åŠ æ ¡æ‹›å’Œç ”ç©¶ç”Ÿè€ƒè¯•ä¸­ï¼Œä¸ºä¹‹åŠªåŠ›ï¼è°¦è™šå‘å­¦è€Œä¸æ˜¯ä¸‰å¤©æ‰“é±¼ä¸¤å¤©æ™’ç½‘","title":"","type":"ç¬”è®°"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/cloud/","section":"Series","summary":"","title":"Cloud","type":"series"},{"content":"\rDockerå®¹å™¨æŠ€æœ¯ #\rDockeræ˜¯ä¸€é—¨å¹³å°çº§åˆ«çš„æŠ€æœ¯ï¼Œæ¶‰åŠçš„èŒƒå›´å¾ˆå¹¿ï¼Œæ‰€ä»¥ï¼Œåœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å®Œæˆï¼šJava SpringBoot ç¯‡ï¼ˆæ¨èå®ŒæˆSpringCloudç¯‡å†æ¥ï¼‰è§†é¢‘æ•™ç¨‹åŠä¹‹å‰å…¨éƒ¨è·¯çº¿ï¼Œå¦åˆ™å­¦ä¹ ä¼šéå¸¸åƒåŠ›ï¼Œå¦å¤–æ¨èé¢å¤–æŒæ¡ï¼šã€Šè®¡ç®—æœºç½‘ç»œã€‹ã€ã€Šæ“ä½œç³»ç»Ÿã€‹ç›¸å…³çŸ¥è¯†ã€‚å­¦ä¸€æ ·ä¸œè¥¿ä¸èƒ½å®Œå…¨é è®°å¿†æ¥å®Œæˆï¼Œè€Œæ˜¯éœ€è¦ç»“åˆè‡ªå·±æ‰€å­¦çš„åŸºç¡€çŸ¥è¯†åŠ ä»¥ç†è§£ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå•å‡­è®°å¿†èƒ½å¤ŸæŒæ¡çš„ä¸œè¥¿å¾€å¾€æ˜¯æœ€å»‰ä»·çš„ã€‚\n**Dockerå®˜ç½‘ï¼š**\rhttps://www.docker.com\n**è¯¾å‰å‡†å¤‡ï¼š**é…ç½®2C2Gä»¥ä¸ŠLinuxæœåŠ¡å™¨ä¸€å°ï¼Œäº‘æœåŠ¡å™¨ã€è™šæ‹Ÿæœºå‡å¯ã€‚\nå®¹å™¨æŠ€æœ¯å…¥é—¨ #\réšç€æ—¶ä»£çš„å‘å±•ï¼ŒDockerä¹Ÿé€æ¸èµ°ä¸Šäº†å†å²èˆå°ï¼Œæ›¾ç»æˆ‘ä»¬æƒ³è¦å®‰è£…ä¸€å¥—ç¯å¢ƒï¼Œéœ€è¦èŠ±è´¹ä¸€ä¸‹åˆç”šè‡³ä¸€æ•´å¤©æ¥é…ç½®å’Œå®‰è£…å„ä¸ªéƒ¨åˆ†ï¼ˆæ¯”å¦‚è¿è¡Œæˆ‘ä»¬è‡ªå·±çš„SpringBootåº”ç”¨ç¨‹åºï¼Œå¯èƒ½éœ€è¦å®‰è£…æ•°æ®åº“ã€å®‰è£…Redisã€å®‰è£…MQç­‰ï¼Œå„ç§å„æ ·çš„ç¯å¢ƒå…‰æ˜¯å®‰è£…å°±è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´ï¼ŒçœŸçš„æ˜¯æå¾—å¿ƒæ€çˆ†ç‚¸ï¼‰ï¼Œè€Œæœ‰äº†Dockerä¹‹åï¼Œæˆ‘ä»¬çš„ç¨‹åºå’Œç¯å¢ƒéƒ¨ç½²å°±å˜å¾—éå¸¸ç®€å•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›ç¯å¢ƒä¸€èµ·æ‰“åŒ…æˆä¸€ä¸ªé•œåƒã€‚è€Œåˆ°æœåŠ¡å™¨ä¸Šéƒ¨ç½²æ—¶ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½é•œåƒå®ç°ä¸€é”®éƒ¨ç½²ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿ\nåŒ…æ‹¬æˆ‘ä»¬åœ¨å­¦ä¹ SpringCloudéœ€è¦é…ç½®çš„å„ç§ç»„ä»¶ï¼Œå¯èƒ½åœ¨è‡ªå·±ç”µè„‘çš„ç¯å¢ƒä¸­è¿è¡Œä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼ˆå¯èƒ½ç”±äºç”µè„‘ä¸Šå„ç§ç¯å¢ƒæ²¡é…ç½®ï¼Œå¯¼è‡´æ— æ³•è¿è¡Œï¼‰ï¼Œè€Œç°åœ¨åªéœ€è¦ä¸‹è½½é•œåƒå°±èƒ½ç›´æ¥è¿è¡Œï¼Œæ‰€æœ‰çš„ç¯å¢ƒå…¨éƒ¨åœ¨é•œåƒä¸­é…ç½®å®Œæˆï¼Œå¼€ç®±å³ç”¨ã€‚\nçœŸçš„æœ‰è¿™ä¹ˆç¥å¥‡å—ï¼Ÿæˆ‘ä»¬æ¥è¯•è¯•çœ‹ã€‚\nç¯å¢ƒå®‰è£…å’Œéƒ¨ç½² #\ré¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯å…ˆå°†Dockerç¯å¢ƒæ­å»ºå¥½ï¼ˆå»ºè®®å’Œæˆ‘åŒä¸€ä¸ªç¯å¢ƒï¼Œä¸ç„¶å‡ºäº†é—®é¢˜åªèƒ½è‡ªå·±æƒ³åŠæ³•äº†ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ï¼š\nUbuntu 22.04 æ“ä½œç³»ç»Ÿ Dockeråˆ†ä¸ºå…è´¹çš„CEï¼ˆCommunity Editionï¼‰ç¤¾åŒºç‰ˆæœ¬å’ŒEEï¼ˆEnterprise Editionï¼‰ä¼ä¸šçº§ä»˜è´¹ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œé€‰æ‹©docker-ceè¿›è¡Œå®‰è£…ã€‚å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼šhttps://docs.docker.com/engine/install/ubuntu/\né¦–å…ˆå®‰è£…ä¸€äº›å·¥å…·ï¼š\nsudo apt-get install ca-certificates curl gnupg lsb-release ä¸è¿‡åœ¨Ubuntu22.04å·²ç»é»˜è®¤å®‰è£…å¥½äº†ã€‚æ¥ç€å®‰è£…å®˜æ–¹çš„GPG keyï¼š\nsudo mkdir -p /etc/apt/keyrings curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg æœ€åå°†Dockerçš„åº“æ·»åŠ åˆ°aptèµ„æºåˆ—è¡¨ä¸­ï¼š\necho \u0026#34;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\u0026#34; | sudo tee /etc/apt/sources.list.d/docker.list \u0026gt; /dev/null æ¥ç€æˆ‘ä»¬æ›´æ–°ä¸€æ¬¡aptï¼š\nsudo apt update æœ€åå®‰è£…Docker CEç‰ˆæœ¬ï¼š\nsudo apt install docker-ce ç­‰å¾…å®‰è£…å®Œæˆå°±å¯ä»¥äº†ï¼š\nå¯ä»¥çœ‹åˆ°å®‰è£…æˆåŠŸåç‰ˆæœ¬æ˜¯20.10.17ï¼Œå½“ç„¶å¯èƒ½ä½ ä»¬å®‰è£…çš„æ—¶å€™å°±æ˜¯æ›´æ–°çš„ç‰ˆæœ¬äº†ã€‚æœ€åæˆ‘ä»¬å°†å½“å‰ç”¨æˆ·æ·»åŠ åˆ°dockerç”¨æˆ·ç»„ä¸­ï¼Œä¸ç„¶æ¯æ¬¡ä½¿ç”¨dockerå‘½ä»¤éƒ½éœ€è¦sudoæ‰§è¡Œï¼Œå¾ˆéº»çƒ¦ï¼š\nsudo usermod -aG docker \u0026lt;ç”¨æˆ·å\u0026gt; é…ç½®å¥½åï¼Œæˆ‘ä»¬å…ˆé€€å‡ºSSHç»ˆç«¯ï¼Œç„¶åé‡æ–°è¿æ¥å°±å¯ä»¥ç”Ÿæ•ˆäº†ã€‚\nè¿™æ ·æˆ‘ä»¬Docker çš„å­¦ä¹ ç¯å¢ƒå°±é…ç½®å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å°±å°è¯•é€šè¿‡Dockeræ¥éƒ¨ç½²ä¸€ä¸ªNginxæœåŠ¡å™¨è¯•è¯•çœ‹ï¼Œä½¿ç”¨å¾ˆç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥äº†ï¼ˆå½“ç„¶ç°åœ¨çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œæˆ‘ä»¬åé¢ä¼šç»†å—¦ï¼‰ï¼š\nsudo docker run -d -p 80:80 nginx é¦–é€‰å®ƒä¼šä»é•œåƒä»“åº“ä¸­ä¸‹è½½å¯¹åº”çš„é•œåƒï¼Œå›½å†…è®¿é—®é€Ÿåº¦è¿˜è¡Œï¼Œä¸éœ€è¦å•ç‹¬é…ç½®é•œåƒæºã€‚æ¥ç€ä¸‹è½½å®Œæˆåï¼Œå°±ä¼šåœ¨åå°è¿è¡Œäº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµè§ˆå™¨è®¿é—®è¯•è¯•çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°ï¼ŒNginxæœåŠ¡å™¨å·²ç»æˆåŠŸéƒ¨ç½²äº†ï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨Ubuntuä¸­å®‰è£…Nginxï¼Œè€Œæ˜¯é€šè¿‡Dockerè¿è¡Œçš„é•œåƒæ¥è¿›è¡ŒæœåŠ¡å™¨æ­å»ºçš„ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ç©æ³•æŒºæ–°å¥‡çš„ã€‚é™¤äº†Nginxè¿™ç§ç®€å•çš„åº”ç”¨ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡Dockeræ¥éƒ¨ç½²å¤æ‚åº”ç”¨ï¼Œä¹‹åæˆ‘ä»¬éƒ½ä¼šä¸€ä¸€è¿›è¡Œè®²è§£çš„ã€‚\nä»è™šæ‹Ÿæœºåˆ°å®¹å™¨ #\rå‰é¢æˆ‘ä»¬æˆåŠŸå®‰è£…äº†Dockerå­¦ä¹ ç¯å¢ƒï¼Œä»¥åŠæµ…å°äº†ä¸€ä¸‹Dockerä¸ºæˆ‘ä»¬å¸¦æ¥çš„åº”ç”¨å¿«é€Ÿéƒ¨ç½²ã€‚åœ¨æ­£å¼è¿›å…¥å­¦ä¹ ä¹‹å‰ï¼Œæˆ‘ä»¬å°±å…ˆä»Dockerçš„å‘å±•å¼€å§‹è¯´èµ·ã€‚\nåœ¨Dockerå‡ºç°ä¹‹å‰ï¼Œè™šæ‹ŸåŒ–æŠ€æœ¯å¯ä»¥è¯´æ˜¯å æ®äº†ä¸»å¯¼åœ°ä½ã€‚é¦–å…ˆæˆ‘ä»¬æ¥è°ˆè°ˆä¸ºä»€ä¹ˆä¼šå‡ºç°è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ä¼ä¸šä¸­æœåŠ¡å™¨å¯ä»¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ä¸€ç§ç¡¬ä»¶è®¾æ–½äº†ï¼ŒæœåŠ¡å™¨ä¹Ÿæ˜¯ç”µè„‘ï¼Œä½†æ˜¯ä¸åƒæˆ‘ä»¬çš„å®¶ç”¨ç”µè„‘ï¼ŒæœåŠ¡å™¨çš„é…ç½®æ˜¯éå¸¸é«˜çš„ï¼Œæˆ‘ä»¬å®¶ç”¨ç”µè„‘çš„CPUå¯èƒ½æœ€é«˜é…ä¹Ÿå°±20æ ¸äº†ï¼Œå†…å­˜å¾ˆå°‘æœ‰è¶…è¿‡128Gçš„ç”µè„‘ï¼Œ64Gå†…å­˜çš„å®¶ç”¨ç”µè„‘å¯ä»¥ç®—å¥¢ä¾ˆäº†ã€‚è€ŒæœåŠ¡å™¨ä¸ä¸€æ ·ï¼ŒæœåŠ¡å™¨çº§åˆ«çš„CPUåŠ¨è¾„12æ ¸ï¼Œç”šè‡³æœåŠ¡å™¨è¿˜èƒ½åŒæ—¶å®‰è£…å¤šå—CPUï¼Œèƒ½ç›´æ¥å †åˆ°å¥½å‡ åæ ¸ï¼š\næˆ‘ä»¬å®¶ç”¨çº§CPUä¸€èˆ¬æ˜¯AMDçš„é”é¾™ç³»åˆ—å’ŒIntelçš„é…·ç¿ç³»åˆ—ï¼ˆæ¯”å¦‚i3 i5 i7 i9ï¼‰ï¼Œè€ŒæœåŠ¡å™¨CPUä¸€èˆ¬æ˜¯Intelçš„å¿—å¼ºï¼ˆXenoï¼‰ç³»åˆ—ï¼Œè¿™ç§CPUçš„ç‰¹ç‚¹å°±æ˜¯æ ¸å¿ƒæ•°éå¸¸å¤šï¼š\nå¹¶ä¸”æœåŠ¡å™¨CPUç›¸æ¯”å®¶ç”¨CPUçš„åŠŸè€—ä¹Ÿä¼šæ›´å¤§ï¼Œå› æ­¤æœåŠ¡å™¨CPUçš„å‘çƒ­é‡éå¸¸é«˜ï¼Œå¦‚æœä½ æœ‰å¹¸å»è¿‡æœºæˆ¿ï¼Œä½ ä¼šå¬è§æ•£çƒ­é£æ‰‡çŒ›çƒˆè½¬åŠ¨çš„å£°éŸ³ï¼ˆä½†æ˜¯æœåŠ¡å™¨CPUçš„é¢‘ç‡æ²¡æœ‰å®¶ç”¨çº§CPUé«˜ï¼Œä¸€èˆ¬å¤§å‹æ¸¸æˆè¦æ±‚çš„æ˜¯é«˜é¢‘ç‡è€Œä¸æ˜¯æ ¸å¿ƒæ•°ï¼Œè€Œä¸”åŠŸè€—ä¹Ÿæ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥å¹¶ä¸é€‚åˆåšå®¶ç”¨ç”µè„‘ï¼Œæ‰€ä»¥ä»¥ååœ¨ç½‘ä¸Šä¹°å°å¼æœºï¼Œçœ‹åˆ°ä»€ä¹ˆâ€œi9çº§â€CPUåƒä¸‡åˆ«ä¹°ï¼Œæ˜¯è¿™äº›é»‘å¿ƒå•†å®¶æŠŠå›½å¤–æœåŠ¡å™¨ä¸Šæ·˜æ±°ä¸‹æ¥çš„æœåŠ¡å™¨CPUï¼ˆæ´‹åƒåœ¾ï¼‰è£…æˆç”µè„‘å–ç»™ä½ ï¼Œæ‰€ä»¥ä¼šå¾ˆä¾¿å®œï¼ŒåŒæ—¶æ ¸å¿ƒæ•°åˆèƒ½åª²ç¾i9ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸€åˆ†é’±ä¸€åˆ†è´§å®åœ¨ï¼‰\næœåŠ¡å™¨æ— è®ºæ˜¯CPUèµ„æºè¿˜æ˜¯å†…å­˜èµ„æºéƒ½è¿œè¶…å®¶ç”¨ç”µè„‘ï¼Œè€Œæˆ‘ä»¬ç¼–å†™çš„Javaåç«¯é¡¹ç›®ï¼Œæœ€åéƒ½ä¼šè¿è¡Œåœ¨è¿™äº›æœåŠ¡å™¨ä¸Šï¼Œä¸è¿‡æœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒæœåŠ¡å™¨æ—¢ç„¶æœ‰è¿™ä¹ˆä¸°å¯Œçš„ç¡¬ä»¶èµ„æºï¼Œå°±è·‘å’±ä»¬è¿™ä¸€ä¸ªå°Javaåç«¯ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹æ ¸å¼¹ç‚¸èšŠå­çš„æ„Ÿè§‰äº†ï¼Ÿå¯èƒ½é¡¶å¤šå°±ç”¨äº†æœåŠ¡å™¨5%çš„ç¡¬ä»¶èµ„æºï¼ŒæœåŠ¡å™¨è¿™ä¹ˆç‰›å°±è¿è¡Œä¸ªè¿™ä¹Ÿå¤ªæµªè´¹äº†å§ã€‚\næ‰€ä»¥ï¼Œä¸ºäº†è§£å†³è¿™ç§èµ„æºåˆ©ç”¨ç‡åªæœ‰5%-15%çš„æƒ…å†µï¼Œå’±ä»¬èƒ½ä¸èƒ½æƒ³ä¸ªåŠæ³•ï¼ŒæŠŠè¿™ä¸€å°æœåŠ¡å™¨åˆ†æˆå¤šä¸ªå°æœåŠ¡å™¨ä½¿ç”¨ï¼Œæ¯ä¸ªå°æœåŠ¡å™¨åªåˆ†é…ä¸€éƒ¨åˆ†çš„èµ„æºï¼Œæ¯”å¦‚åˆ†ä¸€ä¸ªå°æœåŠ¡å™¨å‡ºå»ï¼Œåªç»™2ä¸ªCPUæ ¸å¿ƒå’Œ4Gå†…å­˜ã€‚ä½†æ˜¯ç”±äºè®¾è®¡ä¸Šçš„é—®é¢˜ï¼Œæˆ‘ä»¬çš„ç”µè„‘åªèƒ½åŒæ—¶è¿è¡Œä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œé‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼Ÿæ­¤æ—¶è™šæ‹ŸåŒ–æŠ€æœ¯å°±å¼€å§‹å…´èµ·äº†ã€‚\nè™šæ‹ŸåŒ–ä½¿ç”¨è½¯ä»¶æ¥æ¨¡æ‹Ÿç¡¬ä»¶å¹¶åˆ›å»ºè™šæ‹Ÿè®¡ç®—æœºç³»ç»Ÿã€‚è¿™æ ·ä¸€æ¥ï¼Œä¼ä¸šä¾¿å¯ä»¥åœ¨å•å°æœåŠ¡å™¨ä¸Šè¿è¡Œå¤šä¸ªè™šæ‹Ÿç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯è¿è¡Œå¤šä¸ªæ“ä½œç³»ç»Ÿå’Œåº”ç”¨ï¼Œè€Œè¿™å¯ä»¥å®ç°è§„æ¨¡ç»æµä»¥åŠæé«˜æ•ˆç›Šã€‚æ¯”å¦‚æˆ‘ä»¬ç”µè„‘ä¸Šç»å¸¸ä½¿ç”¨çš„VMwareå°±æ˜¯ä¸€ç§æ°‘ç”¨çº§è™šæ‹ŸåŒ–è½¯ä»¶ï¼š\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨VMwareæ¥åˆ›å»ºè™šæ‹Ÿæœºï¼Œè¿™äº›è™šæ‹Ÿæœºå®é™…ä¸Šéƒ½æ˜¯åŸºäºæˆ‘ä»¬å½“å‰ç³»ç»Ÿä¸Šçš„VMwareè½¯ä»¶æ¥è¿è¡Œçš„ï¼Œå½“ç„¶VMwareä¹Ÿæœ‰æœåŠ¡å™¨ä¸“ç”¨çš„è™šæ‹ŸåŒ–è½¯ä»¶ï¼Œæœ‰äº†è™šæ‹ŸåŒ–ä¹‹åï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨å°±åƒè¿™æ ·ï¼š\nç›¸å½“äºé€šè¿‡è™šæ‹Ÿæœºæ¨¡æ‹Ÿäº†å¾ˆå¤šæ¥ç”µè„‘å‡ºæ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨åˆ’åˆ†å‡ºæ¥çš„å¤šå°è™šæ‹Ÿæœºä¸Šåˆ†åˆ«å®‰è£…ç³»ç»Ÿå’Œéƒ¨ç½²æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºäº†ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥è‡ªç”±åˆ†é…ç¡¬ä»¶èµ„æºï¼Œåˆç†åœ°ä½¿ç”¨ã€‚ä¸€èˆ¬åœ¨ä¼ä¸šä¸­ï¼Œä¸åŒçš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šè¢«åˆ†åˆ«éƒ¨ç½²åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œéš”ç¦»å¼€æ¥ï¼Œæ­¤æ—¶ä½¿ç”¨è™šæ‹Ÿæœºå°±éå¸¸é€‚åˆã€‚\nå®é™…ä¸Šæˆ‘ä»¬åœ¨ä»€ä¹ˆè…¾è®¯äº‘ã€é˜¿é‡Œäº‘ç§Ÿçš„äº‘æœåŠ¡å™¨ï¼Œéƒ½æ˜¯ç»è¿‡è™šæ‹ŸåŒ–æŠ€æœ¯åˆ’åˆ†å‡ºæ¥çš„è™šæ‹Ÿæœºè€Œå·²ã€‚\né‚£ä¹ˆï¼Œæ—¢ç„¶è™šæ‹Ÿæœºéƒ½è¿™ä¹ˆæ–¹ä¾¿äº†ï¼Œå®¹å™¨åˆæ˜¯æ€ä¹ˆæ€å‡ºä¸€æ¡è¡€è·¯çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯å®¹å™¨ã€‚\nå®¹å™¨å’Œè™šæ‹Ÿæœºæ¯”è¾ƒç±»ä¼¼ï¼Œéƒ½å¯ä»¥ä¸ºåº”ç”¨æä¾›å°è£…å’Œéš”ç¦»ï¼Œéƒ½æ˜¯è½¯ä»¶ï¼Œä½†æ˜¯å®¹å™¨ä¸­çš„åº”ç”¨è¿è¡Œæ˜¯å¯„æ‰˜äºå®¿ä¸»æ“ä½œç³»ç»Ÿçš„ï¼Œå®é™…ä¸Šä¾ç„¶æ˜¯åœ¨ç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„èµ„æºï¼Œå½“ç„¶åº”ç”¨ç¨‹åºä¹‹é—´ç¯å¢ƒä¾ç„¶æ˜¯éš”ç¦»çš„ï¼Œè€Œè™šæ‹Ÿæœºåˆ™æ˜¯å®Œå…¨æ¨¡æ‹Ÿä¸€å°çœŸæ­£çš„ç”µè„‘å‡ºæ¥ï¼Œç›´æ¥å°±æ˜¯ä¸¤å°ä¸åŒçš„ç”µè„‘ã€‚\nå› æ­¤å®¹å™¨ç›¸æ¯”è™šæ‹Ÿæœºå°±ç®€å•å¤šäº†ï¼Œå¹¶ä¸”å¯åŠ¨é€Ÿåº¦ä¹Ÿä¼šå¿«å¾ˆå¤šï¼Œå¼€é”€å°äº†ä¸å°‘ã€‚\nä¸è¿‡å®¹å™¨ç«çš„æ ¹æœ¬åŸå› è¿˜æ˜¯å®ƒçš„é›†è£…ç®±æ€æƒ³ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬è¦å†™ä¸€ä¸ªæ¯”å¦‚è®ºå›ã€ç”µå•†è¿™ç±»çš„Javaé¡¹ç›®ï¼Œé‚£ä¹ˆæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ç¼“å­˜è¿™ç±»ä¸­é—´ä»¶æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå› æ­¤æˆ‘ä»¬å¦‚æœæƒ³è¦å°†ä¸€ä¸ªæœåŠ¡éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®é™…ä¸Šè¿˜è¦æå‰å‡†å¤‡å¥½å„ç§å„æ ·çš„ç¯å¢ƒï¼Œå…ˆå®‰è£…å¥½MySQLã€Redisã€RabbitMQç­‰åº”ç”¨ï¼Œé…ç½®å¥½äº†ç¯å¢ƒï¼Œå†å°†æˆ‘ä»¬çš„Javaåº”ç”¨ç¨‹åºå¯åŠ¨ï¼Œæ•´ä¸ªæµç¨‹ä¸‹æ¥ï¼Œå…‰æ˜¯é…ç½®ç¯å¢ƒå°±è¦æµªè´¹å¤§é‡çš„æ—¶é—´ï¼Œå¦‚æœæ˜¯å¤§å‹çš„åˆ†å¸ƒå¼é¡¹ç›®ï¼Œå¯èƒ½è¦éƒ¨ç½²å¾ˆå¤šå°æœºå™¨ï¼Œé‚£å²‚ä¸æ˜¯æˆ‘ä»¬å¾—ä¸€ä¸ªä¸€ä¸ªæ¥ï¼Ÿé¡¹ç›®ä¸Šä¸ªçº¿å°±è¦èŠ±å‡ å¤©æ—¶é—´ï¼Œæ˜¾ç„¶æ˜¯å¾ˆè’å”çš„ã€‚\nè€Œå®¹å™¨å¯ä»¥æ‰“åŒ…æ•´ä¸ªç¯å¢ƒï¼Œæ¯”è¾ƒMySQLã€Redisç­‰ä»¥åŠæˆ‘ä»¬çš„Javaåº”ç”¨ç¨‹åºï¼Œå¯ä»¥è¢«ä¸€èµ·æ‰“åŒ…ä¸ºä¸€ä¸ªé•œåƒï¼Œå½“æˆ‘ä»¬éœ€è¦éƒ¨ç½²æœåŠ¡æ—¶ï¼Œåªéœ€è¦åƒæˆ‘ä»¬ä¹‹å‰é‚£æ ·ï¼Œç›´æ¥ä¸‹è½½é•œåƒè¿è¡Œå³å¯ï¼Œä¸éœ€è¦å†è¿›è¡Œé¢å¤–çš„é…ç½®äº†ï¼Œæ•´ä¸ªé•œåƒä¸­ç¯å¢ƒæ˜¯å·²ç»é…ç½®å¥½çš„çŠ¶æ€ï¼Œå¼€ç®±å³ç”¨ã€‚\nè€Œæˆ‘ä»¬è¦é‡ç‚¹ä»‹ç»çš„å°±æ˜¯Dockeräº†ï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„å›¾æ ‡å°±æ˜¯ä¸€åªé²¸é±¼ï¼Œé²¸é±¼çš„ä¸Šé¢æ˜¯å¾ˆå¤šä¸ªé›†è£…ç®±ï¼Œæ¯ä¸ªé›†è£…ç®±å°±æ˜¯æˆ‘ä»¬çš„æ•´ä¸ªç¯å¢ƒ+åº”ç”¨ç¨‹åºï¼ŒDockerå¯ä»¥å°†ä»»ä½•åº”ç”¨åŠå…¶ä¾èµ–æ‰“åŒ…ä¸ºä¸€ä¸ªè½»é‡çº§ï¼Œå¯ç§»æ¤ï¼Œè‡ªåŒ…å«çš„å®¹å™¨ï¼Œå®¹å™¨å¯ä»¥è¿è¡Œåœ¨å‡ ä¹æ‰€æœ‰çš„æ“ä½œç³»ç»Ÿä¸Šã€‚\nå®¹å™¨å·¥ä½œæœºåˆ¶ç®€è¿° #\ræˆ‘ä»¬å…ˆæ¥çœ‹çœ‹Dockerçš„æ•´ä½“æ¶æ„ï¼š\nå®é™…ä¸Šåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š\nDocker å®¢æˆ·ç«¯ï¼šä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„dockerå‘½ä»¤ï¼Œéƒ½æ˜¯åœ¨å®¢æˆ·ç«¯ä¸Šæ‰§è¡Œçš„ï¼Œæ“ä½œä¼šå‘é€åˆ°æœåŠ¡ç«¯ä¸Šå¤„ç†ã€‚ Docker æœåŠ¡ç«¯ï¼šæœåŠ¡ç«¯å°±æ˜¯å¯åŠ¨å®¹å™¨çš„ä¸»ä½“äº†ï¼Œä¸€èˆ¬æ˜¯ä½œä¸ºæœåŠ¡åœ¨åå°è¿è¡Œï¼Œæ”¯æŒè¿œç¨‹è¿æ¥ã€‚ Registryï¼šæ˜¯å­˜æ”¾Dockeré•œåƒçš„ä»“åº“ï¼Œè·ŸMavenä¸€æ ·ï¼Œä¹Ÿå¯ä»¥åˆ†å…¬æœ‰å’Œç§æœ‰ä»“åº“ï¼Œé•œåƒå¯ä»¥ä»ä»“åº“ä¸‹è½½åˆ°æœ¬åœ°å­˜æ”¾ã€‚ å½“æˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²ä¸€ä¸ªå·²ç»æ‰“åŒ…å¥½çš„åº”ç”¨å’Œç¯å¢ƒï¼Œæˆ‘ä»¬åªéœ€è¦ä¸‹è½½æ‰“åŒ…å¥½çš„é•œåƒå°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬å‰é¢æ‰§è¡Œäº†ï¼š\nsudo docker run -d -p 80:80 nginx å®é™…ä¸Šè¿™ä¸ªå‘½ä»¤è¾“å…¥ä¹‹åï¼š\nDockerå®¢æˆ·ç«¯å°†æ“ä½œå‘é€ç»™æœåŠ¡ç«¯ï¼Œå‘Šè¯‰æœåŠ¡ç«¯æˆ‘ä»¬è¦è¿è¡Œnginxè¿™ä¸ªé•œåƒã€‚ DockeræœåŠ¡ç«¯å…ˆçœ‹çœ‹æœ¬åœ°æœ‰æ²¡æœ‰è¿™ä¸ªé•œåƒï¼Œå‘ç°æ²¡æœ‰ã€‚ æ¥ç€åªèƒ½ä»å…¬å…±ä»“åº“Docker Hubå»æŸ¥æ‰¾ä¸‹è½½é•œåƒäº†ã€‚ ä¸‹è½½å®Œæˆï¼Œé•œåƒæˆåŠŸä¿å­˜åˆ°æœ¬åœ°ã€‚ DockeræœåŠ¡ç«¯åŠ è½½Nginxé•œåƒï¼Œå¯åŠ¨å®¹å™¨å¼€å§‹æ­£å¸¸è¿è¡Œï¼ˆæ³¨æ„å®¹å™¨å’Œå…¶ä»–å®¹å™¨ä¹‹é—´ï¼Œå’Œå¤–éƒ¨ä¹‹é—´ï¼Œéƒ½æ˜¯éš”ç¦»çš„ï¼Œäº’ä¸å½±å“ï¼‰ æ‰€ä»¥ï¼Œæ•´ä¸ªæµç¨‹ä¸­ï¼ŒDockerå°±åƒæ˜¯ä¸€æœè¿è¾“èˆ¹ï¼Œé•œåƒå°±åƒæ˜¯é›†è£…ç®±ï¼Œé€šè¿‡è¿è¾“èˆ¹å°†ä¸–ç•Œå„åœ°çš„è´§ç‰©é€å¾€æˆ‘ä»¬çš„æ¸¯å£ï¼Œè´§ç‰©åˆ°è¾¾æ¸¯å£åï¼ŒDockerå¹¶ä¸å…³å¿ƒé›†è£…ç®±é‡Œé¢çš„æ˜¯ä»€ä¹ˆï¼Œåªéœ€è¦åˆ›å»ºå®¹å™¨å¼€ç®±å³ç”¨å°±å¯ä»¥äº†ã€‚ç›¸æ¯”æˆ‘ä»¬ä¼ ç»Ÿçš„æ‰‹åŠ¨å®‰è£…é…ç½®ç¯å¢ƒï¼Œä¸çŸ¥é“æ–¹ä¾¿äº†å‡ ä¸ªå±‚æ¬¡ã€‚\nä¸è¿‡å®¹å™¨ä¾ç„¶æ˜¯å¯„æ‰˜äºå®¿ä¸»ä¸»æœºçš„è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œéƒ½æ˜¯é€šè¿‡è™šæ‹ŸåŒ–å…ˆåˆ›å»ºå¤šå°ä¸»æœºï¼Œç„¶åå†åˆ°å„ä¸ªè™šæ‹Ÿæœºä¸­éƒ¨ç½²Dockerï¼Œè¿™æ ·çš„è¯ï¼Œè¿ç»´æ•ˆç‡å°±å¤§å¤§æå‡äº†ã€‚\nä»ä¸‹ä¸€ç« å¼€å§‹ï¼Œæˆ‘ä»¬å°±æ­£å¼åœ°æ¥å­¦ä¹ ä¸€ä¸‹Dockerçš„å„ç§æ“ä½œã€‚\nå®¹å™¨ä¸é•œåƒ #\rè¦å¯åŠ¨å®¹å™¨æœ€å…³é”®çš„å°±æ˜¯é•œåƒï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é•œåƒç›¸å…³çš„ä»‹ç»ã€‚\nåˆè¯†å®¹å™¨é•œåƒ #\ré¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹é•œåƒçš„ç›¸å…³æ“ä½œï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬å¸Œæœ›æŠŠæŸä¸ªé•œåƒä»ä»“åº“ä¸‹è½½åˆ°æœ¬åœ°ï¼Œè¿™é‡Œä½¿ç”¨å®˜æ–¹çš„hello-worldé•œåƒï¼š\ndocker pull hello-world åªéœ€è¦è¾“å…¥pullå‘½ä»¤ï¼Œå°±å¯ä»¥ç›´æ¥ä¸‹è½½åˆ°æŒ‡å®šçš„é•œåƒäº†ï¼š\nå¯ä»¥çœ‹åˆ°å¯¹ä¸Šé¢ä¸€è¡Œæœ‰ä¸€å¥Using default tagï¼Œå®é™…ä¸Šä¸€ä¸ªé•œåƒçš„åç§°æ˜¯ç”±ä¸¤éƒ¨åˆ†ç»„æˆçš„ï¼Œä¸€ä¸ªæ˜¯repositoryï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯tagï¼Œä¸€èˆ¬æƒ…å†µä¸‹çº¦å®šrepositoryå°±æ˜¯é•œåƒåç§°ï¼Œtagä½œä¸ºç‰ˆæœ¬ï¼Œé»˜è®¤ä¸ºlatestï¼Œè¡¨ç¤ºæœ€æ–°ç‰ˆæœ¬ã€‚æ‰€ä»¥æŒ‡å®šç‰ˆæœ¬è¿è¡Œçš„è¯ï¼š\ndocker pull åç§°:ç‰ˆæœ¬ ä¹‹åä¸ºäº†æ•™å­¦æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨é»˜è®¤çš„tagï¼Œä¸å»æŒ‡å®šç‰ˆæœ¬äº†ã€‚\né•œåƒä¸‹è½½ä¹‹åä¼šå­˜æ”¾åœ¨æœ¬åœ°ï¼Œè¦å¯åŠ¨è¿™ä¸ªé•œåƒçš„å®¹å™¨ï¼Œå®é™…ä¸Šå°±åƒæˆ‘ä»¬ä¹‹å‰é‚£æ ·ï¼Œè¾“å…¥runå‘½ä»¤å°±å¯ä»¥äº†ï¼š\ndocker run hello-world å½“ç„¶å¦‚æœä»…ä»…æ˜¯åªæƒ³åˆ›å»ºè€Œä¸æƒ³é©¬ä¸Šè¿è¡Œçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨createå‘½ä»¤ï¼š\ndocker create hello-world å¯ä»¥çœ‹åˆ°æˆåŠŸå¯åŠ¨äº†ï¼š\nå¯åŠ¨ä¹‹åï¼Œä¼šä½¿ç”¨å½“å‰é•œåƒè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥pså‘½ä»¤æ¥æŸ¥çœ‹å½“å‰å®¹å™¨çš„å®¹å™¨åˆ—è¡¨ï¼š\ndocker ps -a æ³¨æ„åé¢è¦åŠ ä¸€ä¸ª-aè¡¨ç¤ºæŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆå…¶ä»–é€‰é¡¹å¯ä»¥ä½¿ç”¨-hæŸ¥çœ‹ï¼‰ï¼Œå¦‚æœä¸åŠ çš„è¯ï¼Œåªä¼šæ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œè€ŒHelloWorldæ˜¯ä¸€æ¬¡æ€§çš„ä¸æ˜¯Nginxé‚£æ ·çš„å¸¸é©»ç¨‹åºï¼Œæ‰€ä»¥å®¹å™¨å¯åŠ¨æ‰“å°äº†ä¸Šé¢çš„å†…å®¹ä¹‹åï¼Œå®¹å™¨å°±åœæ­¢è¿è¡Œäº†ï¼š\nå¯ä»¥çœ‹åˆ°å®¹å™¨åˆ—è¡¨ä¸­æœ‰æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„hello-worldä»¥åŠæˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„nginxï¼ˆæ³¨æ„åŒä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ï¼‰ï¼Œæ¯ä¸ªå®¹å™¨éƒ½æœ‰ä¸€ä¸ªéšæœºç”Ÿæˆçš„å®¹å™¨IDå†™åœ¨æœ€å‰é¢ï¼Œåé¢æ˜¯å®¹å™¨çš„åˆ›å»ºæ—¶é—´ä»¥åŠå½“å‰çš„è¿è¡ŒçŠ¶æ€ï¼Œæœ€åä¸€åˆ—æ˜¯å®¹å™¨çš„åç§°ï¼Œåœ¨åˆ›å»ºå®¹å™¨æ—¶ï¼Œåç§°å¯ä»¥ç”±æˆ‘ä»¬æŒ‡å®šä¹Ÿå¯ä»¥è‡ªåŠ¨ç”Ÿæˆï¼Œè¿™é‡Œå°±æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ã€‚\næˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šåç§°å¯åŠ¨ï¼Œåœ¨ä½¿ç”¨runå‘½ä»¤æ—¶ï¼Œæ·»åŠ --nameå‚æ•°å³å¯ï¼š\ndocker run --name=lbwnb hello-world æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å¼€å¯å¤„äºåœæ­¢çŠ¶æ€çš„å®¹å™¨ï¼š\ndocker start \u0026lt;å®¹å™¨åç§°/å®¹å™¨ID\u0026gt; æ³¨æ„å¯åŠ¨çš„å¯¹è±¡æˆ‘ä»¬è¦å¡«å†™å®¹å™¨çš„IDæˆ–æ˜¯å®¹å™¨çš„åç§°æ‰å¯ä»¥ï¼Œå®¹å™¨IDæ¯”è¾ƒé•¿ï¼Œå¯ä»¥ä¸å†™å…¨åªå†™ä¸€åŠï¼Œä½†æ˜¯ä½ è¦ä¿è¯ä½ è¾“å…¥çš„ä¸å®Œå…¨å®¹å™¨IDæ˜¯å”¯ä¸€çš„ã€‚\nå¦‚æœæƒ³è¦åœæ­¢å®¹å™¨ç›´æ¥è¾“å…¥stopå‘½ä»¤å°±å¯ä»¥äº†ï¼š\ndocker stop \u0026lt;å®¹å™¨åç§°/å®¹å™¨ID\u0026gt; æˆ–æ˜¯é‡å¯ï¼š\ndocker restart \u0026lt;å®¹å™¨åç§°/å®¹å™¨ID\u0026gt; å¦‚æœæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨å®¹å™¨äº†ï¼Œé‚£ä¹ˆå¯ä»¥å°†å®¹å™¨åˆ é™¤ï¼Œä½†æ˜¯æ³¨æ„åªæœ‰å®¹å™¨å¤„äºéè¿è¡ŒçŠ¶æ€æ—¶æ‰å¯ä»¥åˆ é™¤ï¼š\ndocker rm \u0026lt;å®¹å™¨åç§°/å®¹å™¨ID\u0026gt; å½“ç„¶å¦‚æœæˆ‘ä»¬å¸Œæœ›å®¹å™¨åœ¨åœæ­¢åè‡ªåŠ¨åˆ é™¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶æ·»åŠ --rmå‚æ•°ï¼š\ndocker run --rm é•œåƒåç§° åˆ é™¤åï¼Œå®¹å™¨å°†ä¸å¤å­˜åœ¨ï¼Œå½“æ²¡æœ‰ä»»ä½•å…³äºnginxçš„å®¹å™¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤nginxçš„æœ¬åœ°é•œåƒï¼š\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨imageså‘½ä»¤æ¥æ£€æŸ¥ä¸€ä¸‹å½“å‰æœ¬åœ°æœ‰é‚£äº›é•œåƒï¼š\ndocker images è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†Dockerçš„ç®€å•ä½¿ç”¨ï¼Œåœ¨åé¢çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šç»§ç»­è®¤è¯†æ›´å¤šçš„ç©æ³•ã€‚\né•œåƒç»“æ„ä»‹ç» #\rå‰é¢æˆ‘ä»¬äº†è§£äº†Dockerçš„ç›¸å…³åŸºæœ¬æ“ä½œï¼Œå®é™…ä¸Šå®¹å™¨çš„åŸºçŸ³å°±æ˜¯é•œåƒï¼Œæœ‰äº†é•œåƒæ‰èƒ½åˆ›å»ºå¯¹åº”çš„å®¹å™¨å®ä¾‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å…ˆä»é•œåƒçš„åŸºæœ¬ç»“æ„å¼€å§‹è¯´èµ·ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é•œåƒåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆæ ·çš„å­˜åœ¨ã€‚\næˆ‘ä»¬åœ¨æ‰“åŒ…é¡¹ç›®æ—¶ï¼Œå®é™…ä¸Šå¾€å¾€éœ€è¦ä¸€ä¸ªåŸºæœ¬çš„æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œè¿™æ ·æˆ‘ä»¬æ‰å¯ä»¥åœ¨è¿™ä¸ªæ“ä½œç³»ç»Ÿä¸Šå®‰è£…å„ç§ä¾èµ–è½¯ä»¶ï¼Œæ¯”å¦‚æ•°æ®åº“ã€ç¼“å­˜ç­‰ï¼Œåƒè¿™ç§åŸºæœ¬çš„ç³»ç»Ÿé•œåƒï¼Œæˆ‘ä»¬ç§°ä¸ºbaseé•œåƒï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä¹‹åéƒ½ä¼šåŸºäºbaseé•œåƒè¿›è¡Œæ‰“åŒ…ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸éœ€è¦baseé•œåƒï¼Œä»…ä»…æ˜¯åŸºäºå½“å‰æ“ä½œç³»ç»Ÿå»æ‰§è¡Œç®€å•çš„å‘½ä»¤ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„hello-worldå°±æ˜¯ã€‚\nä¸€èˆ¬baseé•œåƒå°±æ˜¯å„ä¸ªLinuxæ“ä½œç³»ç»Ÿçš„å‘è¡Œç‰ˆï¼Œæ¯”å¦‚æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„Ubuntuï¼Œè¿˜æœ‰CentOSã€Kaliç­‰ç­‰ã€‚è¿™é‡Œæˆ‘ä»¬å°±ä¸‹è½½ä¸€ä¸‹CentOSçš„baseé•œåƒï¼š\ndocker pull centos å¯ä»¥çœ‹åˆ°ï¼ŒCentOSçš„baseé•œåƒå°±å·²ç»ä¸‹è½½å®Œæˆï¼Œä¸åƒæˆ‘ä»¬ä½¿ç”¨å®Œæ•´ç³»ç»Ÿä¸€æ ·ï¼Œbaseé•œåƒçš„CentOSçœå»äº†å†…æ ¸ï¼Œæ‰€ä»¥å¤§å°åªæœ‰272Mï¼Œè¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹baseé•œåƒçš„æœºåˆ¶ï¼š\nLinuxæ“ä½œä½“ç³»ç”±å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´ç»„æˆï¼Œå…¶ä¸­å†…æ ¸ç©ºé—´å°±æ˜¯æ•´ä¸ªLinuxç³»ç»Ÿçš„æ ¸å¿ƒï¼ŒLinuxå¯åŠ¨åé¦–å…ˆä¼šåŠ bootfsæ–‡ä»¶ç³»ç»Ÿï¼ŒåŠ è½½å®Œæˆåä¼šè‡ªåŠ¨å¸è½½æ‰ï¼Œä¹‹åä¼šåŠ è½½ç”¨æˆ·ç©ºé—´çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™ä¸€å±‚æ˜¯æˆ‘ä»¬è‡ªå·±å¯ä»¥è¿›è¡Œæ“ä½œçš„éƒ¨åˆ†ï¼š\nbootfsåŒ…å«äº†BootLoaderå’ŒLinuxå†…æ ¸ï¼Œç”¨æˆ·æ˜¯ä¸èƒ½å¯¹è¿™å±‚ä½œä»»ä½•ä¿®æ”¹çš„ï¼Œåœ¨å†…æ ¸å¯åŠ¨ä¹‹åï¼Œbootfsä¼šè‡ªåŠ¨å¸è½½ã€‚ rootfsåˆ™åŒ…å«äº†ç³»ç»Ÿä¸Šçš„å¸¸è§çš„ç›®å½•ç»“æ„ï¼ŒåŒ…æ‹¬/devã€ /procã€ /binç­‰ç­‰ä»¥åŠä¸€äº›åŸºæœ¬çš„æ–‡ä»¶å’Œå‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿›å…¥ç³»ç»Ÿä¹‹åèƒ½å¤Ÿæ“ä½œçš„æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬æˆ‘ä»¬åœ¨Ubuntuä¸‹ä½¿ç”¨çš„aptå’ŒCentOSä¸‹ä½¿ç”¨çš„yumï¼Œéƒ½æ˜¯ç”¨æˆ·ç©ºé—´ä¸Šçš„ã€‚ baseé•œåƒåº•å±‚ä¼šç›´æ¥ä½¿ç”¨å®¿ä¸»ä¸»æœºçš„å†…æ ¸ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ çš„Ubuntuå†…æ ¸ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Œé‚£ä¹ˆbaseé•œåƒä¸­çš„CentOSå†…æ ¸ç‰ˆæœ¬å°±æ˜¯å¤šå°‘ï¼Œè€Œrootfsåˆ™å¯ä»¥åœ¨ä¸åŒçš„å®¹å™¨ä¸­è¿è¡Œå¤šç§ä¸åŒçš„ç‰ˆæœ¬ã€‚æ‰€ä»¥ï¼Œbaseé•œåƒå®é™…ä¸Šåªæœ‰CentOSçš„rootfsï¼Œå› æ­¤åªæœ‰300Må¤§å°å·¦å³ï¼Œå½“ç„¶ï¼ŒCentOSé‡Œé¢åŒ…å«å¤šç§åŸºç¡€çš„è½¯ä»¶ï¼Œè¿˜æ˜¯æ¯”è¾ƒè‡ƒè‚¿çš„ï¼Œè€ŒæŸäº›æ“ä½œç³»ç»Ÿçš„baseé•œåƒç”šè‡³éƒ½ä¸åˆ°10Mã€‚\nä½¿ç”¨unameå‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰å†…æ ¸ç‰ˆæœ¬ï¼š\nå› æ­¤ï¼ŒDockerèƒ½å¤ŸåŒæ—¶æ¨¡æ‹Ÿå¤šç§Linuxæ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œå°±ä¸è¶³ä¸ºå¥‡äº†ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å¯åŠ¨ä¸€ä¸‹åˆšåˆšä¸‹è½½çš„baseé•œåƒï¼š\ndocker run -it centos æ³¨æ„è¿™é‡Œéœ€è¦æ·»åŠ -itå‚æ•°è¿›è¡Œå¯åŠ¨ï¼Œå…¶ä¸­-iè¡¨ç¤ºåœ¨å®¹å™¨ä¸Šæ‰“å¼€ä¸€ä¸ªæ ‡å‡†çš„è¾“å…¥æ¥å£ï¼Œ-tè¡¨ç¤ºåˆ†é…ä¸€ä¸ªä¼ªttyè®¾å¤‡ï¼Œå¯ä»¥æ”¯æŒç»ˆç«¯ç™»å½•ï¼Œä¸€èˆ¬è¿™ä¸¤ä¸ªæ˜¯ä¸€èµ·ä½¿ç”¨ï¼Œå¦åˆ™baseå®¹å™¨å¯åŠ¨åå°±è‡ªåŠ¨åœæ­¢äº†ã€‚\nå¯ä»¥çœ‹åˆ°ä½¿ç”¨lså‘½ä»¤èƒ½å¤ŸæŸ¥çœ‹æ‰€æœ‰æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¸è¿‡å¾ˆå¤šå‘½ä»¤éƒ½æ²¡æœ‰ï¼Œè¿clearéƒ½æ²¡æœ‰ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å†…æ ¸ç‰ˆæœ¬ï¼š\nå¯ä»¥çœ‹åˆ°å†…æ ¸ç‰ˆæœ¬æ˜¯ä¸€æ ·çš„ï¼ˆè¿™ä¹Ÿæ˜¯ç¼ºç‚¹æ‰€åœ¨ï¼Œå¦‚æœè½¯ä»¶å¯¹å†…æ ¸ç‰ˆæœ¬æœ‰è¦æ±‚çš„è¯ï¼Œé‚£ä¹ˆæ­¤æ—¶ä½¿ç”¨Dockerå°±ç›´æ¥å¯„äº†ï¼‰ï¼Œæˆ‘ä»¬è¾“å…¥exitå°±å¯ä»¥é€€å‡ºå®¹å™¨ç»ˆç«¯äº†ï¼Œå¯ä»¥çœ‹åˆ°é€€å‡ºåå®¹å™¨ä¹Ÿåœæ­¢äº†ï¼š\nå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å†æ¬¡å¯åŠ¨ï¼Œæ³¨æ„å¯åŠ¨çš„æ—¶å€™è¦åŠ ä¸Š-iæ‰èƒ½è¿›å…¥åˆ°å®¹å™¨è¿›è¡Œäº¤äº’ï¼Œå¦åˆ™ä¼šåœ¨åå°è¿è¡Œï¼š\nåŸºäºbaseé•œåƒï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™åŸºç¡€ä¸Šå®‰è£…å„ç§å„æ ·çš„è½¯ä»¶çš„äº†ï¼Œå‡ ä¹æ‰€æœ‰çš„é•œåƒéƒ½æ˜¯é€šè¿‡åœ¨baseé•œåƒçš„åŸºç¡€ä¸Šå®‰è£…å’Œé…ç½®éœ€è¦çš„è½¯ä»¶æ„å»ºå‡ºæ¥çš„ï¼š\næ¯å®‰è£…ä¸€ä¸ªè½¯ä»¶ï¼Œå°±åœ¨baseé•œåƒä¸Šä¸€å±‚å±‚å åŠ ä¸Šå»ï¼Œé‡‡ç”¨çš„æ˜¯ä¸€ç§åˆ†å±‚çš„ç»“æ„ï¼Œè¿™æ ·å¤šä¸ªå®¹å™¨éƒ½å¯ä»¥å°†è¿™äº›ä¸åŒçš„å±‚æ¬¡è‡ªç”±æ‹¼è£…ï¼Œæ¯”å¦‚ç°åœ¨å¥½å‡ ä¸ªå®¹å™¨éƒ½éœ€è¦ä½¿ç”¨CentOSçš„baseé•œåƒï¼Œè€Œä¸Šé¢è¿è¡Œçš„è½¯ä»¶ä¸åŒï¼Œæ­¤æ—¶åˆ†å±‚ç»“æ„å°±å¾ˆçˆ½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æœ¬åœ°ä¿å­˜ä¸€ä»½baseé•œåƒï¼Œå°±å¯ä»¥ç»™å¤šä¸ªä¸åŒçš„å®¹å™¨æ‹¼è£…ä½¿ç”¨ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆçµæ´»ï¼Ÿ\næˆ‘ä»¬çœ‹åˆ°é™¤äº†è¿™äº›è½¯ä»¶ä¹‹å¤–ï¼Œæœ€ä¸Šå±‚è¿˜æœ‰ä¸€ä¸ªå¯å†™å®¹å™¨å±‚ï¼Œè¿™ä¸ªæ˜¯å¹²å˜›çš„å‘¢ï¼Œä¸ºä»€ä¹ˆè¦æ”¾åœ¨æœ€ä¸Šé¢ï¼Ÿ\næˆ‘ä»¬çŸ¥é“ï¼Œæ‰€æœ‰çš„é•œåƒä¼šå èµ·æ¥ç»„æˆä¸€ä¸ªç»Ÿä¸€çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚æœä¸åŒå±‚ä¸­å­˜åœ¨ç›¸åŒä½ç½®çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆä¸Šå±‚çš„ä¼šè¦†ç›–æ‰ä¸‹å±‚çš„æ–‡ä»¶ï¼Œæœ€ç»ˆæˆ‘ä»¬çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªå åŠ ä¹‹åçš„æ–‡ä»¶ç³»ç»Ÿã€‚å½“æˆ‘ä»¬éœ€è¦ä¿®æ”¹å®¹å™¨ä¸­çš„æ–‡ä»¶æ—¶ï¼Œå®é™…ä¸Šå¹¶ä¸ä¼šå¯¹é•œåƒè¿›è¡Œç›´æ¥ä¿®æ”¹ï¼Œè€Œæ˜¯åœ¨æœ€é¡¶ä¸Šçš„å®¹å™¨å±‚ï¼ˆæœ€ä¸Šé¢ä¸€èˆ¬ç§°ä¸ºå®¹å™¨å±‚ï¼Œä¸‹é¢éƒ½æ˜¯é•œåƒå±‚ï¼‰è¿›è¡Œä¿®æ”¹ï¼Œä¸ä¼šå½±å“åˆ°ä¸‹é¢çš„é•œåƒï¼Œå¦åˆ™é•œåƒå°±å¾ˆéš¾å®ç°å¤šä¸ªå®¹å™¨å…±äº«äº†ã€‚æ‰€ä»¥å„ä¸ªæ“ä½œå¦‚ä¸‹ï¼š\næ–‡ä»¶è¯»å–ï¼šè¦è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼ŒDockerä¼šæœ€ä¸Šå±‚å¾€ä¸‹ä¾æ¬¡å¯»æ‰¾ï¼Œæ‰¾åˆ°ååˆ™æ‰“å¼€æ–‡ä»¶ã€‚ æ–‡ä»¶åˆ›å»ºå’Œä¿®æ”¹ï¼šåˆ›å»ºæ–°æ–‡ä»¶ä¼šç›´æ¥æ·»åŠ åˆ°å®¹å™¨å±‚ä¸­ï¼Œä¿®æ”¹æ–‡ä»¶ä¼šä»ä¸Šå¾€ä¸‹ä¾æ¬¡å¯»æ‰¾å„ä¸ªé•œåƒä¸­çš„æ–‡ä»¶ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™å°†å…¶å¤åˆ¶åˆ°å®¹å™¨å±‚ï¼Œå†è¿›è¡Œä¿®æ”¹ã€‚ åˆ é™¤æ–‡ä»¶ï¼šåˆ é™¤æ–‡ä»¶ä¹Ÿä¼šä»ä¸Šå¾€ä¸‹ä¾æ¬¡å¯»æ‰¾å„ä¸ªé•œåƒä¸­çš„æ–‡ä»¶ï¼Œä¸€æ—¦æ‰¾åˆ°ï¼Œå¹¶ä¸ä¼šç›´æ¥åˆ é™¤é•œåƒä¸­çš„æ–‡ä»¶ï¼Œè€Œæ˜¯åœ¨å®¹å™¨å±‚æ ‡è®°è¿™ä¸ªåˆ é™¤æ“ä½œã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯¹æ•´ä¸ªå®¹å™¨å†…çš„æ–‡ä»¶è¿›è¡Œçš„æ“ä½œï¼Œå‡ ä¹éƒ½æ˜¯åœ¨æœ€ä¸Šé¢çš„å®¹å™¨å±‚è¿›è¡Œçš„ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•å¹²æ¶‰åˆ°ä¸‹é¢æ‰€æœ‰çš„é•œåƒå±‚æ–‡ä»¶çš„ï¼Œè¿™æ ·å°±å¾ˆå¥½åœ°ä¿æŠ¤äº†é•œåƒçš„å®Œæ•´æ€§ï¼Œæ‰èƒ½å®ç°å¤šä¸ªå®¹å™¨å…±äº«ä½¿ç”¨ã€‚\næ„å»ºé•œåƒ #\rå‰é¢æˆ‘ä»¬å·²ç»äº†è§£äº†Dockeré•œåƒçš„ç»“æ„ï¼Œå®é™…ä¸Šæ‰€æœ‰å¸¸ç”¨çš„åº”ç”¨ç¨‹åºéƒ½æœ‰å¯¹åº”çš„é•œåƒï¼Œæˆ‘ä»¬åªéœ€è¦ä¸‹è½½è¿™äº›é•œåƒç„¶åå°±å¯ä»¥ä½¿ç”¨äº†ï¼Œè€Œä¸éœ€è¦è‡ªå·±å»æ‰‹åŠ¨å®‰è£…ï¼Œé¡¶å¤šéœ€è¦è¿›è¡Œä¸€äº›ç‰¹åˆ«çš„é…ç½®ã€‚å½“ç„¶è¦æ˜¯é‡åˆ°æŸäº›å†·é—¨çš„åº”ç”¨ï¼Œå¯èƒ½æ²¡æœ‰æä¾›é•œåƒï¼Œè¿™æ—¶å°±è¦æˆ‘ä»¬æ‰‹åŠ¨å»å®‰è£…ï¼Œæ¥ç€æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•æ„å»ºæˆ‘ä»¬è‡ªå·±çš„Dockeré•œåƒã€‚æ„å»ºé•œåƒæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½¿ç”¨commitå‘½ä»¤æ¥å®Œæˆï¼Œè¿˜æœ‰ä¸€ç§æ˜¯ä½¿ç”¨Dockerfileæ¥å®Œæˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ç§ã€‚\nè¿™é‡Œæˆ‘ä»¬å°±åšä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨æƒ³è¦åœ¨Ubuntuçš„baseé•œåƒä¸­å®‰è£…Javaç¯å¢ƒï¼Œå¹¶å°†å…¶æ‰“åŒ…ä¸ºæ–°çš„é•œåƒï¼ˆè¿™ä¸ªæ–°çš„é•œåƒå°±æ˜¯ä¸€ä¸ªåŒ…å«Javaç¯å¢ƒçš„Ubuntuç³»ç»Ÿé•œåƒï¼‰\nå’±ä»¬å…ˆå¯åŠ¨Ubuntué•œåƒï¼Œç„¶åä½¿ç”¨yumå‘½ä»¤ï¼ˆè·Ÿaptæ¯”è¾ƒç±»ä¼¼ï¼‰æ¥å®‰è£…Javaç¯å¢ƒï¼Œé¦–å…ˆæ˜¯runå‘½ä»¤ï¼š\ndocker pull ubuntu æ¥ç€å¯åŠ¨ï¼š\nç›´æ¥ä½¿ç”¨aptå‘½ä»¤æ¥å®‰è£…Javaç¯å¢ƒï¼Œåœ¨è¿™ä¹‹å‰å…ˆæ›´æ–°ä¸€ä¸‹ï¼Œå› ä¸ºæ˜¯æœ€å°å®‰è£…æ‰€ä»¥æœ¬åœ°æ²¡æœ‰ä»»ä½•è½¯ä»¶åŒ…ï¼š\næ¥ç€è¾“å…¥ï¼š\napt install openjdk-8-jdk ç­‰å¾…å®‰è£…å®Œæˆï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å¯¹Javaç¯å¢ƒçš„å®‰è£…äº†ï¼Œæ¥ç€æˆ‘ä»¬å°±å¯ä»¥é€€å‡ºè¿™ä¸ªé•œåƒç„¶åå°†å…¶æ„å»ºä¸ºæ–°çš„é•œåƒï¼š\nä½¿ç”¨commitå‘½ä»¤å¯ä»¥å°†å®¹å™¨ä¿å­˜ä¸ºæ–°çš„é•œåƒï¼š\ndocker commit å®¹å™¨åç§°/ID æ–°çš„é•œåƒåç§° å¯ä»¥çœ‹åˆ°å®‰è£…äº†è½¯ä»¶ä¹‹åçš„é•œåƒå¤§å°æ¯”æˆ‘ä»¬åŸæœ‰çš„å¤§å°å¤§å¾—å¤šï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸ªé•œåƒæ¥ç›´æ¥å¯åŠ¨ä¸€ä¸ªå¸¦Javaç¯å¢ƒçš„Ubuntuæ“ä½œç³»ç»Ÿå®¹å™¨äº†ã€‚ä¸è¿‡è¿™ç§æ–¹å¼è™½ç„¶è‡ªå®šä¹‰åº¦å¾ˆé«˜ï¼Œä½†æ˜¯Dockerå®˜æ–¹å¹¶ä¸æ¨èï¼Œè¿™æ ·çš„è¯ä½¿ç”¨è€…å¹¶ä¸çŸ¥é“é•œåƒæ˜¯å¦‚ä½•æ„å»ºå‡ºæ¥çš„ï¼Œæ˜¯å¦é‡Œé¢å¸¦äº†åé—¨éƒ½ä¸çŸ¥é“ï¼Œå¹¶ä¸”è¿™æ ·å»æ„å»ºæ•ˆç‡å¤ªä½äº†ï¼Œå¦‚æœè¦åŒæ—¶æ„å»ºå¤šç§æ“ä½œç³»ç»Ÿçš„é•œåƒå²‚ä¸æ˜¯è¦ä¸€ä¸ªä¸€ä¸ªå»æ•²ï¼Ÿæˆ‘ä»¬ä½œä¸ºæ™®é€šç”¨æˆ·å®é™…ä¸Šé‡‡ç”¨Dokcerfileçš„æ–¹å¼ä¼šæ›´å¥½ä¸€äº›ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨Dockerfileçš„å½¢å¼åˆ›å»ºä¸€ä¸ªå¸¦Javaç¯å¢ƒçš„Ubuntuç³»ç»Ÿé•œåƒã€‚é¦–å…ˆç›´æ¥æ–°å»ºä¸€ä¸ªåä¸ºDockerfileçš„æ–‡ä»¶ï¼š\ntouch Dockerfile æ¥ç€æˆ‘ä»¬æ¥è¿›è¡Œç¼–è¾‘ï¼ŒDockerfileå†…éƒ¨éœ€è¦æˆ‘ä»¬ç¼–å†™å¤šç§æŒ‡ä»¤æ¥å‘Šè¯‰Dockeræˆ‘ä»¬çš„é•œåƒçš„ç›¸å…³ä¿¡æ¯ï¼š\nFROM \u0026lt;åŸºç¡€é•œåƒ\u0026gt; é¦–å…ˆæˆ‘ä»¬éœ€è¦ä½¿ç”¨FROMæŒ‡ä»¤æ¥é€‰æ‹©å½“å‰é•œåƒçš„åŸºç¡€é•œåƒï¼ˆå¿…é¡»ä»¥è¿™ä¸ªæŒ‡ä»¤å¼€å§‹ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ubuntuä½œä¸ºåŸºç¡€é•œåƒå³å¯ï¼Œå½“ç„¶å¦‚æœä¸éœ€è¦ä»»ä½•åŸºç¡€é•œåƒçš„è¯ï¼Œç›´æ¥ä½¿ç”¨scratchè¡¨ç¤ºä»é›¶å¼€å§‹æ„å»ºï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚\nåŸºç¡€é•œåƒè®¾å®šå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨å®¹å™¨ä¸­è¿è¡Œå‘½ä»¤æ¥å®‰è£…Javaç¯å¢ƒäº†ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨RUNæŒ‡ä»¤ï¼š\nRUN apt update RUN apt install -y openjdk-8-jdk æ¯æ¡æŒ‡ä»¤æ‰§è¡Œä¹‹åï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„é•œåƒå±‚ã€‚\nOKï¼Œç°åœ¨æˆ‘ä»¬çš„Dockerfileå°±ç¼–å†™å®Œæˆäº†ï¼Œåªéœ€è¦å®Œæˆä¸€æ¬¡æ„å»ºå³å¯ï¼š\ndocker build -t \u0026lt;é•œåƒåç§°\u0026gt; \u0026lt;æ„å»ºç›®å½•\u0026gt; æ‰§è¡Œåï¼ŒDockerä¼šåœ¨æ„å»ºç›®å½•ä¸­å¯»æ‰¾Dockerfileæ–‡ä»¶ï¼Œç„¶åå¼€å§‹ä¾æ¬¡æ‰§è¡ŒDockerfileä¸­çš„æŒ‡ä»¤ï¼š\næ„å»ºè¿‡ç¨‹çš„æ¯ä¸€æ­¥éƒ½éå¸¸æ¸…æ™°åœ°åˆ—å‡ºæ¥äº†ï¼Œä¸€å…±ä¸‰æ¡æŒ‡ä»¤å¯¹åº”ä¸‰æ­¥ä¾æ¬¡è¿›è¡Œï¼Œæˆ‘ä»¬ç¨å¾®ç­‰å¾…ä¸€æ®µæ—¶é—´è¿›è¡Œå®‰è£…ï¼Œå®‰è£…è¿‡ç¨‹ä¸­æ‰€ä»¥çš„æ—¥å¿—ä¿¡æ¯ä¼šç›´æ¥æ‰“å°åˆ°æ§åˆ¶å°ï¼ˆæ³¨æ„Dockeré•œåƒæ„å»ºæœ‰ç¼“å­˜æœºåˆ¶ï¼Œå°±ç®—ä½ ç°åœ¨ä¸­é€”é€€å‡ºäº†ï¼Œç„¶åé‡æ–°è¿›è¡Œæ„å»ºï¼Œä¹Ÿä¼šç›´æ¥å°†ä¹‹å‰å·²ç»æ„å»ºå¥½çš„æ¯ä¸€å±‚é•œåƒï¼Œç›´æ¥æ‹¿æ¥ç”¨ï¼Œé™¤éä¿®æ”¹äº†Dockerfileæ–‡ä»¶é‡æ–°æ„å»ºï¼Œåªè¦æŸä¸€å±‚å‘ç”Ÿå˜åŒ–å…¶ä¸Šå±‚çš„æ„å»ºç¼“å­˜éƒ½ä¼šå¤±æ•ˆï¼Œå½“ç„¶åŒ…æ‹¬pullæ—¶ä¹Ÿä¼šæœ‰ç±»ä¼¼çš„æœºåˆ¶ï¼‰\næœ€åæˆåŠŸå®‰è£…ï¼Œä¼šå‡ºç°åœ¨æœ¬åœ°ï¼š\nå¯ä»¥çœ‹åˆ°å®‰è£…å‡ºæ¥çš„å¤§å°è·Ÿæˆ‘ä»¬ä¹‹å‰çš„æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºåšçš„äº‹æƒ…æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨historyå‘½ä»¤æ¥æŸ¥çœ‹æ„å»ºå†å²ï¼š\nå¯ä»¥çœ‹åˆ°æœ€ä¸Šé¢ä¸¤å±‚æ˜¯æˆ‘ä»¬é€šè¿‡ä½¿ç”¨aptå‘½ä»¤ç”Ÿæˆçš„å†…å®¹ï¼Œå°±ç›´æ¥ä½œä¸ºå½“å‰é•œåƒä¸­çš„ä¸¤å±‚é•œåƒï¼Œæ¯å±‚é•œåƒéƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„IDï¼Œä¸åŒçš„é•œåƒå¤§å°ä¹Ÿä¸ä¸€æ ·ã€‚è€Œæˆ‘ä»¬æ‰‹åŠ¨é€šè¿‡commitå‘½ä»¤æ¥ç”Ÿæˆçš„é•œåƒæ²¡æœ‰è¿™ä¸ªè®°å½•ï¼š\nå¦‚æœé‡åˆ°é•œåƒIDä¸ºmissingçš„ä¸€èˆ¬æ˜¯ä»Docker Hubä¸­ä¸‹è½½çš„é•œåƒä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§ã€‚ç”¨æˆ‘ä»¬è‡ªå·±æ„å»ºçš„é•œåƒæ¥åˆ›å»ºå®¹å™¨å°±å¯ä»¥ç›´æ¥ä½“éªŒå¸¦Javaç¯å¢ƒçš„å®¹å™¨äº†ï¼š\næœ‰å…³Dockerfileçš„å…¶ä»–å‘½ä»¤ï¼Œæˆ‘ä»¬è¿˜ä¼šåœ¨åç»­çš„å­¦ä¹ ä¸­é€æ­¥è®¤è¯†ã€‚\nå‘å¸ƒé•œåƒåˆ°è¿œç¨‹ä»“åº“ #\rå‰é¢æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ„å»ºä¸€ä¸ªDockeré•œåƒï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªå·±çš„é•œåƒå‘å¸ƒåˆ°Docker Hubä¸­ï¼Œå°±åƒGitè¿œç¨‹ä»“åº“ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªå·±çš„é•œåƒä¸Šä¼ åˆ°è¿™é‡Œï¼šhttps://hub.docker.com/repositoriesï¼Œæ²¡æœ‰è´¦å·çš„å…ˆå»è¿›è¡Œæ³¨å†Œã€‚\nç‚¹å‡»å³ä¸Šè§’çš„åˆ›å»ºä»“åº“ï¼Œç„¶åå¡«å†™ä¿¡æ¯ï¼š\nåˆ›å»ºå®Œæˆåï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå…¬å…±çš„é•œåƒä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ¬åœ°çš„é•œåƒä¸Šä¼ äº†ï¼Œä¸Šä¼ ä¹‹å‰æˆ‘ä»¬éœ€è¦å°†é•œåƒåç§°ä¿®æ”¹å¾—è§„èŒƒä¸€ç‚¹ï¼Œè¿™é‡Œä½¿ç”¨tagå‘½ä»¤æ¥é‡æ–°æ‰“æ ‡ç­¾ï¼š\ndocker tag ubuntu-java-file:latest ç”¨æˆ·å/ä»“åº“åç§°:ç‰ˆæœ¬ è¿™é‡Œæˆ‘ä»¬å°†ç‰ˆæœ¬æ”¹æˆ1.0ç‰ˆæœ¬å§ï¼Œä¸ç”¨é»˜è®¤çš„latestäº†ã€‚\nä¿®æ”¹å®Œæˆåï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬åœ°é•œåƒï¼Œåç§°å°±æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„äº†ã€‚æ¥ç€æˆ‘ä»¬éœ€åœ¨æœ¬åœ°ç™»å½•ä¸€ä¸‹ï¼š\nç™»å½•æˆåŠŸåæˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ äº†ï¼š\ndocker push nagocoler/ubuntu-java:1.0 å“ˆå“ˆï¼Œ500Mçš„ä¸œè¥¿ä¼ ä¸Šå»ï¼Œè¿˜æ˜¯æœ‰ç‚¹å‹åŠ›çš„ï¼Œå¦‚æœå®åœ¨å¤ªæ…¢å„ä½å¯ä»¥é‡æ–°åšä¸€ä¸ªç®€å•ç‚¹çš„é•œåƒã€‚ä¸Šä¼ å®Œæˆåï¼Œæ‰“å¼€ä»“åº“ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸€ä¸ª1.0ç‰ˆæœ¬äº†ï¼š\næ³¨æ„å…¬å…±ä»“åº“æ˜¯å¯ä»¥è¢«æœç´¢å’Œä¸‹è½½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡ŒæŠŠæœ¬åœ°çš„é•œåƒå…¨éƒ¨åˆ æ‰ï¼Œå»ä¸‹è½½æˆ‘ä»¬åˆšåˆšä¸Šä¼ å¥½çš„é•œåƒã€‚è¿™é‡Œæˆ‘ä»¬å…ˆæœç´¢ä¸€ä¸‹ï¼Œæœç´¢ä½¿ç”¨searchå‘½ä»¤å³å¯ï¼š\ndocker search nagocoler/ubuntu-java æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pullå‘½ä»¤å°†å…¶ä¸‹è½½ä¸‹æ¥ï¼š\ndocker pull nagocoler/ubuntu-java:1.0 ä¸Šä¼ ä¹‹åçš„é•œåƒæ˜¯è¢«å‹ç¼©è¿‡çš„ï¼Œæ‰€ä»¥ä¸‹è½½çš„å†…å®¹å°±æ¯”è¾ƒå°‘ä¸€äº›ã€‚è¿è¡Œè¯•è¯•çœ‹ï¼š\nå½“ç„¶å„ä½ä¹Ÿå¯ä»¥è®©è‡ªå·±çš„åŒå­¦æˆ–æ˜¯åœ¨å…¶ä»–æœºå™¨ä¸Šå°è¯•ä¸‹è½½è‡ªå·±çš„é•œåƒï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯éƒ½å¯ä»¥æ­£å¸¸è¿è¡Œã€‚\nDocker Hubä¹Ÿå¯ä»¥è‡ªè¡Œæ­å»ºç§æœï¼Œä½†æ˜¯è¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ï¼Œè‡³æ­¤ï¼Œæœ‰å…³å®¹å™¨å’Œé•œåƒçš„ä¸€äº›åŸºæœ¬æ“ä½œå°±è®²è§£å¾—å·®ä¸å¤šäº†ã€‚\nå®æˆ˜ï¼šä½¿ç”¨IDEAæ„å»ºSpringBootç¨‹åºé•œåƒ #\rè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„SpringBooté¡¹ç›®ï¼Œç°åœ¨æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä½¿ç”¨Dockerå¿«é€Ÿåœ°å°†æˆ‘ä»¬çš„SpringBooté¡¹ç›®éƒ¨ç½²åˆ°å®‰è£…äº†Dockerçš„æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶æ‰“åŒ…ä¸ºä¸€ä¸ªDockeré•œåƒã€‚\nå…ˆåˆ›å»ºå¥½ä¸€ä¸ªé¡¹ç›®è®©å®ƒè·‘èµ·æ¥ï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œå°±æ²¡é—®é¢˜äº†ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦å°†å…¶æ‰“åŒ…ä¸ºDockeré•œåƒï¼Œè¿™é‡Œåˆ›å»ºä¸€ä¸ªæ–°çš„Dockerfileï¼š\nFROM ubuntu RUN apt update \u0026amp;\u0026amp; apt install -y openjdk-8-jdk é¦–å…ˆè¿˜æ˜¯åŸºäºubuntuæ„å»ºä¸€ä¸ªå¸¦Javaç¯å¢ƒçš„ç³»ç»Ÿé•œåƒï¼Œæ¥ç€æˆ‘ä»¬å…ˆå°†å…¶è¿æ¥åˆ°æˆ‘ä»¬çš„DockeræœåŠ¡å™¨è¿›è¡Œæ„å»ºï¼Œç”±äºIDEAè‡ªå¸¦äº†Dockeræ’ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç‚¹å‡»å·¦ä¸Šè§’çš„è¿è¡ŒæŒ‰é’®ï¼Œé€‰æ‹©ç¬¬äºŒé¡¹ â€œä¸ºDockerfileæ„å»ºé•œåƒâ€ï¼š\nè¿™é‡Œéœ€è¦é…ç½®Dockerçš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨UbuntuæœåŠ¡å™¨å®‰è£…çš„Dockerï¼Œè¿™é‡Œæˆ‘ä»¬å¡«å†™æœåŠ¡å™¨ç›¸å…³ä¿¡æ¯ï¼Œæˆ‘ä»¬é¦–é€‰éœ€è¦å»ä¿®æ”¹ä¸€ä¸‹Dockerçš„ä¸€äº›é…ç½®ï¼Œå¼€å¯è¿œç¨‹å®¢æˆ·ç«¯è®¿é—®ï¼š\nsudo vim /etc/systemd/system/multi-user.target.wants/docker.service æ‰“å¼€åï¼Œæ·»åŠ é«˜äº®éƒ¨åˆ†ï¼š\nä¿®æ”¹å®Œæˆåï¼Œé‡å¯DockeræœåŠ¡ï¼Œå¦‚æœæ˜¯äº‘æœåŠ¡å™¨ï¼Œè®°å¾—å¼€å¯2375 TCPè¿æ¥ç«¯å£ï¼š\nsudo systemctl daemon-reload sudo systemctl restart docker.service ç°åœ¨æ¥ç€åœ¨IDEAä¸­è¿›è¡Œé…ç½®ï¼š\nåœ¨å¼•æ“API URLå¤„å¡«å†™æˆ‘ä»¬DockeræœåŠ¡å™¨çš„IPåœ°å€ï¼š\ntcp://IP:2375 æ˜¾ç¤ºè¿æ¥æˆåŠŸåï¼Œè¡¨ç¤ºé…ç½®æ­£ç¡®ï¼Œç‚¹å‡»ä¿å­˜å³å¯ï¼Œæ¥ç€å°±å¼€å§‹åœ¨æˆ‘ä»¬çš„DockeræœåŠ¡å™¨ä¸Šè¿›è¡Œæ„å»ºäº†ï¼š\næœ€åæˆåŠŸæ„å»ºï¼š\nå¯ä»¥çœ‹åˆ°ï¼ŒDockeræœåŠ¡å™¨ä¸Šå·²ç»æœ‰äº†æˆ‘ä»¬åˆšåˆšæ„å»ºå¥½çš„é•œåƒï¼š\nä¸è¿‡åç§°æ²¡æœ‰æŒ‡å®šï¼Œè¿™é‡Œæˆ‘ä»¬é‡æ–°é…ç½®ä¸€ä¸‹ï¼š\né‡æ–°è¿›è¡Œæ„å»ºï¼Œå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„åç§°äº†ï¼š\næˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå®¹å™¨è¯•è¯•çœ‹ï¼š\nå¥½äº†ï¼Œç°åœ¨åŸºæœ¬ç¯å¢ƒæ­å»ºå¥½äº†ï¼Œæˆ‘ä»¬æ¥ç€å°±éœ€è¦å°†æˆ‘ä»¬çš„SpringBooté¡¹ç›®æ‰“åŒ…ç„¶åå†å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œäº†ï¼Œæ‰“å¼€Mavenæ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼š\næ¥ç€æˆ‘ä»¬éœ€è¦ç¼–è¾‘Dockerfileï¼Œå°†æˆ‘ä»¬æ„å»ºå¥½çš„jaråŒ…æ”¾è¿›å»ï¼š\nCOPY target/DockerTest-0.0.1-SNAPSHOT.jar app.jar è¿™é‡Œéœ€è¦ä½¿ç”¨COPYå‘½ä»¤æ¥å°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬è¦æ‹·è´çš„æœ¬åœ°æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­˜æ”¾åœ¨Dockeré•œåƒä¸­çš„æ–‡ä»¶ä½ç½®ï¼Œç”±äºè¿˜æ²¡æœ‰å­¦ä¹ å­˜å‚¨ç®¡ç†ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥è¾“å…¥app.jarç›´æ¥ä¿å­˜åœ¨é»˜è®¤è·¯å¾„å³å¯ã€‚\næ¥ç€æˆ‘ä»¬å°±éœ€è¦æŒ‡å®šåœ¨å¯åŠ¨æ—¶è¿è¡Œæˆ‘ä»¬çš„Javaç¨‹åºï¼Œè¿™é‡Œä½¿ç”¨CMDå‘½ä»¤æ¥å®Œæˆï¼š\nFROM ubuntu RUN apt update \u0026amp;\u0026amp; apt install -y openjdk-8-jdk COPY target/DockerTest-0.0.1-SNAPSHOT.jar app.jar CMD java -jar app.jar # EXPOSE 8080 CMDå‘½ä»¤å¯ä»¥è®¾å®šå®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤ï¼ŒEXPOSEå¯ä»¥æŒ‡å®šå®¹å™¨éœ€è¦æš´éœ²çš„ç«¯å£ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬è¿˜æ²¡æœ‰å­¦ä¹ ç½‘ç»œç›¸å…³çš„çŸ¥è¯†ï¼Œæ‰€ä»¥æš‚æ—¶ä¸ä½¿ç”¨ï¼Œè¿™é‡ŒæŒ‡å®šä¸ºæˆ‘ä»¬å¯åŠ¨Javaé¡¹ç›®çš„å‘½ä»¤ã€‚é…ç½®å®Œæˆåï¼Œé‡æ–°æ„å»ºï¼š\nå¯ä»¥çœ‹åˆ°å†å²ä¸­å·²ç»å‡ºç°æ–°çš„æ­¥éª¤äº†ï¼š\næ¥ç€å¯åŠ¨æˆ‘ä»¬çš„é•œåƒï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨IDEAä¸­è¿›è¡Œæ“ä½œï¼Œä¸ç”¨å†å»æ•²å‘½ä»¤äº†ï¼Œæœ‰ç‚¹ç´¯ï¼š\nå¯åŠ¨åå¯ä»¥åœ¨å³ä¾§çœ‹åˆ°å®¹å™¨å¯åŠ¨çš„æ—¥å¿—ä¿¡æ¯ï¼š\nä½†æ˜¯æˆ‘ä»¬å‘ç°å¯åŠ¨ä¹‹åå¹¶ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºå®¹å™¨å†…éƒ¨çš„ç½‘ç»œå’Œå¤–éƒ¨ç½‘ç»œæ˜¯éš”ç¦»çš„ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦è®¿é—®å®¹å™¨å†…çš„æœåŠ¡å™¨ï¼Œéœ€è¦å°†å¯¹åº”ç«¯å£ç»‘å®šåˆ°å®¿ä¸»æœºä¸Šï¼Œè®©å®¿ä¸»ä¸»æœºä¹Ÿå¼€å¯è¿™ä¸ªç«¯å£ï¼Œè¿™æ ·æ‰èƒ½è¿æ¥åˆ°å®¹å™¨å†…ï¼š\ndocker run -p 8080:8080 -d springboot-test:1.0 è¿™é‡Œ-pè¡¨ç¤ºç«¯å£ç»‘å®šï¼Œå°†Dockerå®¹å™¨å†…çš„ç«¯å£ç»‘å®šåˆ°å®¿ä¸»æœºçš„ç«¯å£ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡å®¿ä¸»çš„8080ç«¯å£è®¿é—®åˆ°å®¹å™¨çš„8080ç«¯å£äº†ï¼ˆæœ‰å…³å®¹å™¨ç½‘ç»œç®¡ç†æˆ‘ä»¬è¿˜ä¼šåœ¨åé¢è¿›è¡Œè¯¦ç»†ä»‹ç»ï¼‰ï¼Œ-då‚æ•°è¡¨ç¤ºåå°è¿è¡Œï¼Œå½“ç„¶ç›´æ¥åœ¨IDEAä¸­é…ç½®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š\né…ç½®å¥½åï¼Œç‚¹å‡»é‡æ–°åˆ›å»ºå®¹å™¨ï¼š\né‡æ–°è¿è¡Œåï¼Œæˆ‘ä»¬å°±å¯ä»¥æˆåŠŸè®¿é—®åˆ°å®¹å™¨ä¸­è¿è¡Œçš„SpringBooté¡¹ç›®äº†ï¼š\nå½“ç„¶ï¼Œä¸ºäº†ä»¥åæ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å…¶æ¨é€åˆ°Docker Hubä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å…¬å¼€ä»“åº“ï¼š\nè¿™æ¬¡æˆ‘ä»¬å°±ä½¿ç”¨IDEAæ¥æ¼”ç¤ºç›´æ¥è¿›è¡Œé•œåƒçš„ä¸Šä¼ ï¼Œç›´æ¥ç‚¹å‡»ï¼š\næ¥ç€æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹æˆ‘ä»¬çš„Docker Hubç›¸å…³ä¿¡æ¯ï¼š\nOKï¼Œè¿œç¨‹é•œåƒä»“åº“é…ç½®å®Œæˆï¼Œç›´æ¥æ¨é€å³å¯ï¼Œç­‰å¾…æ¨é€å®Œæˆã€‚\nå¯ä»¥çœ‹åˆ°è¿œç¨‹ä»“åº“ä¸­å·²ç»å‡ºç°äº†æˆ‘ä»¬çš„é•œåƒï¼Œç„¶åIDEAä¸­ä¹Ÿå¯ä»¥åŒæ­¥çœ‹åˆ°ï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä½¿ç”¨IDEAå°†SpringBooté¡¹ç›®æ‰“åŒ…ä¸ºDockeré•œåƒã€‚\nå®¹å™¨ç½‘ç»œç®¡ç† #\r**æ³¨æ„ï¼š**æœ¬å°èŠ‚å­¦ä¹ éœ€è¦æŒæ¡éƒ¨åˆ†ã€Šè®¡ç®—æœºç½‘ç»œã€‹è¯¾ç¨‹ä¸­çš„çŸ¥è¯†ã€‚\nå‰é¢æˆ‘ä»¬å­¦ä¹ äº†å®¹å™¨å’Œé•œåƒçš„ä¸€äº›åŸºæœ¬æ“ä½œï¼Œäº†è§£äº†å¦‚ä½•é€šè¿‡é•œåƒåˆ›å»ºå®¹å™¨ã€ç„¶åè‡ªå·±æ„å»ºå®¹å™¨ï¼Œä»¥åŠè¿œç¨‹ä»“åº“æ¨é€ç­‰ï¼Œè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬æ¥ç€æ¥è®¨è®ºå®¹å™¨çš„ç½‘ç»œç®¡ç†ã€‚\nå®¹å™¨ç½‘ç»œç±»å‹ #\rDockeråœ¨å®‰è£…åï¼Œä¼šåœ¨æˆ‘ä»¬çš„ä¸»æœºä¸Šåˆ›å»ºä¸‰ä¸ªç½‘ç»œï¼Œä½¿ç”¨network lså‘½ä»¤æ¥æŸ¥çœ‹ï¼š\ndocker network ls å¯ä»¥çœ‹åˆ°é»˜è®¤æƒ…å†µä¸‹æœ‰bridgeã€hostã€noneè¿™ä¸‰ç§ç½‘ç»œç±»å‹ï¼ˆå…¶å®æœ‰ç‚¹åƒè™šæ‹Ÿæœºçš„ç½‘ç»œé…ç½®ï¼Œä¹Ÿæ˜¯åˆ†æ¡¥æ¥ã€å…±äº«ç½‘ç»œä¹‹ç±»çš„ï¼‰ï¼Œæˆ‘ä»¬å…ˆæ¥ä¾æ¬¡ä»‹ç»ä¸€ä¸‹ï¼Œåœ¨å¼€å§‹ä¹‹å‰æˆ‘ä»¬å…ˆæ„å»ºä¸€ä¸ªé•œåƒï¼Œé»˜è®¤çš„ubuntué•œåƒç”±äºå•¥è½¯ä»¶éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠä¸€ä¼šç½‘ç»œè¦ç”¨åˆ°çš„å…ˆæå‰è£…å¥½ï¼š\ndocker run -it ubuntu apt update apt install net-tools iputils-ping curl è¿™æ ·å°±å®‰è£…å¥½äº†ï¼Œæˆ‘ä»¬ç›´æ¥é€€å‡ºç„¶åå°†å…¶æ„å»ºä¸ºæ–°çš„é•œåƒï¼š\ndocker commit lucid_sammet ubuntu-net OKï¼Œä¸€ä¼šæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨äº†ã€‚\n**noneç½‘ç»œï¼š**è¿™ä¸ªç½‘ç»œé™¤äº†æœ‰ä¸€ä¸ªæœ¬åœ°ç¯å›ç½‘ç»œä¹‹å¤–ï¼Œå°±æ²¡æœ‰å…¶ä»–çš„ç½‘ç»œäº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºå®¹å™¨æ—¶æŒ‡å®šè¿™ä¸ªç½‘ç»œã€‚\nè¿™é‡Œä½¿ç”¨--networkå‚æ•°æ¥æŒ‡å®šç½‘ç»œï¼š\ndocker run -it --network=none ubuntu-net è¿›å…¥ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹ä¸€ä¸‹å½“å‰çš„ç½‘ç»œï¼š\nifconfig å¯ä»¥çœ‹åˆ°åªæœ‰ä¸€ä¸ªæœ¬åœ°ç¯å›loç½‘ç»œè®¾å¤‡ï¼š\næ‰€ä»¥è¿™ä¸ªå®¹å™¨æ˜¯æ— æ³•è¿æ¥åˆ°äº’è”ç½‘çš„ï¼š\nâ€œçœŸâ€å•æœºè¿è¡Œï¼Œå¯ä»¥è¯´æ˜¯ç»å¯¹çš„å®‰å…¨ï¼Œæ²¡äººèƒ½è®¿é—®è¿›å»ï¼Œå­˜ç‚¹å¯†ç è¿™äº›è¿˜æ˜¯ä¸é”™çš„ã€‚\n**bridgeç½‘ç»œï¼š**å®¹å™¨é»˜è®¤ä½¿ç”¨çš„ç½‘ç»œç±»å‹ï¼Œè¿™æ˜¯æ¡¥æ¥ç½‘ç»œï¼Œä¹Ÿæ˜¯åº”ç”¨æœ€å¹¿æ³›çš„ç½‘ç»œç±»å‹ï¼š\nå®é™…ä¸Šæˆ‘ä»¬åœ¨å®¿ä¸»ä¸»æœºä¸ŠæŸ¥çœ‹ç½‘ç»œä¿¡æ¯ï¼Œä¼šå‘ç°æœ‰ä¸€ä¸ªåä¸ºdocker0çš„ç½‘ç»œè®¾å¤‡ï¼š\nè¿™ä¸ªç½‘ç»œè®¾å¤‡æ˜¯Dockerå®‰è£…æ—¶è‡ªåŠ¨åˆ›å»ºçš„è™šæ‹Ÿè®¾å¤‡ï¼Œå®ƒæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸‹é»˜è®¤åˆ›å»ºçš„å®¹å™¨å†…éƒ¨çš„æƒ…å†µï¼š\ndocker run -it ubuntu-net å¯ä»¥çœ‹åˆ°å®¹å™¨çš„ç½‘ç»œæ¥å£åœ°å€ä¸º172.17.0.2ï¼Œå®é™…ä¸Šè¿™æ˜¯Dockeråˆ›å»ºçš„è™šæ‹Ÿç½‘ç»œï¼Œå°±åƒå®¹å™¨å•ç‹¬æ’äº†ä¸€æ ¹è™šæ‹Ÿçš„ç½‘çº¿ï¼Œè¿æ¥åˆ°Dockeråˆ›å»ºçš„è™šæ‹Ÿç½‘ç»œä¸Šï¼Œè€Œdocker0ç½‘ç»œå®é™…ä¸Šä½œä¸ºä¸€ä¸ªæ¡¥æ¥çš„è§’è‰²ï¼Œä¸€å¤´æ˜¯è‡ªå·±çš„è™šæ‹Ÿå­ç½‘ï¼Œå¦ä¸€å¤´æ˜¯å®¿ä¸»ä¸»æœºçš„ç½‘ç»œã€‚\nç½‘ç»œæ‹“æ‰‘ç±»ä¼¼äºä¸‹é¢è¿™æ ·ï¼š\né€šè¿‡æ·»åŠ è¿™æ ·çš„ç½‘æ¡¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å®¹å™¨çš„ç½‘ç»œè¿›è¡Œç®¡ç†å’Œæ§åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨network inspectå‘½ä»¤æ¥æŸ¥çœ‹docker0ç½‘æ¡¥çš„é…ç½®ä¿¡æ¯ï¼š\ndocker network inspect bridge è¿™é‡Œçš„é…ç½®çš„å­ç½‘æ˜¯172.17.0.0ï¼Œå­ç½‘æ©ç æ˜¯255.255.0.0ï¼Œç½‘å…³æ˜¯172.17.0.1ï¼Œä¹Ÿå°±æ˜¯docker0è¿™ä¸ªè™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šé¢åˆ›å»ºçš„å®¹å™¨å°±æ˜¯è¿™ä¸ªå­ç½‘å†…åˆ†é…çš„åœ°å€172.17.0.2äº†ã€‚\nä¹‹åæˆ‘ä»¬è¿˜ä¼šè®²è§£å¦‚ä½•ç®¡ç†å’Œæ§åˆ¶å®¹å™¨ç½‘ç»œã€‚\n**hostç½‘ç»œï¼š**å½“å®¹å™¨è¿æ¥åˆ°æ­¤ç½‘ç»œåï¼Œä¼šå…±äº«å®¿ä¸»ä¸»æœºçš„ç½‘ç»œï¼Œç½‘ç»œé…ç½®ä¹Ÿæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼š\ndocker run -it --network=host ubuntu-net å¯ä»¥çœ‹åˆ°ç½‘ç»œåˆ—è¡¨å’Œå®¿ä¸»ä¸»æœºçš„åˆ—è¡¨æ˜¯ä¸€æ ·çš„ï¼Œä¸çŸ¥é“å„ä½æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œè¿hostnameéƒ½æ˜¯å’Œå¤–é¢ä¸€æ¨¡ä¸€æ ·çš„ï¼š\nåªè¦å®¿ä¸»ä¸»æœºèƒ½è¿æ¥åˆ°äº’è”ç½‘ï¼Œå®¹å™¨å†…éƒ¨ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ï¼š\nè¿™æ ·çš„è¯ï¼Œç›´æ¥ä½¿ç”¨å®¿ä¸»çš„ç½‘ç»œï¼Œä¼ è¾“æ€§èƒ½åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆæŠ˜æŸï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥ç›´æ¥å¼€æ”¾ç«¯å£ç­‰ï¼Œä¸éœ€è¦è¿›è¡Œä»»ä½•çš„æ¡¥æ¥ï¼š\napt install -y systemctl nginx systemctl start nginx å®‰è£…Nginxä¹‹åç›´æ¥å°±å¯ä»¥è®¿é—®äº†ï¼Œä¸éœ€è¦å¼€æ”¾ä»€ä¹ˆç«¯å£ï¼š\nç›¸æ¯”æ¡¥æ¥ç½‘ç»œå°±æ–¹ä¾¿å¾—å¤šäº†ã€‚\næˆ‘ä»¬å¯ä»¥æ ¹æ®å®é™…æƒ…å†µï¼Œæ¥åˆç†åœ°é€‰æ‹©è¿™ä¸‰ç§ç½‘ç»œä½¿ç”¨ã€‚\nç”¨æˆ·è‡ªå®šä¹‰ç½‘ç»œ #\ré™¤äº†å‰é¢æˆ‘ä»¬ä»‹ç»çš„ä¸‰ç§ç½‘ç»œä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„ç½‘ç»œï¼Œè®©å®¹å™¨è¿æ¥åˆ°è¿™ä¸ªç½‘ç»œã€‚\nDockeré»˜è®¤æä¾›ä¸‰ç§ç½‘ç»œé©±åŠ¨ï¼šbridgeã€overlayã€macvlanï¼Œä¸åŒçš„é©±åŠ¨å¯¹åº”ç€ä¸åŒçš„ç½‘ç»œè®¾å¤‡é©±åŠ¨ï¼Œå®ç°çš„åŠŸèƒ½ä¹Ÿä¸ä¸€æ ·ï¼Œæ¯”å¦‚bridgeç±»å‹çš„ï¼Œå…¶å®å°±å’Œæˆ‘ä»¬å‰é¢ä»‹ç»çš„æ¡¥æ¥ç½‘ç»œæ˜¯ä¸€æ ·çš„ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨network createæ¥è¯•è¯•çœ‹ï¼š\ndocker network create --driver bridge test è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ¡¥æ¥ç½‘ç»œï¼Œåç§°ä¸ºtestï¼š\nå¯ä»¥çœ‹åˆ°æ–°å¢äº†ä¸€ä¸ªç½‘ç»œè®¾å¤‡ï¼Œè¿™ä¸ªå°±æ˜¯ä¸€ä¼šè´Ÿè´£æˆ‘ä»¬å®¹å™¨ç½‘ç»œçš„ç½‘å…³äº†ï¼Œå’Œä¹‹å‰çš„docker0æ˜¯ä¸€æ ·çš„ï¼š\ndocker network inspect test è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œä½¿ç”¨æ­¤ç½‘ç»œï¼š\ndocker run -it --network=test ubuntu-net æˆåŠŸå¾—åˆ°åˆ†é…çš„IPåœ°å€ï¼Œæ˜¯åœ¨è¿™ä¸ªç½‘ç»œå†…çš„ï¼Œæ³¨æ„ä¸åŒçš„ç½‘ç»œä¹‹é—´æ˜¯éš”ç¦»çš„ï¼Œæˆ‘ä»¬å¯ä»¥å†åˆ›å»ºä¸€ä¸ªå®¹å™¨è¯•è¯•çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°ä¸åŒçš„ç½‘ç»œæ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œæ— æ³•è¿›è¡Œé€šä¿¡ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿä¸ºæ­¤å®¹å™¨è¿æ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨æ‰€å±çš„ç½‘ç»œä¸‹ï¼š\ndocker network connect test å®¹å™¨ID/åç§° è¿™æ ·å°±è¿æ¥äº†ä¸€ä¸ªæ–°çš„ç½‘ç»œï¼š\nå¯ä»¥çœ‹åˆ°å®¹å™¨ä¸­æ–°å¢äº†ä¸€ä¸ªç½‘ç»œè®¾å¤‡è¿æ¥åˆ°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç½‘ç»œä¸­ï¼Œç°åœ¨è¿™ä¸¤ä¸ªå®¹å™¨åœ¨åŒä¸€ä¸ªç½‘ç»œä¸‹ï¼Œå°±å¯ä»¥ç›¸äº’pingäº†ï¼š è¿™é‡Œå°±ä¸ä»‹ç»å¦å¤–ä¸¤ç§ç±»å‹çš„ç½‘ç»œäº†ï¼Œä»–ä»¬æ˜¯ç”¨äºå¤šä¸»æœºé€šä¿¡çš„ï¼Œç›®å‰æˆ‘ä»¬åªå­¦ä¹ å•æœºä½¿ç”¨ã€‚\nå®¹å™¨é—´ç½‘ç»œ #\ræˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹å®¹å™¨å’Œå®¹å™¨ä¹‹é—´çš„ç½‘ç»œé€šä¿¡ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¹‹å‰å·²ç»æ¼”ç¤ºè¿‡pingçš„æƒ…å†µäº†ï¼Œç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªubuntuå®¹å™¨ï¼š\ndocker run -it ubuntu-net å…ˆè·å–å…¶ä¸­ä¸€ä¸ªå®¹å™¨çš„ç½‘ç»œä¿¡æ¯ï¼š\næˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å¦ä¸€ä¸ªå®¹å™¨ä¸­pingè¿™ä¸ªå®¹å™¨ï¼š\nå¯ä»¥çœ‹åˆ°èƒ½å¤Ÿç›´æ¥pingé€šï¼Œå› ä¸ºè¿™ä¸¤ä¸ªå®¹å™¨éƒ½æ˜¯ä½¿ç”¨çš„bridgeç½‘ç»œï¼Œåœ¨åŒä¸€ä¸ªå­ç½‘ä¸­ï¼Œæ‰€ä»¥å¯ä»¥äº’ç›¸è®¿é—®ã€‚\næˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡å®¹å™¨çš„IPåœ°å€åœ¨å®¹å™¨é—´è¿›è¡Œé€šä¿¡ï¼Œåªè¦ä¿è¯ä¸¤ä¸ªå®¹å™¨å¤„äºåŒä¸€ä¸ªç½‘ç»œä¸‹å³å¯ï¼Œè™½ç„¶è¿™æ ·æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå®¹å™¨éƒ¨ç½²ä¹‹åçš„IPåœ°å€æ˜¯è‡ªåŠ¨åˆ†é…çš„ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨--ipæ¥æ‰‹åŠ¨æŒ‡å®šï¼Œä½†æ˜¯è¿˜æ˜¯ä¸æ–¹ä¾¿ï¼‰ï¼Œæˆ‘ä»¬æ— æ³•æå‰å¾—çŸ¥IPåœ°å€ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç›´æ–¹æ³•èƒ½å¤Ÿæ›´çµæ´»ä¸€äº›å‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥å€ŸåŠ©Dockeræä¾›çš„DNSæœåŠ¡å™¨ï¼Œå®ƒå°±åƒæ˜¯ä¸€ä¸ªçœŸçš„DNSæœåŠ¡å™¨ä¸€æ ·ï¼Œèƒ½å¤Ÿå¯¹åŸŸåè¿›è¡Œè§£æï¼Œä½¿ç”¨å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å®¹å™¨å¯åŠ¨æ—¶ç»™ä¸ªåå­—å°±è¡Œäº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®è¿™ä¸ªåç§°ï¼Œæœ€åä¼šè¢«è§£æä¸ºå¯¹åº”å®¹å™¨çš„IPåœ°å€ï¼Œä½†æ˜¯æ³¨æ„åªä¼šåœ¨æˆ‘ä»¬ç”¨æˆ·è‡ªå®šä¹‰çš„ç½‘ç»œä¸‹ç”Ÿæ•ˆï¼Œé»˜è®¤çš„ç½‘ç»œæ˜¯ä¸è¡Œçš„ï¼š\ndocker run -it --name=test01 --network=test ubuntu-net docker run -it --name=test02 --network=test ubuntu-net æ¥ç€ç›´æ¥pingå¯¹æ–¹çš„åå­—å°±å¯ä»¥äº†ï¼š\nå¯ä»¥çœ‹åˆ°åç§°ä¼šè‡ªåŠ¨è§£æä¸ºå¯¹åº”çš„IPåœ°å€ï¼Œè¿™æ ·çš„è¯å°±ä¸ç”¨æ‹…å¿ƒIPä¸ç¡®å®šçš„é—®é¢˜äº†ã€‚\nå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è®©ä¸¤ä¸ªå®¹å™¨åŒæ—¶å…±äº«åŒä¸€ä¸ªç½‘ç»œï¼Œæ³¨æ„è¿™é‡Œçš„å…±äº«æ˜¯ç›´æ¥å…±äº«åŒä¸€ä¸ªç½‘ç»œè®¾å¤‡ï¼Œä¸¤ä¸ªå®¹å™¨å…±åŒä½¿ç”¨ä¸€ä¸ªIPåœ°å€ï¼Œåªéœ€è¦åœ¨åˆ›å»ºæ—¶æŒ‡å®šï¼š\ndocker run -it --name=test01 --network=container:test02 ubuntu-net è¿™é‡Œå°†ç½‘ç»œæŒ‡å®šä¸ºä¸€ä¸ªå®¹å™¨çš„ç½‘ç»œï¼Œè¿™æ ·ä¸¤ä¸ªå®¹å™¨ä½¿ç”¨çš„å°±æ˜¯åŒä¸€ä¸ªç½‘ç»œäº†ï¼š\nå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå®¹å™¨çš„IPåœ°å€å’Œç½‘å¡çš„Macåœ°å€æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œå®ƒä»¬çš„ç½‘ç»œç°åœ¨æ˜¯å…±äº«çŠ¶æ€ï¼Œæ­¤æ—¶åœ¨å®¹å™¨ä¸­è®¿é—®ï¼Œlocalhostï¼Œæ—¢æ˜¯è‡ªå·±ä¹Ÿæ˜¯åˆ«äººã€‚\næˆ‘ä»¬å¯ä»¥åœ¨å®¹å™¨1ä¸­ï¼Œå®‰è£…Nginxï¼Œç„¶åå†å®¹å™¨2ä¸­è®¿é—®ï¼š\napt install -y systemctl nginx systemctl start nginx æˆåŠŸè®¿é—®åˆ°å¦ä¸€ä¸ªå®¹å™¨ä¸­çš„NginxæœåŠ¡å™¨ã€‚\nå®¹å™¨å¤–éƒ¨ç½‘ç»œ #\rå‰é¢æˆ‘ä»¬ä»‹ç»äº†å®¹å™¨ä¹‹é—´çš„ç½‘ç»œé€šä¿¡ï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹å®¹å™¨ä¸å¤–éƒ¨ç½‘ç»œçš„é€šä¿¡ã€‚\né¦–å…ˆæˆ‘ä»¬æ¥çœ‹å®¹å™¨æ˜¯å¦‚ä½•è®¿é—®åˆ°äº’è”ç½‘çš„ï¼Œåœ¨é»˜è®¤çš„ä¸‰ç§çš„ç½‘ç»œä¸‹ï¼Œåªæœ‰å…±äº«æ¨¡å¼å’Œæ¡¥æ¥æ¨¡å¼å¯ä»¥è¿æ¥åˆ°å¤–ç½‘ï¼Œå…±äº«æ¨¡å¼å®é™…ä¸Šå°±æ˜¯ç›´æ¥ä½¿ç”¨å®¿ä¸»ä¸»æœºçš„ç½‘ç»œè®¾å¤‡è¿æ¥åˆ°äº’è”ç½‘ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦æ¥çœ‹ä¸€ä¸‹æ¡¥æ¥æ¨¡å¼ã€‚\né€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£åˆ°æ¡¥æ¥æ¨¡å¼å®é™…ä¸Šå°±æ˜¯åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„è™šæ‹Ÿç½‘ç»œï¼Œè®©å®¹å™¨åœ¨è¿™ä¸ªè™šæ‹Ÿç½‘ç»œä¸­ï¼Œç„¶åé€šè¿‡æ¡¥æ¥å™¨æ¥ä¸å¤–ç•Œç›¸è¿ï¼Œé‚£ä¹ˆæ•°æ®åŒ…æ˜¯å¦‚ä½•ä»å®¹å™¨å†…éƒ¨çš„ç½‘ç»œåˆ°è¾¾å®¿ä¸»ä¸»æœºå†å‘é€åˆ°äº’è”ç½‘çš„å‘¢ï¼Ÿå®é™…ä¸Šæ•´ä¸ªè¿‡ç¨‹ä¸­æœ€å…³é”®çš„å°±æ˜¯ä¾é NATï¼ˆNetwork Address Translationï¼‰å°†åœ°å€è¿›è¡Œè½¬æ¢ï¼Œå†åˆ©ç”¨å®¿ä¸»ä¸»æœºçš„IPåœ°å€å‘é€æ•°æ®åŒ…å‡ºå»ã€‚\nè¿™é‡Œæˆ‘ä»¬å°±æ¥è¡¥å……ä¸€ä¸‹ã€Šè®¡ç®—æœºç½‘ç»œã€‹è¯¾ç¨‹ä¸­å­¦ä¹ çš„NATï¼š\nå®é™…ä¸ŠNATåœ¨æˆ‘ä»¬ç”Ÿæ´»ä¸­ä¹Ÿæ˜¯ç»å¸¸è§åˆ°çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦è®¿é—®äº’è”ç½‘ä¸Šçš„æŸä¸ªèµ„æºï¼Œè¦å’ŒæœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œé‚£ä¹ˆå°±éœ€è¦å°†æ•°æ®åŒ…å‘é€å‡ºå»ï¼ŒåŒæ—¶æœåŠ¡å™¨ä¹Ÿè¦å°†æ•°æ®åŒ…å‘é€å›æ¥ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æœåŠ¡å™¨çš„IPåœ°å€ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å»è¿æ¥ï¼Œå› ä¸ºæœåŠ¡å™¨çš„IPåœ°å€æ˜¯æš´éœ²åœ¨äº’è”ç½‘ä¸Šçš„ï¼Œä½†æ˜¯æˆ‘ä»¬çš„å±€åŸŸç½‘å°±ä¸ä¸€æ ·äº†ï¼Œå®ƒä»…ä»…å±€é™åœ¨æˆ‘ä»¬çš„å®¶é‡Œï¼Œæ¯”å¦‚æˆ‘ä»¬è¿æ¥äº†å®¶é‡Œçš„è·¯ç”±å™¨ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªIPåœ°å€ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œè¿™ä¸ªIPå…¬ç½‘æ˜¯æ— æ³•ç›´æ¥è®¿é—®åˆ°æˆ‘ä»¬çš„ï¼Œå› ä¸ºè¿™ä¸ªIPåœ°å€ä»…ä»…æ˜¯ä¸€ä¸ªå±€åŸŸç½‘çš„IPåœ°å€ï¼Œä¿—ç§°å†…ç½‘IPï¼Œæ—¢ç„¶å…¬ç½‘æ— æ³•è®¿é—®åˆ°æˆ‘ä»¬ï¼Œé‚£æœåŠ¡å™¨æ˜¯å¦‚ä½•å°†æ•°æ®åŒ…å‘é€ç»™æˆ‘ä»¬çš„å‘¢ï¼Ÿ\nå®é™…ä¸Šè¿™é‡Œå°±å€ŸåŠ©äº†NATåœ¨å¸®åŠ©æˆ‘ä»¬ä¸äº’è”ç½‘ä¸Šçš„æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œé€šè¿‡NATï¼Œå¯ä»¥å®ç°å°†å±€åŸŸç½‘çš„IPåœ°å€ï¼Œæ˜ å°„ä¸ºå¯¹åº”çš„å…¬ç½‘IPåœ°å€ï¼Œè€ŒNATè®¾å¤‡ä¸€ç«¯è¿æ¥å¤–ç½‘ï¼Œå¦ä¸€ç«¯è¿æ¥å†…ç½‘çš„æ‰€æœ‰è®¾å¤‡ï¼Œå½“æˆ‘ä»¬æƒ³è¦ä¸å¤–ç½‘è¿›è¡Œé€šä¿¡æ—¶ï¼Œå°±å¯ä»¥å°†æ•°æ®åŒ…å‘é€ç»™NATè®¾å¤‡ï¼Œç”±å®ƒæ¥å°†æ•°æ®åŒ…çš„æºåœ°å€æ˜ å°„ä¸ºå®ƒåœ¨å¤–ç½‘ä¸Šçš„åœ°å€ï¼Œè¿™æ ·æœåŠ¡å™¨å°±èƒ½å¤Ÿå‘ç°å®ƒäº†ï¼Œèƒ½å¤Ÿç›´æ¥ä¸å®ƒå»ºç«‹é€šä¿¡ã€‚å½“æœåŠ¡å™¨å‘é€æ•°æ®å›æ¥æ—¶ï¼Œä¹Ÿæ˜¯ç›´æ¥äº¤ç»™NATè®¾å¤‡ï¼Œç„¶åå†æ ¹æ®åœ°å€æ˜ å°„ï¼Œè½¬å‘ç»™å¯¹åº”çš„å†…ç½‘è®¾å¤‡ï¼ˆå½“ç„¶ç”±äºå…¬ç½‘IPåœ°å€æœ‰é™ï¼Œæ‰€ä»¥ä¸€èˆ¬é‡‡ç”¨IP+ç«¯å£ç»“åˆä½¿ç”¨çš„å½¢å¼ANPTï¼‰\næ‰€ä»¥ä½ æ‰“å¼€ç™¾åº¦ç›´æ¥æœIPï¼Œä¼šå‘ç°è¿™ä¸ªIPåœ°å€å¹¶ä¸æ˜¯ä½ æœ¬åœ°çš„ï¼Œè€Œæ˜¯NATè®¾å¤‡çš„å…¬ç½‘åœ°å€ï¼š\nå®é™…ä¸Šæˆ‘ä»¬å®¶é‡Œçš„è·¯ç”±å™¨ä¸€èˆ¬éƒ½å¸¦æœ‰NATåŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯NATæ¨¡å¼ï¼ŒåŒ…æ‹¬æˆ‘ä»¬çš„å°åŒºä¹Ÿæ˜¯æœ‰ä¸€ä¸ªNATè®¾å¤‡åœ¨è¿›è¡Œè½¬æ¢çš„ï¼Œè¿™æ ·ä½ çš„ç”µè„‘æ‰èƒ½åœ¨äº’è”ç½‘çš„ä¸–ç•Œä¸­é¨æ¸¸ã€‚å½“ç„¶NATä¹Ÿå¯ä»¥ä¿æŠ¤å†…ç½‘çš„è®¾å¤‡ä¸ä¼šç›´æ¥æš´éœ²åœ¨å…¬ç½‘ï¼Œè¿™æ ·ä¹Ÿä¼šæ›´åŠ çš„å®‰å…¨ï¼Œåªæœ‰å½“æˆ‘ä»¬ä¸»åŠ¨å‘èµ·è¿æ¥æ—¶ï¼Œåˆ«äººæ‰èƒ½çŸ¥é“æˆ‘ä»¬ã€‚\nå½“ç„¶ï¼Œæˆ‘ä»¬çš„Dockerä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œå®é™…ä¸Šå†…ç½‘çš„æ•°æ®åŒ…æƒ³è¦å‘é€åˆ°äº’è”ç½‘ä¸Šå»ï¼Œé‚£ä¹ˆå°±éœ€è¦ç»è¿‡è¿™æ ·çš„ä¸€å¥—æµç¨‹ï¼š\nè¿™æ ·ï¼ŒDockerå®¹å™¨ä½¿ç”¨çš„å†…ç½‘å°±å¯ä»¥å’Œå¤–ç½‘è¿›è¡Œé€šä¿¡äº†ã€‚\nä½†æ˜¯è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå•çº¯ä¾é NATçš„è¯ï¼Œåªæœ‰æˆ‘ä»¬ä¸»åŠ¨ä¸å¤–ç•Œè”ç³»æ—¶ï¼Œå¤–ç•Œæ‰èƒ½çŸ¥é“æˆ‘ä»¬ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬çš„å®¹å™¨ä¸­å¯èƒ½ä¼šéƒ¨ç½²ä¸€äº›æœåŠ¡ï¼Œéœ€è¦å¤–ç•Œæ¥ä¸»åŠ¨è¿æ¥æˆ‘ä»¬ï¼Œæ­¤æ—¶è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å®¹å™¨æ—¶é…ç½®ç«¯å£æ˜ å°„ï¼Œè¿˜è®°å¾—æˆ‘ä»¬åœ¨ç¬¬ä¸€èŠ‚è¯¾éƒ¨ç½²NginxæœåŠ¡å™¨å—ï¼Ÿ\ndocker run -d -p 80:80 nginx è¿™é‡Œçš„-på‚æ•°å®é™…ä¸Šæ˜¯è¿›è¡Œç«¯å£æ˜ å°„é…ç½®ï¼Œç«¯å£æ˜ å°„å¯ä»¥å°†å®¹å™¨éœ€è¦å¯¹å¤–æä¾›æœåŠ¡çš„ç«¯å£æ˜ å°„åˆ°å®¿ä¸»ä¸»æœºçš„ç«¯å£ä¸Šï¼Œè¿™æ ·ï¼Œå½“å¤–éƒ¨è®¿é—®åˆ°å®¿ä¸»ä¸»æœºçš„å¯¹åº”ç«¯å£æ—¶ï¼Œå°±ä¼šç›´æ¥è½¬å‘ç»™å®¹å™¨å†…æ˜ å°„çš„ç«¯å£äº†ã€‚è§„åˆ™ä¸ºå®¿ä¸»ç«¯å£:å®¹å™¨ç«¯å£ï¼Œè¿™é‡Œé…ç½®çš„æ˜¯å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°å®¿ä¸»ä¸»æœºçš„80ç«¯å£ä¸Šã€‚\nä¸€æ—¦ç›‘å¬åˆ°å®¿ä¸»ä¸»æœºçš„80ç«¯å£æ”¶åˆ°äº†æ•°æ®åŒ…ï¼Œé‚£ä¹ˆä¼šç›´æ¥è½¬å‘ç»™å¯¹åº”çš„å®¹å™¨ã€‚æ‰€ä»¥é…ç½®äº†ç«¯å£æ˜ å°„ä¹‹åï¼Œæˆ‘ä»¬æ‰å¯ä»¥ä»å¤–éƒ¨æ­£å¸¸è®¿é—®åˆ°å®¹å™¨å†…çš„æœåŠ¡ï¼š\næˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥docker psæŸ¥çœ‹ç«¯å£æ˜ å°„æƒ…å†µï¼š\nè‡³æ­¤ï¼Œæœ‰å…³å®¹å™¨çš„ç½‘ç»œéƒ¨åˆ†ï¼Œå°±åˆ°æ­¤ä¸ºæ­¢ï¼Œå½“ç„¶è¿™ä»…ä»…æ˜¯å•æœºä¸‹çš„å®¹å™¨ç½‘ç»œæ“ä½œï¼Œåœ¨ä»¥åçš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šè¿›ä¸€æ­¥å­¦ä¹ å¤šä¸»æœºä¸‹çš„ç½‘ç»œé…ç½®ã€‚\nå®¹å™¨å­˜å‚¨ç®¡ç† #\rå‰é¢æˆ‘ä»¬ä»‹ç»äº†å®¹å™¨çš„ç½‘ç»œç®¡ç†ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»äº†è§£äº†å¦‚ä½•é…ç½®å®¹å™¨çš„ç½‘ç»œï¼Œä»¥åŠç›¸å…³çš„ä¸€äº›åŸç†ã€‚è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†å°±æ˜¯å®¹å™¨çš„å­˜å‚¨ï¼Œåœ¨è¿™ä¸€å°èŠ‚æˆ‘ä»¬å°†æ·±å…¥äº†è§£å®¹å™¨çš„å­˜å‚¨ç®¡ç†ã€‚\nå®¹å™¨æŒä¹…åŒ–å­˜å‚¨ #\ræˆ‘ä»¬çŸ¥é“ï¼Œå®¹å™¨åœ¨åˆ›å»ºä¹‹åï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨å®¹å™¨ä¸­åˆ›å»ºå’Œä¿®æ”¹çš„æ–‡ä»¶ï¼Œå®é™…ä¸Šæ˜¯è¢«å®¹å™¨çš„åˆ†å±‚æœºåˆ¶ä¿å­˜åœ¨æœ€é¡¶å±‚çš„å®¹å™¨å±‚è¿›è¡Œæ“ä½œçš„ï¼Œä¸ºäº†ä¿æŠ¤ä¸‹é¢æ¯ä¸€å±‚çš„é•œåƒä¸è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥æ‰æœ‰äº†è¿™æ ·çš„CopyOnWriteç‰¹æ€§ã€‚ä½†æ˜¯è¿™æ ·ä¹Ÿä¼šå¯¼è‡´å®¹å™¨åœ¨é”€æ¯æ—¶æ•°æ®çš„ä¸¢å¤±ï¼Œå½“æˆ‘ä»¬é”€æ¯å®¹å™¨é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨æ—¶ï¼Œæ‰€æœ‰çš„æ•°æ®å…¨éƒ¨ä¸¢å¤±ï¼Œç›´æ¥å›åˆ°æ¢¦å¼€å§‹çš„åœ°æ–¹ã€‚\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›å¯¹å®¹å™¨å†…çš„æŸäº›æ–‡ä»¶è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°æ•°æ®å·ï¼ˆData Volumeï¼‰äº†ã€‚\nåœ¨å¼€å§‹ä¹‹å‰æˆ‘ä»¬å…ˆå‡†å¤‡ä¸€ä¸‹å®éªŒè¦ç”¨åˆ°çš„é•œåƒï¼š\ndocker run -it ubuntu apt update \u0026amp;\u0026amp; apt install -y vim ç„¶åæ‰“åŒ…ä¸ºæˆ‘ä»¬ä¸€ä¼šè¦ä½¿ç”¨çš„é•œåƒï¼š\ndocker commit æˆ‘ä»¬å¯ä»¥è®©å®¹å™¨å°†æ–‡ä»¶ä¿å­˜åˆ°å®¿ä¸»ä¸»æœºä¸Šï¼Œè¿™æ ·å°±ç®—å®¹å™¨é”€æ¯ï¼Œæ–‡ä»¶ä¹Ÿä¼šåœ¨å®¿ä¸»ä¸»æœºä¸Šä¿ç•™ï¼Œä¸‹æ¬¡åˆ›å»ºå®¹å™¨æ—¶ï¼Œä¾ç„¶å¯ä»¥ä»å®¿ä¸»ä¸»æœºä¸Šè¯»å–åˆ°å¯¹åº”çš„æ–‡ä»¶ã€‚å¦‚ä½•åšåˆ°å‘¢ï¼Ÿåªéœ€è¦åœ¨å®¹å™¨å¯åŠ¨æ—¶æŒ‡å®šå³å¯ï¼š\nmkdir test æˆ‘ä»¬ç°åœ¨ç”¨æˆ·ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„testç›®å½•ï¼Œç„¶ååœ¨é‡Œé¢éšä¾¿åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†å†™ç‚¹å†…å®¹ï¼š\nvim test/hello.txt æ¥ç€æˆ‘ä»¬å°±å¯ä»¥å°†å®¿ä¸»ä¸»æœºä¸Šçš„ç›®å½•æˆ–æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•ä¸Šï¼š\ndocker run -it -v ~/test:/root/test ubuntu-volume è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªæ–°çš„å‚æ•°-vï¼Œç”¨äºæŒ‡å®šæ–‡ä»¶æŒ‚è½½ï¼Œè¿™é‡Œæ˜¯å°†æˆ‘ä»¬åˆšåˆšåˆ›å»ºå¥½çš„testç›®å½•æŒ‚åœ¨åˆ°å®¹å™¨çš„/root/testè·¯å¾„ä¸Šã€‚\nè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨å®¹å™¨ä¸­è®¿é—®å®¿ä¸»ä¸»æœºä¸Šçš„æ–‡ä»¶äº†ï¼Œå½“ç„¶å¦‚æœæˆ‘ä»¬å¯¹æŒ‚è½½ç›®å½•ä¸­çš„æ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼Œé‚£ä¹ˆç›¸å½“äºç¼–è¾‘çš„æ˜¯å®¿ä¸»ä¸»æœºçš„æ•°æ®ï¼š\nvim /root/test/test.txt åœ¨å®¿ä¸»ä¸»æœºçš„å¯¹åº”ç›®å½•ä¸‹ï¼Œå¯ä»¥ç›´æ¥è®¿é—®åˆ°æˆ‘ä»¬åˆšåˆšåˆ›å»ºå¥½çš„æ–‡ä»¶ã€‚\næ¥ç€æˆ‘ä»¬æ¥å°†å®¹å™¨é”€æ¯ï¼Œçœ‹çœ‹å½“å®¹å™¨ä¸å¤å­˜åœ¨æ—¶ï¼ŒæŒ‚è½½çš„æ•°æ®æ—¶å€™è¿˜èƒ½ä¿ç•™ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿æˆ‘ä»¬é”€æ¯äº†å®¹å™¨ï¼Œåœ¨å®¿ä¸»ä¸»æœºä¸Šçš„æ–‡ä»¶ä¾ç„¶å­˜åœ¨ï¼Œå¹¶ä¸ä¼šå—åˆ°å½±å“ï¼Œè¿™æ ·çš„è¯ï¼Œå½“æˆ‘ä»¬ä¸‹æ¬¡åˆ›å»ºæ–°çš„é•œåƒæ—¶ï¼Œä¾ç„¶å¯ä»¥ä½¿ç”¨è¿™äº›ä¿å­˜åœ¨å¤–é¢çš„æ–‡ä»¶ã€‚\næ¯”å¦‚æˆ‘ä»¬ç°åœ¨æƒ³è¦éƒ¨ç½²ä¸€ä¸ªNginxæœåŠ¡å™¨æ¥ä»£ç†æˆ‘ä»¬çš„å‰ç«¯ï¼Œå°±å¯ä»¥ç›´æ¥å°†å‰ç«¯é¡µé¢ä¿å­˜åˆ°å®¿ä¸»ä¸»æœºä¸Šï¼Œç„¶åé€šè¿‡æŒ‚è½½çš„å½¢å¼è®©å®¹å™¨ä¸­çš„Nginxè®¿é—®ï¼Œè¿™æ ·å°±ç®—ä¹‹åNginxé•œåƒæœ‰å‡çº§ï¼Œéœ€è¦é‡æ–°åˆ›å»ºï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°æˆ‘ä»¬çš„å‰ç«¯é¡µé¢ã€‚è¿™é‡Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œæˆ‘ä»¬å…ˆå°†å‰ç«¯æ¨¡æ¿ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼š\nscp Downloads/moban5676.zip 192.168.10.10:~/ ç„¶ååœ¨æœåŠ¡å™¨ä¸Šè§£å‹ä¸€ä¸‹ï¼š\nunzip moban5676.zip æ¥ç€æˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨å®¹å™¨äº†ï¼š\ndocker run -it -v ~/moban5676:/usr/share/nginx/html/ -p 80:80 -d nginx è¿™é‡Œæˆ‘ä»¬å°†è§£å‹å‡ºæ¥çš„ç›®å½•ï¼ŒæŒ‚è½½åˆ°å®¹å™¨ä¸­Nginxçš„é»˜è®¤ç«™ç‚¹ç›®å½•/usr/share/nginx/html/ï¼ˆç”±äºæŒ‚åœ¨åä½äºé¡¶å±‚ï¼Œä¼šæ›¿ä»£é•œåƒå±‚åŸæœ‰çš„æ–‡ä»¶ï¼‰ï¼Œè¿™æ ·Nginxå°±ç›´æ¥ä»£ç†äº†æˆ‘ä»¬å­˜æ”¾åœ¨å®¿ä¸»ä¸»æœºä¸Šçš„å‰ç«¯é¡µé¢ï¼Œå½“ç„¶åˆ«å¿˜äº†æŠŠç«¯å£æ˜ å°„åˆ°å®¿ä¸»ä¸»æœºä¸Šï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„é•œåƒæ˜¯å®˜æ–¹çš„nginxé•œåƒã€‚\nç°åœ¨æˆ‘ä»¬è¿›å…¥å®¹å™¨å°†NginxæœåŠ¡å¯åŠ¨ï¼š\nsystemctl start nginx ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®çœ‹çœ‹æ˜¯å¦ä»£ç†æˆåŠŸï¼š\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å‰ç«¯é¡µé¢ç›´æ¥è¢«ä»£ç†äº†ï¼Œå½“ç„¶å¦‚æœæˆ‘ä»¬è¦ç¼–å†™è‡ªå®šä¹‰çš„é…ç½®ï¼Œä¹Ÿæ˜¯ä½¿ç”¨åŒæ ·çš„æ–¹æ³•æ“ä½œå³å¯ã€‚\næ³¨æ„å¦‚æœæˆ‘ä»¬åœ¨ä½¿ç”¨-vå‚æ•°æ—¶ä¸æŒ‡å®šå®¿ä¸»ä¸»æœºä¸Šçš„ç›®å½•è¿›è¡ŒæŒ‚è½½çš„è¯ï¼Œé‚£ä¹ˆå°±ç”±Dockeræ¥è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¸”ä¼šå°†å®¹å™¨ä¸­å¯¹åº”è·¯å¾„ä¸‹çš„å†…å®¹æ‹·è´åˆ°è¿™ä¸ªè‡ªåŠ¨åˆ›å»ºçš„ç›®å½•ä¸­ï¼Œæœ€åæŒ‚åœ¨åˆ°å®¹å™¨ä¸­ï¼Œè¿™ç§å°±æ˜¯ç”±Dockerç®¡ç†çš„æ•°æ®å·äº†ï¼ˆdocker managed volumeï¼‰æˆ‘ä»¬æ¥è¯•è¯•çœ‹ï¼š\ndocker run -it -v /root/abc ubuntu-volume æ³¨æ„è¿™é‡Œæˆ‘ä»¬ä»…ä»…æŒ‡å®šäº†æŒ‚è½½è·¯å¾„ï¼Œæ²¡æœ‰æŒ‡å®šå®¿ä¸»ä¸»æœºçš„å¯¹åº”ç›®å½•ï¼Œç»§ç»­åˆ›å»ºï¼š\nåˆ›å»ºåå¯ä»¥çœ‹åˆ°rootç›®å½•ä¸‹æœ‰ä¸€ä¸ªæ–°çš„abcç›®å½•ï¼Œé‚£ä¹ˆå®ƒå…·ä½“æ˜¯åœ¨å®¿ä¸»ä¸»æœºçš„å“ªä¸ªä½ç½®å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥ä½¿ç”¨inspectå‘½ä»¤ï¼š\ndocker inspect bold_banzai å¯ä»¥çœ‹åˆ°SorceæŒ‡å‘çš„æ˜¯/var/libä¸­çš„æŸä¸ªç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥è¿™ä¸ªç›®å½•æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œè¿›å…¥ä¹‹å‰è®°å¾—æå‡ä¸€ä¸‹æƒé™ï¼Œæƒé™ä½äº†è¿˜è¿›ä¸å»ï¼š\næˆ‘ä»¬æ¥åˆ›ä¸€ä¸ªæ–°çš„æ–‡æœ¬æ–‡æ¡£ï¼š\nå®é™…ä¸Šå’Œæˆ‘ä»¬ä¹‹å‰æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯å¯ä»¥åœ¨å®¹å™¨ä¸­çœ‹åˆ°çš„ï¼Œå½“ç„¶åˆ é™¤å®¹å™¨ä¹‹åï¼Œæ•°æ®ä¾ç„¶æ˜¯ä¿ç•™çš„ã€‚å½“æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨æ•°æ®å·æ—¶ï¼Œå¯ä»¥è¿›è¡Œåˆ é™¤ï¼š\nå½“ç„¶æœ‰æ—¶å€™ä¸ºäº†æ–¹ä¾¿ï¼Œå¯èƒ½å¹¶ä¸éœ€è¦ç›´æ¥æŒ‚è½½ä¸€ä¸ªç›®å½•ä¸Šå»ï¼Œä»…ä»…æ˜¯ä»å®¿ä¸»ä¸»æœºä¼ é€’ä¸€äº›æ–‡ä»¶åˆ°å®¹å™¨ä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨cpå‘½ä»¤æ¥å®Œæˆï¼š\nè¿™ä¸ªå‘½ä»¤æ”¯æŒä»å®¿ä¸»ä¸»æœºå¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨ï¼Œæˆ–æ˜¯ä»å®¹å™¨å¤åˆ¶æ–‡ä»¶åˆ°å®¿ä¸»ä¸»æœºï¼Œä½¿ç”¨æ–¹å¼ç±»ä¼¼äºLinuxè‡ªå¸¦çš„cpå‘½ä»¤ã€‚\nå®¹å™¨æ•°æ®å…±äº« #\rå‰é¢æˆ‘ä»¬é€šè¿‡æŒ‚è½½çš„å½¢å¼ï¼Œå°†å®¿ä¸»ä¸»æœºä¸Šçš„æ–‡ä»¶ç›´æ¥æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œè¿™æ ·å®¹å™¨å°±å¯ä»¥ç›´æ¥è®¿é—®åˆ°å®¿ä¸»ä¸»æœºä¸Šçš„æ–‡ä»¶äº†ï¼Œå¹¶ä¸”åœ¨å®¹å™¨åˆ é™¤æ—¶ä¹Ÿä¸ä¼šæ¸…ç†å®¿ä¸»ä¸»æœºä¸Šçš„æ–‡ä»¶ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹å¦‚ä½•å®ç°å®¹å™¨ä¸å®¹å™¨ä¹‹é—´çš„æ•°æ®å…±äº«ï¼Œå®é™…ä¸ŠæŒ‰ç…§æˆ‘ä»¬ä¹‹å‰çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¿ä¸»ä¸»æœºåˆ›å»ºä¸€ä¸ªå…¬å…±çš„ç›®å½•ï¼Œè®©è¿™äº›éœ€è¦å®ç°å…±äº«çš„å®¹å™¨ï¼Œéƒ½æŒ‚è½½è¿™ä¸ªå…¬å…±ç›®å½•ï¼š\ndocker run -it -v ~/test:/root/test ubuntu-volume ç”±äºæŒ‚è½½çš„æ˜¯å®¿ä¸»ä¸»æœºä¸Šçš„åŒä¸€å—åŒºåŸŸï¼Œæ‰€ä»¥å†…å®¹å¯ä»¥ç›´æ¥åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­éƒ½èƒ½è®¿é—®ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¦ä¸€ä¸ªå®¹å™¨æŒ‚è½½çš„ç›®å½•ï¼Œç›´æ¥åœ¨å¯åŠ¨å®¹å™¨æ—¶æŒ‡å®šä½¿ç”¨æ­¤å®¹å™¨æŒ‚è½½çš„ç›®å½•ï¼š\ndocker run -it -v ~/test:/root/test --name=data_test ubuntu-volume docker run -it --volumes-from data_test ubuntu-volume è¿™é‡Œä½¿ç”¨--volumes-fromæŒ‡å®šå¦ä¸€ä¸ªå®¹å™¨ï¼ˆè¿™ç§ç”¨äºç»™å…¶ä»–å®¹å™¨æä¾›æ•°æ®å·çš„å®¹å™¨ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºæ•°æ®å·å®¹å™¨ï¼‰\nå¯ä»¥çœ‹åˆ°ï¼Œæ•°æ®å·å®¹å™¨ä¸­æŒ‚è½½çš„å†…å®¹ï¼Œåœ¨å½“å‰å®¹å™¨ä¸­ä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œå½“ç„¶å°±ç®—æ­¤æ—¶æ•°æ®å·å®¹å™¨è¢«åˆ é™¤ï¼Œé‚£ä¹ˆä¹Ÿä¸ä¼šå½±å“åˆ°è¿™è¾¹ï¼Œå› ä¸ºè¿™è¾¹ç›¸å½“äºæ˜¯ç»§æ‰¿äº†æ•°æ®å·å®¹å™¨æä¾›çš„æ•°æ®å·ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šè¿˜æ˜¯è®©ä¸¤ä¸ªå®¹å™¨æŒ‚è½½äº†åŒæ ·çš„ç›®å½•å®ç°æ•°æ®å…±äº«ã€‚\nè™½ç„¶é€šè¿‡ä¸Šé¢çš„æ–¹å¼ï¼Œå¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å®ç°æ•°æ®ä¼ é€’ï¼Œä½†æ˜¯è¿™æ ·å¹¶ä¸æ–¹ä¾¿ï¼Œå¯èƒ½æŸäº›æ—¶å€™æˆ‘ä»¬ä»…ä»…æ˜¯å¸Œæœ›å®¹å™¨ä¹‹é—´å…±äº«ï¼Œè€Œä¸å¸Œæœ›æœ‰å®¿ä¸»ä¸»æœºè¿™ä¸ªè§’è‰²ç›´æ¥å‚ä¸åˆ°å…±äº«ä¹‹ä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦å¯»æ‰¾ä¸€ç§æ›´å¥½çš„åŠæ³•äº†ã€‚å…¶å®æˆ‘ä»¬å¯ä»¥å°†æ•°æ®å®Œå…¨æ”¾å…¥åˆ°å®¹å™¨ä¸­ï¼Œé€šè¿‡æ„å»ºä¸€ä¸ªå®¹å™¨ï¼Œæ¥ç›´æ¥å°†å®¹å™¨ä¸­æ‰“åŒ…å¥½çš„æ•°æ®åˆ†äº«ç»™å…¶ä»–å®¹å™¨ï¼Œå½“ç„¶æœ¬è´¨ä¸Šä¾ç„¶æ˜¯ä¸€ä¸ªDockerç®¡ç†çš„æ•°æ®å·ï¼Œè™½ç„¶è¿˜æ˜¯æ²¡æœ‰å®Œå…¨è„±ç¦»ä¸»æœºï¼Œä½†æ˜¯ç§»æ¤æ€§å°±é«˜å¾—å¤šäº†ã€‚\næˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªDockerfileï¼š\nFROM ubuntu ADD moban5676.tar.gz /usr/share/nginx/html/ VOLUME /usr/share/nginx/html/ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„æŒ‡ä»¤ADDï¼Œå®ƒè·ŸCOPYå‘½ä»¤ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥å¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨ä¸­ï¼Œä½†æ˜¯å®ƒå¯ä»¥è‡ªåŠ¨å¯¹å‹ç¼©æ–‡ä»¶è¿›è¡Œè§£å‹ï¼Œè¿™é‡Œåªéœ€è¦å°†å‹ç¼©å¥½çš„æ–‡ä»¶å¡«å…¥å³å¯ï¼Œåé¢çš„VOLUMEæŒ‡ä»¤å°±åƒæˆ‘ä»¬ä½¿ç”¨-vå‚æ•°ä¸€æ ·ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæŒ‚è½½ç‚¹åœ¨å®¹å™¨ä¸­ï¼š\ncd test tar -zcvf moban5676.tar.gz * mv moban5676.tar.gz .. cd .. æ¥ç€æˆ‘ä»¬ç›´æ¥æ„å»ºï¼š\ndocker build -t data . ç°åœ¨æˆ‘ä»¬è¿è¡Œä¸€ä¸ªå®¹å™¨çœ‹çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„æ–‡ä»¶éƒ½è‡ªåŠ¨è§£å‹å‡ºæ¥äº†ï¼ˆé™¤äº†ä¸­æ–‡æ–‡ä»¶åç§°ä¹±ç äº†ä¹‹å¤–ï¼Œä¸è¿‡æ— å…³ç´§è¦ï¼‰æˆ‘ä»¬é€€å‡ºå®¹å™¨ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®å·åˆ—è¡¨ä¸­æ–°å¢äº†æˆ‘ä»¬è¿™ä¸ªå®¹å™¨éœ€è¦ä½¿ç”¨çš„ï¼š\nè¿™ä¸ªä½ç½®å®é™…ä¸Šå°±æ˜¯æ•°æ®å­˜æ”¾åœ¨å½“å‰ä¸»æœºä¸Šçš„ä½ç½®äº†ï¼Œä¸è¿‡æ˜¯ç”±Dockerè¿›è¡Œç®¡ç†è€Œä¸æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ã€‚ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ç›´æ¥ç»§æ‰¿äº†ï¼š\ndocker run -p 80:80 --volumes-from=data_test -d nginx è®¿é—®ä¸€ä¸‹NginxæœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸä»£ç†ï¼š\nè¿™æ ·æˆ‘ä»¬å°±å®ç°äº†å°†æ•°æ®æ”¾åœ¨å®¹å™¨ä¸­è¿›è¡Œå…±äº«ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ»æ„å»æŒ‡å®šå®¿ä¸»ä¸»æœºçš„æŒ‚è½½ç‚¹ï¼Œè€Œæ˜¯Dockerè‡ªè¡Œç®¡ç†ï¼Œè¿™æ ·å°±ç®—è¿ç§»ä¸»æœºä¾ç„¶å¯ä»¥å¿«é€Ÿéƒ¨ç½²ã€‚\nå®¹å™¨èµ„æºç®¡ç† #\rå‰é¢æˆ‘ä»¬å·²ç»å®ŒæˆDockerçš„å‡ ä¸ªä¸»è¦æ¨¡å—çš„å­¦ä¹ ï¼Œæœ€åæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å¯¹å®¹å™¨çš„èµ„æºè¿›è¡Œç®¡ç†ã€‚\nå®¹å™¨æ§åˆ¶æ“ä½œ #\råœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å…ˆè¡¥å……ä¸€äº›æˆ‘ä»¬å‰é¢æ²¡æœ‰æåˆ°çš„å…¶ä»–å®¹å™¨å‘½ä»¤ã€‚\né¦–å…ˆæˆ‘ä»¬çš„SpringBooté¡¹ç›®åœ¨è¿è¡Œæ˜¯ï¼Œæ€ä¹ˆæŸ¥çœ‹è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å‘¢ï¼Ÿ\ndocker logs test è¿™é‡Œä½¿ç”¨logå‘½ä»¤æ¥æ‰“å°å®¹å™¨ä¸­çš„æ—¥å¿—ä¿¡æ¯ï¼š\nå½“ç„¶ä¹Ÿå¯ä»¥æ·»åŠ -få‚æ•°æ¥æŒç»­æ‰“å°æ—¥å¿—ä¿¡æ¯ã€‚\nç°åœ¨æˆ‘ä»¬çš„å®¹å™¨å·²ç»å¯åŠ¨äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦è¿›å…¥åˆ°å®¹å™¨ç›‘æ§å®¹å™¨çš„æƒ…å†µæ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ˜¯attachå‘½ä»¤æ¥é™„åŠ åˆ°å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç»ˆç«¯ä¸Šï¼š\ndocker attach å®¹å™¨ID/åç§° æ³¨æ„ç°åœ¨å°±åˆ‡æ¢ä¸ºäº†å®¹å™¨å†…çš„ç»ˆç«¯ï¼Œå¦‚æœæƒ³è¦é€€å‡ºçš„è¯ï¼Œéœ€è¦å…ˆæŒ‰Ctrl+Pç„¶åå†æŒ‰Ctrl+Qæ¥é€€å‡ºç»ˆç«¯ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨Ctrl+Cæ¥ç»ˆæ­¢ï¼Œè¿™æ ·ä¼šç›´æ¥ç»ˆæ­¢æ‰Dockerä¸­è¿è¡Œçš„Javaç¨‹åºçš„ã€‚\né€€å‡ºåï¼Œå®¹å™¨ä¾ç„¶æ˜¯å¤„äºè¿è¡ŒçŠ¶æ€çš„ã€‚\næˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨execå‘½ä»¤åœ¨å®¹å™¨ä¸­å¯åŠ¨ä¸€ä¸ªæ–°çš„ç»ˆç«¯æˆ–æ˜¯åœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ï¼š\ndocker exec -it test bash -itå’Œrunå‘½ä»¤çš„æ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œæ‰§è¡Œåï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼ˆå½“ç„¶åŸæœ¬çš„ç¨‹åºè¿˜æ˜¯åœ¨æ­£å¸¸è¿è¡Œï¼‰æˆ‘ä»¬ä¼šåœ¨ä¸€ä¸ªæ–°çš„ç»ˆç«¯ä¸­è¿›è¡Œäº¤äº’ï¼š\nå½“ç„¶ä¹Ÿå¯ä»¥ä»…ä»…åœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸€æ¡å‘½ä»¤ï¼š\næ‰§è¡Œåä¼šåœ¨å®¹å™¨ä¸­æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶è¾“å‡ºç»“æœã€‚\nå‰é¢æˆ‘ä»¬è¿˜å­¦ä¹ äº†å®¹å™¨çš„åœæ­¢æ“ä½œï¼Œé€šè¿‡è¾“å…¥stopå‘½ä»¤æ¥åœæ­¢å®¹å™¨ï¼Œä½†æ˜¯æ­¤æ“ä½œå¹¶ä¸ä¼šç«‹å³åœæ­¢ï¼Œè€Œæ˜¯ä¼šç­‰å¾…å®¹å™¨å¤„ç†å–„åï¼Œé‚£ä¹ˆæ€ä¹ˆæ ·æ‰èƒ½å¼ºåˆ¶ç»ˆæ­¢å®¹å™¨å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨killå‘½ä»¤ï¼Œç›¸å½“äºç»™è¿›ç¨‹å‘é€SIGKILLä¿¡å·ï¼Œå¼ºåˆ¶ç»“æŸã€‚\ndocker kill test ç›¸æ¯”stopå‘½ä»¤ï¼Œkillå°±æ²¡é‚£ä¹ˆæ¸©æŸ”äº†ã€‚\næœ‰æ—¶å€™å¯èƒ½åªæ˜¯å¸Œæœ›å®¹å™¨æš‚æ—¶åœæ­¢è¿è¡Œï¼Œè€Œä¸æ˜¯ç›´æ¥ç»ˆæ­¢è¿è¡Œï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´ç‚¹ï¼Œæ¢å¤å®¹å™¨çš„è¿è¡Œï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨pauseå‘½ä»¤æ¥æš‚åœå®¹å™¨ï¼š\ndocker pause test æš‚åœå®¹å™¨åï¼Œç¨‹åºæš‚æ—¶åœæ­¢è¿è¡Œï¼Œæ— æ³•å“åº”æµè§ˆå™¨å‘é€çš„è¯·æ±‚ï¼š\næ­¤æ—¶å¤„äºçˆ±çš„é­”åŠ›è½¬åœˆåœˆçŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ¢å¤è¿è¡Œï¼Œä½¿ç”¨unpauseå‘½ä»¤ï¼š\ndocker unpause test æ¢å¤è¿è¡Œåï¼Œç¬é—´å°±å“åº”æˆåŠŸäº†ã€‚\nç‰©ç†èµ„æºç®¡ç† #\rå¯¹äºä¸€ä¸ªå®¹å™¨ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹æˆ‘ä»¬å¯èƒ½å¹¶ä¸å¸Œæœ›å®ƒå æ®æ‰€æœ‰çš„ç³»ç»Ÿèµ„æºæ¥è¿è¡Œï¼Œæˆ‘ä»¬åªå¸Œæœ›åˆ†é…ä¸€éƒ¨åˆ†èµ„æºç»™å®¹å™¨ï¼Œæ¯”å¦‚åªåˆ†é…ç»™å®¹å™¨2Gå†…å­˜ï¼Œæœ€å¤§åªå…è®¸ä½¿ç”¨2Gï¼Œä¸å…è®¸å†å ç”¨æ›´å¤šçš„å†…å­˜ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦å¯¹å®¹å™¨çš„èµ„æºè¿›è¡Œé™åˆ¶ã€‚\ndocker run -m å†…å­˜é™åˆ¶ --memory-swap=å†…å­˜å’Œäº¤æ¢åˆ†åŒºæ€»å…±çš„å†…å­˜é™åˆ¶ é•œåƒåç§° å…¶ä¸­-må‚æ•°æ˜¯å¯¹å®¹å™¨çš„ç‰©ç†å†…å­˜çš„ä½¿ç”¨é™åˆ¶ï¼Œè€Œ--memory-swapæ˜¯å¯¹å†…å­˜å’Œäº¤æ¢åˆ†åŒºæ€»å’Œçš„é™åˆ¶ï¼Œå®ƒä»¬é»˜è®¤éƒ½æ˜¯-1ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰ä»»ä½•çš„é™åˆ¶ï¼ˆå¦‚æœåœ¨ä¸€å¼€å§‹ä»…æŒ‡å®š-må‚æ•°ï¼Œé‚£ä¹ˆäº¤æ¢å†…å­˜çš„é™åˆ¶ä¸å…¶ä¿æŒä¸€è‡´ï¼Œå†…å­˜+äº¤æ¢ç­‰äº-mçš„ä¸¤å€å¤§å°ï¼‰é»˜è®¤æƒ…å†µä¸‹è·Ÿå®¿ä¸»ä¸»æœºä¸€æ ·ï¼Œéƒ½æ˜¯2Gå†…å­˜ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å°†å®¹å™¨çš„å†…å­˜é™åˆ¶åˆ°100Mè¯•è¯•çœ‹ï¼Œå…¶ä¸­ç‰©ç†å†…å­˜50Mï¼Œäº¤æ¢å†…å­˜50Mï¼Œå°è¯•å¯åŠ¨ä¸€ä¸‹SpringBootç¨‹åºï¼š\ndocker run -it -m 50M --memory-swap=100M nagocoler/springboot-test:1.0 å¯ä»¥çœ‹åˆ°ï¼Œä¸Šæ¥å°±å› ä¸ºå†…å­˜ä¸è¶³æ— æ³•å¯åŠ¨äº†ï¼š\nå½“ç„¶é™¤äº†å¯¹å†…å­˜çš„é™åˆ¶ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹CPUèµ„æºè¿›è¡Œé™é¢ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰çš„å®¹å™¨éƒ½å¯ä»¥å¹³ç­‰åœ°ä½¿ç”¨CPUèµ„æºï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´ä¸åŒçš„å®¹å™¨çš„CPUæƒé‡ï¼ˆé»˜è®¤ä¸º1024ï¼‰ï¼Œæ¥æŒ‰éœ€åˆ†é…èµ„æºï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨åˆ°-cé€‰é¡¹ï¼Œä¹Ÿå¯ä»¥è¾“å…¥å…¨å--cpu-shareï¼š\ndocker run -c 1024 ubuntu docker run -c 512 ubuntu è¿™é‡Œå®¹å™¨çš„CPUæƒé‡æ¯”ä¾‹ä¸º16æ¯”8ï¼Œä¹Ÿå°±æ˜¯2æ¯”1ï¼ˆæ³¨æ„å¤šä¸ªå®¹å™¨æ—¶æ‰ä¼šç”Ÿæ•ˆï¼‰ï¼Œé‚£ä¹ˆå½“CPUèµ„æºç´§å¼ æ—¶ï¼Œä¼šæŒ‰ç…§æ­¤æƒé‡æ¥åˆ†é…èµ„æºï¼Œå½“ç„¶å¦‚æœCPUèµ„æºå¹¶ä¸ç´§å¼ çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶æ˜¯æœ‰æœºä¼šä½¿ç”¨åˆ°å…¨éƒ¨çš„CPUèµ„æºçš„ã€‚\nè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå‹åŠ›æµ‹è¯•å·¥å…·æ¥è¿›è¡ŒéªŒè¯ï¼š\ndocker run -c 1024 --name=cpu1024 -it ubuntu docker run -c 512 --name=cpu512 -it ubuntu æ¥ç€æˆ‘ä»¬åˆ†åˆ«è¿›å…¥å®¹å™¨å®‰è£…stresså‹åŠ›æµ‹è¯•å·¥å…·ï¼š\napt update \u0026amp;\u0026amp; apt install -y stress æ¥ç€æˆ‘ä»¬åˆ†åˆ«åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­éƒ½å¯åŠ¨å‹åŠ›æµ‹è¯•å·¥å…·ï¼Œäº§ç”Ÿ4ä¸ªè¿›ç¨‹ä¸æ–­è®¡ç®—éšæœºæ•°çš„å¹³æ–¹æ ¹ï¼š\nstress -c 4 æ¥ç€æˆ‘ä»¬è¿›å…¥topæ¥çœ‹çœ‹CPUçŠ¶æ€ï¼ˆçœ‹å®Œä¹‹åè®°å¾—èµ¶ç´§å»killæ‰å®¹å™¨ï¼Œä¸ç„¶CPUæ‹‰æ»¡å¾ˆå¡çš„ï¼‰ï¼š\nå¯ä»¥çœ‹åˆ°æƒé‡é«˜çš„å®¹å™¨ä¸­ï¼Œåˆ†é…åˆ°äº†æ›´å¤šçš„CPUèµ„æºï¼Œè€Œæƒé‡ä½çš„å®¹å™¨ä¸­ï¼Œåªåˆ†é…åˆ°ä¸€åŠçš„CPUèµ„æºã€‚\nå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥é™åˆ¶å®¹å™¨ä½¿ç”¨çš„CPUæ•°é‡ï¼š\ndocker run -it --cpuset-cpus=1 ubuntu --cpuset-cpusé€‰é¡¹å¯ä»¥ç›´æ¥é™åˆ¶åœ¨æŒ‡å®šçš„CPUä¸Šè¿è¡Œï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬çš„å®¿ä¸»æœºæ˜¯2æ ¸çš„CPUï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ†0å’Œ1è¿™ä¸¤ä¸ªCPUç»™Dockerä½¿ç”¨ï¼Œé™åˆ¶åï¼Œåªä¼šä½¿ç”¨CPU 1çš„èµ„æºäº†ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œ4ä¸ªè¿›ç¨‹åªå„è‡ªä½¿ç”¨äº†25%çš„CPUï¼ŒåŠ åœ¨ä¸€èµ·å°±æ˜¯100%ï¼Œä¹Ÿå°±æ˜¯åªèƒ½å æ»¡ä¸€ä¸ªCPUçš„ä½¿ç”¨ç‡ã€‚å¦‚æœè¦åˆ†é…å¤šä¸ªCPUï¼Œåˆ™ä½¿ç”¨é€—å·éš”å¼€ï¼š\ndocker run -it --cpuset-cpus=0,1 ubuntu è¿™æ ·å°±ä¼šä½¿ç”¨è¿™ä¸¤ä¸ªCPUäº†ï¼š\nå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨--cpusæ¥é™åˆ¶ä½¿ç”¨çš„CPUèµ„æºæ•°ï¼š\ndocker run -it --cpus=1 ubuntu é™åˆ¶ä¸º1åï¼Œåªèƒ½ä½¿ç”¨ä¸€ä¸ªCPUæä¾›çš„èµ„æºï¼Œæ‰€ä»¥è¿™é‡ŒåŠ è½½ä¸€èµ·åªæœ‰ä¸€ä¸ªCPUçš„èµ„æºäº†ã€‚å½“ç„¶è¿˜æœ‰æ›´ç²¾ç»†çš„--cpu-period å’Œ--cpu-quotaï¼Œè¿™é‡Œå°±ä¸åšä»‹ç»äº†ã€‚\næœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¯¹ç£ç›˜IOè¯»å†™æ€§èƒ½çš„é™åˆ¶ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ddå‘½ä»¤æ¥æµ‹è¯•ç£ç›˜è¯»å†™é€Ÿåº¦ï¼š\ndd if=/dev/zero of=/tmp/1G bs=4k count=256000 oflag=direct å¯ä»¥ä¸ç”¨ç­‰å¾…è·‘å®Œï¼Œä¸­é€”Ctrl+Cç»“æŸå°±è¡Œï¼š\nå¯ä»¥çœ‹åˆ°å½“å‰çš„è¯»å†™é€Ÿåº¦ä¸º86.4 MB/sï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡--device-read/write-bpså’Œ--device-read/write-iopså‚æ•°å¯¹å…¶è¿›è¡Œé™åˆ¶ã€‚\nè¿™é‡Œè¦å…ˆè¯´ä¸€ä¸‹åŒºåˆ«ï¼š\nbpsï¼šæ¯ç§’è¯»å†™çš„æ•°æ®é‡ã€‚ iopsï¼šæ¯ç§’IOçš„æ¬¡æ•°ã€‚ ä¸ºäº†ç›´è§‚ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨BPSä½œä¸ºé™åˆ¶æ¡ä»¶ï¼š\ndocker run -it --device-write-bps=/dev/sda:10MB ubuntu å› ä¸ºå®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯åœ¨/dev/sdaä¸Šçš„ï¼Œæ‰€ä»¥è¿™æˆ‘ä»¬å°±/dev/sda:10MBæ¥é™åˆ¶å¯¹/dev/sdaçš„å†™å…¥é€Ÿåº¦åªæœ‰10MB/sï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°ç°åœ¨çš„é€Ÿåº¦å°±åªæœ‰10MBå·¦å³äº†ã€‚\nå®¹å™¨ç›‘æ§ #\ræœ€åæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å¯¹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€è¿›è¡Œå®æ—¶ç›‘æ§ï¼Œæˆ‘ä»¬ç°åœ¨å¸Œæœ›èƒ½å¤Ÿå¯¹å®¹å™¨çš„èµ„æºå ç”¨æƒ…å†µè¿›è¡Œç›‘æ§ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨statså‘½ä»¤æ¥è¿›è¡Œç›‘æ§ï¼š\ndocker stats å¯ä»¥å®æ—¶å¯¹å®¹å™¨çš„å„é¡¹çŠ¶æ€è¿›è¡Œç›‘æ§ï¼ŒåŒ…æ‹¬å†…å­˜ä½¿ç”¨ã€CPUå ç”¨ã€ç½‘ç»œI/Oã€ç£ç›˜I/Oç­‰ä¿¡æ¯ï¼Œå½“ç„¶å¦‚æœæˆ‘ä»¬é™åˆ¶å†…å­˜çš„ä½¿ç”¨çš„è¯ï¼š\ndocker run -d -m 200M nagocoler/springboot-test:1.0 å¯ä»¥å¾ˆæ¸…æ¥šåœ°çœ‹åˆ°é™åˆ¶æƒ…å†µï¼š\né™¤äº†ä½¿ç”¨statså‘½ä»¤æ¥å®æ—¶ç›‘æ§æƒ…å†µä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨topå‘½ä»¤æ¥æŸ¥çœ‹å®¹å™¨ä¸­çš„è¿›ç¨‹ï¼š\ndocker top å®¹å™¨ID/åç§° å½“ç„¶ä¹Ÿå¯ä»¥æºå¸¦ä¸€äº›å‚æ•°ï¼Œå…·ä½“çš„å‚æ•°ä¸Linuxä¸­pså‘½ä»¤å‚æ•°ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ã€‚\nä½†æ˜¯è¿™æ ·çš„ç›‘æ§æ˜¯ä¸æ˜¯å¤ªåŸå§‹äº†ä¸€ç‚¹ï¼Ÿæœ‰æ²¡æœ‰é‚£ç§ç½‘é¡µé¢æ¿å¯ä»¥è¿›è¡Œå®æ—¶ç›‘æ§å’Œç®¡ç†çš„å‘¢ï¼Ÿæœ‰çš„ã€‚\næˆ‘ä»¬éœ€è¦å•ç‹¬éƒ¨ç½²ä¸€ä¸ªDockerç½‘é¡µç®¡ç†é¢æ¿åº”ç”¨ï¼Œä¸€èˆ¬æ¯”è¾ƒå¸¸è§çš„æœ‰ï¼šPortainerï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥ç›´æ¥é€šè¿‡Dockeré•œåƒçš„æ–¹å¼å»éƒ¨ç½²è¿™ä¸ªåº”ç”¨ç¨‹åºï¼Œæœç´¢ä¸€ä¸‹ï¼Œå‘ç°æœ€æ–°ç‰ˆç»´æŠ¤çš„åœ°å€ä¸ºï¼šhttps://hub.docker.com/r/portainer/portainer-ce\nCEä¸ºå…è´¹çš„ç¤¾åŒºç‰ˆæœ¬ï¼Œå½“ç„¶ä¹Ÿæœ‰BEå•†ä¸šç‰ˆæœ¬ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç›´æ¥å®‰è£…ç¤¾åŒºç‰ˆå°±è¡Œäº†ï¼Œå®˜æ–¹Linuxå®‰è£…æ•™ç¨‹ï¼šhttps://docs.portainer.io/start/install/server/docker/linuxï¼ŒåŒ…å«ä¸€äº›å®‰è£…å‰éœ€è¦çš„å‡†å¤‡ã€‚\né¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ•°æ®å·ä¾›Portainerä½¿ç”¨ï¼š\ndocker volume create portainer_data æ¥ç€é€šè¿‡å®˜æ–¹å‘½ä»¤å®‰è£…å¯åŠ¨ï¼š\ndocker run -d -p 8000:8000 -p 9443:9443 --name portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latest æ³¨æ„è¿™é‡Œéœ€è¦å¼€æ”¾ä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªæ˜¯8000ç«¯å£ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯9443ç«¯å£ã€‚\nOKï¼Œå¼€å¯æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç™»å½•åå°é¢æ¿ï¼šhttps://IP:9443/ï¼Œè¿™é‡Œéœ€è¦HTTPSè®¿é—®ï¼Œæµè§ˆå™¨å¯èƒ½ä¼šæç¤ºä¸å®‰å…¨ï¼Œæ— è§†å°±è¡Œï¼š\nè¿›å…¥åå°±éœ€è¦æˆ‘ä»¬è¿›è¡Œæ³¨å†Œäº†ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¾“å…¥ä¸¤æ¬¡å¯†ç å³å¯ï¼Œé»˜è®¤ç”¨æˆ·åå°±æ˜¯adminï¼Œå¡«å†™å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨äº†ï¼š\nç‚¹å‡»Get Startedå³å¯è¿›å…¥åˆ°ç®¡ç†é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›®å‰æœ‰ä¸€ä¸ªæœ¬åœ°çš„DockeræœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼š\næˆ‘ä»¬å¯ä»¥ç‚¹å‡»è¿›å…¥ï¼Œè¿›è¡Œè¯¦ç»†åœ°ç®¡ç†ï¼Œä¸è¿‡å”¯ä¸€ç¼ºç‚¹å°±æ˜¯æ²¡ä¸­æ–‡ï¼ŒæŒºéš¾å—çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨éå®˜æ–¹çš„æ±‰åŒ–ç‰ˆæœ¬ï¼šhttps://hub.docker.com/r/6053537/portainer-ceã€‚\nå•æœºå®¹å™¨ç¼–æ’ #\ræœ€åæˆ‘ä»¬æ¥è®²è§£ä¸€ä¸‹Docker-Composeï¼Œå®ƒèƒ½å¤Ÿå¯¹æˆ‘ä»¬çš„å®¹å™¨è¿›è¡Œç¼–æ’ã€‚æ¯”å¦‚ç°åœ¨æˆ‘ä»¬è¦åœ¨ä¸€å°ä¸»æœºä¸Šéƒ¨ç½²å¾ˆå¤šç§ç±»å‹çš„æœåŠ¡ï¼ŒåŒ…æ‹¬æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€SpringBootåº”ç”¨ç¨‹åºè‹¥å¹²ï¼Œæˆ–æ˜¯æƒ³è¦æ­å»ºä¸€ä¸ªMySQLé›†ç¾¤ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦åˆ›å»ºå¤šä¸ªå®¹å™¨æ¥å®Œæˆæ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå®ç°ä¸€é”®éƒ¨ç½²ï¼Œè¿™æ—¶è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å°±è¦ç”¨åˆ°å®¹å™¨ç¼–æ’äº†ï¼Œè®©å¤šä¸ªå®¹å™¨æŒ‰ç…§æˆ‘ä»¬è‡ªå·±çš„ç¼–æ’è¿›è¡Œéƒ¨ç½²ã€‚\n**å®˜æ–¹æ–‡æ¡£ï¼š**\rhttps://docs.docker.com/get-started/08_using_compose/ï¼Œè§†é¢‘æ•™ç¨‹è‚¯å®šä¸å¯èƒ½æŠŠæ‰€æœ‰çš„é…ç½®å…¨éƒ¨ä»‹ç»å®Œï¼Œæ‰€ä»¥å¦‚æœå„ä½å°ä¼™ä¼´æƒ³è¦äº†è§£æ›´å¤šçš„é…ç½®ï¼Œæœ‰æ›´å¤šéœ€æ±‚çš„è¯ï¼Œå¯ä»¥ç›´æ¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚\nå¿«é€Ÿå¼€å§‹ #\råœ¨Linuxç¯å¢ƒä¸‹æˆ‘ä»¬éœ€è¦å…ˆå®‰è£…ä¸€ä¸‹æ’ä»¶ï¼š\nsudo apt install docker-compose-plugin æ¥ç€è¾“å…¥docker compose versionæ¥éªŒè¯ä¸€ä¸‹æ˜¯å¦å®‰è£…æˆåŠŸã€‚\nè¿™é‡Œæˆ‘ä»¬å°±ä»¥éƒ¨ç½²SpringBooté¡¹ç›®ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¹‹å‰æ‰“åŒ…å¥½çš„SpringBooté¡¹ç›®ï¼Œç°åœ¨æˆ‘ä»¬å¸Œæœ›éƒ¨ç½²è¿™ä¸ªSpringBooté¡¹ç›®çš„åŒæ—¶ï¼Œéƒ¨ç½²ä¸€ä¸ªMySQLæœåŠ¡å™¨ï¼Œä¸€ä¸ªRedisæœåŠ¡å™¨ï¼Œè¿™æ—¶æˆ‘ä»¬SpringBooté¡¹ç›®è¦è¿è¡Œçš„æ•´ä¸ªå®Œæ•´ç¯å¢ƒï¼Œå…ˆè·å–åˆ°å¯¹åº”çš„é•œåƒï¼š\ndocker pull mysql/mysql-server docker pull redis æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è‡ªå·±çš„æœ¬åœ°å®‰è£…ä¸€ä¸‹DockerComposeï¼Œä¸‹è½½åœ°å€ï¼šhttps://github.com/docker/compose/releasesï¼Œä¸‹è½½è‡ªå·±ç”µè„‘å¯¹åº”çš„ç‰ˆæœ¬ï¼Œç„¶ååœ¨IDEAä¸­é…ç½®ï¼š\nä¸‹è½½å®Œæˆåï¼Œå°†Docker Composeå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ä¿®æ”¹ä¸ºä½ å­˜æ”¾åˆšåˆšä¸‹è½½çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼ŒWindowsç›´æ¥è®¾ç½®è·¯å¾„å°±è¡Œï¼ŒMacOSä¸‹è½½ä¹‹åéœ€è¦è¿›è¡Œä¸‹é¢çš„æ“ä½œï¼š\nmv ä¸‹è½½çš„æ–‡ä»¶åç§° docker-compose sudo chmod 777 docker-compose sudo mv docker-compose /usr/local/bin é…ç½®å®Œæˆåå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼Œå¦åˆ™ä¼šæ— æ³•è¿è¡Œï¼Œæ¥ç€æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åœ¨IDEAä¸­ç¼–å†™docker-compose.ymlæ–‡ä»¶äº†ã€‚\nè¿™é‡Œç‚¹å‡»å³ä¸Šè§’çš„â€œä¸æœåŠ¡å·¥å…·çª—å£åŒæ­¥â€æŒ‰é’®ï¼Œè¿™æ ·ä¸€ä¼šå°±å¯ä»¥åœ¨ä¸‹é¢æŸ¥çœ‹æƒ…å†µäº†ã€‚\næˆ‘ä»¬ç°åœ¨å°±ä»å¤´å¼€å§‹é…ç½®è¿™ä¸ªæ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬è¦åˆ›å»ºä¸‰ä¸ªæœåŠ¡ï¼Œä¸€ä¸ªæ˜¯MySQLæœåŠ¡å™¨ï¼Œä¸€ä¸ªæ˜¯RedisæœåŠ¡å™¨ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯SpringBootæœåŠ¡å™¨ï¼Œéœ€è¦ä¸‰ä¸ªå®¹å™¨æ¥åˆ†åˆ«è¿è¡Œï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆå†™ä¸Šè¿™ä¸‰ä¸ªæœåŠ¡ï¼š\nversion: \u0026#34;3.9\u0026#34; #é¦–å…ˆæ˜¯ç‰ˆæœ¬å·ï¼Œåˆ«ä¹±å†™ï¼Œè¿™ä¸ªæ˜¯å’ŒDockerç‰ˆæœ¬æœ‰å¯¹åº”çš„ services: #servicesé‡Œé¢å°±æ˜¯æˆ‘ä»¬æ‰€æœ‰éœ€è¦è¿›è¡Œç¼–æ’çš„æœåŠ¡äº† spring: #æœåŠ¡åç§°ï¼Œéšä¾¿èµ· container_name: app_springboot #ä¸€ä¼šè¦åˆ›å»ºçš„å®¹å™¨åç§° mysql: container_name: app_mysql redis: container_name: app_redis è¿™æ ·æˆ‘ä»¬å°±é…ç½®å¥½äº†ä¸€ä¼šè¦åˆ›å»ºçš„ä¸‰ä¸ªæœåŠ¡å’Œå¯¹åº”çš„å®¹å™¨åç§°ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦æŒ‡å®šä¸€ä¸‹è¿™äº›å®¹å™¨å¯¹åº”çš„é•œåƒäº†ï¼Œé¦–å…ˆæ˜¯æˆ‘ä»¬çš„SpringBootåº”ç”¨ç¨‹åºï¼Œå¯èƒ½æˆ‘ä»¬åç»­è¿˜ä¼šå¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæ›´æ–°å’Œä¿®æ”¹ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éƒ¨ç½²éœ€è¦å…ˆç”±Dockerfileæ„å»ºå‡ºé•œåƒåï¼Œå†è¿›è¡Œéƒ¨ç½²ï¼š\nspring: container_name: app_springboot build: . #buildè¡¨ç¤ºä½¿ç”¨æ„å»ºçš„é•œåƒï¼Œ.è¡¨ç¤ºä½¿ç”¨å½“å‰ç›®å½•ä¸‹çš„Dockerfileè¿›è¡Œæ„å»º æˆ‘ä»¬è¿™é‡Œä¿®æ”¹ä¸€ä¸‹Dockerfileï¼Œå°†åŸºç¡€é•œåƒä¿®æ”¹ä¸ºå·²ç»æ‰“åŒ…å¥½JDKç¯å¢ƒçš„é•œåƒï¼š\nFROM adoptopenjdk/openjdk8 COPY target/DockerTest-0.0.1-SNAPSHOT.jar app.jar CMD java -jar app.jar æ¥ç€æ˜¯å¦å¤–ä¸¤ä¸ªæœåŠ¡ï¼Œå¦å¤–ä¸¤ä¸ªæœåŠ¡éœ€è¦ä½¿ç”¨å¯¹åº”çš„é•œåƒæ¥å¯åŠ¨å®¹å™¨ï¼š\nmysql: container_name: app_mysql image: mysql/mysql-server:latest #imageè¡¨ç¤ºä½¿ç”¨å¯¹åº”çš„é•œåƒï¼Œè¿™é‡Œä¼šè‡ªåŠ¨ä»ä»“åº“ä¸‹è½½ï¼Œç„¶åå¯åŠ¨å®¹å™¨ redis: container_name: app_redis image: redis:latest è¿˜æ²¡æœ‰ç»“æŸï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†SpringBooté¡¹ç›®çš„ç«¯å£è¿›è¡Œæ˜ å°„ï¼Œæœ€åä¸€ä¸ªç®€å•çš„docker-composeé…ç½®æ–‡ä»¶å°±ç¼–å†™å®Œæˆäº†ï¼š\nversion: \u0026#34;3.9\u0026#34; #é¦–å…ˆæ˜¯ç‰ˆæœ¬å·ï¼Œåˆ«ä¹±å†™ï¼Œè¿™ä¸ªæ˜¯å’ŒDockerç‰ˆæœ¬æœ‰å¯¹åº”çš„ services: #servicesé‡Œé¢å°±æ˜¯æˆ‘ä»¬æ‰€æœ‰éœ€è¦è¿›è¡Œç¼–æ’çš„æœåŠ¡äº† spring: #æœåŠ¡åç§°ï¼Œéšä¾¿èµ· container_name: app_springboot #ä¸€ä¼šè¦åˆ›å»ºçš„å®¹å™¨åç§° build: . ports: - \u0026#34;8080:8080\u0026#34; mysql: container_name: app_mysql image: mysql/mysql-server:latest redis: container_name: app_redis image: redis:latest ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä¸€é”®éƒ¨ç½²äº†ï¼Œæˆ‘ä»¬ç‚¹å‡»ä¸‹æ–¹éƒ¨ç½²æŒ‰é’®ï¼š\nçœ‹åˆ° Running 4/4 å°±è¡¨ç¤ºå·²ç»éƒ¨ç½²æˆåŠŸäº†ï¼Œæˆ‘ä»¬ç°åœ¨åˆ°æœåŠ¡å™¨è¿™è¾¹æ¥çœ‹çœ‹æƒ…å†µï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œç¡®å®æ˜¯æŒ‰ç…§æˆ‘ä»¬çš„é…ç½®ï¼Œåˆ›å»ºäº†3ä¸ªå®¹å™¨ï¼Œå¹¶ä¸”éƒ½æ˜¯å¤„äºè¿è¡Œä¸­ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ï¼š\nå¦‚æœæƒ³è¦ç»“æŸçš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦ç‚¹å‡»åœæ­¢å°±è¡Œäº†ï¼š\nå½“ç„¶å¦‚æœæˆ‘ä»¬ä¸å†éœ€è¦è¿™å¥—ç¯å¢ƒçš„è¯ï¼Œå¯ä»¥ç›´æ¥ç‚¹å‡»ä¸‹æ–¹çš„æŒ‰é’®ï¼Œå°†æ•´å¥—ç¼–æ’ç»™downæ‰ï¼Œè¿™æ ·çš„è¯ç›¸å¯¹åº”çš„å®¹å™¨ä¹Ÿä¼šè¢«æ¸…ç†çš„ï¼š\næ³¨æ„åœ¨ä½¿ç”¨docker-composeéƒ¨ç½²æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„è‡ªå®šä¹‰ç½‘ç»œï¼Œå¹¶ä¸”æ‰€æœ‰çš„å®¹å™¨éƒ½æ˜¯è¿æ¥åˆ°è¿™ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œé‡Œé¢ï¼š\nè¿™ä¸ªç½‘ç»œé»˜è®¤ä¹Ÿæ˜¯ä½¿ç”¨bridgeä½œä¸ºé©±åŠ¨ï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„é…ç½®ï¼Œå»éƒ¨ç½²æˆ‘ä»¬çš„æ•´å¥—ç¯å¢ƒã€‚\néƒ¨ç½²å®Œæ•´é¡¹ç›® #\rå‰é¢æˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨docker-composeè¿›è¡Œç®€å•éƒ¨ç½²ï¼Œä½†æ˜¯ä»…ä»…åªæ˜¯ç®€å•å¯åŠ¨äº†æœåŠ¡ï¼Œæˆ‘ä»¬ç°åœ¨æ¥å°†è¿™äº›æœåŠ¡ç»™è¿èµ·æ¥ã€‚é¦–å…ˆæ˜¯SpringBooté¡¹ç›®ï¼Œæˆ‘ä»¬å…ˆå¼•å…¥ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-jdbc\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;mysql\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mysql-connector-java\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€é…ç½®ä¸€ä¸‹æ•°æ®æºï¼Œç­‰ç­‰ï¼Œæˆ‘ä»¬æ€ä¹ˆçŸ¥é“æ•°æ®åº“çš„é»˜è®¤å¯†ç æ˜¯å¤šå°‘å‘¢ï¼Ÿæ‰€ä»¥æˆ‘ä»¬å…ˆé…ç½®ä¸€ä¸‹MySQLæœåŠ¡ï¼š\nmysql: container_name: app_mysql image: mysql/mysql-server:latest environment: #è¿™é‡Œæˆ‘ä»¬é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®MySQLçš„rootè´¦å·å’Œå¯†ç  MYSQL_ROOT_HOST: \u0026#39;%\u0026#39; #ç™»é™†çš„ä¸»æœºï¼Œè¿™é‡Œç›´æ¥é…ç½®ä¸º\u0026#39;%\u0026#39; MYSQL_ROOT_PASSWORD: \u0026#39;123456.root\u0026#39; #MySQL rootè´¦å·çš„å¯†ç ï¼Œåˆ«è®¾å®šå¾—å¤ªç®€å•äº† MYSQL_DATABASE: \u0026#39;study\u0026#39; #åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºçš„æ•°æ®åº“ TZ: \u0026#39;Asia/Shanghai\u0026#39; #æ—¶åŒº ports: - \u0026#34;3306:3306\u0026#34; #æŠŠç«¯å£æš´éœ²å‡ºæ¥ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸æš´éœ²ï¼Œå› ä¸ºé»˜è®¤æ‰€æœ‰å®¹å™¨ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªç½‘ç»œ æœ‰å…³MySQLçš„è¯¦ç»†é…ç½®è¯·æŸ¥é˜…ï¼šhttps://registry.hub.docker.com/_/mysql\næ¥ç€æˆ‘ä»¬å°†æ•°æ®æºé…ç½®å®Œæˆï¼š\nspring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://app_mysql:3306/study #åœ°å€ç›´æ¥è¾“å…¥å®¹å™¨åç§°ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œè§£æï¼Œå‰é¢å·²ç»è®²è¿‡äº† username: root password: 123456.root ç„¶åæˆ‘ä»¬æ¥å†™ç‚¹æµ‹è¯•çš„ä»£ç å§ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨JPAè¿›è¡Œäº¤äº’ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-jpa\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; @Data @AllArgsConstructor @NoArgsConstructor @Entity @Table(name = \u0026#34;db_account\u0026#34;) public class Account { @Column(name = \u0026#34;id\u0026#34;) @Id long id; @Column(name = \u0026#34;name\u0026#34;) String name; @Column(name = \u0026#34;password\u0026#34;) String password; } @Repository public interface AccountRepository extends JpaRepository\u0026lt;Account, Long\u0026gt; { } @RestController public class MainController { @Resource AccountRepository repository; @RequestMapping(\u0026#34;/\u0026#34;) public String hello(){ return \u0026#34;Hello World!\u0026#34;; } @GetMapping(\u0026#34;/get\u0026#34;) public Account get(@RequestParam(\u0026#34;id\u0026#34;) long id){ return repository.findById(id).orElse(null); } @PostMapping(\u0026#34;/post\u0026#34;) public Account get(@RequestParam(\u0026#34;id\u0026#34;) long id, @RequestParam(\u0026#34;name\u0026#34;) String name, @RequestParam(\u0026#34;password\u0026#34;) String password){ return repository.save(new Account(id, name, password)); } } æ¥ç€æˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼š\nspring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://app_mysql:3306/study username: root password: 123456.root jpa: database: mysql show-sql: true hibernate: ddl-auto: update #è¿™é‡Œè‡ªåŠ¨æ‰§è¡ŒDDLåˆ›å»ºè¡¨ï¼Œå…¨ç¨‹è‡ªåŠ¨åŒ–ï¼Œå°½å¯èƒ½åšåˆ°å¼€ç®±å³ç”¨ ç°åœ¨ä»£ç ç¼–å†™å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥å°†é¡¹ç›®æ‰“åŒ…äº†ï¼Œæ³¨æ„æ‰§è¡Œæˆ‘ä»¬ä¸‹é¢çš„æ‰“åŒ…å‘½ä»¤ï¼Œä¸è¦è¿›è¡Œæµ‹è¯•ï¼Œå› ä¸ºè¿ä¸ä¸Šæ•°æ®åº“ï¼š\nmvn package -DskipTests é‡æ–°ç”ŸæˆjaråŒ…åï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹docker-composeé…ç½®ï¼Œå› ä¸ºMySQLçš„å¯åŠ¨é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæˆ‘ä»¬è¦ä¸€ç‚¹æ—¶é—´ç­‰å¾…å…¶å¯åŠ¨å®Œæˆï¼Œå¦‚æœè¿æ¥ä¸ä¸Šæ•°æ®åº“å¯¼è‡´SpringBooté¡¹ç›®å¯åŠ¨å¤±è´¥ï¼Œæˆ‘ä»¬å°±é‡å¯ï¼š\nspring: #æœåŠ¡åç§°ï¼Œéšä¾¿èµ· container_name: app_springboot #ä¸€ä¼šè¦åˆ›å»ºçš„å®¹å™¨åç§° build: . ports: - \u0026#34;8080:8080\u0026#34; depends_on: #è¿™é‡Œè®¾ç½®ä¸€ä¸‹ä¾èµ–ï¼Œéœ€è¦ç­‰å¾…mysqlå¯åŠ¨åæ‰è¿è¡Œï¼Œä½†æ˜¯æ²¡å•¥ç”¨ï¼Œè¿™ä¸ªå¹¶ä¸æ˜¯ç­‰åˆ°å¯åŠ¨å®Œæˆåï¼Œè€Œæ˜¯è¿›ç¨‹å»ºç«‹å°±åœæ­¢ç­‰å¾… - mysql restart: always #è¿™é‡Œé…ç½®å®¹å™¨åœæ­¢åè‡ªåŠ¨é‡å¯ ç„¶åæˆ‘ä»¬å°†ä¹‹å‰è‡ªåŠ¨æ„å»ºçš„é•œåƒåˆ é™¤ï¼Œç­‰å¾…é‡æ–°æ„å»ºï¼š\nç°åœ¨æˆ‘ä»¬é‡æ–°éƒ¨ç½²docker-composå§ï¼š\nå½“ä¸‰ä¸ªæœåŠ¡å…¨éƒ¨ä¸ºè“è‰²æ—¶ï¼Œå°±è¡¨ç¤ºå·²ç»æ­£å¸¸è¿è¡Œäº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼š\næ¥ç€æˆ‘ä»¬æ¥è¯•è¯•çœ‹å‘æ•°æ®åº“ä¼ å…¥æ•°æ®ï¼š\nå¯ä»¥çœ‹åˆ°å“åº”æˆåŠŸï¼Œæ¥ç€æˆ‘ä»¬æ¥è¯·æ±‚ä¸€ä¸‹ï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬çš„é¡¹ç›®å’ŒMySQLåŸºæœ¬å°±æ˜¯è‡ªåŠ¨éƒ¨ç½²äº†ã€‚\næ¥ç€æˆ‘ä»¬æ¥é…ç½®ä¸€ä¸‹Redisï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-redis\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€é…ç½®è¿æ¥ä¿¡æ¯ï¼š\nspring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://app_mysql:3306/study username: root password: 123456.root jpa: database: mysql show-sql: true hibernate: ddl-auto: update redis: host: app_redis //å†åŠ ä¸¤ä¸ªRedisæ“ä½œè¿›æ¥ @Resource StringRedisTemplate template; @GetMapping(\u0026#34;/take\u0026#34;) public String take(@RequestParam(\u0026#34;key\u0026#34;) String key){ return template.opsForValue().get(key); } @PostMapping(\u0026#34;/put\u0026#34;) public String put(@RequestParam(\u0026#34;key\u0026#34;) String key, @RequestParam(\u0026#34;value\u0026#34;) String value){ template.opsForValue().set(key, value); return \u0026#34;æ“ä½œæˆåŠŸï¼\u0026#34;; } æœ€åæˆ‘ä»¬æ¥é…ç½®ä¸€ä¸‹docker-composeçš„é…ç½®æ–‡ä»¶ï¼š\nredis: container_name: app_redis image: redis:latest ports: - \u0026#34;6379:6379\u0026#34; OKï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ–¹å¼ï¼Œæˆ‘ä»¬é‡æ–°å†éƒ¨ç½²ä¸€ä¸‹ï¼Œç„¶åæµ‹è¯•ï¼š\nè¿™æ ·æˆ‘ä»¬å°±å®Œæˆæ•´å¥—ç¯å¢ƒ+åº”ç”¨ç¨‹åºçš„é…ç½®äº†ï¼Œæˆ‘ä»¬åœ¨éƒ¨ç½²æ•´ä¸ªé¡¹ç›®æ—¶ï¼Œåªéœ€è¦ä½¿ç”¨docker-composeé…ç½®æ–‡ä»¶è¿›è¡Œå¯åŠ¨å³å¯ï¼Œè¿™æ ·å°±å¤§å¤§æ–¹ä¾¿äº†æˆ‘ä»¬çš„æ“ä½œï¼Œå®ç°å¼€ç®±å³ç”¨ã€‚ç”šè‡³æˆ‘ä»¬è¿˜å¯ä»¥ä¸“é—¨ä½¿ç”¨ä¸€ä¸ªå¹³å°æ¥åŒæ—¶å¯¹å¤šä¸ªä¸»æœºè¿›è¡Œä¸€æ¬¡æ€§é…ç½®ï¼Œå¤§è§„æ¨¡å¿«é€Ÿéƒ¨ç½²ï¼Œè€Œè¿™äº›å°±ç•™åˆ°ä»¥åçš„è¯¾ç¨‹ä¸­å†è¯´å§ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/docker/","section":"Docs","summary":"Dockerå®¹å™¨æŠ€æœ¯ #\rDockeræ˜¯ä¸€é—¨å¹³å°çº§åˆ«çš„æŠ€æœ¯ï¼Œæ¶‰åŠçš„èŒƒå›´å¾ˆå¹¿ï¼Œæ‰€ä»¥ï¼Œåœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å®Œæˆï¼šJava SpringBoot ç¯‡ï¼ˆæ¨èå®ŒæˆSpringCloudç¯‡å†æ¥ï¼‰è§†é¢‘æ•™ç¨‹åŠä¹‹å‰å…¨éƒ¨è·¯çº¿ï¼Œå¦åˆ™å­¦ä¹ ä¼šéå¸¸åƒåŠ›ï¼Œå¦å¤–æ¨èé¢å¤–æŒæ¡ï¼šã€Šè®¡ç®—æœºç½‘ç»œã€‹ã€ã€Šæ“ä½œç³»ç»Ÿã€‹ç›¸å…³çŸ¥è¯†ã€‚å­¦ä¸€æ ·ä¸œè¥¿ä¸èƒ½å®Œå…¨é è®°å¿†æ¥å®Œæˆï¼Œè€Œæ˜¯éœ€è¦ç»“åˆè‡ªå·±æ‰€å­¦çš„åŸºç¡€çŸ¥è¯†åŠ ä»¥ç†è§£ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå•å‡­è®°å¿†èƒ½å¤ŸæŒæ¡çš„ä¸œè¥¿å¾€å¾€æ˜¯æœ€å»‰ä»·çš„ã€‚\n**Dockerå®˜ç½‘ï¼š**\rhttps://www.docker.com\n**è¯¾å‰å‡†å¤‡ï¼š**é…ç½®2C2Gä»¥ä¸ŠLinuxæœåŠ¡å™¨ä¸€å°ï¼Œäº‘æœåŠ¡å™¨ã€è™šæ‹Ÿæœºå‡å¯ã€‚\nå®¹å™¨æŠ€æœ¯å…¥é—¨ #\réšç€æ—¶ä»£çš„å‘å±•ï¼ŒDockerä¹Ÿé€æ¸èµ°ä¸Šäº†å†å²èˆå°ï¼Œæ›¾ç»æˆ‘ä»¬æƒ³è¦å®‰è£…ä¸€å¥—ç¯å¢ƒï¼Œéœ€è¦èŠ±è´¹ä¸€ä¸‹åˆç”šè‡³ä¸€æ•´å¤©æ¥é…ç½®å’Œå®‰è£…å„ä¸ªéƒ¨åˆ†ï¼ˆæ¯”å¦‚è¿è¡Œæˆ‘ä»¬è‡ªå·±çš„SpringBootåº”ç”¨ç¨‹åºï¼Œå¯èƒ½éœ€è¦å®‰è£…æ•°æ®åº“ã€å®‰è£…Redisã€å®‰è£…MQç­‰ï¼Œå„ç§å„æ ·çš„ç¯å¢ƒå…‰æ˜¯å®‰è£…å°±è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´ï¼ŒçœŸçš„æ˜¯æå¾—å¿ƒæ€çˆ†ç‚¸ï¼‰ï¼Œè€Œæœ‰äº†Dockerä¹‹åï¼Œæˆ‘ä»¬çš„ç¨‹åºå’Œç¯å¢ƒéƒ¨ç½²å°±å˜å¾—éå¸¸ç®€å•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›ç¯å¢ƒä¸€èµ·æ‰“åŒ…æˆä¸€ä¸ªé•œåƒã€‚è€Œåˆ°æœåŠ¡å™¨ä¸Šéƒ¨ç½²æ—¶ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½é•œåƒå®ç°ä¸€é”®éƒ¨ç½²ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿ\nåŒ…æ‹¬æˆ‘ä»¬åœ¨å­¦ä¹ SpringCloudéœ€è¦é…ç½®çš„å„ç§ç»„ä»¶ï¼Œå¯èƒ½åœ¨è‡ªå·±ç”µè„‘çš„ç¯å¢ƒä¸­è¿è¡Œä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼ˆå¯èƒ½ç”±äºç”µè„‘ä¸Šå„ç§ç¯å¢ƒæ²¡é…ç½®ï¼Œå¯¼è‡´æ— æ³•è¿è¡Œï¼‰ï¼Œè€Œç°åœ¨åªéœ€è¦ä¸‹è½½é•œåƒå°±èƒ½ç›´æ¥è¿è¡Œï¼Œæ‰€æœ‰çš„ç¯å¢ƒå…¨éƒ¨åœ¨é•œåƒä¸­é…ç½®å®Œæˆï¼Œå¼€ç®±å³ç”¨ã€‚\nçœŸçš„æœ‰è¿™ä¹ˆç¥å¥‡å—ï¼Ÿæˆ‘ä»¬æ¥è¯•è¯•çœ‹ã€‚\nç¯å¢ƒå®‰è£…å’Œéƒ¨ç½² #\ré¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯å…ˆå°†Dockerç¯å¢ƒæ­å»ºå¥½ï¼ˆå»ºè®®å’Œæˆ‘åŒä¸€ä¸ªç¯å¢ƒï¼Œä¸ç„¶å‡ºäº†é—®é¢˜åªèƒ½è‡ªå·±æƒ³åŠæ³•äº†ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ï¼š\nUbuntu 22.04 æ“ä½œç³»ç»Ÿ Dockeråˆ†ä¸ºå…è´¹çš„CEï¼ˆCommunity Editionï¼‰ç¤¾åŒºç‰ˆæœ¬å’ŒEEï¼ˆEnterprise Editionï¼‰ä¼ä¸šçº§ä»˜è´¹ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œé€‰æ‹©docker-ceè¿›è¡Œå®‰è£…ã€‚å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼šhttps://docs.docker.com/engine/install/ubuntu/\né¦–å…ˆå®‰è£…ä¸€äº›å·¥å…·ï¼š\nsudo apt-get install ca-certificates curl gnupg lsb-release ä¸è¿‡åœ¨Ubuntu22.","title":"Docker","type":"doc"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/doc/","section":"Docs","summary":"","title":"Docs","type":"doc"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/mq/","section":"Series","summary":"","title":"Mq","type":"series"},{"content":"\rMySQLé«˜çº§ #\råœ¨JavaWebé˜¶æ®µï¼Œæˆ‘ä»¬åˆæ­¥è®¤è¯†äº†MySQLæ•°æ®åº“ï¼ŒåŒ…æ‹¬ä¸€äº›åŸºæœ¬æ“ä½œï¼Œæ¯”å¦‚åˆ›å»ºæ•°æ®åº“ã€è¡¨ã€è§¦å‘å™¨ï¼Œä»¥åŠæœ€åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ã€äº‹åŠ¡ç­‰æ“ä½œã€‚è€Œåœ¨æ­¤é˜¶æ®µï¼Œæˆ‘ä»¬å°†ç»§ç»­æ·±å…¥å­¦ä¹ MySQLï¼Œäº†è§£å®ƒçš„æ›´å¤šé«˜çº§ç©æ³•ï¼Œä¹Ÿç›¸å½“äºè¿›è¡Œå¤ä¹ ã€‚\nå‡½æ•° #\rå…¶å®å‡½æ•°æˆ‘ä»¬åœ¨ä¹‹å‰å·²ç»æ¥è§¦åˆ°ä¸€éƒ¨åˆ†äº†ï¼Œåœ¨JavaWebé˜¶æ®µï¼Œæˆ‘ä»¬äº†è§£äº†èšé›†å‡½æ•°ï¼Œèšé›†å‡½æ•°ä¸€èˆ¬ç”¨ä½œç»Ÿè®¡ï¼ŒåŒ…æ‹¬ï¼š\ncount([distinct]*) ç»Ÿè®¡æ‰€æœ‰çš„è¡Œæ•°ï¼ˆdistinctè¡¨ç¤ºå»é‡å†ç»Ÿè®¡ï¼Œä¸‹åŒï¼‰ count([distinct]åˆ—å) ç»Ÿè®¡æŸåˆ—çš„å€¼æ€»å’Œ sum([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„å’Œï¼ˆæ³¨æ„å¿…é¡»æ˜¯æ•°å­—ç±»å‹çš„ï¼‰ avg([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„å¹³å‡å€¼ï¼ˆæ³¨æ„å¿…é¡»æ˜¯æ•°å­—ç±»å‹ï¼‰ max([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„æœ€å¤§å€¼ min([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„æœ€å°å€¼ æ¯”å¦‚æˆ‘ä»¬éœ€è¦è®¡ç®—æŸä¸ªè¡¨ä¸€å…±æœ‰å¤šå°‘è¡Œï¼š\nSELECT COUNT(*) FROM student é€šè¿‡ä½¿ç”¨COUNTèšé›†å‡½æ•°ï¼Œå°±å¯ä»¥å¿«é€Ÿç»Ÿè®¡å¹¶å¾—åˆ°ç»“æœï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è®¡ç®—æŸä¸€åˆ—ä¸Šæ‰€æœ‰æ•°å­—çš„å’Œï¼š\nSELECT SUM(sid) FROM student é€šè¿‡SUMèšé›†å‡½æ•°ï¼Œå°±å¯ä»¥å¿«é€Ÿè®¡ç®—æ¯ä¸€åˆ—çš„å’Œï¼Œå®é™…ä¸Šè¿™äº›å‡½æ•°éƒ½æ˜¯ç”±ç³»ç»Ÿæä¾›çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚\næœ¬ç‰ˆå—æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»å„ç±»ç³»ç»Ÿå‡½æ•°ä»¥åŠå¦‚ä½•ç¼–å†™è‡ªå®šä¹‰å‡½æ•°ã€‚\nç³»ç»Ÿå‡½æ•° #\rç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„å‡½æ•°ä¹Ÿæ˜¯éå¸¸å®ç”¨çš„ï¼Œæˆ‘ä»¬å°†ä¼šåˆ†ä¸ºå‡ ä¸ªç±»å‹è¿›è¡Œè®²è§£ã€‚\nå­—ç¬¦ä¸²å‡½æ•° #\rå¤„ç†å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°æ¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå¤„ç†å­—ç¬¦ä¸²ï¼Œå…¶ä¸­å¸¸ç”¨æ¯”å¦‚ç”¨äºå­—ç¬¦ä¸²åˆ†å‰²çš„å‡½æ•°æœ‰ï¼š\nsubstring(å­—ç¬¦ä¸², èµ·å§‹ä½ç½®, ç»“æŸä½ç½®) åŒJavaä¸­Stringç±»çš„substringä¸€è‡´ï¼Œä½†æ˜¯æ³¨æ„ä¸‹æ ‡æ˜¯ä»1å¼€å§‹ï¼Œä¸‹åŒ left(å­—ç¬¦ä¸², é•¿åº¦) ä»æœ€å·¦è¾¹å‘å³æˆªå–å­—ç¬¦ä¸² right(å­—ç¬¦ä¸², é•¿åº¦) ä»æœ€å³è¾¹å‘å·¦æˆªå–å­—ç¬¦ä¸² æ¯”å¦‚æˆ‘ä»¬åªæƒ³è·å–æ‰€æœ‰å­¦ç”Ÿå§“åçš„ç¬¬äºŒä¸ªå­—ï¼Œé‚£ä¹ˆå¯ä»¥åƒè¿™æ ·å†™ï¼š\nSELECT SUBSTRING(name, 2, 2) FROM student æ¯”å¦‚æˆ‘ä»¬æƒ³è·å–æ‰€æœ‰å­¦ç”Ÿå§“åçš„ç¬¬ä¸€ä¸ªå­—ï¼Œå¯ä»¥åƒè¿™æ ·å†™ï¼š\nSELECT LEFT(name, 1) FROM student æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²å‡½æ•°æ¥å¿«é€Ÿå°†æ‰€æœ‰çš„å­—æ¯è½¬æ¢ä¸ºå¤§å†™å­—æ¯æˆ–æ˜¯å¿«é€Ÿè½¬æ¢ä¸ºå°å†™å­—æ¯ï¼š\nupper(å­—ç¬¦ä¸²) å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå¤§å†™å­—æ¯ lower(å­—ç¬¦ä¸²) å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—æ¯è½¬æ¢ä¸ºå°å†™å­—æ¯ æ¯”å¦‚æˆ‘ä»¬å¸Œæœ›å°†ä¸€ä¸ªå­—ç¬¦ä¸²æ‰€æœ‰å­—ç¬¦ä¸“ä¸ºå¤§å†™ï¼š\nSELECT UPPER(\u0026#39;abcdefg\u0026#39;) æˆ‘ä»¬ä¹Ÿå¯ä»¥åƒJavaä¸­é‚£æ ·ç›´æ¥å¯¹å­—ç¬¦ä¸²ä¸­çš„å†…å®¹è¿›è¡Œæ›¿æ¢ï¼š\nreplace(å­—ç¬¦ä¸², åŸæ–‡, æ›¿æ¢æ–‡) åŒJavaä¸­Stringçš„replaceæ•ˆæœ æ¯”å¦‚ç°åœ¨æˆ‘ä»¬å¸Œæœ›å°†æŸ¥è¯¢åˆ°çš„æ‰€æœ‰åŒå­¦çš„åç§°ä¸­çš„å°å…¨éƒ¨æ›¿æ¢å¤§ï¼š\nSELECT REPLACE(`name`, \u0026#39;å°\u0026#39;, \u0026#39;å¤§\u0026#39;) FROM student å­—ç¬¦ä¸²ä¹Ÿæ”¯æŒè¿›è¡Œæ‹¼æ¥ï¼Œç³»ç»Ÿæä¾›äº†å­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°ï¼š\nconcat(å­—ç¬¦ä¸²1, å­—ç¬¦ä¸²2) è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸² æ¯”å¦‚æˆ‘ä»¬å¸Œæœ›å°†æŸ¥è¯¢åˆ°çš„æ‰€æœ‰åŒå­¦çš„åç§°æœ€åéƒ½æ·»åŠ ä¸€ä¸ªå­å­—ï¼š\nSELECT concat(name, \u0026#39;å­\u0026#39;) FROM student æœ€åå°±æ˜¯è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ï¼š\nlength(å­—ç¬¦ä¸²) è·å–å­—ç¬¦ä¸²é•¿åº¦ï¼ˆæ³¨æ„å¦‚æœä½¿ç”¨çš„æ˜¯UTF-8ç¼–ç æ ¼å¼ï¼Œé‚£ä¹ˆä¸€ä¸ªæ±‰å­—å 3å­—èŠ‚ï¼Œæ•°å­—å’Œå­—æ¯å ä¸€ä¸ªå­—èŠ‚ï¼‰ æ¯”å¦‚æˆ‘ä»¬è¦è·å–æ‰€æœ‰äººåå­—çš„é•¿åº¦ï¼š\nSELECT LENGTH(`name`) FROM student æ—¥æœŸå‡½æ•° #\rMySQLæä¾›çš„æ—¥æœŸå‡½æ•°ä¹Ÿéå¸¸å®ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿå¯¹æ—¥æœŸè¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦å¿«é€Ÿå°†æ—¥æœŸæ·»åŠ Nå¤©ï¼Œå°±å¯ä»¥ä½¿ç”¨ï¼š\ndate_add(æ—¥æœŸ, interval å¢é‡ å•ä½) æ¯”å¦‚æˆ‘ä»¬å¸Œæœ›è®©2022-1-1å‘å5å¤©ï¼š\nSELECT DATE_ADD(\u0026#39;2022-1-1\u0026#39;,INTERVAL 5 day) åŒç†ï¼Œå‘å‰1å¹´ï¼š\nSELECT DATE_ADD(\u0026#39;2022-1-1\u0026#39;,INTERVAL -1 year) å•ä½æœ‰ï¼šyearï¼ˆå¹´ï¼‰ã€monthï¼ˆæœˆï¼‰ã€dayï¼ˆæ—¥ï¼‰ã€hourï¼ˆå°æ—¶ï¼‰ã€minuteï¼ˆåˆ†é’Ÿï¼‰ã€secondï¼ˆç§’ï¼‰\næˆ‘ä»¬è¿˜å¯ä»¥å¿«é€Ÿè®¡ç®—æ—¥æœŸçš„é—´éš”å¤©æ•°ï¼š\ndatediff(æ—¥æœŸ1, æ—¥æœŸ2) æ¯”å¦‚æˆ‘ä»¬æƒ³è®¡ç®—2022å¹´çš„2æœˆæœ‰å¤šå°‘å¤©ï¼š\nSELECT DATEDIFF(\u0026#39;2022-3-1\u0026#39;,\u0026#39;2022-2-1\u0026#39;) å¦‚æœæˆ‘ä»¬æƒ³å¿«é€Ÿè·å–å½“å‰æ—¶é—´çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›ï¼š\ncurdate() å½“å‰çš„æ—¥æœŸ curtime() å½“å‰çš„æ—¶é—´ now() å½“å‰çš„æ—¥æœŸ+æ—¶é—´ æ­¤å‡½æ•°ä¹‹å‰æˆ‘ä»¬åœ¨ç¼–å†™å®æˆ˜é¡¹ç›®çš„æ—¶å€™å·²ç»ä½¿ç”¨è¿‡äº†ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å•ç‹¬è·å–æ—¶é—´ä¸­çš„æŸä¸ªå€¼ï¼š\nday(æ—¥æœŸ) è·å–æ—¥æœŸæ˜¯å‡ å· month(æ—¥æœŸ) è·å–æ—¥æœŸæ˜¯å‡ æœˆ year(æ—¥æœŸ) è·å–æ—¥æœŸæ˜¯å“ªä¸€å¹´ æ¯”å¦‚æˆ‘ä»¬æƒ³è·å–ä»Šå¤©æ˜¯å‡ å·ï¼š\nSELECT DAY(NOW()) æ•°å­¦å‡½æ•° #\ræ•°å­¦å‡½æ•°æ¯”è¾ƒå¸¸è§„ï¼ŒåŸºæœ¬ä¸Javaçš„Mathå·¥å…·ç±»ä¸€è‡´ï¼Œè¿™é‡Œåˆ—å‡ºå³å¯ï¼Œå„ä½å¯ä»¥è‡ªè¡Œå°è¯•ï¼š\nabs(x) æ±‚xçš„ç»å¯¹å€¼ ceiling(x) xå‘ä¸Šå–æ•´ floor(x) xå‘ä¸‹å–æ•´ round(x, ç²¾åº¦) xå–å››èˆäº”å…¥ï¼Œéµå¾ªå°æ•°ç‚¹ç²¾åº¦ exp(x) eçš„xæ¬¡æ–¹ rand() 0-1ä¹‹é—´çš„éšæœºæ•° log(x) xçš„å¯¹æ•° pi() Ï€ power(x, n) xçš„næ¬¡æ–¹ sqrt(x) xçš„å¹³æ–¹æ ¹ sin(x) cos(x) tan(x) ä¸‰è§’å‡½æ•°ï¼ˆè²Œä¼¼æ²¡æœ‰arctanè¿™ç±»åå‡½æ•°ï¼Ÿï¼‰ ç±»å‹è½¬æ¢å‡½æ•° #\rMySQLçš„ç±»å‹è½¬æ¢ä¹Ÿåˆ†ä¸ºéšå¼ç±»å‹è½¬æ¢å’Œæ˜¾ç¤ºç±»å‹è½¬æ¢ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹éšå¼ç±»å‹è½¬æ¢ï¼š\nSELECT 1+\u0026#39;2\u0026#39; è™½ç„¶è¿™å¥ä¸­æ—¢åŒ…å«äº†æ•°å­—å’Œå­—ç¬¦ï¼Œä½†æ˜¯å­—ç¬¦ä¸²ä¼šè¢«è¿›è¡Œéšå¼è½¬æ¢ï¼ˆæ³¨æ„è¿™é‡Œå¹¶ä¸æ˜¯æŒ‰ç…§å­—ç¬¦çš„ASCIIç è½¬æ¢ï¼Œè€Œæ˜¯å†™çš„å¤šå°‘è¡¨ç¤ºå¤šå°‘ï¼‰æ‰€ä»¥æœ€åå¾—åˆ°çš„å°±æ˜¯1+2çš„ç»“æœä¸º3\nSELECT CONCAT(1, \u0026#39;2\u0026#39;) è¿™é‡Œå› ä¸ºéœ€è¦ä¼ å…¥å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬ç»™çš„æ˜¯1è¿™ä¸ªæ•°å­—ï¼Œå› æ­¤è¿™é‡Œä¹Ÿä¼šå‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ï¼Œ1ä¼šè¢«ç›´æ¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„'1\u0026rsquo;ï¼Œæ‰€ä»¥è¿™é‡Œå¾—åˆ°çš„ç»“æœæ˜¯'12'\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢æ¥å°†å¾—åˆ°çš„æ•°æ®è½¬æ¢æˆæˆ‘ä»¬éœ€è¦çš„æ•°æ®ç±»å‹ï¼Œè¿™æ—¶å°±éœ€è¦ç”¨åˆ°ç±»å‹è½¬æ¢å‡½æ•°äº†ï¼ŒMySQLæä¾›äº†ï¼š\ncast(æ•°æ® as æ•°æ®ç±»å‹) æ•°æ®ç±»å‹æœ‰ä»¥ä¸‹å‡ ç§ï¼š\nBINARY[(N)] ï¼šäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè½¬æ¢åé•¿åº¦å°äºNä¸ªå­—èŠ‚ CHAR[(N)] ï¼šå­—ç¬¦ä¸²ï¼Œè½¬æ¢åé•¿åº¦å°äºNä¸ªå­—ç¬¦ DATE ï¼šæ—¥æœŸ DATETIME ï¼šæ—¥æœŸæ—¶é—´ DECIMAL[(M[,N])] ï¼šæµ®ç‚¹æ•°ï¼ŒMä¸ºæ•°å­—æ€»ä½æ•°(åŒ…æ‹¬æ•´æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†)ï¼ŒNä¸ºå°æ•°ç‚¹åçš„ä½æ•° SIGNED [INTEGER] ï¼šæœ‰ç¬¦å·æ•´æ•° TIME ï¼šæ—¶é—´ UNSIGNED [INTEGER] ï¼šæ— ç¬¦å·æ•´æ•° æ¯”å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦å°†ä¸€ä¸ªæµ®ç‚¹æ•°è½¬æ¢ä¸ºä¸€ä¸ªæ•´æ•°ï¼š\nSELECT CAST(pi() AS SIGNED) æˆ‘ä»¬è¿˜å¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œæ‰«æï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ä¸€æ—¦é‡åˆ°éæ•°å­—çš„å­—ç¬¦ï¼Œä¼šåœæ­¢æ‰«æï¼š\nSELECT CAST(\u0026#39;123abc456\u0026#39; as SIGNED) é™¤äº†castä»¥å¤–è¿˜æœ‰convertå‡½æ•°ï¼ŒåŠŸèƒ½æ¯”è¾ƒç›¸ä¼¼ï¼Œè¿™é‡Œå°±ä¸åšè®²è§£äº†ã€‚\næµç¨‹æ§åˆ¶å‡½æ•° #\rMySQLè¿˜ä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šçš„é€»è¾‘åˆ¤æ–­å‡½æ•°ï¼Œæ¯”å¦‚ï¼š\nif(æ¡ä»¶è¡¨è¾¾å¼, ç»“æœ1, ç»“æœ2) ä¸Javaä¸­çš„ä¸‰ç›®è¿ç®—ç¬¦ä¸€è‡´ a \u0026gt; b ? \u0026ldquo;AAA\u0026rdquo; : \u0026ldquo;BBB\u0026rdquo; ifnull(å€¼1, å€¼2) å¦‚æœå€¼1ä¸ºNULLåˆ™è¿”å›å€¼2ï¼Œå¦åˆ™è¿”å›å€¼1 nullif(å€¼1, å€¼2) å¦‚æœå€¼1ä¸å€¼2ç›¸ç­‰ï¼Œé‚£ä¹ˆè¿”å›NULL isnull(å€¼) åˆ¤æ–­å€¼æ˜¯å¦ä¸ºNULL æ¯”å¦‚ç°åœ¨æˆ‘ä»¬æƒ³åˆ¤æ–­ï¼š\nSELECT IF(1 \u0026lt; 0,\u0026#39;lbwnb\u0026#39;,\u0026#39;yyds\u0026#39;) é€šè¿‡åˆ¤æ–­å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œä¸€äº›æ¡ä»¶åˆ¤æ–­æ“ä½œã€‚\né™¤äº†IFæ¡ä»¶åˆ¤æ–­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç±»ä¼¼Switchä¸€æ ·çš„è¯­å¥å®Œæˆå¤šåˆ†æ”¯ç»“æ„ï¼š\nSELECT CASE 2 WHEN 1 THEN 10 ELSE 5 END; æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è‡ªå®šä¹‰çš„åˆ¤æ–­æ¡ä»¶æ”¾å…¥Whenä¹‹åï¼Œå®ƒç±»ä¼¼äºelse-ifï¼š\nSELECT CASE WHEN 3\u0026gt;5 THEN 10 WHEN 0\u0026lt;1 THEN 11 ELSE 5 END; è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼äºJavaä¸­çš„Thread.sleepçš„å‡½æ•°ï¼Œä»¥ç§’ä¸ºå•ä½ï¼š\nSELECT sleep(10); æœ‰å…³MySQL8.0æ–°å¢çš„çª—å£å‡½æ•°è¿™é‡Œæš‚æ—¶ä¸åšä»‹ç»ã€‚\nè‡ªå®šä¹‰å‡½æ•° #\ré™¤äº†ä½¿ç”¨ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„å‡½æ•°ä»¥å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å‡½æ•°ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°è¿›è¡Œæ•°æ®å¤„ç†ï¼Œå”¯ä¸€æ¯”è¾ƒéº»çƒ¦çš„å°±æ˜¯å‡½æ•°å®šä¹‰åä¸èƒ½ä¿®æ”¹ï¼Œåªèƒ½åˆ äº†é‡æ–°å†™ã€‚\nåŸºæœ¬è¯­æ³• #\rMySQLçš„å‡½æ•°ä¸Javaä¸­çš„æ–¹æ³•ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥æ·»åŠ å‚æ•°å’Œè¿”å›å€¼ï¼Œå¯ä»¥é€šè¿‡CREATE FUNCTIONåˆ›å»ºå‡½æ•°ï¼š\nCREATE FUNCTION test() RETURNS INT BEGIN RETURN 666; END å®šä¹‰å‡½æ•°çš„æ ¼å¼ä¸ºï¼š\ncreate function å‡½æ•°åç§°([å‚æ•°åˆ—è¡¨]) returns è¿”å›å€¼ç±»å‹ begin å’Œ end ä¹‹é—´å†™å‡½æ•°çš„å…¶ä»–é€»è¾‘ï¼Œbeginå’Œendå°±ç›¸å½“äºJavaä¸­çš„èŠ±æ‹¬å·{ ... } returnåç´§è·Ÿè¿”å›çš„ç»“æœ æ·»åŠ å‚æ•°ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å‡½æ•°åç§°æ‹¬å·ä¸­æ·»åŠ å³å¯ï¼Œæ³¨æ„ç±»å‹éœ€è¦å†™åœ¨å‚æ•°åç§°åé¢ï¼š\nCREATE FUNCTION test(i INT) RETURNS INT BEGIN RETURN i * i; END æˆ‘ä»¬å¯ä»¥åœ¨BEGINå’ŒRETURNä¹‹é—´ç¼–å†™ä¸€äº›å…¶ä»–çš„é€»è¾‘ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶ä¸ºå…¶èµ‹å€¼ï¼š\nBEGIN DECLARE a INT; SET a = 10; RETURN i * i * a; END å®šä¹‰å±€éƒ¨å˜é‡çš„æ ¼å¼ä¸ºï¼š\ndeclare å˜é‡åç§° å˜é‡ç±»å‹ [, \u0026hellip;] declare å˜é‡åç§° å˜é‡ç±»å‹ default é»˜è®¤å€¼ ä¸ºå˜é‡èµ‹å€¼çš„æ ¼å¼ä¸ºï¼š\nset å˜é‡åç§° = å€¼ æˆ‘ä»¬è¿˜å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨selectè¯­å¥ï¼Œå®ƒå¯ä»¥ç›´æ¥ä»è¡¨ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å¯ä»¥ç»“åˆintoå…³é”®å­—å°†æŸ¥è¯¢ç»“æœèµ‹å€¼ç»™å˜é‡ï¼š\nBEGIN DECLARE a INT; -- select into from è¯­å¥ SELECT COUNT(*) INTO a FROM student; RETURN a; END æµç¨‹æ§åˆ¶ #\ræ¥ç€æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æµç¨‹æ§åˆ¶è¯­å¥ï¼Œå…¶ä¸­æœ€å…³é”®çš„å°±æ˜¯IFåˆ¤æ–­è¯­å¥ï¼š\nBEGIN DECLARE a INT DEFAULT 10; IF a \u0026gt; 10 THEN RETURN 1; ELSE RETURN 2; END IF; END IFåˆ†æ”¯è¯­å¥çš„æ ¼å¼ä¸ºï¼š\nif åˆ¤æ–­æ¡ä»¶ then \u0026hellip; else if åˆ¤æ–­æ¡ä»¶ then \u0026hellip;. else \u0026hellip; end if; æˆ‘ä»¬å¯ä»¥ç»“åˆexistså…³é”®å­—æ¥åˆ¤æ–­æ˜¯å¦ä¸ºNULLï¼š\nBEGIN DECLARE a INT DEFAULT 0; -- IF EXISTS(SELECT * FROM student WHERE sid = 100) THEN IF NOT EXISTS(SELECT * FROM student WHERE sid = 100) THEN SET a = 10; END IF; RETURN a; END æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å‡½æ•°ä¸­ä½¿ç”¨switchè¯­å¥ï¼š\nBEGIN DECLARE a INT DEFAULT 10; CASE a WHEN 10 THEN RETURN 2; ELSE RETURN 1; END CASE; END SWITCHåˆ†æ”¯è¯­å¥çš„æ ¼å¼ä¸ºï¼š\ncase å˜é‡ when å…·ä½“å€¼æˆ–æ˜¯å¸ƒå°”è¡¨è¾¾å¼ then \u0026hellip; when * then \u0026hellip; else \u0026hellip; end case; ä¸Javaä¸åŒçš„æ˜¯ï¼Œå®ƒæ”¯æŒä½¿ç”¨å¸ƒå°”è¡¨è¾¾å¼ï¼š\nBEGIN DECLARE a INT DEFAULT 10; CASE WHEN 1 \u0026lt; 5 THEN SET a = 5; ELSE SET a = 10; END CASE; RETURN a; END æˆ‘ä»¬ä»¥ç±»ä¼¼äºelseifçš„å½¢å¼è¿›è¡Œåˆ¤æ–­ï¼Œå…¶å®å’Œä¸Šé¢ç›´æ¥ä½¿ç”¨æ˜¯ä¸€æ ·çš„ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹å¾ªç¯è¯­å¥ï¼ŒMySQLæä¾›äº†ä¸‰ç§å¾ªç¯è¯­å¥ï¼Œå…¶ä¸­ç¬¬ä¸€ç§æ˜¯WHILEè¯­å¥ï¼š\nBEGIN DECLARE a INT DEFAULT 10; WHILE a \u0026lt; 11 DO SET a = a + 1; END WHILE; RETURN a; END æ ¼å¼ä¸ºï¼š\nwhile å¾ªç¯æ¡ä»¶ do \u0026hellip; end while; æˆ‘ä»¬æ¥ç€æ¥çœ‹ç¬¬äºŒç§å¾ªç¯è¯­å¥ï¼ŒLOOPå¾ªç¯ï¼š\nBEGIN DECLARE a INT DEFAULT 10; lp1: LOOP SET a = a - 1; IF a = 0 THEN LEAVE lp1; END IF; END LOOP lp1; RETURN a; END ç›¸æ¯”whileè¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨LEAVEç²¾å‡†æ§åˆ¶ç»“æŸå“ªä¸ªå¾ªç¯ï¼Œæœ‰ç‚¹ç±»ä¼¼äºgotoè¯­å¥ï¼š\nBEGIN DECLARE a INT DEFAULT 0; lp1: LOOP lp2: LOOP SET a = a + 1; IF a \u0026gt; 5 THEN LEAVE lp1; END IF; END LOOP lp2; END LOOP lp1; RETURN a; END ç±»ä¼¼äºJavaä¸­çš„gotoå†™æ³•ï¼ˆåœ¨JavaSEé˜¶æ®µå·²ç»è®²è§£è¿‡ï¼‰ï¼š\npublic static void main(String[] args) { int a = 0; lp1: while (true){ lp2: while (true){ a++; if(a \u0026gt; 5) break lp1; } } System.out.println(a); } å®ƒçš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š\nå¾ªç¯åç§° loop \u0026hellip;(å¯ä»¥æ’å…¥leaveè¯­å¥ç»“æŸ) end loop å¾ªç¯åç§°; æ¥ç€æˆ‘ä»¬æ¥çœ‹æœ€åä¸€ç§å¾ªç¯è¯­å¥ï¼Œrepeatè¯­å¥ï¼š\nBEGIN DECLARE a INT DEFAULT 0; REPEAT SET a = a + 1; UNTIL a \u0026gt; 0 END REPEAT; RETURN a; END å®ƒç±»ä¼¼äºJavaä¸­çš„do-whileå¾ªç¯è¯­å¥ï¼Œå®ƒä¼šå…ˆå»æ‰§è¡Œé‡Œé¢çš„å†…å®¹ï¼Œå†è¿›è¡Œåˆ¤æ–­ï¼Œæ ¼å¼ä¸ºï¼š\nrepeat \u0026hellip; until ç»“æŸå¾ªç¯æ¡ä»¶ end repeat; å…¨å±€å˜é‡ #\ræŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ä¸€æ¬¡ä¼šè¯ä¸­ç›´æ¥å®šä¹‰å˜é‡å¹¶ä½¿ç”¨ï¼Œè¿™æ—¶å®ƒå¹¶ä¸æ˜¯ä½äºå‡½æ•°å†…çš„ï¼Œè¿™å°±æ˜¯å…¨å±€å˜é‡ï¼Œå®ƒæ— éœ€é¢„å…ˆå®šä¹‰ï¼Œç›´æ¥ä½¿ç”¨å³å¯ï¼š\nset @x = 10; æˆ‘ä»¬å¯ä»¥å°†å…¨å±€å˜é‡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼š\nselect test(@x); é™¤äº†æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å…¨éƒ¨å˜é‡ä»¥å¤–ï¼Œç³»ç»Ÿé»˜è®¤ä¹Ÿæœ‰å¾ˆå¤šçš„å˜é‡ï¼Œå› æ­¤æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å˜é‡ç§°ä¸ºç”¨æˆ·å˜é‡ï¼Œç³»ç»Ÿé»˜è®¤å˜é‡ç§°ä¸ºç³»ç»Ÿå˜é‡ã€‚æŸ¥çœ‹ç³»ç»Ÿå˜é‡çš„å‘½ä»¤ä¸ºï¼š\nshow GLOBAL VARIABLES å­˜å‚¨è¿‡ç¨‹ #\rå­˜å‚¨è¿‡ç¨‹æ˜¯ä¸€ä¸ªåŒ…æ‹¬å¤šæ¡SQLè¯­å¥çš„é›†åˆï¼Œä¸“ç”¨äºç‰¹å®šè¡¨çš„ç‰¹å®šæ“ä½œï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰å®æˆ˜é¡¹ç›®ä¸­çš„åˆ›å»ºç”¨æˆ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä¸€æ¬¡æ€§ä¸ºä¸¤å¼ è¡¨æ·»åŠ æ•°æ®ï¼Œä½†æ˜¯å¦‚æœä¸ä½¿ç”¨Javaï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½å»ä½¿ç”¨SQLå‘½ä»¤æ¥å®Œæˆï¼Œå°±éœ€è¦æ‰‹åŠ¨æ•²ä¸¤æ¬¡å‘½ä»¤ï¼Œéå¸¸éº»çƒ¦ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æå‰å°†è¿™äº›æ“ä½œå®šä¹‰å¥½ï¼Œé¢„ç•™å‡ºéœ€è¦å¡«å†™æ•°æ®çš„ä½ç½®ï¼Œä¸‹æ¬¡è¾“å…¥å‚æ•°ç›´æ¥è°ƒç”¨å³å¯ã€‚\nè¿™é‡Œå¾ˆå®¹æ˜“ä¸å‡½æ•°ææ··æ·†ï¼Œå­˜å‚¨è¿‡ç¨‹ä¹Ÿæ˜¯æ‰§è¡Œå¤šæ¡SQLè¯­å¥ï¼Œä½†æ˜¯å®ƒä»¬çš„å‡ºå‘ç‚¹ä¸ä¸€æ ·ï¼Œå‡½æ•°æ˜¯ä¸“ç”¨äºè¿›è¡Œæ•°æ®å¤„ç†ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™è°ƒç”¨è€…ï¼Œå®ƒæ›´å¤šæƒ…å†µä¸‹æ˜¯ä¸€æ¡SQLè¯­å¥çš„å‚ä¸è€…ï¼Œæ— æ³•ç›´æ¥è¿è¡Œï¼Œå¹¶ä¸”ä¸æ¶‰åŠæŸä¸ªç‰¹å®šè¡¨ï¼š\nselect count(*) from student; è€Œå­˜å‚¨è¿‡ç¨‹æ˜¯å¤šæ¡SQLè¯­å¥çš„æ‰§è¡Œè€…ï¼Œè¿™æ˜¯å®ƒä»¬çš„æœ¬è´¨åŒºåˆ«ã€‚\nå®šä¹‰å­˜å‚¨è¿‡ç¨‹ä¸å®šä¹‰å‡½æ•°æä¸ºç›¸ä¼¼ï¼Œå®ƒä¹Ÿå¯ä»¥åŒ…å«å‚æ•°ï¼Œå‡½æ•°ä¸­ä½¿ç”¨çš„è¯­å¥è¿™é‡Œä¹Ÿèƒ½ä½¿ç”¨ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰è¿”å›å€¼ï¼š\nCREATE PROCEDURE lbwnb(`name` VARCHAR(20), pwd VARCHAR(255)) BEGIN INSERT INTO users(username, `password`) VALUES(`name`, pwd); END æˆ‘ä»¬å¯ä»¥åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­ç¼–å†™å¤šæ¡SQLè¯­å¥ï¼Œä½†æ˜¯æ³¨æ„ï¼ŒMySQLçš„å­˜å‚¨è¿‡ç¨‹ä¸å…·æœ‰åŸå­æ€§ï¼Œå½“å‡ºç°é”™è¯¯æ—¶ï¼Œå¹¶ä¸ä¼šå›æ»šä¹‹å‰çš„æ“ä½œï¼Œå› æ­¤éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç¼–å†™äº‹åŠ¡ä¿è¯åŸå­æ€§ã€‚\næ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼š\nCALL lbwnb(\u0026#39;111\u0026#39;, \u0026#39;2222\u0026#39;) é€šè¿‡ä½¿ç”¨callæ¥æ‰§è¡Œä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œå¦‚æœå­˜å‚¨è¿‡ç¨‹æœ‰å‚æ•°ï¼Œé‚£ä¹ˆè¿˜éœ€è¦å¡«å†™å‚æ•°ã€‚\næ¯”å¦‚ç°åœ¨æˆ‘ä»¬æƒ³è¦å®ç°æŸ¥è¯¢ç”¨æˆ·è¡¨ï¼Œå¦‚æœåŒ…å«ç”¨æˆ·testé‚£ä¹ˆå°±åˆ é™¤ç”¨æˆ·ï¼Œå¦‚æœä¸åŒ…å«ï¼Œå°±æ·»åŠ ç”¨æˆ·ï¼š\nCREATE PROCEDURE `lbwnb`() BEGIN IF NOT EXISTS(SELECT * FROM users WHERE username = \u0026#39;test\u0026#39;) THEN INSERT INTO users(username, `password`) VALUES(\u0026#39;test\u0026#39;, \u0026#39;123456\u0026#39;); ELSE DELETE FROM users WHERE username = \u0026#39;test\u0026#39;; END IF; END è¿™é‡Œå…¶å®åªéœ€è¦ä¸€ä¸ªç®€å•çš„IFåˆ¤æ–­å³å¯å®ç°ã€‚\né‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¸Œæœ›éå†ä¸€ä¸ªSELECTè¯­å¥æŸ¥è¯¢çš„ç»“æœå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¸¸æ ‡æ¥å®Œæˆï¼š\nBEGIN DECLARE id INT; DECLARE `name` VARCHAR(10); DECLARE sex VARCHAR(5); DECLARE cur CURSOR FOR SELECT * FROM student; OPEN cur; WHILE TRUE DO FETCH cur INTO id, `name`, sex; SELECT id, `name`, sex; END WHILE; CLOSE cur; END æ¸¸æ ‡çš„ä½¿ç”¨åˆ†ä¸º4ä¸ªæ­¥éª¤ï¼š\nDECLARE æ¸¸æ ‡åç§° CURSOR FOR æŸ¥è¯¢ç»“æœ - å®šä¹‰æ¸¸æ ‡ OPEN cur - å¼€å¯æ¸¸æ ‡ FETCH æ¸¸æ ‡åç§° INTO å­˜å‚¨ç»“æœçš„å˜é‡ - ä»é¡¶éƒ¨å¼€å§‹ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå‘ä¸‹ç§»åŠ¨ï¼Œå¦‚æœå·²ç»åœ¨æœ€åº•éƒ¨ï¼Œåˆ™è§¦å‘å¼‚å¸¸ CLOSE cur - å…³é—­æ¸¸æ ‡ æˆ‘ä»¬è¿™é‡Œåˆ©ç”¨äº†ä¸€ä¸ªwhileå¾ªç¯æ¥å¤šæ¬¡é€šè¿‡æ¸¸æ ‡è·å–æŸ¥è¯¢ç»“æœï¼Œä½†æ˜¯æœ€åæ˜¯å› ä¸ºå‡ºç°å¼‚å¸¸æ‰é€€å‡ºçš„ï¼Œè¿™æ ·ä¼šå¯¼è‡´ä¹‹åçš„ä»£ç å°±æ— æ³•ç»§ç»­æ­£å¸¸è¿è¡Œäº†ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹å¦‚ä½•å¤„ç†å¼‚å¸¸ï¼š\nBEGIN DECLARE id INT; DECLARE `name` VARCHAR(10); DECLARE sex VARCHAR(5); DECLARE score INT; DECLARE a INT DEFAULT 0; DECLARE cur CURSOR FOR SELECT * FROM student; -- å¿…é¡»åœ¨æ¸¸æ ‡å®šä¹‰ä¹‹åç¼–å†™ DECLARE CONTINUE HANDLER FOR 1329 SET a = 1; OPEN cur; WHILE a = 0 DO FETCH cur INTO id, `name`, sex, score; SELECT id, `name`, sex, score; END WHILE; CLOSE cur; SELECT 1; END æˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨ï¼ˆå¥æŸ„ï¼‰ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\ndeclear (continue/exit) handler for å¼‚å¸¸åç§°(ID) åšç‚¹ä»€ä¹ˆ æˆ‘ä»¬è¿˜å¯ä»¥é™å®šå­˜å‚¨è¿‡ç¨‹çš„å‚æ•°ä¼ é€’ï¼Œæ¯”å¦‚æˆ‘ä»¬åªå¸Œæœ›ç”¨æˆ·ç»™æˆ‘ä»¬ä¸€ä¸ªå‚æ•°ç”¨äºæ¥æ”¶æ•°æ®ï¼Œè€Œä¸æ˜¯å€¼ä¼ é€’ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è®¾å®šä¸ºOUTç±»å‹ï¼š\nCREATE PROCEDURE `lbwnb`(OUT a INT) BEGIN SELECT a; SET a = 100; END æ‰€æœ‰çš„å‚æ•°é»˜è®¤ä¸ºINç±»å‹ï¼Œä¹Ÿå°±æ˜¯åªèƒ½ä½œä¸ºä¼ å…¥å‚æ•°ï¼Œæ— æ³•ä¸ºå…¶èµ‹å€¼ï¼Œè€Œè¿™é‡Œè®²å‚æ•°è®¾å®šä¸ºOUTç±»å‹ï¼Œé‚£ä¹ˆå‚æ•°æ— æ³•å°†å€¼ä¼ å…¥ï¼Œè€Œåªèƒ½è¢«èµ‹å€¼ã€‚\nå¦‚æœæˆ‘ä»¬æ—¢å¸Œæœ›å‚æ•°å¯ä»¥ä¼ å…¥ä¹Ÿå¯ä»¥è¢«é‡æ–°èµ‹å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¿®æ”¹ä¸ºINOUTç±»å‹ã€‚\nå­˜å‚¨å¼•æ“ #\rå­˜å‚¨å¼•æ“å°±åƒæˆ‘ä»¬ç”µè„‘ä¸­çš„CPUï¼Œå®ƒæ˜¯æ•´ä¸ªMySQLæœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œæ•°æ®åº“ä¸­çš„æ•°æ®å¦‚ä½•å­˜å‚¨ï¼Œæ•°æ®åº“èƒ½å¤Ÿæ”¯æŒå“ªäº›åŠŸèƒ½ï¼Œæˆ‘ä»¬çš„å¢åˆ æ”¹æŸ¥è¯·æ±‚å¦‚ä½•æ‰§è¡Œï¼Œéƒ½æ˜¯ç”±å­˜å‚¨å¼•æ“æ¥å†³å®šçš„ã€‚\næˆ‘ä»¬å¯ä»¥å¤§è‡´äº†è§£ä¸€ä¸‹ä»¥ä¸‹ä¸‰ç§å­˜å‚¨å¼•æ“ï¼š\nMyISAMï¼š MySQL5.5ä¹‹å‰çš„é»˜è®¤å­˜å‚¨å¼•æ“ï¼Œåœ¨æ’å…¥å’ŒæŸ¥è¯¢çš„æƒ…å†µä¸‹æ€§èƒ½å¾ˆé«˜ï¼Œä½†æ˜¯å®ƒä¸æ”¯æŒäº‹åŠ¡ï¼Œåªèƒ½æ·»åŠ è¡¨çº§é”ã€‚ InnoDBï¼š MySQL5.5ä¹‹åçš„é»˜è®¤å­˜å‚¨å¼•æ“ï¼Œå®ƒæ”¯æŒACIDäº‹åŠ¡ã€è¡Œçº§é”ã€å¤–é”®ï¼Œä½†æ˜¯æ€§èƒ½æ¯”ä¸è¿‡MyISAMï¼Œæ›´åŠ æ¶ˆè€—èµ„æºã€‚ Memoryï¼š æ•°æ®éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ•°æ®åº“é‡å¯æˆ–å‘ç”Ÿå´©æºƒï¼Œè¡¨ä¸­çš„æ•°æ®éƒ½å°†æ¶ˆå¤±ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹MySQLæ”¯æŒçš„å­˜å‚¨å¼•æ“ï¼š\nshow engines; åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºè¡¨æŒ‡å®šå…¶å­˜å‚¨å¼•æ“ã€‚\næˆ‘ä»¬è¿˜å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹é»˜è®¤çš„å­˜å‚¨å¼•æ“ï¼Œåœ¨Windows 11ç³»ç»Ÿä¸‹ï¼ŒMySQLçš„é…ç½®æ–‡ä»¶é»˜è®¤æ”¾åœ¨C:\\ProgramData\\MySQL\\MySQL Server 5.7ä¸­ï¼Œæ³¨æ„ProgramDataæ˜¯ä¸ªéšè—æ–‡ä»¶å¤¹ã€‚\nç´¢å¼• #\ræ³¨æ„ï¼š æœ¬å°èŠ‚ä¼šæ¶‰åŠæ•°æ®ç»“æ„ä¸ç®—æ³•ç›¸å…³çŸ¥è¯†ã€‚\nç´¢å¼•å°±å¥½åƒæˆ‘ä»¬ä¹¦çš„ç›®å½•ï¼Œæ¯æœ¬ä¹¦éƒ½æœ‰ä¸€ä¸ªç›®å½•ç”¨äºæˆ‘ä»¬å¿«é€Ÿå®šä½æˆ‘ä»¬æƒ³è¦çš„å†…å®¹åœ¨å“ªä¸€é¡µï¼Œç´¢å¼•ä¹Ÿæ˜¯ï¼Œé€šè¿‡å»ºç«‹ç´¢å¼•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ç´¢å¼•æ¥å¿«é€Ÿæ‰¾åˆ°æƒ³è¦çš„ä¸€æ¡è®°å½•ï¼Œå¤§å¤§æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚\næœ¬ç‰ˆå—æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»ç´¢å¼•çš„å‡ ç§ç±»å‹ï¼Œä»¥åŠç´¢å¼•çš„åº•å±‚å­˜å‚¨åŸç†ã€‚\nå•åˆ—ç´¢å¼• #\rå•åˆ—ç´¢å¼•åªé’ˆå¯¹äºæŸä¸€åˆ—æ•°æ®åˆ›å»ºç´¢å¼•ï¼Œå•åˆ—ç´¢å¼•æœ‰ä»¥ä¸‹å‡ ç§ç±»å‹ï¼š\nNORMALï¼š æ™®é€šçš„ç´¢å¼•ç±»å‹ï¼Œå®Œå®Œå…¨å…¨ç›¸å½“äºä¸€æœ¬ä¹¦çš„ç›®å½•ã€‚ UNIQUEï¼š å”¯ä¸€ç´¢å¼•ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»ç”¨è¿‡äº†ï¼Œä¸€æ—¦å»ºç«‹å”¯ä¸€ç´¢å¼•ï¼Œé‚£ä¹ˆæ•´ä¸ªåˆ—ä¸­å°†ä¸å…è®¸å‡ºç°é‡å¤æ•°æ®ã€‚æ¯ä¸ªè¡¨çš„ä¸»é”®åˆ—ï¼Œéƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å”¯ä¸€ç´¢å¼•ï¼Œå«åšPrimary Keyï¼Œå®ƒä¸ä»…ä»…è¦æ±‚ä¸å…è®¸å‡ºç°é‡å¤ï¼Œè¿˜è¦æ±‚ä¸èƒ½ä¸ºNULLï¼Œå®ƒè¿˜å¯ä»¥è‡ªåŠ¨é€’å¢ã€‚æ¯å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªPrimaryç´¢å¼•ã€‚ SPATIALï¼š ç©ºé—´ç´¢å¼•ï¼Œç©ºé—´ç´¢å¼•æ˜¯å¯¹ç©ºé—´æ•°æ®ç±»å‹çš„å­—æ®µå»ºç«‹çš„ç´¢å¼•ï¼ŒMYSQLä¸­çš„ç©ºé—´æ•°æ®ç±»å‹æœ‰4ç§ï¼Œåˆ†åˆ«æ˜¯GEOMETRYã€POINTã€LINESTRINGã€POLYGONï¼Œä¸æ˜¯å¾ˆå¸¸ç”¨ï¼Œè¿™é‡Œä¸åšä»‹ç»ã€‚ FULLTEXTï¼š å…¨æ–‡ç´¢å¼•ï¼ˆMySQL 5.6 ä¹‹åInnoDBæ‰æ”¯æŒï¼‰ï¼Œå®ƒæ˜¯æ¨¡ç³ŠåŒ¹é…çš„ä¸€ç§æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒçš„æ•ˆç‡è¦æ¯”ä½¿ç”¨like %æ›´é«˜ï¼Œå¹¶ä¸”å®ƒè¿˜æ”¯æŒå¤šç§åŒ¹é…æ–¹å¼ï¼Œçµæ´»æ€§ä¹Ÿæ›´åŠ å¼ºå¤§ã€‚åªæœ‰å­—æ®µçš„æ•°æ®ç±»å‹ä¸º charã€varcharã€text åŠå…¶ç³»åˆ—æ‰å¯ä»¥å»ºå…¨æ–‡ç´¢å¼•ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å…¨æ–‡ç´¢å¼•ï¼Œé¦–å…ˆåˆ›å»ºä¸€å¼ ç”¨äºæµ‹è¯•å…¨æ–‡ç´¢å¼•çš„è¡¨ï¼š\nCREATE TABLE articles ( id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY, title VARCHAR(200), body TEXT, FULLTEXT (body)); INSERT INTO articles VALUES (NULL,\u0026#39;MySQL Tutorial\u0026#39;, \u0026#39;DBMS stands for DataBase ...\u0026#39;), (NULL,\u0026#39;How To Use MySQL Efficiently\u0026#39;, \u0026#39;After you went through a ...\u0026#39;), (NULL,\u0026#39;Optimising MySQL\u0026#39;,\u0026#39;In this tutorial we will show ...\u0026#39;), (NULL,\u0026#39;1001 MySQL Tricks\u0026#39;,\u0026#39;1. Never run mysqld as root. 2. ...\u0026#39;), (NULL,\u0026#39;MySQL vs. YourSQL\u0026#39;, \u0026#39;In the following database comparison ...\u0026#39;), (NULL,\u0026#39;MySQL Security\u0026#39;, \u0026#39;When configured properly, MySQL ...\u0026#39;); æœ€åæˆ‘ä»¬ä½¿ç”¨å…¨æ–‡ç´¢å¼•è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼š\nSELECT * FROM articles WHERE MATCH (body) AGAINST (\u0026#39;database\u0026#39;); æ³¨æ„å…¨æ–‡ç´¢å¼•å¦‚ä½•å®šä¹‰å­—æ®µçš„ï¼Œmatchä¸­å°±å¿…é¡»æ˜¯å“ªäº›å­—æ®µï¼Œagainstä¸­å®šä¹‰éœ€è¦æ¨¡ç³ŠåŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ç”¨ä½œæŸ¥æ‰¾çš„å­—ç¬¦ä¸²å®é™…ä¸Šæ˜¯è¢«åˆ†è¯ä¹‹åçš„ç»“æœï¼Œå¦‚æœè¿›è¡Œæ¨¡ç³ŠåŒ¹é…çš„ä¸æ˜¯ä¸€ä¸ªè¯è¯­ï¼Œé‚£ä¹ˆä¼šæŸ¥æ‰¾å¤±è´¥ï¼Œä½†æ˜¯å®ƒçš„æ•ˆç‡è¿œé«˜äºä»¥ä¸‹è¿™ç§å†™æ³•ï¼š\nSELECT * FROM articles WHERE body like \u0026#39;%database%\u0026#39;; ç»„åˆç´¢å¼• #\rç»„åˆç´¢å¼•å®é™…ä¸Šå°±æ˜¯å°†å¤šè¡Œæ†ç»‘åœ¨ä¸€èµ·ï¼Œä½œä¸ºä¸€ä¸ªç´¢å¼•ï¼Œå®ƒåŒæ ·æ”¯æŒä»¥ä¸Šå‡ ç§ç´¢å¼•ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Navicatä¸­è¿›è¡Œæ¼”ç¤ºã€‚\næ³¨æ„ç»„åˆç´¢å¼•åœ¨è¿›è¡ŒåŒ¹é…æ—¶ï¼Œéµå¾ªæœ€å·¦åŸåˆ™ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨explainè¯­å¥ï¼ˆå®ƒå¯ä»¥ç”¨äºåˆ†æselectè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼Œä¹Ÿå°±æ˜¯MySQLåˆ°åº•æ˜¯å¦‚ä½•åœ¨æ‰§è¡ŒæŸæ¡selectè¯­å¥çš„ï¼‰æ¥åˆ†ææŸ¥è¯¢è¯­å¥åˆ°åº•æœ‰æ²¡æœ‰é€šè¿‡ç´¢å¼•è¿›è¡ŒåŒ¹é…ã€‚\nexplain select * from student where name = \u0026#39;å°ç‹\u0026#39;; å¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š\nselect_typeï¼šæŸ¥è¯¢ç±»å‹ï¼Œä¸Šé¢çš„å°±æ˜¯ç®€å•æŸ¥è¯¢ï¼ˆSIMPLEï¼‰ tableï¼šæŸ¥è¯¢çš„è¡¨ typeï¼šMySQLå†³å®šå¦‚ä½•æŸ¥æ‰¾å¯¹åº”çš„è®°å½•ï¼Œæ•ˆç‡ä»é«˜åˆ°ä½ï¼šsystem \u0026gt; const \u0026gt; eq_ref \u0026gt; ref \u0026gt; range \u0026gt; index \u0026gt; all possible_keysï¼šæ‰§è¡ŒæŸ¥è¯¢æ—¶å¯èƒ½ä¼šç”¨åˆ°çš„ç´¢å¼• keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼• key_lenï¼šMysqlåœ¨ç´¢å¼•é‡Œä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå­—æ®µçš„æœ€å¤§å¯èƒ½é•¿åº¦ rowsï¼šæ‰«æçš„è¡Œæ•° extraï¼šé™„åŠ è¯´æ˜ ç´¢å¼•åº•å±‚åŸç† #\råœ¨äº†è§£å®Œäº†ç´¢å¼•çš„ç±»å‹ä¹‹åï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹ç´¢å¼•æ˜¯å¦‚ä½•å®ç°çš„ã€‚\næ—¢ç„¶æˆ‘ä»¬è¦é€šè¿‡ç´¢å¼•æ¥å¿«é€ŸæŸ¥æ‰¾å†…å®¹ï¼Œé‚£ä¹ˆå¦‚ä½•è®¾è®¡ç´¢å¼•å°±æ˜¯æˆ‘ä»¬çš„é‡ç‚¹å†…å®¹ï¼Œå› ä¸ºç´¢å¼•æ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„ï¼Œè·Ÿæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„HashMapä¹‹ç±»çš„ä¸åŒï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨å†…å­˜ä¸­çš„ï¼Œä½†æ˜¯ç¡¬ç›˜çš„è¯»å–é€Ÿåº¦è¿œå°äºå†…å­˜çš„é€Ÿåº¦ï¼Œæ¯ä¸€æ¬¡IOæ“ä½œéƒ½ä¼šè€—è´¹å¤§é‡çš„æ—¶é—´ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¯èƒ½æŠŠæ•´ä¸ªç£ç›˜ä¸Šçš„ç´¢å¼•å…¨éƒ¨å¯¼å…¥å†…å­˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è€ƒè™‘å°½å¯èƒ½å¤šçš„å‡å°‘IOæ¬¡æ•°ï¼Œç´¢å¼•çš„å®ç°å¯ä»¥ä¾é ä¸¤ç§æ•°æ®ç»“æ„ï¼Œä¸€ç§æ˜¯æˆ‘ä»¬åœ¨JavaSEé˜¶æ®µå·²ç»å­¦ä¹ è¿‡çš„Hashè¡¨ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯B-Treeã€‚\næˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹å“ˆå¸Œè¡¨ï¼Œå®é™…ä¸Šå°±æ˜¯è®¡ç®—Hashå€¼æ¥å¿«é€Ÿå®šä½ï¼š\né€šè¿‡å¯¹Keyè¿›è¡Œæ•£åˆ—å€¼è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°å¯¹åº”æ•°æ®çš„å­˜æ”¾ä½ç½®ï¼Œå®ƒçš„æŸ¥è¯¢æ•ˆç‡èƒ½å¤Ÿè¾¾åˆ°O(1)ï¼Œä½†æ˜¯å®ƒä¹Ÿå­˜åœ¨ä¸€å®šçš„ç¼ºé™·ï¼š\nHashç´¢å¼•ä»…ä»…èƒ½æ»¡è¶³â€œ=â€ï¼Œâ€œinâ€æŸ¥è¯¢æ¡ä»¶ï¼Œä¸èƒ½ä½¿ç”¨èŒƒå›´æŸ¥è¯¢ã€‚ Hashç¢°æ’é—®é¢˜ã€‚ ä¸èƒ½ç”¨éƒ¨åˆ†ç´¢å¼•é”®æ¥æœç´¢ï¼Œå› ä¸ºç»„åˆç´¢å¼•åœ¨è®¡ç®—å“ˆå¸Œå€¼çš„æ—¶å€™æ˜¯ä¸€èµ·è®¡ç®—çš„ã€‚ é‚£ä¹ˆï¼Œæ—¢ç„¶è¦è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ç§æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ç±»ä¼¼äºäºŒå‰æ ‘é‚£æ ·çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨ç´¢å¼•ï¼Œä½†æ˜¯è¿™æ ·ç›¸æ¯”ä½¿ç”¨Hashç´¢å¼•ï¼Œä¼šç‰ºç‰²ä¸€å®šçš„è¯»å–é€Ÿåº¦ã€‚\nä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰ä½¿ç”¨äºŒå‰æ ‘ï¼Œè€Œæ˜¯ä½¿ç”¨äº†BTreeï¼Œå®ƒæ˜¯ä¸“é—¨ä¸ºç£ç›˜æ•°æ®è¯»å–è®¾è®¡çš„ä¸€ç§åº¦ä¸ºnçš„æŸ¥æ‰¾æ ‘ï¼š\næ ‘ä¸­æ¯ä¸ªç»“ç‚¹æœ€å¤šå«æœ‰mä¸ªå­©å­ï¼ˆm \u0026gt;= 2ï¼‰\né™¤æ ¹ç»“ç‚¹å’Œå¶å­ç»“ç‚¹å¤–ï¼Œå…¶å®ƒæ¯ä¸ªç»“ç‚¹è‡³å°‘æœ‰[ceil(m / 2)]ä¸ªå­©å­ã€‚\nè‹¥æ ¹ç»“ç‚¹ä¸æ˜¯å¶å­ç»“ç‚¹ï¼Œåˆ™è‡³å°‘æœ‰2ä¸ªå­©å­ã€‚\næ‰€æœ‰å¶å­ç»“ç‚¹éƒ½å‡ºç°åœ¨åŒä¸€å±‚ã€‚\næ¯ä¸ªéç»ˆç«¯ç»“ç‚¹ä¸­åŒ…å«æœ‰nä¸ªé”®å€¼ä¿¡æ¯ï¼š (P1ï¼ŒK1ï¼ŒP2ï¼ŒK2ï¼ŒP3ï¼Œ\u0026hellip;\u0026hellip;ï¼ŒKnï¼ŒPn+1)ã€‚å…¶ä¸­ï¼š\nKi (i=1\u0026hellip;n)ä¸ºé”®å€¼ï¼Œä¸”é”®å€¼æŒ‰é¡ºåºå‡åºæ’åºK(i-1)\u0026lt; Kiã€‚ Piä¸ºæŒ‡å‘å­æ ‘æ ¹çš„ç»“ç‚¹ï¼Œä¸”æŒ‡é’ˆP(i)æŒ‡å‘çš„å­æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹çš„é”®å€¼å‡å°äºKiï¼Œä½†éƒ½å¤§äºK(i-1)ã€‚ é”®å€¼çš„ä¸ªæ•°nå¿…é¡»æ»¡è¶³ï¼š [ceil(m / 2)-1] \u0026lt;= n \u0026lt;= m-1ã€‚ æ¯”å¦‚ç°åœ¨æˆ‘ä»¬è¦å¯¹é”®å€¼ä¸º10çš„è®°å½•è¿›è¡ŒæŸ¥æ‰¾ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š\nè¯»å–æ ¹èŠ‚ç‚¹æ•°æ®ï¼ˆç›®å‰è¿›è¡Œäº†ä¸€æ¬¡IOæ“ä½œï¼‰ æ ¹æ®æ ¹èŠ‚ç‚¹æ•°æ®è¿›è¡Œåˆ¤æ–­å¾—åˆ°10\u0026lt;17ï¼Œå› ä¸ºP1æŒ‡å‘çš„å­æ ‘ä¸­æ‰€æœ‰å€¼éƒ½æ˜¯å°äº17çš„ï¼Œæ‰€ä»¥è¿™æ—¶æˆ‘ä»¬å°†P1æŒ‡å‘çš„èŠ‚ç‚¹è¯»å–ï¼ˆç›®å‰è¿›è¡Œäº†ä¸¤æ¬¡IOæ“ä½œï¼‰ å†æ¬¡è¿›è¡Œåˆ¤æ–­ï¼Œå¾—åˆ°8\u0026lt;10\u0026lt;12ï¼Œå› ä¸ºP2æŒ‡å‘çš„å­æ ‘ä¸­æ‰€æœ‰çš„å€¼éƒ½æ˜¯å°äº12å¤§äº8çš„ï¼Œæ‰€ä»¥è¿™æ—¶è¯»å–P2æŒ‡å‘çš„èŠ‚ç‚¹ï¼ˆç›®å‰è¿›è¡Œäº†ä¸‰æ¬¡IOæ“ä½œï¼‰ æˆåŠŸæ‰¾åˆ°ã€‚ æˆ‘ä»¬æ¥ç€æ¥çœ‹ï¼Œè™½ç„¶BTreeèƒ½å¤Ÿå¾ˆå¥½åœ°åˆ©ç”¨äºŒå‰æŸ¥æ‰¾æ ‘çš„æ€æƒ³å¤§å¹…åº¦å‡å°‘æŸ¥æ‰¾æ¬¡æ•°ï¼Œä½†æ˜¯å®ƒçš„æŸ¥æ‰¾æ•ˆç‡è¿˜æ˜¯å¾ˆä½ï¼Œå› æ­¤å®ƒçš„ä¼˜åŒ–ç‰ˆæœ¬B+Treeè¯ç”Ÿäº†ï¼Œå®ƒæ‹¥æœ‰æ›´ç¨³å®šçš„æŸ¥è¯¢æ•ˆç‡å’Œæ›´ä½çš„IOè¯»å–æ¬¡æ•°ï¼š\næˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®ƒå’ŒBTreeæœ‰ä¸€å®šçš„åŒºåˆ«ï¼š\næœ‰næ£µå­æ ‘çš„ç»“ç‚¹ä¸­å«æœ‰nä¸ªé”®å€¼ï¼ŒBTreeåªæœ‰n-1ä¸ªã€‚ æ‰€æœ‰çš„é”®å€¼ä¿¡æ¯åªåœ¨å¶å­èŠ‚ç‚¹ä¸­åŒ…å«ï¼Œéå¶å­èŠ‚ç‚¹ä»…ä»…ä¿å­˜å­èŠ‚ç‚¹çš„æœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰å€¼ï¼Œå’ŒæŒ‡å‘å¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè¿™æ ·ç›¸æ¯”BTreeæ¯ä¸€ä¸ªèŠ‚ç‚¹åœ¨ç¡¬ç›˜ä¸­å­˜æ”¾äº†æ›´å°‘çš„å†…å®¹ï¼ˆæ²¡æœ‰é”®å€¼ä¿¡æ¯äº†ï¼‰ æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæ ¹æ®å¤§å°é¡ºåºæŒ‡å‘ä¸‹ä¸€ä¸ªå¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆQï¼Œæœ¬è´¨ä¸Šæ•°æ®å°±æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚ è¿™æ ·ï¼Œè¯»å–IOçš„æ—¶é—´ç›¸æ¯”BTreeå°±å‡å°‘äº†å¾ˆå¤šï¼Œå¹¶ä¸”æŸ¥è¯¢ä»»ä½•é”®å€¼ä¿¡æ¯éƒ½éœ€è¦å®Œæ•´åœ°èµ°åˆ°å¶å­èŠ‚ç‚¹ï¼Œä¿è¯äº†æŸ¥è¯¢çš„IOè¯»å–æ¬¡æ•°ä¸€è‡´ã€‚å› æ­¤MySQLé»˜è®¤é€‰æ‹©B+Treeä½œä¸ºç´¢å¼•çš„å­˜å‚¨æ•°æ®ç»“æ„ã€‚\nè¿™æ˜¯MyISAMå­˜å‚¨å¼•æ“ä¸‹çš„B+Treeå®ç°ï¼š\nè¿™æ˜¯InnoDBå­˜å‚¨å¼•æ“ä¸‹çš„B+Treeå®ç°ï¼š\nInnoDBä¸MyISAMå®ç°çš„ä¸åŒä¹‹å¤„ï¼š\næ•°æ®æœ¬èº«å°±æ˜¯ç´¢å¼•çš„ä¸€éƒ¨åˆ†ï¼ˆæ‰€ä»¥è¿™é‡Œå»ºè®®ä¸»é”®ä½¿ç”¨è‡ªå¢ï¼‰ éä¸»é”®ç´¢å¼•çš„æ•°æ®å®é™…ä¸Šå­˜å‚¨çš„æ˜¯å¯¹åº”è®°å½•çš„ä¸»é”®å€¼ï¼ˆå› æ­¤InnoDBå¿…é¡»æœ‰ä¸»é”®ï¼Œè‹¥æ²¡æœ‰ä¹Ÿä¼šè‡ªåŠ¨æŸ¥æ‰¾æ›¿ä»£ï¼‰ é”æœºåˆ¶ #\råœ¨JavaSEçš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬åœ¨å¤šçº¿ç¨‹æ¿å—é¦–æ¬¡ç”¨åˆ°äº†é”æœºåˆ¶ï¼Œå½“æˆ‘ä»¬å¯¹æŸä¸ªæ–¹æ³•æˆ–æ˜¯æŸä¸ªä»£ç å—åŠ é”åï¼Œé™¤éé”çš„æŒæœ‰è€…é‡Šæ”¾å½“å‰çš„é”ï¼Œå¦åˆ™å…¶ä»–çº¿ç¨‹æ— æ³•è¿›å…¥æ­¤æ–¹æ³•æˆ–æ˜¯ä»£ç å—ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨é”æœºåˆ¶æ¥ä¿è¯å¤šçº¿ç¨‹ä¹‹é—´çš„å®‰å…¨æ€§ã€‚\nåœ¨MySQLä¸­ï¼Œå°±å¾ˆå®¹æ˜“å‡ºç°å¤šçº¿ç¨‹åŒæ—¶æ“ä½œè¡¨ä¸­æ•°æ®çš„æƒ…å†µï¼Œå¦‚æœè¦é¿å…æ½œåœ¨çš„å¹¶å‘é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¹‹å‰è®²è§£çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ¥å¤„ç†ï¼Œè€Œäº‹åŠ¡éš”ç¦»ä¸­åˆ©ç”¨äº†é”æœºåˆ¶ã€‚\nè¯»æœªæäº¤(Read Uncommitted)ï¼šèƒ½å¤Ÿè¯»å–åˆ°å…¶ä»–äº‹åŠ¡ä¸­æœªæäº¤çš„å†…å®¹ï¼Œå­˜åœ¨è„è¯»é—®é¢˜ã€‚ è¯»å·²æäº¤(Read Committed RC)ï¼šåªèƒ½è¯»å–å…¶ä»–äº‹åŠ¡å·²ç»æäº¤çš„å†…å®¹ï¼Œå­˜åœ¨ä¸å¯é‡å¤è¯»é—®é¢˜ã€‚ å¯é‡å¤è¯»(Repeated Read RR)ï¼šåœ¨è¯»å–æŸè¡Œåä¸å…è®¸å…¶ä»–äº‹åŠ¡æ“ä½œæ­¤è¡Œï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸï¼Œä½†æ˜¯ä¾ç„¶å­˜åœ¨å¹»è¯»é—®é¢˜ã€‚ ä¸²è¡Œè¯»(Serializable)ï¼šä¸€ä¸ªäº‹åŠ¡çš„å¼€å§‹å¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªäº‹åŠ¡çš„å®Œæˆã€‚ æˆ‘ä»¬å¯ä»¥åˆ‡æ¢éš”ç¦»çº§åˆ«åˆ†åˆ«æ¼”ç¤ºä¸€ä¸‹ï¼š\nset session transaction isolation level read uncommitted; åœ¨RRçº§åˆ«ä¸‹ï¼ŒMySQLåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å¹»è¯»é—®é¢˜ï¼š\nåœ¨å¿«ç…§è¯»ï¼ˆä¸åŠ é”ï¼‰è¯»æƒ…å†µä¸‹ï¼Œmysqlé€šè¿‡mvccæ¥é¿å…å¹»è¯»ã€‚ åœ¨å½“å‰è¯»ï¼ˆåŠ é”ï¼‰è¯»æƒ…å†µä¸‹ï¼Œmysqlé€šè¿‡next-keyæ¥é¿å…å¹»è¯»ã€‚ MVCCï¼Œå…¨ç§° Multi-Version Concurrency Control ï¼Œå³å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚MVCC æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶çš„æ–¹æ³•ï¼Œä¸€èˆ¬åœ¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ï¼Œå®ç°å¯¹æ•°æ®åº“çš„å¹¶å‘è®¿é—®ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­å®ç°äº‹åŠ¡å†…å­˜ã€‚\nè¯»é”å’Œå†™é” #\rä»å¯¹æ•°æ®çš„æ“ä½œç±»å‹ä¸Šæ¥è¯´ï¼Œé”åˆ†ä¸ºè¯»é”å’Œå†™é”ï¼š\nè¯»é”ï¼š ä¹Ÿå«å…±äº«é”ï¼Œå½“ä¸€ä¸ªäº‹åŠ¡æ·»åŠ äº†è¯»é”åï¼Œå…¶ä»–çš„äº‹åŠ¡ä¹Ÿå¯ä»¥æ·»åŠ è¯»é”æˆ–æ˜¯è¯»å–æ•°æ®ï¼Œä½†æ˜¯ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼Œåªèƒ½ç­‰åˆ°æ‰€æœ‰çš„è¯»é”å…¨éƒ¨é‡Šæ”¾ã€‚ å†™é”ï¼š ä¹Ÿå«æ’ä»–é”ï¼Œå½“ä¸€ä¸ªäº‹åŠ¡æ·»åŠ äº†å†™é”åï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½è¯»ä¸èƒ½å†™ä¹Ÿä¸èƒ½æ·»åŠ ä»»ä½•é”ï¼Œåªèƒ½ç­‰å¾…å½“å‰äº‹åŠ¡é‡Šæ”¾é”ã€‚ å…¨å±€é”ã€è¡¨é”å’Œè¡Œé” #\rä»é”çš„ä½œç”¨èŒƒå›´ä¸Šåˆ’åˆ†ï¼Œåˆ†ä¸ºå…¨å±€é”ã€è¡¨é”å’Œè¡Œé”ï¼š\nå…¨å±€é”ï¼š é”ä½œç”¨äºå…¨å±€ï¼Œæ•´ä¸ªæ•°æ®åº“çš„æ‰€æœ‰æ“ä½œå…¨éƒ¨å—åˆ°é”é™åˆ¶ã€‚ è¡¨é”ï¼š é”ä½œç”¨äºæ•´ä¸ªè¡¨ï¼Œæ‰€æœ‰å¯¹è¡¨çš„æ“ä½œéƒ½ä¼šæ”¶åˆ°é”é™åˆ¶ã€‚ è¡Œé”ï¼š é”ä½œç”¨äºè¡¨ä¸­çš„æŸä¸€è¡Œï¼Œåªä¼šé€šè¿‡é”é™åˆ¶å¯¹æŸä¸€è¡Œçš„æ“ä½œï¼ˆä»…InnoDBæ”¯æŒï¼‰ å…¨å±€é” #\ræˆ‘ä»¬é¦–å…ˆæ¥çœ‹å…¨å±€é”ï¼Œå®ƒä½œç”¨äºæ•´ä¸ªæ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¼€å¯è¯»å…¨å±€é”ï¼š\nflush tables with read lock; å¼€å¯åï¼Œæ•´ä¸ªæ•°æ®åº“è¢«ä¸Šè¯»é”ï¼Œæˆ‘ä»¬åªèƒ½å»è¯»å–æ•°æ®ï¼Œä½†æ˜¯ä¸å…è®¸è¿›è¡Œå†™æ“ä½œï¼ˆåŒ…æ‹¬æ›´æ–°ã€æ’å…¥ã€åˆ é™¤ç­‰ï¼‰ä¸€æ—¦æ‰§è¡Œå†™æ“ä½œï¼Œä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è§£é”ï¼š\nunlock tables; é™¤äº†æ‰‹åŠ¨é‡Šæ”¾é”ä¹‹å¤–ï¼Œå½“æˆ‘ä»¬çš„ä¼šè¯ç»“æŸåï¼Œé”ä¹Ÿä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ã€‚\nè¡¨é” #\rè¡¨é”ä½œç”¨äºæŸä¸€å¼ è¡¨ï¼Œä¹Ÿæ˜¯MyISAMå’ŒInnoDBå­˜å‚¨å¼•æ“æ”¯æŒçš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥ä¸ºè¡¨æ·»åŠ é”ï¼š\nlock table è¡¨åç§° read/write; åœ¨æˆ‘ä»¬ä¸ºè¡¨æ·»åŠ å†™é”åï¼Œæˆ‘ä»¬å‘ç°å…¶ä»–åœ°æ–¹æ˜¯æ— æ³•è®¿é—®æ­¤è¡¨çš„ï¼Œä¸€å¾‹éƒ½è¢«é˜»å¡ã€‚\nè¡Œé” #\rè¡¨é”çš„ä½œç”¨èŒƒå›´å¤ªå¹¿äº†ï¼Œå¦‚æœæˆ‘ä»¬ä»…ä»…åªæ˜¯å¯¹æŸä¸€è¡Œè¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆå¤§å¯ä¸å¿…å¯¹æ•´ä¸ªè¡¨è¿›è¡ŒåŠ é”ï¼Œå› æ­¤InnoDBæ”¯æŒäº†è¡Œé”ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯¹æŸä¸€è¡Œè¿›è¡ŒåŠ é”ï¼š\n-- æ·»åŠ è¯»é”ï¼ˆå…±äº«é”ï¼‰ select * from ... lock in share mode; -- æ·»åŠ å†™é”ï¼ˆæ’ä»–é”ï¼‰ select * from ... for update; ä½¿ç”¨InnoDBçš„æƒ…å†µä¸‹ï¼Œåœ¨æ‰§è¡Œæ›´æ–°ã€åˆ é™¤ã€æ’å…¥æ“ä½œæ—¶ï¼Œæ•°æ®åº“ä¹Ÿä¼šè‡ªåŠ¨ä¸ºæ‰€æ¶‰åŠçš„è¡Œæ·»åŠ å†™é”ï¼ˆæ’ä»–é”ï¼‰ï¼Œç›´åˆ°äº‹åŠ¡æäº¤æ—¶ï¼Œæ‰ä¼šé‡Šæ”¾é”ï¼Œæ‰§è¡Œæ™®é€šçš„æŸ¥è¯¢æ“ä½œæ—¶ï¼Œä¸ä¼šæ·»åŠ ä»»ä½•é”ã€‚ä½¿ç”¨MyISAMçš„æƒ…å†µä¸‹ï¼Œåœ¨æ‰§è¡Œæ›´æ–°ã€åˆ é™¤ã€æ’å…¥æ“ä½œæ—¶ï¼Œæ•°æ®åº“ä¼šå¯¹æ¶‰åŠçš„è¡¨æ·»åŠ å†™é”ï¼Œåœ¨æ‰§è¡ŒæŸ¥è¯¢æ“ä½œæ—¶ï¼Œæ•°æ®åº“ä¼šå¯¹æ¶‰åŠçš„è¡¨æ·»åŠ è¯»é”ã€‚\næé—®ï¼š å½“æˆ‘ä»¬ä¸ä½¿ç”¨idè¿›è¡Œé€‰æ‹©ï¼Œè¡Œé”ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿï¼ˆè¡Œé”å‡çº§ï¼‰\nè®°å½•é”ã€é—´éš™é”å’Œä¸´é”®é” #\ræˆ‘ä»¬çŸ¥é“InnoDBæ”¯æŒä½¿ç”¨è¡Œé”ï¼Œä½†æ˜¯è¡Œé”æ¯”è¾ƒå¤æ‚ï¼Œå®ƒå¯ä»¥ç»§ç»­åˆ†ä¸ºå¤šä¸ªç±»å‹ã€‚\nè®°å½•é” #\rï¼ˆRecord Locksï¼‰è®°å½•é”, ä»…ä»…é”ä½ç´¢å¼•è®°å½•çš„ä¸€è¡Œï¼Œåœ¨å•æ¡ç´¢å¼•è®°å½•ä¸ŠåŠ é”ã€‚Record locké”ä½çš„æ°¸è¿œæ˜¯ç´¢å¼•ï¼Œè€Œéè®°å½•æœ¬èº«ï¼Œå³ä½¿è¯¥è¡¨ä¸Šæ²¡æœ‰ä»»ä½•ç´¢å¼•ï¼Œé‚£ä¹ˆinnodbä¼šåœ¨åå°åˆ›å»ºä¸€ä¸ªéšè—çš„èšé›†ä¸»é”®ç´¢å¼•ï¼Œé‚£ä¹ˆé”ä½çš„å°±æ˜¯è¿™ä¸ªéšè—çš„èšé›†ä¸»é”®ç´¢å¼•ã€‚æ‰€ä»¥è¯´å½“ä¸€æ¡sqlæ²¡æœ‰èµ°ä»»ä½•ç´¢å¼•æ—¶ï¼Œé‚£ä¹ˆå°†ä¼šåœ¨æ¯ä¸€æ¡èšåˆç´¢å¼•åé¢åŠ å†™é”ï¼Œè¿™ä¸ªç±»ä¼¼äºè¡¨é”ï¼Œä½†åŸç†ä¸Šå’Œè¡¨é”åº”è¯¥æ˜¯å®Œå…¨ä¸åŒçš„ã€‚\né—´éš™é” #\rï¼ˆGap Locksï¼‰ä»…ä»…é”ä½ä¸€ä¸ªç´¢å¼•åŒºé—´ï¼ˆå¼€åŒºé—´ï¼Œä¸åŒ…æ‹¬åŒç«¯ç«¯ç‚¹ï¼‰ã€‚åœ¨ç´¢å¼•è®°å½•ä¹‹é—´çš„é—´éš™ä¸­åŠ é”ï¼Œæˆ–è€…æ˜¯åœ¨æŸä¸€æ¡ç´¢å¼•è®°å½•ä¹‹å‰æˆ–è€…ä¹‹ååŠ é”ï¼Œå¹¶ä¸åŒ…æ‹¬è¯¥ç´¢å¼•è®°å½•æœ¬èº«ã€‚æ¯”å¦‚åœ¨ 1ã€2ä¸­ï¼Œé—´éš™é”çš„å¯èƒ½å€¼æœ‰ (-âˆ, 1)ï¼Œ(1, 2)ï¼Œ(2, +âˆ)ï¼Œé—´éš™é”å¯ç”¨äºé˜²æ­¢å¹»è¯»ï¼Œä¿è¯ç´¢å¼•é—´çš„ä¸ä¼šè¢«æ’å…¥æ•°æ®ã€‚\nä¸´é”®é” #\rï¼ˆNext-Key Locksï¼‰Record lock + Gap lockï¼Œå·¦å¼€å³é—­åŒºé—´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒInnoDBæ­£æ˜¯ä½¿ç”¨Next-key Locksæ¥é”å®šè®°å½•ï¼ˆå¦‚select â€¦ for updateè¯­å¥ï¼‰å®ƒè¿˜ä¼šæ ¹æ®åœºæ™¯è¿›è¡Œçµæ´»å˜æ¢ï¼š\nåœºæ™¯ è½¬æ¢ ä½¿ç”¨å”¯ä¸€ç´¢å¼•è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œä½†è¡¨ä¸­ä¸å­˜åœ¨è®°å½• è‡ªåŠ¨è½¬æ¢ä¸º Gap Locks ä½¿ç”¨å”¯ä¸€ç´¢å¼•è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œä¸”è¡¨ä¸­å­˜åœ¨è®°å½• è‡ªåŠ¨è½¬æ¢ä¸º Record Locks ä½¿ç”¨éå”¯ä¸€ç´¢å¼•è¿›è¡Œç²¾ç¡®åŒ¹é… ä¸è½¬æ¢ ä½¿ç”¨å”¯ä¸€ç´¢å¼•è¿›è¡ŒèŒƒå›´åŒ¹é… ä¸è½¬æ¢ï¼Œä½†æ˜¯åªé”ä¸Šç•Œï¼Œä¸é”ä¸‹ç•Œ https://zhuanlan.zhihu.com/p/48269420\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºæŸç çŸ¥è¯†åº“ç‰ˆæƒæ‰€æœ‰ï¼Œç¦æ­¢ä¸€åˆ‡æœªç»æˆæƒçš„è½¬è½½ã€å‘å¸ƒã€å‡ºå”®ç­‰è¡Œä¸ºï¼Œè¿è€…å°†è¢«è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://www.itbaima.cn/document/vkpmw9wbej21nei6\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/mysql/","section":"Docs","summary":"MySQLé«˜çº§ #\råœ¨JavaWebé˜¶æ®µï¼Œæˆ‘ä»¬åˆæ­¥è®¤è¯†äº†MySQLæ•°æ®åº“ï¼ŒåŒ…æ‹¬ä¸€äº›åŸºæœ¬æ“ä½œï¼Œæ¯”å¦‚åˆ›å»ºæ•°æ®åº“ã€è¡¨ã€è§¦å‘å™¨ï¼Œä»¥åŠæœ€åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ã€äº‹åŠ¡ç­‰æ“ä½œã€‚è€Œåœ¨æ­¤é˜¶æ®µï¼Œæˆ‘ä»¬å°†ç»§ç»­æ·±å…¥å­¦ä¹ MySQLï¼Œäº†è§£å®ƒçš„æ›´å¤šé«˜çº§ç©æ³•ï¼Œä¹Ÿç›¸å½“äºè¿›è¡Œå¤ä¹ ã€‚\nå‡½æ•° #\rå…¶å®å‡½æ•°æˆ‘ä»¬åœ¨ä¹‹å‰å·²ç»æ¥è§¦åˆ°ä¸€éƒ¨åˆ†äº†ï¼Œåœ¨JavaWebé˜¶æ®µï¼Œæˆ‘ä»¬äº†è§£äº†èšé›†å‡½æ•°ï¼Œèšé›†å‡½æ•°ä¸€èˆ¬ç”¨ä½œç»Ÿè®¡ï¼ŒåŒ…æ‹¬ï¼š\ncount([distinct]*) ç»Ÿè®¡æ‰€æœ‰çš„è¡Œæ•°ï¼ˆdistinctè¡¨ç¤ºå»é‡å†ç»Ÿè®¡ï¼Œä¸‹åŒï¼‰ count([distinct]åˆ—å) ç»Ÿè®¡æŸåˆ—çš„å€¼æ€»å’Œ sum([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„å’Œï¼ˆæ³¨æ„å¿…é¡»æ˜¯æ•°å­—ç±»å‹çš„ï¼‰ avg([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„å¹³å‡å€¼ï¼ˆæ³¨æ„å¿…é¡»æ˜¯æ•°å­—ç±»å‹ï¼‰ max([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„æœ€å¤§å€¼ min([distinct]åˆ—å) æ±‚ä¸€åˆ—çš„æœ€å°å€¼ æ¯”å¦‚æˆ‘ä»¬éœ€è¦è®¡ç®—æŸä¸ªè¡¨ä¸€å…±æœ‰å¤šå°‘è¡Œï¼š\nSELECT COUNT(*) FROM student é€šè¿‡ä½¿ç”¨COUNTèšé›†å‡½æ•°ï¼Œå°±å¯ä»¥å¿«é€Ÿç»Ÿè®¡å¹¶å¾—åˆ°ç»“æœï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è®¡ç®—æŸä¸€åˆ—ä¸Šæ‰€æœ‰æ•°å­—çš„å’Œï¼š\nSELECT SUM(sid) FROM student é€šè¿‡SUMèšé›†å‡½æ•°ï¼Œå°±å¯ä»¥å¿«é€Ÿè®¡ç®—æ¯ä¸€åˆ—çš„å’Œï¼Œå®é™…ä¸Šè¿™äº›å‡½æ•°éƒ½æ˜¯ç”±ç³»ç»Ÿæä¾›çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚","title":"Mysql","type":"doc"},{"content":"\rNettyæ¡†æ¶ #\rå‰é¢æˆ‘ä»¬å­¦ä¹ äº†Javaä¸ºæˆ‘ä»¬æä¾›çš„NIOæ¡†æ¶ï¼Œæä¾›ä½¿ç”¨NIOæä¾›çš„ä¸‰å¤§ç»„ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™æ›´åŠ é«˜æ€§èƒ½çš„å®¢æˆ·ç«¯/æœåŠ¡ç«¯ç½‘ç»œç¨‹åºäº†ï¼Œç”šè‡³è¿˜å¯ä»¥è‡ªè¡Œè§„å®šä¸€ç§é€šä¿¡åè®®è¿›è¡Œé€šä¿¡ã€‚\nNIOæ¡†æ¶å­˜åœ¨çš„é—®é¢˜ #\rä½†æ˜¯ä¹‹å‰æˆ‘ä»¬åœ¨ä½¿ç”¨NIOæ¡†æ¶çš„æ—¶å€™ï¼Œè¿˜æ˜¯å‘ç°äº†ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ¥ç›˜ç‚¹ä¸€ä¸‹ã€‚\nå®¢æˆ·ç«¯å…³é—­å¯¼è‡´æœåŠ¡ç«¯ç©ºè½®è¯¢ #\rå¯èƒ½åœ¨ä¹‹å‰çš„å®éªŒä¸­ï¼Œä½ å‘ç°äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š\nå½“æˆ‘ä»¬çš„å®¢æˆ·ç«¯ä¸»åŠ¨ä¸æœåŠ¡ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œä¼šå¯¼è‡´READäº‹ä»¶ä¸€ç›´è¢«è§¦å‘ï¼Œä¹Ÿå°±æ˜¯è¯´selector.select()ä¼šç›´æ¥é€šè¿‡ï¼Œå¹¶ä¸”æ˜¯å¯è¯»çš„çŠ¶æ€ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å®é™…ä¸Šè¯»åˆ°æ˜¯æ•°æ®æ˜¯ä¸€ä¸ªç©ºçš„ï¼ˆä¸Šé¢çš„å›¾ä¸­åœ¨ç©ºè½®è¯¢ä¸¤æ¬¡åæŠ›å‡ºå¼‚å¸¸äº†ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ— é™çš„å¾ªç¯ä¸‹å»ï¼‰æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¾—ç¨å¾®å¤„ç†ä¸€ä¸‹ï¼š\n} else if(key.isReadable()) { SocketChannel channel = (SocketChannel) key.channel(); ByteBuffer buffer = ByteBuffer.allocate(128); //è¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸‹ï¼Œå¦‚æœreadæ“ä½œå¾—åˆ°çš„ç»“æœæ˜¯-1ï¼Œé‚£ä¹ˆè¯´æ˜æœåŠ¡ç«¯å·²ç»æ–­å¼€è¿æ¥äº† if(channel.read(buffer) \u0026lt; 0) { System.out.println(\u0026#34;å®¢æˆ·ç«¯å·²ç»æ–­å¼€è¿æ¥äº†ï¼š\u0026#34;+channel.getRemoteAddress()); channel.close(); //ç›´æ¥å…³é—­æ­¤é€šé“ continue; //ç»§ç»­è¿›è¡Œé€‰æ‹© } buffer.flip(); System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); channel.write(ByteBuffer.wrap(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€æ—¶å…³é—­è¿æ¥äº†ï¼š\nå½“ç„¶ï¼Œé™¤äº†è¿™ç§æƒ…å†µå¯èƒ½ä¼šå¯¼è‡´ç©ºè½®è¯¢ä¹‹å¤–ï¼Œå®é™…ä¸Šè¿˜æœ‰ä¸€ç§å¯èƒ½ï¼Œè¿™ç§æƒ…å†µæ˜¯NIOæ¡†æ¶æœ¬èº«çš„BUGï¼š\nwhile (true) { int count = selector.select(); //ç”±äºåº•å±‚epollæœºåˆ¶çš„é—®é¢˜ï¼Œå¯¼è‡´selectæ–¹æ³•å¯èƒ½ä¼šä¸€ç›´è¿”å›0ï¼Œé€ æˆæ— é™å¾ªç¯çš„æƒ…å†µã€‚ System.out.println(\u0026#34;ç›‘å¬åˆ° \u0026#34;+count+\u0026#34; ä¸ªäº‹ä»¶\u0026#34;); Set\u0026lt;SelectionKey\u0026gt; selectionKeys = selector.selectedKeys(); Iterator\u0026lt;SelectionKey\u0026gt; iterator = selectionKeys.iterator(); è¯¦ç»†è¯·çœ‹JDKå®˜æ–¹BUGåé¦ˆï¼š\nJDK-6670302 : (se) NIO selector wakes up with 0 selected keys infinitely JDK-6403933 : (se) Selector doesn\u0026rsquo;t block on Selector.select(timeout) (lnx) æœ¬è´¨åŸå› ä¹Ÿæ˜¯å› ä¸ºå®¢æˆ·ç«¯çš„ä¸»åŠ¨æ–­å¼€å¯¼è‡´ï¼š\nThis is an issue with poll (and epoll) on Linux. If a file descriptor for a connected socket is polled with a request event mask of 0, and if the connection is abruptly terminated (RST) then the poll wakes up with the POLLHUP (and maybe POLLERR) bit set in the returned event set. The implication of this behaviour is that Selector will wakeup and as the interest set for the SocketChannel is 0 it means there aren\u0026rsquo;t any selected events and the select method returns 0.\nè¿™ä¸ªé—®é¢˜æœ¬è´¨æ˜¯ä¸æ“ä½œç³»ç»Ÿæœ‰å…³çš„ï¼Œæ‰€ä»¥JDKä¸€ç›´éƒ½è®¤ä¸ºæ˜¯æ“ä½œç³»ç»Ÿçš„é—®é¢˜ï¼Œä¸åº”è¯¥ç”±è‡ªå·±æ¥å¤„ç†ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜åœ¨å½“æ—¶çš„å¥½å‡ ä¸ªJDKç‰ˆæœ¬éƒ½æ˜¯å­˜åœ¨çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆä¸¥é‡çš„ç©ºè½¬é—®é¢˜ï¼Œæ— é™åˆ¶åœ°è¿›è¡Œç©ºè½¬æ“ä½œä¼šå¯¼è‡´CPUèµ„æºè¢«ç–¯ç‹‚æ¶ˆè€—ã€‚\nä¸è¿‡ï¼Œè¿™ä¸ªé—®é¢˜ï¼Œå´è¢«Nettyæ¡†æ¶å·§å¦™è§£å†³äº†ï¼Œæˆ‘ä»¬åé¢å†è¯´ã€‚\nç²˜åŒ…/æ‹†åŒ…é—®é¢˜ #\ré™¤äº†ä¸Šé¢çš„é—®é¢˜ä¹‹å¤–ï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹ä¸‹ä¸€ä¸ªé—®é¢˜ã€‚\næˆ‘ä»¬åœ¨è®¡ç®—æœºç½‘ç»œè¿™é—¨è¯¾ç¨‹ä¸­å­¦ä¹ è¿‡ï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡TCPåè®®å‘é€æ•°æ®çš„æ—¶å€™ï¼Œä¹Ÿä¼šå…ˆå°†æ•°æ®å­˜æ”¾åœ¨ç¼“å†²åŒºä¸­ï¼Œè€Œè‡³äºä»€ä¹ˆæ—¶å€™çœŸæ­£åœ°å‘å‡ºè¿™äº›æ•°æ®ï¼Œæ˜¯ç”±TCPåè®®æ¥å†³å®šçš„ï¼Œè¿™æ˜¯æˆ‘ä»¬æ— æ³•æ§åˆ¶çš„äº‹æƒ…ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬è¦å‘é€ä¸¤ä¸ªæ•°æ®åŒ…ï¼ˆP1/P2ï¼‰ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ªåŒ…åº”è¯¥æ˜¯ä¾æ¬¡åˆ°è¾¾æœåŠ¡ç«¯ï¼Œå¹¶ç”±æœåŠ¡ç«¯æ­£ç¡®è¯»å–ä¸¤æ¬¡æ•°æ®å‡ºæ¥ï¼Œä½†æ˜¯ç”±äºä¸Šé¢çš„æœºåˆ¶ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼š\nå¯èƒ½P1å’ŒP2è¢«åˆåœ¨ä¸€èµ·å‘é€ç»™äº†æœåŠ¡ç«¯ï¼ˆç²˜åŒ…ç°è±¡ï¼‰ å¯èƒ½P1å’ŒP2çš„å‰åŠéƒ¨åˆ†åˆåœ¨ä¸€èµ·å‘é€ç»™äº†æœåŠ¡ç«¯ï¼ˆæ‹†åŒ…ç°è±¡ï¼‰ å¯èƒ½P1çš„å‰åŠéƒ¨åˆ†å°±è¢«å•ç‹¬ä½œä¸ºä¸€ä¸ªéƒ¨åˆ†å‘ç»™äº†æœåŠ¡ç«¯ï¼Œåé¢çš„å’ŒP2ä¸€èµ·å‘ç»™æœåŠ¡ç«¯ï¼ˆä¹Ÿæ˜¯æ‹†åŒ…ç°è±¡ï¼‰ å½“ç„¶ï¼Œå¯¹äºè¿™ç§é—®é¢˜ï¼Œä¹Ÿæœ‰ä¸€äº›æ¯”è¾ƒå¸¸è§çš„è§£å†³æ–¹æ¡ˆï¼š\næ¶ˆæ¯å®šé•¿ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹è§„å®šå›ºå®šå¤§å°çš„æ¶ˆæ¯é•¿åº¦ï¼Œä¾‹å¦‚æ¯ä¸ªæ•°æ®åŒ…å¤§å°å›ºå®šä¸º200å­—èŠ‚ï¼Œå¦‚æœä¸å¤Ÿï¼Œç©ºä½è¡¥ç©ºæ ¼ï¼Œåªæœ‰æ¥æ”¶äº†200ä¸ªå­—èŠ‚ä¹‹åï¼Œä½œä¸ºä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…è¿›è¡Œå¤„ç†ã€‚ åœ¨æ¯ä¸ªåŒ…çš„æœ«å°¾ä½¿ç”¨å›ºå®šçš„åˆ†éš”ç¬¦ï¼Œæ¯”å¦‚æ¯ä¸ªæ•°æ®åŒ…æœ«å°¾éƒ½æ˜¯\\r\\nï¼Œè¿™æ ·å°±ä¸€å®šéœ€è¦è¯»å–åˆ°è¿™æ ·çš„åˆ†éš”ç¬¦æ‰èƒ½å°†å‰é¢æ‰€æœ‰çš„æ•°æ®ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…è¿›è¡Œå¤„ç†ã€‚ å°†æ¶ˆæ¯åˆ†ä¸ºå¤´éƒ¨å’Œæœ¬ä½“ï¼Œåœ¨å¤´éƒ¨ä¸­ä¿å­˜æœ‰å½“å‰æ•´ä¸ªæ•°æ®åŒ…çš„é•¿åº¦ï¼Œåªæœ‰åœ¨è¯»åˆ°è¶³å¤Ÿé•¿åº¦ä¹‹åæ‰ç®—æ˜¯è¯»åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…ã€‚ è¿™é‡Œæˆ‘ä»¬å°±æ¥æ¼”ç¤ºä¸€ä¸‹ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆï¼š\npublic static void main(String[] args) { try (ServerSocketChannel serverChannel = ServerSocketChannel.open(); Selector selector = Selector.open()){ serverChannel.bind(new InetSocketAddress(8080)); serverChannel.configureBlocking(false); serverChannel.register(selector, SelectionKey.OP_ACCEPT); //ä¸€ä¸ªæ•°æ®åŒ…è¦æ±‚å¿…é¡»å¡æ»¡30ä¸ªå­—èŠ‚ ByteBuffer buffer = ByteBuffer.allocate(30); while (true) { int count = selector.select(); Set\u0026lt;SelectionKey\u0026gt; selectionKeys = selector.selectedKeys(); Iterator\u0026lt;SelectionKey\u0026gt; iterator = selectionKeys.iterator(); while (iterator.hasNext()) { ... if(buffer.remaining() == 0) { buffer.flip(); System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); buffer.clear(); } channel.write(ByteBuffer.wrap((\u0026#34;å·²æ”¶åˆ° \u0026#34;+size+\u0026#34; å­—èŠ‚çš„æ•°æ®ï¼\u0026#34;).getBytes())); } ... ç°åœ¨ï¼Œå½“æˆ‘ä»¬çš„å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯æ—¶ï¼Œå¦‚æœæ²¡æœ‰è¾¾åˆ°30ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆä¼šæš‚æ—¶å­˜å‚¨èµ·æ¥ï¼Œç­‰æœ‰30ä¸ªä¹‹åå†ä¸€æ¬¡æ€§å¾—åˆ°ï¼Œå½“ç„¶å¦‚æœæ•°æ®é‡è¶…è¿‡äº†30ï¼Œé‚£ä¹ˆæœ€å¤šä¹Ÿåªä¼šè¯»å–30ä¸ªå­—èŠ‚ï¼Œå…¶ä»–çš„æ”¾åœ¨ä¸‹ä¸€æ‰¹ï¼š\nè¿™æ ·å°±å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³ç²˜åŒ…/æ‹†åŒ…é—®é¢˜äº†ã€‚\næ€»çš„é€šè¿‡æ¶ˆæ¯å®šé•¿\nèµ°è¿›Nettyæ¡†æ¶ #\rå‰é¢æˆ‘ä»¬ç›˜ç‚¹äº†ä¸€ä¸‹NIOå­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼Œè€Œåœ¨Nettyæ¡†æ¶ä¸­ï¼Œè¿™äº›é—®é¢˜éƒ½è¢«å·§å¦™çš„è§£å†³äº†ã€‚\nNettyæ˜¯ç”±JBOSSæä¾›çš„ä¸€ä¸ªå¼€æºçš„javaç½‘ç»œç¼–ç¨‹æ¡†æ¶ï¼Œä¸»è¦æ˜¯å¯¹javaçš„nioåŒ…è¿›è¡Œäº†å†æ¬¡å°è£…ã€‚Nettyæ¯”javaåŸç”Ÿçš„nioåŒ…æä¾›äº†æ›´åŠ å¼ºå¤§ã€ç¨³å®šçš„åŠŸèƒ½å’Œæ˜“äºä½¿ç”¨çš„apiã€‚ nettyçš„ä½œè€…æ˜¯Trustin Leeï¼Œè¿™æ˜¯ä¸€ä¸ªéŸ©å›½äººï¼Œä»–è¿˜å¼€å‘äº†å¦å¤–ä¸€ä¸ªè‘—åçš„ç½‘ç»œç¼–ç¨‹æ¡†æ¶ï¼Œminaã€‚äºŒè€…åœ¨å¾ˆå¤šæ–¹é¢éƒ½ååˆ†ç›¸ä¼¼ï¼Œå®ƒä»¬çš„çº¿ç¨‹æ¨¡å‹ä¹Ÿæ˜¯åŸºæœ¬ä¸€è‡´ ã€‚ä¸è¿‡nettyç¤¾åŒºçš„æ´»è·ƒç¨‹åº¦è¦minaé«˜å¾—å¤šã€‚\nNettyå®é™…ä¸Šåº”ç”¨åœºæ™¯éå¸¸å¤šï¼Œæ¯”å¦‚æˆ‘ä»¬çš„Minecraftæ¸¸æˆæœåŠ¡å™¨ï¼š\nJavaç‰ˆæœ¬çš„MinecraftæœåŠ¡å™¨å°±æ˜¯ä½¿ç”¨Nettyæ¡†æ¶ä½œä¸ºç½‘ç»œé€šä¿¡çš„åŸºç¡€ï¼Œæ­£æ˜¯å¾—ç›ŠäºNettyæ¡†æ¶çš„é«˜æ€§èƒ½ï¼Œæˆ‘ä»¬æ‰èƒ½æ„‰å¿«åœ°å’Œå…¶ä»–çš„å°ä¼™ä¼´ä¸€èµ·åœ¨æœåŠ¡å™¨é‡Œé¢ç‚¸æœã€‚\nå­¦ä¹ äº†Nettyæ¡†æ¶åï¼Œè¯´ä¸å®šä½ ä¹Ÿå¯ä»¥æ‘¸ç´¢åˆ°éƒ¨åˆ†Minecraftæ’ä»¶/æ¨¡ç»„å¼€å‘çš„åº•å±‚ç»†èŠ‚ï¼ˆå¤ªæŠ˜ç£¨äº†ï¼ŒUPä¸»é«˜ä¸­æäº†å¤§åŠå¹´è¿™ç©æ„ï¼‰\nå½“ç„¶é™¤äº†æ¸¸æˆæœåŠ¡å™¨ä¹‹å¤–ï¼Œæˆ‘ä»¬å¾®æœåŠ¡ä¹‹é—´çš„è¿œç¨‹è°ƒç”¨ä¹Ÿå¯ä»¥ä½¿ç”¨Nettyæ¥å®Œæˆï¼Œæ¯”å¦‚Dubboçš„RPCæ¡†æ¶ï¼ŒåŒ…æ‹¬æœ€æ–°çš„SpringWebFluxæ¡†æ¶ï¼Œä¹ŸæŠ›å¼ƒäº†å†…åµŒTomcatè€Œä½¿ç”¨Nettyä½œä¸ºé€šä¿¡æ¡†æ¶ã€‚æ—¢ç„¶Nettyè¿™ä¹ˆå¼ºå¤§ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬å°±å¼€å§‹Nettyçš„å­¦ä¹ å§ï¼\nå¯¼åŒ…å…ˆï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.netty\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;netty-all\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.1.76.Final\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; ByteBufä»‹ç» #\rNettyå¹¶æ²¡æœ‰ä½¿ç”¨NIOä¸­æä¾›çš„ByteBufferæ¥è¿›è¡Œæ•°æ®è£…è½½ï¼Œè€Œæ˜¯è‡ªè¡Œå®šä¹‰äº†ä¸€ä¸ªByteBufç±»ã€‚\né‚£ä¹ˆè¿™ä¸ªç±»ç›¸æ¯”NIOä¸­çš„ByteBufferæœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„å‘¢ï¼Ÿ\nå†™æ“ä½œå®Œæˆåæ— éœ€è¿›è¡Œflip()ç¿»è½¬ã€‚ å…·æœ‰æ¯”ByteBufferæ›´å¿«çš„å“åº”é€Ÿåº¦ã€‚ åŠ¨æ€æ‰©å®¹ã€‚ é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„å†…éƒ¨ç»“æ„ï¼š\npublic abstract class AbstractByteBuf extends ByteBuf { ... int readerIndex; //indexè¢«åˆ†ä¸ºäº†è¯»å’Œå†™ï¼Œæ˜¯ä¸¤ä¸ªæŒ‡é’ˆåœ¨åŒæ—¶å·¥ä½œ int writerIndex; private int markedReaderIndex; //markæ“ä½œä¹Ÿåˆ†ä¸¤ç§ private int markedWriterIndex; private int maxCapacity; //æœ€å¤§å®¹é‡ï¼Œæ²¡é”™ï¼Œè¿™ç©æ„èƒ½åŠ¨æ€æ‰©å®¹ å¯ä»¥çœ‹åˆ°ï¼Œè¯»æ“ä½œå’Œå†™æ“ä½œåˆ†åˆ«ç”±ä¸¤ä¸ªæŒ‡é’ˆåœ¨è¿›è¡Œç»´æŠ¤ï¼Œæ¯å†™å…¥ä¸€æ¬¡ï¼ŒwriterIndexå‘åç§»åŠ¨ä¸€ä½ï¼Œæ¯è¯»å–ä¸€æ¬¡ï¼Œä¹Ÿæ˜¯readerIndexå‘åç§»åŠ¨ä¸€ä½ï¼Œå½“ç„¶readerIndexä¸èƒ½å¤§äºwriterIndexï¼Œè¿™æ ·å°±ä¸ä¼šåƒNIOä¸­çš„ByteBufferé‚£æ ·è¿˜éœ€è¦è¿›è¡Œç¿»è½¬äº†ã€‚\nå…¶ä¸­readerIndexå’ŒwriterIndexä¹‹é—´çš„éƒ¨åˆ†å°±æ˜¯æ˜¯å¯è¯»çš„å†…å®¹ï¼Œè€ŒwriterIndexä¹‹ååˆ°capacityéƒ½æ˜¯å¯å†™çš„éƒ¨åˆ†ã€‚\næˆ‘ä»¬æ¥å®é™…ä½¿ç”¨ä¸€ä¸‹çœ‹çœ‹ï¼š\npublic static void main(String[] args) { //åˆ›å»ºä¸€ä¸ªåˆå§‹å®¹é‡ä¸º10çš„ByteBufç¼“å†²åŒºï¼Œè¿™é‡Œçš„Unpooledæ˜¯ç”¨äºå¿«é€Ÿç”ŸæˆByteBufçš„å·¥å…·ç±» //è‡³äºä¸ºå•¥å«Unpooledæ˜¯æ± åŒ–çš„æ„æ€ï¼ŒByteBufæœ‰æ± åŒ–å’Œéæ± åŒ–ä¸¤ç§ï¼ŒåŒºåˆ«åœ¨äºå¯¹å†…å­˜çš„å¤ç”¨ï¼Œæˆ‘ä»¬ä¹‹åå†è®¨è®º ByteBuf buf = Unpooled.buffer(10); System.out.println(\u0026#34;åˆå§‹çŠ¶æ€ï¼š\u0026#34;+Arrays.toString(buf.array())); buf.writeInt(-888888888); //å†™å…¥ä¸€ä¸ªIntæ•°æ® System.out.println(\u0026#34;å†™å…¥Intåï¼š\u0026#34;+Arrays.toString(buf.array())); buf.readShort(); //æ— éœ€ç¿»è½¬ï¼Œç›´æ¥è¯»å–ä¸€ä¸ªshortæ•°æ®å‡ºæ¥ System.out.println(\u0026#34;è¯»å–Shortåï¼š\u0026#34;+Arrays.toString(buf.array())); buf.discardReadBytes(); //ä¸¢å¼ƒæ“ä½œï¼Œä¼šå°†å½“å‰çš„å¯è¯»éƒ¨åˆ†å†…å®¹ä¸¢åˆ°æœ€å‰é¢ï¼Œå¹¶ä¸”è¯»å†™æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸¢å¼ƒçš„è·ç¦» System.out.println(\u0026#34;ä¸¢å¼ƒä¹‹åï¼š\u0026#34;+Arrays.toString(buf.array())); buf.clear(); //æ¸…ç©ºæ“ä½œï¼Œæ¸…ç©ºä¹‹åè¯»å†™æŒ‡é’ˆéƒ½å½’é›¶ System.out.println(\u0026#34;æ¸…ç©ºä¹‹åï¼š\u0026#34;+Arrays.toString(buf.array())); } é€šè¿‡ç»“åˆæ–­ç‚¹è°ƒè¯•ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿè¯»å†™æŒ‡é’ˆçš„ç§»åŠ¨æƒ…å†µï¼Œæ›´åŠ æ¸…æ¥šçš„è®¤è¯†ä¸€ä¸‹ByteBufçš„åº•å±‚æ“ä½œã€‚\næˆ‘ä»¬å†æ¥çœ‹çœ‹åˆ’åˆ†æ“ä½œæ˜¯ä¸æ˜¯å’Œä¹‹å‰ä¸€æ ·çš„ï¼š\npublic static void main(String[] args) { //æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€ä¸ªbyte[]ç›´æ¥åŒ…è£…è¿›ç¼“å†²åŒºï¼ˆå’ŒNIOæ˜¯ä¸€æ ·çš„ï¼‰ä¸è¿‡å†™æŒ‡é’ˆçš„å€¼ä¸€å¼€å§‹å°±è·‘åˆ°æœ€åå»äº†ï¼Œä½†æ˜¯è¿™ç©æ„æ˜¯ä¸æ˜¯åªè¯»çš„ ByteBuf buf = Unpooled.wrappedBuffer(\u0026#34;abcdefg\u0026#34;.getBytes()); //é™¤äº†åŒ…è£…ï¼Œä¹Ÿå¯ä»¥å¤åˆ¶æ•°æ®ï¼ŒcopiedBuffer()ä¼šå®Œå®Œæ•´æ•´å°†æ•°æ®æ‹·è´åˆ°ä¸€ä¸ªæ–°çš„ç¼“å†²åŒºä¸­ buf.readByte(); //è¯»å–ä¸€ä¸ªå­—èŠ‚ ByteBuf slice = buf.slice(); //ç°åœ¨è¯»æŒ‡é’ˆä½äº1ï¼Œç„¶åè¿›è¡Œåˆ’åˆ† System.out.println(slice.arrayOffset()); //å¾—åˆ°åˆ’åˆ†å‡ºæ¥çš„ByteBufçš„åç§»åœ°å€ System.out.println(Arrays.toString(slice.array())); } å¯ä»¥çœ‹åˆ°ï¼Œåˆ’åˆ†ä¹Ÿæ˜¯æ ¹æ®å½“å‰è¯»å–çš„ä½ç½®æ¥è¿›è¡Œçš„ã€‚\næˆ‘ä»¬ç»§ç»­æ¥çœ‹çœ‹å®ƒçš„å¦ä¸€ä¸ªç‰¹æ€§ï¼ŒåŠ¨æ€æ‰©å®¹ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”³è¯·ä¸€ä¸ªå®¹é‡ä¸º10çš„ç¼“å†²åŒºï¼š\npublic static void main(String[] args) { ByteBuf buf = Unpooled.buffer(10); //å®¹é‡åªæœ‰10å­—èŠ‚ System.out.println(buf.capacity()); //ç›´æ¥å†™ä¸€ä¸ªå­—ç¬¦ä¸² buf.writeCharSequence(\u0026#34;å¢æœ¬ä¼Ÿç‰›é€¼ï¼\u0026#34;, StandardCharsets.UTF_8); //å¾ˆæ˜æ˜¾è¿™ä¹ˆå¤šå­—å·²ç»è¶…è¿‡10å­—èŠ‚äº† System.out.println(buf.capacity()); } é€šè¿‡ç»“æœæˆ‘ä»¬å‘ç°ï¼Œåœ¨å†™å…¥ä¸€ä¸ªè¶…å‡ºå½“å‰å®¹é‡çš„æ•°æ®æ—¶ï¼Œä¼šè¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼Œæ‰©å®¹ä¼šä»64å¼€å§‹ï¼Œä¹‹åæ¯æ¬¡è§¦å‘æ‰©å®¹éƒ½ä¼šx2ï¼Œå½“ç„¶å¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›å®ƒæ‰©å®¹ï¼Œå¯ä»¥æŒ‡å®šæœ€å¤§å®¹é‡ï¼š\npublic static void main(String[] args) { //åœ¨ç”Ÿæˆæ—¶æŒ‡å®šmaxCapacityä¹Ÿä¸º10 ByteBuf buf = Unpooled.buffer(10, 10); System.out.println(buf.capacity()); buf.writeCharSequence(\u0026#34;å¢æœ¬ä¼Ÿç‰›é€¼ï¼\u0026#34;, StandardCharsets.UTF_8); System.out.println(buf.capacity()); } å¯ä»¥çœ‹åˆ°ç°åœ¨æ— æ³•å†åŠ¨æ€æ‰©å®¹äº†ï¼š\næˆ‘ä»¬æ¥ç€æ¥çœ‹ä¸€ä¸‹ç¼“å†²åŒºçš„ä¸‰ç§å®ç°æ¨¡å¼ï¼šå †ç¼“å†²åŒºæ¨¡å¼ã€ç›´æ¥ç¼“å†²åŒºæ¨¡å¼ã€å¤åˆç¼“å†²åŒºæ¨¡å¼ã€‚\nå †ç¼“å†²åŒºï¼ˆæ•°ç»„å®ç°ï¼‰å’Œç›´æ¥ç¼“å†²åŒºï¼ˆå †å¤–å†…å­˜å®ç°ï¼‰ä¸ç”¨å¤šè¯´ï¼Œå‰é¢æˆ‘ä»¬åœ¨NIOä¸­å·²ç»äº†è§£è¿‡äº†ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªç›´æ¥ç¼“å†²åŒºä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨ï¼š\npublic static void main(String[] args) { ByteBuf buf = Unpooled.directBuffer(10); System.out.println(Arrays.toString(buf.array())); } åŒæ ·çš„ä¸èƒ½ç›´æ¥æ‹¿åˆ°æ•°ç»„ï¼Œå› ä¸ºåº•å±‚å‹æ ¹ä¸æ˜¯æ•°ç»„å®ç°çš„ï¼š\næˆ‘ä»¬æ¥çœ‹çœ‹å¤åˆæ¨¡å¼ï¼Œå¤åˆæ¨¡å¼å¯ä»¥ä»»æ„åœ°æ‹¼å‡‘ç»„åˆå…¶ä»–ç¼“å†²åŒºï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ï¼š\nè¿™æ ·ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹ä¸¤ä¸ªç¼“å†²åŒºç»„åˆçš„å†…å®¹è¿›è¡Œæ“ä½œï¼Œæˆ‘ä»¬å°±ä¸ç”¨å†å•ç‹¬åˆ›å»ºä¸€ä¸ªæ–°çš„ç¼“å†²åŒºäº†ï¼Œè€Œæ˜¯ç›´æ¥å°†å…¶è¿›è¡Œæ‹¼æ¥æ“ä½œï¼Œç›¸å½“äºæ˜¯ä½œä¸ºå¤šä¸ªç¼“å†²åŒºç»„åˆçš„è§†å›¾ã€‚\n//åˆ›å»ºä¸€ä¸ªå¤åˆç¼“å†²åŒº CompositeByteBuf buf = Unpooled.compositeBuffer(); buf.addComponent(Unpooled.copiedBuffer(\u0026#34;abc\u0026#34;.getBytes())); buf.addComponent(Unpooled.copiedBuffer(\u0026#34;def\u0026#34;.getBytes())); for (int i = 0; i \u0026lt; buf.capacity(); i++) { System.out.println((char) buf.getByte(i)); } å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹Ÿå¯ä»¥æ­£å¸¸æ“ä½œç»„åˆåçš„ç¼“å†²åŒºã€‚\næœ€åæˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œæ± åŒ–ç¼“å†²åŒºå’Œéæ± åŒ–ç¼“å†²åŒºçš„åŒºåˆ«ã€‚\næˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹Unpooledå·¥å…·ç±»ä¸­å…·ä½“æ˜¯å¦‚ä½•åˆ›å»ºbufferçš„ï¼š\npublic final class Unpooled { private static final ByteBufAllocator ALLOC; //å®é™…ä¸Šå†…éƒ¨æ˜¯æœ‰ä¸€ä¸ªByteBufAllocatorå¯¹è±¡çš„ public static final ByteOrder BIG_ENDIAN; public static final ByteOrder LITTLE_ENDIAN; public static final ByteBuf EMPTY_BUFFER; public static ByteBuf buffer() { return ALLOC.heapBuffer(); //ç¼“å†²åŒºçš„åˆ›å»ºæ“ä½œå®é™…ä¸Šæ˜¯ä¾é ByteBufAllocatoræ¥è¿›è¡Œçš„ } ... static { //ALLOCåœ¨é™æ€ä»£ç å—ä¸­è¿›è¡ŒæŒ‡å®šï¼Œå®é™…ä¸ŠçœŸæ­£çš„å®ç°ç±»æ˜¯UnpooledByteBufAllocator ALLOC = UnpooledByteBufAllocator.DEFAULT; BIG_ENDIAN = ByteOrder.BIG_ENDIAN; LITTLE_ENDIAN = ByteOrder.LITTLE_ENDIAN; EMPTY_BUFFER = ALLOC.buffer(0, 0); //ç©ºç¼“å†²åŒºå®¹é‡å’Œæœ€å¤§å®¹é‡éƒ½æ˜¯0 assert EMPTY_BUFFER instanceof EmptyByteBuf : \u0026#34;EMPTY_BUFFER must be an EmptyByteBuf.\u0026#34;; } } é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œè¿™ä¸ªByteBufAllocatoråˆæ˜¯ä¸ªå•¥ï¼Œé¡¾åæ€ä¹‰ï¼Œå…¶å®å°±æ˜¯è´Ÿè´£åˆ†é…ç¼“å†²åŒºçš„ã€‚\nå®ƒæœ‰ä¸¤ä¸ªå…·ä½“å®ç°ç±»ï¼šUnpooledByteBufAllocatorå’ŒPooledByteBufAllocatorï¼Œä¸€ä¸ªæ˜¯éæ± åŒ–ç¼“å†²åŒºç”Ÿæˆå™¨ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯æ± åŒ–ç¼“å†²åŒºç”Ÿæˆå™¨ï¼Œé‚£ä¹ˆæ± åŒ–å’Œéæ± åŒ–æœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿ\nå®é™…ä¸Šæ± åŒ–ç¼“å†²åŒºåˆ©ç”¨äº†æ± åŒ–æ€æƒ³ï¼Œå°†ç¼“å†²åŒºé€šè¿‡è®¾ç½®å†…å­˜æ± æ¥è¿›è¡Œå†…å­˜å—å¤ç”¨ï¼Œè¿™æ ·å°±ä¸ç”¨é¢‘ç¹åœ°è¿›è¡Œå†…å­˜çš„ç”³è¯·ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨å †å¤–å†…å­˜çš„æ—¶å€™ï¼Œé¿å…å¤šæ¬¡é‡å¤é€šè¿‡åº•å±‚malloc()å‡½æ•°ç³»ç»Ÿè°ƒç”¨ç”³è¯·å†…å­˜é€ æˆçš„æ€§èƒ½æŸå¤±ã€‚Nettyçš„å†…å­˜ç®¡ç†æœºåˆ¶ä¸»è¦æ˜¯å€Ÿé‰´Jemallocå†…å­˜åˆ†é…ç­–ç•¥ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥æ·±å…¥äº†è§£ä¸€ä¸‹ã€‚\næ‰€ä»¥ï¼Œç”±äºæ˜¯å¤ç”¨å†…å­˜ç©ºé—´ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸ªä¾‹å­ï¼š\npublic static void main(String[] args) { ByteBufAllocator allocator = PooledByteBufAllocator.DEFAULT; ByteBuf buf = allocator.directBuffer(10); //ç”³è¯·ä¸€ä¸ªå®¹é‡ä¸º10çš„ç›´æ¥ç¼“å†²åŒº buf.writeChar(\u0026#39;T\u0026#39;); //éšä¾¿æ“ä½œæ“ä½œ System.out.println(buf.readChar()); buf.release(); //é‡Šæ”¾æ­¤ç¼“å†²åŒº ByteBuf buf2 = allocator.directBuffer(10); //é‡æ–°å†ç”³è¯·ä¸€ä¸ªåŒæ ·å¤§å°çš„ç›´æ¥ç¼“å†²åŒº System.out.println(buf2 == buf); } å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨å®Œä¸€ä¸ªç¼“å†²åŒºä¹‹åï¼Œæˆ‘ä»¬å°†å…¶è¿›è¡Œèµ„æºé‡Šæ”¾ï¼Œå½“æˆ‘ä»¬å†æ¬¡ç”³è¯·ä¸€ä¸ªåŒæ ·å¤§å°çš„ç¼“å†²åŒºæ—¶ï¼Œä¼šç›´æ¥å¾—åˆ°ä¹‹å‰å·²ç»ç”³è¯·å¥½çš„ç¼“å†²åŒºï¼Œæ‰€ä»¥ï¼ŒPooledByteBufAllocatorå®é™…ä¸Šæ˜¯å°†ByteBufå®ä¾‹æ”¾å…¥æ± ä¸­åœ¨è¿›è¡Œå¤ç”¨ã€‚\næ± åŒ–æŠ€æœ¯ï¼Œé¿å…åº•å±‚é‡å¤çš„mallocæ“ä½œæµªè´¹æ€§èƒ½\né›¶æ‹·è´ç®€ä»‹ #\r**æ³¨æ„ï¼š**æ­¤å°èŠ‚ä½œä¸ºé€‰å­¦å†…å®¹ï¼Œéœ€è¦æŒæ¡æ“ä½œç³»ç»Ÿå’Œè®¡ç®—æœºç»„æˆåŸç†æ‰èƒ½å­¦ä¹ ã€‚\né›¶æ‹·è´æ˜¯ä¸€ç§I/Oæ“ä½œä¼˜åŒ–æŠ€æœ¯ï¼Œå¯ä»¥å¿«é€Ÿé«˜æ•ˆåœ°å°†æ•°æ®ä»æ–‡ä»¶ç³»ç»Ÿç§»åŠ¨åˆ°ç½‘ç»œæ¥å£ï¼Œè€Œä¸éœ€è¦å°†å…¶ä»å†…æ ¸ç©ºé—´å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ï¼Œé¦–å…ˆç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæ˜¯å†…æ ¸ç©ºé—´ï¼Œä»€ä¹ˆåˆæ˜¯ç”¨æˆ·ç©ºé—´å‘¢ï¼Ÿ\nå…¶å®æ—©æœŸæ“ä½œç³»ç»Ÿæ˜¯ä¸åŒºåˆ†å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„ï¼Œä½†æ˜¯åº”ç”¨ç¨‹åºèƒ½è®¿é—®ä»»æ„å†…å­˜ç©ºé—´ï¼Œç¨‹åºå¾ˆå®¹æ˜“ä¸ç¨³å®šï¼Œå¸¸å¸¸æŠŠç³»ç»Ÿæå´©æºƒï¼Œæ¯”å¦‚æ¸…é™¤æ“ä½œç³»ç»Ÿçš„å†…å­˜æ•°æ®ã€‚å®é™…ä¸Šè®©åº”ç”¨ç¨‹åºéšä¾¿è®¿é—®å†…å­˜çœŸçš„å¤ªå±é™©äº†ï¼Œäºæ˜¯å°±æŒ‰ç…§CPU æŒ‡ä»¤çš„é‡è¦ç¨‹åº¦å¯¹æŒ‡ä»¤è¿›è¡Œäº†åˆ†çº§ï¼ŒæŒ‡ä»¤åˆ†ä¸ºå››ä¸ªçº§åˆ«ï¼šRing0 ~ Ring3ï¼ŒLinux ä¸‹åªä½¿ç”¨äº† Ring0 å’Œ Ring3 ä¸¤ä¸ªè¿è¡Œçº§åˆ«ï¼Œè¿›ç¨‹è¿è¡Œåœ¨ Ring3 çº§åˆ«æ—¶è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼ŒæŒ‡ä»¤åªè®¿é—®ç”¨æˆ·ç©ºé—´ï¼Œè€Œè¿è¡Œåœ¨ Ring0 çº§åˆ«æ—¶è¢«ç§°ä¸ºè¿è¡Œåœ¨å†…æ ¸æ€ï¼Œå¯ä»¥è®¿é—®ä»»æ„å†…å­˜ç©ºé—´ã€‚\næ¯”å¦‚æˆ‘ä»¬Javaä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œå®é™…ä¸Šæœ€ç»ˆæ˜¯è¦äº¤ç»™æ“ä½œç³»ç»Ÿæ¥ä¸ºæˆ‘ä»¬è¿›è¡Œåˆ†é…çš„ï¼Œè€Œéœ€è¦æ“ä½œç³»ç»Ÿå¸®åŠ©æˆ‘ä»¬å®Œæˆä»»åŠ¡åˆ™éœ€è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œæ˜¯å†…æ ¸åœ¨è¿›è¡Œå¤„ç†ï¼Œä¸æ˜¯æˆ‘ä»¬è‡ªå·±çš„ç¨‹åºåœ¨å¤„ç†ï¼Œè¿™æ—¶å°±ç›¸å½“äºæˆ‘ä»¬çš„ç¨‹åºå¤„äºäº†å†…æ ¸æ€ï¼Œè€Œå½“æ“ä½œç³»ç»Ÿåº•å±‚åˆ†é…å®Œæˆï¼Œæœ€ååˆ°æˆ‘ä»¬Javaä»£ç ä¸­è¿”å›å¾—åˆ°çº¿ç¨‹å¯¹è±¡æ—¶ï¼Œåˆç»§ç»­ç”±æˆ‘ä»¬çš„ç¨‹åºè¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥ä»å†…æ ¸æ€è½¬æ¢å›äº†ç”¨æˆ·æ€ã€‚\nè€Œæˆ‘ä»¬çš„æ–‡ä»¶æ“ä½œä¹Ÿæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¹Ÿæ˜¯éœ€è¦è®©æ“ä½œç³»ç»Ÿå¸®åŠ©æˆ‘ä»¬ä»ç£ç›˜ä¸Šè¯»å–æ–‡ä»¶æ•°æ®æˆ–æ˜¯å‘ç½‘ç»œå‘é€æ•°æ®ï¼Œæ¯”å¦‚ä½¿ç”¨ä¼ ç»ŸIOçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦ä»ç£ç›˜ä¸Šè¯»å–æ–‡ä»¶ç„¶åå‘é€åˆ°ç½‘ç»œä¸Šï¼Œå°±ä¼šç»å†ä»¥ä¸‹æµç¨‹ï¼š\nå¯ä»¥çœ‹åˆ°æ•´ä¸ªè¿‡ç¨‹ä¸­æ˜¯ç»å†äº†2æ¬¡CPUæ‹·è´+2æ¬¡DMAæ‹·è´ï¼Œä¸€å…±å››æ¬¡æ‹·è´ï¼Œè™½ç„¶é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä½†æ˜¯æ•°æ®è€æ˜¯è¿™æ ·æ¥å›è¿›è¡Œå¤åˆ¶ï¼Œæ˜¯ä¸æ˜¯å¤ªæµªè´¹æ—¶é—´äº†ç‚¹ï¼Ÿæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å¯»æ‰¾ä¸€ç§æ›´å¥½çš„æ–¹å¼ï¼Œæ¥å®ç°é›¶æ‹·è´ã€‚\nå®ç°é›¶æ‹·è´æˆ‘ä»¬è¿™é‡Œæ¼”ç¤ºä¸‰ç§æ–¹æ¡ˆï¼š\nä½¿ç”¨è™šæ‹Ÿå†…å­˜\nç°åœ¨çš„æ“ä½œç³»ç»ŸåŸºæœ¬éƒ½æ˜¯æ”¯æŒè™šæ‹Ÿå†…å­˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥è®©å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„è™šæ‹Ÿåœ°å€æŒ‡å‘åŒä¸€ä¸ªç‰©ç†åœ°å€ï¼Œè¿™æ ·å°±ç›¸å½“äºæ˜¯ç›´æ¥å…±ç”¨äº†è¿™ä¸€å—åŒºåŸŸï¼Œä¹Ÿå°±è°ˆä¸ä¸Šæ‹·è´æ“ä½œäº†ï¼š\nä½¿ç”¨mmap/writeå†…å­˜æ˜ å°„\nå®é™…ä¸Šè¿™ç§æ–¹å¼å°±æ˜¯å°†å†…æ ¸ç©ºé—´ä¸­çš„ç¼“å­˜ç›´æ¥æ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´ç¼“å­˜ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰åœ¨å­¦ä¹ NIOä¸­ä½¿ç”¨çš„MappedByteBufferï¼Œå°±æ˜¯ç›´æ¥ä½œä¸ºæ˜ å°„å­˜åœ¨ï¼Œå½“æˆ‘ä»¬éœ€è¦å°†æ•°æ®å‘é€åˆ°Socketç¼“å†²åŒºæ—¶ï¼Œç›´æ¥åœ¨å†…æ ¸ç©ºé—´ä¸­è¿›è¡Œæ“ä½œå°±è¡Œäº†ï¼š\nä¸è¿‡è¿™æ ·è¿˜æ˜¯ä¼šå‡ºç°ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ï¼Œæˆ‘ä»¬å¾—å†ä¼˜åŒ–ä¼˜åŒ–ã€‚\nä½¿ç”¨sendfileæ–¹å¼\nåœ¨Linux2.1å¼€å§‹ï¼Œå¼•å…¥äº†sendfileæ–¹å¼æ¥ç®€åŒ–æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘Šè¯‰å†…æ ¸è¦æŠŠå“ªä¸ªæ–‡ä»¶æ•°æ®æ‹·è´æ‹·è´åˆ°Socketä¸Šï¼Œç›´æ¥åœ¨å†…æ ¸ç©ºé—´ä¸­ä¸€æ­¥åˆ°ä½ï¼š\næ¯”å¦‚æˆ‘ä»¬ä¹‹å‰åœ¨NIOä¸­ä½¿ç”¨çš„transferTo()æ–¹æ³•ï¼Œå°±æ˜¯åˆ©ç”¨äº†è¿™ç§æœºåˆ¶æ¥å®ç°é›¶æ‹·è´çš„ã€‚\nNettyå·¥ä½œæ¨¡å‹ #\rå‰é¢æˆ‘ä»¬äº†è§£äº†Nettyä¸ºæˆ‘ä»¬æä¾›çš„æ›´é«˜çº§çš„ç¼“å†²åŒºç±»ï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹Nettyæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä¸Šä¸€ç« æˆ‘ä»¬ä»‹ç»äº†Reactoræ¨¡å¼ï¼Œè€ŒNettyæ­£æ˜¯ä»¥ä¸»ä»Reactorå¤šçº¿ç¨‹æ¨¡å‹ä¸ºåŸºç¡€ï¼Œæ„å»ºå‡ºäº†ä¸€å¥—é«˜æ•ˆçš„å·¥ä½œæ¨¡å‹ã€‚\nå¤§è‡´å·¥ä½œæ¨¡å‹å›¾å¦‚ä¸‹ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œå’Œæˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„ä¸»ä»Reactorå¤šçº¿ç¨‹æ¨¡å‹éå¸¸ç±»ä¼¼ï¼š\næ‰€æœ‰çš„å®¢æˆ·ç«¯éœ€è¦è¿æ¥åˆ°ä¸»Reactorå®ŒæˆAcceptæ“ä½œåï¼Œå…¶ä»–çš„æ“ä½œç”±ä»Reactorå»å®Œæˆï¼Œè¿™é‡Œä¹Ÿæ˜¯å·®ä¸å¤šçš„æ€æƒ³ï¼Œä½†æ˜¯å®ƒè¿›è¡Œäº†ä¸€äº›æ”¹è¿›ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒçš„è®¾è®¡ï¼š\nNetty æŠ½è±¡å‡ºä¸¤ç»„çº¿ç¨‹æ± BossGroupå’ŒWorkerGroupï¼ŒBossGroupä¸“é—¨è´Ÿè´£æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥, WorkerGroupä¸“é—¨è´Ÿè¯»å†™ï¼Œå°±åƒæˆ‘ä»¬å‰é¢è¯´çš„ä¸»ä»Reactorä¸€æ ·ã€‚ æ— è®ºæ˜¯BossGroupè¿˜æ˜¯WorkerGroupï¼Œéƒ½æ˜¯ä½¿ç”¨EventLoopï¼ˆäº‹ä»¶å¾ªç¯ï¼Œå¾ˆå¤šç³»ç»Ÿéƒ½é‡‡ç”¨äº†äº‹ä»¶å¾ªç¯æœºåˆ¶ï¼Œæ¯”å¦‚å‰ç«¯æ¡†æ¶Node.jsï¼Œäº‹ä»¶å¾ªç¯é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œä¸æ–­åœ°è¿›è¡Œäº‹ä»¶é€šçŸ¥ï¼‰æ¥è¿›è¡Œäº‹ä»¶ç›‘å¬çš„ï¼Œæ•´ä¸ªNettyä¹Ÿæ˜¯ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¥è¿ä½œçš„ï¼Œæ¯”å¦‚å½“å®¢æˆ·ç«¯å·²ç»å‡†å¤‡å¥½è¯»å†™ã€è¿æ¥å»ºç«‹æ—¶ï¼Œéƒ½ä¼šè¿›è¡Œäº‹ä»¶é€šçŸ¥ï¼Œè¯´ç™½äº†å°±åƒæˆ‘ä»¬ä¹‹å‰å†™NIOå¤šè·¯å¤ç”¨é‚£æ ·ï¼Œåªä¸è¿‡è¿™é‡Œæ¢æˆEventLoopäº†è€Œå·²ï¼Œå®ƒå·²ç»å¸®åŠ©æˆ‘ä»¬å°è£…å¥½äº†ä¸€äº›å¸¸ç”¨æ“ä½œï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥è‡ªå·±æ·»åŠ ä¸€äº›é¢å¤–çš„ä»»åŠ¡ï¼Œå¦‚æœæœ‰å¤šä¸ªEventLoopï¼Œä¼šå­˜æ”¾åœ¨EventLoopGroupä¸­ï¼ŒEventLoopGroupå°±æ˜¯BossGroupå’ŒWorkerGroupçš„å…·ä½“å®ç°ã€‚ åœ¨BossGroupä¹‹åï¼Œä¼šæ­£å¸¸å°†SocketChannelç»‘å®šåˆ°WorkerGroupä¸­çš„å…¶ä¸­ä¸€ä¸ªEventLoopä¸Šï¼Œè¿›è¡Œåç»­çš„è¯»å†™æ“ä½œç›‘å¬ã€‚ å‰é¢æˆ‘ä»¬å¤§è‡´äº†è§£äº†ä¸€ä¸‹Nettyçš„å·¥ä½œæ¨¡å‹ï¼Œæ¥ç€æˆ‘ä»¬æ¥å°è¯•åˆ›å»ºä¸€ä¸ªNettyæœåŠ¡å™¨ï¼š\npublic static void main(String[] args) { //è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨NioEventLoopGroupå®ç°ç±»å³å¯ï¼Œåˆ›å»ºBossGroupå’ŒWorkerGroup //å½“ç„¶è¿˜æœ‰EpollEventLoopGroupï¼Œä½†æ˜¯ä»…æ”¯æŒLinuxï¼Œè¿™æ˜¯NettyåŸºäºLinuxåº•å±‚Epollå•ç‹¬ç¼–å†™çš„ä¸€å¥—æœ¬åœ°å®ç°ï¼Œæ²¡æœ‰ä½¿ç”¨NIOé‚£å¥— EventLoopGroup bossGroup = new NioEventLoopGroup(), workerGroup = new NioEventLoopGroup(); //åˆ›å»ºæœåŠ¡ç«¯å¯åŠ¨å¼•å¯¼ç±» ServerBootstrap bootstrap = new ServerBootstrap(); //å¯é“¾å¼ï¼Œå°±å¾ˆæ£’ bootstrap .group(bossGroup, workerGroup) //æŒ‡å®šäº‹ä»¶å¾ªç¯ç»„ .channel(NioServerSocketChannel.class) //æŒ‡å®šä¸ºNIOçš„ServerSocketChannel .childHandler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { //æ³¨æ„ï¼Œè¿™é‡Œçš„SocketChannelä¸æ˜¯æˆ‘ä»¬NIOé‡Œé¢çš„ï¼Œæ˜¯Nettyçš„ @Override protected void initChannel(SocketChannel channel) { //è·å–æµæ°´çº¿ï¼Œå½“æˆ‘ä»¬éœ€è¦å¤„ç†å®¢æˆ·ç«¯çš„æ•°æ®æ—¶ï¼Œå®é™…ä¸Šæ˜¯åƒæµæ°´çº¿ä¸€æ ·åœ¨å¤„ç†ï¼Œè¿™ä¸ªæµæ°´çº¿ä¸Šå¯ä»¥æœ‰å¾ˆå¤šHandler channel.pipeline().addLast(new ChannelInboundHandlerAdapter(){ //æ·»åŠ ä¸€ä¸ªHandlerï¼Œè¿™é‡Œä½¿ç”¨ChannelInboundHandlerAdapter @Override public void channelRead(ChannelHandlerContext ctx, Object msg) { //ctxæ˜¯ä¸Šä¸‹æ–‡ï¼Œmsgæ˜¯æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œé»˜è®¤ä»¥ByteBufå½¢å¼ï¼ˆä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å½¢å¼ï¼Œåé¢å†è¯´ï¼‰ ByteBuf buf = (ByteBuf) msg; //ç±»å‹è½¬æ¢ä¸€ä¸‹ System.out.println(Thread.currentThread().getName()+\u0026#34; \u0026gt;\u0026gt; æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); //é€šè¿‡ä¸Šä¸‹æ–‡å¯ä»¥ç›´æ¥å‘é€æ•°æ®å›å»ï¼Œæ³¨æ„è¦writeAndFlushæ‰èƒ½è®©å®¢æˆ·ç«¯ç«‹å³æ”¶åˆ° ctx.writeAndFlush(Unpooled.wrappedBuffer(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); } }); } }); //æœ€åç»‘å®šç«¯å£ï¼Œå¯åŠ¨ bootstrap.bind(8080); } å¯ä»¥çœ‹åˆ°ä¸Šé¢å†™äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯ä½ ä¸€å®šä¼šæ‡µé€¼ï¼Œè¿™äº›æ–°æ¥çš„ä¸œè¥¿ï¼Œéƒ½æ˜¯ä»€ä¹ˆè·Ÿä»€ä¹ˆå•Šï¼Œæ€ä¹ˆä¸€ä¸ªä¹Ÿæ²¡çœ‹æ˜ç™½ï¼Ÿæ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥æš‚æ—¶å…ˆå°†ä»£ç å†™åœ¨è¿™é‡Œï¼Œå…·ä½“çš„å„ä¸ªéƒ¨åˆ†ï¼Œè¿˜è¯·å¬åé¢ç»†ç»†é“æ¥ã€‚\næˆ‘ä»¬æ¥ç€ç¼–å†™ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰çš„ï¼š\npublic static void main(String[] args) { //åˆ›å»ºä¸€ä¸ªæ–°çš„SocketChannelï¼Œä¸€ä¼šé€šè¿‡é€šé“è¿›è¡Œé€šä¿¡ try (SocketChannel channel = SocketChannel.open(new InetSocketAddress(\u0026#34;localhost\u0026#34;, 8080)); Scanner scanner = new Scanner(System.in)){ System.out.println(\u0026#34;å·²è¿æ¥åˆ°æœåŠ¡ç«¯ï¼\u0026#34;); while (true) { //å’±ç»™å®ƒå¥—ä¸ªæ— é™å¾ªç¯ï¼Œè¿™æ ·å°±èƒ½ä¸€ç›´å‘æ¶ˆæ¯äº† System.out.println(\u0026#34;è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); if(text.isEmpty()) continue; //ç›´æ¥å‘é€šé“ä¸­å†™å…¥æ•°æ®ï¼ŒçœŸèˆ’æœ channel.write(ByteBuffer.wrap(text.getBytes())); System.out.println(\u0026#34;å·²å‘é€ï¼\u0026#34;); ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); //ç›´æ¥ä»é€šé“ä¸­è¯»å–æ•°æ® buffer.flip(); System.out.println(\u0026#34;æ”¶åˆ°æœåŠ¡å™¨è¿”å›ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); } } catch (IOException e) { throw new RuntimeException(e); } } é€šè¿‡é€šé“æ­£å¸¸æ”¶å‘æ•°æ®å³å¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±æˆåŠŸæ­å»ºå¥½äº†ä¸€ä¸ªNettyæœåŠ¡å™¨ã€‚\nChannelè¯¦è§£ #\råœ¨å­¦ä¹ NIOæ—¶ï¼Œæˆ‘ä»¬å°±å·²ç»æ¥è§¦åˆ°Channeläº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é€šé“æ¥è¿›è¡Œæ•°æ®çš„ä¼ è¾“ï¼Œå¹¶ä¸”é€šé“æ”¯æŒåŒå‘ä¼ è¾“ã€‚\nè€Œåœ¨Nettyä¸­ï¼Œä¹Ÿæœ‰å¯¹åº”çš„Channelç±»å‹ï¼š\næ¥å£çš„é™æ€å˜é‡é€šå¸¸ä¸ä¼šå†è¿è¡Œæ—¶è¢«ä½¿ç”¨ï¼Œä¸ä¼šäº§ç”Ÿæ­§ä¹‰é—®é¢˜\npublic interface Channel extends AttributeMap, ChannelOutboundInvoker, Comparable\u0026lt;Channel\u0026gt; { ChannelId id(); //é€šé“ID EventLoop eventLoop(); //è·å–æ­¤é€šé“æ‰€å±çš„EventLoopï¼Œå› ä¸ºä¸€ä¸ªChannelåœ¨å®ƒçš„ç”Ÿå‘½å‘¨æœŸå†…åªèƒ½æ³¨å†Œåˆ°ä¸€ä¸ªEventLoopä¸­ Channel parent(); //Channelæ˜¯å…·æœ‰å±‚çº§å…³ç³»çš„ï¼Œè¿™é‡Œæ˜¯è¿”å›çˆ¶Channel ChannelConfig config(); boolean isOpen(); //é€šé“å½“å‰çš„ç›¸å…³çŠ¶æ€ boolean isRegistered(); boolean isActive(); ChannelMetadata metadata(); //é€šé“ç›¸å…³ä¿¡æ¯ SocketAddress localAddress(); SocketAddress remoteAddress(); ChannelFuture closeFuture(); //å…³é—­é€šé“ï¼Œä½†æ˜¯ä¼šç”¨åˆ°ChannelFutureï¼Œåé¢è¯´ boolean isWritable(); long bytesBeforeUnwritable(); long bytesBeforeWritable(); Unsafe unsafe(); ChannelPipeline pipeline(); //æµæ°´çº¿ï¼Œä¹‹åä¹Ÿä¼šè¯´ ByteBufAllocator alloc(); //å¯ä»¥ç›´æ¥ä»Channelæ‹¿åˆ°ByteBufAllocatorçš„å®ä¾‹ï¼Œæ¥åˆ†é…ByteBuf Channel read(); Channel flush(); //åˆ·æ–°ï¼ŒåŸºæ“ } å¯ä»¥çœ‹åˆ°ï¼ŒNettyä¸­çš„Channelç›¸æ¯”NIOåŠŸèƒ½å°±å¤šå¾—å¤šäº†ã€‚Nettyä¸­çš„Channelä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š\næ‰€æœ‰çš„IOæ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸æ˜¯åœ¨å½“å‰çº¿ç¨‹åŒæ­¥è¿è¡Œï¼Œæ–¹æ³•è°ƒç”¨ä¹‹åå°±ç›´æ¥è¿”å›äº†ï¼Œé‚£æ€ä¹ˆè·å–æ“ä½œçš„ç»“æœå‘¢ï¼Ÿè¿˜è®°å¾—æˆ‘ä»¬åœ¨å‰é¢JUCç¯‡æ•™ç¨‹ä¸­å­¦ä¹ çš„Futureå—ï¼Œæ²¡é”™ï¼Œè¿™é‡Œçš„ChannelFutureä¹Ÿæ˜¯å¹²è¿™äº‹çš„ã€‚ å¤šçº¿ç¨‹é€šè¿‡Futureæ¥è·å–çº¿ç¨‹æ‰§è¡Œçš„ç»“æœ\næˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸‹Channelæ¥å£çš„çˆ¶æ¥å£ChannelOutboundInvokeræ¥å£ï¼Œè¿™é‡Œé¢å®šä¹‰äº†å¤§é‡çš„I/Oæ“ä½œï¼š\npublic interface ChannelOutboundInvoker { //é€šé“å‡ºç«™è°ƒç”¨ï¼ˆåŒ…å«å¤§é‡çš„ç½‘ç»œå‡ºç«™æ“ä½œï¼Œæ¯”å¦‚å†™ï¼‰ ChannelFuture bind(SocketAddress var1); //Socketç»‘å®šã€è¿æ¥ã€æ–­å¼€ã€å…³é—­ç­‰æ“ä½œ ChannelFuture connect(SocketAddress var1); ChannelFuture connect(SocketAddress var1, SocketAddress var2); ChannelFuture disconnect(); ChannelFuture close(); ChannelFuture deregister(); ChannelFuture bind(SocketAddress var1, ChannelPromise var2); //ä¸‹é¢è¿™ä¸€ç³»åˆ—è¿˜æœ‰é™„å¸¦ChannelPromiseçš„ï¼ŒChannelPromiseæˆ‘ä»¬åé¢å†è¯´ï¼Œå…¶å®å°±æ˜¯ChannelFutureçš„å¢å¼ºç‰ˆ ChannelFuture connect(SocketAddress var1, ChannelPromise var2); ChannelFuture connect(SocketAddress var1, SocketAddress var2, ChannelPromise var3); ChannelFuture disconnect(ChannelPromise var1); ChannelFuture close(ChannelPromise var1); ChannelFuture deregister(ChannelPromise var1); ChannelOutboundInvoker read(); ChannelFuture write(Object var1); //å¯ä»¥çœ‹åˆ°è¿™äº›å¸¸è§çš„å†™æ“ä½œï¼Œéƒ½æ˜¯è¿”å›çš„ChannelFutureï¼Œè€Œä¸æ˜¯ç›´æ¥ç»™ç»“æœ ChannelFuture write(Object var1, ChannelPromise var2); ChannelOutboundInvoker flush(); ChannelFuture writeAndFlush(Object var1, ChannelPromise var2); ChannelFuture writeAndFlush(Object var1); ChannelPromise newPromise(); //å…¶ä»–çš„æš‚æ—¶ä¸æ ChannelProgressivePromise newProgressivePromise(); ChannelFuture newSucceededFuture(); ChannelFuture newFailedFuture(Throwable var1); ChannelPromise voidPromise(); } å½“ç„¶å®ƒè¿˜å®ç°äº†AttributeMapæ¥å£ï¼Œå…¶å®æœ‰ç‚¹ç±»ä¼¼äºSessioné‚£ç§æ„Ÿè§‰ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€äº›å±æ€§ä¹‹ç±»çš„ï¼š\npublic interface AttributeMap { \u0026lt;T\u0026gt; Attribute\u0026lt;T\u0026gt; attr(AttributeKey\u0026lt;T\u0026gt; var1); \u0026lt;T\u0026gt; boolean hasAttr(AttributeKey\u0026lt;T\u0026gt; var1); } æˆ‘ä»¬äº†è§£äº†Nettyåº•å±‚çš„Channelä¹‹åï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹ChannelHandlerï¼Œæ—¢ç„¶ç°åœ¨æœ‰äº†é€šé“ï¼Œé‚£ä¹ˆæ€ä¹ˆè¿›è¡Œæ“ä½œå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å°†éœ€è¦å¤„ç†çš„äº‹æƒ…æ”¾åœ¨ChannelHandlerä¸­ï¼ŒChannelHandlerå……å½“äº†æ‰€æœ‰å…¥ç«™å’Œå‡ºç«™æ•°æ®çš„åº”ç”¨ç¨‹åºé€»è¾‘çš„å®¹å™¨ï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬ä¹‹å‰Reactoræ¨¡å¼ä¸­çš„Handlerï¼Œå…¨é å®ƒæ¥å¤„ç†è¯»å†™æ“ä½œã€‚\nä¸è¿‡è¿™é‡Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ChannelHandleråœ¨è¿›è¡Œå¤„ç†ï¼Œè€Œæ˜¯ä¸€æ•´å¥—æµæ°´çº¿ï¼Œæˆ‘ä»¬ä¹‹åä¼šä»‹ç»ChannelPipelineã€‚\næ¯”å¦‚æˆ‘ä»¬ä¸Šé¢å°±æ˜¯ä½¿ç”¨äº†ChannelInboundHandlerAdapteræŠ½è±¡ç±»ï¼Œå®ƒæ˜¯ChannelInboundHandleræ¥å£çš„å®ç°ï¼Œç”¨äºå¤„ç†å…¥ç«™æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å®é™…ä¸Šå°±æ˜¯é€šè¿‡é‡å†™å¯¹åº”çš„æ–¹æ³•æ¥è¿›è¡Œå¤„ç†ï¼Œè¿™äº›æ–¹æ³•ä¼šåœ¨åˆé€‚çš„æ—¶é—´è¢«è°ƒç”¨ï¼š\nchannel.pipeline().addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) { //ctxæ˜¯ä¸Šä¸‹æ–‡ï¼Œmsgæ˜¯æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œä»¥ByteBufå½¢å¼ ByteBuf buf = (ByteBuf) msg; //ç±»å‹è½¬æ¢ä¸€ä¸‹ System.out.println(Thread.currentThread().getName()+\u0026#34; \u0026gt;\u0026gt; æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); //é€šè¿‡ä¸Šä¸‹æ–‡å¯ä»¥ç›´æ¥å‘é€æ•°æ®å›å»ï¼Œæ³¨æ„è¦writeAndFlushæ‰èƒ½è®©å®¢æˆ·ç«¯ç«‹å³æ”¶åˆ° ctx.writeAndFlush(Unpooled.wrappedBuffer(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); } }); æˆ‘ä»¬å…ˆä»é¡¶å±‚æ¥å£å¼€å§‹çœ‹èµ·ï¼š\npublic interface ChannelHandler { //å½“ChannelHandlerè¢«æ·»åŠ åˆ°æµæ°´çº¿ä¸­æ—¶è°ƒç”¨ void handlerAdded(ChannelHandlerContext var1) throws Exception; //å½“ChannelHandlerä»æµæ°´çº¿ä¸­ç§»é™¤æ—¶è°ƒç”¨ void handlerRemoved(ChannelHandlerContext var1) throws Exception; /** @deprecated å·²è¿‡æ—¶é‚£å’±å°±ä¸ç®¡äº† */ @Deprecated void exceptionCaught(ChannelHandlerContext var1, Throwable var2) throws Exception; @Inherited @Documented @Target({ElementType.TYPE}) @Retention(RetentionPolicy.RUNTIME) public @interface Sharable { } } é¡¶å±‚æ¥å£çš„å®šä¹‰æ¯”è¾ƒç®€å•ï¼Œå°±åªæœ‰ä¸€äº›æµæ°´çº¿ç›¸å…³çš„å›è°ƒæ–¹æ³•ï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹ä¸‹ä¸€çº§ï¼š\n//ChannelInboundHandlerç”¨äºå¤„ç†å…¥ç«™ç›¸å…³äº‹ä»¶ public interface ChannelInboundHandler extends ChannelHandler { //å½“Channelå·²ç»æ³¨å†Œåˆ°è‡ªå·±çš„EventLoopä¸Šæ—¶è°ƒç”¨ï¼Œå‰é¢æˆ‘ä»¬è¯´äº†ï¼Œä¸€ä¸ªChannelåªä¼šæ³¨å†Œåˆ°ä¸€ä¸ªEventLoopä¸Šï¼Œæ³¨å†Œåˆ°EventLoopåï¼Œè¿™æ ·æ‰ä¼šåœ¨å‘ç”Ÿå¯¹åº”äº‹ä»¶æ—¶è¢«é€šçŸ¥ã€‚ void channelRegistered(ChannelHandlerContext var1) throws Exception; //ä»EventLoopä¸Šå–æ¶ˆæ³¨å†Œæ—¶ void channelUnregistered(ChannelHandlerContext var1) throws Exception; //å½“Channelå·²ç»å¤„äºæ´»è·ƒçŠ¶æ€æ—¶è¢«è°ƒç”¨ï¼Œæ­¤æ—¶Channelå·²ç»è¿æ¥/ç»‘å®šï¼Œå¹¶ä¸”å·²ç»å°±ç»ª void channelActive(ChannelHandlerContext var1) throws Exception; //è·Ÿä¸Šé¢ç›¸åï¼Œä¸å†æ´»è·ƒäº†ï¼Œå¹¶ä¸”ä¸åœ¨è¿æ¥å®ƒçš„è¿œç¨‹èŠ‚ç‚¹ void channelInactive(ChannelHandlerContext var1) throws Exception; //å½“ä»Channelè¯»å–æ•°æ®æ—¶è¢«è°ƒç”¨ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®è¢«è‡ªåŠ¨åŒ…è£…æˆäº†ä¸€ä¸ªObjectï¼ˆé»˜è®¤æ˜¯ByteBufï¼‰ void channelRead(ChannelHandlerContext var1, Object var2) throws Exception; //ä¸Šä¸€ä¸ªè¯»å–æ“ä½œå®Œæˆåè°ƒç”¨ void channelReadComplete(ChannelHandlerContext var1) throws Exception; //æš‚æ—¶ä¸ä»‹ç» void userEventTriggered(ChannelHandlerContext var1, Object var2) throws Exception; //å½“Channelçš„å¯å†™çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶è¢«è°ƒç”¨ void channelWritabilityChanged(ChannelHandlerContext var1) throws Exception; //å‡ºç°å¼‚å¸¸æ—¶è¢«è°ƒç”¨ void exceptionCaught(ChannelHandlerContext var1, Throwable var2) throws Exception; } è€Œæˆ‘ä»¬ä¸Šé¢ç”¨åˆ°çš„ChannelInboundHandlerAdapterå®é™…ä¸Šå°±æ˜¯å¯¹è¿™äº›æ–¹æ³•å®ç°çš„æŠ½è±¡ç±»ï¼Œç›¸æ¯”ç›´æ¥ç”¨æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥åªé‡å†™æˆ‘ä»¬éœ€è¦çš„æ–¹æ³•ï¼Œæ²¡æœ‰é‡å†™çš„æ–¹æ³•ä¼šé»˜è®¤å‘æµæ°´çº¿ä¸‹ä¸€ä¸ªChannelHandlerå‘é€ã€‚\næˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼š\npublic class TestChannelHandler extends ChannelInboundHandlerAdapter { public void channelRegistered(ChannelHandlerContext ctx) throws Exception { System.out.println(\u0026#34;channelRegistered\u0026#34;); } public void channelUnregistered(ChannelHandlerContext ctx) throws Exception { System.out.println(\u0026#34;channelUnregistered\u0026#34;); } public void channelActive(ChannelHandlerContext ctx) throws Exception { System.out.println(\u0026#34;channelActive\u0026#34;); } public void channelInactive(ChannelHandlerContext ctx) throws Exception { System.out.println(\u0026#34;channelInactive\u0026#34;); } public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(Thread.currentThread().getName()+\u0026#34; \u0026gt;\u0026gt; æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); //è¿™æ¬¡æˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨ctx.alloc()æ¥ç”Ÿæˆç¼“å†²åŒº ByteBuf back = ctx.alloc().buffer(); back.writeCharSequence(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;, StandardCharsets.UTF_8); ctx.writeAndFlush(back); System.out.println(\u0026#34;channelRead\u0026#34;); } public void channelReadComplete(ChannelHandlerContext ctx) throws Exception { System.out.println(\u0026#34;channelReadComplete\u0026#34;); } public void userEventTriggered(ChannelHandlerContext ctx, Object evt) throws Exception { System.out.println(\u0026#34;userEventTriggered\u0026#34;); } public void channelWritabilityChanged(ChannelHandlerContext ctx) throws Exception { System.out.println(\u0026#34;channelWritabilityChanged\u0026#34;); } public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception { System.out.println(\u0026#34;exceptionCaught\u0026#34;+cause); } } public static void main(String[] args) { EventLoopGroup bossGroup = new NioEventLoopGroup(), workerGroup = new NioEventLoopGroup(); ServerBootstrap bootstrap = new ServerBootstrap(); bootstrap .group(bossGroup, workerGroup) .channel(NioServerSocketChannel.class) //ChannelInitializeræ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ChannelHandlerï¼Œå®ƒæœ¬èº«ä¸å¤„ç†ä»»ä½•å‡ºç«™/å…¥ç«™äº‹ä»¶ï¼Œå®ƒçš„ç›®çš„ä»…ä»…æ˜¯å®ŒæˆChannelçš„åˆå§‹åŒ– .childHandler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { @Override protected void initChannel(SocketChannel channel) { //å°†æˆ‘ä»¬è‡ªå®šä¹‰çš„ChannelHandleræ·»åŠ åˆ°æµæ°´çº¿ channel.pipeline().addLast(new TestChannelHandler()); } }); bootstrap.bind(8080); } ç°åœ¨æˆ‘ä»¬å¯åŠ¨æœåŠ¡å™¨ï¼Œè®©å®¢æˆ·ç«¯æ¥è¿æ¥å¹¶å‘é€ä¸€ä¸‹æ•°æ®è¯•è¯•çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°ChannelInboundHandlerçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œé¦–å…ˆæ˜¯Channelæ³¨å†ŒæˆåŠŸï¼Œç„¶åæ‰ä¼šå˜æˆå¯ç”¨çŠ¶æ€ï¼Œæ¥ç€å°±å·®ä¸å¤šå¯ä»¥ç­‰å¾…å®¢æˆ·ç«¯æ¥æ•°æ®äº†ï¼Œå½“å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€è¿æ¥æ—¶ï¼Œä¼šå†æ¬¡è§¦å‘ä¸€æ¬¡channelReadCompleteï¼Œç„¶åä¸å¯ç”¨ï¼Œæœ€åå–æ¶ˆæ³¨å†Œã€‚\næˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å‡ºç°å¼‚å¸¸çš„æƒ…å†µå‘¢ï¼Ÿ\npublic void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(Thread.currentThread().getName()+\u0026#34; \u0026gt;\u0026gt; æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ByteBuf back = ctx.alloc().buffer(); back.writeCharSequence(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;, StandardCharsets.UTF_8); ctx.writeAndFlush(back); System.out.println(\u0026#34;channelRead\u0026#34;); throw new RuntimeException(\u0026#34;æˆ‘æ˜¯è‡ªå®šä¹‰å¼‚å¸¸1\u0026#34;); //å¼„ç‚¹å¼‚å¸¸ä¸Šå» } public void channelReadComplete(ChannelHandlerContext ctx) throws Exception { System.out.println(\u0026#34;channelReadComplete\u0026#34;); throw new RuntimeException(\u0026#34;æˆ‘æ˜¯è‡ªå®šä¹‰å¼‚å¸¸2\u0026#34;); //å¼„ç‚¹å¼‚å¸¸ä¸Šå» } ... public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception { System.out.println(\u0026#34;exceptionCaught\u0026#34;+cause); } å¯ä»¥çœ‹åˆ°å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¼šæ¥ç€è°ƒç”¨exceptionCaughtæ–¹æ³•ï¼š\nä¸ChannelInboundHandlerå¯¹åº”çš„è¿˜æœ‰ChannelOutboundHandlerç”¨äºå¤„ç†å‡ºç«™ç›¸å…³çš„æ“ä½œï¼Œè¿™é‡Œå°±ä¸è¿›è¡Œæ¼”ç¤ºäº†ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹ChannelPipelineï¼Œæ¯ä¸€ä¸ªChanneléƒ½å¯¹åº”ä¸€ä¸ªChannelPipelineï¼ˆåœ¨Channelåˆå§‹åŒ–æ—¶å°±è¢«åˆ›å»ºäº†ï¼‰\nå®ƒå°±åƒæ˜¯ä¸€æ¡æµæ°´çº¿ä¸€æ ·ï¼Œæ•´æ¡æµæ°´çº¿ä¸Šå¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸ªHandlerï¼ˆåŒ…æ‹¬å…¥ç«™å’Œå‡ºç«™ï¼‰ï¼Œæ•´æ¡æµæ°´çº¿ä¸Šçš„ä¸¤ç«¯è¿˜æœ‰ä¸¤ä¸ªé»˜è®¤çš„å¤„ç†å™¨ï¼ˆç”¨äºä¸€äº›é¢„ç½®æ“ä½œå’Œåç»­æ“ä½œï¼Œæ¯”å¦‚é‡Šæ”¾èµ„æºç­‰ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒå¦‚ä½•å®‰æ’è¿™äº›è‡ªå®šä¹‰çš„Handlerå³å¯ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨å¸Œæœ›åˆ›å»ºä¸¤ä¸ªå…¥ç«™ChannelHandlerï¼Œä¸€ä¸ªç”¨äºæ¥æ”¶è¯·æ±‚å¹¶å¤„ç†ï¼Œè¿˜æœ‰ä¸€ä¸ªç”¨äºå¤„ç†å½“å‰æ¥æ”¶è¯·æ±‚è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ï¼š\n.childHandler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { //æ³¨æ„ï¼Œè¿™é‡Œçš„SocketChannelä¸æ˜¯æˆ‘ä»¬NIOé‡Œé¢çš„ï¼Œæ˜¯Nettyçš„ @Override protected void initChannel(SocketChannel channel) { channel.pipeline() //ç›´æ¥è·å–pipelineï¼Œç„¶åæ·»åŠ ä¸¤ä¸ªHandlerï¼Œæ³¨æ„é¡ºåº .addLast(new ChannelInboundHandlerAdapter(){ //ç¬¬ä¸€ä¸ªç”¨äºå¤„ç†æ¶ˆæ¯æ¥æ”¶ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ds throw new RuntimeException(\u0026#34;æˆ‘æ˜¯å¼‚å¸¸\u0026#34;); } }) .addLast(new ChannelInboundHandlerAdapter(){ //ç¬¬äºŒä¸ªç”¨äºå¤„ç†å¼‚å¸¸ @Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception { System.out.println(\u0026#34;æˆ‘æ˜¯å¼‚å¸¸å¤„ç†ï¼š\u0026#34;+cause); } }); } }); é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•è¿ä½œçš„å‘¢ï¼Ÿå®é™…ä¸Šå¦‚æœæˆ‘ä»¬ä¸åœ¨ChannelInboundHandlerAdapterä¸­é‡å†™å¯¹åº”çš„æ–¹æ³•ï¼Œå®ƒä¼šé»˜è®¤ä¼ æ’­åˆ°æµæ°´çº¿çš„ä¸‹ä¸€ä¸ªChannelInboundHandlerAdapterè¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ï¼š\npublic void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception { ctx.fireExceptionCaught(cause); //é€šè¿‡ChannelHandlerContextæ¥å‘ä¸‹ä¼ é€’ï¼ŒChannelHandlerContextæ˜¯åœ¨Handleræ·»åŠ è¿›Pipelineä¸­æ—¶å°±è¢«è‡ªåŠ¨åˆ›å»ºçš„ } æ¯”å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦å°†ä¸€ä¸ªæ¶ˆæ¯åœ¨ä¸¤ä¸ªHandlerä¸­è¿›è¡Œå¤„ç†ï¼š\n@Override protected void initChannel(SocketChannel channel) { channel.pipeline() //ç›´æ¥è·å–pipelineï¼Œç„¶åæ·»åŠ ä¸¤ä¸ªHandler .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;1æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ctx.fireChannelRead(msg); //é€šè¿‡ChannelHandlerContext } }) .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;2æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); } }); } æˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹å‡ºç«™ç›¸å…³æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ChannelOutboundHandlerAdapteræ¥å®Œæˆï¼š\n@Override protected void initChannel(SocketChannel channel) { channel.pipeline() .addLast(new ChannelOutboundHandlerAdapter(){ //æ³¨æ„å‡ºæ ˆç«™æ“ä½œåº”è¯¥åœ¨å…¥ç«™æ“ä½œçš„å‰é¢ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ChannelHandlerContextçš„writeæ–¹æ³•æ—¶ï¼Œæ˜¯ä»æµæ°´çº¿çš„å½“å‰ä½ç½®å€’ç€å¾€å‰æ‰¾ä¸‹ä¸€ä¸ªChannelOutboundHandlerAdapterï¼Œè€Œæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„ChannelInboundHandlerAdapteræ˜¯ä»å‰å¾€åæ‰¾ä¸‹ä¸€ä¸ªï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯Channelçš„writeæ–¹æ³•ï¼Œé‚£ä¹ˆä¼šä»æ•´ä¸ªæµæ°´çº¿çš„æœ€åå¼€å§‹å€’ç€å¾€å‰æ‰¾ChannelOutboundHandlerAdapterï¼Œä¸€å®šè¦æ³¨æ„é¡ºåºã€‚ @Override public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception { //å½“æ‰§è¡Œwriteæ“ä½œæ—¶ï¼Œä¼š System.out.println(msg); //writeçš„æ˜¯å•¥ï¼Œè¿™é‡Œå°±æ˜¯æ˜¯å•¥ //æˆ‘ä»¬å°†å…¶è½¬æ¢ä¸ºByteBufï¼Œè¿™æ ·æ‰èƒ½å‘é€å›å®¢æˆ·ç«¯ ctx.writeAndFlush(Unpooled.wrappedBuffer(msg.toString().getBytes())); } }) .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;1æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ctx.fireChannelRead(msg); } }) .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;2æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ctx.writeAndFlush(\u0026#34;ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šè¿˜æœ‰äººéƒ½çœ‹åˆ°è¿™é‡Œäº†è¿˜æ²¡ä¸‰è¿å§\u0026#34;); //è¿™é‡Œå¯ä»¥writeä»»ä½•å¯¹è±¡ //ctx.channel().writeAndFlush(\u0026#34;å•Šå¯¹å¯¹å¯¹\u0026#34;); æˆ–æ˜¯é€šè¿‡Channelè¿›è¡Œwriteä¹Ÿå¯ä»¥ } }); } ç°åœ¨æˆ‘ä»¬æ¥è¯•è¯•çœ‹ï¼Œæä¸¤ä¸ªå‡ºç«™çš„Handlerï¼ŒéªŒè¯ä¸€ä¸‹æ˜¯ä¸æ˜¯ä¸Šé¢çš„æ ·å­ï¼š\n@Override protected void initChannel(SocketChannel channel) { channel.pipeline() //ç›´æ¥è·å–pipelineï¼Œç„¶åæ·»åŠ ä¸¤ä¸ªHandler .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;1æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ctx.fireChannelRead(msg); } }) .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;2æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ctx.channel().writeAndFlush(\u0026#34;ä¼å…µä¸€å·å¢æœ¬ä¼Ÿ\u0026#34;); //è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨channelçš„write } }) .addLast(new ChannelOutboundHandlerAdapter(){ @Override public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception { System.out.println(\u0026#34;1å·å‡ºç«™ï¼š\u0026#34;+msg); } }) .addLast(new ChannelOutboundHandlerAdapter(){ @Override public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception { System.out.println(\u0026#34;2å·å‡ºç«™ï¼š\u0026#34;+msg); ctx.write(msg); //ç»§ç»­writeç»™å…¶ä»–çš„å‡ºç«™Handlerï¼Œä¸ç„¶åˆ°è¿™é‡Œå°±æ–­äº† } }); } æ‰€ä»¥ï¼Œå‡ºç«™æ“ä½œåœ¨æµæ°´çº¿ä¸Šæ˜¯åç€æ¥çš„ï¼Œæ•´ä¸ªæµæ°´çº¿æ“ä½œå¤§æ¦‚æµç¨‹å¦‚ä¸‹:\næœ‰å…³ChannelåŠå…¶å¤„ç†ç›¸å…³æ“ä½œï¼Œå°±å…ˆè®²åˆ°è¿™é‡Œã€‚\nEventLoopå’Œä»»åŠ¡è°ƒåº¦ #\rå‰é¢æˆ‘ä»¬è®²è§£äº†Channelï¼Œé‚£ä¹ˆåœ¨EventLoopä¸­å…·ä½“æ˜¯å¦‚ä½•è¿›è¡Œè°ƒåº¦çš„å‘¢ï¼Ÿå®é™…ä¸Šæˆ‘ä»¬ä¹‹å‰åœ¨ç¼–å†™NIOçš„æ—¶å€™ï¼Œå°±æ˜¯ä¸€ä¸ªwhileå¾ªç¯åœ¨æºæºä¸æ–­åœ°ç­‰å¾…æ–°çš„äº‹ä»¶ï¼Œè€ŒEventLoopä¹Ÿæ­£æ˜¯è¿™ç§æ€æƒ³ï¼Œå®ƒæœ¬è´¨å°±æ˜¯ä¸€ä¸ªäº‹ä»¶ç­‰å¾…/å¤„ç†çº¿ç¨‹ã€‚\næˆ‘ä»¬ä¸Šé¢ä½¿ç”¨çš„å°±æ˜¯EventLoopGroupï¼ŒåŒ…å«å¾ˆå¤šä¸ªEventLoopï¼Œæˆ‘ä»¬æ¯åˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œå°±éœ€è¦ç»‘å®šåˆ°ä¸€ä¸ªEventLoopä¸Šï¼Œä¹‹åEventLoopå°±ä¼šå¼€å§‹ç›‘å¬è¿™ä¸ªè¿æ¥ï¼ˆåªè¦è¿æ¥ä¸å…³é—­ï¼Œä¸€ç›´éƒ½æ˜¯è¿™ä¸ªEventLoopè´Ÿè´£æ­¤Channelï¼‰ï¼Œè€Œä¸€ä¸ªEventLoopå¯ä»¥åŒæ—¶ç›‘å¬å¾ˆå¤šä¸ªChannelï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„Selectorç½¢äº†ã€‚\nå½“ç„¶ï¼ŒEventLoopå¹¶ä¸åªæ˜¯ç”¨äºç½‘ç»œæ“ä½œçš„ï¼Œæˆ‘ä»¬å‰é¢æ‰€è¯´çš„EventLoopå…¶å®éƒ½æ˜¯NioEventLoopï¼Œå®ƒæ˜¯ä¸“ç”¨äºç½‘ç»œé€šä¿¡çš„ï¼Œé™¤äº†ç½‘ç»œé€šä¿¡ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ™®é€šçš„EventLoopæ¥å¤„ç†ä¸€äº›å…¶ä»–çš„äº‹ä»¶ã€‚\næ¯”å¦‚æˆ‘ä»¬ç°åœ¨ç¼–å†™çš„æœåŠ¡ç«¯ï¼Œè™½ç„¶ç»“æ„ä¸Šå’Œä¸»ä»Reactorå¤šçº¿ç¨‹æ¨¡å‹å·®ä¸å¤šï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼ŒHandlerä¼¼ä¹æ˜¯å’Œè¯»å†™æ“ä½œåœ¨ä¸€èµ·è¿›è¡Œçš„ï¼Œè€Œæˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„æ¨¡å‹ä¸­ï¼ŒHandleræ˜¯åœ¨è¯»å†™ä¹‹å¤–çš„å•ç‹¬çº¿ç¨‹ä¸­è¿›è¡Œçš„ï¼š\npublic static void main(String[] args) { EventLoopGroup bossGroup = new NioEventLoopGroup(), workerGroup = new NioEventLoopGroup(1); //çº¿ç¨‹æ•°å…ˆé™åˆ¶ä¸€ä¸‹ ServerBootstrap bootstrap = new ServerBootstrap(); bootstrap .group(bossGroup, workerGroup) //æŒ‡å®šäº‹ä»¶å¾ªç¯ç»„ .channel(NioServerSocketChannel.class) //æŒ‡å®šä¸ºNIOçš„ServerSocketChannel .childHandler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { //æ³¨æ„ï¼Œè¿™é‡Œçš„SocketChannelä¸æ˜¯æˆ‘ä»¬NIOé‡Œé¢çš„ï¼Œæ˜¯Nettyçš„ @Override protected void initChannel(SocketChannel channel) { channel.pipeline() .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); Thread.sleep(10000); //è¿™é‡Œæˆ‘ä»¬ç›´æ¥å¡10ç§’å‡è£…åœ¨å¤„ç†ä»»åŠ¡ ctx.writeAndFlush(Unpooled.wrappedBuffer(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); } }); } }); bootstrap.bind(8080); } å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœåœ¨è¿™é‡Œå¡ä½äº†ï¼Œé‚£ä¹ˆå°±æ²¡åŠæ³•å¤„ç†EventLoopç»‘å®šçš„å…¶ä»–Channeläº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå°±åˆ›å»ºä¸€ä¸ªæ™®é€šçš„EventLoopæ¥ä¸“é—¨å¤„ç†è¯»å†™ä¹‹å¤–çš„ä»»åŠ¡ï¼š\npublic static void main(String[] args) { EventLoopGroup bossGroup = new NioEventLoopGroup(), workerGroup = new NioEventLoopGroup(1); //çº¿ç¨‹æ•°å…ˆé™åˆ¶ä¸€ä¸‹ EventLoopGroup handlerGroup = new DefaultEventLoopGroup(); //ä½¿ç”¨DefaultEventLoopæ¥å¤„ç†å…¶ä»–ä»»åŠ¡ ServerBootstrap bootstrap = new ServerBootstrap(); bootstrap .group(bossGroup, workerGroup) .channel(NioServerSocketChannel.class) .childHandler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { @Override protected void initChannel(SocketChannel channel) { channel.pipeline() .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); handlerGroup.submit(() -\u0026gt; { //ç”±äºç»§æ‰¿è‡ªScheduledExecutorServiceï¼Œæˆ‘ä»¬ç›´æ¥æäº¤ä»»åŠ¡å°±è¡Œäº†ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è´¼æ–¹ä¾¿ try { Thread.sleep(10000); } catch (InterruptedException e) { throw new RuntimeException(e); } ctx.writeAndFlush(Unpooled.wrappedBuffer(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); }); } }); } }); bootstrap.bind(8080); } å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™æˆä¸€æ¡æµæ°´çº¿ï¼š\npublic static void main(String[] args) { EventLoopGroup bossGroup = new NioEventLoopGroup(), workerGroup = new NioEventLoopGroup(1); //çº¿ç¨‹æ•°å…ˆé™åˆ¶ä¸€ä¸‹ EventLoopGroup handlerGroup = new DefaultEventLoopGroup(); //ä½¿ç”¨DefaultEventLoopæ¥å¤„ç†å…¶ä»–ä»»åŠ¡ ServerBootstrap bootstrap = new ServerBootstrap(); bootstrap .group(bossGroup, workerGroup) .channel(NioServerSocketChannel.class) .childHandler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { @Override protected void initChannel(SocketChannel channel) { channel.pipeline() .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ctx.fireChannelRead(msg); } }).addLast(handlerGroup, new ChannelInboundHandlerAdapter(){ //åœ¨æ·»åŠ æ—¶ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ªEventLoopGroup @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { try { Thread.sleep(10000); } catch (InterruptedException e) { throw new RuntimeException(e); } ctx.writeAndFlush(Unpooled.wrappedBuffer(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); } }); } }); bootstrap.bind(8080); } è¿™æ ·ï¼Œæˆ‘ä»¬å°±è¿›ä¸€æ­¥åœ°å°†EventLoopåˆ©ç”¨èµ·æ¥äº†ã€‚\næŒ‰ç…§å‰é¢æœåŠ¡ç«¯çš„æ–¹å¼ï¼Œæˆ‘ä»¬æ¥æŠŠNettyç‰ˆæœ¬çš„å®¢æˆ·ç«¯ä¹Ÿç»™å†™äº†ï¼š\npublic static void main(String[] args) { Bootstrap bootstrap = new Bootstrap(); //å®¢æˆ·ç«¯ä¹Ÿæ˜¯ä½¿ç”¨Bootstrapæ¥å¯åŠ¨ bootstrap .group(new NioEventLoopGroup()) //å®¢æˆ·ç«¯å°±æ²¡é‚£ä¹ˆéº»çƒ¦äº†ï¼Œç›´æ¥ä¸€ä¸ªEventLoopå°±è¡Œï¼Œç”¨äºå¤„ç†å‘å›æ¥çš„æ•°æ® .channel(NioSocketChannel.class) //å®¢æˆ·ç«¯è‚¯å®šå°±æ˜¯ä½¿ç”¨SocketChanneläº† .handler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { //è¿™é‡Œçš„æ•°æ®å¤„ç†æ–¹å¼å’ŒæœåŠ¡ç«¯æ˜¯ä¸€æ ·çš„ @Override protected void initChannel(SocketChannel channel) throws Exception { channel.pipeline().addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;\u0026gt;\u0026gt; æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); } }); } }); Channel channel = bootstrap.connect(\u0026#34;localhost\u0026#34;, 8080).channel(); //è¿æ¥åæ‹¿åˆ°å¯¹åº”çš„Channelå¯¹è±¡ //æ³¨æ„ä¸Šé¢è¿æ¥æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œè°ƒç”¨ä¹‹åä¼šç»§ç»­å¾€ä¸‹èµ°ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ­£å¼ç¼–å†™å®¢æˆ·ç«¯çš„æ•°æ®å‘é€ä»£ç äº† try(Scanner scanner = new Scanner(System.in)){ //è¿˜æ˜¯å’Œä¹‹å‰ä¸€æ ·ï¼Œæ‰«äº†å°±å‘ while (true) { System.out.println(\u0026#34;\u0026lt;\u0026lt; è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); if(text.isEmpty()) continue; channel.writeAndFlush(Unpooled.wrappedBuffer(text.getBytes())); //é€šè¿‡Channelå¯¹è±¡å‘é€æ•°æ® } } } æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼š\nFutureå’ŒPromise #\ræˆ‘ä»¬æ¥ç€æ¥çœ‹ChannelFutureï¼Œå‰é¢æˆ‘ä»¬æåˆ°ï¼ŒNettyä¸­Channelçš„ç›¸å…³æ“ä½œéƒ½æ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œå¹¶ä¸æ˜¯åœ¨å½“å‰çº¿ç¨‹åŒæ­¥æ‰§è¡Œï¼Œæˆ‘ä»¬ä¸èƒ½ç«‹å³å¾—åˆ°æ‰§è¡Œç»“æœï¼Œå¦‚æœéœ€è¦å¾—åˆ°ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¿…é¡»è¦åˆ©ç”¨åˆ°Futureã€‚\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ChannelFutueræ¥å£æ€ä¹ˆå®šä¹‰çš„ï¼š\npublic interface ChannelFuture extends Future\u0026lt;Void\u0026gt; { Channel channel(); //æˆ‘ä»¬å¯ä»¥ç›´æ¥è·å–æ­¤ä»»åŠ¡çš„Channel ChannelFuture addListener(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super Void\u0026gt;\u0026gt; var1); //å½“ä»»åŠ¡å®Œæˆæ—¶ï¼Œä¼šç›´æ¥æ‰§è¡ŒGenericFutureListenerçš„ä»»åŠ¡ï¼Œæ³¨æ„æ‰§è¡Œçš„ä½ç½®ä¹Ÿæ˜¯åœ¨EventLoopä¸­ ChannelFuture addListeners(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super Void\u0026gt;\u0026gt;... var1); ChannelFuture removeListener(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super Void\u0026gt;\u0026gt; var1); ChannelFuture removeListeners(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super Void\u0026gt;\u0026gt;... var1); ChannelFuture sync() throws InterruptedException; //åœ¨å½“å‰çº¿ç¨‹åŒæ­¥ç­‰å¾…å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œä»»åŠ¡å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸ ChannelFuture syncUninterruptibly(); //åŒä¸Šï¼Œä½†æ˜¯æ— æ³•å“åº”ä¸­æ–­ ChannelFuture await() throws InterruptedException; //åŒä¸Šï¼Œä½†æ˜¯ä»»åŠ¡ä¸­æ–­ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦æ‰‹åŠ¨åˆ¤æ–­ ChannelFuture awaitUninterruptibly(); //ä¸ç”¨æˆ‘è¯´äº†å§ï¼Ÿ boolean isVoid(); //è¿”å›ç±»å‹æ˜¯å¦ä¸ºvoid } æ­¤æ¥å£æ˜¯ç»§æ‰¿è‡ªNettyä¸­çš„Futureæ¥å£çš„ï¼ˆä¸æ˜¯JDKçš„é‚£ä¸ªï¼‰ï¼š\npublic interface Future\u0026lt;V\u0026gt; extends java.util.concurrent.Future\u0026lt;V\u0026gt; { //å†å¾€ä¸Šæ‰æ˜¯JDKçš„Future boolean isSuccess(); //ç”¨äºåˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸçš„ boolean isCancellable(); Throwable cause(); //è·å–å¯¼è‡´ä»»åŠ¡å¤±è´¥çš„å¼‚å¸¸ ... V getNow(); //ç«‹å³è·å–ç»“æœï¼Œå¦‚æœè¿˜æœªäº§ç”Ÿç»“æœï¼Œå¾—åˆ°nullï¼Œä¸è¿‡ChannelFutureå®šä¹‰Vä¸ºVoidï¼Œå°±ç®—å®Œæˆäº†è·å–ä¹Ÿæ˜¯null boolean cancel(boolean var1); //å–æ¶ˆä»»åŠ¡ } Channelçš„å¾ˆå¤šæ“ä½œéƒ½æ˜¯å¼‚æ­¥å®Œæˆçš„ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªChannelFutureï¼Œæ¯”å¦‚Channelçš„writeæ“ä½œï¼Œè¿”å›çš„å°±æ˜¯ä¸€ä¸ªChannelFutureå¯¹è±¡ï¼š\n.addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+buf.toString(StandardCharsets.UTF_8)); ChannelFuture future = ctx.writeAndFlush(Unpooled.wrappedBuffer(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); System.out.println(\u0026#34;ä»»åŠ¡å®ŒæˆçŠ¶æ€ï¼š\u0026#34;+future.isDone()); //é€šè¿‡ChannelFutureæ¥è·å–ç›¸å…³ä¿¡æ¯ } }); åŒ…æ‹¬æˆ‘ä»¬çš„æœåŠ¡ç«¯å¯åŠ¨ä¹Ÿæ˜¯è¿”å›çš„ChannelFutureï¼š\n... } }); ChannelFuture future = bootstrap.bind(8080); System.out.println(\u0026#34;æœåŠ¡ç«¯å¯åŠ¨çŠ¶æ€ï¼š\u0026#34;+future.isDone()); System.out.println(\u0026#34;æˆ‘æ˜¯æœåŠ¡ç«¯å¯åŠ¨å®Œæˆä¹‹åè¦åšçš„äº‹æƒ…ï¼\u0026#34;); } å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡ç«¯çš„å¯åŠ¨å°±æ¯”è¾ƒæ…¢äº†ï¼Œæ‰€ä»¥åœ¨ä¸€å¼€å§‹ç›´æ¥è·å–çŠ¶æ€ä¼šè¿”å›falseï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åˆéœ€è¦ç­‰åˆ°æœåŠ¡ç«¯å¯åŠ¨å®Œæˆä¹‹ååšä¸€äº›äº‹æƒ…ï¼Œè¿™ä¸ªæ—¶å€™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç°åœ¨æˆ‘ä»¬å°±æœ‰ä¸¤ç§æ–¹æ¡ˆäº†ï¼š\n} }); ChannelFuture future = bootstrap.bind(8080); future.sync(); //è®©å½“å‰çº¿ç¨‹åŒæ­¥ç­‰å¾…ä»»åŠ¡å®Œæˆ System.out.println(\u0026#34;æœåŠ¡ç«¯å¯åŠ¨çŠ¶æ€ï¼š\u0026#34;+future.isDone()); System.out.println(\u0026#34;æˆ‘æ˜¯æœåŠ¡ç«¯å¯åŠ¨å®Œæˆä¹‹åè¦åšçš„äº‹æƒ…ï¼\u0026#34;); } ç¬¬ä¸€ç§æ–¹æ¡ˆæ˜¯ç›´æ¥è®©å½“å‰çº¿ç¨‹åŒæ­¥ç­‰å¾…å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨sync()æ–¹æ³•ï¼Œè¿™æ ·å½“å‰çº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ç›´åˆ°ä»»åŠ¡ç»“æŸã€‚ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ï¼Œç­‰å¾…ä»»åŠ¡å®Œæˆæ—¶é€šçŸ¥ï¼š\n} }); ChannelFuture future = bootstrap.bind(8080); //ç›´æ¥æ·»åŠ ç›‘å¬å™¨ï¼Œå½“ä»»åŠ¡å®Œæˆæ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œä½†æ˜¯æ³¨æ„æ‰§è¡Œä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œä¸æ˜¯åœ¨å½“å‰çº¿ç¨‹ future.addListener(f -\u0026gt; System.out.println(\u0026#34;æˆ‘æ˜¯æœåŠ¡ç«¯å¯åŠ¨å®Œæˆä¹‹åè¦åšçš„äº‹æƒ…ï¼\u0026#34;)); } åŒ…æ‹¬å®¢æˆ·ç«¯çš„å…³é—­ï¼Œä¹Ÿæ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼š\ntry(Scanner scanner = new Scanner(System.in)){ while (true) { System.out.println(\u0026#34;\u0026lt;\u0026lt; è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); if(text.isEmpty()) continue; if(text.equals(\u0026#34;exit\u0026#34;)) { //è¾“å…¥exitå°±é€€å‡º ChannelFuture future = channel.close(); future.sync(); //ç­‰å¾…Channelå®Œå…¨å…³é—­ break; } channel.writeAndFlush(Unpooled.wrappedBuffer(text.getBytes())); } } catch (InterruptedException e) { throw new RuntimeException(e); } finally { group.shutdownGracefully(); //ä¼˜é›…é€€å‡ºEventLoopï¼Œå…¶å®å°±æ˜¯æŠŠè¿˜æ²¡å‘é€çš„æ•°æ®ä¹‹ç±»çš„äº‹æƒ…åšå®Œï¼Œå½“ç„¶ä¹Ÿå¯ä»¥shutdownNowç«‹å³å…³é—­ } æˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹Promiseæ¥å£ï¼Œå®ƒæ”¯æŒæ‰‹åŠ¨è®¾å®šæˆåŠŸå’Œå¤±è´¥çš„ç»“æœï¼š\n//æ­¤æ¥å£ä¹Ÿæ˜¯ç»§æ‰¿è‡ªNettyä¸­çš„Futureæ¥å£ public interface Promise\u0026lt;V\u0026gt; extends Future\u0026lt;V\u0026gt; { Promise\u0026lt;V\u0026gt; setSuccess(V var1); //æ‰‹åŠ¨è®¾å®šæˆåŠŸ boolean trySuccess(V var1); Promise\u0026lt;V\u0026gt; setFailure(Throwable var1); //æ‰‹åŠ¨è®¾å®šå¤±è´¥ boolean tryFailure(Throwable var1); boolean setUncancellable(); //è¿™äº›å°±å’Œä¹‹å‰çš„Futureæ˜¯ä¸€æ ·çš„äº† Promise\u0026lt;V\u0026gt; addListener(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super V\u0026gt;\u0026gt; var1); Promise\u0026lt;V\u0026gt; addListeners(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super V\u0026gt;\u0026gt;... var1); Promise\u0026lt;V\u0026gt; removeListener(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super V\u0026gt;\u0026gt; var1); Promise\u0026lt;V\u0026gt; removeListeners(GenericFutureListener\u0026lt;? extends Future\u0026lt;? super V\u0026gt;\u0026gt;... var1); Promise\u0026lt;V\u0026gt; await() throws InterruptedException; Promise\u0026lt;V\u0026gt; awaitUninterruptibly(); Promise\u0026lt;V\u0026gt; sync() throws InterruptedException; Promise\u0026lt;V\u0026gt; syncUninterruptibly(); } æ¯”å¦‚æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\npublic static void main(String[] args) throws ExecutionException, InterruptedException { Promise\u0026lt;String\u0026gt; promise = new DefaultPromise\u0026lt;\u0026gt;(new DefaultEventLoop()); System.out.println(promise.isSuccess()); //åœ¨ä¸€å¼€å§‹è‚¯å®šä¸æ˜¯æˆåŠŸçš„ promise.setSuccess(\u0026#34;lbwnb\u0026#34;); //è®¾å®šæˆåŠŸ System.out.println(promise.isSuccess()); //å†æ¬¡è·å–ï¼Œå¯ä»¥å‘ç°ç¡®å®æˆåŠŸäº† System.out.println(promise.get()); //è·å–ç»“æœï¼Œå°±æ˜¯æˆ‘ä»¬åˆšåˆšç»™è¿›å»çš„ } å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šæˆåŠŸçŠ¶æ€ï¼ŒåŒ…æ‹¬ChannelOutboundInvokerä¸­çš„ä¸€äº›åŸºæœ¬æ“ä½œï¼Œéƒ½æ˜¯æ”¯æŒChannelPromiseçš„ï¼š\n.addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ByteBuf buf = (ByteBuf) msg; String text = buf.toString(StandardCharsets.UTF_8); System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34;+text); ChannelPromise promise = new DefaultChannelPromise(channel); System.out.println(promise.isSuccess()); ctx.writeAndFlush(Unpooled.wrappedBuffer(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes()), promise); promise.sync(); //åŒæ­¥ç­‰å¾…ä¸€ä¸‹ System.out.println(promise.isSuccess()); } }); æœ€åç»“æœå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„äº†ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åƒFutureé‚£æ ·æ·»åŠ ç›‘å¬å™¨ï¼Œå½“æˆåŠŸæ—¶è‡ªåŠ¨é€šçŸ¥ï¼š\npublic static void main(String[] args) throws ExecutionException, InterruptedException { Promise\u0026lt;String\u0026gt; promise = new DefaultPromise\u0026lt;\u0026gt;(new DefaultEventLoop()); promise.addListener(f -\u0026gt; System.out.println(promise.get())); //æ³¨æ„æ˜¯åœ¨ä¸Šé¢çš„DefaultEventLoopæ‰§è¡Œçš„ System.out.println(promise.isSuccess()); promise.setSuccess(\u0026#34;lbwnb\u0026#34;); System.out.println(promise.isSuccess()); } æœ‰å…³Futureå’ŒPromiseå°±æš‚æ—¶è®²è§£åˆ°è¿™é‡Œã€‚\nç¼–ç å™¨å’Œè§£ç å™¨ #\rå‰é¢æˆ‘ä»¬å·²ç»äº†è§£äº†Nettyçš„å¤§éƒ¨åˆ†åŸºç¡€å†…å®¹ï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹Nettyå†…ç½®çš„ä¸€äº›ç¼–ç å™¨å’Œè§£ç å™¨ã€‚\nåœ¨å‰é¢çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬çš„æ•°æ®å‘é€å’Œæ¥æ”¶éƒ½æ˜¯éœ€è¦ä»¥ByteBufå½¢å¼ä¼ è¾“ï¼Œä½†æ˜¯è¿™æ ·æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤ªä¸æ–¹ä¾¿äº†ï¼Œå’±ä»¬èƒ½ä¸èƒ½å‚è€ƒä¸€ä¸‹JavaWebé‚£ç§æä¸ªFilterï¼Œåœ¨æˆ‘ä»¬å¼€å§‹å¤„ç†æ•°æ®ä¹‹å‰ï¼Œè¿‡è¿‡æ»¤ä¸€æ¬¡ï¼Œå¹¶åœ¨è¿‡æ»¤çš„é€”ä¸­å°†æ•°æ®è½¬æ¢æˆæˆ‘ä»¬æƒ³è¦çš„ç±»å‹ï¼Œä¹Ÿå¯ä»¥å°†å‘å‡ºçš„æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œè¿™å°±è¦ç”¨åˆ°ç¼–ç è§£ç å™¨äº†ã€‚\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æœ€ç®€çš„ï¼Œå­—ç¬¦ä¸²ï¼Œå¦‚æœæˆ‘ä»¬è¦ç›´æ¥åœ¨å®¢æˆ·ç«¯æˆ–æ˜¯æœåŠ¡ç«¯å¤„ç†å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²è§£ç å™¨åˆ°æˆ‘ä»¬çš„æµæ°´çº¿ä¸­ï¼š\n@Override protected void initChannel(SocketChannel channel) { channel.pipeline() //è§£ç å™¨æœ¬è´¨ä¸Šä¹Ÿç®—æ˜¯ä¸€ç§ChannelInboundHandlerAdapterï¼Œç”¨äºå¤„ç†å…¥ç«™è¯·æ±‚ .addLast(new StringDecoder()) //å½“å®¢æˆ·ç«¯å‘é€æ¥çš„æ•°æ®åªæ˜¯ç®€å•çš„å­—ç¬¦ä¸²è½¬æ¢çš„ByteBufæ—¶ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å†…ç½®çš„StringDecoderå³å¯è½¬æ¢ .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { //ç»è¿‡StringDecoderè½¬æ¢åï¼Œmsgç›´æ¥å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æ‰“å°å°±è¡Œäº† System.out.println(msg); } }); } å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨èµ·æ¥è¿˜æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶æ·»åŠ åˆ°æµæ°´çº¿å³å¯ï¼Œå®é™…ä¸Šå™¨æœ¬è´¨å°±æ˜¯ä¸€ä¸ªChannelInboundHandlerAdapterï¼š\næˆ‘ä»¬çœ‹åˆ°å®ƒæ˜¯ç»§æ‰¿è‡ªMessageToMessageDecoderï¼Œç”¨äºå°†ä¼ å…¥çš„Messageè½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªè¡Œç¼–å†™ä¸€ä¸ªå®ç°ï¼š\n/** * æˆ‘ä»¬ä¹Ÿæ¥æä¸€ä¸ªè‡ªå®šä¹‰çš„ */ public class TestDecoder extends MessageToMessageDecoder\u0026lt;ByteBuf\u0026gt; { @Override protected void decode(ChannelHandlerContext channelHandlerContext, ByteBuf buf, List\u0026lt;Object\u0026gt; list) throws Exception { System.out.println(\u0026#34;æ•°æ®å·²æ”¶åˆ°ï¼Œæ­£åœ¨è¿›è¡Œè§£ç ...\u0026#34;); String text = buf.toString(StandardCharsets.UTF_8); //ç›´æ¥è½¬æ¢ä¸ºUTF8å­—ç¬¦ä¸² list.add(text); //è§£ç åéœ€è¦å°†è§£æåçš„æ•°æ®ä¸¢è¿›Listä¸­ï¼Œå¦‚æœä¸¢è¿›å»å¤šä¸ªæ•°æ®ï¼Œç›¸å½“äºæ•°æ®è¢«åˆ†æˆäº†å¤šä¸ªï¼Œåé¢çš„Handlerå°±éœ€è¦æ¯ä¸ªéƒ½å¤„ç†ä¸€æ¬¡ } } è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ï¼š\nå½“ç„¶å¦‚æœæˆ‘ä»¬åœ¨Listé‡Œé¢ä¸¢å¾ˆå¤šä¸ªæ•°æ®çš„è¯ï¼š\npublic class TestDecoder extends MessageToMessageDecoder\u0026lt;ByteBuf\u0026gt; { @Override protected void decode(ChannelHandlerContext channelHandlerContext, ByteBuf buf, List\u0026lt;Object\u0026gt; list) throws Exception { System.out.println(\u0026#34;æ•°æ®å·²æ”¶åˆ°ï¼Œæ­£åœ¨è¿›è¡Œè§£ç ...\u0026#34;); String text = buf.toString(StandardCharsets.UTF_8); //ç›´æ¥è½¬æ¢ä¸ºUTF8å­—ç¬¦ä¸² list.add(text); list.add(text+\u0026#34;2\u0026#34;); list.add(text+\u0026#39;3\u0026#39;); //ä¸€æ¡æ¶ˆæ¯è¢«è§£ç æˆä¸‰æ¡æ¶ˆæ¯ } } å¯ä»¥çœ‹åˆ°ï¼Œåé¢çš„Handlerä¼šä¾æ¬¡å¯¹ä¸‰æ¡æ•°æ®éƒ½è¿›è¡Œå¤„ç†ï¼Œå½“ç„¶ï¼Œé™¤äº†MessageToMessageDecoderä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–ç±»å‹çš„è§£ç å™¨ï¼Œæ¯”å¦‚ByteToMessageDecoderç­‰ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†ï¼ŒNettyå†…ç½®äº†å¾ˆå¤šçš„è§£ç å™¨å®ç°æ¥æ–¹ä¾¿æˆ‘ä»¬å¼€å‘ï¼Œæ¯”å¦‚HTTPï¼ˆä¸‹ä¸€èŠ‚ä»‹ç»ï¼‰ï¼ŒSMTPã€MQTTç­‰ï¼Œä»¥åŠæˆ‘ä»¬å¸¸ç”¨çš„Redisã€Memcachedã€JSONç­‰æ•°æ®åŒ…ã€‚\nå½“ç„¶ï¼Œæœ‰äº†è§£ç å™¨å¤„ç†å‘æ¥çš„æ•°æ®ï¼Œé‚£å‘å‡ºå»çš„æ•°æ®è‚¯å®šä¹Ÿæ˜¯éœ€è¦è¢«å¤„ç†çš„ï¼Œæ‰€ä»¥ç¼–ç å™¨å°±å‡ºç°äº†ï¼š\nchannel.pipeline() //è§£ç å™¨æœ¬è´¨ä¸Šä¹Ÿç®—æ˜¯ä¸€ç§ChannelInboundHandlerAdapterï¼Œç”¨äºå¤„ç†å…¥ç«™è¯·æ±‚ .addLast(new StringDecoder()) .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { System.out.println(\u0026#34;æ”¶åˆ°å®¢æˆ·ç«¯çš„æ•°æ®ï¼š\u0026#34;+msg); ctx.channel().writeAndFlush(\u0026#34;å¯ä»¥ï¼Œä¸è·Ÿä½ å¤šBB\u0026#34;); //ç›´æ¥å‘å­—ç¬¦ä¸²å›å» } }) .addLast(new StringEncoder()); //ä½¿ç”¨å†…ç½®çš„StringEncoderå¯ä»¥ç›´æ¥å°†å‡ºç«™çš„å­—ç¬¦ä¸²æ•°æ®ç¼–ç æˆByteBuf å’Œä¸Šé¢çš„StringDecoderä¸€æ ·ï¼ŒStringEncoderæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªChannelOutboundHandlerAdapterï¼š\næ˜¯ä¸æ˜¯æ„Ÿè§‰å‰é¢å­¦ä¹ çš„Handlerå’ŒPipelineçªç„¶å°±å˜å¾—æœ‰ç”¨äº†ï¼Œç›´æ¥ä¸€æ¡çº¿æŠŠæ•°æ®å¤„ç†å®‰æ’å¾—æ˜æ˜ç™½ç™½å•Šã€‚\nç°åœ¨æˆ‘ä»¬æŠŠå®¢æˆ·ç«¯ä¹Ÿæ”¹æˆä½¿ç”¨ç¼–ç ã€è§£ç å™¨çš„æ ·å­ï¼š\npublic static void main(String[] args) { Bootstrap bootstrap = new Bootstrap(); bootstrap .group(new NioEventLoopGroup()) .channel(NioSocketChannel.class) .handler(new ChannelInitializer\u0026lt;SocketChannel\u0026gt;() { @Override protected void initChannel(SocketChannel channel) throws Exception { channel.pipeline() .addLast(new StringDecoder()) //è§£ç å™¨å®‰æ’ .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { System.out.println(\u0026#34;\u0026gt;\u0026gt; æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34; + msg); //ç›´æ¥æ¥æ”¶å­—ç¬¦ä¸² } }) .addLast(new StringEncoder()); //ç¼–ç å™¨å®‰æ’ } }); Channel channel = bootstrap.connect(\u0026#34;localhost\u0026#34;, 8080).channel(); try(Scanner scanner = new Scanner(System.in)){ while (true) { System.out.println(\u0026#34;\u0026lt;\u0026lt; è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); if(text.isEmpty()) continue; channel.writeAndFlush(text); //ç›´æ¥å‘é€å­—ç¬¦ä¸²å°±è¡Œ } } } è¿™æ ·æˆ‘ä»¬çš„ä»£ç é‡åˆè¹­è¹­çš„å‡å°‘äº†å¾ˆå¤šï¼š\nå½“ç„¶ï¼Œé™¤äº†ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹å¤–ï¼Œè¿˜æœ‰ç¼–è§£ç å™¨ã€‚ï¼Ÿï¼Ÿç¼åˆæ€ªï¼Ÿï¼Ÿ\nå¯ä»¥çœ‹åˆ°å®ƒæ˜¯æ—¢ç»§æ‰¿äº†ChannelInboundHandlerAdapterä¹Ÿå®ç°äº†ChannelOutboundHandleræ¥å£ï¼Œåˆèƒ½å¤„ç†å‡ºç«™ä¹Ÿèƒ½å¤„ç†å…¥ç«™è¯·æ±‚ï¼Œå®é™…ä¸Šå°±æ˜¯å°†ä¹‹å‰çš„ç»™ç»„åˆåˆ°ä¸€èµ·äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°ä¸€ä¸ªç¼åˆåœ¨ä¸€èµ·çš„StringCodecç±»ï¼š\n//éœ€è¦æŒ‡å®šä¸¤ä¸ªæ³›å‹ï¼Œç¬¬ä¸€ä¸ªæ˜¯å…¥ç«™çš„æ¶ˆæ¯ç±»å‹ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯å‡ºç«™çš„æ¶ˆæ¯ç±»å‹ï¼Œå‡ºç«™æ˜¯Stringç±»å‹ï¼Œæˆ‘ä»¬è¦è½¬æˆByteBuf public class StringCodec extends MessageToMessageCodec\u0026lt;ByteBuf, String\u0026gt; { @Override protected void encode(ChannelHandlerContext channelHandlerContext, String buf, List\u0026lt;Object\u0026gt; list) throws Exception { System.out.println(\u0026#34;æ­£åœ¨å¤„ç†å‡ºç«™æ•°æ®...\u0026#34;); list.add(Unpooled.wrappedBuffer(buf.getBytes())); //åŒæ ·çš„ï¼Œæ·»åŠ çš„æ•°é‡å°±æ˜¯å‡ºç«™çš„æ¶ˆæ¯æ•°é‡ } @Override protected void decode(ChannelHandlerContext channelHandlerContext, ByteBuf buf, List\u0026lt;Object\u0026gt; list) throws Exception { System.out.println(\u0026#34;æ­£åœ¨å¤„ç†å…¥ç«™æ•°æ®...\u0026#34;); list.add(buf.toString(StandardCharsets.UTF_8)); //å’Œä¹‹å‰ä¸€æ ·ï¼Œç›´æ¥ä¸€è¡Œè§£å†³ } } å¯ä»¥çœ‹åˆ°å®é™…ä¸Šå°±æ˜¯éœ€è¦æˆ‘ä»¬åŒæ—¶å»å®ç°ç¼–ç å’Œè§£ç æ–¹æ³•ï¼Œç»§æ‰¿MessageToMessageCodecç±»å³å¯ã€‚\nå½“ç„¶ï¼Œå¦‚æœæ•´æ¡æµæ°´çº¿ä¸Šæœ‰å¾ˆå¤šä¸ªè§£ç å™¨æˆ–æ˜¯ç¼–ç å™¨ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥å¤šæ¬¡è¿›è¡Œç¼–ç æˆ–æ˜¯è§£ç ï¼Œæ¯”å¦‚ï¼š\npublic class StringToStringEncoder extends MessageToMessageEncoder\u0026lt;String\u0026gt; { @Override protected void encode(ChannelHandlerContext channelHandlerContext, String s, List\u0026lt;Object\u0026gt; list) throws Exception { System.out.println(\u0026#34;æˆ‘æ˜¯é¢„å¤„ç†ç¼–ç å™¨ï¼Œå°±è¦çš®è¿™ä¸€ä¸‹ã€‚\u0026#34;); list.add(\u0026#34;[å·²å¤„ç†] \u0026#34;+s); } } channel.pipeline() //è§£ç å™¨æœ¬è´¨ä¸Šä¹Ÿç®—æ˜¯ä¸€ç§ChannelInboundHandlerAdapterï¼Œç”¨äºå¤„ç†å…¥ç«™è¯·æ±‚ .addLast(new StringDecoder()) .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { System.out.println(\u0026#34;æ”¶åˆ°å®¢æˆ·ç«¯çš„æ•°æ®ï¼š\u0026#34;+msg); ctx.channel().writeAndFlush(\u0026#34;å¯ä»¥ï¼Œä¸è·Ÿä½ å¤šBB\u0026#34;); //ç›´æ¥å‘å­—ç¬¦ä¸²å›å» } }) .addLast(new StringEncoder()) //æœ€åå†è½¬æˆByteBuf .addLast(new StringToStringEncoder()); //å…ˆä»æˆ‘ä»¬è‡ªå®šä¹‰çš„å¼€å§‹ å¯ä»¥çœ‹åˆ°ï¼Œæ•°æ®åœ¨æµæ°´çº¿ä¸Šä¸€å±‚ä¸€å±‚å¤„ç†æœ€åå†å›åˆ°çš„å®¢æˆ·ç«¯ï¼š\næˆ‘ä»¬åœ¨ä¸€å¼€å§‹æåˆ°çš„ç²˜åŒ…/æ‹†åŒ…é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªè§£ç å™¨è§£å†³ï¼š\nchannel.pipeline() .addLast(new FixedLengthFrameDecoder(10)) //ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨å®šé•¿æ•°æ®åŒ…ï¼Œæ¯ä¸ªæ•°æ®åŒ…éƒ½è¦æ˜¯æŒ‡å®šé•¿åº¦ ... channel.pipeline() .addLast(new DelimiterBasedFrameDecoder(1024, Unpooled.wrappedBuffer(\u0026#34;!\u0026#34;.getBytes()))) //ç¬¬äºŒç§ï¼Œå°±æ˜¯æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„åˆ†éš”ç¬¦ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œä»¥æ„Ÿå¹å·ä¸ºåˆ†éš”ç¬¦ //åœ¨æ”¶åˆ°åˆ†éš”ç¬¦ä¹‹å‰çš„æ‰€æœ‰æ•°æ®ï¼Œéƒ½ä½œä¸ºåŒä¸€ä¸ªæ•°æ®åŒ…çš„å†…å®¹ channel.pipeline() .addLast(new LengthFieldBasedFrameDecoder(1024, 0, 4)) //ç¬¬ä¸‰ç§æ–¹æ¡ˆï¼Œå°±æ˜¯åœ¨å¤´éƒ¨æ·»åŠ é•¿åº¦ä¿¡æ¯ï¼Œæ¥ç¡®å®šå½“å‰å‘é€çš„æ•°æ®åŒ…å…·ä½“é•¿åº¦æ˜¯å¤šå°‘ //offsetæ˜¯ä»å“ªé‡Œå¼€å§‹ï¼Œlengthæ˜¯é•¿åº¦ä¿¡æ¯å å¤šå°‘å­—èŠ‚ï¼Œè¿™é‡Œæ˜¯ä»0å¼€å§‹è¯»4ä¸ªå­—èŠ‚è¡¨ç¤ºæ•°æ®åŒ…é•¿åº¦ .addLast(new StringDecoder()) channel.pipeline() .addLast(new StringDecoder()) .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { System.out.println(\u0026#34;\u0026gt;\u0026gt; æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼š\u0026#34; + msg); } }) .addLast(new LengthFieldPrepender(4)) //å®¢æˆ·ç«¯åœ¨å‘é€æ—¶ä¹Ÿéœ€è¦å°†é•¿åº¦æ‹¼åˆ°å‰é¢å» .addLast(new StringEncoder()); æœ‰å…³ç¼–ç å™¨å’Œè§£ç å™¨çš„å†…å®¹å°±å…ˆä»‹ç»åˆ°è¿™é‡Œã€‚\nå®ç°HTTPåè®®é€šä¿¡ #\rå‰é¢æˆ‘ä»¬ä»‹ç»äº†Nettyä¸ºæˆ‘ä»¬æä¾›çš„ç¼–ç å™¨å’Œè§£ç å™¨ï¼Œè¿™é‡Œæˆ‘ä»¬å°±æ¥ä½¿ç”¨ä¸€ä¸‹æ”¯æŒHTTPåè®®çš„ç¼–ç å™¨å’Œè§£ç å™¨ã€‚\nchannel.pipeline() .addLast(new HttpRequestDecoder()) //Httpè¯·æ±‚è§£ç å™¨ .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { System.out.println(\u0026#34;æ”¶åˆ°å®¢æˆ·ç«¯çš„æ•°æ®ï¼š\u0026#34;+msg.getClass()); //çœ‹çœ‹æ˜¯ä¸ªå•¥ç±»å‹ //æ”¶åˆ°æµè§ˆå™¨è¯·æ±‚åï¼Œæˆ‘ä»¬éœ€è¦ç»™ä¸€ä¸ªå“åº”å›å» FullHttpResponse response = new DefaultFullHttpResponse(HttpVersion.HTTP_1_1, HttpResponseStatus.OK); //HTTPç‰ˆæœ¬ä¸º1.1ï¼ŒçŠ¶æ€ç å°±OKï¼ˆ200ï¼‰å³å¯ //ç›´æ¥å‘å“åº”å†…å®¹ä¸­å†™å…¥æ•°æ® response.content().writeCharSequence(\u0026#34;Hello World!\u0026#34;, StandardCharsets.UTF_8); ctx.channel().writeAndFlush(response); //å‘é€å“åº” ctx.channel().close(); //HTTPè¯·æ±‚æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ‰€ä»¥è®°å¾—å…³é—­ } }) .addLast(new HttpResponseEncoder()); //å“åº”è®°å¾—ä¹Ÿè¦ç¼–ç åå‘é€å“¦ ç°åœ¨æˆ‘ä»¬ç”¨æµè§ˆå™¨è®¿é—®ä¸€ä¸‹æˆ‘ä»¬çš„æœåŠ¡å™¨å§ï¼š\nå¯ä»¥çœ‹åˆ°æµè§ˆå™¨æˆåŠŸæ¥æ”¶åˆ°æœåŠ¡å™¨å“åº”ï¼Œç„¶åæ§åˆ¶å°æ‰“å°äº†ä»¥ä¸‹ç±»å‹ï¼š\nå¯ä»¥çœ‹åˆ°ä¸€æ¬¡è¯·æ±‚æ˜¯ä¸€ä¸ªDefaultHttpRequest+LastHttpContent$1ï¼Œè¿™é‡Œæœ‰ä¸¤ç»„æ˜¯å› ä¸ºæµè§ˆå™¨è¯·æ±‚äº†ä¸€ä¸ªåœ°å€ä¹‹åç´§æ¥ç€è¯·æ±‚äº†æˆ‘ä»¬ç½‘ç«™çš„faviconå›¾æ ‡ã€‚\nè¿™æ ·æŠŠæ•°æ®åˆ†å¼€å¤„ç†è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œè¦æ˜¯ç›´æ¥æ•´åˆæˆä¸€ä¸ªå¤šå¥½ï¼Œå®‰æ’ï¼š\nchannel.pipeline() .addLast(new HttpRequestDecoder()) //Httpè¯·æ±‚è§£ç å™¨ .addLast(new HttpObjectAggregator(Integer.MAX_VALUE)) //æä¸€ä¸ªèšåˆå™¨ï¼Œå°†å†…å®¹èšåˆä¸ºä¸€ä¸ªFullHttpRequestï¼Œå‚æ•°æ˜¯æœ€å¤§å†…å®¹é•¿åº¦ .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { FullHttpRequest request = (FullHttpRequest) msg; System.out.println(\u0026#34;æµè§ˆå™¨è¯·æ±‚è·¯å¾„ï¼š\u0026#34;+request.uri()); //ç›´æ¥è·å–è¯·æ±‚ç›¸å…³ä¿¡æ¯ FullHttpResponse response = new DefaultFullHttpResponse(HttpVersion.HTTP_1_1, HttpResponseStatus.OK); response.content().writeCharSequence(\u0026#34;Hello World!\u0026#34;, StandardCharsets.UTF_8); ctx.channel().writeAndFlush(response); ctx.channel().close(); } }) .addLast(new HttpResponseEncoder()); å†æ¬¡è®¿é—®ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥æ­£å¸¸è¯»å–è¯·æ±‚è·¯å¾„äº†ï¼š\næˆ‘ä»¬æ¥è¯•è¯•çœ‹æä¸ªé™æ€é¡µé¢ä»£ç†ç©ç©ï¼Œæ‹¿å‡ºæˆ‘ä»¬çš„é™ˆå¹´è€æ¨¡æ¿ï¼š\nå…¨éƒ¨æ”¾è¿›Resourceæ–‡ä»¶å¤¹ï¼Œä¸€ä¼šæ ¹æ®æµè§ˆå™¨çš„è¯·æ±‚è·¯å¾„ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿”å›å¯¹åº”çš„é¡µé¢äº†ï¼Œå…ˆå®‰æ’ä¸€ä¸ªè§£æå™¨ï¼Œç”¨äºè§£æè·¯å¾„ç„¶åå°†é™æ€é¡µé¢çš„å†…å®¹è¿”å›ï¼š\npublic class PageResolver { //ç›´æ¥å•ä¾‹æ¨¡å¼ private static final PageResolver INSTANCE = new PageResolver(); private PageResolver(){} public static PageResolver getInstance(){ return INSTANCE; } //è¯·æ±‚è·¯å¾„ç»™è¿›æ¥ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦å°†é¡µé¢æ‹¿åˆ°ï¼Œç„¶åè½¬æ¢æˆå“åº”æ•°æ®åŒ…å‘å›å» public FullHttpResponse resolveResource(String path){ if(path.startsWith(\u0026#34;/\u0026#34;)) { //åˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯æ­£å¸¸çš„è·¯å¾„è¯·æ±‚ path = path.equals(\u0026#34;/\u0026#34;) ? \u0026#34;index.html\u0026#34; : path.substring(1); //å¦‚æœæ˜¯ç›´æ¥è¯·æ±‚æ ¹è·¯å¾„ï¼Œé‚£å°±é»˜è®¤è¿”å›indexé¡µé¢ï¼Œå¦åˆ™å°±è¯¥è¿”å›ä»€ä¹ˆè·¯å¾„çš„æ–‡ä»¶å°±è¿”å›ä»€ä¹ˆ try(InputStream stream = this.getClass().getClassLoader().getResourceAsStream(path)) { if(stream != null) { //æ‹¿åˆ°æ–‡ä»¶è¾“å…¥æµä¹‹åï¼Œæ‰å¯ä»¥è¿”å›é¡µé¢ byte[] bytes = new byte[stream.available()]; stream.read(bytes); return this.packet(HttpResponseStatus.OK, bytes); //æ•°æ®å…ˆè¯»å‡ºæ¥ï¼Œç„¶åäº¤ç»™ä¸‹é¢çš„æ–¹æ³•æ‰“åŒ… } } catch (IOException e){ e.printStackTrace(); } } //å…¶ä»–æƒ…å†µä¸€å¾‹è¿”å›404 return this.packet(HttpResponseStatus.NOT_FOUND, \u0026#34;404 Not Found!\u0026#34;.getBytes()); } //åŒ…è£…æˆFullHttpResponseï¼ŒæŠŠçŠ¶æ€ç å’Œæ•°æ®å†™è¿›å» private FullHttpResponse packet(HttpResponseStatus status, byte[] data){ FullHttpResponse response = new DefaultFullHttpResponse(HttpVersion.HTTP_1_1, status); response.content().writeBytes(data); return response; } } ç°åœ¨æˆ‘ä»¬çš„é™æ€èµ„æºè§£æå°±å†™å¥½äº†ï¼Œæ¥ç€ï¼š\nchannel.pipeline() .addLast(new HttpRequestDecoder()) //Httpè¯·æ±‚è§£ç å™¨ .addLast(new HttpObjectAggregator(Integer.MAX_VALUE)) //æä¸€ä¸ªèšåˆå™¨ï¼Œå°†å†…å®¹èšåˆä¸ºä¸€ä¸ªFullHttpRequestï¼Œå‚æ•°æ˜¯æœ€å¤§å†…å®¹é•¿åº¦ .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { FullHttpRequest request = (FullHttpRequest) msg; //è¯·æ±‚è¿›æ¥äº†ç›´æ¥èµ°è§£æ PageResolver resolver = PageResolver.getInstance(); ctx.channel().writeAndFlush(resolver.resolveResource(request.uri())); ctx.channel().close(); } }) .addLast(new HttpResponseEncoder()); ç°åœ¨æˆ‘ä»¬å¯åŠ¨æœåŠ¡å™¨æ¥è¯•è¯•çœ‹å§ï¼š\nå¯ä»¥çœ‹åˆ°é¡µé¢å¯ä»¥æ­£å¸¸å±•ç¤ºäº†ï¼Œæ˜¯ä¸æ˜¯æœ‰Tomcatå“ªå‘³äº†ã€‚\nå…¶ä»–å†…ç½®Handlerä»‹ç» #\rNettyä¹Ÿä¸ºæˆ‘ä»¬å†…ç½®äº†ä¸€äº›å…¶ä»–æ¯”è¾ƒå¥½ç”¨çš„Handlerï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æ‰“å°æ—¥å¿—ï¼š\nchannel.pipeline() .addLast(new HttpRequestDecoder()) .addLast(new HttpObjectAggregator(Integer.MAX_VALUE)) .addLast(new LoggingHandler(LogLevel.INFO)) //æ·»åŠ ä¸€ä¸ªæ—¥å¿—Handlerï¼Œåœ¨è¯·æ±‚åˆ°æ¥æ—¶ä¼šè‡ªåŠ¨æ‰“å°ç›¸å…³æ—¥å¿— ... æ—¥å¿—çº§åˆ«æˆ‘ä»¬é€‰æ‹©INFOï¼Œç°åœ¨æˆ‘ä»¬ç”¨æµè§ˆå™¨è®¿é—®ä¸€ä¸‹ï¼š\nå¯ä»¥çœ‹åˆ°æ¯æ¬¡è¯·æ±‚çš„å†…å®¹å’Œè¯¦ç»†ä¿¡æ¯éƒ½ä¼šåœ¨æ—¥å¿—ä¸­å‡ºç°ï¼ŒåŒ…æ‹¬è¯¦ç»†çš„æ•°æ®åŒ…è§£æè¿‡ç¨‹ï¼Œè¯·æ±‚å¤´ä¿¡æ¯éƒ½æ˜¯å®Œæ•´åœ°æ‰“å°åœ¨æ§åˆ¶å°ä¸Šçš„ã€‚\næˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨Handlerå¯¹IPåœ°å€è¿›è¡Œè¿‡æ»¤ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸å¸Œæœ›æŸäº›IPåœ°å€è¿æ¥æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼š\nchannel.pipeline() .addLast(new HttpRequestDecoder()) .addLast(new HttpObjectAggregator(Integer.MAX_VALUE)) .addLast(new RuleBasedIpFilter(new IpFilterRule() { @Override public boolean matches(InetSocketAddress inetSocketAddress) { return !inetSocketAddress.getHostName().equals(\u0026#34;127.0.0.1\u0026#34;); //è¿›è¡ŒåŒ¹é…ï¼Œè¿”å›falseè¡¨ç¤ºåŒ¹é…å¤±è´¥ //å¦‚æœåŒ¹é…å¤±è´¥ï¼Œé‚£ä¹ˆä¼šæ ¹æ®ä¸‹é¢çš„ç±»å‹å†³å®šè¯¥å¹²ä»€ä¹ˆï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œåˆ¤æ–­æ˜¯ä¸æ˜¯æœ¬åœ°è®¿é—®çš„ï¼Œå¦‚æœæ˜¯é‚£å°±æ‹’ç» } @Override public IpFilterRuleType ruleType() { return IpFilterRuleType.REJECT; //ç±»å‹ï¼ŒREJECTè¡¨ç¤ºæ‹’ç»è¿æ¥ï¼ŒACCEPTè¡¨ç¤ºå…è®¸è¿æ¥ } })) ç°åœ¨æˆ‘ä»¬æµè§ˆå™¨è®¿é—®ä¸€ä¸‹çœ‹çœ‹ï¼š\næˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹é‚£äº›é•¿æœŸå¤„äºç©ºé—²çš„è¿›è¡Œå¤„ç†ï¼š\nchannel.pipeline() .addLast(new StringDecoder()) .addLast(new IdleStateHandler(10, 10, 0)) //IdleStateHandlerèƒ½å¤Ÿä¾¦æµ‹è¿æ¥ç©ºé—²çŠ¶æ€ //ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¿æ¥å¤šå°‘ç§’æ²¡æœ‰è¯»æ“ä½œæ—¶è§¦å‘äº‹ä»¶ï¼Œç¬¬äºŒä¸ªæ˜¯å†™æ“ä½œï¼Œç¬¬ä¸‰ä¸ªæ˜¯è¯»å†™æ“ä½œéƒ½ç®—ï¼Œ0è¡¨ç¤ºç¦ç”¨ //äº‹ä»¶éœ€è¦åœ¨ChannelInboundHandlerAdapterä¸­è¿›è¡Œç›‘å¬å¤„ç† .addLast(new ChannelInboundHandlerAdapter(){ @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { System.out.println(\u0026#34;æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;+msg); ctx.channel().writeAndFlush(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;); } @Override public void userEventTriggered(ChannelHandlerContext ctx, Object evt) throws Exception { //æ²¡æƒ³åˆ°å§ï¼Œè¿™ä¸ªæ–¹æ³•åŸæ¥æ˜¯åœ¨è¿™ä¸ªæ—¶å€™ç”¨çš„ if(evt instanceof IdleStateEvent) { IdleStateEvent event = (IdleStateEvent) evt; if(event.state() == IdleState.WRITER_IDLE) { System.out.println(\u0026#34;å¥½ä¹…éƒ½æ²¡å†™äº†ï¼Œçœ‹è§†é¢‘çš„ä½ çœŸçš„æœ‰è®¤çœŸåœ¨è·Ÿç€æ•²å—\u0026#34;); } else if(event.state() == IdleState.READER_IDLE) { System.out.println(\u0026#34;å·²ç»å¾ˆä¹…å¾ˆä¹…æ²¡æœ‰è¯»äº‹ä»¶å‘ç”Ÿäº†ï¼Œå¥½å¯‚å¯\u0026#34;); } } } }) .addLast(new StringEncoder()); å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬è¶…è¿‡ä¸€æ®µæ—¶é—´ä¸å‘é€æ•°æ®æ—¶ï¼Œå°±ä¼šè¿™æ ·ï¼š\né€šè¿‡è¿™ç§æœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å…³æ‰é‚£äº›å ç€èŒ…å‘ä¸æ‹‰å±çš„è¿æ¥ã€‚\nå¯åŠ¨æµç¨‹æºç è§£è¯» #\rå‰é¢æˆ‘ä»¬å®Œæˆäº†å¯¹NettyåŸºæœ¬åŠŸèƒ½çš„è®²è§£ï¼Œæˆ‘ä»¬æœ€åå°±æ¥çœ‹ä¸€ä¸‹ï¼ŒNettyåˆ°åº•æ˜¯å¦‚ä½•å¯åŠ¨ä»¥åŠè¿›è¡Œæ•°æ®å¤„ç†çš„ã€‚\né¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œæ•´ä¸ªæœåŠ¡ç«¯æ˜¯åœ¨bindä¹‹åå¯åŠ¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»è¿™é‡Œå¼€å§‹ä¸‹æ‰‹ï¼Œä¸å¤šBBç›´æ¥ä¸Šæºç ï¼š\npublic ChannelFuture bind(int inetPort) { return this.bind(new InetSocketAddress(inetPort)); //è½¬æ¢æˆInetSocketAddresså¯¹è±¡ } è¿›æ¥ä¹‹åå‘ç°æ˜¯è°ƒç”¨çš„å…¶ä»–ç»‘å®šæ–¹æ³•ï¼Œç»§ç»­ï¼š\npublic ChannelFuture bind(SocketAddress localAddress) { this.validate(); //å†æ¬¡éªŒè¯ä¸€ä¸‹ï¼Œçœ‹çœ‹EventLoopGroupå’ŒChannelæŒ‡å®šäº†æ²¡ return this.doBind((SocketAddress)ObjectUtil.checkNotNull(localAddress, \u0026#34;localAddress\u0026#34;)); } æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š\nprivate ChannelFuture doBind(final SocketAddress localAddress) { final ChannelFuture regFuture = this.initAndRegister(); //ä¸Šæ¥ç¬¬ä¸€å¥åˆå§‹åŒ–ç„¶åæ³¨å†Œ ... } æˆ‘ä»¬çœ‹çœ‹æ˜¯æ€ä¹ˆæ³¨å†Œçš„ï¼š\nfinal ChannelFuture initAndRegister() { Channel channel = null; try { channel = this.channelFactory.newChannel(); //é€šè¿‡channelFactoryåˆ›å»ºæ–°çš„Channelï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬åœ¨ä¸€å¼€å§‹è®¾å®šçš„NioServerSocketChannel this.init(channel); //æ¥ç€å¯¹åˆ›å»ºå¥½çš„NioServerSocketChannelè¿›è¡Œåˆå§‹åŒ– ... ChannelFuture regFuture = this.config().group().register(channel); //å°†é€šé“æ³¨å†Œåˆ°bossGroupä¸­çš„ä¸€ä¸ªEventLoopä¸­ ... return regFuture; } æˆ‘ä»¬æ¥çœ‹çœ‹æ˜¯å¦‚ä½•å¯¹åˆ›å»ºå¥½çš„ServerSocketChannelè¿›è¡Œåˆå§‹åŒ–çš„ï¼š\nvoid init(Channel channel) { setChannelOptions(channel, this.newOptionsArray(), logger); setAttributes(channel, this.newAttributesArray()); ChannelPipeline p = channel.pipeline(); ... //åœ¨æµæ°´çº¿ä¸Šæ·»åŠ ä¸€ä¸ªHandlerï¼Œåœ¨Handleråˆå§‹åŒ–çš„æ—¶å€™å‘EventLoopä¸­æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œå°†ServerBootstrapAcceptoræ·»åŠ åˆ°æµæ°´çº¿ä¸Š //è¿™æ ·æˆ‘ä»¬çš„ServerSocketChannelåœ¨å®¢æˆ·ç«¯è¿æ¥æ—¶å°±èƒ½Acceptäº† p.addLast(new ChannelHandler[]{new ChannelInitializer\u0026lt;Channel\u0026gt;() { public void initChannel(final Channel ch) { final ChannelPipeline pipeline = ch.pipeline(); ChannelHandler handler = ServerBootstrap.this.config.handler(); if (handler != null) { pipeline.addLast(new ChannelHandler[]{handler}); } ch.eventLoop().execute(new Runnable() { public void run() { //è¿™é‡Œæäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œå°†ServerBootstrapAcceptoræ·»åŠ åˆ°ServerSocketChannelçš„pipelineä¸­ pipeline.addLast(new ChannelHandler[]{new ServerBootstrapAcceptor(ch, currentChildGroup, currentChildHandler, currentChildOptions, currentChildAttrs)}); } }); } }}); } æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼ŒServerBootstrapAcceptoræ€ä¹ˆå¤„ç†çš„ï¼Œç›´æ¥çœ‹åˆ°å®ƒçš„channelReadæ–¹æ³•ï¼š\n//å½“åº•å±‚NIOçš„ServerSocketChannelçš„Selectoræœ‰OP_ACCEPTäº‹ä»¶åˆ°è¾¾æ—¶ï¼ŒNioEventLoopä¼šæ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ï¼Œåˆ›å»ºSocketChannelï¼Œå¹¶è§¦å‘channelReadå›è°ƒ public void channelRead(ChannelHandlerContext ctx, Object msg) { //æ­¤æ—¶msgå°±æ˜¯Acceptè¿æ¥åˆ›å»ºä¹‹åçš„Channelå¯¹è±¡ final Channel child = (Channel)msg; //è¿™é‡Œç›´æ¥å°†æˆ‘ä»¬ä¹‹å‰ç¼–å†™çš„childHandleræ·»åŠ åˆ°æ–°åˆ›å»ºçš„å®¢æˆ·ç«¯è¿æ¥çš„æµæ°´çº¿ä¸­ï¼ˆæ˜¯ä¸æ˜¯æ„Ÿè§‰çªç„¶å°±é€šäº†ï¼‰ child.pipeline().addLast(new ChannelHandler[]{this.childHandler}); AbstractBootstrap.setChannelOptions(child, this.childOptions, ServerBootstrap.logger); AbstractBootstrap.setAttributes(child, this.childAttrs); try { //ç›´æ¥å‘workGroupä¸­çš„ä¸€ä¸ªEventLoopæ³¨å†Œæ–°åˆ›å»ºå¥½çš„å®¢æˆ·ç«¯è¿æ¥Channelï¼Œç­‰å¾…è¯»å†™äº‹ä»¶ this.childGroup.register(child).addListener(new ChannelFutureListener() { //å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œå¦‚æœæ²¡æœ‰æ³¨å†ŒæˆåŠŸï¼Œå°±å¼ºåˆ¶å…³é—­è¿™ä¸ªChannel public void operationComplete(ChannelFuture future) throws Exception { if (!future.isSuccess()) { ServerBootstrap.ServerBootstrapAcceptor.forceClose(child, future.cause()); ... æ‰€ä»¥ï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è®²è§£çš„ä¸»ä»Reactorå¤šçº¿ç¨‹æ¨¡å‹ï¼Œåªè¦å‰é¢ç†è§£äº†ï¼Œè¿™é‡Œå…¶å®å¾ˆå¥½æ¨æ–­ã€‚\nåˆå§‹åŒ–å®Œæˆä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ³¨å†Œï¼Œåœ¨ä¹‹å‰NIOé˜¶æ®µæˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦å°†Channelæ³¨å†Œåˆ°å¯¹åº”çš„Selectoræ‰å¯ä»¥å¼€å§‹é€‰æ‹©ï¼š\npublic ChannelFuture register(Channel channel) { return this.register((ChannelPromise)(new DefaultChannelPromise(channel, this))); //è½¬æ¢æˆChannelPromiseç»§ç»­ } public ChannelFuture register(ChannelPromise promise) { ObjectUtil.checkNotNull(promise, \u0026#34;promise\u0026#34;); promise.channel().unsafe().register(this, promise); //è°ƒç”¨Channelçš„Unsafeæ¥å£å®ç°è¿›è¡Œæ³¨å†Œ return promise; } ç»§ç»­å‘ä¸‹ï¼š\npublic final void register(EventLoop eventLoop, final ChannelPromise promise) { ... AbstractChannel.this.eventLoop = eventLoop; if (eventLoop.inEventLoop()) { this.register0(promise); //è¿™é‡Œæ˜¯ç»§ç»­è°ƒç”¨register0æ–¹æ³•åœ¨è¿›è¡Œæ³¨å†Œ } ... } } ç»§ç»­ï¼š\nprivate void register0(ChannelPromise promise) { try { ... boolean firstRegistration = this.neverRegistered; AbstractChannel.this.doRegister(); //è¿™é‡Œå¼€å§‹æ‰§è¡ŒAbstractNioChannelä¸­çš„doRegisteræ–¹æ³•è¿›è¡Œæ³¨å†Œ AbstractChannel.this.registered = true; AbstractChannel.this.pipeline.invokeHandlerAddedIfNeeded(); this.safeSetSuccess(promise); if (AbstractChannel.this.isActive()) { if (firstRegistration) { AbstractChannel.this.pipeline.fireChannelActive(); //è¿™é‡Œæ˜¯å…³é”® } else if (AbstractChannel.this.config().isAutoRead()) { this.beginRead(); } } ... } æ¥åˆ°æœ€åä¸€çº§ï¼š\nprotected void doRegister() throws Exception { boolean selected = false; while(true) { try { //å¯ä»¥çœ‹åˆ°åœ¨è¿™é‡Œç»ˆäºæ˜¯çœŸæ­£çš„è¿›è¡Œäº†æ³¨å†Œï¼ŒjavaChannel()å¾—åˆ°NIOçš„Channelå¯¹è±¡ï¼Œç„¶åè°ƒç”¨registeræ–¹æ³• //è¿™é‡Œå°±å’Œæˆ‘ä»¬ä¹‹å‰NIOä¸€æ ·äº†ï¼Œå°†Channelæ³¨å†Œåˆ°Selectorä¸­ï¼Œå¯ä»¥çœ‹åˆ°Selectorä¹Ÿæ˜¯EventLoopä¸­çš„ //ä½†æ˜¯æ³¨æ„ï¼Œè¿™é‡Œçš„opså‚æ•°æ˜¯0ï¼Œä¹Ÿå°±æ˜¯ä¸ç›‘å¬ä»»ä½•äº‹ä»¶ this.selectionKey = this.javaChannel().register(this.eventLoop().unwrappedSelector(), 0, this); return; ... } } æˆ‘ä»¬å›åˆ°ä¸Šä¸€çº§ï¼Œåœ¨doRegisterå®Œæˆä¹‹åï¼Œä¼šæ‹¿åˆ°selectionKeyï¼Œä½†æ˜¯æ³¨æ„è¿™æ—¶è¿˜æ²¡æœ‰ç›‘å¬ä»»ä½•äº‹ä»¶ï¼Œæˆ‘ä»¬æ¥ç€çœ‹åˆ°ä¸‹é¢çš„fireChannelActiveæ–¹æ³•ï¼š\npublic final ChannelPipeline fireChannelActive() { AbstractChannelHandlerContext.invokeChannelActive(this.head); //ä¼ çš„æ˜¯æµæ°´çº¿ä¸Šçš„é»˜è®¤å¤´ç»“ç‚¹ return this; } static void invokeChannelActive(final AbstractChannelHandlerContext next) { EventExecutor executor = next.executor(); if (executor.inEventLoop()) { next.invokeChannelActive(); //ç»§ç»­å‘ä¸‹ } else { executor.execute(new Runnable() { public void run() { next.invokeChannelActive(); } }); } } private void invokeChannelActive() { if (this.invokeHandler()) { try { ((ChannelInboundHandler)this.handler()).channelActive(this); //ä¾ç„¶æ˜¯è°ƒç”¨çš„å¤´ç»“ç‚¹çš„channelActiveæ–¹æ³•è¿›è¡Œå¤„ç† } catch (Throwable var2) { this.invokeExceptionCaught(var2); } } else { this.fireChannelActive(); } } public void channelActive(ChannelHandlerContext ctx) { //è¿™é‡Œæ˜¯å¤´ç»“ç‚¹çš„ ctx.fireChannelActive(); this.readIfIsAutoRead(); //ç»§ç»­å‘ä¸‹ } private void readIfIsAutoRead() { if (DefaultChannelPipeline.this.channel.config().isAutoRead()) { DefaultChannelPipeline.this.channel.read(); //ç»§ç»­ä¸æ–­å‘ä¸‹ } } public void read(ChannelHandlerContext ctx) { this.unsafe.beginRead(); //æœ€åè¿™é‡Œä¼šè°ƒç”¨beginReadæ–¹æ³• } public final void beginRead() { this.assertEventLoop(); try { AbstractChannel.this.doBeginRead(); //è¿™é‡Œå°±æ˜¯è°ƒç”¨AbstractNioChannelçš„doBeginReadæ–¹æ³•äº† } catch (final Exception var2) { this.invokeLater(new Runnable() { public void run() { AbstractChannel.this.pipeline.fireExceptionCaught(var2); } }); this.close(this.voidPromise()); } } protected void doBeginRead() throws Exception { SelectionKey selectionKey = this.selectionKey; //å…ˆæ‹¿åˆ°ä¹‹å‰æ³¨å†Œå¥½çš„selectionKey if (selectionKey.isValid()) { this.readPending = true; int interestOps = selectionKey.interestOps(); //æŠŠç›‘å¬çš„æ“ä½œå–å‡ºæ¥ if ((interestOps \u0026amp; this.readInterestOp) == 0) { //å¦‚æœæ²¡æœ‰ç›‘å¬ä»»ä½•æ“ä½œ selectionKey.interestOps(interestOps | this.readInterestOp); //é‚£å°±æŠŠreadInterestOpäº‹ä»¶è¿›è¡Œç›‘å¬ï¼Œè¿™é‡Œçš„readInterestOpå®é™…ä¸Šå°±æ˜¯OP_ACCEPT } } } è¿™æ ·ï¼ŒChannelåœ¨åˆå§‹åŒ–å®Œæˆä¹‹åä¹Ÿå®Œæˆäº†åº•å±‚çš„æ³¨å†Œï¼Œå·²ç»å¯ä»¥å¼€å§‹ç­‰å¾…äº‹ä»¶äº†ã€‚\næˆ‘ä»¬ç°åœ¨å›åˆ°ä¹‹å‰çš„doBindæ–¹æ³•çš„æ³¨å†Œä½ç½®ï¼Œç°åœ¨æ³¨å†Œå®Œæˆä¹‹åï¼ŒåŸºæœ¬ä¸Šæ•´ä¸ªä¸»ä»Reactorç»“æ„å°±å·²ç»å‡ºæ¥äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿˜è¦åšäº›ä»€ä¹ˆï¼š\nprivate ChannelFuture doBind(final SocketAddress localAddress) { final ChannelFuture regFuture = this.initAndRegister(); //ç›®å‰åˆå§‹åŒ–å’Œæ³¨å†Œéƒ½å·²ç»æˆåŠŸäº† final Channel channel = regFuture.channel(); //ç”±äºæ˜¯å¼‚æ­¥æ“ä½œï¼Œæˆ‘ä»¬é€šè¿‡ChannelFutureæ‹¿åˆ°å¯¹åº”çš„ServerSocketChannelå¯¹è±¡ if (regFuture.cause() != null) { return regFuture; } else if (regFuture.isDone()) { //å¦‚æœè¯´åˆå§‹åŒ–å·²ç»å®Œæˆäº† ChannelPromise promise = channel.newPromise(); doBind0(regFuture, channel, localAddress, promise); //ç›´æ¥å¼€å§‹è¿›è¡Œè¿›ä¸€æ­¥çš„ç»‘å®š return promise; } else { //å¦‚æœè¿˜æ²¡æå®Œï¼Œé‚£å°±åˆ›Promisç»§ç»­ç­‰å¾…ä»»åŠ¡å®Œæˆ final PendingRegistrationPromise promise = new PendingRegistrationPromise(channel); regFuture.addListener(new ChannelFutureListener() { public void operationComplete(ChannelFuture future) throws Exception { Throwable cause = future.cause(); if (cause != null) { promise.setFailure(cause); } else { promise.registered(); AbstractBootstrap.doBind0(regFuture, channel, localAddress, promise); } } }); return promise; } } å¯ä»¥çœ‹åˆ°æœ€åéƒ½ä¼šèµ°åˆ°doBind0æ–¹æ³•ï¼š\nprivate static void doBind0(final ChannelFuture regFuture, final Channel channel, final SocketAddress localAddress, final ChannelPromise promise) { //æœ€åä¼šå‘Channelå·²ç»æ³¨å†Œåˆ°çš„EventLoopä¸­æäº¤ä¸€ä¸ªæ–°çš„ä»»åŠ¡ channel.eventLoop().execute(new Runnable() { public void run() { if (regFuture.isSuccess()) { //è¿™é‡Œæ‰æ˜¯çœŸæ­£è°ƒç”¨Channelåº•å±‚è¿›è¡Œç»‘å®šæ“ä½œ channel.bind(localAddress, promise).addListener(ChannelFutureListener.CLOSE_ON_FAILURE); } else { promise.setFailure(regFuture.cause()); } } }); } è‡³æ­¤ï¼ŒæœåŠ¡ç«¯çš„å¯åŠ¨æµç¨‹ç»“æŸã€‚æˆ‘ä»¬å‰é¢è¿˜æåˆ°äº†NIOçš„ç©ºè½®è¯¢é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬æ¥çœ‹çœ‹Nettyæ˜¯å¦‚ä½•è§£å†³çš„ï¼Œæˆ‘ä»¬ç›´æ¥å®šä½åˆ°NioEventLoopä¸­ï¼š\n//ç”±äºä»£ç å¤ªå¤šï¼Œè¿™é‡Œçœç•¥å¤§éƒ¨åˆ†ä»£ç  while(true) { boolean var34; try { ... try { if (!this.hasTasks()) { strategy = this.select(curDeadlineNanos); //é¦–å…ˆä¼šåœ¨è¿™é‡Œè¿›è¡ŒSelector.select()æ“ä½œï¼Œè·ŸNIOæ˜¯ä¸€æ ·çš„ } ... ++selectCnt; //æ¯æ¬¡å”¤é†’éƒ½ä¼šè®©selectCntè‡ªå¢ this.cancelledKeys = 0; ... if (!ranTasks \u0026amp;\u0026amp; strategy \u0026lt;= 0) { if (this.unexpectedSelectorWakeup(selectCnt)) { //è¿™é‡Œä¼šè¿›è¡Œåˆ¤æ–­æ˜¯å¦å‡ºç°ç©ºè½®è¯¢BUG ... æˆ‘ä»¬æ¥çœ‹çœ‹æ˜¯æ€ä¹ˆè¿›è¡Œåˆ¤æ–­çš„ï¼š\nprivate boolean unexpectedSelectorWakeup(int selectCnt) { if (Thread.interrupted()) { if (logger.isDebugEnabled()) { logger.debug(\u0026#34;Selector.select() returned prematurely because Thread.currentThread().interrupt() was called. Use NioEventLoop.shutdownGracefully() to shutdown the NioEventLoop.\u0026#34;); } return true; //å¦‚æœselectCntå¤§äºç­‰äºSELECTOR_AUTO_REBUILD_THRESHOLDï¼ˆé»˜è®¤ä¸º512ï¼‰é‚£ä¹ˆä¼šç›´æ¥é‡å»ºSelector } else if (SELECTOR_AUTO_REBUILD_THRESHOLD \u0026gt; 0 \u0026amp;\u0026amp; selectCnt \u0026gt;= SELECTOR_AUTO_REBUILD_THRESHOLD) { logger.warn(\u0026#34;Selector.select() returned prematurely {} times in a row; rebuilding Selector {}.\u0026#34;, selectCnt, this.selector); this.rebuildSelector(); //å½“å‰çš„Selectorå‡ºç°BUGäº†ï¼Œå¾—é‡å»ºä¸€ä¸ªSelector return true; } else { return false; } } å®é™…ä¸Šï¼Œå½“æ¯æ¬¡ç©ºè½®è¯¢å‘ç”Ÿæ—¶ä¼šæœ‰ä¸“é—¨çš„è®¡æ•°å™¨+1ï¼Œå¦‚æœç©ºè½®è¯¢çš„æ¬¡æ•°è¶…è¿‡äº†512æ¬¡ï¼Œå°±è®¤ä¸ºå…¶è§¦å‘äº†ç©ºè½®è¯¢bugï¼Œè§¦å‘bugåï¼ŒNettyç›´æ¥é‡å»ºä¸€ä¸ªSelectorï¼Œå°†åŸæ¥çš„Channelé‡æ–°æ³¨å†Œåˆ°æ–°çš„ Selectorä¸Šï¼Œå°†æ—§çš„ Selectorå…³æ‰ï¼Œè¿™æ ·å°±é˜²æ­¢äº†æ— é™å¾ªç¯ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/netty/netty/","section":"Docs","summary":"Nettyæ¡†æ¶ #\rå‰é¢æˆ‘ä»¬å­¦ä¹ äº†Javaä¸ºæˆ‘ä»¬æä¾›çš„NIOæ¡†æ¶ï¼Œæä¾›ä½¿ç”¨NIOæä¾›çš„ä¸‰å¤§ç»„ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™æ›´åŠ é«˜æ€§èƒ½çš„å®¢æˆ·ç«¯/æœåŠ¡ç«¯ç½‘ç»œç¨‹åºäº†ï¼Œç”šè‡³è¿˜å¯ä»¥è‡ªè¡Œè§„å®šä¸€ç§é€šä¿¡åè®®è¿›è¡Œé€šä¿¡ã€‚\nNIOæ¡†æ¶å­˜åœ¨çš„é—®é¢˜ #\rä½†æ˜¯ä¹‹å‰æˆ‘ä»¬åœ¨ä½¿ç”¨NIOæ¡†æ¶çš„æ—¶å€™ï¼Œè¿˜æ˜¯å‘ç°äº†ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ¥ç›˜ç‚¹ä¸€ä¸‹ã€‚\nå®¢æˆ·ç«¯å…³é—­å¯¼è‡´æœåŠ¡ç«¯ç©ºè½®è¯¢ #\rå¯èƒ½åœ¨ä¹‹å‰çš„å®éªŒä¸­ï¼Œä½ å‘ç°äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š\nå½“æˆ‘ä»¬çš„å®¢æˆ·ç«¯ä¸»åŠ¨ä¸æœåŠ¡ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œä¼šå¯¼è‡´READäº‹ä»¶ä¸€ç›´è¢«è§¦å‘ï¼Œä¹Ÿå°±æ˜¯è¯´selector.select()ä¼šç›´æ¥é€šè¿‡ï¼Œå¹¶ä¸”æ˜¯å¯è¯»çš„çŠ¶æ€ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å®é™…ä¸Šè¯»åˆ°æ˜¯æ•°æ®æ˜¯ä¸€ä¸ªç©ºçš„ï¼ˆä¸Šé¢çš„å›¾ä¸­åœ¨ç©ºè½®è¯¢ä¸¤æ¬¡åæŠ›å‡ºå¼‚å¸¸äº†ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ— é™çš„å¾ªç¯ä¸‹å»ï¼‰æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¾—ç¨å¾®å¤„ç†ä¸€ä¸‹ï¼š\n} else if(key.isReadable()) { SocketChannel channel = (SocketChannel) key.channel(); ByteBuffer buffer = ByteBuffer.allocate(128); //è¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸‹ï¼Œå¦‚æœreadæ“ä½œå¾—åˆ°çš„ç»“æœæ˜¯-1ï¼Œé‚£ä¹ˆè¯´æ˜æœåŠ¡ç«¯å·²ç»æ–­å¼€è¿æ¥äº† if(channel.read(buffer) \u0026lt; 0) { System.out.println(\u0026#34;å®¢æˆ·ç«¯å·²ç»æ–­å¼€è¿æ¥äº†ï¼š\u0026#34;+channel.getRemoteAddress()); channel.","title":"Netty","type":"doc"},{"content":"\rNIOåŸºç¡€ #\r**æ³¨æ„ï¼š**æ¨èå®ŒæˆJavaSEç¯‡ã€JavaWebç¯‡çš„å­¦ä¹ å†å¼€å¯è¿™ä¸€éƒ¨åˆ†çš„å­¦ä¹ ï¼Œå¦‚æœåœ¨è¿™ä¹‹å‰å®Œæˆäº†JVMç¯‡ï¼Œé‚£ä¹ˆçœ‹èµ·æ¥å°±ä¼šæ¯”è¾ƒè½»æ¾äº†ã€‚\nåœ¨JavaSEçš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†å¦‚ä½•ä½¿ç”¨IOè¿›è¡Œæ•°æ®ä¼ è¾“ï¼ŒJava IOæ˜¯é˜»å¡çš„ï¼Œå¦‚æœåœ¨ä¸€æ¬¡è¯»å†™æ•°æ®è°ƒç”¨æ—¶æ•°æ®è¿˜æ²¡æœ‰å‡†å¤‡å¥½ï¼Œæˆ–è€…ç›®å‰ä¸å¯å†™ï¼Œé‚£ä¹ˆè¯»å†™æ“ä½œå°±ä¼šè¢«é˜»å¡ç›´åˆ°æ•°æ®å‡†å¤‡å¥½æˆ–ç›®æ ‡å¯å†™ä¸ºæ­¢ã€‚Java NIOåˆ™æ˜¯éé˜»å¡çš„ï¼Œæ¯ä¸€æ¬¡æ•°æ®è¯»å†™è°ƒç”¨éƒ½ä¼šç«‹å³è¿”å›ï¼Œå¹¶å°†ç›®å‰å¯è¯»ï¼ˆæˆ–å¯å†™ï¼‰çš„å†…å®¹å†™å…¥ç¼“å†²åŒºæˆ–è€…ä»ç¼“å†²åŒºä¸­è¾“å‡ºï¼Œå³ä½¿å½“å‰æ²¡æœ‰å¯ç”¨æ•°æ®ï¼Œè°ƒç”¨ä»ç„¶ä¼šç«‹å³è¿”å›å¹¶ä¸”ä¸å¯¹ç¼“å†²åŒºåšä»»ä½•æ“ä½œã€‚\nNIOæ¡†æ¶æ˜¯åœ¨JDK1.4æ¨å‡ºçš„ï¼Œå®ƒçš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³ä¼ ç»ŸIOçš„ä¸è¶³ï¼Œè¿™ä¸€æœŸè§†é¢‘ï¼Œæˆ‘ä»¬å°±å°†å›´ç»•ç€NIOå¼€å§‹è®²è§£ã€‚\nç¼“å†²åŒº #\rä¸€åˆ‡çš„ä¸€åˆ‡è¿˜è¦ä»ç¼“å†²åŒºå¼€å§‹è®²èµ·ï¼ŒåŒ…æ‹¬æºç åœ¨å†…ï¼Œå…¶å®è¿™ä¸ªä¸æ˜¯å¾ˆéš¾ï¼Œåªæ˜¯éœ€è¦ç†æ¸…æ€è·¯ã€‚\nBufferç±»åŠå…¶å®ç° #\rBufferç±»æ˜¯ç¼“å†²åŒºçš„å®ç°ï¼Œç±»ä¼¼äºJavaä¸­çš„æ•°ç»„ï¼Œä¹Ÿæ˜¯ç”¨äºå­˜æ”¾å’Œè·å–æ•°æ®çš„ã€‚ä½†æ˜¯Bufferç›¸æ¯”Javaä¸­çš„æ•°ç»„ï¼ŒåŠŸèƒ½å°±éå¸¸å¼ºå¤§äº†ï¼Œå®ƒåŒ…å«ä¸€ç³»åˆ—å¯¹äºæ•°ç»„çš„å¿«æ·æ“ä½œã€‚\nBufferæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„æ ¸å¿ƒå†…å®¹ï¼š\npublic abstract class Buffer { // è¿™å››ä¸ªå˜é‡çš„å…³ç³»: mark \u0026lt;= position \u0026lt;= limit \u0026lt;= capacity // è¿™äº›å˜é‡å°±æ˜¯Bufferæ“ä½œçš„æ ¸å¿ƒäº†ï¼Œä¹‹åæˆ‘ä»¬å­¦ä¹ çš„è¿‡ç¨‹ä¸­å¯ä»¥çœ‹æºç æ˜¯å¦‚ä½•æ“ä½œè¿™äº›å˜é‡çš„ private int mark = -1; private int position = 0; private int limit; private int capacity; // ç›´æ¥ç¼“å†²åŒºå®ç°å­ç±»çš„æ•°æ®å†…å­˜åœ°å€ï¼ˆä¹‹åä¼šè®²è§£ï¼‰ long address; æˆ‘ä»¬æ¥çœ‹çœ‹Bufferç±»çš„å­ç±»ï¼ŒåŒ…æ‹¬æˆ‘ä»¬è®¤è¯†åˆ°çš„æ‰€æœ‰åŸºæœ¬ç±»å‹ï¼ˆé™¤äº† booleanç±»å‹ä¹‹å¤–ï¼‰ï¼š\nIntBuffer - intç±»å‹çš„ç¼“å†²åŒºã€‚ ShortBuffer - shortç±»å‹çš„ç¼“å†²åŒºã€‚ LongBuffer - longç±»å‹çš„ç¼“å†²åŒºã€‚ FloatBuffer - floatç±»å‹çš„ç¼“å†²åŒºã€‚ DoubleBuffer - doubleç±»å‹çš„ç¼“å†²åŒºã€‚ ByteBuffer - byteç±»å‹çš„ç¼“å†²åŒºã€‚ CharBuffer - charç±»å‹çš„ç¼“å†²åŒºã€‚ ï¼ˆæ³¨æ„æˆ‘ä»¬ä¹‹å‰åœ¨JavaSEä¸­å­¦ä¹ è¿‡çš„StringBufferè™½ç„¶ä¹Ÿæ˜¯è¿™ç§å‘½åæ–¹å¼ï¼Œä½†æ˜¯ä¸å±äºBufferä½“ç³»ï¼Œè¿™é‡Œä¸ä¼šè¿›è¡Œä»‹ç»ï¼‰\nè¿™é‡Œæˆ‘ä»¬ä»¥IntBufferä¸ºä¾‹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªBufferç±»ï¼š\npublic static void main(String[] args) { //åˆ›å»ºä¸€ä¸ªç¼“å†²åŒºä¸èƒ½ç›´æ¥newï¼Œè€Œæ˜¯éœ€è¦ä½¿ç”¨é™æ€æ–¹æ³•å»ç”Ÿæˆï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š //1. ç”³è¯·ä¸€ä¸ªå®¹é‡ä¸º10çš„intç¼“å†²åŒº IntBuffer buffer = IntBuffer.allocate(10); //2. å¯ä»¥å°†ç°æœ‰çš„æ•°ç»„ç›´æ¥è½¬æ¢ä¸ºç¼“å†²åŒºï¼ˆåŒ…æ‹¬æ•°ç»„ä¸­çš„æ•°æ®ï¼‰ int[] arr = new int[]{1, 2, 3, 4, 5, 6}; IntBuffer buffer = IntBuffer.wrap(arr); } é‚£ä¹ˆå®ƒçš„å†…éƒ¨æ˜¯æœ¬è´¨ä¸Šå¦‚ä½•è¿›è¡Œæ“ä½œçš„å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„æºç ï¼š\npublic static IntBuffer allocate(int capacity) { if (capacity \u0026lt; 0) //å¦‚æœç”³è¯·çš„å®¹é‡å°äº0ï¼Œé‚£è¿˜æœ‰å•¥æ„æ€ throw new IllegalArgumentException(); return new HeapIntBuffer(capacity, capacity); //å¯ä»¥çœ‹åˆ°è¿™é‡Œä¼šç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„IntBufferå®ç°ç±» //HeapIntBufferæ˜¯åœ¨å †å†…å­˜ä¸­å­˜æ”¾æ•°æ®ï¼Œæœ¬è´¨ä¸Šå°±æ•°ç»„ï¼Œä¸€ä¼šæˆ‘ä»¬å¯ä»¥åœ¨æ·±å…¥çœ‹ä¸€ä¸‹ } public static IntBuffer wrap(int[] array, int offset, int length) { try { //å¯ä»¥çœ‹åˆ°è¿™ä¸ªä¹Ÿæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„HeapIntBufferå¯¹è±¡ï¼Œå¹¶ä¸”ç»™äº†åˆå§‹æ•°ç»„ä»¥åŠæˆªå–çš„èµ·å§‹ä½ç½®å’Œé•¿åº¦ return new HeapIntBuffer(array, offset, length); } catch (IllegalArgumentException x) { throw new IndexOutOfBoundsException(); } } public static IntBuffer wrap(int[] array) { return wrap(array, 0, array.length); //è°ƒç”¨çš„æ˜¯ä¸Šé¢çš„wrapæ–¹æ³• } é‚£ä¹ˆè¿™ä¸ªHeapIntBufferåˆæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹ï¼š\nHeapIntBuffer(int[] buf, int off, int len) { // æ³¨æ„è¿™ä¸ªæ„é€ æ–¹æ³•ä¸æ˜¯publicï¼Œæ˜¯é»˜è®¤çš„è®¿é—®æƒé™ super(-1, off, off + len, buf.length, buf, 0); //ä½ ä¼šå‘ç°è¿™æ€ä¹ˆåˆå»è°ƒçˆ¶ç±»çš„æ„é€ æ–¹æ³•äº†ï¼Œç»•æ¥ç»•å» //markæ˜¯æ ‡è®°ï¼Œoffæ˜¯å½“å‰èµ·å§‹ä¸‹æ ‡ä½ç½®ï¼Œoff+lenæ˜¯æœ€å¤§ä¸‹æ ‡ä½ç½®ï¼Œbuf.lengthæ˜¯åº•å±‚ç»´æŠ¤çš„æ•°ç»„çœŸæ­£é•¿åº¦ï¼Œbufå°±æ˜¯æ•°ç»„ï¼Œæœ€åä¸€ä¸ª0æ˜¯èµ·å§‹åç§»ä½ç½® } æˆ‘ä»¬åˆæ¥çœ‹çœ‹IntBufferä¸­çš„æ„é€ æ–¹æ³•æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼š\nfinal int[] hb; // åªæœ‰åœ¨å †ç¼“å†²åŒºå®ç°æ—¶æ‰ä¼šä½¿ç”¨ final int offset; boolean isReadOnly; // åªæœ‰åœ¨å †ç¼“å†²åŒºå®ç°æ—¶æ‰ä¼šä½¿ç”¨ IntBuffer(int mark, int pos, int lim, int cap, // æ³¨æ„è¿™ä¸ªæ„é€ æ–¹æ³•ä¸æ˜¯publicï¼Œæ˜¯é»˜è®¤çš„è®¿é—®æƒé™ int[] hb, int offset) { super(mark, pos, lim, cap); //è°ƒç”¨Bufferç±»çš„æ„é€ æ–¹æ³• this.hb = hb; //hbå°±æ˜¯çœŸæ­£æˆ‘ä»¬è¦å­˜æ”¾æ•°æ®çš„æ•°ç»„ï¼Œå †ç¼“å†²åŒºåº•å±‚å…¶å®å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªæ•°ç»„ this.offset = offset; //èµ·å§‹åç§»ä½ç½® } æœ€åæˆ‘ä»¬æ¥çœ‹çœ‹Bufferä¸­çš„æ„é€ æ–¹æ³•ï¼š\nBuffer(int mark, int pos, int lim, int cap) { // æ³¨æ„è¿™ä¸ªæ„é€ æ–¹æ³•ä¸æ˜¯publicï¼Œæ˜¯é»˜è®¤çš„è®¿é—®æƒé™ if (cap \u0026lt; 0) //å®¹é‡ä¸èƒ½å°äº0ï¼Œå°äº0è¿˜ç©ä¸ªé”¤å­ throw new IllegalArgumentException(\u0026#34;Negative capacity: \u0026#34; + cap); this.capacity = cap; //è®¾å®šç¼“å†²åŒºå®¹é‡ limit(lim); //è®¾å®šæœ€å¤§positionä½ç½® position(pos); //è®¾å®šèµ·å§‹ä½ç½® if (mark \u0026gt;= 0) { //å¦‚æœèµ·å§‹æ ‡è®°å¤§äºç­‰äº0 if (mark \u0026gt; pos) //å¹¶ä¸”æ ‡è®°ä½ç½®å¤§äºèµ·å§‹ä½ç½®ï¼Œé‚£ä¹ˆå°±æŠ›å¼‚å¸¸ï¼ˆè‡³äºä¸ºå•¥ä¸èƒ½å¤§äºæˆ‘ä»¬åé¢å†è¯´ï¼‰ throw new IllegalArgumentException(\u0026#34;mark \u0026gt; position: (\u0026#34; + mark + \u0026#34; \u0026gt; \u0026#34; + pos + \u0026#34;)\u0026#34;); this.mark = mark; //å¦åˆ™è®¾å®šmarkä½ç½®ï¼ˆmarké»˜è®¤ä¸º-1ï¼‰ } } é€šè¿‡å¯¹æºç çš„è§‚å¯Ÿï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“æ„äº†ï¼š\nç°åœ¨æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ä¸Šé¢è¿™äº›ç»“æ„çš„å„è‡ªèŒè´£åˆ’åˆ†ï¼š\nBufferï¼šç¼“å†²åŒºçš„ä¸€äº›åŸºæœ¬å˜é‡å®šä¹‰ï¼Œæ¯”å¦‚å½“å‰çš„ä½ç½®ï¼ˆpositionï¼‰ã€å®¹é‡ (capacity)ã€æœ€å¤§é™åˆ¶ (limit)ã€æ ‡è®° (mark)ç­‰ï¼Œä½ è‚¯å®šä¼šç–‘æƒ‘è¿™äº›å˜é‡æœ‰å•¥ç”¨ï¼Œåˆ«ç€æ€¥ï¼Œè¿™äº›å˜é‡ä¼šåœ¨åé¢çš„æ“ä½œä¸­ç”¨åˆ°ï¼Œæˆ‘ä»¬é€æ­¥è®²è§£ã€‚ IntBufferç­‰å­ç±»ï¼šå®šä¹‰äº†å­˜æ”¾æ•°æ®çš„æ•°ç»„ï¼ˆåªæœ‰å †ç¼“å†²åŒºå®ç°å­ç±»æ‰ä¼šç”¨åˆ°ï¼‰ã€æ˜¯å¦åªè¯»ç­‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®çš„å­˜æ”¾ä½ç½®ã€ä»¥åŠå¯¹äºåº•å±‚æ•°ç»„çš„ç›¸å…³æ“ä½œéƒ½åœ¨è¿™é‡Œå·²ç»å®šä¹‰å¥½äº†ï¼Œå¹¶ä¸”å·²ç»å®ç°äº†Comparableæ¥å£ã€‚ HeapIntBufferå †ç¼“å†²åŒºå®ç°å­ç±»ï¼šæ•°æ®å­˜æ”¾åœ¨å †ä¸­ï¼Œå®é™…ä¸Šå°±æ˜¯ç”¨çš„çˆ¶ç±»çš„æ•°ç»„åœ¨ä¿å­˜æ•°æ®ï¼Œå¹¶ä¸”å°†çˆ¶ç±»å®šä¹‰çš„æ‰€æœ‰åº•å±‚æ“ä½œå…¨éƒ¨å®ç°äº†ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å¯¹äºBufferç±»çš„åŸºæœ¬ç»“æ„å°±æœ‰äº†ä¸€ä¸ªå¤§è‡´çš„è®¤è¯†ã€‚\nç¼“å†²åŒºå†™æ“ä½œ #\rå‰é¢æˆ‘ä»¬äº†è§£äº†Bufferç±»çš„åŸºæœ¬æ“ä½œï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•å‘ç¼“å†²åŒºä¸­å­˜æ”¾æ•°æ®ä»¥åŠè·å–æ•°æ®ï¼Œæ•°æ®çš„å­˜æ”¾åŒ…æ‹¬ä»¥ä¸‹å››ä¸ªæ–¹æ³•ï¼š\npublic abstract IntBuffer put(int i); - åœ¨å½“å‰positionä½ç½®æ’å…¥æ•°æ®ï¼Œç”±å…·ä½“å­ç±»å®ç° public abstract IntBuffer put(int index, int i); - åœ¨æŒ‡å®šä½ç½®å­˜æ”¾æ•°æ®ï¼Œä¹Ÿæ˜¯ç”±å…·ä½“å­ç±»å®ç° public final IntBuffer put(int[] src); - ç›´æ¥å­˜æ”¾æ‰€æœ‰æ•°ç»„ä¸­çš„å†…å®¹ï¼ˆæ•°ç»„é•¿åº¦ä¸èƒ½è¶…å‡ºç¼“å†²åŒºå¤§å°ï¼‰ public IntBuffer put(int[] src, int offset, int length); - ç›´æ¥å­˜æ”¾æ•°ç»„ä¸­çš„å†…å®¹ï¼ŒåŒä¸Šï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šå­˜æ”¾ä¸€æ®µèŒƒå›´ public IntBuffer put(IntBuffer src); - ç›´æ¥å­˜æ”¾å¦ä¸€ä¸ªç¼“å†²åŒºä¸­çš„å†…å®¹ æˆ‘ä»¬ä»æœ€ç®€çš„å¼€å§‹çœ‹ï¼Œæ˜¯åœ¨å½“å‰ä½ç½®æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªå½“å‰ä½ç½®æ˜¯æ€ä¹ˆå®šä¹‰çš„å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æºç ï¼š\npublic IntBuffer put(int x) { hb[ix(nextPutIndex())] = x; //è¿™ä¸ªixå’ŒnextPutIndex()å¾ˆçµæ€§ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“å®ç° return this; } protected int ix(int i) { return i + offset; //å°†içš„å€¼åŠ ä¸Šæˆ‘ä»¬ä¹‹å‰è®¾å®šçš„offsetåç§»é‡å€¼ï¼Œä½†æ˜¯é»˜è®¤æ˜¯0ï¼ˆé0çš„æƒ…å†µåé¢ä¼šä»‹ç»ï¼‰ } final int nextPutIndex() { int p = position; //è·å–Bufferç±»ä¸­çš„positionä½ç½®ï¼ˆä¸€å¼€å§‹ä¹Ÿæ˜¯0ï¼‰ if (p \u0026gt;= limit) //ä½ç½®è‚¯å®šä¸èƒ½è¶…è¿‡åº•å±‚æ•°ç»„æœ€å¤§é•¿åº¦ï¼Œå¦åˆ™è¶Šç•Œ throw new BufferOverflowException(); position = p + 1; //è·å–ä¹‹åä¼šä½¿å¾—Bufferç±»ä¸­çš„position+1 return p; //è¿”å›å½“å‰çš„ä½ç½® } æ‰€ä»¥putæ“ä½œå®é™…ä¸Šæ˜¯å°†åº•å±‚æ•°ç»„ hbåœ¨positionä½ç½®ä¸Šçš„æ•°æ®è¿›è¡Œè®¾å®šã€‚\nè®¾å®šå®Œæˆåï¼Œpositionè‡ªåŠ¨åç§»ï¼š\næˆ‘ä»¬å¯ä»¥ç¼–å†™ä»£ç æ¥çœ‹çœ‹ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.allocate(10); buffer .put(1) .put(2) .put(3); //æˆ‘ä»¬ä¾æ¬¡å­˜æ”¾ä¸‰ä¸ªæ•°æ®è¯•è¯•çœ‹ System.out.println(buffer); } é€šè¿‡æ–­ç‚¹è°ƒè¯•ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®é™…çš„æ“ä½œæƒ…å†µï¼š\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸æ–­åœ°putæ“ä½œï¼Œpositionä¼šä¸€ç›´å‘åç§»åŠ¨ï¼Œå½“ç„¶å¦‚æœè¶…å‡ºæœ€å¤§é•¿åº¦ï¼Œé‚£ä¹ˆä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼š\næ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒä¸ªputæ“ä½œæ˜¯å¦‚ä½•è¿›è¡Œï¼Œå®ƒèƒ½å¤Ÿåœ¨æŒ‡å®šä½ç½®æ’å…¥æ•°æ®ï¼š\npublic IntBuffer put(int i, int x) { hb[ix(checkIndex(i))] = x; //è¿™é‡Œä¾ç„¶ä¼šä½¿ç”¨ixï¼Œä½†æ˜¯ä¼šæ£€æŸ¥ä½ç½®æ˜¯å¦åˆæ³• return this; } final int checkIndex(int i) { // package-private if ((i \u0026lt; 0) || (i \u0026gt;= limit)) //æ’å…¥çš„ä½ç½®ä¸èƒ½å°äº0å¹¶ä¸”ä¸èƒ½å¤§äºç­‰äºåº•å±‚æ•°ç»„æœ€å¤§é•¿åº¦ throw new IndexOutOfBoundsException(); return i; //æ²¡æœ‰é—®é¢˜å°±æŠŠiè¿”å› } å®é™…ä¸Šè¿™ä¸ªæ¯”æˆ‘ä»¬ä¹‹å‰çš„è¦å¥½ç†è§£ä¸€äº›ï¼Œæ³¨æ„å…¨ç¨‹ä¸ä¼šæ“ä½œpositionçš„å€¼ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹ç¬¬ä¸‰ä¸ªputæ“ä½œï¼Œå®ƒæ˜¯ç›´æ¥åœ¨IntBufferä¸­å®ç°çš„ï¼Œæ˜¯åŸºäºå‰ä¸¤ä¸ªputæ–¹æ³•çš„å­ç±»å®ç°æ¥å®Œæˆçš„ï¼š\npublic IntBuffer put(int[] src, int offset, int length) { checkBounds(offset, length, src.length); //æ£€æŸ¥æˆªå–èŒƒå›´æ˜¯å¦åˆæ³•ï¼Œç»™offsetã€è°ƒç”¨è€…æŒ‡å®šé•¿åº¦ã€æ•°ç»„å®é™…é•¿åº¦ if (length \u0026gt; remaining()) //æ¥ç€åˆ¤æ–­è¦æ’å…¥çš„æ•°æ®é‡åœ¨ç¼“å†²åŒºæ˜¯å¦å®¹å¾—ä¸‹ï¼Œè£…ä¸ä¸‹ä¹Ÿä¸è¡Œ throw new BufferOverflowException(); int end = offset + length; //è®¡ç®—å‡ºæœ€ç»ˆè¯»å–ä½ç½®ï¼Œä¸‹é¢å¼€å§‹for for (int i = offset; i \u0026lt; end; i++) this.put(src[i]); //æ³¨æ„æ˜¯ç›´æ¥ä»postionä½ç½®å¼€å§‹æ’å…¥ï¼Œç›´åˆ°æŒ‡å®šèŒƒå›´ç»“æŸ return this; //ojbk } public final IntBuffer put(int[] src) { return put(src, 0, src.length); //å› ä¸ºä¸éœ€è¦æŒ‡å®šèŒƒå›´ï¼Œæ‰€ä»¥ç›´æ¥0å’Œlengthï¼Œç„¶åè°ƒä¸Šé¢çš„ï¼Œå¤šæå“¦ } public final int remaining() { //è®¡ç®—å¹¶è·å–å½“å‰ç¼“å†²åŒºçš„å‰©ä½™ç©ºé—´ int rem = limit - position; //æœ€å¤§å®¹é‡å‡å»å½“å‰ä½ç½®ï¼Œå°±æ˜¯å‰©ä½™ç©ºé—´ return rem \u0026gt; 0 ? rem : 0; //æ²¡å®¹é‡å°±è¿”å›0 } static void checkBounds(int off, int len, int size) { // package-private if ((off | len | (off + len) | (size - (off + len))) \u0026lt; 0) //è®©æˆ‘çŒœçŒœï¼Œçœ‹ä¸æ‡‚äº†æ˜¯å§ throw new IndexOutOfBoundsException(); //å®é™…ä¸Šå°±æ˜¯çœ‹ç»™å®šçš„æ•°ç»„èƒ½ä¸èƒ½æˆªå–å‡ºæŒ‡å®šçš„è¿™æ®µæ•°æ®ï¼Œå¦‚æœéƒ½ä¸å¤Ÿäº†é‚£è‚¯å®šä¸è¡Œå•Š } å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼Œé¦–å…ˆæ¥äº†ä¸€ä¸ªæ•°ç»„è¦å–ä¸€æ®µæ•°æ®å…¨éƒ¨ä¸¢è¿›ç¼“å†²åŒºï¼š\nåœ¨æ£€æŸ¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜å¹¶ä¸”ç¼“å†²åŒºæœ‰å®¹é‡æ—¶ï¼Œå°±å¯ä»¥å¼€å§‹æ’å…¥äº†ï¼š\næœ€åæˆ‘ä»¬é€šè¿‡ä»£ç æ¥çœ‹çœ‹ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.allocate(10); int[] arr = new int[]{1,2,3,4,5,6,7,8,9}; buffer.put(arr, 3, 4); //ä»ä¸‹æ ‡3å¼€å§‹ï¼Œæˆªå–4ä¸ªå…ƒç´  System.out.println(Arrays.toString(buffer.array())); //arrayæ–¹æ³•å¯ä»¥ç›´æ¥è·å–åˆ°æ•°ç»„ } å¯ä»¥çœ‹åˆ°æœ€åç»“æœä¸ºï¼š\nå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€ä¸ªç¼“å†²åŒºçš„å†…å®¹ä¿å­˜åˆ°å¦ä¸€ä¸ªç¼“å†²åŒºï¼š\npublic IntBuffer put(IntBuffer src) { if (src == this) //ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šæœ‰äººä¿å­˜è‡ªå·±å§ throw new IllegalArgumentException(); if (isReadOnly()) //å¦‚æœæ˜¯åªè¯»çš„è¯ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯ä¸å…è®¸æ’å…¥æ“ä½œçš„ï¼ˆæˆ‘çŒœä½ ä»¬è‚¯å®šä¼šé—®ä¸ºå•¥å°±è¿™é‡Œä¼šåˆ¤æ–­åªè¯»ï¼Œå‰é¢å››ä¸ªå‘¢ï¼‰ throw new ReadOnlyBufferException(); int n = src.remaining(); //ç»™è¿›æ¥çš„srcçœ‹çœ‹å®¹é‡ï¼ˆæ³¨æ„è¿™é‡Œä¸remainingçš„ç»“æœä¸æ˜¯å‰©ä½™å®¹é‡ï¼Œæ˜¯è½¬æ¢åçš„ï¼Œä¹‹åä¼šè¯´ï¼‰ if (n \u0026gt; remaining()) //è¿™é‡Œåˆ¤æ–­å½“å‰å‰©ä½™å®¹é‡æ˜¯å¦å°äºsrcå®¹é‡ throw new BufferOverflowException(); for (int i = 0; i \u0026lt; n; i++) //ä¹Ÿæ˜¯ä»positionä½ç½®å¼€å§‹ç»§ç»­å†™å…¥ put(src.get()); //é€šè¿‡getæ–¹æ³•ä¸€ä¸ªä¸€ä¸ªè¯»å–æ•°æ®å‡ºæ¥ï¼Œå…·ä½“è¿‡ç¨‹åé¢è®²è§£ return this; } æˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœï¼š\npublic static void main(String[] args) { IntBuffer src = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5}); IntBuffer buffer = IntBuffer.allocate(10); buffer.put(src); System.out.println(Arrays.toString(buffer.array())); } ä½†æ˜¯å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œä¼šå‡ºç°é—®é¢˜ï¼š\npublic static void main(String[] args) { IntBuffer src = IntBuffer.allocate(5); for (int i = 0; i \u0026lt; 5; i++) src.put(i); //æ‰‹åŠ¨æ’å…¥æ•°æ® IntBuffer buffer = IntBuffer.allocate(10); buffer.put(src); System.out.println(Arrays.toString(buffer.array())); } æˆ‘ä»¬å‘ç°ï¼Œç»“æœå’Œä¸Šé¢çš„ä¸ä¸€æ ·ï¼Œå¹¶æ²¡æœ‰æˆåŠŸåœ°å°†æ•°æ®å¡«åˆ°ä¸‹é¢çš„IntBufferä¸­ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå®é™…ä¸Šå°±æ˜¯å› ä¸º remaining()çš„è®¡ç®—é—®é¢˜ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ˜¯ç›´æ¥è®¡ç®—postionçš„ä½ç½®ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬åœ¨å†™æ“ä½œå®Œæˆä¹‹åï¼Œpositionè·‘åˆ°åé¢å»äº†ï¼Œä¹Ÿå°±å¯¼è‡´ remaining()ç»“æœæœ€åç®—å‡ºæ¥ä¸º0ã€‚\nå› ä¸ºè¿™é‡Œä¸æ˜¯å†™æ“ä½œï¼Œæ˜¯æ¥ä¸‹æ¥éœ€è¦ä»å¤´å¼€å§‹è¿›è¡Œè¯»æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—æƒ³ä¸ªåŠæ³•æŠŠpositionç»™é€€å›åˆ°ä¸€å¼€å§‹çš„ä½ç½®ï¼Œè¿™æ ·æ‰å¯ä»¥ä»å¤´å¼€å§‹è¯»å–ï¼Œé‚£ä¹ˆæ€ä¹ˆåšå‘¢ï¼Ÿä¸€èˆ¬æˆ‘ä»¬åœ¨å†™å…¥å®Œæˆåéœ€è¦è¿›è¡Œè¯»æ“ä½œæ—¶ï¼ˆåé¢éƒ½æ˜¯è¿™æ ·ï¼Œä¸åªæ˜¯è¿™é‡Œï¼‰ï¼Œä¼šä½¿ç”¨ flip()æ–¹æ³•è¿›è¡Œç¿»è½¬ï¼š\npublic final Buffer flip() { limit = position; //ä¿®æ”¹limitå€¼ï¼Œå½“å‰å†™åˆ°å“ªé‡Œï¼Œä¸‹æ¬¡è¯»çš„æœ€ç»ˆä½ç½®å°±æ˜¯è¿™é‡Œï¼Œlimitçš„ä½œç”¨å¼€å§‹æ…¢æ…¢ä½“ç°äº† position = 0; //positionå½’é›¶ mark = -1; //æ ‡è®°è¿˜åŸä¸º-1ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬è¿˜æ²¡ç”¨åˆ° return this; } è¿™æ ·ï¼Œå†æ¬¡è®¡ç®— remaining()çš„ç»“æœå°±æ˜¯æˆ‘ä»¬éœ€è¦è¯»å–çš„æ•°é‡äº†ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆputæ–¹æ³•ä¸­è¦ç”¨ remaining()æ¥è®¡ç®—çš„åŸå› ï¼Œæˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\npublic static void main(String[] args) { IntBuffer src = IntBuffer.allocate(5); for (int i = 0; i \u0026lt; 5; i++) src.put(i); IntBuffer buffer = IntBuffer.allocate(10); src.flip(); //æˆ‘ä»¬å¯ä»¥é€šè¿‡flipæ¥ç¿»è½¬ç¼“å†²åŒº buffer.put(src); System.out.println(Arrays.toString(buffer.array())); } ç¿»è½¬ä¹‹åå†æ¬¡è¿›è¡Œè½¬ç§»ï¼Œå°±æ­£å¸¸äº†ã€‚\nç¼“å†²åŒºè¯»æ“ä½œ #\rå‰é¢æˆ‘ä»¬çœ‹å®Œäº†å†™æ“ä½œï¼Œç°åœ¨æˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹è¯»æ“ä½œã€‚è¯»æ“ä½œæœ‰å››ä¸ªæ–¹æ³•ï¼š\npublic abstract int get(); - ç›´æ¥è·å–å½“å‰positionä½ç½®çš„æ•°æ®ï¼Œç”±å­ç±»å®ç° public abstract int get(int index); - è·å–æŒ‡å®šä½ç½®çš„æ•°æ®ï¼Œä¹Ÿæ˜¯å­ç±»å®ç° public IntBuffer get(int[] dst) - å°†æ•°æ®è¯»å–åˆ°ç»™å®šçš„æ•°ç»„ä¸­ public IntBuffer get(int[] dst, int offset, int length) - åŒä¸Šï¼ŒåŠ äº†ä¸ªèŒƒå›´ æˆ‘ä»¬è¿˜æ˜¯ä»æœ€ç®€å•çš„å¼€å§‹çœ‹ï¼Œç¬¬ä¸€ä¸ªgetæ–¹æ³•çš„å®ç°åœ¨IntBufferç±»ä¸­ï¼š\npublic int get() { return hb[ix(nextGetIndex())]; //ç›´æ¥ä»æ•°ç»„ä¸­å–å°±å®Œäº‹ } final int nextGetIndex() { // å¥½å®¶ä¼™ï¼Œè¿™ä¸è·Ÿå‰é¢é‚£ä¸ªä¸€æ¨¡ä¸€æ ·å— int p = position; if (p \u0026gt;= limit) throw new BufferUnderflowException(); position = p + 1; return p; } å¯ä»¥çœ‹åˆ°æ¯æ¬¡è¯»å–æ“ä½œä¹‹åï¼Œä¹Ÿä¼šå°†postion+1ï¼Œç›´åˆ°æœ€åä¸€ä¸ªä½ç½®ï¼Œå¦‚æœè¿˜è¦ç»§ç»­è¯»ï¼Œé‚£ä¹ˆå°±ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒä¸ªï¼š\npublic int get(int i) { return hb[ix(checkIndex(i))]; //è¿™é‡Œä¾ç„¶æ˜¯ä½¿ç”¨checkIndexæ¥æ£€æŸ¥ä½ç½®æ˜¯å¦éæ³• } æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªï¼š\npublic IntBuffer get(int[] dst, int offset, int length) { checkBounds(offset, length, dst.length); //è·Ÿputæ“ä½œä¸€æ ·ï¼Œä¹Ÿæ˜¯éœ€è¦æ£€æŸ¥æ˜¯å¦è¶Šç•Œ if (length \u0026gt; remaining()) //å¦‚æœè¯»å–çš„é•¿åº¦æ¯”å¯ä»¥è¯»çš„é•¿åº¦å¤§ï¼Œé‚£è‚¯å®šæ˜¯ä¸è¡Œçš„ throw new BufferUnderflowException(); int end = offset + length; //è®¡ç®—å‡ºæœ€ç»ˆè¯»å–ä½ç½® for (int i = offset; i \u0026lt; end; i++) dst[i] = get(); //å¼€å§‹ä»positionæŠŠæ•°æ®è¯»åˆ°æ•°ç»„ä¸­ï¼Œæ³¨æ„æ˜¯åœ¨æ•°ç»„çš„offsetä½ç½®å¼€å§‹ return this; } public IntBuffer get(int[] dst) { return get(dst, 0, dst.length); //ä¸æŒ‡å®šèŒƒå›´çš„è¯ï¼Œé‚£å°±ç›´æ¥ç”¨ä¸Šé¢çš„ } æˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5}); int[] arr = new int[10]; buffer.get(arr, 2, 5); System.out.println(Arrays.toString(arr)); } å¯ä»¥çœ‹åˆ°æˆåŠŸåœ°å°†æ•°æ®è¯»å–åˆ°äº†æ•°ç»„ä¸­ã€‚\nå½“ç„¶å¦‚æœæˆ‘ä»¬éœ€è¦ç›´æ¥è·å–æ•°ç»„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ array()æ–¹æ³•æ¥æ‹¿åˆ°ï¼š\npublic final int[] array() { if (hb == null) //ä¸ºç©ºé‚£è¯´æ˜åº•å±‚ä¸æ˜¯æ•°ç»„å®ç°çš„ï¼Œè‚¯å®šå°±æ²¡æ³•è½¬æ¢äº† throw new UnsupportedOperationException(); if (isReadOnly) //åªè¯»ä¹Ÿæ˜¯ä¸è®©ç›´æ¥å–å‡ºçš„ï¼Œå› ä¸ºä¸€æ—¦å–å‡ºå»å²‚ä¸æ˜¯å°±èƒ½è¢«ä¿®æ”¹äº† throw new ReadOnlyBufferException(); return hb; //ç›´æ¥è¿”å›hb } æˆ‘ä»¬æ¥è¯•è¯•çœ‹ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5}); System.out.println(Arrays.toString(buffer.array())); } å½“ç„¶ï¼Œæ—¢ç„¶éƒ½å·²ç»æ‹¿åˆ°äº†åº•å±‚çš„ hbäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚æœç›´æ¥ä¿®æ”¹ä¹‹åæ˜¯ä¸æ˜¯è¯»å–åˆ°çš„å°±æ˜¯æˆ‘ä»¬çš„ä¿®æ”¹ä¹‹åçš„ç»“æœäº†ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5}); int[] arr = buffer.array(); arr[0] = 99999; //æ‹¿åˆ°æ•°ç»„å¯¹è±¡ç›´æ¥æ”¹ System.out.println(buffer.get()); } å¯ä»¥çœ‹åˆ°è¿™ç§æ–¹å¼ç”±äºæ˜¯ç›´æ¥æ‹¿åˆ°çš„åº•å±‚æ•°ç»„ï¼Œæ‰€æœ‰ä¿®æ”¹ä¼šç›´æ¥ç”Ÿæ•ˆåœ¨ç¼“å†²åŒºä¸­ã€‚\nå½“ç„¶é™¤äº†å¸¸è§„çš„è¯»å–æ–¹å¼ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ mark()æ¥å®ç°è·³è½¬è¯»å–ï¼Œè¿™é‡Œéœ€è¦ä»‹ç»ä¸€ä¸‹å‡ ä¸ªæ“ä½œï¼š\npublic final Buffer mark() - æ ‡è®°å½“å‰ä½ç½® public final Buffer reset() - è®©å½“å‰çš„positionä½ç½®è·³è½¬åˆ°markå½“æ—¶æ ‡è®°çš„ä½ç½® æˆ‘ä»¬é¦–å…ˆæ¥çœ‹æ ‡è®°æ–¹æ³•ï¼š\npublic final Buffer mark() { mark = position; //ç›´æ¥æ ‡è®°åˆ°å½“å‰ä½ç½®ï¼Œmarkå˜é‡ç»ˆäºæ´¾ä¸Šç”¨åœºäº†ï¼Œå½“ç„¶è¿™é‡Œä»…ä»…æ˜¯æ ‡è®° return this; } æˆ‘ä»¬å†æ¥çœ‹çœ‹é‡ç½®æ–¹æ³•ï¼š\npublic final Buffer reset() { int m = mark; //å­˜ä¸€ä¸‹å½“å‰çš„markä½ç½® if (m \u0026lt; 0) //å› ä¸ºmarké»˜è®¤æ˜¯-1ï¼Œè¦æ˜¯æ²¡æœ‰è¿›è¡Œè¿‡ä»»ä½•æ ‡è®°æ“ä½œï¼Œé‚£resetä¸ªæ¯› throw new InvalidMarkException(); position = m; //ç›´æ¥è®©positionå˜æˆmarkä½ç½® return this; } é‚£æ¯”å¦‚æˆ‘ä»¬åœ¨è¯»å–åˆ°1å·ä½ç½®æ—¶è¿›è¡Œæ ‡è®°ï¼š\næ¥ç€æˆ‘ä»¬ä½¿ç”¨resetæ–¹æ³•å°±å¯ä»¥ç›´æ¥å›é€€å›å»äº†ï¼š\nç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5}); buffer.get(); //è¯»å–ä¸€ä½ï¼Œé‚£ä¹ˆpositionå°±å˜æˆ1äº† buffer.mark(); //è¿™æ—¶æ ‡è®°ï¼Œé‚£ä¹ˆmark = 1 buffer.get(); //åˆè¯»å–ä¸€ä½ï¼Œé‚£ä¹ˆpositionå°±å˜æˆ2äº† buffer.reset(); //ç›´æ¥å°†position = markï¼Œä¹Ÿå°±æ˜¯å˜å›1 System.out.println(buffer.get()); } å¯ä»¥çœ‹åˆ°ï¼Œè¯»å–çš„ä½ç½®æ ¹æ®æˆ‘ä»¬çš„æ“ä½œè¿›è¡Œäº†å˜åŒ–ï¼Œæœ‰å…³ç¼“å†²åŒºçš„è¯»æ“ä½œï¼Œå°±æš‚æ—¶è®²åˆ°è¿™é‡Œã€‚\nç¼“å†²åŒºå…¶ä»–æ“ä½œ #\rå‰é¢æˆ‘ä»¬å¤§è‡´äº†è§£äº†ä¸€ä¸‹ç¼“å†²åŒºçš„è¯»å†™æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹ï¼Œé™¤äº†å¸¸è§„çš„è¯»å†™æ“ä½œä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›å…¶ä»–çš„æ“ä½œï¼š\npublic abstract IntBuffer compact() - å‹ç¼©ç¼“å†²åŒºï¼Œç”±å…·ä½“å®ç°ç±»å®ç° public IntBuffer duplicate() - å¤åˆ¶ç¼“å†²åŒºï¼Œä¼šç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç›¸åŒçš„ç¼“å†²åŒº public abstract IntBuffer slice() - åˆ’åˆ†ç¼“å†²åŒºï¼Œä¼šå°†åŸæœ¬çš„å®¹é‡å¤§å°çš„ç¼“å†²åŒºåˆ’åˆ†ä¸ºæ›´å°çš„å‡ºæ¥è¿›è¡Œæ“ä½œ public final Buffer rewind() - é‡ç»•ç¼“å†²åŒºï¼Œå…¶å®å°±æ˜¯æŠŠpositionå½’é›¶ï¼Œç„¶åmarkå˜å›-1 public final Buffer clear() - å°†ç¼“å†²åŒºæ¸…ç©ºï¼Œæ‰€æœ‰çš„å˜é‡å˜å¦‚å›¾9å›æœ€åˆçš„çŠ¶æ€ æˆ‘ä»¬å…ˆä»å‹ç¼©ç¼“å†²åŒºå¼€å§‹çœ‹èµ·ï¼Œå®ƒä¼šå°†æ•´ä¸ªç¼“å†²åŒºçš„å¤§å°å’Œæ•°æ®å†…å®¹å˜æˆpositionä½ç½®åˆ°limitä¹‹é—´çš„æ•°æ®ï¼Œå¹¶ç§»åŠ¨åˆ°æ•°ç»„å¤´éƒ¨ï¼š\npublic IntBuffer compact() { int pos = position(); //è·å–å½“å‰ä½ç½® int lim = limit(); //è·å–å½“å‰æœ€å¤§positionä½ç½® assert (pos \u0026lt;= lim); //æ–­è¨€è¡¨è¾¾å¼ï¼Œpositionå¿…é¡»å°äºæœ€å¤§ä½ç½®ï¼Œè‚¯å®šçš„ int rem = (pos \u0026lt;= lim ? lim - pos : 0); //è®¡ç®—posè·ç¦»æœ€å¤§ä½ç½®çš„é•¿åº¦ System.arraycopy(hb, ix(pos), hb, ix(0), rem); //ç›´æ¥å°†hbæ•°ç»„å½“å‰positionä½ç½®çš„æ•°æ®æ‹·è´åˆ°å¤´éƒ¨å»ï¼Œç„¶åé•¿åº¦æ”¹æˆåˆšåˆšè®¡ç®—å‡ºæ¥çš„ç©ºé—´ position(rem); //ç›´æ¥å°†positionç§»åŠ¨åˆ°remä½ç½® limit(capacity()); //posæœ€å¤§ä½ç½®ä¿®æ”¹ä¸ºæœ€å¤§å®¹é‡ discardMark(); //markå˜å›-1 return this; } æ¯”å¦‚ç°åœ¨çš„çŠ¶æ€æ˜¯ï¼š\né‚£ä¹ˆæˆ‘ä»¬åœ¨æ‰§è¡Œ compact()æ–¹æ³•ä¹‹åï¼Œä¼šè¿›è¡Œæˆªå–ï¼Œæ­¤æ—¶ limit - position = 6ï¼Œé‚£ä¹ˆå°±ä¼šæˆªå–ç¬¬ 4ã€5ã€6ã€7ã€8ã€9è¿™6ä¸ªæ•°æ®ç„¶åä¸¢åˆ°æœ€å‰é¢ï¼Œæ¥ç€positionè·‘åˆ° 7è¡¨ç¤ºè¿™æ˜¯ä¸‹ä¸€ä¸ªç»§ç»­çš„ä½ç½®ï¼š\nç°åœ¨æˆ‘ä»¬é€šè¿‡ä»£ç æ¥æ£€éªŒä¸€ä¸‹ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 0}); for (int i = 0; i \u0026lt; 4; i++) buffer.get(); //å…ˆæ­£å¸¸è¯»4ä¸ª buffer.compact(); //å‹ç¼©ç¼“å†²åŒº System.out.println(\u0026#34;å‹ç¼©ä¹‹åçš„æƒ…å†µï¼š\u0026#34;+Arrays.toString(buffer.array())); System.out.println(\u0026#34;å½“å‰positionä½ç½®ï¼š\u0026#34;+buffer.position()); System.out.println(\u0026#34;å½“å‰limitä½ç½®ï¼š\u0026#34;+buffer.limit()); } å¯ä»¥çœ‹åˆ°æœ€åçš„ç»“æœæ²¡æœ‰é—®é¢˜ï¼š\næˆ‘ä»¬æ¥ç€æ¥çœ‹ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç°åœ¨éœ€è¦å¤åˆ¶ä¸€ä¸ªå†…å®¹ä¸€æ¨¡ä¸€æ ·çš„çš„ç¼“å†²åŒºï¼Œè¯¥æ€ä¹ˆåšï¼Ÿç›´æ¥ä½¿ç”¨ duplicate()æ–¹æ³•å°±å¯ä»¥å¤åˆ¶äº†ï¼š\npublic IntBuffer duplicate() { //ç›´æ¥newä¸€ä¸ªæ–°çš„ï¼Œä½†æ˜¯æ˜¯å§hbç»™ä¸¢è¿›å»äº†ï¼Œè€Œä¸æ˜¯æ‹·è´ä¸€ä¸ªæ–°çš„ return new HeapIntBuffer(hb, this.markValue(), this.position(), this.limit(), this.capacity(), offset); } é‚£ä¹ˆå„ä½çŒœæƒ³ä¸€ä¸‹ï¼Œå¦‚æœé€šè¿‡è¿™ç§æ–¹å¼åˆ›äº†ä¸€ä¸ªæ–°çš„IntBufferï¼Œé‚£ä¹ˆä¸‹é¢çš„ä¾‹å­ä¼šå‡ºç°ä»€ä¹ˆç»“æœï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5}); IntBuffer duplicate = buffer.duplicate(); System.out.println(buffer == duplicate); System.out.println(buffer.array() == duplicate.array()); } ç”±äºbufferæ˜¯é‡æ–°newçš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªä¸ºfalseï¼Œè€Œåº•å±‚çš„æ•°ç»„ç”±äºåœ¨æ„é€ çš„æ—¶å€™æ²¡æœ‰è¿›è¡Œä»»ä½•çš„æ‹·è´è€Œæ˜¯ç›´æ¥ä¼ é€’ï¼Œå› æ­¤å®é™…ä¸Šä¸¤ä¸ªç¼“å†²åŒºçš„åº•å±‚æ•°ç»„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ‰€ä»¥ï¼Œä¸€ä¸ªå‘ç”Ÿä¿®æ”¹ï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªå°±è·Ÿç€å˜äº†ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5}); IntBuffer duplicate = buffer.duplicate(); buffer.put(0, 66666); System.out.println(duplicate.get()); } ç°åœ¨æˆ‘ä»¬æ¥ç€æ¥çœ‹ä¸‹ä¸€ä¸ªæ–¹æ³•ï¼Œslice()æ–¹æ³•ä¼šå°†ç¼“å†²åŒºè¿›è¡Œåˆ’åˆ†ï¼š\npublic IntBuffer slice() { int pos = this.position(); //è·å–å½“å‰position int lim = this.limit(); //è·å–positionæœ€å¤§ä½ç½® int rem = (pos \u0026lt;= lim ? lim - pos : 0); //æ±‚å¾—å‰©ä½™ç©ºé—´ return new HeapIntBuffer(hb, //è¿”å›ä¸€ä¸ªæ–°çš„åˆ’åˆ†å‡ºçš„ç¼“å†²åŒºï¼Œä½†æ˜¯åº•å±‚çš„æ•°ç»„ç”¨çš„è¿˜æ˜¯åŒä¸€ä¸ª -1, 0, rem, //æ–°çš„å®¹é‡å˜æˆäº†å‰©ä½™ç©ºé—´çš„å¤§å° rem, pos + offset); //å¯ä»¥çœ‹åˆ°offsetçš„åœ°å€ä¸å†æ˜¯0äº†ï¼Œè€Œæ˜¯å½“å‰çš„positionåŠ ä¸ŠåŸæœ‰çš„offsetå€¼ } è™½ç„¶ç°åœ¨åº•å±‚ä¾ç„¶ä½¿ç”¨çš„æ˜¯ä¹‹å‰çš„æ•°ç»„ï¼Œä½†æ˜¯ç”±äºè®¾å®šäº†offsetå€¼ï¼Œæˆ‘ä»¬ä¹‹å‰çš„æ“ä½œä¼¼ä¹å˜å¾—ä¸å¤ªä¸€æ ·äº†ï¼š\nå›é¡¾å‰é¢æˆ‘ä»¬æ‰€è®²è§£çš„å†…å®¹ï¼Œåœ¨è¯»å–å’Œå­˜æ”¾æ—¶ï¼Œä¼šè¢« ixæ–¹æ³•è¿›è¡Œè°ƒæ•´ï¼š\nprotected int ix(int i) { return i + offset; //ç°åœ¨offsetä¸º4ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´é€»è¾‘ä¸Šçš„iæ˜¯0ä½†æ˜¯å¾—åˆ°çœŸå®ä½ç½®å´æ˜¯4 } public int get() { return hb[ix(nextGetIndex())]; //æœ€åä¼šç»è¿‡ixæ–¹æ³•è½¬æ¢ä¸ºçœŸæ­£åœ¨æ•°ç»„ä¸­çš„ä½ç½® } å½“ç„¶ï¼Œåœ¨é€»è¾‘ä¸Šæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯è¿™æ ·çš„ï¼š\nç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 0}); for (int i = 0; i \u0026lt; 4; i++) buffer.get(); IntBuffer slice = buffer.slice(); System.out.println(\u0026#34;åˆ’åˆ†ä¹‹åçš„æƒ…å†µï¼š\u0026#34;+Arrays.toString(slice.array())); System.out.println(\u0026#34;åˆ’åˆ†ä¹‹åçš„åç§»åœ°å€ï¼š\u0026#34;+slice.arrayOffset()); System.out.println(\u0026#34;å½“å‰positionä½ç½®ï¼š\u0026#34;+slice.position()); System.out.println(\u0026#34;å½“å‰limitä½ç½®ï¼š\u0026#34;+slice.limit()); while (slice.hasRemaining()) { //å°†æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨æŒ¨ç€æ‰“å°å‡ºæ¥ System.out.print(slice.get()+\u0026#34;, \u0026#34;); } } å¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆç»“æœï¼š\næœ€åä¸¤ä¸ªæ–¹æ³•å°±æ¯”è¾ƒç®€å•äº†ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ rewind()ï¼Œå®ƒç›¸å½“äºæ˜¯å¯¹positionå’Œmarkè¿›è¡Œäº†ä¸€æ¬¡é‡ç½®ï¼š\npublic final Buffer rewind() { position = 0; mark = -1; return this; } æ¥ç€æ˜¯ clear()ï¼Œå®ƒç›¸å½“äºæ˜¯å°†æ•´ä¸ªç¼“å†²åŒºå›å½’åˆ°æœ€åˆçš„çŠ¶æ€äº†ï¼š\npublic final Buffer clear() { position = 0; //åŒä¸Š limit = capacity; //limitå˜å›capacity mark = -1; return this; } åˆ°è¿™é‡Œï¼Œå…³äºç¼“å†²åŒºçš„ä¸€äº›å…¶ä»–æ“ä½œï¼Œæˆ‘ä»¬å°±è®²è§£åˆ°æ­¤ã€‚\nç¼“å†²åŒºæ¯”è¾ƒ #\rç¼“å†²åŒºä¹‹é—´æ˜¯å¯ä»¥è¿›è¡Œæ¯”è¾ƒçš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°equalsæ–¹æ³•å’ŒcompareToæ–¹æ³•éƒ½æ˜¯è¢«é‡å†™äº†çš„ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹ equalsæ–¹æ³•ï¼Œæ³¨æ„ï¼Œå®ƒæ˜¯åˆ¤æ–­ä¸¤ä¸ªç¼“å†²åŒºå‰©ä½™çš„å†…å®¹æ˜¯å¦ä¸€è‡´ï¼š\npublic boolean equals(Object ob) { if (this == ob) //è¦æ˜¯ä¸¤ä¸ªç¼“å†²åŒºæ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè‚¯å®šä¸€æ · return true; if (!(ob instanceof IntBuffer)) //ç±»å‹ä¸æ˜¯IntBufferé‚£ä¹Ÿä¸ç”¨æ¯”äº† return false; IntBuffer that = (IntBuffer)ob; //è½¬æ¢ä¸ºIntBuffer int thisPos = this.position(); //è·å–å½“å‰ç¼“å†²åŒºçš„ç›¸å…³ä¿¡æ¯ int thisLim = this.limit(); int thatPos = that.position(); //è·å–å¦ä¸€ä¸ªç¼“å†²åŒºçš„ç›¸å…³ä¿¡æ¯ int thatLim = that.limit(); int thisRem = thisLim - thisPos; int thatRem = thatLim - thatPos; if (thisRem \u0026lt; 0 || thisRem != thatRem) //å¦‚æœå‰©ä½™å®¹é‡å°äº0æˆ–æ˜¯ä¸¤ä¸ªç¼“å†²åŒºçš„å‰©ä½™å®¹é‡ä¸ä¸€æ ·ï¼Œä¹Ÿä¸è¡Œ return false; //æ³¨æ„æ¯”è¾ƒçš„æ˜¯å‰©ä½™çš„å†…å®¹ for (int i = thisLim - 1, j = thatLim - 1; i \u0026gt;= thisPos; i--, j--) //ä»æœ€åä¸€ä¸ªå¼€å§‹å€’ç€å¾€å›æ¯”å‰©ä½™çš„åŒºåŸŸ if (!equals(this.get(i), that.get(j))) return false; //åªè¦å‘ç°ä¸ä¸€æ ·çš„å°±ä¸ç”¨ç»§ç»­äº†ï¼Œç›´æ¥false return true; //ä¸Šé¢çš„æ¯”è¾ƒéƒ½æ²¡é—®é¢˜ï¼Œé‚£ä¹ˆå°±true } private static boolean equals(int x, int y) { return x == y; } é‚£ä¹ˆæˆ‘ä»¬æŒ‰ç…§å®ƒçš„æ€è·¯æ¥éªŒè¯ä¸€ä¸‹ï¼š\npublic static void main(String[] args) { IntBuffer buffer1 = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 0}); IntBuffer buffer2 = IntBuffer.wrap(new int[]{6, 5, 4, 3, 2, 1, 7, 8, 9, 0}); System.out.println(buffer1.equals(buffer2)); //ç›´æ¥æ¯”è¾ƒ buffer1.position(6); buffer2.position(6); System.out.println(buffer1.equals(buffer2)); //æ¯”è¾ƒä»ä¸‹æ ‡6å¼€å§‹çš„å‰©ä½™å†…å®¹ } å¯ä»¥çœ‹åˆ°ç»“æœå°±æ˜¯æˆ‘ä»¬æ‰€æƒ³çš„é‚£æ ·ï¼š\né‚£ä¹ˆæˆ‘ä»¬æ¥ç€æ¥çœ‹æ¯”è¾ƒï¼ŒcompareToæ–¹æ³•ï¼Œå®ƒå®é™…ä¸Šæ˜¯ Comparableæ¥å£æä¾›çš„æ–¹æ³•ï¼Œå®ƒå®é™…ä¸Šæ¯”è¾ƒçš„ä¹Ÿæ˜¯poså¼€å§‹å‰©ä½™çš„å†…å®¹ï¼š\npublic int compareTo(IntBuffer that) { int thisPos = this.position(); //è·å–å¹¶è®¡ç®—ä¸¤ä¸ªç¼“å†²åŒºçš„poså’Œremain int thisRem = this.limit() - thisPos; int thatPos = that.position(); int thatRem = that.limit() - thatPos; int length = Math.min(thisRem, thatRem); //é€‰å–ä¸€ä¸ªå‰©ä½™ç©ºé—´æœ€å°çš„å‡ºæ¥ if (length \u0026lt; 0) //å¦‚æœæœ€å°çš„å°äº0ï¼Œé‚£å°±è¿”å›-1 return -1; int n = thisPos + Math.min(thisRem, thatRem); //è®¡ç®—nçš„å€¼å½“å‰çš„posåŠ ä¸Šå‰©ä½™çš„æœ€å°ç©ºé—´ for (int i = thisPos, j = thatPos; i \u0026lt; n; i++, j++) { //ä»ä¸¤ä¸ªç¼“å†²åŒºçš„å½“å‰ä½ç½®å¼€å§‹ï¼Œä¸€ç›´åˆ°nç»“æŸ int cmp = compare(this.get(i), that.get(j)); //æ¯”è¾ƒ if (cmp != 0) return cmp; //åªè¦å‡ºç°ä¸ç›¸åŒçš„ï¼Œé‚£ä¹ˆå°±è¿”å›æ¯”è¾ƒå‡ºæ¥çš„å€¼ } return thisRem - thatRem; //å¦‚æœæ²¡æ¯”å‡ºæ¥ä¸ªæ‰€ä»¥ç„¶ï¼Œé‚£ä¹ˆå°±æ¯”é•¿åº¦ } private static int compare(int x, int y) { return Integer.compare(x, y); } è¿™é‡Œæˆ‘ä»¬å°±ä¸å¤šåšä»‹ç»äº†ã€‚\nåªè¯»ç¼“å†²åŒº #\ræ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹åªè¯»ç¼“å†²åŒºï¼Œåªè¯»ç¼“å†²åŒºå°±åƒå…¶åç§°ä¸€æ ·ï¼Œå®ƒåªèƒ½è¿›è¡Œè¯»æ“ä½œï¼Œè€Œä¸å…è®¸è¿›è¡Œå†™æ“ä½œã€‚\né‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆåˆ›å»ºåªè¯»ç¼“å†²åŒºå‘¢ï¼Ÿ\npublic abstract IntBuffer asReadOnlyBuffer(); - åŸºäºå½“å‰ç¼“å†²åŒºç”Ÿæˆä¸€ä¸ªåªè¯»çš„ç¼“å†²åŒºã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹æ­¤æ–¹æ³•çš„å…·ä½“å®ç°ï¼š\npublic IntBuffer asReadOnlyBuffer() { return new HeapIntBufferR(hb, //æ³¨æ„è¿™é‡Œå¹¶ä¸æ˜¯ç›´æ¥åˆ›å»ºäº†HeapIntBufferï¼Œè€Œæ˜¯HeapIntBufferRï¼Œå¹¶ä¸”ç›´æ¥å¤åˆ¶çš„hbæ•°ç»„ this.markValue(), this.position(), this.limit(), this.capacity(), offset); } é‚£ä¹ˆè¿™ä¸ªHeapIntBufferRç±»è·Ÿæˆ‘ä»¬æ™®é€šçš„HeapIntBufferæœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„å‘¢ï¼Ÿ\nå¯ä»¥çœ‹åˆ°å®ƒæ˜¯ç»§æ‰¿è‡ªHeapIntBufferçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„å®ç°æœ‰ä»€ä¹ˆä¸åŒï¼š\nprotected HeapIntBufferR(int[] buf, int mark, int pos, int lim, int cap, int off) { super(buf, mark, pos, lim, cap, off); this.isReadOnly = true; } å¯ä»¥çœ‹åˆ°åœ¨å…¶æ„é€ æ–¹æ³•ä¸­ï¼Œé™¤äº†ç›´æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•å¤–ï¼Œè¿˜ä¼šå°† isReadOnlyæ ‡è®°ä¿®æ”¹ä¸ºtrueï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹putæ“ä½œæœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„ï¼š\npublic boolean isReadOnly() { return true; } public IntBuffer put(int x) { throw new ReadOnlyBufferException(); } public IntBuffer put(int i, int x) { throw new ReadOnlyBufferException(); } public IntBuffer put(int[] src, int offset, int length) { throw new ReadOnlyBufferException(); } public IntBuffer put(IntBuffer src) { throw new ReadOnlyBufferException(); } å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„putæ–¹æ³•å…¨éƒ¨å‡‰å‡‰ï¼Œåªè¦è°ƒç”¨å°±ä¼šç›´æ¥æŠ›å‡ºReadOnlyBufferExceptionå¼‚å¸¸ã€‚ä½†æ˜¯å…¶ä»–getæ–¹æ³•ä¾ç„¶æ²¡æœ‰è¿›è¡Œé‡å†™ï¼Œä¹Ÿå°±æ˜¯è¯´getæ“ä½œè¿˜æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ï¼Œä½†æ˜¯åªè¦æ˜¯å†™æ“ä½œå°±éƒ½ä¸è¡Œï¼š\npublic static void main(String[] args) { IntBuffer buffer = IntBuffer.wrap(new int[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 0}); IntBuffer readBuffer = buffer.asReadOnlyBuffer(); System.out.println(readBuffer.isReadOnly()); System.out.println(readBuffer.get()); readBuffer.put(0, 666); } å¯ä»¥çœ‹åˆ°ç»“æœä¸ºï¼š\nè¿™å°±æ˜¯åªè¯»çŠ¶æ€ä¸‹çš„ç¼“å†²åŒºã€‚\nByteBufferå’ŒCharBuffer #\ré€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå·²ç»äº†è§£äº†ç¼“å†²åŒºçš„ä½¿ç”¨ï¼Œä½†æ˜¯éƒ½æ˜¯åŸºäºIntBufferè¿›è¡Œè®²è§£ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å¦å¤–ä¸¤ç§åŸºæœ¬ç±»å‹çš„ç¼“å†²åŒºByteBufferå’ŒCharBufferï¼Œå› ä¸ºByteBufferåº•å±‚å­˜æ”¾çš„æ˜¯å¾ˆå¤šå•ä¸ªbyteå­—èŠ‚ï¼Œæ‰€ä»¥ä¼šæœ‰æ›´å¤šçš„ç©æ³•ï¼ŒåŒæ ·CharBufferæ˜¯ä¸€ç³»åˆ—å­—èŠ‚ï¼Œæ‰€ä»¥ä¹Ÿæœ‰å¾ˆå¤šä¾¿æ·æ“ä½œã€‚\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ByteBufferï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç‚¹è¿›å»çœ‹ï¼š\npublic abstract class ByteBuffer extends Buffer implements Comparable\u0026lt;ByteBuffer\u0026gt; { final byte[] hb; // Non-null only for heap buffers final int offset; boolean isReadOnly; // Valid only for heap buffers .... å¯ä»¥çœ‹åˆ°å¦‚æœä¹Ÿæ˜¯ä½¿ç”¨å †ç¼“å†²åŒºå­ç±»å®ç°ï¼Œé‚£ä¹ˆä¾ç„¶æ˜¯ä¸€ä¸ª byte[]çš„å½¢å¼ä¿å­˜æ•°æ®ã€‚æˆ‘ä»¬æ¥å°è¯•ä½¿ç”¨ä¸€ä¸‹ï¼š\npublic static void main(String[] args) { ByteBuffer buffer = ByteBuffer.allocate(10); //é™¤äº†ç›´æ¥ä¸¢byteè¿›å»ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸¢å…¶ä»–çš„åŸºæœ¬ç±»å‹ï¼ˆæ³¨æ„å®¹é‡æ¶ˆè€—ï¼‰ buffer.putInt(Integer.MAX_VALUE); //ä¸¢ä¸ªintçš„æœ€å¤§å€¼è¿›å»ï¼Œæ³¨æ„ä¸€ä¸ªintå 4å­—èŠ‚ System.out.println(\u0026#34;å½“å‰ç¼“å†²åŒºå‰©ä½™å­—èŠ‚æ•°ï¼š\u0026#34;+buffer.remaining()); //åªå‰©6ä¸ªå­—èŠ‚äº† //æˆ‘ä»¬æ¥å°è¯•è¯»å–ä¸€ä¸‹ï¼Œè®°å¾—å…ˆç¿»è½¬ buffer.flip(); while (buffer.hasRemaining()) { System.out.println(buffer.get()); //ä¸€å…±å››ä¸ªå­—èŠ‚ } } æœ€åçš„ç»“æœä¸ºï¼š\nå¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªbyteä¸º127ã€ç„¶åä¸‰ä¸ªéƒ½æ˜¯-1ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š\n127 è½¬æ¢ä¸ºäºŒè¿›åˆ¶è¡¥ç å½¢å¼å°±æ˜¯ 01111111ï¼Œè€Œ -1è½¬æ¢ä¸ºäºŒè¿›åˆ¶è¡¥ç å½¢å¼ä¸º 11111111 é‚£ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯01111111ï¼Œè€Œåç»­å­—èŠ‚å°±æ˜¯11111111ï¼ŒæŠŠå®ƒä»¬æ‹¼æ¥åœ¨ä¸€èµ·ï¼š\näºŒè¿›åˆ¶è¡¥ç è¡¨ç¤º 01111111 11111111 11111111 11111111 è½¬æ¢ä¸ºåè¿›åˆ¶å°±æ˜¯ 2147483647ï¼Œä¹Ÿå°±æ˜¯intçš„æœ€å¤§å€¼ã€‚ é‚£ä¹ˆæ ¹æ®æˆ‘ä»¬ä¸Šé¢çš„æ¨å¯¼ï¼Œå„ä½èƒ½å¦è®¡ç®—å¾—åˆ°ä¸‹é¢çš„ç»“æœå‘¢ï¼Ÿ\npublic static void main(String[] args) { ByteBuffer buffer = ByteBuffer.allocate(10); buffer.put((byte) 0); buffer.put((byte) 0); buffer.put((byte) 1); buffer.put((byte) -1); buffer.flip(); //ç¿»è½¬ä¸€ä¸‹ System.out.println(buffer.getInt()); //ä»¥intå½¢å¼è·å–ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€æ¬¡æ€§è·å–4ä¸ªå­—èŠ‚ } ç»è¿‡ä¸Šé¢çš„è®¡ç®—ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯ï¼š\nä¸Šé¢çš„æ•°æ®ä»¥äºŒè¿›åˆ¶è¡¥ç çš„å½¢å¼è¡¨ç¤ºä¸ºï¼š00000000 00000000 00000001 11111111 å°†å…¶è½¬æ¢ä¸ºåè¿›åˆ¶é‚£ä¹ˆå°±æ˜¯ï¼š256 + 255 = 511 å¥½å§ï¼Œå†æ¥ä¸ªé­”é¬¼é—®é¢˜ï¼ŒæŠŠç¬¬ä¸€ä¸ªæ¢æˆ1å‘¢ï¼š10000000 00000000 00000001 11111111ï¼Œè‡ªå·±ç®—ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹CharBufferï¼Œè¿™ç§ç¼“å†²åŒºå®é™…ä¸Šä¹Ÿæ˜¯ä¿å­˜ä¸€å¤§å †charç±»å‹çš„æ•°æ®ï¼š\npublic static void main(String[] args) { CharBuffer buffer = CharBuffer.allocate(10); buffer.put(\u0026#34;lbwnb\u0026#34;); //é™¤äº†å¯ä»¥ç›´æ¥ä¸¢charä¹‹å¤–ï¼Œå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ä¸€æ¬¡æ€§ä¸¢è¿›å…¥ System.out.println(Arrays.toString(buffer.array())); } ä½†æ˜¯æ­£æ˜¯å¾—ç›Šäºcharæ•°ç»„ï¼Œå®ƒåŒ…å«äº†å¾ˆå¤šçš„å­—ç¬¦ä¸²æ“ä½œï¼Œå¯ä»¥ä¸€æ¬¡æ€§å­˜æ”¾ä¸€æ•´ä¸ªå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬ç”šè‡³è¿˜å¯ä»¥å°†å…¶å½“åšä¸€ä¸ªStringæ¥è¿›è¡Œå¤„ç†ï¼š\npublic static void main(String[] args) { CharBuffer buffer = CharBuffer.allocate(10); buffer.put(\u0026#34;lbwnb\u0026#34;); buffer.append(\u0026#34;!\u0026#34;); //å¯ä»¥åƒStringBuilderä¸€æ ·ä½¿ç”¨appendæ¥ç»§ç»­æ·»åŠ æ•°æ® System.out.println(\u0026#34;å‰©ä½™å®¹é‡ï¼š\u0026#34;+buffer.remaining()); //å·²ç»ç”¨äº†6ä¸ªå­—ç¬¦äº† buffer.flip(); System.out.println(\u0026#34;æ•´ä¸ªå­—ç¬¦ä¸²ä¸ºï¼š\u0026#34;+buffer); //ç›´æ¥å°†å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸² System.out.println(\u0026#34;ç¬¬3ä¸ªå­—ç¬¦æ˜¯ï¼š\u0026#34;+buffer.charAt(2)); //ç›´æ¥åƒStringä¸€æ ·charAt buffer //ä¹Ÿå¯ä»¥è½¬æ¢ä¸ºIntStreamè¿›è¡Œæ“ä½œ .chars() .filter(i -\u0026gt; i \u0026lt; \u0026#39;l\u0026#39;) .forEach(i -\u0026gt; System.out.print((char) i)); } å½“ç„¶é™¤äº†ä¸€äº›å¸¸è§„æ“ä½œä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°åˆ›å»ºï¼š\npublic static void main(String[] args) { //å¯ä»¥ç›´æ¥ä½¿ç”¨wrapåŒ…è£…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯æ³¨æ„ï¼ŒåŒ…è£…å‡ºæ¥ä¹‹åæ˜¯åªè¯»çš„ CharBuffer buffer = CharBuffer.wrap(\u0026#34;æ”¶è—ç­‰äºå­¦ä¼š~\u0026#34;); System.out.println(buffer); buffer.put(\u0026#34;111\u0026#34;); //è¿™é‡Œå°è¯•è¿›è¡Œä¸€ä¸‹å†™æ“ä½œ } å¯ä»¥çœ‹åˆ°ç»“æœä¹Ÿæ˜¯æˆ‘ä»¬é¢„æ–™ä¸­çš„ï¼š\nå¯¹äºè¿™ä¸¤ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ç¼“å†²åŒºï¼Œæˆ‘ä»¬å°±æš‚æ—¶è®²è§£åˆ°è¿™é‡Œã€‚\nç›´æ¥ç¼“å†²åŒº #\r**æ³¨æ„ï¼š**æ¨èå­¦ä¹ å®ŒæˆJVMç¯‡å†æ¥å­¦ä¹ è¿™ä¸€éƒ¨åˆ†ã€‚\næœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç›´æ¥ç¼“å†²åŒºï¼Œæˆ‘ä»¬å‰é¢ä¸€ç›´ä½¿ç”¨çš„éƒ½æ˜¯å †ç¼“å†²åŒºï¼Œä¹Ÿå°±æ˜¯è¯´å®é™…ä¸Šæ•°æ®æ˜¯ä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­çš„ï¼Œå¦‚æœä½ å·²ç»å®Œæˆäº†JVMç¯‡çš„å­¦ä¹ ï¼Œä¸€å®šçŸ¥é“å®é™…ä¸Šå ç”¨çš„æ˜¯å †å†…å­˜ï¼Œè€Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªç›´æ¥ç¼“å†²åŒºï¼Œä¹Ÿå°±æ˜¯ç”³è¯·å †å¤–å†…å­˜è¿›è¡Œæ•°æ®ä¿å­˜ï¼Œé‡‡ç”¨æ“ä½œç³»ç»Ÿæœ¬åœ°çš„IOï¼Œç›¸æ¯”å †ç¼“å†²åŒºä¼šå¿«ä¸€äº›ã€‚\né‚£ä¹ˆæ€ä¹ˆä½¿ç”¨ç›´æ¥ç¼“å†²åŒºå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ allocateDirectæ–¹æ³•æ¥åˆ›å»ºï¼š\npublic static void main(String[] args) { //è¿™é‡Œæˆ‘ä»¬ç”³è¯·ä¸€ä¸ªç›´æ¥ç¼“å†²åŒº ByteBuffer buffer = ByteBuffer.allocateDirect(10); //ä½¿ç”¨æ–¹å¼åŸºæœ¬å’Œä¹‹å‰æ˜¯ä¸€æ ·çš„ buffer.put((byte) 66); buffer.flip(); System.out.println(buffer.get()); } æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ª allocateDirectæ–¹æ³•æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªç›´æ¥ç¼“å†²åŒºçš„ï¼š\npublic static ByteBuffer allocateDirect(int capacity) { return new DirectByteBuffer(capacity); } è¿™ä¸ªæ–¹æ³•ç›´æ¥åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„DirectByteBufferå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»åˆæ˜¯æ€ä¹ˆè¿›è¡Œåˆ›å»ºçš„å‘¢ï¼Ÿ\nå¯ä»¥çœ‹åˆ°å®ƒå¹¶ä¸æ˜¯ç›´æ¥ç»§æ‰¿è‡ªByteBufferï¼Œè€Œæ˜¯MappedByteBufferï¼Œå¹¶ä¸”å®ç°äº†æ¥å£DirectBufferï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ªæ¥å£ï¼š\npublic interface DirectBuffer { public long address(); //è·å–å†…å­˜åœ°å€ public Object attachment(); //é™„åŠ å¯¹è±¡ï¼Œè¿™æ˜¯ä¸ºäº†ä¿è¯æŸäº›æƒ…å†µä¸‹å†…å­˜ä¸è¢«é‡Šæ”¾ï¼Œæˆ‘ä»¬åé¢ç»†è°ˆ public Cleaner cleaner(); //å†…å­˜æ¸…ç†ç±» } public abstract class MappedByteBuffer extends ByteBuffer { //è¿™ä¸‰ä¸ªæ–¹æ³•ç›®å‰æš‚æ—¶ç”¨ä¸åˆ°ï¼Œåé¢æ–‡ä»¶å†è¯´ public final MappedByteBuffer load(); public final boolean isLoaded(); public final MappedByteBuffer force(); } æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹DirectByteBufferç±»çš„æˆå‘˜å˜é‡ï¼š\n// æŠŠUnsafeç±»å–å‡ºæ¥ protected static final Unsafe unsafe = Bits.unsafe(); // åœ¨å†…å­˜ä¸­ç›´æ¥åˆ›å»ºçš„å†…å­˜ç©ºé—´åœ°å€ private static final long arrayBaseOffset = (long)unsafe.arrayBaseOffset(byte[].class); // æ˜¯å¦å…·æœ‰éå¯¹é½è®¿é—®èƒ½åŠ›ï¼Œæ ¹æ®CPUæ¶æ„è€Œå®šï¼Œintelã€AMDã€AppleSilicon éƒ½æ˜¯æ”¯æŒçš„ protected static final boolean unaligned = Bits.unaligned(); // ç›´æ¥ç¼“å†²åŒºçš„å†…å­˜åœ°å€ï¼Œä¸ºäº†æå‡é€Ÿåº¦å°±æ”¾åˆ°Bufferç±»ä¸­å»äº† // protected long address; // é™„åŠ å¯¹è±¡ï¼Œä¸€ä¼šæœ‰å¤§ä½œç”¨ private final Object att; æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹æ„é€ æ–¹æ³•ï¼š\nDirectByteBuffer(int cap) { // package-private super(-1, 0, cap, cap); boolean pa = VM.isDirectMemoryPageAligned(); //æ˜¯å¦ç›´æ¥å†…å­˜åˆ†é¡µå¯¹é½ï¼Œéœ€è¦é¢å¤–è®¡ç®— int ps = Bits.pageSize(); long size = Math.max(1L, (long)cap + (pa ? ps : 0)); //è®¡ç®—å‡ºæœ€ç»ˆéœ€è¦ç”³è¯·çš„å¤§å° //åˆ¤æ–­å †å¤–å†…å­˜æ˜¯å¦è¶³å¤Ÿï¼Œå¤Ÿçš„è¯å°±ä½œä¸ºä¿ç•™å†…å­˜ Bits.reserveMemory(size, cap); long base = 0; try { //é€šè¿‡Unsafeç”³è¯·å†…å­˜ç©ºé—´ï¼Œå¹¶å¾—åˆ°å†…å­˜åœ°å€ base = unsafe.allocateMemory(size); } catch (OutOfMemoryError x) { //ç”³è¯·å¤±è´¥å°±å–æ¶ˆä¸€å¼€å§‹çš„ä¿ç•™å†…å­˜ Bits.unreserveMemory(size, cap); throw x; } //æ‰¹é‡å°†ç”³è¯·åˆ°çš„è¿™ä¸€æ®µå†…å­˜æ¯ä¸ªå­—èŠ‚éƒ½è®¾å®šä¸º0 unsafe.setMemory(base, size, (byte) 0); if (pa \u0026amp;\u0026amp; (base % ps != 0)) { // Round up to page boundary address = base + ps - (base \u0026amp; (ps - 1)); } else { //å°†addresså˜é‡ï¼ˆåœ¨Bufferä¸­å®šä¹‰ï¼‰è®¾å®šä¸ºbaseçš„åœ°å€ address = base; } //åˆ›å»ºä¸€ä¸ªé’ˆå¯¹äºæ­¤ç¼“å†²åŒºçš„Cleanerï¼Œç”±äºæ˜¯å †å¤–å†…å­˜ï¼Œæ‰€ä»¥ç°åœ¨ç”±å®ƒæ¥è¿›è¡Œå†…å­˜æ¸…ç† cleaner = Cleaner.create(this, new Deallocator(base, size, cap)); att = null; } å¯ä»¥çœ‹åˆ°åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œæ˜¯ç›´æ¥é€šè¿‡Unsafeç±»æ¥ç”³è¯·è¶³å¤Ÿçš„å †å¤–å†…å­˜ä¿å­˜æ•°æ®ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ä¸ä½¿ç”¨æ­¤ç¼“å†²åŒºæ—¶ï¼Œå†…å­˜ä¼šè¢«å¦‚ä½•æ¸…ç†å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªCleanerï¼š\npublic class Cleaner extends PhantomReference\u0026lt;Object\u0026gt;{ //ç»§æ‰¿è‡ªé¬¼å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤å¯¹è±¡ä¼šå­˜æ”¾ä¸€ä¸ªæ²¡æœ‰ä»»ä½•å¼•ç”¨çš„å¯¹è±¡ //å¼•ç”¨é˜Ÿåˆ—ï¼ŒPhantomReferenceæ„é€ æ–¹æ³•éœ€è¦ private static final ReferenceQueue\u0026lt;Object\u0026gt; dummyQueue = new ReferenceQueue\u0026lt;\u0026gt;(); //æ‰§è¡Œæ¸…ç†çš„å…·ä½“æµç¨‹ private final Runnable thunk; static private Cleaner first = null; //CleaneråŒå‘é“¾è¡¨ï¼Œæ¯åˆ›å»ºä¸€ä¸ªCleanerå¯¹è±¡éƒ½ä¼šæ·»åŠ ä¸€ä¸ªç»“ç‚¹ private Cleaner next = null, prev = null; private static synchronized Cleaner add(Cleaner cl) { //æ·»åŠ æ“ä½œä¼šè®©æ–°æ¥çš„å˜æˆæ–°çš„å¤´ç»“ç‚¹ if (first != null) { cl.next = first; first.prev = cl; } first = cl; return cl; } //å¯ä»¥çœ‹åˆ°åˆ›å»ºé¬¼å¼•ç”¨çš„å¯¹è±¡å°±æ˜¯ä¼ è¿›çš„ç¼“å†²åŒºå¯¹è±¡ private Cleaner(Object referent, Runnable thunk) { super(referent, dummyQueue); //æ¸…ç†æµç¨‹å®é™…ä¸Šæ˜¯å¤–é¢çš„Deallocator this.thunk = thunk; } //é€šè¿‡æ­¤æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„Cleaner public static Cleaner create(Object ob, Runnable thunk) { if (thunk == null) return null; return add(new Cleaner(ob, thunk)); //è°ƒç”¨addæ–¹æ³•å°†Cleaneræ·»åŠ åˆ°é˜Ÿåˆ— } //æ¸…ç†æ“ä½œ public void clean() { if (!remove(this)) return; //è¿›è¡Œæ¸…ç†æ“ä½œæ—¶ä¼šä»åŒå‘é˜Ÿåˆ—ä¸­ç§»é™¤å½“å‰Cleanerï¼Œfalseè¯´æ˜å·²ç»ç§»é™¤è¿‡äº†ï¼Œç›´æ¥return try { thunk.run(); //è¿™é‡Œå°±æ˜¯ç›´æ¥æ‰§è¡Œå…·ä½“æ¸…ç†æµç¨‹ } catch (final Throwable x) { ... } } é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å…·ä½“çš„æ¸…ç†ç¨‹åºåœ¨åšäº›ä»€ä¹ˆï¼ŒDeallocatoræ˜¯åœ¨ç›´æ¥ç¼“å†²åŒºä¸­å£°æ˜çš„ï¼š\nprivate static class Deallocator implements Runnable { private static Unsafe unsafe = Unsafe.getUnsafe(); private long address; //å†…å­˜åœ°å€ private long size; //å¤§å° private int capacity; //ç”³è¯·çš„å®¹é‡ private Deallocator(long address, long size, int capacity) { assert (address != 0); this.address = address; this.size = size; this.capacity = capacity; } public void run() { //å…·ä½“çš„æ¸…ç†æ“ä½œ if (address == 0) { // Paranoia return; } unsafe.freeMemory(address); //è¿™é‡Œæ˜¯ç›´æ¥è°ƒç”¨äº†Unsafeè¿›è¡Œå†…å­˜é‡Šæ”¾æ“ä½œ address = 0; //å†…å­˜åœ°å€æ”¹ä¸º0ï¼ŒNULL Bits.unreserveMemory(size, capacity); //å–æ¶ˆä¸€å¼€å§‹çš„ä¿ç•™å†…å­˜ } } å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ˜ç¡®åœ¨æ¸…ç†çš„æ—¶å€™å®é™…ä¸Šä¹Ÿæ˜¯è°ƒç”¨Unsafeç±»è¿›è¡Œå†…å­˜é‡Šæ”¾æ“ä½œï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªæ¸…ç†æ“ä½œå…·ä½“æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™è¿›è¡Œçš„å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬è¦æ˜ç¡®ï¼Œå¦‚æœæ˜¯æ™®é€šçš„å †ç¼“å†²åŒºï¼Œç”±äºä½¿ç”¨çš„æ•°ç»„ï¼Œé‚£ä¹ˆä¸€æ—¦æ­¤å¯¹è±¡æ²¡æœ‰ä»»ä½•å¼•ç”¨æ—¶ï¼Œå°±éšæ—¶éƒ½ä¼šè¢«GCç»™å›æ”¶æ‰ï¼Œä½†æ˜¯ç°åœ¨æ˜¯å †å¤–å†…å­˜ï¼Œåªèƒ½æˆ‘ä»¬æ‰‹åŠ¨è¿›è¡Œå†…å­˜å›æ”¶ï¼Œé‚£ä¹ˆå½“DirectByteBufferä¹Ÿå¤±å»å¼•ç”¨æ—¶ï¼Œä¼šä¸ä¼šè§¦å‘å†…å­˜å›æ”¶å‘¢ï¼Ÿ\nç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œè¿˜è®°å¾—æˆ‘ä»¬åˆšåˆšçœ‹åˆ°Cleaneræ˜¯PhantomReferenceçš„å­ç±»å—ï¼Œè€ŒDirectByteBufferæ˜¯è¢«é¬¼å¼•ç”¨çš„å¯¹è±¡ï¼Œè€Œå…·ä½“çš„æ¸…ç†æ“ä½œæ˜¯Cleanerç±»çš„cleanæ–¹æ³•ï¼Œè«éè¿™ä¸¤è€…æœ‰ä»€ä¹ˆè”ç³»å—ï¼Ÿ\nä½ åˆ«è¯´ï¼Œè¿˜çœŸæœ‰ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹åˆ°PhantomReferenceçš„çˆ¶ç±»Referenceï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™æ ·ä¸€ä¸ªç±»ï¼š\nprivate static class ReferenceHandler extends Thread { ... static { // é¢„åŠ è½½å¹¶åˆå§‹åŒ– InterruptedException å’Œ Cleaner ç±» // ä»¥é¿å…å‡ºç°åœ¨å¾ªç¯è¿è¡Œè¿‡ç¨‹ä¸­æ—¶ç”±äºå†…å­˜ä¸è¶³è€Œæ— æ³•åŠ è½½ ensureClassInitialized(InterruptedException.class); ensureClassInitialized(Cleaner.class); } public void run() { while (true) { tryHandlePending(true); //è¿™é‡Œæ˜¯ä¸€ä¸ªæ— é™å¾ªç¯è°ƒç”¨tryHandlePendingæ–¹æ³• } } } private T referent; /* ä¼šè¢«GCå›æ”¶çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»™è¿‡æ¥è¢«å¼•ç”¨çš„å¯¹è±¡ */ volatile ReferenceQueue\u0026lt;? super T\u0026gt; queue; //å¼•ç”¨é˜Ÿåˆ—ï¼Œå¯ä»¥å’Œä¸‹é¢çš„nextæ­é…ä½¿ç”¨ï¼Œå½¢æˆé“¾è¡¨ //Referenceå¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªä¸€ä¸ªè¿èµ·æ¥çš„èŠ‚ç‚¹ï¼Œè¿™æ ·æ‰èƒ½æ”¾åˆ°ReferenceQueueä¸­å½¢æˆé“¾è¡¨ volatile Reference next; //å³å°†è¢«GCçš„å¼•ç”¨é“¾è¡¨ transient private Reference\u0026lt;T\u0026gt; discovered; /* ç”±è™šæ‹Ÿæœºæ“ä½œ */ //pendingä¸discoveredä¸€èµ·æ„æˆäº†ä¸€ä¸ªpendingå•å‘é“¾è¡¨ï¼Œæ ‡è®°ä¸ºstaticç±»æ‰€æœ‰ï¼Œpendingä¸ºé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œdiscoveredä¸ºé“¾è¡¨å½“å‰ //ReferenceèŠ‚ç‚¹æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè¿™ä¸ªé˜Ÿåˆ—æ˜¯ç”±JVMæ„å»ºçš„ï¼Œå½“å¯¹è±¡é™¤äº†è¢«referenceå¼•ç”¨ä¹‹å¤–æ²¡æœ‰å…¶å®ƒå¼ºå¼•ç”¨äº†ï¼ŒJVMå°±ä¼šå°†æŒ‡å‘ //éœ€è¦å›æ”¶çš„å¯¹è±¡çš„Referenceå¯¹è±¡éƒ½æ”¾å…¥åˆ°è¿™ä¸ªé˜Ÿåˆ—é‡Œé¢ï¼Œè¿™ä¸ªé˜Ÿåˆ—ä¼šç”±ä¸‹é¢çš„ Reference Hander çº¿ç¨‹æ¥å¤„ç†ã€‚ private static Reference\u0026lt;Object\u0026gt; pending = null; static { //Referenceç±»çš„é™æ€ä»£ç å— ThreadGroup tg = Thread.currentThread().getThreadGroup(); for (ThreadGroup tgn = tg; tgn != null; tg = tgn, tgn = tg.getParent()); Thread handler = new ReferenceHandler(tg, \u0026#34;Reference Handler\u0026#34;); //åœ¨ä¸€å¼€å§‹çš„æ—¶å€™å°±ä¼šåˆ›å»º handler.setPriority(Thread.MAX_PRIORITY); //ä»¥æœ€é«˜ä¼˜å…ˆçº§å¯åŠ¨ handler.setDaemon(true); //æ­¤çº¿ç¨‹ç›´æ¥ä½œä¸ºä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ handler.start(); //ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€å¼€å§‹çš„æ—¶å€™è¿™ä¸ªå®ˆæŠ¤çº¿ç¨‹å°±ä¼šå¯åŠ¨ ... } é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´Reference Handlerçº¿ç¨‹æ˜¯åœ¨ä¸€å¼€å§‹å°±å¯åŠ¨äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å…³æ³¨ç‚¹å¯ä»¥æ”¾åœ¨ tryHandlePendingæ–¹æ³•ä¸Šï¼Œçœ‹çœ‹è¿™ç©æ„åˆ°åº•åœ¨åšä¸ªå•¥ï¼š\nstatic boolean tryHandlePending(boolean waitForNotify) { Reference\u0026lt;Object\u0026gt; r; Cleaner c; try { synchronized (lock) { //åŠ é”åŠäº‹ //å½“Cleanerå¼•ç”¨çš„DirectByteBufferå¯¹è±¡å³å°†è¢«å›æ”¶æ—¶ï¼Œpendingä¼šå˜æˆæ­¤Cleanerå¯¹è±¡ //è¿™é‡Œåˆ¤æ–­åˆ°pendingä¸ä¸ºnullæ—¶å°±éœ€è¦å¤„ç†ä¸€ä¸‹å¯¹è±¡é”€æ¯äº† if (pending != null) { r = pending; // \u0026#39;instanceof\u0026#39; æœ‰æ—¶ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºï¼Œæ‰€ä»¥å°†rä»é“¾è¡¨ä¸­ç§»é™¤ä¹‹å‰å°±è¿›è¡Œç±»å‹åˆ¤æ–­ // å¦‚æœæ˜¯Cleanerç±»å‹å°±ç»™åˆ°c c = r instanceof Cleaner ? (Cleaner) r : null; // å°†pendingæ›´æ–°ä¸ºé“¾è¡¨ä¸‹ä¸€ä¸ªå¾…å›æ”¶å…ƒç´  pending = r.discovered; r.discovered = null; //rä¸å†å¼•ç”¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ } else { //å¦åˆ™å°±è¿›å…¥ç­‰å¾… if (waitForNotify) { lock.wait(); } return waitForNotify; } } } catch (OutOfMemoryError x) { Thread.yield(); return true; } catch (InterruptedException x) { return true; } // å¦‚æœå…ƒç´ æ˜¯Cleanerç±»å‹ï¼Œcåœ¨ä¸Šé¢å°±ä¼šè¢«èµ‹å€¼ï¼Œè¿™é‡Œå°±ä¼šæ‰§è¡Œå…¶cleanæ–¹æ³•ï¼ˆç ´æ¡ˆäº†ï¼‰ if (c != null) { c.clean(); return true; } ReferenceQueue\u0026lt;? super Object\u0026gt; q = r.queue; if (q != ReferenceQueue.NULL) q.enqueue(r); //è¿™ä¸ªæ˜¯å¼•ç”¨é˜Ÿåˆ—ï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬ä¹‹å‰åœ¨JVMç¯‡ä¸­è®²è§£çš„å…¥é˜Ÿæœºåˆ¶ return true; } é€šè¿‡å¯¹æºç çš„è§£è¯»ï¼Œæˆ‘ä»¬å°±äº†è§£äº†ç›´æ¥ç¼“å†²åŒºçš„å†…å­˜åŠ è½½é‡Šæ”¾æ•´ä¸ªæµç¨‹ã€‚å’Œå †ç¼“å†²åŒºä¸€æ ·ï¼Œå½“ç›´æ¥ç¼“å†²åŒºæ²¡æœ‰ä»»ä½•å¼ºå¼•ç”¨æ—¶ï¼Œå°±æœ‰æœºä¼šè¢«GCæ­£å¸¸å›æ”¶æ‰å¹¶è‡ªåŠ¨é‡Šæ”¾ç”³è¯·çš„å†…å­˜ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹ç›´æ¥ç¼“å†²åŒºçš„è¯»å†™æ“ä½œæ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼š\npublic byte get() { return ((unsafe.getByte(ix(nextGetIndex())))); //ç›´æ¥é€šè¿‡Unsafeç±»è¯»å–å¯¹åº”åœ°å€ä¸Šçš„byteæ•°æ® } private long ix(int i) { return address + ((long)i \u0026lt;\u0026lt; 0); //ixç°åœ¨æ˜¯å†…å­˜åœ°å€å†åŠ ä¸Ši } æˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹å†™æ“ä½œï¼š\npublic ByteBuffer put(byte x) { unsafe.putByte(ix(nextPutIndex()), ((x))); return this; } å¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯è¯»å–è¿˜æ˜¯å†™å…¥æ“ä½œéƒ½æ˜¯é€šè¿‡Unsafeç±»æ“ä½œå¯¹åº”çš„å†…å­˜åœ°å€å®Œæˆçš„ã€‚\né‚£ä¹ˆå®ƒçš„å¤åˆ¶æ“ä½œæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ\npublic ByteBuffer duplicate() { return new DirectByteBuffer(this, this.markValue(), this.position(), this.limit(), this.capacity(), 0); } DirectByteBuffer(DirectBuffer db, // è¿™é‡Œç»™çš„dbæ˜¯è¿›è¡Œå¤åˆ¶æ“ä½œçš„DirectByteBufferå¯¹è±¡ int mark, int pos, int lim, int cap, int off) { super(mark, pos, lim, cap); address = db.address() + off; //ç›´æ¥ç»§ç»­ä½¿ç”¨ä¹‹å‰ç”³è¯·çš„å†…å­˜ç©ºé—´ cleaner = null; //å› ä¸ºç”¨çš„æ˜¯ä¹‹å‰çš„å†…å­˜ç©ºé—´ï¼Œå·²ç»æœ‰å¯¹åº”çš„Cleaneräº†ï¼Œè¿™é‡Œä¸éœ€è¦å†æä¸€ä¸ª att = db; //å°†attè®¾å®šä¸ºæ­¤å¯¹è±¡ } å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ˜¯è¿›è¡Œå¤åˆ¶æ“ä½œï¼Œé‚£ä¹ˆä¼šç›´æ¥ä¼šç»§ç»­ä½¿ç”¨æ‰§è¡Œå¤åˆ¶æ“ä½œçš„DirectByteBufferç”³è¯·çš„å†…å­˜ç©ºé—´ã€‚ä¸çŸ¥é“å„ä½æ˜¯å¦èƒ½å¤Ÿé©¬ä¸Šè”æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœæ‰§è¡Œå¤åˆ¶æ“ä½œçš„DirectByteBufferå¯¹è±¡å¤±å»äº†å¼ºå¼•ç”¨è¢«å›æ”¶ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘Cleanerå¹¶è¿›è¡Œå†…å­˜é‡Šæ”¾ï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œè¿™æ®µå†…å­˜ç©ºé—´å¯èƒ½å¤åˆ¶å‡ºæ¥çš„DirectByteBufferå¯¹è±¡è¿˜éœ€è¦ç»§ç»­ä½¿ç”¨ï¼Œè¿™æ—¶è‚¯å®šæ˜¯ä¸èƒ½è¿›è¡Œå›æ”¶çš„ï¼Œæ‰€ä»¥è¯´è¿™é‡Œä½¿ç”¨äº†attå˜é‡å°†ä¹‹å‰çš„DirectByteBufferå¯¹è±¡è¿›è¡Œå¼•ç”¨ï¼Œä»¥é˜²æ­¢å…¶å¤±å»å¼ºå¼•ç”¨è¢«åƒåœ¾å›æ”¶ï¼Œæ‰€ä»¥åªè¦ä¸æ˜¯åŸæ¥çš„DirectByteBufferå¯¹è±¡å’Œå¤åˆ¶å‡ºæ¥çš„DirectByteBufferå¯¹è±¡éƒ½å¤±å»å¼ºå¼•ç”¨æ—¶ï¼Œå°±ä¸ä¼šå¯¼è‡´è¿™æ®µå†…å­˜ç©ºé—´è¢«å›æ”¶ã€‚\nè¿™æ ·ï¼Œæˆ‘ä»¬ä¹‹å‰çš„æœªè§£ä¹‹è°œä¸ºå•¥æœ‰ä¸ª attä¹Ÿå°±å¾—åˆ°ç­”æ¡ˆäº†ï¼Œæœ‰å…³ç›´æ¥ç¼“å†²åŒºçš„ä»‹ç»ï¼Œå°±åˆ°è¿™é‡Œä¸ºæ­¢ã€‚\né€šé“ #\rå‰é¢æˆ‘ä»¬å­¦ä¹ äº†NIOçš„åŸºçŸ³â€”â€”ç¼“å†²åŒºï¼Œé‚£ä¹ˆç¼“å†²åŒºå…·ä½“ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Œåœ¨æœ¬æ¿å—æˆ‘ä»¬å­¦ä¹ é€šé“ä¹‹åï¼Œç›¸ä¿¡å„ä½å°±èƒ½çŸ¥é“äº†ã€‚é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯é€šé“å‘¢ï¼Ÿ\nåœ¨ä¼ ç»ŸIOä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡æµè¿›è¡Œä¼ è¾“ï¼Œæ•°æ®ä¼šæºæºä¸æ–­ä»æµä¸­ä¼ å‡ºï¼›è€Œåœ¨NIOä¸­ï¼Œæ•°æ®æ˜¯æ”¾åœ¨ç¼“å†²åŒºä¸­è¿›è¡Œç®¡ç†ï¼Œå†ä½¿ç”¨é€šé“å°†ç¼“å†²åŒºä¸­çš„æ•°æ®ä¼ è¾“åˆ°ç›®çš„åœ°ã€‚\né€šé“æ¥å£å±‚æ¬¡ #\ré€šé“çš„æ ¹åŸºæ¥å£æ˜¯ Channelï¼Œæ‰€æœ‰çš„æ´¾ç”Ÿæ¥å£å’Œç±»éƒ½æ˜¯ä»è¿™é‡Œå¼€å§‹çš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒå®šä¹‰äº†å“ªäº›åŸºæœ¬åŠŸèƒ½ï¼š\npublic interface Channel extends Closeable { //é€šé“æ˜¯å¦å¤„äºå¼€å¯çŠ¶æ€ public boolean isOpen(); //å› ä¸ºé€šé“å¼€å¯ä¹Ÿéœ€è¦å…³é—­ï¼Œæ‰€ä»¥å®ç°äº†Closeableæ¥å£ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ‡‚çš„éƒ½æ‡‚ public void close() throws IOException; } æˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹å®ƒçš„ä¸€äº›å­æ¥å£ï¼Œé¦–å…ˆæ˜¯æœ€åŸºæœ¬çš„è¯»å†™æ“ä½œï¼š\npublic interface ReadableByteChannel extends Channel { //å°†é€šé“ä¸­çš„æ•°æ®è¯»å–åˆ°ç»™å®šçš„ç¼“å†²åŒºä¸­ public int read(ByteBuffer dst) throws IOException; } public interface WritableByteChannel extends Channel { //å°†ç»™å®šç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ°é€šé“ä¸­ public int write(ByteBuffer src) throws IOException; } æœ‰äº†è¯»å†™åŠŸèƒ½åï¼Œæœ€åæ•´åˆä¸ºäº†ä¸€ä¸ªByteChannelæ¥å£ï¼š\npublic interface ByteChannel extends ReadableByteChannel, WritableByteChannel{ } åœ¨ByteChannelä¹‹ä¸‹ï¼Œè¿˜æœ‰æ›´å¤šçš„æ´¾ç”Ÿæ¥å£ï¼š\n//å…è®¸ä¿ç•™positionå’Œæ›´æ”¹positionçš„é€šé“ï¼Œä»¥åŠå¯¹é€šé“è¿æ¥å®ä½“çš„ç›¸å…³æ“ä½œ public interface SeekableByteChannel extends ByteChannel { ... //è·å–å½“å‰çš„position long position() throws IOException; //ä¿®æ”¹å½“å‰çš„position SeekableByteChannel position(long newPosition) throws IOException; //è¿”å›æ­¤é€šé“è¿æ¥åˆ°çš„å®ä½“ï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰çš„å½“å‰å¤§å° long size() throws IOException; //å°†æ­¤é€šé“è¿æ¥åˆ°çš„å®ä½“æˆªæ–­ï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼Œæˆªæ–­ä¹‹åï¼Œæ–‡ä»¶åé¢ä¸€åŠå°±æ²¡äº†ï¼‰ä¸ºç»™å®šå¤§å° SeekableByteChannel truncate(long size) throws IOException; } æ¥ç€æˆ‘ä»¬æ¥çœ‹ï¼Œé™¤äº†è¯»å†™ä¹‹å¤–ï¼ŒChannelè¿˜å¯ä»¥å…·æœ‰å“åº”ä¸­æ–­çš„èƒ½åŠ›ï¼š\npublic interface InterruptibleChannel extends Channel { //å½“å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œåœ¨æ­¤é€šé“ä¸Šå¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹ä¼šç›´æ¥æŠ›å‡º AsynchronousCloseException å¼‚å¸¸ public void close() throws IOException; } //è¿™æ˜¯InterruptibleChannelçš„æŠ½è±¡å®ç°ï¼Œå®Œæˆäº†ä¸€éƒ¨åˆ†åŠŸèƒ½ public abstract class AbstractInterruptibleChannel implements Channel, InterruptibleChannel { //åŠ é”å…³é—­æ“ä½œç”¨åˆ° private final Object closeLock = new Object(); //å½“å‰Channelçš„å¼€å¯çŠ¶æ€ private volatile boolean open = true; protected AbstractInterruptibleChannel() { } //å…³é—­æ“ä½œå®ç° public final void close() throws IOException { synchronized (closeLock) { //åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ­¤æ“ä½œï¼ŒåŠ é” if (!open) //å¦‚æœå·²ç»å…³é—­äº†ï¼Œé‚£ä¹ˆå°±ä¸ç”¨ç»§ç»­äº† return; open = false; //å¼€å¯çŠ¶æ€å˜æˆfalse implCloseChannel(); //å¼€å§‹å…³é—­é€šé“ } } //è¯¥æ–¹æ³•ç”± close æ–¹æ³•è°ƒç”¨ï¼Œä»¥æ‰§è¡Œå…³é—­é€šé“çš„å…·ä½“æ“ä½œï¼Œä»…å½“é€šé“å°šæœªå…³é—­æ—¶æ‰è°ƒç”¨æ­¤æ–¹æ³•ï¼Œä¸ä¼šå¤šæ¬¡è°ƒç”¨ã€‚ protected abstract void implCloseChannel() throws IOException; public final boolean isOpen() { return open; } //å¼€å§‹é˜»å¡ï¼ˆæœ‰å¯èƒ½ä¸€ç›´é˜»å¡ä¸‹å»ï¼‰æ“ä½œä¹‹å‰ï¼Œéœ€è¦è°ƒç”¨æ­¤æ–¹æ³•è¿›è¡Œæ ‡è®°ï¼Œ protected final void begin() { ... } //é˜»å¡æ“ä½œç»“æŸä¹‹åï¼Œä¹Ÿéœ€è¦éœ€è¦è°ƒç”¨æ­¤æ–¹æ³•ï¼Œä¸ºäº†é˜²æ­¢å¼‚å¸¸æƒ…å†µå¯¼è‡´æ­¤æ–¹æ³•æ²¡æœ‰è¢«è°ƒç”¨ï¼Œå»ºè®®æ”¾åœ¨finallyä¸­ protected final void end(boolean completed) ... } ... } è€Œä¹‹åçš„ä¸€äº›å®ç°ç±»ï¼Œéƒ½æ˜¯åŸºäºè¿™äº›æ¥å£å®šä¹‰çš„æ–¹æ³•å»è¿›è¡Œå®ç°çš„ï¼Œæ¯”å¦‚FileChannelï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¤§è‡´äº†è§£äº†ä¸€ä¸‹é€šé“ç›¸å…³çš„æ¥å£å®šä¹‰ï¼Œé‚£ä¹ˆæˆ‘æ¥çœ‹çœ‹å…·ä½“æ˜¯å¦‚ä½•å¦‚ä½•ä½¿ç”¨çš„ã€‚\næ¯”å¦‚ç°åœ¨æˆ‘ä»¬è¦å®ç°ä»è¾“å…¥æµä¸­è¯»å–æ•°æ®ç„¶åæ‰“å°å‡ºæ¥ï¼Œé‚£ä¹ˆä¹‹å‰ä¼ ç»ŸIOçš„å†™æ³•ï¼š\npublic static void main(String[] args) throws IOException { //æ•°ç»„åˆ›å»ºå¥½ï¼Œä¸€ä¼šç”¨æ¥å­˜æ”¾ä»æµä¸­è¯»å–åˆ°çš„æ•°æ® byte[] data = new byte[10]; //ç›´æ¥ä½¿ç”¨è¾“å…¥æµ InputStream in = System.in; while (true) { int len; while ((len = in.read(data)) \u0026gt;= 0) { //å°†è¾“å…¥æµä¸­çš„æ•°æ®ä¸€æ¬¡æ€§è¯»å–åˆ°æ•°ç»„ä¸­ System.out.print(\u0026#34;è¯»å–åˆ°ä¸€æ‰¹æ•°æ®ï¼š\u0026#34;+new String(data, 0, len)); //è¯»å–äº†å¤šå°‘æ‰“å°å¤šå°‘ } } } è€Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨é€šé“ä¹‹åï¼š\npublic static void main(String[] args) throws IOException { //ç¼“å†²åŒºåˆ›å»ºå¥½ï¼Œä¸€ä¼šå°±é å®ƒæ¥ä¼ è¾“æ•°æ® ByteBuffer buffer = ByteBuffer.allocate(10); //å°†System.inä½œä¸ºè¾“å…¥æºï¼Œä¸€ä¼šChannelå°±å¯ä»¥ä»è¿™é‡Œè¯»å–æ•°æ®ï¼Œç„¶åé€šè¿‡ç¼“å†²åŒºè£…è½½ä¸€æ¬¡æ€§ä¼ é€’æ•°æ® ReadableByteChannel readChannel = Channels.newChannel(System.in); while (true) { //å°†é€šé“ä¸­çš„æ•°æ®å†™åˆ°ç¼“å†²åŒºä¸­ï¼Œç¼“å†²åŒºæœ€å¤šä¸€æ¬¡è£…10ä¸ª readChannel.read(buffer); //å†™å…¥æ“ä½œç»“æŸä¹‹åï¼Œéœ€è¦è¿›è¡Œç¿»è½¬ï¼Œä»¥ä¾¿æ¥ä¸‹æ¥çš„è¯»å–æ“ä½œ buffer.flip(); //æœ€åè½¬æ¢æˆStringæ‰“å°å‡ºæ¥åº·åº· System.out.println(\u0026#34;è¯»å–åˆ°ä¸€æ‰¹æ•°æ®ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); //å›åˆ°æœ€å¼€å§‹çš„çŠ¶æ€ buffer.clear(); } } ä¹ä¸€çœ‹ï¼Œå¥½åƒæ„Ÿè§‰ä¹Ÿæ²¡å•¥åŒºåˆ«ï¼Œä¸å°±æ˜¯æŠŠæ•°ç»„æ¢æˆç¼“å†²åŒºäº†å—ï¼Œæ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ•°æ®ä¹Ÿæ˜¯ä»Channelä¸­è¯»å–å¾—åˆ°ï¼Œå¹¶ä¸”é€šè¿‡ç¼“å†²åŒºè¿›è¡Œæ•°æ®è£…è½½ç„¶åå¾—åˆ°ç»“æœï¼Œä½†æ˜¯ï¼ŒChannelä¸åƒæµé‚£æ ·æ˜¯å•å‘çš„ï¼Œå®ƒå°±åƒå®ƒçš„åå­—ä¸€æ ·ï¼Œä¸€ä¸ªé€šé“å¯ä»¥ä»ä¸€ç«¯èµ°åˆ°å¦ä¸€ç«¯ï¼Œä¹Ÿå¯ä»¥ä»å¦ä¸€ç«¯èµ°åˆ°è¿™ä¸€ç«¯ï¼Œæˆ‘ä»¬åé¢è¿›è¡Œä»‹ç»ã€‚\næ–‡ä»¶ä¼ è¾“FileChannel #\rå‰é¢æˆ‘ä»¬ä»‹ç»äº†é€šé“çš„åŸºæœ¬æƒ…å†µï¼Œè¿™é‡Œæˆ‘ä»¬å°±æ¥å°è¯•å®ç°ä¸€ä¸‹æ–‡ä»¶çš„è¯»å–å’Œå†™å…¥ï¼Œåœ¨ä¼ ç»ŸIOä¸­ï¼Œæ–‡ä»¶çš„å†™å…¥å’Œè¾“å‡ºéƒ½æ˜¯ä¾é FileOutputStreamå’ŒFileInputStreamæ¥å®Œæˆçš„ï¼š\npublic static void main(String[] args) throws IOException { try(FileOutputStream out = new FileOutputStream(\u0026#34;test.txt\u0026#34;); FileInputStream in = new FileInputStream(\u0026#34;test.txt\u0026#34;)){ String data = \u0026#34;ä¼å…µä¸€å·å¢æœ¬ä¼Ÿå‡†å¤‡å°±ç»ªï¼\u0026#34;; out.write(data.getBytes()); //å‘æ–‡ä»¶çš„è¾“å‡ºæµä¸­å†™å…¥æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æŠŠæ•°æ®å†™åˆ°æ–‡ä»¶ä¸­ out.flush(); byte[] bytes = new byte[in.available()]; in.read(bytes); //ä»æ–‡ä»¶çš„è¾“å…¥æµä¸­è¯»å–æ–‡ä»¶çš„ä¿¡æ¯ System.out.println(new String(bytes)); } } è€Œç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡ä¸€ä¸ªFileChannelå°±å¯ä»¥å®Œæˆè¿™ä¸¤è€…çš„æ“ä½œï¼Œè·å–æ–‡ä»¶é€šé“çš„æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š\npublic static void main(String[] args) throws IOException { //1. ç›´æ¥é€šè¿‡è¾“å…¥æˆ–è¾“å‡ºæµè·å–å¯¹åº”çš„é€šé“ FileInputStream in = new FileInputStream(\u0026#34;test.txt\u0026#34;); //ä½†æ˜¯è¿™é‡Œçš„é€šé“åªæ”¯æŒè¯»å–æˆ–æ˜¯å†™å…¥æ“ä½œ FileChannel channel = in.getChannel(); //åˆ›å»ºä¸€ä¸ªå®¹é‡ä¸º128çš„ç¼“å†²åŒº ByteBuffer buffer = ByteBuffer.allocate(128); //ä»é€šé“ä¸­å°†æ•°æ®è¯»å–åˆ°ç¼“å†²åŒºä¸­ channel.read(buffer); //ç¿»è½¬ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥è¦è¯»å–äº† buffer.flip(); System.out.println(new String(buffer.array(), 0, buffer.remaining())); } å¯ä»¥çœ‹åˆ°é€šè¿‡è¾“å…¥æµè·å–çš„æ–‡ä»¶é€šé“è¯»å–æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œä½†æ˜¯å†™å…¥æ“ä½œï¼š\npublic static void main(String[] args) throws IOException { //1. ç›´æ¥é€šè¿‡è¾“å…¥æˆ–è¾“å‡ºæµè·å–å¯¹åº”çš„é€šé“ FileInputStream in = new FileInputStream(\u0026#34;test.txt\u0026#34;); //ä½†æ˜¯è¿™é‡Œçš„é€šé“åªæ”¯æŒè¯»å–æˆ–æ˜¯å†™å…¥æ“ä½œ FileChannel channel = in.getChannel(); //å°è¯•å†™å…¥ä¸€ä¸‹ channel.write(ByteBuffer.wrap(\u0026#34;ä¼å…µä¸€å·å¢æœ¬ä¼Ÿå‡†å¤‡å°±ç»ªï¼\u0026#34;.getBytes())); } ç›´æ¥æŠ¥é”™ï¼Œè¯´æ˜åªæ”¯æŒè¯»å–æ“ä½œï¼Œé‚£ä¹ˆè¾“å‡ºæµå‘¢ï¼Ÿ\npublic static void main(String[] args) throws IOException { //1. ç›´æ¥é€šè¿‡è¾“å…¥æˆ–è¾“å‡ºæµè·å–å¯¹åº”çš„é€šé“ FileOutputStream out = new FileOutputStream(\u0026#34;test.txt\u0026#34;); //ä½†æ˜¯è¿™é‡Œçš„é€šé“åªæ”¯æŒè¯»å–æˆ–æ˜¯å†™å…¥æ“ä½œ FileChannel channel = out.getChannel(); //å°è¯•å†™å…¥ä¸€ä¸‹ channel.write(ByteBuffer.wrap(\u0026#34;ä¼å…µä¸€å·å¢æœ¬ä¼Ÿå‡†å¤‡å°±ç»ªï¼\u0026#34;.getBytes())); } å¯ä»¥çœ‹åˆ°èƒ½å¤Ÿæ­£å¸¸è¿›è¡Œå†™å…¥ï¼Œä½†æ˜¯è¯»å–å‘¢ï¼Ÿ\npublic static void main(String[] args) throws IOException { //1. ç›´æ¥é€šè¿‡è¾“å…¥æˆ–è¾“å‡ºæµè·å–å¯¹åº”çš„é€šé“ FileOutputStream out = new FileOutputStream(\u0026#34;test.txt\u0026#34;); //ä½†æ˜¯è¿™é‡Œçš„é€šé“åªæ”¯æŒè¯»å–æˆ–æ˜¯å†™å…¥æ“ä½œ FileChannel channel = out.getChannel(); ByteBuffer buffer = ByteBuffer.allocate(128); //ä»é€šé“ä¸­å°†æ•°æ®è¯»å–åˆ°ç¼“å†²åŒºä¸­ channel.read(buffer); //ç¿»è½¬ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥è¦è¯»å–äº† buffer.flip(); System.out.println(new String(buffer.array(), 0, buffer.remaining())); } å¯ä»¥çœ‹åˆ°è¾“å‡ºæµç”Ÿæˆçš„Channelåˆä¸æ”¯æŒè¯»å–ï¼Œæ‰€ä»¥è¯´æœ¬è´¨ä¸Šè¿˜æ˜¯ä¿æŒç€è¾“å…¥è¾“å‡ºæµçš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¹‹å‰ä¸æ˜¯è¯´Channelåˆå¯ä»¥è¾“å…¥åˆå¯ä»¥è¾“å‡ºå—ï¼Ÿè¿™é‡Œæˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒç§æ–¹å¼ï¼š\n//RandomAccessFileèƒ½å¤Ÿæ”¯æŒæ–‡ä»¶çš„éšæœºè®¿é—®ï¼Œå¹¶ä¸”å®ç°äº†æ•°æ®æµ public class RandomAccessFile implements DataOutput, DataInput, Closeable { æˆ‘ä»¬å¯ä»¥é€šè¿‡RandomAccessFileæ¥åˆ›å»ºé€šé“ï¼š\npublic static void main(String[] args) throws IOException { /* é€šè¿‡RandomAccessFileè¿›è¡Œåˆ›å»ºï¼Œæ³¨æ„åé¢çš„modeæœ‰å‡ ç§ï¼š r ä»¥åªè¯»çš„æ–¹å¼ä½¿ç”¨ rw è¯»æ“ä½œå’Œå†™æ“ä½œéƒ½å¯ä»¥ rws æ¯å½“è¿›è¡Œå†™æ“ä½œï¼ŒåŒæ­¥çš„åˆ·æ–°åˆ°ç£ç›˜ï¼Œåˆ·æ–°å†…å®¹å’Œå…ƒæ•°æ® rwd æ¯å½“è¿›è¡Œå†™æ“ä½œï¼ŒåŒæ­¥çš„åˆ·æ–°åˆ°ç£ç›˜ï¼Œåˆ·æ–°å†…å®¹ */ try(RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;\u0026#34;)){ } } ç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å®ƒçš„è¯»å†™æ“ä½œï¼š\npublic static void main(String[] args) throws IOException { /* é€šè¿‡RandomAccessFileè¿›è¡Œåˆ›å»ºï¼Œæ³¨æ„åé¢çš„modeæœ‰å‡ ç§ï¼š r ä»¥åªè¯»çš„æ–¹å¼ä½¿ç”¨ rw è¯»æ“ä½œå’Œå†™æ“ä½œéƒ½å¯ä»¥ rws æ¯å½“è¿›è¡Œå†™æ“ä½œï¼ŒåŒæ­¥çš„åˆ·æ–°åˆ°ç£ç›˜ï¼Œåˆ·æ–°å†…å®¹å’Œå…ƒæ•°æ® rwd æ¯å½“è¿›è¡Œå†™æ“ä½œï¼ŒåŒæ­¥çš„åˆ·æ–°åˆ°ç£ç›˜ï¼Œåˆ·æ–°å†…å®¹ */ try(RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;rw\u0026#34;); //è¿™é‡Œè®¾å®šä¸ºæ”¯æŒè¯»å†™ï¼Œè¿™æ ·åˆ›å»ºçš„é€šé“æ‰èƒ½å…·æœ‰è¿™äº›åŠŸèƒ½ FileChannel channel = f.getChannel()){ //é€šè¿‡RandomAccessFileåˆ›å»ºä¸€ä¸ªé€šé“ channel.write(ByteBuffer.wrap(\u0026#34;ä¼å…µäºŒå·é©¬é£é£å‡†å¤‡å°±ç»ªï¼\u0026#34;.getBytes())); System.out.println(\u0026#34;å†™æ“ä½œå®Œæˆä¹‹åæ–‡ä»¶è®¿é—®ä½ç½®ï¼š\u0026#34;+channel.position()); //æ³¨æ„è¯»å–ä¹Ÿæ˜¯ä»ç°åœ¨çš„ä½ç½®å¼€å§‹ channel.position(0); //éœ€è¦å°†ä½ç½®å˜å›åˆ°æœ€å‰é¢ï¼Œè¿™æ ·ä¸‹é¢æ‰èƒ½ä»æ–‡ä»¶çš„æœ€å¼€å§‹è¿›è¡Œè¯»å– ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); buffer.flip(); System.out.println(new String(buffer.array(), 0, buffer.remaining())); } } å¯ä»¥çœ‹åˆ°ï¼Œä¸€ä¸ªFileChannelæ—¢å¯ä»¥å®Œæˆæ–‡ä»¶è¯»å–ï¼Œä¹Ÿå¯ä»¥å®Œæˆæ–‡ä»¶çš„å†™å…¥ã€‚\né™¤äº†åŸºæœ¬çš„è¯»å†™æ“ä½œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å¯¹æ–‡ä»¶è¿›è¡Œæˆªæ–­ï¼š\npublic static void main(String[] args) throws IOException { try(RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;rw\u0026#34;); FileChannel channel = f.getChannel()){ //æˆªæ–­æ–‡ä»¶ï¼Œåªç•™å‰20ä¸ªå­—èŠ‚ channel.truncate(20); ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); buffer.flip(); System.out.println(new String(buffer.array(), 0, buffer.remaining())); } } å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„å†…å®¹ç›´æ¥è¢«æˆªæ–­äº†ï¼Œæ–‡ä»¶å†…å®¹å°±åªå‰©ä¸€åŠäº†ã€‚\nå½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›è¡Œæ–‡ä»¶çš„æ‹·è´ï¼Œä¹Ÿæ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œåªéœ€è¦ä½¿ç”¨é€šé“å°±å¯ä»¥ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦å°†ä¸€ä¸ªé€šé“çš„æ•°æ®å†™å…¥åˆ°å¦ä¸€ä¸ªé€šé“ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨transferToæ–¹æ³•ï¼š\npublic static void main(String[] args) throws IOException { try(FileOutputStream out = new FileOutputStream(\u0026#34;test2.txt\u0026#34;); FileInputStream in = new FileInputStream(\u0026#34;test.txt\u0026#34;)){ FileChannel inChannel = in.getChannel(); //è·å–åˆ°testæ–‡ä»¶çš„é€šé“ inChannel.transferTo(0, inChannel.size(), out.getChannel()); //ç›´æ¥å°†testæ–‡ä»¶é€šé“ä¸­çš„æ•°æ®è½¬åˆ°test2æ–‡ä»¶çš„é€šé“ä¸­ } } å¯ä»¥çœ‹åˆ°æ‰§è¡Œåï¼Œæ–‡ä»¶çš„å†…å®¹å…¨éƒ¨è¢«å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ–‡ä»¶äº†ã€‚\nå½“ç„¶ï¼Œåå‘æ“ä½œä¹Ÿæ˜¯å¯ä»¥çš„ï¼š\npublic static void main(String[] args) throws IOException { try(FileOutputStream out = new FileOutputStream(\u0026#34;test2.txt\u0026#34;); FileInputStream in = new FileInputStream(\u0026#34;test.txt\u0026#34;)){ FileChannel inChannel = in.getChannel(); //è·å–åˆ°testæ–‡ä»¶çš„é€šé“ out.getChannel().transferFrom(inChannel, 0, inChannel.size()); //ç›´æ¥å°†ä»testæ–‡ä»¶é€šé“ä¸­ä¼ æ¥çš„æ•°æ®è½¬ç»™test2æ–‡ä»¶çš„é€šé“ } } å½“æˆ‘ä»¬è¦ç¼–è¾‘æŸä¸ªæ–‡ä»¶æ—¶ï¼Œé€šè¿‡ä½¿ç”¨MappedByteBufferç±»ï¼Œå¯ä»¥å°†å…¶æ˜ å°„åˆ°å†…å­˜ä¸­è¿›è¡Œç¼–è¾‘ï¼Œç¼–è¾‘çš„å†…å®¹ä¼šåŒæ­¥æ›´æ–°åˆ°æ–‡ä»¶ä¸­ï¼š\n//æ³¨æ„ä¸€å®šè¦æ˜¯å¯å†™çš„ï¼Œä¸ç„¶æ— æ³•è¿›è¡Œä¿®æ”¹æ“ä½œ try(RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;rw\u0026#34;); FileChannel channel = f.getChannel()){ //é€šè¿‡mapæ–¹æ³•æ˜ å°„æ–‡ä»¶çš„æŸä¸€æ®µå†…å®¹ï¼Œåˆ›å»ºMappedByteBufferå¯¹è±¡ //æ¯”å¦‚è¿™é‡Œå°±æ˜¯ä»ç¬¬å››ä¸ªå­—èŠ‚å¼€å§‹ï¼Œæ˜ å°„10å­—èŠ‚å†…å®¹åˆ°å†…å­˜ä¸­ //æ³¨æ„è¿™é‡Œéœ€è¦ä½¿ç”¨MapMode.READ_WRITEæ¨¡å¼ï¼Œå…¶ä»–æ¨¡å¼æ— æ³•ä¿å­˜æ•°æ®åˆ°æ–‡ä»¶ MappedByteBuffer buffer = channel.map(FileChannel.MapMode.READ_WRITE, 4, 10); //æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹åœ¨å†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œç¼–è¾‘ï¼Œä¹Ÿå°±æ˜¯ç¼–è¾‘Bufferä¸­çš„å†…å®¹ //æ³¨æ„è¿™é‡Œå†™å…¥ä¹Ÿæ˜¯ä»posä½ç½®å¼€å§‹çš„ï¼Œé»˜è®¤æ˜¯ä»0å¼€å§‹ï¼Œç›¸å¯¹äºæ–‡ä»¶å°±æ˜¯ä»ç¬¬å››ä¸ªå­—èŠ‚å¼€å§‹å†™ //æ³¨æ„æˆ‘ä»¬åªæ˜ å°„äº†10ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯å†™çš„å†…å®¹ä¸èƒ½è¶…å‡º10å­—èŠ‚äº† buffer.put(\u0026#34;yyds\u0026#34;.getBytes()); //ç¼–è¾‘å®Œæˆåï¼Œé€šè¿‡forceæ–¹æ³•å°†æ•°æ®å†™å›æ–‡ä»¶çš„æ˜ å°„åŒºåŸŸ buffer.force(); } å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶çš„æŸä¸€ä¸ªåŒºåŸŸå·²ç»è¢«æˆ‘ä»¬ä¿®æ”¹äº†ï¼Œå¹¶ä¸”è¿™é‡Œå®é™…ä¸Šä½¿ç”¨çš„å°±æ˜¯DirectByteBufferç›´æ¥ç¼“å†²åŒºï¼Œæ•ˆç‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚\næ–‡ä»¶é”FileLock #\ræˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè·¨è¿›ç¨‹æ–‡ä»¶é”æ¥é˜²æ­¢å¤šä¸ªè¿›ç¨‹ä¹‹é—´çš„æ–‡ä»¶äº‰æŠ¢æ“ä½œï¼ˆæ³¨æ„è¿™é‡Œæ˜¯è¿›ç¨‹ï¼Œä¸æ˜¯çº¿ç¨‹ï¼‰FileLockæ˜¯æ–‡ä»¶é”ï¼Œå®ƒèƒ½ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹ï¼ˆç¨‹åºï¼‰èƒ½å¤Ÿä¿®æ”¹å®ƒï¼Œæˆ–è€…éƒ½åªå¯ä»¥è¯»ï¼Œè¿™æ ·å°±è§£å†³äº†å¤šè¿›ç¨‹é—´çš„åŒæ­¥æ–‡ä»¶ï¼Œä¿è¯äº†å®‰å…¨æ€§ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒè¿›ç¨‹çº§åˆ«çš„ï¼Œä¸æ˜¯çº¿ç¨‹çº§åˆ«çš„ï¼Œä»–å¯ä»¥è§£å†³å¤šä¸ªè¿›ç¨‹å¹¶å‘è®¿é—®åŒä¸€ä¸ªæ–‡ä»¶çš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒä¸é€‚ç”¨äºæ§åˆ¶åŒä¸€ä¸ªè¿›ç¨‹ä¸­å¤šä¸ªçº¿ç¨‹å¯¹ä¸€ä¸ªæ–‡ä»¶çš„è®¿é—®ã€‚\né‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨æ–‡ä»¶é”ï¼š\npublic static void main(String[] args) throws IOException, InterruptedException { //åˆ›å»ºRandomAccessFileå¯¹è±¡ï¼Œå¹¶æ‹¿åˆ°Channel RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;rw\u0026#34;); FileChannel channel = f.getChannel(); System.out.println(new Date() + \u0026#34; æ­£åœ¨å°è¯•è·å–æ–‡ä»¶é”...\u0026#34;); //æ¥ç€æˆ‘ä»¬ç›´æ¥ä½¿ç”¨lockæ–¹æ³•è¿›è¡ŒåŠ é”æ“ä½œï¼ˆå¦‚æœå…¶ä»–è¿›ç¨‹å·²ç»åŠ é”ï¼Œé‚£ä¹ˆä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œï¼‰ //åŠ é”æ“ä½œæ”¯æŒå¯¹æ–‡ä»¶çš„æŸä¸€æ®µè¿›è¡ŒåŠ é”ï¼Œæ¯”å¦‚è¿™é‡Œå°±æ˜¯ä»0å¼€å§‹åçš„6ä¸ªå­—èŠ‚åŠ é”ï¼Œfalseä»£è¡¨è¿™æ˜¯ä¸€æŠŠç‹¬å é” //èŒƒå›´é”ç”šè‡³å¯ä»¥æå‰åŠ åˆ°ä¸€ä¸ªè¿˜æœªå†™å…¥çš„ä½ç½®ä¸Š FileLock lock = channel.lock(0, 6, false); System.out.println(new Date() + \u0026#34; å·²è·å–åˆ°æ–‡ä»¶é”ï¼\u0026#34;); Thread.sleep(5000); //å‡è®¾è¦å¤„ç†5ç§’é’Ÿ System.out.println(new Date() + \u0026#34; æ“ä½œå®Œæ¯•ï¼Œé‡Šæ”¾æ–‡ä»¶é”ï¼\u0026#34;); //æ“ä½œå®Œæˆä¹‹åä½¿ç”¨releaseæ–¹æ³•è¿›è¡Œé”é‡Šæ”¾ lock.release(); } æœ‰å…³å…±äº«é”å’Œç‹¬å é”ï¼š\nè¿›ç¨‹å¯¹æ–‡ä»¶åŠ ç‹¬å é”åï¼Œå½“å‰è¿›ç¨‹å¯¹æ–‡ä»¶å¯è¯»å¯å†™ï¼Œç‹¬å æ­¤æ–‡ä»¶ï¼Œå…¶å®ƒè¿›ç¨‹æ˜¯ä¸èƒ½è¯»è¯¥æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œçš„ã€‚ è¿›ç¨‹å¯¹æ–‡ä»¶åŠ å…±äº«é”åï¼Œè¿›ç¨‹å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œè¯»æ“ä½œï¼Œä½†æ˜¯æ— æ³•è¿›è¡Œå†™æ“ä½œï¼Œå…±äº«é”å¯ä»¥è¢«å¤šä¸ªè¿›ç¨‹æ·»åŠ ï¼Œä½†æ˜¯åªè¦å­˜åœ¨å…±äº«é”ï¼Œå°±ä¸èƒ½æ·»åŠ ç‹¬å é”ã€‚ ç°åœ¨æˆ‘ä»¬æ¥å¯åŠ¨ä¸¤ä¸ªè¿›ç¨‹è¯•è¯•çœ‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨IDEAä¸­é…ç½®ä¸€ä¸‹ä¸¤ä¸ªå¯åŠ¨é¡¹ï¼š\nç°åœ¨æˆ‘ä»¬ä¾æ¬¡å¯åŠ¨å®ƒä»¬ï¼š\nå¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯ä¸¤ä¸ªè¿›ç¨‹åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªè¿›è¡Œè®¿é—®ï¼Œè€Œå¦ä¸€ä¸ªéœ€è¦ç­‰å¾…é”é‡Šæ”¾ã€‚\né‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç”³è¯·çš„æ˜¯æ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†å‘¢ï¼Ÿ\n//å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹é” 0 - 5 FileLock lock = channel.lock(0, 6, false); //å¦ä¸€ä¸ªè¿›ç¨‹é” 6 - 11 FileLock lock = channel.lock(6, 6, false); å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªè¿›ç¨‹è¿™æ—¶å°±å¯ä»¥åŒæ—¶è¿›è¡ŒåŠ é”æ“ä½œäº†ï¼Œå› ä¸ºå®ƒä»¬é”çš„æ˜¯ä¸åŒçš„æ®µè½ã€‚\né‚£ä¹ˆè¦æ˜¯äº¤å‰å‘¢ï¼Ÿ\n//å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹é” 0 - 5 FileLock lock = channel.lock(0, 6, false); //å¦ä¸€ä¸ªè¿›ç¨‹é” 3 - 8 FileLock lock = channel.lock(3, 6, false); å¯ä»¥çœ‹åˆ°äº¤å‰çš„æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¼šå‡ºç°é˜»å¡çš„ã€‚\næ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹å…±äº«é”ï¼Œå…±äº«é”å…è®¸å¤šä¸ªè¿›ç¨‹åŒæ—¶åŠ é”ï¼Œä½†æ˜¯ä¸èƒ½è¿›è¡Œå†™æ“ä½œï¼š\npublic static void main(String[] args) throws IOException, InterruptedException { RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;rw\u0026#34;); FileChannel channel = f.getChannel(); System.out.println(new Date() + \u0026#34; æ­£åœ¨å°è¯•è·å–æ–‡ä»¶é”...\u0026#34;); //ç°åœ¨ä½¿ç”¨å…±äº«é” FileLock lock = channel.lock(0, Long.MAX_VALUE, true); System.out.println(new Date() + \u0026#34; å·²è·å–åˆ°æ–‡ä»¶é”ï¼\u0026#34;); //è¿›è¡Œå†™æ“ä½œ channel.write(ByteBuffer.wrap(new Date().toString().getBytes())); System.out.println(new Date() + \u0026#34; æ“ä½œå®Œæ¯•ï¼Œé‡Šæ”¾æ–‡ä»¶é”ï¼\u0026#34;); //æ“ä½œå®Œæˆä¹‹åä½¿ç”¨releaseæ–¹æ³•è¿›è¡Œé”é‡Šæ”¾ lock.release(); } å½“æˆ‘ä»¬è¿›è¡Œå†™æ“ä½œæ—¶ï¼š\nå¯ä»¥çœ‹åˆ°ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè¯´å¦ä¸€ä¸ªç¨‹åºå·²é”å®šæ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ï¼ˆæŸäº›ç³»ç»Ÿæˆ–æ˜¯ç¯å¢ƒå®æµ‹æ— æ•ˆï¼Œæ¯”å¦‚UPä¸»çš„armæ¶æ„MacOSå°±ä¸ç”Ÿæ•ˆï¼Œè¿™ä¸ªå¼‚å¸¸æ˜¯åœ¨Windowsç¯å¢ƒä¸‹è¿è¡Œå¾—åˆ°çš„ï¼‰\nå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æµ‹è¯•ä¸€ä¸‹å¤šä¸ªè¿›è¡ŒåŒæ—¶åŠ å…±äº«é”ï¼š\npublic static void main(String[] args) throws IOException, InterruptedException { RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;rw\u0026#34;); FileChannel channel = f.getChannel(); System.out.println(new Date() + \u0026#34; æ­£åœ¨å°è¯•è·å–æ–‡ä»¶é”...\u0026#34;); FileLock lock = channel.lock(0, Long.MAX_VALUE, true); System.out.println(new Date() + \u0026#34; å·²è·å–åˆ°æ–‡ä»¶é”ï¼\u0026#34;); Thread.sleep(5000); //å‡è®¾è¦å¤„ç†5ç§’é’Ÿ System.out.println(new Date() + \u0026#34; æ“ä½œå®Œæ¯•ï¼Œé‡Šæ”¾æ–‡ä»¶é”ï¼\u0026#34;); lock.release(); } å¯ä»¥çœ‹åˆ°ç»“æœæ˜¯å¤šä¸ªè¿›ç¨‹éƒ½èƒ½åŠ å…±äº«é”ï¼š\nå½“ç„¶ï¼Œé™¤äº†ç›´æ¥ä½¿ç”¨ lock()æ–¹æ³•è¿›è¡ŒåŠ é”ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ tryLock()æ–¹æ³•ä»¥éé˜»å¡æ–¹å¼è·å–æ–‡ä»¶é”ï¼Œä½†æ˜¯å¦‚æœè·å–é”å¤±è´¥ä¼šå¾—åˆ°nullï¼š\npublic static void main(String[] args) throws IOException, InterruptedException { RandomAccessFile f = new RandomAccessFile(\u0026#34;test.txt\u0026#34;, \u0026#34;rw\u0026#34;); FileChannel channel = f.getChannel(); System.out.println(new Date() + \u0026#34; æ­£åœ¨å°è¯•è·å–æ–‡ä»¶é”...\u0026#34;); FileLock lock = channel.tryLock(0, Long.MAX_VALUE, false); System.out.println(lock); Thread.sleep(5000); //å‡è®¾è¦å¤„ç†5ç§’é’Ÿ lock.release(); } å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªè¿›ç¨‹éƒ½å»å°è¯•è·å–ç‹¬å é”ï¼š\nç¬¬ä¸€ä¸ªæˆåŠŸåŠ é”çš„è¿›ç¨‹è·å¾—äº†å¯¹åº”çš„é”å¯¹è±¡ï¼Œè€Œç¬¬äºŒä¸ªè¿›ç¨‹ç›´æ¥å¾—åˆ°çš„æ˜¯ nullã€‚\nåˆ°è¿™é‡Œï¼Œæœ‰å…³æ–‡ä»¶é”çš„ç›¸å…³å†…å®¹å°±å·®ä¸å¤šäº†ã€‚\nå¤šè·¯å¤ç”¨ç½‘ç»œé€šä¿¡ #\rå‰é¢æˆ‘ä»¬å·²ç»ä»‹ç»äº†NIOæ¡†æ¶çš„ä¸¤å¤§æ ¸å¿ƒï¼šBufferå’ŒChannelï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹æœ€åä¸€ä¸ªå†…å®¹ã€‚\nä¼ ç»Ÿé˜»å¡I/Oç½‘ç»œé€šä¿¡ #\rè¯´èµ·ç½‘ç»œé€šä¿¡ï¼Œç›¸ä¿¡å„ä½å¹¶ä¸é™Œç”Ÿï¼Œæ­£æ˜¯å› ä¸ºç½‘ç»œçš„å­˜åœ¨æˆ‘ä»¬æ‰èƒ½èµ°è¿›ç°ä»£åŒ–çš„ç¤¾ä¼šï¼Œåœ¨JavaWebé˜¶æ®µï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨Socketå»ºç«‹TCPè¿æ¥è¿›è¡Œç½‘ç»œé€šä¿¡ï¼š\npublic static void main(String[] args) { try(ServerSocket server = new ServerSocket(8080)){ //å°†æœåŠ¡ç«¯åˆ›å»ºåœ¨ç«¯å£8080ä¸Š System.out.println(\u0026#34;æ­£åœ¨ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥...\u0026#34;); Socket socket = server.accept(); System.out.println(\u0026#34;å®¢æˆ·ç«¯å·²è¿æ¥ï¼ŒIPåœ°å€ä¸ºï¼š\u0026#34;+socket.getInetAddress().getHostAddress()); BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream())); //é€šè¿‡ System.out.print(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;); System.out.println(reader.readLine()); OutputStreamWriter writer = new OutputStreamWriter(socket.getOutputStream()); writer.write(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;); writer.flush(); }catch (IOException e){ e.printStackTrace(); } } public static void main(String[] args) { try (Socket socket = new Socket(\u0026#34;localhost\u0026#34;, 8080); Scanner scanner = new Scanner(System.in)){ System.out.println(\u0026#34;å·²è¿æ¥åˆ°æœåŠ¡ç«¯ï¼\u0026#34;); OutputStream stream = socket.getOutputStream(); OutputStreamWriter writer = new OutputStreamWriter(stream); //é€šè¿‡è½¬æ¢æµæ¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå†™å…¥å†…å®¹ System.out.println(\u0026#34;è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); writer.write(text+\u0026#39;\\n\u0026#39;); //å› ä¸ºå¯¹æ–¹æ˜¯readLine()è¿™é‡ŒåŠ ä¸ªæ¢è¡Œç¬¦ writer.flush(); System.out.println(\u0026#34;æ•°æ®å·²å‘é€ï¼š\u0026#34;+text); BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream())); System.out.println(\u0026#34;æ”¶åˆ°æœåŠ¡å™¨è¿”å›ï¼š\u0026#34;+reader.readLine()); }catch (IOException e){ System.out.println(\u0026#34;æœåŠ¡ç«¯è¿æ¥å¤±è´¥ï¼\u0026#34;); e.printStackTrace(); }finally { System.out.println(\u0026#34;å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ï¼\u0026#34;); } } å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å‰é¢è®²è§£çš„é€šé“æ¥è¿›è¡Œé€šä¿¡ï¼š\npublic static void main(String[] args) { //åˆ›å»ºä¸€ä¸ªæ–°çš„ServerSocketChannelï¼Œä¸€ä¼šç›´æ¥ä½¿ç”¨SocketChannelè¿›è¡Œç½‘ç»œIOæ“ä½œ try (ServerSocketChannel serverChannel = ServerSocketChannel.open()){ //ä¾ç„¶æ˜¯å°†å…¶ç»‘å®šåˆ°8080ç«¯å£ serverChannel.bind(new InetSocketAddress(8080)); //åŒæ ·æ˜¯è°ƒç”¨accept()æ–¹æ³•ï¼Œé˜»å¡ç­‰å¾…æ–°çš„è¿æ¥åˆ°æ¥ SocketChannel socket = serverChannel.accept(); //å› ä¸ºæ˜¯é€šé“ï¼Œä¸¤ç«¯çš„ä¿¡æ¯éƒ½æ˜¯å¯ä»¥æ˜ç¡®çš„ï¼Œè¿™é‡Œè·å–è¿œç«¯åœ°å€ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è·å–æœ¬åœ°åœ°å€ System.out.println(\u0026#34;å®¢æˆ·ç«¯å·²è¿æ¥ï¼ŒIPåœ°å€ä¸ºï¼š\u0026#34;+socket.getRemoteAddress()); //ä½¿ç”¨ç¼“å†²åŒºè¿›è¡Œæ•°æ®æ¥æ”¶ ByteBuffer buffer = ByteBuffer.allocate(128); socket.read(buffer); //SocketChannelåŒæ—¶å®ç°äº†è¯»å†™é€šé“æ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿›è¡ŒåŒå‘æ“ä½œ buffer.flip(); System.out.print(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); //ç›´æ¥å‘é€šé“ä¸­å†™å…¥æ•°æ®å°±è¡Œ socket.write(ByteBuffer.wrap(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); //è®°å¾—å…³ socket.close(); } catch (IOException e) { throw new RuntimeException(e); } } public static void main(String[] args) { //åˆ›å»ºä¸€ä¸ªæ–°çš„SocketChannelï¼Œä¸€ä¼šé€šè¿‡é€šé“è¿›è¡Œé€šä¿¡ try (SocketChannel channel = SocketChannel.open(new InetSocketAddress(\u0026#34;localhost\u0026#34;, 8080)); Scanner scanner = new Scanner(System.in)){ System.out.println(\u0026#34;å·²è¿æ¥åˆ°æœåŠ¡ç«¯ï¼\u0026#34;); System.out.println(\u0026#34;è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); //ç›´æ¥å‘é€šé“ä¸­å†™å…¥æ•°æ®ï¼ŒçœŸèˆ’æœ channel.write(ByteBuffer.wrap(text.getBytes())); ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); //ç›´æ¥ä»é€šé“ä¸­è¯»å–æ•°æ® buffer.flip(); System.out.println(\u0026#34;æ”¶åˆ°æœåŠ¡å™¨è¿”å›ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); } catch (IOException e) { throw new RuntimeException(e); } } è™½ç„¶å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„Socketè¿›è¡Œç½‘ç»œé€šä¿¡ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœè¦è¿›è¡ŒIOæ“ä½œï¼Œæˆ‘ä»¬éœ€è¦å•ç‹¬åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ç°åœ¨æœ‰å¾ˆå¤šä¸ªå®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯éœ€è¦åŒæ—¶è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¦å¤„ç†è¿™äº›å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åªèƒ½å•ç‹¬ä¸ºå…¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œå¤„ç†ï¼š\nè™½ç„¶è¿™æ ·çœ‹èµ·æ¥æ¯”è¾ƒåˆç†ï¼Œä½†æ˜¯éšç€å®¢æˆ·ç«¯æ•°é‡çš„å¢åŠ ï¼Œå¦‚æœè¦ä¿æŒæŒç»­é€šä¿¡ï¼Œé‚£ä¹ˆå°±ä¸èƒ½æ‘§æ¯è¿™äº›çº¿ç¨‹ï¼Œè€Œæ˜¯éœ€è¦ä¸€ç›´ä¿ç•™ï¼ˆä½†æ˜¯å®é™…ä¸Šå¾ˆå¤šæ—¶å€™åªæ˜¯ä¿æŒè¿æ¥ï¼Œä¸€ç›´åœ¨é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯çš„è¯»å†™æ“ä½œï¼ŒIOæ“ä½œçš„é¢‘ç‡å¾ˆä½ï¼Œè¿™æ ·å°±ç™½ç™½å ç”¨äº†ä¸€æ¡çº¿ç¨‹ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯ç«™ç€èŒ…å‘ä¸æ‹‰å±ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬çš„çº¿ç¨‹ä¸å¯èƒ½æ— é™åˆ¶çš„è¿›è¡Œåˆ›å»ºï¼Œæ€»æœ‰ä¸€å¤©ä¼šè€—å°½æœåŠ¡ç«¯çš„èµ„æºï¼Œé‚£ä¹ˆç°åœ¨æ€ä¹ˆåŠå‘¢ï¼Œå…³é”®æ˜¯ç°åœ¨åˆæœ‰å¾ˆå¤šå®¢æˆ·ç«¯æºæºä¸æ–­åœ°è¿æ¥å¹¶è¿›è¡Œæ“ä½œï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨NIOä¸ºæˆ‘ä»¬æä¾›çš„å¤šè·¯å¤ç”¨ç¼–ç¨‹æ¨¡å‹ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹NIOä¸ºæˆ‘ä»¬æä¾›çš„æ¨¡å‹ï¼š\næœåŠ¡ç«¯ä¸å†æ˜¯ä¸€ä¸ªå•çº¯é€šè¿‡ accept()æ–¹æ³•æ¥åˆ›å»ºè¿æ¥çš„æœºåˆ¶äº†ï¼Œè€Œæ˜¯æ ¹æ®å®¢æˆ·ç«¯ä¸åŒçš„çŠ¶æ€ï¼ŒSelectorä¼šä¸æ–­è½®è¯¢ï¼Œåªæœ‰å®¢æˆ·ç«¯åœ¨å¯¹åº”çš„çŠ¶æ€æ—¶ï¼Œæ¯”å¦‚çœŸæ­£å¼€å§‹è¯»å†™æ“ä½œæ—¶ï¼Œæ‰ä¼šåˆ›å»ºçº¿ç¨‹æˆ–è¿›è¡Œå¤„ç†ï¼ˆè¿™æ ·å°±ä¸ä¼šä¸€ç›´é˜»å¡ç­‰å¾…æŸä¸ªå®¢æˆ·ç«¯çš„IOæ“ä½œäº†ï¼‰ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¹‹åéœ€è¦ä¸€ç›´ä¿æŒè¿æ¥ï¼Œå³ä½¿æ²¡æœ‰ä»»ä½•çš„è¯»å†™æ“ä½œã€‚è¿™æ ·å°±ä¸ä¼šå› ä¸ºå ç€èŒ…å‘ä¸æ‹‰å±å¯¼è‡´çº¿ç¨‹æ— é™åˆ¶åœ°åˆ›å»ºä¸‹å»äº†ã€‚\né€šè¿‡è¿™ç§æ–¹å¼ï¼Œç”šè‡³å•çº¿ç¨‹éƒ½èƒ½åšåˆ°é«˜æ•ˆçš„å¤ç”¨ï¼Œæœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯Redisäº†ï¼Œå› ä¸ºå†…å­˜çš„é€Ÿåº¦éå¸¸å¿«ï¼Œå¤šçº¿ç¨‹ä¸Šä¸‹æ–‡çš„å¼€é”€å°±ä¼šæ˜¾å¾—æœ‰äº›æ‹–åè…¿ï¼Œè¿˜ä¸å¦‚ç›´æ¥å•çº¿ç¨‹ç®€å•é«˜æ•ˆï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆRediså•çº¿ç¨‹ä¹Ÿèƒ½è¿™ä¹ˆå¿«çš„åŸå› ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬å°±ä»NIOæ¡†æ¶çš„ç¬¬ä¸‰ä¸ªæ ¸å¿ƒå†…å®¹ï¼šSelectorï¼Œå¼€å§‹è®²èµ·ã€‚\né€‰æ‹©å™¨ä¸I/Oå¤šè·¯å¤ç”¨ #\rå‰é¢æˆ‘ä»¬å¤§æ¦‚äº†è§£äº†ä¸€ä¸‹é€‰æ‹©å™¨ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œé€‰æ‹©å™¨æ˜¯å½“å…·ä½“æœ‰æŸä¸€ä¸ªçŠ¶æ€ï¼ˆæ¯”å¦‚è¯»ã€å†™ã€è¯·æ±‚ï¼‰å·²ç»å°±ç»ªæ—¶ï¼Œæ‰ä¼šè¿›è¡Œå¤„ç†ï¼Œè€Œä¸æ˜¯è®©æˆ‘ä»¬çš„ç¨‹åºä¸»åŠ¨åœ°è¿›è¡Œç­‰å¾…ã€‚\næ—¢ç„¶æˆ‘ä»¬ç°åœ¨éœ€è¦å®ç°IOå¤šè·¯å¤ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹å¸¸è§çš„IOå¤šè·¯å¤ç”¨æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯Selectorçš„å®ç°æ–¹æ¡ˆï¼Œæ¯”å¦‚ç°åœ¨æœ‰å¾ˆå¤šä¸ªç”¨æˆ·è¿æ¥åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼š\nselectï¼šå½“è¿™äº›è¿æ¥å‡ºç°å…·ä½“çš„æŸä¸ªçŠ¶æ€æ—¶ï¼Œåªæ˜¯çŸ¥é“å·²ç»å°±ç»ªäº†ï¼Œä½†æ˜¯ä¸çŸ¥é“è¯¦å…·ä½“æ˜¯å“ªä¸€ä¸ªè¿æ¥å·²ç»å°±ç»ªï¼Œæ¯æ¬¡è°ƒç”¨éƒ½è¿›è¡Œçº¿æ€§éå†æ‰€æœ‰è¿æ¥ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œå¹¶ä¸”å­˜åœ¨æœ€å¤§è¿æ¥æ•°é™åˆ¶ã€‚ pollï¼šåŒä¸Šï¼Œä½†æ˜¯ç”±äºåº•å±‚é‡‡ç”¨é“¾è¡¨ï¼Œæ‰€ä»¥æ²¡æœ‰æœ€å¤§è¿æ¥æ•°é™åˆ¶ã€‚ epollï¼šé‡‡ç”¨äº‹ä»¶é€šçŸ¥æ–¹å¼ï¼Œå½“æŸä¸ªè¿æ¥å°±ç»ªï¼Œèƒ½å¤Ÿç›´æ¥è¿›è¡Œç²¾å‡†é€šçŸ¥ï¼ˆè¿™æ˜¯å› ä¸ºåœ¨å†…æ ¸å®ç°ä¸­epollæ˜¯æ ¹æ®æ¯ä¸ªfdä¸Šé¢çš„callbackå‡½æ•°å®ç°çš„ï¼Œåªè¦å°±ç»ªä¼šä¼šç›´æ¥å›è°ƒcallbackå‡½æ•°ï¼Œå®ç°ç²¾å‡†é€šçŸ¥ï¼Œä½†æ˜¯åªæœ‰Linuxæ”¯æŒè¿™ç§æ–¹å¼ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ O(1)ï¼ŒJavaåœ¨Linuxç¯å¢ƒä¸‹æ­£æ˜¯é‡‡ç”¨çš„è¿™ç§æ¨¡å¼è¿›è¡Œå®ç°çš„ã€‚ å¥½äº†ï¼Œæ—¢ç„¶å¤šè·¯å¤ç”¨æ¨¡å‹äº†è§£å®Œæ¯•äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•è®©æˆ‘ä»¬çš„ç½‘ç»œé€šä¿¡å®ç°å¤šè·¯å¤ç”¨ï¼š\npublic static void main(String[] args) { try (ServerSocketChannel serverChannel = ServerSocketChannel.open(); Selector selector = Selector.open()){ //å¼€å¯ä¸€ä¸ªæ–°çš„Selectorï¼Œè¿™ç©æ„ä¹Ÿæ˜¯è¦å…³é—­é‡Šæ”¾èµ„æºçš„ serverChannel.bind(new InetSocketAddress(8080)); //è¦ä½¿ç”¨é€‰æ‹©å™¨è¿›è¡Œæ“ä½œï¼Œå¿…é¡»ä½¿ç”¨éé˜»å¡çš„æ–¹å¼ï¼Œè¿™æ ·æ‰ä¸ä¼šåƒé˜»å¡IOé‚£æ ·å¡åœ¨accept()ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ï¼Œè®©é€‰æ‹©å™¨å»è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œ serverChannel.configureBlocking(false); //å°†é€‰æ‹©å™¨æ³¨å†Œåˆ°ServerSocketChannelä¸­ï¼Œåé¢æ˜¯é€‰æ‹©éœ€è¦ç›‘å¬çš„æ—¶é—´ï¼Œåªæœ‰å‘ç”Ÿå¯¹åº”äº‹ä»¶æ—¶æ‰ä¼šè¿›è¡Œé€‰æ‹©ï¼Œå¤šä¸ªäº‹ä»¶ç”¨ | è¿æ¥ï¼Œæ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„Channeléƒ½æ”¯æŒä»¥ä¸‹å…¨éƒ¨å››ä¸ªäº‹ä»¶ï¼Œå¯èƒ½åªæ”¯æŒéƒ¨åˆ† //å› ä¸ºæ˜¯ServerSocketChannelè¿™é‡Œæˆ‘ä»¬å°±ç›‘å¬acceptå°±å¯ä»¥äº†ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ //SelectionKey.OP_CONNECT --- è¿æ¥å°±ç»ªäº‹ä»¶ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„è¿æ¥å·²ç»å»ºç«‹æˆåŠŸ //SelectionKey.OP_ACCEPT --- æ¥æ”¶è¿æ¥äº‹ä»¶ï¼Œè¡¨ç¤ºæœåŠ¡å™¨ç›‘å¬åˆ°äº†å®¢æˆ·è¿æ¥ï¼ŒæœåŠ¡å™¨å¯ä»¥æ¥æ”¶è¿™ä¸ªè¿æ¥äº† //SelectionKey.OP_READ --- è¯» å°±ç»ªäº‹ä»¶ï¼Œè¡¨ç¤ºé€šé“ä¸­å·²ç»æœ‰äº†å¯è¯»çš„æ•°æ®ï¼Œå¯ä»¥æ‰§è¡Œè¯»æ“ä½œäº† //SelectionKey.OP_WRITE --- å†™ å°±ç»ªäº‹ä»¶ï¼Œè¡¨ç¤ºå·²ç»å¯ä»¥å‘é€šé“å†™æ•°æ®äº†ï¼ˆè¿™ç©æ„æ¯”è¾ƒç‰¹æ®Šï¼Œä¸€èˆ¬æƒ…å†µä¸‹å› ä¸ºéƒ½æ˜¯å¯ä»¥å†™å…¥çš„ï¼Œæ‰€ä»¥å¯èƒ½ä¼šæ— é™å¾ªç¯ï¼‰ serverChannel.register(selector, SelectionKey.OP_ACCEPT); while (true) { //æ— é™å¾ªç¯ç­‰å¾…æ–°çš„ç”¨æˆ·ç½‘ç»œæ“ä½œ //æ¯æ¬¡é€‰æ‹©éƒ½å¯èƒ½ä¼šé€‰å‡ºå¤šä¸ªå·²ç»å°±ç»ªçš„ç½‘ç»œæ“ä½œï¼Œæ²¡æœ‰æ“ä½œæ—¶ä¼šæš‚æ—¶é˜»å¡ int count = selector.select(); System.out.println(\u0026#34;ç›‘å¬åˆ° \u0026#34;+count+\u0026#34; ä¸ªäº‹ä»¶\u0026#34;); Set\u0026lt;SelectionKey\u0026gt; selectionKeys = selector.selectedKeys(); Iterator\u0026lt;SelectionKey\u0026gt; iterator = selectionKeys.iterator(); while (iterator.hasNext()) { SelectionKey key = iterator.next(); //æ ¹æ®ä¸åŒçš„äº‹ä»¶ç±»å‹ï¼Œæ‰§è¡Œä¸åŒçš„æ“ä½œå³å¯ if(key.isAcceptable()) { //å¦‚æœå½“å‰ServerSocketChannelå·²ç»åšå¥½å‡†å¤‡å¤„ç†Accept SocketChannel channel = serverChannel.accept(); System.out.println(\u0026#34;å®¢æˆ·ç«¯å·²è¿æ¥ï¼ŒIPåœ°å€ä¸ºï¼š\u0026#34;+channel.getRemoteAddress()); //ç°åœ¨è¿æ¥å°±å»ºç«‹å¥½äº†ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦å°†è¿æ¥ä¹Ÿæ³¨å†Œé€‰æ‹©å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦å½“è¿™ä¸ªè¿æ¥æœ‰å†…å®¹å¯è¯»æ—¶å°±è¿›è¡Œå¤„ç† channel.configureBlocking(false); channel.register(selector, SelectionKey.OP_READ); //è¿™æ ·å°±åœ¨è¿æ¥å»ºç«‹æ—¶å®Œæˆäº†æ³¨å†Œ } else if(key.isReadable()) { //å¦‚æœå½“å‰è¿æ¥æœ‰å¯è¯»çš„æ•°æ®å¹¶ä¸”å¯ä»¥å†™ï¼Œé‚£ä¹ˆå°±å¼€å§‹å¤„ç† SocketChannel channel = (SocketChannel) key.channel(); ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); buffer.flip(); System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); //ç›´æ¥å‘é€šé“ä¸­å†™å…¥æ•°æ®å°±è¡Œ channel.write(ByteBuffer.wrap(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); //åˆ«å…³ï¼Œè¯´ä¸å®šç”¨æˆ·è¿˜è¦ç»§ç»­é€šä¿¡å‘¢ } //å¤„ç†å®Œæˆåï¼Œä¸€å®šè®°å¾—ç§»å‡ºè¿­ä»£å™¨ï¼Œä¸ç„¶ä¸‹æ¬¡è¿˜æœ‰ iterator.remove(); } } } catch (IOException e) { throw new RuntimeException(e); } } æ¥ç€æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸‹å®¢æˆ·å®¢æˆ·ç«¯ï¼š\npublic static void main(String[] args) { //åˆ›å»ºä¸€ä¸ªæ–°çš„SocketChannelï¼Œä¸€ä¼šé€šè¿‡é€šé“è¿›è¡Œé€šä¿¡ try (SocketChannel channel = SocketChannel.open(new InetSocketAddress(\u0026#34;localhost\u0026#34;, 8080)); Scanner scanner = new Scanner(System.in)){ System.out.println(\u0026#34;å·²è¿æ¥åˆ°æœåŠ¡ç«¯ï¼\u0026#34;); while (true) { //å’±ç»™å®ƒå¥—ä¸ªæ— é™å¾ªç¯ï¼Œè¿™æ ·å°±èƒ½ä¸€ç›´å‘æ¶ˆæ¯äº† System.out.println(\u0026#34;è¯·è¾“å…¥è¦å‘é€ç»™æœåŠ¡ç«¯çš„å†…å®¹ï¼š\u0026#34;); String text = scanner.nextLine(); //ç›´æ¥å‘é€šé“ä¸­å†™å…¥æ•°æ®ï¼ŒçœŸèˆ’æœ channel.write(ByteBuffer.wrap(text.getBytes())); System.out.println(\u0026#34;å·²å‘é€ï¼\u0026#34;); ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); //ç›´æ¥ä»é€šé“ä¸­è¯»å–æ•°æ® buffer.flip(); System.out.println(\u0026#34;æ”¶åˆ°æœåŠ¡å™¨è¿”å›ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); } } catch (IOException e) { throw new RuntimeException(e); } } æˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœï¼š\nå¯ä»¥çœ‹åˆ°æˆåŠŸå®ç°äº†ï¼Œå½“ç„¶å„ä½ä¹Ÿå¯ä»¥è·Ÿè‡ªå·±çš„å®¤å‹ä¸€èµ·å¼€å®¢æˆ·ç«¯è¿›è¡Œæµ‹è¯•ï¼Œç°åœ¨ï¼Œæˆ‘ä»¬åªç”¨äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œå°±èƒ½å¤ŸåŒæ—¶å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œå¯è§å¤šè·¯å¤ç”¨æ˜¯å¤šä¹ˆé‡è¦ã€‚\nå®ç°Reactoræ¨¡å¼ #\rå‰é¢æˆ‘ä»¬ç®€å•å®ç°äº†å¤šè·¯å¤ç”¨ç½‘ç»œé€šä¿¡ï¼Œæˆ‘ä»¬æ¥ç€æ¥äº†è§£ä¸€ä¸‹Reactoræ¨¡å¼ï¼Œå¯¹æˆ‘ä»¬çš„æœåŠ¡ç«¯è¿›è¡Œä¼˜åŒ–ã€‚\nç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è¿›è¡Œä¼˜åŒ–ï¼Œæˆ‘ä»¬é¦–å…ˆæŠ½è±¡å‡ºä¸¤ä¸ªç»„ä»¶ï¼ŒReactorçº¿ç¨‹å’ŒHandlerå¤„ç†å™¨ï¼š\nReactorçº¿ç¨‹ï¼šè´Ÿè´£å“åº”IOäº‹ä»¶ï¼Œå¹¶åˆ†å‘åˆ°Handlerå¤„ç†å™¨ã€‚æ–°çš„äº‹ä»¶åŒ…å«è¿æ¥å»ºç«‹å°±ç»ªã€è¯»å°±ç»ªã€å†™å°±ç»ªç­‰ã€‚ Handlerå¤„ç†å™¨ï¼šæ‰§è¡Œéé˜»å¡çš„æ“ä½œã€‚ å®é™…ä¸Šæˆ‘ä»¬ä¹‹å‰ç¼–å†™çš„ç®—æ˜¯ä¸€ç§å•çº¿ç¨‹Reactorçš„æœ´ç´ æ¨¡å‹ï¼ˆé¢å‘è¿‡ç¨‹çš„å†™æ³•ï¼‰ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ ‡å‡†çš„å†™æ³•ï¼š\nå®¢æˆ·ç«¯è¿˜æ˜¯æŒ‰ç…§æˆ‘ä»¬ä¸Šé¢çš„æ–¹å¼è¿æ¥åˆ°Reactorï¼Œå¹¶é€šè¿‡é€‰æ‹©å™¨èµ°åˆ°Acceptoræˆ–æ˜¯Handlerï¼ŒAcceptorä¸»è¦è´Ÿè´£å®¢æˆ·ç«¯è¿æ¥çš„å»ºç«‹ï¼ŒHandlerè´Ÿè´£è¯»å†™æ“ä½œï¼Œä»£ç å¦‚ä¸‹ï¼Œé¦–å…ˆæ˜¯Handlerï¼š\npublic class Handler implements Runnable{ private final SocketChannel channel; public Handler(SocketChannel channel) { this.channel = channel; } @Override public void run() { try { ByteBuffer buffer = ByteBuffer.allocate(128); channel.read(buffer); buffer.flip(); System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); channel.write(ByteBuffer.wrap(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); }catch (IOException e){ e.printStackTrace(); } } } æ¥ç€æ˜¯Acceptorï¼Œå®é™…ä¸Šå°±æ˜¯æŠŠä¸Šé¢çš„ä¸šåŠ¡ä»£ç æ¬ä¸ªä½ç½®ç½¢äº†ï¼š\n/** * Acceptorä¸»è¦ç”¨äºå¤„ç†è¿æ¥æ“ä½œ */ public class Acceptor implements Runnable{ private final ServerSocketChannel serverChannel; private final Selector selector; public Acceptor(ServerSocketChannel serverChannel, Selector selector) { this.serverChannel = serverChannel; this.selector = selector; } @Override public void run() { try{ SocketChannel channel = serverChannel.accept(); System.out.println(\u0026#34;å®¢æˆ·ç«¯å·²è¿æ¥ï¼ŒIPåœ°å€ä¸ºï¼š\u0026#34;+channel.getRemoteAddress()); channel.configureBlocking(false); //è¿™é‡Œåœ¨æ³¨å†Œæ—¶ï¼Œåˆ›å»ºå¥½å¯¹åº”çš„Handlerï¼Œè¿™æ ·åœ¨Reactorä¸­åˆ†å‘çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥è°ƒç”¨Handleräº† channel.register(selector, SelectionKey.OP_READ, new Handler(channel)); }catch (IOException e){ e.printStackTrace(); } } } è¿™é‡Œæˆ‘ä»¬åœ¨æ³¨å†Œæ—¶ä¸¢äº†ä¸€ä¸ªé™„åŠ å¯¹è±¡è¿›å»ï¼Œè¿™ä¸ªé™„åŠ å¯¹è±¡ä¼šåœ¨é€‰æ‹©å™¨é€‰æ‹©åˆ°æ­¤é€šé“ä¸Šæ—¶ï¼Œå¯ä»¥é€šè¿‡ attachment()æ–¹æ³•è¿›è¡Œè·å–ï¼Œå¯¹äºæˆ‘ä»¬ç®€åŒ–ä»£ç æœ‰å¤§ä½œç”¨ï¼Œä¸€ä¼šå±•ç¤ºï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹çœ‹Reactorï¼š\npublic class Reactor implements Closeable, Runnable{ private final ServerSocketChannel serverChannel; private final Selector selector; public Reactor() throws IOException{ serverChannel = ServerSocketChannel.open(); selector = Selector.open(); } @Override public void run() { try { serverChannel.bind(new InetSocketAddress(8080)); serverChannel.configureBlocking(false); //æ³¨å†Œæ—¶ï¼Œå°†Acceptorä½œä¸ºé™„åŠ å¯¹è±¡å­˜æ”¾ï¼Œå½“é€‰æ‹©å™¨é€‰æ‹©åä¹Ÿå¯ä»¥è·å–åˆ° serverChannel.register(selector, SelectionKey.OP_ACCEPT, new Acceptor(serverChannel, selector)); while (true) { int count = selector.select(); System.out.println(\u0026#34;ç›‘å¬åˆ° \u0026#34;+count+\u0026#34; ä¸ªäº‹ä»¶\u0026#34;); Set\u0026lt;SelectionKey\u0026gt; selectionKeys = selector.selectedKeys(); Iterator\u0026lt;SelectionKey\u0026gt; iterator = selectionKeys.iterator(); while (iterator.hasNext()) { this.dispatch(iterator.next()); //é€šè¿‡dispatchæ–¹æ³•è¿›è¡Œåˆ†å‘ iterator.remove(); } } }catch (IOException e) { e.printStackTrace(); } } //é€šè¿‡æ­¤æ–¹æ³•è¿›è¡Œåˆ†å‘ private void dispatch(SelectionKey key){ Object att = key.attachment(); //è·å–attachmentï¼ŒServerSocketChannelå’Œå¯¹åº”çš„å®¢æˆ·ç«¯Channeléƒ½æ·»åŠ äº†çš„ if(att instanceof Runnable) { ((Runnable) att).run(); //ç”±äºHandlerå’ŒAcceptoréƒ½å®ç°è‡ªRunnableæ¥å£ï¼Œè¿™é‡Œå°±ç»Ÿä¸€è°ƒç”¨ä¸€ä¸‹ } //è¿™æ ·å°±å®ç°äº†å¯¹åº”çš„æ—¶å€™è°ƒç”¨å¯¹åº”çš„Handleræˆ–æ˜¯Acceptoräº† } //ç”¨äº†è®°å¾—å…³ï¼Œä¿æŒå¥½ä¹ æƒ¯ï¼Œå°±åƒçœ‹å®Œè§†é¢‘è¦ä¸‰è¿ä¸€æ · @Override public void close() throws IOException { serverChannel.close(); selector.close(); } } æœ€åæˆ‘ä»¬ç¼–å†™ä¸€ä¸‹ä¸»ç±»ï¼š\npublic static void main(String[] args) { //åˆ›å»ºReactorå¯¹è±¡ï¼Œå¯åŠ¨ï¼Œå®Œäº‹ try (Reactor reactor = new Reactor()){ reactor.run(); }catch (IOException e) { e.printStackTrace(); } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®ç°äº†å•çº¿ç¨‹Reactoræ¨¡å¼ï¼Œæ³¨æ„å…¨ç¨‹ä½¿ç”¨åˆ°çš„éƒ½åªæ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæ²¡æœ‰åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»ä½•äº‹æƒ…ã€‚\nä½†æ˜¯å•çº¿ç¨‹å§‹ç»ˆæ²¡åŠæ³•åº”å¯¹å¤§é‡çš„è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚é‡ä¸Šå»äº†ï¼Œå•çº¿ç¨‹è¿˜æ˜¯å¾ˆä¸å¤Ÿç”¨ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹å¤šçº¿ç¨‹Reactoræ¨¡å¼ï¼Œå®ƒåˆ›å»ºäº†å¤šä¸ªçº¿ç¨‹å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®è¯»å–å®Œæˆä¹‹åçš„æ“ä½œäº¤ç»™çº¿ç¨‹æ± æ¥æ‰§è¡Œï¼š\nå…¶å®æˆ‘ä»¬åªéœ€è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹Handlerå°±è¡Œäº†ï¼š\npublic class Handler implements Runnable{ //æŠŠçº¿ç¨‹æ± ç»™å®‰æ’äº†ï¼Œ10ä¸ªçº¿ç¨‹ private static final ExecutorService POOL = Executors.newFixedThreadPool(10); private final SocketChannel channel; public Handler(SocketChannel channel) { this.channel = channel; } @Override public void run() { try { ByteBuffer buffer = ByteBuffer.allocate(1024); channel.read(buffer); buffer.flip(); POOL.submit(() -\u0026gt; { try { System.out.println(\u0026#34;æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼š\u0026#34;+new String(buffer.array(), 0, buffer.remaining())); channel.write(ByteBuffer.wrap(\u0026#34;å·²æ”¶åˆ°ï¼\u0026#34;.getBytes())); }catch (IOException e){ e.printStackTrace(); } }); } catch (IOException e) { throw new RuntimeException(e); } } } è¿™æ ·ï¼Œåœ¨æ•°æ®è¯»å‡ºä¹‹åï¼Œå°±å¯ä»¥å°†æ•°æ®å¤„ç†äº¤ç»™çº¿ç¨‹æ± æ‰§è¡Œã€‚\nä½†æ˜¯è¿™æ ·æ„Ÿè§‰è¿˜æ˜¯åˆ’åˆ†çš„ä¸å¤Ÿï¼Œä¸€ä¸ªReactoréœ€è¦åŒæ—¶å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„æ‰€æœ‰æ“ä½œè¯·æ±‚ï¼Œæ˜¾å¾—æœ‰äº›ä¹åŠ›ï¼Œé‚£ä¹ˆä¸å¦¨æˆ‘ä»¬å°†Reactoråšæˆä¸€ä¸»å¤šä»çš„æ¨¡å¼ï¼Œè®©ä¸»Reactoråªè´Ÿè´£Acceptæ“ä½œï¼Œè€Œå…¶ä»–çš„Reactorè¿›è¡Œå„è‡ªçš„å…¶ä»–æ“ä½œï¼š\nç°åœ¨æˆ‘ä»¬æ¥é‡æ–°è®¾è®¡ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç ï¼ŒReactorç±»å°±ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œä¸è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œæˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹å…¶ä»–çš„ï¼š\n//SubReactorä½œä¸ºä»Reactor public class SubReactor implements Runnable, Closeable { //æ¯ä¸ªä»Reactorä¹Ÿæœ‰ä¸€ä¸ªSelector private final Selector selector; //åˆ›å»ºä¸€ä¸ª4çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œä¹Ÿå°±æ˜¯å››ä¸ªä»Reactorå·¥ä½œ private static final ExecutorService POOL = Executors.newFixedThreadPool(4); private static final SubReactor[] reactors = new SubReactor[4]; private static int selectedIndex = 0; //é‡‡ç”¨è½®è¯¢æœºåˆ¶ï¼Œæ¯æ¥å—ä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå°±è½®è¯¢åˆ†é…ç»™å››ä¸ªä»Reactor static { //åœ¨ä¸€å¼€å§‹çš„æ—¶å€™å°±è®©4ä¸ªä»Reactorè·‘èµ·æ¥ for (int i = 0; i \u0026lt; 4; i++) { try { reactors[i] = new SubReactor(); POOL.submit(reactors[i]); } catch (IOException e) { e.printStackTrace(); } } } //è½®è¯¢è·å–ä¸‹ä¸€ä¸ªSelectorï¼ˆAcceptorç”¨ï¼‰ public static Selector nextSelector(){ Selector selector = reactors[selectedIndex].selector; selectedIndex = (selectedIndex + 1) % 4; return selector; } private SubReactor() throws IOException { selector = Selector.open(); } @Override public void run() { try { //å¯åŠ¨åç›´æ¥ç­‰å¾…selectorç›‘å¬åˆ°å¯¹åº”çš„äº‹ä»¶å³å¯ï¼Œå…¶ä»–çš„æ“ä½œé€»è¾‘å’ŒReactorä¸€è‡´ while (true) { int count = selector.select(); System.out.println(Thread.currentThread().getName()+\u0026#34; \u0026gt;\u0026gt; ç›‘å¬åˆ° \u0026#34;+count+\u0026#34; ä¸ªäº‹ä»¶\u0026#34;); Set\u0026lt;SelectionKey\u0026gt; selectionKeys = selector.selectedKeys(); Iterator\u0026lt;SelectionKey\u0026gt; iterator = selectionKeys.iterator(); while (iterator.hasNext()) { this.dispatch(iterator.next()); iterator.remove(); } } }catch (IOException e) { e.printStackTrace(); } } private void dispatch(SelectionKey key){ Object att = key.attachment(); if(att instanceof Runnable) { ((Runnable) att).run(); } } @Override public void close() throws IOException { selector.close(); } } æˆ‘ä»¬æ¥ç€æ¥ä¿®æ”¹ä¸€ä¸‹Acceptorç±»ï¼š\npublic class Acceptor implements Runnable{ private final ServerSocketChannel serverChannel; //åªéœ€è¦ä¸€ä¸ªServerSocketChannelå°±è¡Œäº† public Acceptor(ServerSocketChannel serverChannel) { this.serverChannel = serverChannel; } @Override public void run() { try{ SocketChannel channel = serverChannel.accept(); //è¿˜æ˜¯æ­£å¸¸è¿›è¡ŒAcceptæ“ä½œï¼Œå¾—åˆ°SocketChannel System.out.println(Thread.currentThread().getName()+\u0026#34; \u0026gt;\u0026gt; å®¢æˆ·ç«¯å·²è¿æ¥ï¼ŒIPåœ°å€ä¸ºï¼š\u0026#34;+channel.getRemoteAddress()); channel.configureBlocking(false); Selector selector = SubReactor.nextSelector(); //é€‰å–ä¸‹ä¸€ä¸ªä»Reactorçš„Selector selector.wakeup(); //åœ¨æ³¨å†Œä¹‹å‰å”¤é†’ä¸€ä¸‹é˜²æ­¢å¡æ­» channel.register(selector, SelectionKey.OP_READ, new Handler(channel)); //æ³¨æ„ç°åœ¨æ³¨å†Œçš„æ˜¯ä»Reactorçš„Selector }catch (IOException e){ e.printStackTrace(); } } } ç°åœ¨ï¼ŒSocketChannelç›¸å…³çš„æ“ä½œå°±ç”±ä»Reactorè¿›è¡Œå¤„ç†äº†ï¼Œè€Œä¸æ˜¯ä¸€å¾‹äº¤ç»™ä¸»Reactorè¿›è¡Œæ“ä½œã€‚\nè‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†NIOçš„ä¸‰å¤§ç»„ä»¶ï¼šBufferã€Channelã€Selectorï¼Œæœ‰å…³NIOåŸºç¡€ç›¸å…³çš„å†…å®¹ï¼Œå°±è®²è§£åˆ°è¿™é‡Œã€‚ä¸‹ä¸€ç« æˆ‘ä»¬å°†ç»§ç»­è®²è§£åŸºäºNIOå®ç°çš„é«˜æ€§èƒ½ç½‘ç»œé€šä¿¡æ¡†æ¶Nettyã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/netty/nio/","section":"Docs","summary":"NIOåŸºç¡€ #\r**æ³¨æ„ï¼š**æ¨èå®ŒæˆJavaSEç¯‡ã€JavaWebç¯‡çš„å­¦ä¹ å†å¼€å¯è¿™ä¸€éƒ¨åˆ†çš„å­¦ä¹ ï¼Œå¦‚æœåœ¨è¿™ä¹‹å‰å®Œæˆäº†JVMç¯‡ï¼Œé‚£ä¹ˆçœ‹èµ·æ¥å°±ä¼šæ¯”è¾ƒè½»æ¾äº†ã€‚\nåœ¨JavaSEçš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†å¦‚ä½•ä½¿ç”¨IOè¿›è¡Œæ•°æ®ä¼ è¾“ï¼ŒJava IOæ˜¯é˜»å¡çš„ï¼Œå¦‚æœåœ¨ä¸€æ¬¡è¯»å†™æ•°æ®è°ƒç”¨æ—¶æ•°æ®è¿˜æ²¡æœ‰å‡†å¤‡å¥½ï¼Œæˆ–è€…ç›®å‰ä¸å¯å†™ï¼Œé‚£ä¹ˆè¯»å†™æ“ä½œå°±ä¼šè¢«é˜»å¡ç›´åˆ°æ•°æ®å‡†å¤‡å¥½æˆ–ç›®æ ‡å¯å†™ä¸ºæ­¢ã€‚Java NIOåˆ™æ˜¯éé˜»å¡çš„ï¼Œæ¯ä¸€æ¬¡æ•°æ®è¯»å†™è°ƒç”¨éƒ½ä¼šç«‹å³è¿”å›ï¼Œå¹¶å°†ç›®å‰å¯è¯»ï¼ˆæˆ–å¯å†™ï¼‰çš„å†…å®¹å†™å…¥ç¼“å†²åŒºæˆ–è€…ä»ç¼“å†²åŒºä¸­è¾“å‡ºï¼Œå³ä½¿å½“å‰æ²¡æœ‰å¯ç”¨æ•°æ®ï¼Œè°ƒç”¨ä»ç„¶ä¼šç«‹å³è¿”å›å¹¶ä¸”ä¸å¯¹ç¼“å†²åŒºåšä»»ä½•æ“ä½œã€‚\nNIOæ¡†æ¶æ˜¯åœ¨JDK1.4æ¨å‡ºçš„ï¼Œå®ƒçš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³ä¼ ç»ŸIOçš„ä¸è¶³ï¼Œè¿™ä¸€æœŸè§†é¢‘ï¼Œæˆ‘ä»¬å°±å°†å›´ç»•ç€NIOå¼€å§‹è®²è§£ã€‚\nç¼“å†²åŒº #\rä¸€åˆ‡çš„ä¸€åˆ‡è¿˜è¦ä»ç¼“å†²åŒºå¼€å§‹è®²èµ·ï¼ŒåŒ…æ‹¬æºç åœ¨å†…ï¼Œå…¶å®è¿™ä¸ªä¸æ˜¯å¾ˆéš¾ï¼Œåªæ˜¯éœ€è¦ç†æ¸…æ€è·¯ã€‚\nBufferç±»åŠå…¶å®ç° #\rBufferç±»æ˜¯ç¼“å†²åŒºçš„å®ç°ï¼Œç±»ä¼¼äºJavaä¸­çš„æ•°ç»„ï¼Œä¹Ÿæ˜¯ç”¨äºå­˜æ”¾å’Œè·å–æ•°æ®çš„ã€‚ä½†æ˜¯Bufferç›¸æ¯”Javaä¸­çš„æ•°ç»„ï¼ŒåŠŸèƒ½å°±éå¸¸å¼ºå¤§äº†ï¼Œå®ƒåŒ…å«ä¸€ç³»åˆ—å¯¹äºæ•°ç»„çš„å¿«æ·æ“ä½œã€‚\nBufferæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„æ ¸å¿ƒå†…å®¹ï¼š\npublic abstract class Buffer { // è¿™å››ä¸ªå˜é‡çš„å…³ç³»: mark \u0026lt;= position \u0026lt;= limit \u0026lt;= capacity // è¿™äº›å˜é‡å°±æ˜¯Bufferæ“ä½œçš„æ ¸å¿ƒäº†ï¼Œä¹‹åæˆ‘ä»¬å­¦ä¹ çš„è¿‡ç¨‹ä¸­å¯ä»¥çœ‹æºç æ˜¯å¦‚ä½•æ“ä½œè¿™äº›å˜é‡çš„ private int mark = -1; private int position = 0; private int limit; private int capacity; // ç›´æ¥ç¼“å†²åŒºå®ç°å­ç±»çš„æ•°æ®å†…å­˜åœ°å€ï¼ˆä¹‹åä¼šè®²è§£ï¼‰ long address; æˆ‘ä»¬æ¥çœ‹çœ‹Bufferç±»çš„å­ç±»ï¼ŒåŒ…æ‹¬æˆ‘ä»¬è®¤è¯†åˆ°çš„æ‰€æœ‰åŸºæœ¬ç±»å‹ï¼ˆé™¤äº† booleanç±»å‹ä¹‹å¤–ï¼‰ï¼š","title":"NIO","type":"doc"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/nionetty/","section":"Series","summary":"","title":"NIO\u0026Netty","type":"series"},{"content":"\ræ¶ˆæ¯é˜Ÿåˆ— #\rç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†æˆ‘ä»¬ä¹‹å‰çš„æŠ€æœ¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„åº”ç”¨ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹æœ€åä¸€ç« çš„å†…å®¹ã€‚\né‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—å‘¢ï¼Ÿ\næˆ‘ä»¬ä¹‹å‰å¦‚æœéœ€è¦è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œé‚£ä¹ˆä¸€èˆ¬å¯ä»¥é€šè¿‡å‘é€HTTPè¯·æ±‚æ¥å®Œæˆï¼Œè€Œç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œå°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒèƒ½å¤Ÿå°†å‘é€æ–¹å‘é€çš„ä¿¡æ¯æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå½“æ–°çš„æ¶ˆæ¯å…¥é˜Ÿæ—¶ï¼Œä¼šé€šçŸ¥æ¥æ”¶æ–¹è¿›è¡Œå¤„ç†ï¼Œä¸€èˆ¬æ¶ˆæ¯å‘é€æ–¹ç§°ä¸ºç”Ÿäº§è€…ï¼Œæ¥æ”¶æ–¹ç§°ä¸ºæ¶ˆè´¹è€…ã€‚\nè¿™æ ·æˆ‘ä»¬æ‰€æœ‰çš„è¯·æ±‚ï¼Œéƒ½å¯ä»¥ç›´æ¥ä¸¢åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå†ç”±æ¶ˆè´¹è€…å–å‡ºï¼Œä¸å†æ˜¯ç›´æ¥è¿æ¥æ¶ˆè´¹è€…çš„å½¢å¼äº†ï¼Œè€Œæ˜¯åŠ äº†ä¸€ä¸ªä¸­é—´å•†ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„è§£è€¦æ–¹æ¡ˆï¼Œå¹¶ä¸”åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œç”±äºæ¶ˆè´¹è€…èƒ½åŠ›æœ‰é™ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿèƒ½èµ·åˆ°ä¸€ä¸ªå‰Šå³°å¡«è°·çš„ä½œç”¨ï¼Œå †ç§¯ä¸€éƒ¨åˆ†çš„è¯·æ±‚ï¼Œå†ç”±æ¶ˆè´¹è€…æ¥æ…¢æ…¢å¤„ç†ï¼Œè€Œä¸ä¼šåƒç›´æ¥è°ƒç”¨é‚£æ ·è¯·æ±‚èœ‚æ‹¥è€Œè‡³ã€‚\né‚£ä¹ˆï¼Œæ¶ˆæ¯é˜Ÿåˆ—å…·ä½“å®ç°æœ‰å“ªäº›å‘¢ï¼š\nRabbitMQ - æ€§èƒ½å¾ˆå¼ºï¼Œååé‡å¾ˆé«˜ï¼Œæ”¯æŒå¤šç§åè®®ï¼Œé›†ç¾¤åŒ–ï¼Œæ¶ˆæ¯çš„å¯é æ‰§è¡Œç‰¹æ€§ç­‰ä¼˜åŠ¿ï¼Œå¾ˆé€‚åˆä¼ä¸šçš„å¼€å‘ã€‚ Kafka - æä¾›äº†è¶…é«˜çš„ååé‡ï¼Œmsçº§åˆ«çš„å»¶è¿Ÿï¼Œæé«˜çš„å¯ç”¨æ€§ä»¥åŠå¯é æ€§ï¼Œè€Œä¸”åˆ†å¸ƒå¼å¯ä»¥ä»»æ„æ‰©å±•ã€‚ RocketMQ - é˜¿é‡Œå·´å·´æ¨å‡ºçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç»å†è¿‡åŒåä¸€çš„è€ƒéªŒï¼Œå•æœºååé‡é«˜ï¼Œæ¶ˆæ¯çš„é«˜å¯é æ€§ï¼Œæ‰©å±•æ€§å¼ºï¼Œæ”¯æŒäº‹åŠ¡ç­‰ï¼Œä½†æ˜¯åŠŸèƒ½ä¸å¤Ÿå®Œæ•´ï¼Œè¯­è¨€æ”¯æŒæ€§è¾ƒå·®ã€‚ æˆ‘ä»¬è¿™é‡Œï¼Œä¸»è¦è®²è§£çš„æ˜¯RabbitMQæ¶ˆæ¯é˜Ÿåˆ—ã€‚\nRabbitMQ æ¶ˆæ¯é˜Ÿåˆ— #\rå®˜æ–¹ç½‘ç«™ï¼š https://www.rabbitmq.com\nRabbitMQæ‹¥æœ‰æ•°ä¸‡è®¡çš„ç”¨æˆ·ï¼Œæ˜¯æœ€å—æ¬¢è¿çš„å¼€æºæ¶ˆæ¯é˜Ÿåˆ—ä¹‹ä¸€ï¼Œä»\rT-Mobileåˆ°\rRuntasticï¼ŒRabbitMQåœ¨å…¨çƒèŒƒå›´å†…ç”¨äºå°å‹åˆåˆ›ä¼ä¸šå’Œå¤§å‹ä¼ä¸šã€‚\nRabbitMQè½»é‡çº§ï¼Œæ˜“äºåœ¨æœ¬åœ°å’Œäº‘ç«¯éƒ¨ç½²ï¼Œå®ƒæ”¯æŒå¤šç§æ¶ˆæ¯åè®®ã€‚RabbitMQå¯ä»¥éƒ¨ç½²åœ¨åˆ†å¸ƒå¼å’Œè”åˆé…ç½®ä¸­ï¼Œä»¥æ»¡è¶³å¤§è§„æ¨¡ã€é«˜å¯ç”¨æ€§è¦æ±‚ã€‚\nRabbitMQåœ¨è®¸å¤šæ“ä½œç³»ç»Ÿå’Œäº‘ç¯å¢ƒä¸­è¿è¡Œï¼Œå¹¶ä¸º\rå¤§å¤šæ•°æµè¡Œè¯­è¨€æä¾›äº†\rå¹¿æ³›çš„å¼€å‘è€…å·¥å…·ã€‚\næˆ‘ä»¬é¦–å…ˆè¿˜æ˜¯æ¥çœ‹çœ‹å¦‚ä½•è¿›è¡Œå®‰è£…ã€‚\nå®‰è£…æ¶ˆæ¯é˜Ÿåˆ— #\rä¸‹è½½åœ°å€ï¼š https://www.rabbitmq.com/download.html\nç”±äºé™¤äº†æ¶ˆæ¯é˜Ÿåˆ—æœ¬èº«ä¹‹å¤–è¿˜éœ€è¦Erlangç¯å¢ƒï¼ˆRabbitMQå°±æ˜¯è¿™ä¸ªè¯­è¨€å¼€å‘çš„ï¼‰æ‰€ä»¥æˆ‘ä»¬å°±åœ¨æˆ‘ä»¬çš„UbuntuæœåŠ¡å™¨ä¸Šè¿›è¡Œå®‰è£…ã€‚\né¦–å…ˆæ˜¯Erlangï¼Œæ¯”è¾ƒå¤§ï¼Œ1GBå·¦å³ï¼š\nsudo apt install erlang æ¥ç€å®‰è£…RabbitMQï¼š\nsudo apt install rabbitmq-server å®‰è£…å®Œæˆåï¼Œå¯ä»¥è¾“å…¥ï¼š\nsudo rabbitmqctl status æ¥æŸ¥çœ‹å½“å‰çš„RabbitMQè¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬è¿è¡Œç¯å¢ƒã€å†…å­˜å ç”¨ã€æ—¥å¿—æ–‡ä»¶ç­‰ä¿¡æ¯ï¼š\nRuntime\rOS PID: 13718\rOS: Linux\rUptime (seconds): 65\rIs under maintenance?: false\rRabbitMQ version: 3.8.9\rNode name: rabbit@ubuntu-server-2\rErlang configuration: Erlang/OTP 23 [erts-11.1.8] [source] [64-bit] [smp:2:2] [ds:2:2:10] [async-threads:64]\rErlang processes: 280 used, 1048576 limit\rScheduler run queue: 1\rCluster heartbeat timeout (net_ticktime): 60 è¿™æ ·æˆ‘ä»¬çš„RabbitMQæœåŠ¡å™¨å°±å®‰è£…å®Œæˆäº†ï¼Œè¦çœäº‹è¿˜å¾—æ˜¯Ubuntuå•Šã€‚\nå¯ä»¥çœ‹åˆ°é»˜è®¤æœ‰ä¸¤ä¸ªç«¯å£åè¢«ä½¿ç”¨ï¼š\nListeners\rInterface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication\rInterface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0 æˆ‘ä»¬ä¸€ä¼šä¸»è¦ä½¿ç”¨çš„å°±æ˜¯amqpåè®®çš„é‚£ä¸ªç«¯å£5672æ¥è¿›è¡Œè¿æ¥ï¼Œ25672æ˜¯é›†ç¾¤åŒ–ç«¯å£ï¼Œä¹‹åæˆ‘ä»¬ä¹Ÿä¼šç”¨åˆ°ã€‚\næ¥ç€æˆ‘ä»¬è¿˜å¯ä»¥å°†RabbitMQçš„ç®¡ç†é¢æ¿å¼€å¯ï¼Œè¿™æ ·è¯å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸Šè¿›è¡Œå®æ—¶è®¿é—®å’Œç›‘æ§äº†ï¼š\nsudo rabbitmq-plugins enable rabbitmq_management å†æ¬¡æŸ¥çœ‹çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°å¤šäº†ä¸€ä¸ªç®¡ç†é¢æ¿ï¼Œä½¿ç”¨çš„æ˜¯HTTPåè®®ï¼š\nListeners\rInterface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication\rInterface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0\rInterface: [::], port: 15672, protocol: http, purpose: HTTP API æˆ‘ä»¬æ‰“å¼€æµè§ˆå™¨ç›´æ¥è®¿é—®ä¸€ä¸‹ï¼š\nå¯ä»¥çœ‹åˆ°éœ€è¦æˆ‘ä»¬è¿›è¡Œç™»å½•æ‰å¯ä»¥è¿›å…¥ï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·æ‰å¯ä»¥ï¼Œè¿™é‡Œå°±éƒ½ç”¨adminï¼š\nsudo rabbitmqctl add_user ç”¨æˆ·å å¯†ç  å°†ç®¡ç†å‘˜æƒé™ç»™äºˆæˆ‘ä»¬åˆšåˆšåˆ›å»ºå¥½çš„ç”¨æˆ·ï¼š\nsudo rabbitmqctl set_user_tags admin administrator åˆ›å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬ç™»å½•ä¸€ä¸‹é¡µé¢ï¼š\nè¿›å…¥äº†ä¹‹åä¼šæ˜¾ç¤ºå½“å‰çš„æ¶ˆæ¯é˜Ÿåˆ—æƒ…å†µï¼ŒåŒ…æ‹¬ç‰ˆæœ¬å·ã€Erlangç‰ˆæœ¬ç­‰ï¼Œè¿™é‡Œéœ€è¦ä»‹ç»ä¸€ä¸‹RabbitMQçš„è®¾è®¡æ¶æ„ï¼Œè¿™æ ·æˆ‘ä»¬å°±çŸ¥é“å„ä¸ªæ¨¡å—ç®¡ç†çš„æ˜¯ä»€ä¹ˆå†…å®¹äº†ï¼š\nç”Ÿäº§è€…ï¼ˆPublisherï¼‰å’Œæ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼š ä¸ç”¨å¤šè¯´äº†å§ã€‚ Channelï¼š æˆ‘ä»¬çš„å®¢æˆ·ç«¯è¿æ¥éƒ½ä¼šä½¿ç”¨ä¸€ä¸ªChannelï¼Œå†é€šè¿‡Channelå»è®¿é—®åˆ°RabbitMQæœåŠ¡å™¨ï¼Œæ³¨æ„é€šä¿¡åè®®ä¸æ˜¯httpï¼Œè€Œæ˜¯amqpåè®®ã€‚ Exchangeï¼š ç±»ä¼¼äºäº¤æ¢æœºä¸€æ ·çš„å­˜åœ¨ï¼Œä¼šæ ¹æ®æˆ‘ä»¬çš„è¯·æ±‚ï¼Œè½¬å‘ç»™ç›¸åº”çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½å¯ä»¥ç»‘å®šåˆ°Exchangeä¸Šï¼Œè¿™æ ·Exchangeå°±å¯ä»¥å°†æ•°æ®è½¬å‘ç»™é˜Ÿåˆ—äº†ï¼Œå¯ä»¥å­˜åœ¨å¾ˆå¤šä¸ªï¼Œä¸åŒçš„Exchangeç±»å‹å¯ä»¥ç”¨äºå®ç°ä¸åŒæ¶ˆæ¯çš„æ¨¡å¼ã€‚ Queueï¼š æ¶ˆæ¯é˜Ÿåˆ—æœ¬ä½“ï¼Œç”Ÿäº§è€…æ‰€æœ‰çš„æ¶ˆæ¯éƒ½å­˜æ”¾åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…æ¶ˆè´¹è€…å–å‡ºã€‚ Virtual Hostï¼š æœ‰ç‚¹ç±»ä¼¼äºç¯å¢ƒéš”ç¦»ï¼Œä¸åŒç¯å¢ƒéƒ½å¯ä»¥å•ç‹¬é…ç½®ä¸€ä¸ªVirtual Hostï¼Œæ¯ä¸ªVirtual Hostå¯ä»¥åŒ…å«å¾ˆå¤šä¸ªExchangeå’ŒQueueï¼Œæ¯ä¸ªVirtual Hostç›¸äº’ä¹‹é—´ä¸å½±å“ã€‚ ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ— #\ræˆ‘ä»¬å°±ä»æœ€ç®€çš„çš„æ¨¡å‹å¼€å§‹è®²èµ·ï¼š\nï¼ˆä¸€ä¸ªç”Ÿäº§è€… -\u0026gt; æ¶ˆæ¯é˜Ÿåˆ— -\u0026gt; ä¸€ä¸ªæ¶ˆè´¹è€…ï¼‰\nç”Ÿäº§è€…åªéœ€è¦å°†æ•°æ®ä¸¢è¿›æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œæ¶ˆè´¹è€…åªéœ€è¦å°†æ•°æ®ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºï¼Œè¿™æ ·å°±å®ç°äº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„æ¶ˆæ¯äº¤äº’ã€‚æˆ‘ä»¬ç°åœ¨æ¥æ¼”ç¤ºä¸€ä¸‹ï¼Œé¦–å…ˆè¿›å…¥åˆ°æˆ‘ä»¬çš„ç®¡ç†é¡µé¢ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å®éªŒç¯å¢ƒï¼Œåªéœ€è¦æ–°å»ºä¸€ä¸ªVirtual Hostå³å¯ï¼š\næ·»åŠ æ–°çš„è™šæ‹Ÿä¸»æœºä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“å‰adminç”¨æˆ·çš„ä¸»æœºè®¿é—®æƒé™ä¸­æ–°å¢äº†æˆ‘ä»¬åˆšåˆšæ·»åŠ çš„ç¯å¢ƒï¼š\nç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹äº¤æ¢æœºï¼š\näº¤æ¢æœºåˆ—è¡¨ä¸­è‡ªåŠ¨ä¸ºæˆ‘ä»¬æ–°å¢äº†åˆšåˆšåˆ›å»ºå¥½çš„è™šæ‹Ÿä¸»æœºç›¸å…³çš„é¢„è®¾äº¤æ¢æœºï¼Œä¸€å…±7ä¸ªï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€ä¸‹å‰é¢ä¸¤ä¸ªdirectç±»å‹çš„äº¤æ¢æœºï¼Œä¸€ä¸ªæ˜¯ï¼ˆAMQP defaultï¼‰è¿˜æœ‰ä¸€ä¸ªæ˜¯amq.directï¼Œå®ƒä»¬éƒ½æ˜¯ç›´è¿æ¨¡å¼çš„äº¤æ¢æœºï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬ä¸€ä¸ªï¼š\nç¬¬ä¸€ä¸ªäº¤æ¢æœºæ˜¯æ‰€æœ‰è™šæ‹Ÿä¸»æœºéƒ½ä¼šè‡ªå¸¦çš„ä¸€ä¸ªé»˜è®¤äº¤æ¢æœºï¼Œå¹¶ä¸”æ­¤äº¤æ¢æœºä¸å¯åˆ é™¤ï¼Œæ­¤äº¤æ¢æœºé»˜è®¤ç»‘å®šåˆ°æ‰€æœ‰çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚æœæ˜¯é€šè¿‡é»˜è®¤äº¤æ¢æœºå‘é€æ¶ˆæ¯ï¼Œé‚£ä¹ˆä¼šæ ¹æ®æ¶ˆæ¯çš„routingKeyï¼ˆä¹‹åæˆ‘ä»¬å‘æ¶ˆæ¯éƒ½ä¼šæŒ‡å®šï¼‰å†³å®šå‘é€ç»™å“ªä¸ªåŒåçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½æ˜¾ç¤ºåœ°å°†æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šæˆ–è§£ç»‘åˆ°æ­¤äº¤æ¢æœºã€‚\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯¦ç»†ä¿¡æ¯ä¸­ï¼Œå½“å‰äº¤æ¢æœºç‰¹æ€§æ˜¯æŒä¹…åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å°±ç®—æœºå™¨é‡å¯ï¼Œé‚£ä¹ˆæ­¤äº¤æ¢æœºä¹Ÿä¼šä¿ç•™ï¼Œå¦‚æœä¸æ˜¯æŒä¹…åŒ–ï¼Œé‚£ä¹ˆä¸€æ—¦é‡å¯å°±ä¼šæ¶ˆå¤±ã€‚å®é™…ä¸Šæˆ‘ä»¬åœ¨åˆ—è¡¨ä¸­çœ‹åˆ°Dçš„å­—æ ·ï¼Œå°±è¡¨ç¤ºæ­¤äº¤æ¢æœºæ˜¯æŒä¹…åŒ–çš„ï¼ŒåŒ…å«ä¸€ä¼šæˆ‘ä»¬è¦è®²è§£çš„æ¶ˆæ¯é˜Ÿåˆ—åˆ—è¡¨ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ‰€æœ‰è‡ªåŠ¨ç”Ÿæˆçš„äº¤æ¢æœºéƒ½æ˜¯æŒä¹…åŒ–çš„ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹ç¬¬äºŒä¸ªäº¤æ¢æœºï¼Œè¿™ä¸ªäº¤æ¢æœºæ˜¯ä¸€ä¸ªæ™®é€šçš„ç›´è¿äº¤æ¢æœºï¼š\nè¿™ä¸ªäº¤æ¢æœºå’Œæˆ‘ä»¬åˆšåˆšä»‹ç»çš„é»˜è®¤äº¤æ¢æœºç±»å‹ä¸€è‡´ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æŒä¹…åŒ–çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæ˜¯å…·æœ‰ç»‘å®šå…³ç³»çš„ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šçš„æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šåˆ°æ­¤äº¤æ¢æœºä¸Šï¼Œé‚£ä¹ˆè¿™ä¸ªäº¤æ¢æœºæ— æ³•æ­£å¸¸å°†ä¿¡æ¯å­˜æ”¾åˆ°æŒ‡å®šçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œä¹Ÿæ˜¯æ ¹æ®routingKeyå¯»æ‰¾æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆä½†æ˜¯å¯ä»¥è‡ªå®šä¹‰ï¼‰\næˆ‘ä»¬å¯ä»¥åœ¨ä¸‹é¢ç›´æ¥æ“ä½œï¼Œè®©æŸä¸ªé˜Ÿåˆ—ç»‘å®šï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆä¸è¿›è¡Œæ“ä½œã€‚\nä»‹ç»å®Œäº†ä¸¤ä¸ªæœ€åŸºæœ¬çš„äº¤æ¢æœºä¹‹åï¼ˆå…¶ä»–ç±»å‹çš„äº¤æ¢æœºæˆ‘ä»¬ä¼šåœ¨åé¢è¿›è¡Œä»‹ç»ï¼‰ï¼Œæˆ‘ä»¬æ¥ç€æ¥çœ‹æ¶ˆæ¯é˜Ÿåˆ—ï¼š\nå¯ä»¥çœ‹åˆ°æ¶ˆæ¯é˜Ÿåˆ—åˆ—è¡¨ä¸­æ²¡æœ‰ä»»ä½•çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å°è¯•æ·»åŠ ä¸€ä¸ªæ–°çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼š\nç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬é€‰æ‹©æˆ‘ä»¬åˆšåˆšåˆ›å»ºå¥½çš„è™šæ‹Ÿä¸»æœºï¼Œåœ¨è¿™ä¸ªè™šæ‹Ÿä¸»æœºä¸‹åˆ›å»ºæ­¤æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¥ç€æˆ‘ä»¬å°†å…¶ç±»å‹å®šä¹‰ä¸ºClassicç±»å‹ï¼Œä¹Ÿå°±æ˜¯ç»å…¸ç±»å‹ï¼ˆå…¶ä»–ç±»å‹æˆ‘ä»¬ä¼šåœ¨åé¢é€æ­¥ä»‹ç»ï¼‰åç§°éšä¾¿èµ·ä¸€ä¸ªï¼Œç„¶åæŒä¹…åŒ–æˆ‘ä»¬é€‰æ‹©Transientæš‚æ—¶çš„ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æŒä¹…åŒ–ï¼Œçœ‹ä½ è‡ªå·±ï¼‰è‡ªåŠ¨åˆ é™¤æˆ‘ä»¬é€‰æ‹©Noï¼ˆéœ€è¦è‡³å°‘æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…è¿æ¥åˆ°è¿™ä¸ªé˜Ÿåˆ—ï¼Œä¹‹åï¼Œä¸€æ—¦æ‰€æœ‰ä¸è¿™ä¸ªé˜Ÿåˆ—è¿æ¥çš„æ¶ˆè´¹è€…éƒ½æ–­å¼€æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨åˆ é™¤æ­¤é˜Ÿåˆ—ï¼‰æœ€ä¸‹é¢çš„å‚æ•°æˆ‘ä»¬æš‚æ—¶ä¸è¿›è¡Œä»»ä½•è®¾ç½®ï¼ˆä¹‹åä¼šç”¨åˆ°ï¼‰\nç°åœ¨ï¼Œæˆ‘ä»¬å°±åˆ›å»ºå¥½äº†ä¸€ä¸ªç»å…¸çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼š\nç‚¹å‡»æ­¤é˜Ÿåˆ—çš„åç§°ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼š\nè¯¦ç»†ç›¸ä¿¡ä¸­åŒ…æ‹¬é˜Ÿåˆ—çš„å½“å‰è´Ÿè½½çŠ¶æ€ã€å±æ€§ã€æ¶ˆæ¯é˜Ÿåˆ—å ç”¨çš„å†…å­˜ï¼Œæ¶ˆæ¯æ•°é‡ç­‰ï¼Œä¸€ä¼šæˆ‘ä»¬å‘é€æ¶ˆæ¯æ—¶å¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œè§‚å¯Ÿã€‚\nç°åœ¨æˆ‘ä»¬éœ€è¦å°†æ­¤æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šåˆ°ä¸Šé¢çš„ç¬¬äºŒä¸ªç›´è¿äº¤æ¢æœºï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ­¤äº¤æ¢æœºå‘æ­¤æ¶ˆæ¯é˜Ÿåˆ—å‘é€æ¶ˆæ¯äº†ï¼š\nè¿™é‡Œå¡«å†™ä¹‹å‰ç¬¬äºŒä¸ªäº¤æ¢æœºçš„åç§°è¿˜æœ‰æˆ‘ä»¬è‡ªå®šä¹‰çš„routingKeyï¼ˆæœ€å¥½è¿˜æ˜¯å’Œæ¶ˆæ¯é˜Ÿåˆ—åç§°ä¸€è‡´ï¼Œè¿™é‡Œæ˜¯ä¸ºäº†ä¸€ä¼šæ¼”ç¤ºä¸¤ä¸ªäº¤æ¢æœºåŒºåˆ«ç”¨ï¼‰æˆ‘ä»¬ç›´æ¥ç‚¹å‡»ç»‘å®šå³å¯ï¼š\nç»‘å®šä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“å‰é˜Ÿåˆ—å·²ç»ç»‘å®šå¯¹åº”çš„äº¤æ¢æœºäº†ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å‰å¾€äº¤æ¢æœºå¯¹æ­¤æ¶ˆæ¯é˜Ÿåˆ—å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼š\nå›åˆ°äº¤æ¢æœºä¹‹åï¼Œå¯ä»¥å¡åˆ°è¿™è¾¹ä¹Ÿæ˜¯åŒæ­¥äº†å½“å‰çš„ç»‘å®šä¿¡æ¯ï¼Œåœ¨ä¸‹æ–¹ï¼Œæˆ‘ä»¬ç›´æ¥å‘æ­¤æ¶ˆæ¯é˜Ÿåˆ—å‘é€ä¿¡æ¯ï¼š\nç‚¹å‡»å‘é€ä¹‹åï¼Œæˆ‘ä»¬å›åˆ°åˆšåˆšçš„äº¤æ¢æœºè¯¦ç»†é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸€æ¡æ–°çš„æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­äº†ï¼š\næˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ¶ˆæ¯é˜Ÿåˆ—è¿™è¾¹è·å–æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œæ‰¾åˆ°ä¸‹æ–¹çš„Get messageé€‰é¡¹ï¼š\nå¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªé€‰æ‹©ï¼Œé¦–å…ˆç¬¬ä¸€ä¸ªAck Modeï¼Œè¿™ä¸ªæ˜¯åº”ç­”æ¨¡å¼é€‰æ‹©ï¼Œä¸€å…±æœ‰4ä¸ªé€‰é¡¹ï¼š\nNack message requeue trueï¼šæ‹’ç»æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šå°†æ¶ˆæ¯ä»æ¶ˆæ¯é˜Ÿåˆ—å–å‡ºï¼Œå¹¶ä¸”é‡æ–°æ’é˜Ÿï¼Œä¸€æ¬¡å¯ä»¥æ‹’ç»å¤šä¸ªæ¶ˆæ¯ã€‚ Ack message requeue falseï¼šç¡®è®¤åº”ç­”ï¼Œç¡®è®¤åæ¶ˆæ¯ä¼šä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œä¸€æ¬¡å¯ä»¥ç¡®è®¤å¤šä¸ªæ¶ˆæ¯ã€‚ Reject message requeue true/falseï¼šä¹Ÿæ˜¯æ‹’ç»æ­¤æ¶ˆæ¯ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šæ˜¯å¦é‡æ–°æ’é˜Ÿã€‚ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„å°±å¯ä»¥äº†ï¼Œè¿™æ ·åªä¼šæŸ¥çœ‹æ¶ˆæ¯æ˜¯å•¥ï¼Œä½†æ˜¯ä¸ä¼šå–å‡ºï¼Œæ¶ˆæ¯ä¾ç„¶å­˜åœ¨äºæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç¼–ç æ ¼å¼ï¼Œä½¿ç”¨é»˜è®¤çš„å°±å¯ä»¥äº†ï¼Œæœ€åå°±æ˜¯è¦ç”Ÿæ•ˆçš„æ“ä½œæ•°é‡ï¼Œé€‰æ‹©1å°±è¡Œï¼š\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšåˆšçš„æ¶ˆæ¯å·²ç»æˆåŠŸè¯»å–åˆ°ã€‚\nç°åœ¨æˆ‘ä»¬å†å»ç¬¬ä¸€ä¸ªé»˜è®¤äº¤æ¢æœºä¸­å°è¯•å‘é€æ¶ˆæ¯è¯•è¯•çœ‹ï¼š\nå¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¹‹å‰è‡ªå®šä¹‰çš„routingKeyï¼Œä¼šæ˜¾ç¤ºæ²¡æœ‰è·¯ç”±ï¼Œè¿™æ˜¯å› ä¸ºé»˜è®¤çš„äº¤æ¢æœºåªä¼šæ‰¾å¯¹åº”åç§°çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬ç°åœ¨å‘yydså‘é€ä¸€ä¸‹è¯•è¯•çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°æ¶ˆæ¯æˆåŠŸå‘å¸ƒäº†ï¼Œæˆ‘ä»¬æ¥æ¥æ”¶ä¸€ä¸‹çœ‹çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°æˆåŠŸå‘é€åˆ°æ­¤æ¶ˆæ¯é˜Ÿåˆ—ä¸­äº†ã€‚\nå½“ç„¶é™¤äº†åœ¨äº¤æ¢æœºå‘é€æ¶ˆæ¯ç»™æ¶ˆæ¯é˜Ÿåˆ—ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æ¶ˆæ¯é˜Ÿåˆ—è¿™é‡Œå‘ï¼š\næ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œæ³¨æ„è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜¯å¦å°†æ¶ˆæ¯æŒä¹…åŒ–ï¼Œå¦‚æœæ˜¯æŒä¹…åŒ–æ¶ˆæ¯ï¼Œé‚£ä¹ˆå°±ç®—æœåŠ¡å™¨é‡å¯ï¼Œæ­¤æ¶ˆæ¯ä¹Ÿä¼šä¿å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚\næœ€åå¦‚æœæˆ‘ä»¬ä¸éœ€è¦å†ä½¿ç”¨æ­¤æ¶ˆæ¯é˜Ÿåˆ—äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å¯¹å…¶è¿›è¡Œåˆ é™¤æˆ–æ˜¯æ¸…ç©ºï¼š\nç‚¹å‡»Delete Queueåˆ é™¤æˆ‘ä»¬åˆšåˆšåˆ›å»ºå¥½çš„yydsé˜Ÿåˆ—ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹åº”æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸€äº›ç®€å•ä½¿ç”¨ï¼Œå°±è®²è§£å®Œæ¯•äº†ã€‚\nä½¿ç”¨Javaæ“ä½œæ¶ˆæ¯é˜Ÿåˆ— #\rç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•é€šè¿‡Javaè¿æ¥åˆ°RabbitMQæœåŠ¡å™¨å¹¶ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œæ¶ˆæ¯å‘é€ï¼ˆè¿™é‡Œä¸€èµ·è®²è§£ï¼ŒåŒ…æ‹¬JavaåŸºç¡€ç‰ˆæœ¬å’ŒSpringBootç‰ˆæœ¬ï¼‰ï¼Œé¦–å…ˆæˆ‘ä»¬ä½¿ç”¨æœ€åŸºæœ¬çš„Javaå®¢æˆ·ç«¯è¿æ¥æ–¹å¼ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.rabbitmq\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;amqp-client\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.14.2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; ä¾èµ–å¯¼å…¥ä¹‹åï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œé¦–å…ˆæ˜¯ç”Ÿäº§è€…ï¼Œç”Ÿäº§è€…è´Ÿè´£å°†ä¿¡æ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼š\npublic static void main(String[] args) { //ä½¿ç”¨ConnectionFactoryæ¥åˆ›å»ºè¿æ¥ ConnectionFactory factory = new ConnectionFactory(); //è®¾å®šè¿æ¥ä¿¡æ¯ï¼ŒåŸºæ“ factory.setHost(\u0026#34;192.168.0.12\u0026#34;); factory.setPort(5672); //æ³¨æ„è¿™é‡Œå†™5672ï¼Œæ˜¯amqpåè®®ç«¯å£ factory.setUsername(\u0026#34;admin\u0026#34;); factory.setPassword(\u0026#34;admin\u0026#34;); factory.setVirtualHost(\u0026#34;/test\u0026#34;); //åˆ›å»ºè¿æ¥ try(Connection connection = factory.newConnection()){ }catch (Exception e){ e.printStackTrace(); } } è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ç¨‹åºä¸­å®šä¹‰å¹¶åˆ›å»ºæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå®é™…ä¸Šæ˜¯å’Œæˆ‘ä»¬åœ¨ç®¡ç†é¡µé¢åˆ›å»ºä¸€æ ·çš„æ•ˆæœï¼‰å®¢æˆ·ç«¯éœ€è¦é€šè¿‡è¿æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„é€šé“ï¼ˆChannelï¼‰ï¼ŒåŒä¸€ä¸ªè¿æ¥ä¸‹å¯ä»¥æœ‰å¾ˆå¤šä¸ªé€šé“ï¼Œè¿™æ ·å°±ä¸ç”¨åˆ›å»ºå¾ˆå¤šä¸ªè¿æ¥ä¹Ÿèƒ½æ”¯æŒåˆ†å¼€å‘é€äº†ã€‚\ntry(Connection connection = factory.newConnection(); Channel channel = connection.createChannel()){ //é€šè¿‡Connectionåˆ›å»ºæ–°çš„Channel //å£°æ˜é˜Ÿåˆ—ï¼Œå¦‚æœæ­¤é˜Ÿåˆ—ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»º channel.queueDeclare(\u0026#34;yyds\u0026#34;, false, false, false, null); //å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº channel.queueBind(\u0026#34;yyds\u0026#34;, \u0026#34;amq.direct\u0026#34;, \u0026#34;my-yyds\u0026#34;); //å‘å¸ƒæ–°çš„æ¶ˆæ¯ï¼Œæ³¨æ„æ¶ˆæ¯éœ€è¦è½¬æ¢ä¸ºbyte[] channel.basicPublish(\u0026#34;amq.direct\u0026#34;, \u0026#34;my-yyds\u0026#34;, null, \u0026#34;Hello World!\u0026#34;.getBytes()); }catch (Exception e){ e.printStackTrace(); } å…¶ä¸­queueDeclareæ–¹æ³•çš„å‚æ•°å¦‚ä¸‹ï¼š\nqueueï¼šé˜Ÿåˆ—çš„åç§°ï¼ˆé»˜è®¤åˆ›å»ºåroutingKeyå’Œé˜Ÿåˆ—åç§°ä¸€è‡´ï¼‰ durableï¼šæ˜¯å¦æŒä¹…åŒ–ã€‚ exclusiveï¼šæ˜¯å¦æ’ä»–ï¼Œå¦‚æœä¸€ä¸ªé˜Ÿåˆ—è¢«å£°æ˜ä¸ºæ’ä»–é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—ä»…å¯¹é¦–æ¬¡å£°æ˜å®ƒçš„è¿æ¥å¯è§ï¼Œå¹¶åœ¨è¿æ¥æ–­å¼€æ—¶è‡ªåŠ¨åˆ é™¤ã€‚æ’ä»–é˜Ÿåˆ—æ˜¯åŸºäºConnectionå¯è§ï¼ŒåŒä¸€ä¸ªConnectionçš„ä¸åŒChannelæ˜¯å¯ä»¥åŒæ—¶è®¿é—®åŒä¸€ä¸ªè¿æ¥åˆ›å»ºçš„æ’ä»–é˜Ÿåˆ—ï¼Œå¹¶ä¸”ï¼Œå¦‚æœä¸€ä¸ªConnectionå·²ç»å£°æ˜äº†ä¸€ä¸ªæ’ä»–é˜Ÿåˆ—ï¼Œå…¶ä»–çš„Connectionæ˜¯ä¸å…è®¸å»ºç«‹åŒåçš„æ’ä»–é˜Ÿåˆ—çš„ï¼Œå³ä½¿è¯¥é˜Ÿåˆ—æ˜¯æŒä¹…åŒ–çš„ï¼Œä¸€æ—¦Connectionå…³é—­æˆ–è€…å®¢æˆ·ç«¯é€€å‡ºï¼Œè¯¥æ’ä»–é˜Ÿåˆ—éƒ½ä¼šè‡ªåŠ¨è¢«åˆ é™¤ã€‚ autoDeleteï¼šæ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚ argumentsï¼šè®¾ç½®é˜Ÿåˆ—çš„å…¶ä»–ä¸€äº›å‚æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦ä»€ä¹ˆå…¶ä»–å‚æ•°ã€‚ å…¶ä¸­queueBindæ–¹æ³•å‚æ•°å¦‚ä¸‹ï¼š\nqueueï¼šéœ€è¦ç»‘å®šçš„é˜Ÿåˆ—åç§°ã€‚ exchangeï¼šéœ€è¦ç»‘å®šçš„äº¤æ¢æœºåç§°ã€‚ routingKeyï¼šä¸ç”¨å¤šè¯´äº†å§ã€‚ å…¶ä¸­basicPublishæ–¹æ³•çš„å‚æ•°å¦‚ä¸‹ï¼š\nexchange: å¯¹åº”çš„Exchangeåç§°ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä½¿ç”¨ç¬¬äºŒä¸ªç›´è¿äº¤æ¢æœºã€‚ routingKeyï¼šè¿™é‡Œæˆ‘ä»¬å¡«å†™ç»‘å®šæ—¶æŒ‡å®šçš„routingKeyï¼Œå…¶å®å’Œä¹‹å‰åœ¨ç®¡ç†é¡µé¢æ“ä½œä¸€æ ·ã€‚ propsï¼šå…¶ä»–çš„é…ç½®ã€‚ bodyï¼šæ¶ˆæ¯æœ¬ä½“ã€‚ æ‰§è¡Œå®Œæˆåï¼Œå¯ä»¥åœ¨ç®¡ç†é¡µé¢ä¸­çœ‹åˆ°æˆ‘ä»¬åˆšåˆšåˆ›å»ºå¥½çš„æ¶ˆæ¯é˜Ÿåˆ—äº†ï¼š\nå¹¶ä¸”æ­¤æ¶ˆæ¯é˜Ÿåˆ—å·²ç»æˆåŠŸä¸amq.directäº¤æ¢æœºè¿›è¡Œç»‘å®šï¼š\né‚£ä¹ˆç°åœ¨æˆ‘ä»¬çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­å·²ç»å­˜åœ¨æ•°æ®äº†ï¼Œæ€ä¹ˆå°†å…¶è¯»å–å‡ºæ¥å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ¶ˆè´¹è€…ï¼š\npublic static void main(String[] args) throws IOException, TimeoutException { ConnectionFactory factory = new ConnectionFactory(); factory.setHost(\u0026#34;10.37.129.4\u0026#34;); factory.setPort(5672); factory.setUsername(\u0026#34;admin\u0026#34;); factory.setPassword(\u0026#34;admin\u0026#34;); factory.setVirtualHost(\u0026#34;/test\u0026#34;); //è¿™é‡Œä¸ä½¿ç”¨try-with-resourceï¼Œå› ä¸ºæ¶ˆè´¹è€…æ˜¯ä¸€ç›´ç­‰å¾…æ–°çš„æ¶ˆæ¯åˆ°æ¥ï¼Œç„¶åæŒ‰ç…§ //æˆ‘ä»¬è®¾å®šçš„é€»è¾‘è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½åœ¨å®šä¹‰å®Œæˆä¹‹åå°±å…³é—­è¿æ¥ Connection connection = factory.newConnection(); Channel channel = connection.createChannel(); //åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„æ¶ˆè´¹è€… channel.basicConsume(\u0026#34;yyds\u0026#34;, false, (s, delivery) -\u0026gt; { System.out.println(new String(delivery.getBody())); //basicAckæ˜¯ç¡®è®¤åº”ç­”ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½“å‰çš„æ¶ˆæ¯æ ‡ç­¾ï¼Œåé¢çš„å‚æ•°æ˜¯ //æ˜¯å¦æ‰¹é‡å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ‰€æœ‰çš„æ¶ˆæ¯ï¼Œå¦‚æœä¸ºfalseè¡¨ç¤ºåªå¤„ç†å½“å‰æ¶ˆæ¯ channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false); //basicNackæ˜¯æ‹’ç»åº”ç­”ï¼Œæœ€åä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦å°†å½“å‰æ¶ˆæ¯æ”¾å›é˜Ÿåˆ—ï¼Œå¦‚æœ //ä¸ºfalseï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¼šè¢«ä¸¢å¼ƒ //channel.basicNack(delivery.getEnvelope().getDeliveryTag(), false, false); //è·Ÿä¸Šé¢ä¸€æ ·ï¼Œæœ€åä¸€ä¸ªå‚æ•°ä¸ºfalseï¼Œåªä¸è¿‡è¿™é‡Œçœäº† //channel.basicReject(delivery.getEnvelope().getDeliveryTag(), false); }, s -\u0026gt; {}); } å…¶ä¸­basicConsumeæ–¹æ³•å‚æ•°å¦‚ä¸‹ï¼š\nqueue - æ¶ˆæ¯é˜Ÿåˆ—åç§°ï¼Œç›´æ¥æŒ‡å®šã€‚ autoAck - è‡ªåŠ¨åº”ç­”ï¼Œæ¶ˆè´¹è€…ä»æ¶ˆæ¯é˜Ÿåˆ—å–å‡ºæ•°æ®åï¼Œéœ€è¦è·ŸæœåŠ¡å™¨è¿›è¡Œç¡®è®¤åº”ç­”ï¼Œå½“æœåŠ¡å™¨æ”¶åˆ°ç¡®è®¤åï¼Œä¼šè‡ªåŠ¨å°†æ¶ˆæ¯åˆ é™¤ï¼Œå¦‚æœå¼€å¯è‡ªåŠ¨åº”ç­”ï¼Œé‚£ä¹ˆæ¶ˆæ¯å‘å‡ºåä¼šç›´æ¥åˆ é™¤ã€‚ deliver - æ¶ˆæ¯æ¥æ”¶åçš„å‡½æ•°å›è°ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å›è°ƒä¸­å¯¹æ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œæˆåï¼Œéœ€è¦ç»™æœåŠ¡å™¨ç¡®è®¤åº”ç­”ã€‚ cancel - å½“æ¶ˆè´¹è€…å–æ¶ˆè®¢é˜…æ—¶è¿›è¡Œçš„å‡½æ•°å›è°ƒï¼Œè¿™é‡Œæš‚æ—¶ç”¨ä¸åˆ°ã€‚ ç°åœ¨æˆ‘ä»¬å¯åŠ¨ä¸€ä¸‹æ¶ˆè´¹è€…ï¼Œå¯ä»¥çœ‹åˆ°ç«‹å³è¯»å–åˆ°æˆ‘ä»¬åˆšåˆšæ’å…¥åˆ°é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼š\næˆ‘ä»¬ç°åœ¨ç»§ç»­åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ’å…¥æ–°çš„æ•°æ®ï¼Œè¿™é‡Œç›´æ¥åœ¨ç½‘é¡µä¸Šè¿›è¡Œæ“ä½œå°±è¡Œäº†ï¼ŒåŒæ ·çš„æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ¶ˆè´¹è€…ç«¯æ¥å—å¹¶è¿›è¡Œå¤„ç†ã€‚\nç°åœ¨æˆ‘ä»¬æŠŠåˆšåˆšåˆ›å»ºå¥½çš„æ¶ˆæ¯é˜Ÿåˆ—åˆ é™¤ã€‚\nå®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.spring.io/spring-amqp/docs/current/reference/html/\nå‰é¢æˆ‘ä»¬å·²ç»å®Œæˆäº†RabbitMQçš„å®‰è£…å’Œç®€å•ä½¿ç”¨ï¼Œå¹¶ä¸”é€šè¿‡Javaè¿æ¥åˆ°æœåŠ¡å™¨ã€‚ç°åœ¨æˆ‘ä»¬æ¥å°è¯•åœ¨SpringBootä¸­æ•´åˆæ¶ˆæ¯é˜Ÿåˆ—å®¢æˆ·ç«¯ï¼Œé¦–å…ˆæ˜¯ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-amqp\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€æˆ‘ä»¬éœ€è¦é…ç½®RabbitMQçš„åœ°å€ç­‰ä¿¡æ¯ï¼š\nspring: rabbitmq: addresses: 192.168.0.4 username: admin password: admin virtual-host: /test è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†æœ€åŸºæœ¬ä¿¡æ¯é…ç½®ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•åƒä¹‹å‰ä¸€æ ·å»å£°æ˜ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªé…ç½®ç±»å°±è¡Œäº†ï¼š\n@Configuration public class RabbitConfiguration { @Bean(\u0026#34;directExchange\u0026#34;) //å®šä¹‰äº¤æ¢æœºBeanï¼Œå¯ä»¥å¾ˆå¤šä¸ª public Exchange exchange(){ return ExchangeBuilder.directExchange(\u0026#34;amq.direct\u0026#34;).build(); } @Bean(\u0026#34;yydsQueue\u0026#34;) //å®šä¹‰æ¶ˆæ¯é˜Ÿåˆ— public Queue queue(){ return QueueBuilder .nonDurable(\u0026#34;yyds\u0026#34;) //éæŒä¹…åŒ–ç±»å‹ .build(); } @Bean(\u0026#34;binding\u0026#34;) public Binding binding(@Qualifier(\u0026#34;directExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue\u0026#34;) Queue queue){ //å°†æˆ‘ä»¬åˆšåˆšå®šä¹‰çš„äº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®š return BindingBuilder .bind(queue) //ç»‘å®šé˜Ÿåˆ— .to(exchange) //åˆ°äº¤æ¢æœº .with(\u0026#34;my-yyds\u0026#34;) //ä½¿ç”¨è‡ªå®šä¹‰çš„routingKey .noargs(); } } æ¥ç€æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç”Ÿäº§è€…ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç¼–å†™åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­ï¼š\n@SpringBootTest class SpringCloudMqApplicationTests { //RabbitTemplateä¸ºæˆ‘ä»¬å°è£…äº†å¤§é‡çš„RabbitMQæ“ä½œï¼Œå·²ç»ç”±Starteræä¾›ï¼Œå› æ­¤ç›´æ¥æ³¨å…¥ä½¿ç”¨å³å¯ @Resource RabbitTemplate template; @Test void publisher() { //ä½¿ç”¨convertAndSendæ–¹æ³•ä¸€æ­¥åˆ°ä½ï¼Œå‚æ•°åŸºæœ¬å’Œä¹‹å‰æ˜¯ä¸€æ ·çš„ //æœ€åä¸€ä¸ªæ¶ˆæ¯æœ¬ä½“å¯ä»¥æ˜¯Objectç±»å‹ï¼ŒçœŸæ˜¯å¤§å¤§çš„æ–¹ä¾¿ template.convertAndSend(\u0026#34;amq.direct\u0026#34;, \u0026#34;my-yyds\u0026#34;, \u0026#34;Hello World!\u0026#34;); } } ç°åœ¨æˆ‘ä»¬æ¥è¿è¡Œä¸€ä¸‹è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š\nå¯ä»¥çœ‹åˆ°åå°è‡ªåŠ¨å£°æ˜äº†æˆ‘ä»¬åˆšåˆšå®šä¹‰å¥½çš„æ¶ˆæ¯é˜Ÿåˆ—å’Œäº¤æ¢æœºä»¥åŠå¯¹åº”çš„ç»‘å®šå…³ç³»ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„æ•°æ®ä¹Ÿæ˜¯æˆåŠŸæ’å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼š\nç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œå› ä¸ºæ¶ˆè´¹è€…å®é™…ä¸Šå°±æ˜¯ä¸€ç›´ç­‰å¾…æ¶ˆæ¯ç„¶åè¿›è¡Œå¤„ç†çš„è§’è‰²ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦åˆ›å»ºä¸€ä¸ªç›‘å¬å™¨å°±è¡Œäº†ï¼Œå®ƒä¼šä¸€ç›´ç­‰å¾…æ¶ˆæ¯åˆ°æ¥ç„¶åå†è¿›è¡Œå¤„ç†ï¼š\n@Component //æ³¨å†Œä¸ºBean public class TestListener { @RabbitListener(queues = \u0026#34;yyds\u0026#34;) //å®šä¹‰æ­¤æ–¹æ³•ä¸ºé˜Ÿåˆ—yydsçš„ç›‘å¬å™¨ï¼Œä¸€æ—¦ç›‘å¬åˆ°æ–°çš„æ¶ˆæ¯ï¼Œå°±ä¼šæ¥å—å¹¶å¤„ç† public void test(Message message){ System.out.println(new String(message.getBody())); } } æ¥ç€æˆ‘ä»¬å¯åŠ¨æœåŠ¡å™¨ï¼š\nå¯ä»¥çœ‹åˆ°æ§åˆ¶å°æˆåŠŸè¾“å‡ºäº†æˆ‘ä»¬ä¹‹å‰æ”¾å…¥é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”ç®¡ç†é¡µé¢ä¸­ä¹Ÿæ˜¾ç¤ºæ­¤æ¶ˆè´¹è€…å·²ç»è¿æ¥äº†ï¼š\næ¥ç€æˆ‘ä»¬å†é€šè¿‡ç®¡ç†é¡µé¢æ·»åŠ æ–°çš„æ¶ˆæ¯çœ‹çœ‹ï¼Œä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸è¿›è¡Œæ¥å—çš„ã€‚\nå½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ç¡®ä¿æ¶ˆæ¯èƒ½å¤Ÿè¢«æ¶ˆè´¹è€…æ¥å—å¹¶å¤„ç†ï¼Œç„¶åå¾—åˆ°æ¶ˆè´¹è€…çš„åé¦ˆï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼š\n@Test void publisher() { //ä¼šç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹ç„¶åè¿”å›å“åº”ç»“æœ Object res = template.convertSendAndReceive(\u0026#34;amq.direct\u0026#34;, \u0026#34;my-yyds\u0026#34;, \u0026#34;Hello World!\u0026#34;); System.out.println(\u0026#34;æ”¶åˆ°æ¶ˆè´¹è€…å“åº”ï¼š\u0026#34;+res); } æ¶ˆè´¹è€…è¿™è¾¹åªéœ€è¦è¿”å›ä¸€ä¸ªå¯¹åº”çš„ç»“æœå³å¯ï¼š\n@RabbitListener(queues = \u0026#34;yyds\u0026#34;) public String receiver(String data){ System.out.println(\u0026#34;ä¸€å·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); return \u0026#34;æ”¶åˆ°!\u0026#34;; } æµ‹è¯•æ²¡æœ‰é—®é¢˜ï¼š\né‚£ä¹ˆå¦‚æœæˆ‘ä»¬éœ€è¦ç›´æ¥æ¥æ”¶ä¸€ä¸ªJSONæ ¼å¼çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”å¸Œæœ›ç›´æ¥è·å–åˆ°å®ä½“ç±»å‘¢ï¼Ÿ\n@Data public class User { int id; String name; } @Configuration public class RabbitConfiguration { ... @Bean(\u0026#34;jacksonConverter\u0026#34;) //ç›´æ¥åˆ›å»ºä¸€ä¸ªç”¨äºJSONè½¬æ¢çš„Bean public Jackson2JsonMessageConverter converter(){ return new Jackson2JsonMessageConverter(); } } æ¥ç€æˆ‘ä»¬åªéœ€è¦æŒ‡å®šè½¬æ¢å™¨å°±å¯ä»¥äº†ï¼š\n@Component public class TestListener { //æŒ‡å®šmessageConverterä¸ºæˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„Beanåç§° @RabbitListener(queues = \u0026#34;yyds\u0026#34;, messageConverter = \u0026#34;jacksonConverter\u0026#34;) public void receiver(User user){ //ç›´æ¥æ¥æ”¶Userç±»å‹ System.out.println(user); } } ç°åœ¨æˆ‘ä»¬ç›´æ¥åœ¨ç®¡ç†é¡µé¢å‘é€ï¼š\n{\u0026#34;id\u0026#34;:1,\u0026#34;name\u0026#34;:\u0026#34;LB\u0026#34;} !\r](\rhttps://tva1.sinaimg.cn/large/e6c9d24ely1h1byhcakabj221m0lwac0.jpg)\nå¯ä»¥çœ‹åˆ°æˆåŠŸå®Œæˆäº†è½¬æ¢ï¼Œå¹¶è¾“å‡ºäº†ç”¨æˆ·ä¿¡æ¯ï¼š\nåŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å‘é€Userï¼Œå› ä¸ºæˆ‘ä»¬åˆšåˆšå·²ç»é…ç½®äº†Jackson2JsonMessageConverterä¸ºBeanï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨å°±å¯ä»¥äº†ï¼š\n@Test void publisher() { template.convertAndSend(\u0026#34;amq.direct\u0026#34;, \u0026#34;yyds\u0026#34;, new User()); } å¯ä»¥çœ‹åˆ°åå°çš„æ•°æ®ç±»å‹ä¸ºï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±é€šè¿‡SpringBootå®ç°äº†RabbitMQçš„ç®€å•ä½¿ç”¨ã€‚\næ­»ä¿¡é˜Ÿåˆ— #\ræ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œå¦‚æœè¿Ÿè¿Ÿæ²¡æœ‰æ¶ˆè´¹è€…æ¥å¤„ç†ï¼Œé‚£ä¹ˆå°±ä¼šä¸€ç›´å ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„ç©ºé—´ã€‚æ¯”å¦‚æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹æŠ¢è½¦ç¥¨çš„åœºæ™¯ï¼Œç”¨æˆ·ä¸‹å•é«˜é“ç¥¨ä¹‹åï¼Œä¼šè¿›è¡ŒæŠ¢åº§ï¼Œç„¶åå†è¿›è¡Œä»˜æ¬¾ï¼Œä½†æ˜¯å¦‚æœç”¨æˆ·ä¸‹å•ä¹‹åå¹¶æ²¡æœ‰åŠæ—¶çš„ä»˜æ¬¾ï¼Œè¿™å¼ ç¥¨ä¸å¯èƒ½ä¸€ç›´è®©è¿™ä¸ªç”¨æˆ·å ç”¨ç€ï¼Œå› ä¸ºä½ ä¸ä¹°åˆ«äººè¿˜è¦ä¹°å‘¢ï¼Œæ‰€ä»¥ä¼šåœ¨ä¸€æ®µæ—¶é—´åè¶…æ—¶ï¼Œè®©è¿™å¼ ç¥¨å¯ä»¥ç»§ç»­è¢«å…¶ä»–äººè´­ä¹°ã€‚\nè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ­»ä¿¡é˜Ÿåˆ—ï¼Œå°†é‚£äº›ç”¨æˆ·è¶…æ—¶æœªä»˜æ¬¾çš„æˆ–æ˜¯ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆçš„è®¢å•ï¼Œè¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†ï¼Œä»¥ä¸‹ç±»å‹çš„æ¶ˆæ¯éƒ½ä¼šè¢«åˆ¤å®šä¸ºæ­»ä¿¡ï¼š\næ¶ˆæ¯è¢«æ‹’ç»(basic.reject / basic.nack)ï¼Œå¹¶ä¸”requeue = false æ¶ˆæ¯TTLè¿‡æœŸ é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦ é‚£ä¹ˆå¦‚ä½•æ„å»ºè¿™æ ·çš„ä¸€ç§ä½¿ç”¨æ¨¡å¼å‘¢ï¼Ÿå®é™…ä¸Šæœ¬è´¨å°±æ˜¯ä¸€ä¸ªæ­»ä¿¡äº¤æ¢æœº+ç»‘å®šçš„æ­»ä¿¡é˜Ÿåˆ—ï¼Œå½“æ­£å¸¸é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è¢«åˆ¤å®šä¸ºæ­»ä¿¡æ—¶ï¼Œä¼šè¢«å‘é€åˆ°å¯¹åº”çš„æ­»ä¿¡äº¤æ¢æœºï¼Œç„¶åå†é€šè¿‡äº¤æ¢æœºå‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­ï¼Œæ­»ä¿¡é˜Ÿåˆ—ä¹Ÿæœ‰å¯¹åº”çš„æ¶ˆè´¹è€…å»å¤„ç†æ¶ˆæ¯ã€‚\nè¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨é…ç½®ç±»ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ­»ä¿¡äº¤æ¢æœºå’Œæ­»ä¿¡é˜Ÿåˆ—ï¼Œå¹¶è¿›è¡Œç»‘å®šï¼š\n@Configuration public class RabbitConfiguration { @Bean(\u0026#34;directDlExchange\u0026#34;) public Exchange dlExchange(){ //åˆ›å»ºä¸€ä¸ªæ–°çš„æ­»ä¿¡äº¤æ¢æœº return ExchangeBuilder.directExchange(\u0026#34;dlx.direct\u0026#34;).build(); } @Bean(\u0026#34;yydsDlQueue\u0026#34;) //åˆ›å»ºä¸€ä¸ªæ–°çš„æ­»ä¿¡é˜Ÿåˆ— public Queue dlQueue(){ return QueueBuilder .nonDurable(\u0026#34;dl-yyds\u0026#34;) .build(); } @Bean(\u0026#34;dlBinding\u0026#34;) //æ­»ä¿¡äº¤æ¢æœºå’Œæ­»ä¿¡é˜Ÿåˆ—è¿›ç»‘å®š public Binding dlBinding(@Qualifier(\u0026#34;directDlExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsDlQueue\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;dl-yyds\u0026#34;) .noargs(); } ... @Bean(\u0026#34;yydsQueue\u0026#34;) public Queue queue(){ return QueueBuilder .nonDurable(\u0026#34;yyds\u0026#34;) .deadLetterExchange(\u0026#34;dlx.direct\u0026#34;) //æŒ‡å®šæ­»ä¿¡äº¤æ¢æœº .deadLetterRoutingKey(\u0026#34;dl-yyds\u0026#34;) //æŒ‡å®šæ­»ä¿¡RoutingKey .build(); } ... } æ¥ç€æˆ‘ä»¬å°†ç›‘å¬å™¨ä¿®æ”¹ä¸ºæ­»ä¿¡é˜Ÿåˆ—ç›‘å¬ï¼š\n@Component public class TestListener { @RabbitListener(queues = \u0026#34;dl-yyds\u0026#34;, messageConverter = \u0026#34;jacksonConverter\u0026#34;) public void receiver(User user){ System.out.println(user); } } é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬æ¥å°è¯•å¯åŠ¨ä¸€ä¸‹å§ï¼Œæ³¨æ„å¯åŠ¨ä¹‹å‰è®°å¾—æŠŠä¹‹å‰çš„é˜Ÿåˆ—ç»™åˆ äº†ï¼Œè¿™é‡Œè¦é‡æ–°å®šä¹‰ã€‚\né˜Ÿåˆ—åˆ—è¡¨ä¸­å·²ç»å‡ºç°äº†æˆ‘ä»¬åˆšåˆšå®šä¹‰å¥½çš„æ­»ä¿¡é˜Ÿåˆ—ï¼Œå¹¶ä¸”yydsé˜Ÿåˆ—ä¹Ÿæ”¯æŒæ­»ä¿¡é˜Ÿåˆ—å‘é€åŠŸèƒ½äº†ï¼Œç°åœ¨æˆ‘ä»¬å°è¯•å‘æ­¤é˜Ÿåˆ—å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å°†å…¶æ‹’ç»ï¼š\nå¯ä»¥çœ‹åˆ°æ‹’ç»åï¼Œå¦‚æœä¸è®©æ¶ˆæ¯é‡æ–°æ’é˜Ÿï¼Œé‚£ä¹ˆå°±ä¼šå˜æˆæ­»ä¿¡ï¼Œç›´æ¥è¢«ä¸¢è¿›æ­»ä¿¡é˜Ÿåˆ—ä¸­ï¼Œå¯ä»¥çœ‹åˆ°åœ¨æ‹’ç»åï¼š\nç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒç§æƒ…å†µï¼ŒRabbitMQæ”¯æŒå°†è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡è¢«æ¶ˆè´¹çš„æ¶ˆæ¯è‡ªåŠ¨åˆ é™¤ï¼Œè¿™éœ€è¦æ¶ˆæ¯é˜Ÿåˆ—è®¾å®šTTLå€¼ï¼Œå¦‚æœæ¶ˆæ¯çš„å­˜æ´»æ—¶é—´è¶…è¿‡äº†Time To Liveå€¼ï¼Œå°±ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œè‡ªåŠ¨åˆ é™¤åçš„æ¶ˆæ¯å¦‚æœæœ‰æ­»ä¿¡é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚\nç°åœ¨æˆ‘ä»¬å°†yydsæ¶ˆæ¯é˜Ÿåˆ—è®¾å®šTTLå€¼ï¼ˆæ¯«ç§’ä¸ºå•ä½ï¼‰ï¼š\n@Bean(\u0026#34;yydsQueue\u0026#34;) public Queue queue(){ return QueueBuilder .nonDurable(\u0026#34;yyds\u0026#34;) .deadLetterExchange(\u0026#34;dlx.direct\u0026#34;) .deadLetterRoutingKey(\u0026#34;dl-yyds\u0026#34;) .ttl(5000) //å¦‚æœ5ç§’æ²¡å¤„ç†ï¼Œå°±è‡ªåŠ¨åˆ é™¤ .build(); } ç°åœ¨æˆ‘ä»¬é‡å¯æµ‹è¯•ä¸€ä¸‹ï¼Œæ³¨æ„ä¿®æ”¹äº†ä¹‹åè®°å¾—åˆ é™¤ä¹‹å‰çš„yydsé˜Ÿåˆ—ï¼š\nå¯ä»¥çœ‹åˆ°ç°åœ¨yydsé˜Ÿåˆ—å·²ç»å…·æœ‰TTLç‰¹æ€§äº†ï¼Œæˆ‘ä»¬ç°åœ¨æ¥æ’å…¥ä¸€ä¸ªæ–°çš„æ¶ˆæ¯ï¼š\nå¯ä»¥çœ‹åˆ°æ¶ˆæ¯5ç§’é’Ÿä¹‹åå°±ä¸è§äº†ï¼Œè€Œæ˜¯è¢«ä¸¢è¿›äº†æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚\næœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å½“æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦è¾¾åˆ°æœ€å¤§çš„æƒ…å†µï¼Œç°åœ¨æˆ‘ä»¬å°†æ¶ˆæ¯é˜Ÿåˆ—çš„é•¿åº¦è¿›è¡Œé™åˆ¶ï¼š\n@Bean(\u0026#34;yydsQueue\u0026#34;) public Queue queue(){ return QueueBuilder .nonDurable(\u0026#34;yyds\u0026#34;) .deadLetterExchange(\u0026#34;dlx.direct\u0026#34;) .deadLetterRoutingKey(\u0026#34;dl-yyds\u0026#34;) .maxLength(3) //å°†æœ€å¤§é•¿åº¦è®¾å®šä¸º3 .build(); } ç°åœ¨æˆ‘ä»¬é‡å¯ä¸€ä¸‹ï¼Œç„¶åå°è¯•è¿ç»­æ’å…¥4ä¸ªæ¶ˆæ¯ï¼š\nå¯ä»¥çœ‹åˆ°yydsæ¶ˆæ¯é˜Ÿåˆ—æ–°å¢äº†Limitç‰¹æ€§ï¼Œä¹Ÿå°±æ˜¯é™å®šé•¿åº¦ï¼š\n@Test void publisher() { for (int i = 0; i \u0026lt; 4; i++) template.convertAndSend(\u0026#34;amq.direct\u0026#34;, \u0026#34;my-yyds\u0026#34;, new User()); } å¯ä»¥çœ‹åˆ°å› ä¸ºé•¿åº¦é™åˆ¶ä¸º3ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªæ¶ˆæ¯ç›´æ¥è¢«ä¸¢è¿›äº†æ­»ä¿¡é˜Ÿåˆ—ä¸­ï¼Œä¸ºäº†èƒ½å¤Ÿæ›´ç›´è§‚åœ°è§‚å¯Ÿæ¶ˆæ¯é˜Ÿåˆ—çš„æœºåˆ¶ï¼Œæˆ‘ä»¬ä¸ºUserç±»æ–°å¢ä¸€ä¸ªæ—¶é—´å­—æ®µï¼š\n@Data public class User { int id; String name; String date = new Date().toString(); } æ¥ç€æ¯éš”ä¸€ç§’é’Ÿæ’å…¥ä¸€ä¸ªï¼š\n@Test void publisher() throws InterruptedException { for (int i = 0; i \u0026lt; 4; i++) { Thread.sleep(1000); template.convertAndSend(\u0026#34;amq.direct\u0026#34;, \u0026#34;my-yyds\u0026#34;, new User()); } } å†æ¬¡è¿›è¡Œä¸Šè¿°å®éªŒï¼Œå¯ä»¥å‘ç°å¦‚æœåˆ°è¾¾é˜Ÿåˆ—é•¿åº¦é™åˆ¶ï¼Œé‚£ä¹ˆæ¯æ¬¡æ’å…¥éƒ½ä¼šæŠŠä½äºé˜Ÿé¦–çš„æ¶ˆæ¯ä¸¢è¿›æ­»ä¿¡é˜Ÿåˆ—ï¼Œæ¥è…¾å‡ºç©ºé—´ç»™æ–°æ¥çš„æ¶ˆæ¯ã€‚\nå·¥ä½œé˜Ÿåˆ—æ¨¡å¼ #\ræ³¨æ„ï¼š XXæ¨¡å¼åªæ˜¯ä¸€ç§è®¾è®¡æ€è·¯ï¼Œå¹¶ä¸æ˜¯æŒ‡çš„å…·ä½“çš„æŸç§å®ç°ï¼Œå¯ä»¥ç†è§£ä¸ºå®ç°XXæ¨¡å¼éœ€è¦æ€ä¹ˆå»å†™ã€‚\nå‰é¢æˆ‘ä»¬äº†è§£äº†æœ€ç®€çš„ä¸€ä¸ªæ¶ˆè´¹è€…ä¸€ä¸ªç”Ÿäº§è€…çš„æ¨¡å¼ï¼Œæ¥ç€æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä¸€ä¸ªç”Ÿäº§è€…å¤šä¸ªæ¶ˆè´¹è€…çš„æƒ…å†µï¼š\nå®é™…ä¸Šè¿™ç§æ¨¡å¼å°±éå¸¸é€‚åˆå¤šä¸ªå·¥äººç­‰å¾…æ–°çš„ä»»åŠ¡åˆ°æ¥çš„åœºæ™¯ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æœ‰å¾ˆå¤šä¸ªï¼Œä¸€ä¸ªä¸€ä¸ªä¸¢è¿›æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œæ­¤æ—¶å·¥äººæœ‰å¾ˆå¤šä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†è¿™äº›ä»»åŠ¡åˆ†é…ä¸ªå„ä¸ªå·¥äººï¼Œè®©ä»–ä»¬å„è‡ªè´Ÿè´£ä¸€äº›ä»»åŠ¡ï¼Œå¹¶ä¸”åšçš„å¿«çš„å·¥äººè¿˜å¯ä»¥åšå®Œæˆä¸€äº›ï¼ˆèƒ½è€…å¤šåŠ³ï¼‰ã€‚\néå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ›å»ºä¸¤ä¸ªç›‘å¬å™¨å³å¯ï¼š\n@Component public class TestListener { @RabbitListener(queues = \u0026#34;yyds\u0026#34;) public void receiver(String data){ //è¿™é‡Œç›´æ¥æ¥æ”¶Stringç±»å‹çš„æ•°æ® System.out.println(\u0026#34;ä¸€å·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); } @RabbitListener(queues = \u0026#34;yyds\u0026#34;) public void receiver2(String data){ System.out.println(\u0026#34;äºŒå·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); } } å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œè½®è¯¢åˆ†å‘ï¼š\né‚£ä¹ˆå¦‚æœæˆ‘ä»¬ä¸€å¼€å§‹å°±åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ”¾å…¥ä¸€éƒ¨åˆ†æ¶ˆæ¯åœ¨å¼€å¯æ¶ˆè´¹è€…å‘¢ï¼Ÿ\nå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ˜¯ä¸€å¼€å§‹å°±å­˜åœ¨æ¶ˆæ¯ï¼Œä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…ä¸€æ¬¡æ€§å…¨éƒ¨æ¶ˆè€—ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¯¹æ¶ˆè´¹è€…çš„Prefetch countï¼ˆé¢„è·å–æ•°é‡ï¼Œä¸€æ¬¡æ€§è·å–æ¶ˆæ¯çš„æœ€å¤§æ•°é‡ï¼‰è¿›è¡Œé™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç°åœ¨å¸Œæœ›çš„æ˜¯æ¶ˆè´¹è€…ä¸€æ¬¡åªèƒ½æ‹¿ä¸€ä¸ªæ¶ˆæ¯ï¼Œè€Œä¸æ˜¯å°†æ‰€æœ‰çš„æ¶ˆæ¯å…¨éƒ¨éƒ½è·å–ã€‚\nå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªæ•°é‡è¿›è¡Œä¸€äº›é…ç½®ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦åœ¨é…ç½®ç±»ä¸­å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„ListenerContainerFactoryï¼Œå¯ä»¥åœ¨è¿™é‡Œè®¾å®šæ¶ˆè´¹è€…Channelçš„PrefetchCountçš„å¤§å°ï¼š\n@Resource private CachingConnectionFactory connectionFactory; @Bean(name = \u0026#34;listenerContainer\u0026#34;) public SimpleRabbitListenerContainerFactory listenerContainer(){ SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory(); factory.setConnectionFactory(connectionFactory); factory.setPrefetchCount(1); //å°†PrefetchCountè®¾å®šä¸º1è¡¨ç¤ºä¸€æ¬¡åªèƒ½å–ä¸€ä¸ª return factory; } æ¥ç€æˆ‘ä»¬åœ¨ç›‘å¬å™¨è¿™è¾¹æŒ‡å®šå³å¯ï¼š\n@Component public class TestListener { @RabbitListener(queues = \u0026#34;yyds\u0026#34;, containerFactory = \u0026#34;listenerContainer\u0026#34;) public void receiver(String data){ System.out.println(\u0026#34;ä¸€å·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); } @RabbitListener(queues = \u0026#34;yyds\u0026#34;, containerFactory = \u0026#34;listenerContainer\u0026#34;) public void receiver2(String data){ System.out.println(\u0026#34;äºŒå·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); } } ç°åœ¨æˆ‘ä»¬å†æ¬¡å¯åŠ¨æœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°PrefetchCountè¢«é™å®šä¸º1äº†ï¼š\nå†æ¬¡é‡å¤ä¸Šè¿°çš„å®ç°ï¼Œå¯ä»¥çœ‹åˆ°æ¶ˆæ¯ä¸ä¼šè¢«ä¸€å·æ¶ˆè´¹è€…ç»™å…¨éƒ¨æŠ¢èµ°äº†ï¼š\nå½“ç„¶é™¤äº†å»å®šä¹‰ä¸¤ä¸ªç›¸åŒçš„ç›‘å¬å™¨ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æ³¨è§£ä¸­å®šä¹‰ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦10ä¸ªåŒæ ·çš„æ¶ˆè´¹è€…ï¼š\n@Component public class TestListener { @RabbitListener(queues = \u0026#34;yyds\u0026#34;, containerFactory = \u0026#34;listenerContainer\u0026#34;, concurrency = \u0026#34;10\u0026#34;) public void receiver(String data){ System.out.println(\u0026#34;ä¸€å·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); } } å¯ä»¥çœ‹åˆ°åœ¨ç®¡ç†é¡µé¢ä¸­å‡ºç°äº†10ä¸ªæ¶ˆè´¹è€…ï¼š\nè‡³æ­¤ï¼Œæœ‰å…³å·¥ä½œé˜Ÿåˆ—æ¨¡å¼å°±è®²åˆ°è¿™é‡Œã€‚\nå‘å¸ƒè®¢é˜…æ¨¡å¼ #\rå‰é¢æˆ‘ä»¬å·²ç»äº†è§£äº†RabbitMQå®¢æˆ·ç«¯çš„ä¸€äº›åŸºæœ¬æ“ä½œï¼ŒåŒ…æ‹¬æ™®é€šçš„æ¶ˆæ¯æ¨¡å¼ï¼Œæ¥ç€æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å…¶ä»–çš„æ¨¡å¼ï¼Œé¦–å…ˆæ˜¯å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œå®ƒæ”¯æŒå¤šç§æ–¹å¼ï¼š\næ¯”å¦‚æˆ‘ä»¬åœ¨é˜¿é‡Œäº‘ä¹°äº†äº‘æœåŠ¡å™¨ï¼Œä½†æ˜¯æœ€è¿‘å¿«åˆ°æœŸäº†ï¼Œé‚£ä¹ˆå°±ä¼šç»™ä½ çš„æ‰‹æœºã€é‚®ç®±å‘é€æ¶ˆæ¯ï¼Œå‘Šè¯‰ä½ éœ€è¦å»ç»­è´¹äº†ï¼Œä½†æ˜¯æ‰‹æœºçŸ­ä¿¡å’Œé‚®ä»¶å‘é€å¹¶ä¸ä¸€å®šæ˜¯åŒä¸€ä¸ªä¸šåŠ¡æä¾›çš„ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬åˆå¸Œæœ›èƒ½å¤Ÿéƒ½å»æ‰§è¡Œï¼Œæ‰€ä»¥å°±å¯ä»¥ç”¨åˆ°å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼Œå‘å¸ƒä¸€æ¬¡ï¼Œæ¶ˆè´¹å¤šä¸ªã€‚\nå®ç°è¿™ç§æ¨¡å¼å…¶å®ä¹Ÿéå¸¸ç®€å•ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨æˆ‘ä»¬ä¹‹å‰çš„ç›´è¿äº¤æ¢æœºï¼Œè‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦ç”¨åˆ°å¦ä¸€ç§ç±»å‹çš„äº¤æ¢æœºï¼Œå«åšfanoutï¼ˆæ‰‡å‡ºï¼‰ç±»å‹ï¼Œè¿™æ—¶ä¸€ç§å¹¿æ’­ç±»å‹ï¼Œæ¶ˆæ¯ä¼šè¢«å¹¿æ’­åˆ°æ‰€æœ‰ä¸æ­¤äº¤æ¢æœºç»‘å®šçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚\nè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼š\nè¿™ä¸ªäº¤æ¢æœºæ˜¯ä¸€ä¸ªfanoutç±»å‹çš„äº¤æ¢æœºï¼Œæˆ‘ä»¬å°±æ˜¯è¦å®ƒå°±è¡Œäº†ï¼š\n@Configuration public class RabbitConfiguration { @Bean(\u0026#34;fanoutExchange\u0026#34;) public Exchange exchange(){ //æ³¨æ„è¿™é‡Œæ˜¯fanoutExchange return ExchangeBuilder.fanoutExchange(\u0026#34;amq.fanout\u0026#34;).build(); } @Bean(\u0026#34;yydsQueue1\u0026#34;) public Queue queue(){ return QueueBuilder.nonDurable(\u0026#34;yyds1\u0026#34;).build(); } @Bean(\u0026#34;binding\u0026#34;) public Binding binding(@Qualifier(\u0026#34;fanoutExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue1\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;yyds1\u0026#34;) .noargs(); } @Bean(\u0026#34;yydsQueue2\u0026#34;) public Queue queue2(){ return QueueBuilder.nonDurable(\u0026#34;yyds2\u0026#34;).build(); } @Bean(\u0026#34;binding2\u0026#34;) public Binding binding2(@Qualifier(\u0026#34;fanoutExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue2\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;yyds2\u0026#34;) .noargs(); } } è¿™é‡Œæˆ‘ä»¬å°†ä¸¤ä¸ªé˜Ÿåˆ—éƒ½ç»‘å®šåˆ°æ­¤äº¤æ¢æœºä¸Šï¼Œæˆ‘ä»¬å…ˆå¯åŠ¨çœ‹çœ‹æ•ˆæœï¼š\nç»‘å®šæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¥ç€æˆ‘ä»¬æä¸¤ä¸ªç›‘å¬å™¨ï¼Œç›‘å¬ä¸€ä¸‹è¿™ä¸¤ä¸ªé˜Ÿåˆ—ï¼š\n@Component public class TestListener { @RabbitListener(queues = \u0026#34;yyds1\u0026#34;) public void receiver(String data){ System.out.println(\u0026#34;ä¸€å·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); } @RabbitListener(queues = \u0026#34;yyds2\u0026#34;) public void receiver2(String data){ System.out.println(\u0026#34;äºŒå·æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬å™¨ \u0026#34;+data); } } ç°åœ¨æˆ‘ä»¬é€šè¿‡äº¤æ¢æœºå‘é€æ¶ˆæ¯ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯ä¸¤ä¸ªç›‘å¬å™¨éƒ½ä¼šæ¥æ”¶åˆ°æ¶ˆæ¯ï¼š\nå¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯ä¸¤ä¸ªæ¶ˆæ¯é˜Ÿåˆ—éƒ½èƒ½å¤Ÿæ¥å—åˆ°æ­¤æ¶ˆæ¯ï¼š\nè¿™æ ·æˆ‘ä»¬å°±å®ç°äº†å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‚\nè·¯ç”±æ¨¡å¼ #\rè·¯ç”±æ¨¡å¼å®é™…ä¸Šæˆ‘ä»¬ä¸€å¼€å§‹å°±å·²ç»å®ç°äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»‘å®šæ—¶æŒ‡å®šæƒ³è¦çš„routingKeyåªæœ‰ç”Ÿäº§è€…å‘é€æ—¶æŒ‡å®šäº†å¯¹åº”çš„routingKeyæ‰èƒ½åˆ°è¾¾å¯¹åº”çš„é˜Ÿåˆ—ã€‚\nå½“ç„¶é™¤äº†æˆ‘ä»¬ä¹‹å‰çš„ä¸€æ¬¡ç»‘å®šä¹‹å¤–ï¼ŒåŒä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å¤šæ¬¡ç»‘å®šåˆ°äº¤æ¢æœºï¼Œå¹¶ä¸”ä½¿ç”¨ä¸åŒçš„routingKeyï¼Œè¿™æ ·åªè¦æ»¡è¶³å…¶ä¸­ä¸€ä¸ªéƒ½å¯ä»¥è¢«å‘é€åˆ°æ­¤æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼š\n@Configuration public class RabbitConfiguration { @Bean(\u0026#34;directExchange\u0026#34;) public Exchange exchange(){ return ExchangeBuilder.directExchange(\u0026#34;amq.direct\u0026#34;).build(); } @Bean(\u0026#34;yydsQueue\u0026#34;) public Queue queue(){ return QueueBuilder.nonDurable(\u0026#34;yyds\u0026#34;).build(); } @Bean(\u0026#34;binding\u0026#34;) //ä½¿ç”¨yyds1ç»‘å®š public Binding binding(@Qualifier(\u0026#34;directExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;yyds1\u0026#34;) .noargs(); } @Bean(\u0026#34;binding2\u0026#34;) //ä½¿ç”¨yyds2ç»‘å®š public Binding binding2(@Qualifier(\u0026#34;directExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;yyds2\u0026#34;) .noargs(); } } å¯åŠ¨åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç®¡ç†é¢æ¿ä¸­å‡ºç°äº†ä¸¤ä¸ªç»‘å®šå…³ç³»ï¼š\nè¿™é‡Œå¯ä»¥æµ‹è¯•ä¸€ä¸‹ï¼Œéšä¾¿ä½¿ç”¨å“ªä¸ªroutingKeyéƒ½å¯ä»¥ã€‚\nä¸»é¢˜æ¨¡å¼ #\rå®é™…ä¸Šè¿™ç§æ¨¡å¼å°±æ˜¯ä¸€ç§æ¨¡ç³ŠåŒ¹é…çš„æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†routingKeyä»¥æ¨¡ç³ŠåŒ¹é…çš„æ–¹å¼å»è¿›è¡Œè½¬å‘ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨*æˆ–#æ¥è¡¨ç¤ºï¼š\n* - è¡¨ç¤ºä»»æ„çš„ä¸€ä¸ªå•è¯ # - è¡¨ç¤º0ä¸ªæˆ–å¤šä¸ªå•è¯ è¿™é‡Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\n@Configuration public class RabbitConfiguration { @Bean(\u0026#34;topicExchange\u0026#34;) //è¿™é‡Œä½¿ç”¨é¢„ç½®çš„Topicç±»å‹äº¤æ¢æœº public Exchange exchange(){ return ExchangeBuilder.topicExchange(\u0026#34;amq.topic\u0026#34;).build(); } @Bean(\u0026#34;yydsQueue\u0026#34;) public Queue queue(){ return QueueBuilder.nonDurable(\u0026#34;yyds\u0026#34;).build(); } @Bean(\u0026#34;binding\u0026#34;) public Binding binding2(@Qualifier(\u0026#34;topicExchange\u0026#34;) Exchange exchange, @Qualifier(\u0026#34;yydsQueue\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) .with(\u0026#34;*.test.*\u0026#34;) .noargs(); } } å¯åŠ¨é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°åªè¦æ˜¯æ»¡è¶³é€šé…ç¬¦æ¡ä»¶çš„éƒ½å¯ä»¥æˆåŠŸè½¬å‘åˆ°å¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼š\næ¥ç€æˆ‘ä»¬å¯ä»¥å†è¯•è¯•çœ‹#é€šé…ç¬¦ã€‚\né™¤äº†æˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„é»˜è®¤ä¸»é¢˜äº¤æ¢æœºä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå«åšamq.rabbitmq.traceçš„äº¤æ¢æœºï¼š\nå¯ä»¥çœ‹åˆ°å®ƒä¹Ÿæ˜¯topicç±»å‹çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªäº¤æ¢æœºæ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿå®é™…ä¸Šè¿™æ˜¯ç”¨äºå¸®åŠ©æˆ‘ä»¬è®°å½•å’Œè¿½è¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„äº¤æ¢æœºï¼Œå®ƒæ˜¯ä¸€ä¸ªå†…éƒ¨çš„äº¤æ¢æœºï¼Œé‚£ä¹ˆå¦‚æœä½¿ç”¨å‘¢ï¼Ÿé¦–å…ˆåˆ›å»ºä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ç”¨äºæ¥æ”¶è®°å½•ï¼š\næ¥ç€æˆ‘ä»¬éœ€è¦åœ¨æ§åˆ¶å°å°†è™šæ‹Ÿä¸»æœº/testçš„è¿½è¸ªåŠŸèƒ½å¼€å¯ï¼š\nsudo rabbitmqctl trace_on -p /test å¼€å¯åï¼Œæˆ‘ä»¬å°†æ­¤é˜Ÿåˆ—ç»‘å®šåˆ°ä¸Šé¢çš„äº¤æ¢æœºä¸Šï¼š\nç”±äºå‘é€åˆ°æ­¤äº¤æ¢æœºä¸Šçš„routingKeyä¸ºrouting keyä¸º publish.äº¤æ¢æœºåç§° å’Œ deliver.é˜Ÿåˆ—åç§°ï¼Œåˆ†åˆ«å¯¹åº”ç”Ÿäº§è€…æŠ•é€’åˆ°äº¤æ¢æœºçš„æ¶ˆæ¯ï¼Œå’Œæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸Šè·å–çš„æ¶ˆæ¯ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨#é€šé…ç¬¦è¿›è¡Œç»‘å®šã€‚\nç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œæ¯”å¦‚è¿˜æ˜¯å¾€yydsé˜Ÿåˆ—å‘é€æ¶ˆæ¯ï¼š\nå¯ä»¥çœ‹åˆ°åœ¨å‘é€æ¶ˆæ¯ï¼Œå¹¶ä¸”æ¶ˆè´¹è€…å·²ç»å¤„ç†ä¹‹åï¼Œtraceé˜Ÿåˆ—ä¸­æ–°å¢äº†ä¸¤æ¡æ¶ˆæ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹éƒ½æ˜¯äº›ä»€ä¹ˆæ¶ˆæ¯ï¼š\né€šè¿‡è¿½è¸ªï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ˜ç¡®åœ°å¾—çŸ¥æ¶ˆæ¯å‘é€çš„äº¤æ¢æœºã€routingKeyã€ç”¨æˆ·ç­‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¿¡æ¯æœ¬èº«ï¼ŒåŒæ ·çš„ï¼Œæ¶ˆè´¹è€…åœ¨å–å‡ºæ•°æ®æ—¶ä¹Ÿæœ‰è®°å½•ï¼š\næˆ‘ä»¬å¯ä»¥æ˜ç¡®æ¶ˆè´¹è€…çš„åœ°å€ã€ç«¯å£ã€å…·ä½“æ“ä½œçš„é˜Ÿåˆ—ä»¥åŠå–å‡ºçš„æ¶ˆæ¯ä¿¡æ¯ç­‰ã€‚\nåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å·²ç»äº†è§£äº†3ç§ç±»å‹çš„äº¤æ¢æœºã€‚\nç¬¬å››ç§äº¤æ¢æœºç±»å‹ #\ré€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†ä¸‰ç§äº¤æ¢æœºç±»å‹ï¼Œç°åœ¨æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹ç¬¬å››ç§äº¤æ¢æœºç±»å‹headerï¼Œå®ƒæ˜¯æ ¹æ®å¤´éƒ¨ä¿¡æ¯æ¥å†³å®šçš„ï¼Œåœ¨æˆ‘ä»¬å‘é€çš„æ¶ˆæ¯ä¸­æ˜¯å¯ä»¥æºå¸¦ä¸€äº›å¤´éƒ¨ä¿¡æ¯çš„ï¼ˆç±»ä¼¼äºHTTPï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™äº›å¤´éƒ¨ä¿¡æ¯æ¥å†³å®šè·¯ç”±åˆ°å“ªä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚\n@Configuration public class RabbitConfiguration { @Bean(\u0026#34;headerExchange\u0026#34;) //æ³¨æ„è¿™é‡Œè¿”å›çš„æ˜¯HeadersExchange public HeadersExchange exchange(){ return ExchangeBuilder .headersExchange(\u0026#34;amq.headers\u0026#34;) //RabbitMQä¸ºæˆ‘ä»¬é¢„ç½®äº†ä¸¤ä¸ªï¼Œè¿™é‡Œç”¨ç¬¬ä¸€ä¸ªå°±è¡Œ .build(); } @Bean(\u0026#34;yydsQueue\u0026#34;) public Queue queue(){ return QueueBuilder.nonDurable(\u0026#34;yyds\u0026#34;).build(); } @Bean(\u0026#34;binding\u0026#34;) public Binding binding2(@Qualifier(\u0026#34;headerExchange\u0026#34;) HeadersExchange exchange, //è¿™é‡Œå’Œä¸Šé¢ä¸€æ ·çš„ç±»å‹ @Qualifier(\u0026#34;yydsQueue\u0026#34;) Queue queue){ return BindingBuilder .bind(queue) .to(exchange) //ä½¿ç”¨HeadersExchangeçš„toæ–¹æ³•ï¼Œå¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥é…ç½® //.whereAny(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;).exist(); è¿™ä¸ªæ˜¯åªè¦å­˜åœ¨ä»»æ„ä¸€ä¸ªæŒ‡å®šçš„å¤´éƒ¨Keyå°±è¡Œ //.whereAll(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;).exist(); è¿™ä¸ªæ˜¯å¿…é¡»å­˜åœ¨æ‰€æœ‰æŒ‡å®šçš„çš„å¤´éƒ¨Key .where(\u0026#34;test\u0026#34;).matches(\u0026#34;hello\u0026#34;); //æ¯”å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦æ¶ˆæ¯çš„å¤´éƒ¨ä¿¡æ¯ä¸­åŒ…å«testï¼Œå¹¶ä¸”å€¼ä¸ºhelloæ‰èƒ½è½¬å‘ç»™æˆ‘ä»¬çš„æ¶ˆæ¯é˜Ÿåˆ— //.whereAny(Collections.singletonMap(\u0026#34;test\u0026#34;, \u0026#34;hello\u0026#34;)).match(); ä¼ å…¥Mapä¹Ÿè¡Œï¼Œæ‰¹é‡æŒ‡å®šé”®å€¼å¯¹ } } ç°åœ¨æˆ‘ä»¬æ¥å¯åŠ¨ä¸€ä¸‹è¯•è¯•çœ‹ï¼š\nç»“æœå‘ç°ï¼Œæ¶ˆæ¯å¯ä»¥æˆåŠŸå‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿™å°±æ˜¯ä½¿ç”¨å¤´éƒ¨ä¿¡æ¯è¿›è¡Œè·¯ç”±ã€‚\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±ä»‹ç»å®Œäº†æ‰€æœ‰å››ç§ç±»å‹çš„äº¤æ¢æœºã€‚\né›†ç¾¤æ­å»º #\rå‰é¢æˆ‘ä»¬å¯¹äºRabbitMQçš„ç›¸å…³å†…å®¹å·²ç»åŸºæœ¬è®²è§£å®Œæ¯•äº†ï¼Œæœ€åæˆ‘ä»¬æ¥å°è¯•æ­å»ºä¸€ä¸ªé›†ç¾¤ï¼Œè®©RabbitMQä¹‹é—´è¿›è¡Œæ•°æ®å¤åˆ¶ï¼ˆé•œåƒæ¨¡å¼ï¼‰ç¨å¾®æœ‰ç‚¹éº»çƒ¦ï¼Œè·Ÿç€è§†é¢‘èµ°å§ã€‚\nå¯èƒ½ä¼šç”¨åˆ°çš„ä¸€äº›å‘½ä»¤ï¼š\nsudo rabbitmqctl stop_app sudo rabbitmqctl join_cluster rabbit@ubuntu-server sudo rabbitmqctl start_app å®ç°å¤åˆ¶å³å¯ã€‚\nSpringCloud æ¶ˆæ¯ç»„ä»¶ #\rå‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨RabbitMQæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¥ç€æˆ‘ä»¬æ¥ç®€å•ä»‹ç»ä¸€ä¸‹SpringCloudä¸ºæˆ‘ä»¬æä¾›çš„ä¸€äº›æ¶ˆæ¯ç»„ä»¶ã€‚\nSpringCloud Stream #\rå®˜æ–¹æ–‡æ¡£ï¼š https://docs.spring.io/spring-cloud-stream/docs/3.2.2/reference/html/\nå‰é¢æˆ‘ä»¬ä»‹ç»äº†RabbitMQï¼Œäº†è§£äº†æ¶ˆæ¯é˜Ÿåˆ—ç›¸å…³çš„ä¸€äº›æ“ä½œï¼Œä½†æ˜¯å¯èƒ½æˆ‘ä»¬ä¼šé‡åˆ°ä¸åŒçš„ç³»ç»Ÿåœ¨ç”¨ä¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¯”å¦‚ç³»ç»ŸAç”¨çš„Kafkaã€ç³»ç»ŸBç”¨çš„RabbitMQï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨åˆæ²¡æœ‰å­¦ä¹ è¿‡Kafkaï¼Œé‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼åƒJDBCä¸€æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒSQLå’Œä¸šåŠ¡æœ¬èº«ï¼Œè€Œä¸ç”¨å…³å¿ƒæ•°æ®åº“çš„å…·ä½“å®ç°å‘¢ï¼Ÿ\nSpringCloud Streamèƒ½å¤Ÿåšåˆ°ï¼Œå®ƒèƒ½å¤Ÿå±è”½åº•å±‚å®ç°ï¼Œæˆ‘ä»¬ä½¿ç”¨ç»Ÿä¸€çš„æ¶ˆæ¯é˜Ÿåˆ—æ“ä½œæ–¹å¼å°±èƒ½æ“ä½œå¤šç§ä¸åŒç±»å‹çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚\nå®ƒå±è”½äº†RabbitMQåº•å±‚æ“ä½œï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ç»Ÿä¸€çš„Inputå’ŒOutputå½¢å¼ï¼Œä»¥Binderä¸ºä¸­é—´ä»¶ï¼Œè¿™æ ·å°±ç®—æˆ‘ä»¬åˆ‡æ¢äº†ä¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¹Ÿæ— éœ€ä¿®æ”¹ä»£ç ï¼Œè€Œå…·ä½“æŸç§æ¶ˆæ¯é˜Ÿåˆ—çš„åº•å±‚å®ç°æ˜¯äº¤ç»™Streamåœ¨åšçš„ã€‚\nè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\nä¾èµ–å¦‚ä¸‹ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2021.0.1\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;!-- RabbitMQçš„Streamå®ç° --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-stream-rabbit\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; é¦–å…ˆæˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸‹ç”Ÿäº§è€…ï¼Œé¦–å…ˆæ˜¯é…ç½®æ–‡ä»¶ï¼š\nserver: port: 8001 spring: cloud: stream: binders: #æ­¤å¤„é…ç½®è¦ç»‘å®šçš„rabbitmqçš„æœåŠ¡ä¿¡æ¯ local-server: #ç»‘å®šåç§°ï¼Œéšä¾¿èµ·ä¸€ä¸ªå°±è¡Œ type: rabbit #æ¶ˆæ¯ç»„ä»¶ç±»å‹ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯RabbitMQï¼Œå°±å¡«å†™rabbit environment: #æœåŠ¡å™¨ç›¸å…³ä¿¡æ¯ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ–¹å¼å¡«å†™å°±è¡Œï¼Œçˆ†çº¢åˆ«ç®¡ spring: rabbitmq: host: 192.168.0.6 port: 5672 username: admin password: admin virtual-host: /test bindings: test-out-0: destination: test.exchange æ¥ç€æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªControllerï¼Œä¸€ä¼šè®¿é—®ä¸€æ¬¡è¿™ä¸ªæ¥å£ï¼Œå°±å‘æ¶ˆæ¯é˜Ÿåˆ—å‘é€ä¸€ä¸ªæ•°æ®ï¼š\n@RestController public class PublishController { @Resource StreamBridge bridge; //é€šè¿‡bridgeæ¥å‘é€æ¶ˆæ¯ @RequestMapping(\u0026#34;/publish\u0026#34;) public String publish(){ //ç¬¬ä¸€ä¸ªå‚æ•°å…¶å®å°±æ˜¯RabbitMQçš„äº¤æ¢æœºåç§°ï¼ˆæ•°æ®ä¼šå‘é€ç»™è¿™ä¸ªäº¤æ¢æœºï¼Œåˆ°è¾¾å“ªä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸ç”±æˆ‘ä»¬å†³å®šï¼‰ //è¿™ä¸ªäº¤æ¢æœºçš„å‘½åç¨å¾®æœ‰ä¸€äº›è§„åˆ™: //è¾“å…¥: \u0026lt;åç§°\u0026gt; + -in- + \u0026lt;index\u0026gt; //è¾“å‡º: \u0026lt;åç§°\u0026gt; + -out- + \u0026lt;index\u0026gt; //è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨è¾“å‡ºçš„æ–¹å¼ï¼Œæ¥å°†æ•°æ®å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ³¨æ„è¿™é‡Œçš„åç§°ä¼šå’Œä¹‹åçš„æ¶ˆè´¹è€…Beanåç§°è¿›è¡Œå¯¹åº” bridge.send(\u0026#34;test-out-0\u0026#34;, \u0026#34;HelloWorld!\u0026#34;); return \u0026#34;æ¶ˆæ¯å‘é€æˆåŠŸï¼\u0026#34;+new Date(); } } ç°åœ¨æˆ‘ä»¬æ¥å°†ç”Ÿäº§è€…å¯åŠ¨ä¸€ä¸‹ï¼Œè®¿é—®ä¸€ä¸‹æ¥å£ï¼š\nå¯ä»¥çœ‹åˆ°æ¶ˆæ¯æˆåŠŸå‘é€ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹RabbitMQè¿™è¾¹çš„æƒ…å†µï¼š\næ–°å¢äº†ä¸€ä¸ªtest-in-0äº¤æ¢æœºï¼Œå¹¶ä¸”æ­¤äº¤æ¢æœºæ˜¯topicç±»å‹çš„ï¼š\nä½†æ˜¯ç›®å‰æ²¡æœ‰ä»»ä½•é˜Ÿåˆ—ç»‘å®šåˆ°æ­¤äº¤æ¢æœºä¸Šï¼Œå› æ­¤æˆ‘ä»¬åˆšåˆšå‘é€çš„æ¶ˆæ¯å®é™…ä¸Šæ˜¯æ²¡æœ‰ç»™åˆ°ä»»ä½•é˜Ÿåˆ—çš„ã€‚\næ¥ç€æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸‹æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…çš„ç¼–å†™æ–¹å¼æ¯”è¾ƒç‰¹åˆ«ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªConsumerå°±å¯ä»¥äº†ï¼Œå…¶ä»–é…ç½®ä¿æŒä¸€è‡´ï¼š\n@Component public class ConsumerComponent { @Bean(\u0026#34;test\u0026#34;) //æ³¨æ„è¿™é‡Œéœ€è¦å¡«å†™æˆ‘ä»¬å‰é¢äº¤æ¢æœºåç§°ä¸­\u0026#34;åç§°\u0026#34;ï¼Œè¿™æ ·ç”Ÿäº§è€…å‘é€çš„æ•°æ®æ‰ä¼šæ­£ç¡®åˆ°è¾¾ public Consumer\u0026lt;String\u0026gt; consumer(){ return System.out::println; } } é…ç½®ä¸­éœ€è¦ä¿®æ”¹ä¸€ä¸‹ç›®æ ‡äº¤æ¢æœºï¼š\nserver: port: 8002 spring: cloud: stream: ... bindings: #å› ä¸ºæ¶ˆè´¹è€…æ˜¯è¾“å…¥ï¼Œé»˜è®¤åç§°ä¸º æ–¹æ³•å-in-indexï¼Œè¿™é‡Œæˆ‘ä»¬å°†å…¶æŒ‡å®šä¸ºæˆ‘ä»¬åˆšåˆšå®šä¹‰çš„äº¤æ¢æœº test-in-0: destination: test.exchange æ¥ç€æˆ‘ä»¬ç›´æ¥å¯åŠ¨å°±å¯ä»¥äº†ï¼Œå¯ä»¥çœ‹åˆ°å¯åŠ¨ä¹‹åï¼Œè‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„é˜Ÿåˆ—ï¼š\nè€Œè¿™ä¸ªé˜Ÿåˆ—å®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬æ¶ˆè´¹è€…ç­‰å¾…æ•°æ®åˆ°è¾¾çš„é˜Ÿåˆ—ï¼š\nå¯ä»¥çœ‹åˆ°å½“å‰é˜Ÿåˆ—ç›´æ¥ç»‘å®šåˆ°äº†æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„äº¤æ¢æœºä¸Šï¼Œå¹¶ä¸”routingKeyæ˜¯ç›´æ¥å†™çš„#ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¼šæ¶ˆæ¯ä¼šç›´æ¥è¿‡æ¥ã€‚\nç°åœ¨æˆ‘ä»¬å†æ¥è®¿é—®ä¸€äº›æ¶ˆæ¯å‘é€æ¥å£ï¼š\nå¯ä»¥çœ‹åˆ°æ¶ˆè´¹è€…æˆåŠŸåœ°è¿›è¡Œæ¶ˆè´¹äº†ï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±é€šè¿‡ä½¿ç”¨SpringCloud Streamæ¥å±è”½æ‰åº•å±‚RabbitMQæ¥ç›´æ¥è¿›è¡Œæ¶ˆæ¯çš„æ“ä½œäº†ã€‚\nSpringCloud Bus #\rå®˜æ–¹æ–‡æ¡£ï¼š https://cloud.spring.io/spring-cloud-bus/reference/html/\nå®é™…ä¸Šå®ƒå°±ç›¸å½“äºæ˜¯ä¸€ä¸ªæ¶ˆæ¯æ€»çº¿ï¼Œå¯ç”¨äºå‘å„ä¸ªæœåŠ¡å¹¿æ’­æŸäº›çŠ¶æ€çš„æ›´æ”¹ï¼ˆæ¯”å¦‚äº‘ç«¯é…ç½®æ›´æ”¹ï¼Œå¯ä»¥ç»“åˆConfigç»„ä»¶å®ç°åŠ¨æ€æ›´æ–°é…ç½®ï¼Œå½“ç„¶æˆ‘ä»¬å‰é¢å­¦ä¹ çš„Nacoså…¶å®å·²ç»åŒ…å«è¿™ä¸ªåŠŸèƒ½äº†ï¼‰æˆ–å…¶ä»–ç®¡ç†æŒ‡ä»¤ã€‚\nè¿™é‡Œæˆ‘ä»¬ä¹Ÿæ˜¯ç®€å•ä½¿ç”¨ä¸€ä¸‹å§ï¼ŒBuséœ€è¦åŸºäºä¸€ä¸ªå…·ä½“çš„æ¶ˆæ¯é˜Ÿåˆ—å®ç°ï¼Œæ¯”å¦‚RabbitMQæˆ–æ˜¯Kafkaï¼Œè¿™é‡Œæˆ‘ä»¬ä¾ç„¶ä½¿ç”¨RabbitMQã€‚\næˆ‘ä»¬å°†æœ€å¼€å§‹çš„å¾®æœåŠ¡æ‹†åˆ†é¡¹ç›®ç»§ç»­ä½¿ç”¨ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬å¸Œæœ›å€Ÿé˜…æœåŠ¡çš„æŸä¸ªæ¥å£è°ƒç”¨æ—¶ï¼Œèƒ½å¤Ÿç»™ç”¨æˆ·æœåŠ¡å’Œå›¾ä¹¦æœåŠ¡å‘é€ä¸€ä¸ªé€šçŸ¥ï¼Œé¦–å…ˆæ˜¯ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-bus-amqp\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-actuator\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€æˆ‘ä»¬åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å°†RabbitMQçš„ç›¸å…³ä¿¡æ¯é…ç½®ï¼š\nspring: rabbitmq: addresses: 192.168.0.6 username: admin password: admin virtual-host: /test management: endpoints: web: exposure: include: \u0026#34;*\u0026#34; #æš´éœ²ç«¯ç‚¹ï¼Œä¸€ä¼šç”¨äºæé†’åˆ·æ–° ç„¶åå¯åŠ¨æˆ‘ä»¬çš„ä¸‰ä¸ªæœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ç®¡ç†é¢æ¿ä¸­ï¼š\næ–°å¢äº†springCloudBugè¿™æ ·ä¸€ä¸ªäº¤æ¢æœºï¼Œå¹¶ä¸”ï¼š\nè‡ªåŠ¨ç”Ÿæˆäº†å„è‡ªçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿™æ ·å°±å¯ä»¥ç›‘å¬å¹¶æ¥æ”¶åˆ°æ¶ˆæ¯äº†ã€‚\nç°åœ¨æˆ‘ä»¬è®¿é—®ä¸€ä¸ªç«¯å£ï¼š\næ­¤ç«¯å£æ˜¯ç”¨äºé€šçŸ¥åˆ«äººè¿›è¡Œåˆ·æ–°ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨ä¹‹åï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¸­æˆåŠŸå‡ºç°äº†ä¸€æ¬¡æ¶ˆè´¹ï¼š\nç°åœ¨æˆ‘ä»¬ç»“åˆä¹‹å‰ä½¿ç”¨çš„Configé…ç½®ä¸­å¿ƒï¼Œæ¥çœ‹çœ‹æ˜¯ä¸æ˜¯å¯ä»¥åšåˆ°é€šçŸ¥ä¹‹åæ‰€æœ‰çš„é…ç½®åŠ¨æ€åˆ·æ–°äº†ã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºæŸç çŸ¥è¯†åº“ç‰ˆæƒæ‰€æœ‰ï¼Œç¦æ­¢ä¸€åˆ‡æœªç»æˆæƒçš„è½¬è½½ã€å‘å¸ƒã€å‡ºå”®ç­‰è¡Œä¸ºï¼Œè¿è€…å°†è¢«è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://www.itbaima.cn/document/35v1hbsfcdgagdnw\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/rabbitmq/","section":"Docs","summary":"æ¶ˆæ¯é˜Ÿåˆ— #\rç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†æˆ‘ä»¬ä¹‹å‰çš„æŠ€æœ¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„åº”ç”¨ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹æœ€åä¸€ç« çš„å†…å®¹ã€‚\né‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—å‘¢ï¼Ÿ\næˆ‘ä»¬ä¹‹å‰å¦‚æœéœ€è¦è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œé‚£ä¹ˆä¸€èˆ¬å¯ä»¥é€šè¿‡å‘é€HTTPè¯·æ±‚æ¥å®Œæˆï¼Œè€Œç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œå°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒèƒ½å¤Ÿå°†å‘é€æ–¹å‘é€çš„ä¿¡æ¯æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå½“æ–°çš„æ¶ˆæ¯å…¥é˜Ÿæ—¶ï¼Œä¼šé€šçŸ¥æ¥æ”¶æ–¹è¿›è¡Œå¤„ç†ï¼Œä¸€èˆ¬æ¶ˆæ¯å‘é€æ–¹ç§°ä¸ºç”Ÿäº§è€…ï¼Œæ¥æ”¶æ–¹ç§°ä¸ºæ¶ˆè´¹è€…ã€‚\nè¿™æ ·æˆ‘ä»¬æ‰€æœ‰çš„è¯·æ±‚ï¼Œéƒ½å¯ä»¥ç›´æ¥ä¸¢åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå†ç”±æ¶ˆè´¹è€…å–å‡ºï¼Œä¸å†æ˜¯ç›´æ¥è¿æ¥æ¶ˆè´¹è€…çš„å½¢å¼äº†ï¼Œè€Œæ˜¯åŠ äº†ä¸€ä¸ªä¸­é—´å•†ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„è§£è€¦æ–¹æ¡ˆï¼Œå¹¶ä¸”åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œç”±äºæ¶ˆè´¹è€…èƒ½åŠ›æœ‰é™ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿèƒ½èµ·åˆ°ä¸€ä¸ªå‰Šå³°å¡«è°·çš„ä½œç”¨ï¼Œå †ç§¯ä¸€éƒ¨åˆ†çš„è¯·æ±‚ï¼Œå†ç”±æ¶ˆè´¹è€…æ¥æ…¢æ…¢å¤„ç†ï¼Œè€Œä¸ä¼šåƒç›´æ¥è°ƒç”¨é‚£æ ·è¯·æ±‚èœ‚æ‹¥è€Œè‡³ã€‚\né‚£ä¹ˆï¼Œæ¶ˆæ¯é˜Ÿåˆ—å…·ä½“å®ç°æœ‰å“ªäº›å‘¢ï¼š\nRabbitMQ - æ€§èƒ½å¾ˆå¼ºï¼Œååé‡å¾ˆé«˜ï¼Œæ”¯æŒå¤šç§åè®®ï¼Œé›†ç¾¤åŒ–ï¼Œæ¶ˆæ¯çš„å¯é æ‰§è¡Œç‰¹æ€§ç­‰ä¼˜åŠ¿ï¼Œå¾ˆé€‚åˆä¼ä¸šçš„å¼€å‘ã€‚ Kafka - æä¾›äº†è¶…é«˜çš„ååé‡ï¼Œmsçº§åˆ«çš„å»¶è¿Ÿï¼Œæé«˜çš„å¯ç”¨æ€§ä»¥åŠå¯é æ€§ï¼Œè€Œä¸”åˆ†å¸ƒå¼å¯ä»¥ä»»æ„æ‰©å±•ã€‚ RocketMQ - é˜¿é‡Œå·´å·´æ¨å‡ºçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç»å†è¿‡åŒåä¸€çš„è€ƒéªŒï¼Œå•æœºååé‡é«˜ï¼Œæ¶ˆæ¯çš„é«˜å¯é æ€§ï¼Œæ‰©å±•æ€§å¼ºï¼Œæ”¯æŒäº‹åŠ¡ç­‰ï¼Œä½†æ˜¯åŠŸèƒ½ä¸å¤Ÿå®Œæ•´ï¼Œè¯­è¨€æ”¯æŒæ€§è¾ƒå·®ã€‚ æˆ‘ä»¬è¿™é‡Œï¼Œä¸»è¦è®²è§£çš„æ˜¯RabbitMQæ¶ˆæ¯é˜Ÿåˆ—ã€‚\nRabbitMQ æ¶ˆæ¯é˜Ÿåˆ— #\rå®˜æ–¹ç½‘ç«™ï¼š https://www.rabbitmq.com\nRabbitMQæ‹¥æœ‰æ•°ä¸‡è®¡çš„ç”¨æˆ·ï¼Œæ˜¯æœ€å—æ¬¢è¿çš„å¼€æºæ¶ˆæ¯é˜Ÿåˆ—ä¹‹ä¸€ï¼Œä»\rT-Mobileåˆ°\rRuntasticï¼ŒRabbitMQåœ¨å…¨çƒèŒƒå›´å†…ç”¨äºå°å‹åˆåˆ›ä¼ä¸šå’Œå¤§å‹ä¼ä¸šã€‚\nRabbitMQè½»é‡çº§ï¼Œæ˜“äºåœ¨æœ¬åœ°å’Œäº‘ç«¯éƒ¨ç½²ï¼Œå®ƒæ”¯æŒå¤šç§æ¶ˆæ¯åè®®ã€‚RabbitMQå¯ä»¥éƒ¨ç½²åœ¨åˆ†å¸ƒå¼å’Œè”åˆé…ç½®ä¸­ï¼Œä»¥æ»¡è¶³å¤§è§„æ¨¡ã€é«˜å¯ç”¨æ€§è¦æ±‚ã€‚\nRabbitMQåœ¨è®¸å¤šæ“ä½œç³»ç»Ÿå’Œäº‘ç¯å¢ƒä¸­è¿è¡Œï¼Œå¹¶ä¸º\rå¤§å¤šæ•°æµè¡Œè¯­è¨€æä¾›äº†\rå¹¿æ³›çš„å¼€å‘è€…å·¥å…·ã€‚","title":"RabbitMq","type":"doc"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"\rå¾®æœåŠ¡åŸºç¡€ #\ræ³¨æ„ï¼š æ­¤é˜¶æ®µå­¦ä¹ æ¨èçš„ç”µè„‘é…ç½®ï¼Œè‡³å°‘é…å¤‡4æ ¸å¿ƒCPUï¼ˆä¸»é¢‘3.0Ghzä»¥ä¸Šï¼‰+16GBå†…å­˜ï¼Œå¦åˆ™å¡åˆ°ä½ æ€€ç–‘äººç”Ÿã€‚\nå‰é¢æˆ‘ä»¬è®²è§£äº†SpringBootæ¡†æ¶ï¼Œé€šè¿‡ä½¿ç”¨SpringBootæ¡†æ¶ï¼Œæˆ‘ä»¬çš„é¡¹ç›®å¼€å‘é€Ÿåº¦å¯ä»¥è¯´æ˜¯å¾—åˆ°äº†è´¨çš„æå‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¯¹äºé¡¹ç›®çš„ç»´æŠ¤å’Œç†è§£ï¼Œä¹Ÿä¼šæ›´åŠ çš„è½»æ¾ã€‚å¯è§ï¼ŒSpringBootä¸ºæˆ‘ä»¬çš„å¼€å‘å¸¦æ¥äº†å·¨å¤§ä¾¿æ·ã€‚è€Œè¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åŸºäºSpringBootï¼Œç»§ç»­æ·±å…¥åˆ°ä¼ä¸šå®é™…åœºæ™¯ï¼Œæ¢è®¨å¾®æœåŠ¡æ¶æ„ä¸‹çš„SpringCloudã€‚è¿™ä¸ªéƒ¨åˆ†æˆ‘ä»¬ä¼šæ›´åŠ æ³¨é‡äºæ¶æ„è®¾è®¡ä¸Šçš„è®²è§£ï¼Œå¼±åŒ–å®ç°åŸç†æ–¹é¢çš„ç ”ç©¶ã€‚\nä¼ ç»Ÿé¡¹ç›®è½¬å‹ #\rè¦è¯´è¿‘å‡ å¹´æœ€ç«çƒ­çš„è¯é¢˜ï¼Œé‚£è¿˜å¾—æ˜¯å¾®æœåŠ¡ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯å¾®æœåŠ¡å‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥å…ˆä»æŠ€æœ¯çš„æ¼”å˜å¼€å§‹çœ‹èµ·ï¼Œåœ¨æˆ‘ä»¬å­¦ä¹ JavaWebä¹‹åï¼Œä¸€èˆ¬çš„ç½‘ç«™å¼€å‘æ¨¡å¼ä¸ºServlet+JSPï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬åœ¨å­¦ä¹ äº†SSMä¹‹åï¼Œä¼šå‘ç°è¿™ç§æ¨¡å¼å·²ç»è¿œè¿œè½åäº†ï¼Œç¬¬ä¸€ï¼Œä¸€ä¸ªå…¬å¸ä¸å¯èƒ½å»æ‹›é‚£ä¹ˆå¤šåŒæ—¶ä¼šå‰ç«¯+åç«¯çš„å¼€å‘äººå‘˜ï¼Œå°±ç®—æ‹›åˆ°ï¼Œä¹Ÿå¹¶ä¸ä¸€å®šèƒ½ä¿è¯ä¸¤ä¸ªæ–¹é¢éƒ½æ¯”è¾ƒæ“…é•¿ï¼Œç›¸æ¯”å‰åç«¯åˆ†å¼€å­¦ä¹ çš„å¼€å‘äººå‘˜ï¼Œæ˜¾ç„¶åè€…çš„å­¦ä¹ æˆæœ¬æ›´ä½ï¼Œä¸“æ³¨åº¦æ›´é«˜ã€‚å› æ­¤å‰åç«¯åˆ†ç¦»æˆä¸ºäº†ä¸€ç§æ–°çš„è¶‹åŠ¿ã€‚é€šè¿‡ä½¿ç”¨SpringBootï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥å¾ˆå¿«é€Ÿåœ°å¼€å‘ä¸€ä¸ªé«˜æ€§èƒ½çš„å•ä½“åº”ç”¨ï¼Œåªéœ€è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œæˆ‘ä»¬æ•´ä¸ªé¡¹ç›®å°±å¼€å§‹è¿è¡Œäº†ï¼Œå„é¡¹åŠŸèƒ½èäºä¸€ä½“ï¼Œå¼€å‘èµ·æ¥ä¹Ÿæ›´åŠ è½»æ¾ã€‚\nä½†æ˜¯éšç€æˆ‘ä»¬é¡¹ç›®çš„ä¸æ–­æ‰©å¤§ï¼Œå•ä½“åº”ç”¨ä¼¼ä¹æ˜¾å¾—æœ‰ç‚¹ä¹åŠ›äº†ã€‚\néšç€è¶Šæ¥è¶Šå¤šçš„åŠŸèƒ½ä¸æ–­åœ°åŠ å…¥åˆ°ä¸€ä¸ªSpringBooté¡¹ç›®ä¸­ï¼Œéšç€æ¥å£ä¸æ–­å¢åŠ ï¼Œæ•´ä¸ªç³»ç»Ÿå°±è¦åœ¨åŒä¸€æ—¶é—´å†…å“åº”æ›´å¤šç±»å‹çš„è¯·æ±‚ï¼Œæ˜¾ç„¶ï¼Œè¿™ç§æ‰©å±•æ–¹å¼æ˜¯ä¸å¯èƒ½æ— é™ä½¿ç”¨ä¸‹å»çš„ï¼Œæ€»æœ‰ä¸€å¤©ï¼Œè¿™ä¸ªSpringBooté¡¹ç›®ä¼šåºå¤§åˆ°è¿è¡Œç¼“æ…¢ã€‚å¹¶ä¸”æ‰€æœ‰çš„åŠŸèƒ½å¦‚æœéƒ½é›†æˆåœ¨å•ç«¯ä¸Šï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šå…¨éƒ¨æ±‡é›†åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¯¹æ­¤æœåŠ¡å™¨é€ æˆå·¨å¤§å‹åŠ›ã€‚\nå¯ä»¥è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„ç”µè„‘å·²ç»å‡çº§åˆ°i9-12900Kï¼Œä½†æ˜¯ä¾ç„¶åœ¨è¿è¡Œé¡¹ç›®çš„æ—¶å€™ç¼“æ…¢ï¼Œæ— æ³•åŒä¸€æ—¶é—´å“åº”æˆåƒä¸Šä¸‡çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜å°±å·²ç»ä¸æ˜¯å•çº¯å‡çº§æœºå™¨é…ç½®å¯ä»¥è§£å†³çš„äº†ã€‚\nä¼ ç»Ÿå•ä½“æ¶æ„åº”ç”¨éšç€é¡¹ç›®è§„æ¨¡çš„æ‰©å¤§ï¼Œå®é™…ä¸Šä¼šæš´éœ²è¶Šæ¥è¶Šå¤šçš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯ä¸€å°æœåŠ¡å™¨æ— æ³•æ‰¿å—åºå¤§çš„å•ä½“åº”ç”¨éƒ¨ç½²ï¼Œå¹¶ä¸”å•ä½“åº”ç”¨çš„ç»´æŠ¤ä¹Ÿä¼šè¶Šæ¥è¶Šå›°éš¾ï¼Œæˆ‘ä»¬å¾—å¯»æ‰¾ä¸€ç§æ–°çš„å¼€å‘æ¶æ„æ¥è§£å†³è¿™äº›é—®é¢˜äº†ã€‚\nIn short, the microservice architectural style is an approach to developing a single application as a suite of small services, each running in its own process and communicating with lightweight mechanisms, often an HTTP resource API. These services are built around business capabilities and independently deployable by fully automated deployment machinery. There is a bare minimum of centralized management of these services, which may be written in different programming languages and use different data storage technologies.\nMartin Fowleråœ¨2014å¹´æå‡ºäº†â€œå¾®æœåŠ¡â€æ¶æ„ï¼Œå®ƒæ˜¯ä¸€ç§å…¨æ–°çš„æ¶æ„é£æ ¼ã€‚\nå¾®æœåŠ¡æŠŠä¸€ä¸ªåºå¤§çš„å•ä½“åº”ç”¨æ‹†åˆ†ä¸ºä¸€ä¸ªä¸ªçš„å°å‹æœåŠ¡ï¼Œæ¯”å¦‚æˆ‘ä»¬åŸæ¥çš„å›¾ä¹¦ç®¡ç†é¡¹ç›®ä¸­ï¼Œæœ‰ç™»å½•ã€æ³¨å†Œã€æ·»åŠ ã€åˆ é™¤ã€æœç´¢ç­‰åŠŸèƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™äº›åŠŸèƒ½å•ç‹¬åšæˆä¸€ä¸ªä¸ªå°å‹çš„SpringBooté¡¹ç›®ï¼Œç‹¬ç«‹è¿è¡Œã€‚ æ¯ä¸ªå°å‹çš„å¾®æœåŠ¡ï¼Œéƒ½å¯ä»¥ç‹¬ç«‹éƒ¨ç½²å’Œå‡çº§ï¼Œè¿™æ ·ï¼Œå°±ç®—æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œé‚£ä¹ˆä¹Ÿåªä¼šå½±å“ä¸€ä¸ªæœåŠ¡çš„è¿è¡Œã€‚ å¾®æœåŠ¡ä¹‹é—´ä½¿ç”¨HTTPè¿›è¡Œæ•°æ®äº¤äº’ï¼Œä¸å†æ˜¯å•ä½“åº”ç”¨å†…éƒ¨äº¤äº’äº†ï¼Œè™½ç„¶è¿™æ ·ä¼šæ˜¾å¾—æ›´éº»çƒ¦ï¼Œä½†æ˜¯å¸¦æ¥çš„å¥½å¤„ä¹Ÿæ˜¯å¾ˆç›´æ¥çš„ï¼Œç”šè‡³èƒ½çªç ´è¯­è¨€é™åˆ¶ï¼Œä½¿ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€è¿›è¡Œå¾®æœåŠ¡å¼€å‘ï¼Œåªéœ€è¦ä½¿ç”¨HTTPè¿›è¡Œæ•°æ®äº¤äº’å³å¯ã€‚ æˆ‘ä»¬å¯ä»¥åŒæ—¶è´­ä¹°å¤šå°ä¸»æœºæ¥åˆ†åˆ«éƒ¨ç½²è¿™äº›å¾®æœåŠ¡ï¼Œè¿™æ ·ï¼Œå•æœºçš„å‹åŠ›å°±è¢«åˆ†æ•£åˆ°å¤šå°æœºå™¨ï¼Œå¹¶ä¸”æ¯å°æœºå™¨çš„é…ç½®ä¸ä¸€å®šéœ€è¦å¤ªé«˜ï¼Œè¿™æ ·å°±èƒ½èŠ‚çœå¤§é‡çš„æˆæœ¬ï¼ŒåŒæ—¶å®‰å…¨æ€§ä¹Ÿå¾—åˆ°å¾ˆå¤§çš„ä¿è¯ã€‚ ç”šè‡³åŒä¸€ä¸ªå¾®æœåŠ¡å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªï¼Œè¿™æ ·å½“å…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œå…¶ä»–æœåŠ¡å™¨ä¹Ÿåœ¨è¿è¡ŒåŒæ ·çš„å¾®æœåŠ¡ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ä¸€ä¸ªå¾®æœåŠ¡çš„é«˜å¯ç”¨ã€‚ å½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯ç®€å•çš„æ¼”ç¤ºä¸€ä¸‹å¾®æœåŠ¡æ¶æ„ï¼Œå®é™…å¼€å‘ä¸­è‚¯å®šæ˜¯æ¯”è¿™ä¸ªå¤æ‚å¾—å¤šçš„ã€‚\nå¯è§ï¼Œé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œæ›´åŠ èƒ½å¤Ÿåº”å¯¹å½“ä»Šæ—¶ä»£ä¸‹çš„ç§ç§è€ƒéªŒï¼Œä¼ ç»Ÿé¡¹ç›®çš„å¼€å‘æ¨¡å¼ï¼Œéœ€è¦è¿›è¡Œæ¶æ„ä¸Šçš„å‡çº§ã€‚\nèµ°è¿›SpringCloud #\rå‰é¢æˆ‘ä»¬ä»‹ç»äº†å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç‚¹ï¼Œé‚£ä¹ˆåŒæ ·çš„ï¼Œè¿™äº›ä¼˜ç‚¹çš„èƒŒåä¹Ÿå­˜åœ¨ç€è¯¸å¤šçš„é—®é¢˜ï¼š\nè¦å®ç°å¾®æœåŠ¡å¹¶ä¸æ˜¯è¯´åªéœ€è¦ç®€å•åœ°å°†é¡¹ç›®è¿›è¡Œæ‹†åˆ†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘å¯¹å„ä¸ªå¾®æœåŠ¡è¿›è¡Œç®¡ç†ã€ç›‘æ§ç­‰ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å¤ŸåŠæ—¶åœ°å¯»æ‰¾å’Œæ’æŸ¥é—®é¢˜ã€‚å› æ­¤å¾®æœåŠ¡å¾€å¾€éœ€è¦çš„æ˜¯ä¸€æ•´å¥—è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æœåŠ¡æ³¨å†Œå’Œå‘ç°ã€å®¹ç¾å¤„ç†ã€è´Ÿè½½å‡è¡¡ã€é…ç½®ç®¡ç†ç­‰ã€‚ å®ƒä¸åƒå•ä½“æ¶æ„é‚£ç§æ–¹ä¾¿ç»´æŠ¤ï¼Œç”±äºéƒ¨ç½²åœ¨å¤šä¸ªæœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å»ä¿è¯å„ä¸ªå¾®æœåŠ¡èƒ½å¤Ÿç¨³å®šè¿è¡Œï¼Œåœ¨ç®¡ç†éš¾åº¦ä¸Šè‚¯å®šæ˜¯é«˜äºä¼ ç»Ÿå•ä½“åº”ç”¨çš„ã€‚ åœ¨åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸‹ï¼Œå•ä½“åº”ç”¨çš„æŸäº›åŠŸèƒ½å¯èƒ½ä¼šå˜å¾—æ¯”è¾ƒéº»çƒ¦ï¼Œæ¯”å¦‚åˆ†å¸ƒå¼äº‹åŠ¡ã€‚ æ‰€ä»¥ï¼Œä¸ºäº†æ›´å¥½åœ°è§£å†³è¿™äº›é—®é¢˜ï¼ŒSpringCloudæ­£å¼ç™»åœºã€‚\nSpringCloudæ˜¯Springæä¾›çš„ä¸€å¥—åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆï¼Œé›†åˆäº†ä¸€äº›å¤§å‹äº’è”ç½‘å…¬å¸çš„å¼€æºäº§å“ï¼ŒåŒ…æ‹¬è¯¸å¤šç»„ä»¶ï¼Œå…±åŒç»„æˆSpringCloudæ¡†æ¶ã€‚å¹¶ä¸”ï¼Œå®ƒåˆ©ç”¨Spring Bootçš„å¼€å‘ä¾¿åˆ©æ€§å·§å¦™åœ°ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€è®¾æ–½çš„å¼€å‘ï¼Œå¦‚æœåŠ¡å‘ç°æ³¨å†Œã€é…ç½®ä¸­å¿ƒã€æ¶ˆæ¯æ€»çº¿ã€è´Ÿè½½å‡è¡¡ã€ç†”æ–­æœºåˆ¶ã€æ•°æ®ç›‘æ§ç­‰ï¼Œéƒ½å¯ä»¥ç”¨Spring Bootçš„å¼€å‘é£æ ¼åšåˆ°ä¸€é”®å¯åŠ¨å’Œéƒ¨ç½²ã€‚\nç”±äºä¸­å°å‹å…¬å¸æ²¡æœ‰ç‹¬ç«‹å¼€å‘è‡ªå·±çš„åˆ†å¸ƒå¼åŸºç¡€è®¾æ–½çš„èƒ½åŠ›ï¼Œä½¿ç”¨SpringCloudè§£å†³æ–¹æ¡ˆèƒ½å¤Ÿä»¥æœ€ä½çš„æˆæœ¬åº”å¯¹å½“å‰æ—¶ä»£çš„ä¸šåŠ¡å‘å±•ã€‚\nå¯ä»¥çœ‹åˆ°ï¼ŒSpringCloudæ•´ä½“æ¶æ„çš„äº®ç‚¹æ˜¯éå¸¸æ˜æ˜¾çš„ï¼Œåˆ†å¸ƒå¼æ¶æ„ä¸‹çš„å„ä¸ªåœºæ™¯ï¼Œéƒ½æœ‰å¯¹åº”çš„ç»„ä»¶æ¥å¤„ç†ï¼Œæ¯”å¦‚åŸºäºNetflixï¼ˆå¥ˆé£ï¼‰çš„å¼€æºåˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆæä¾›çš„ç»„ä»¶ï¼š\nEureka - å®ç°æœåŠ¡æ²»ç†ï¼ˆæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ‰€æœ‰çš„å¾®æœåŠ¡è¿›è¡Œé›†ä¸­ç®¡ç†ï¼ŒåŒ…æ‹¬ä»–ä»¬çš„è¿è¡ŒçŠ¶æ€ã€ä¿¡æ¯ç­‰ã€‚ Ribbon - ä¸ºæœåŠ¡ä¹‹é—´ç›¸äº’è°ƒç”¨æä¾›è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ˆç°åœ¨è¢«SpringCloudLoadBalancerå–ä»£ï¼‰ Hystrix - æ–­è·¯å™¨ï¼Œä¿æŠ¤ç³»ç»Ÿï¼Œæ§åˆ¶æ•…éšœèŒƒå›´ã€‚æš‚æ—¶å¯ä»¥è·Ÿå®¶é‡Œç”µé—¸çš„ä¿é™©ä¸ç±»æ¯”ï¼Œå½“è§¦ç”µå±é™©å‘ç”Ÿæ—¶èƒ½å¤Ÿé˜²æ­¢è¿›ä¸€æ­¥çš„å‘å±•ã€‚ Zuul - apiç½‘å…³ï¼Œè·¯ç”±ï¼Œè´Ÿè½½å‡è¡¡ç­‰å¤šç§ä½œç”¨ï¼Œå°±åƒæˆ‘ä»¬çš„è·¯ç”±å™¨ï¼Œå¯èƒ½æœ‰å¾ˆå¤šä¸ªè®¾å¤‡éƒ½è¿æ¥äº†è·¯ç”±å™¨ï¼Œä½†æ˜¯æ•°æ®åŒ…è¦è½¬å‘ç»™è°åˆ™æ˜¯ç”±è·¯ç”±å™¨åœ¨è¿›è¡Œï¼ˆå·²ç»è¢«SpringCloudGatewayå–ä»£ï¼‰ Config - é…ç½®ç®¡ç†ï¼Œå¯ä»¥å®ç°é…ç½®æ–‡ä»¶é›†ä¸­ç®¡ç† å½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯è¿›è¡Œç®€å•çš„äº†è§£å³å¯ï¼Œå®é™…ä¸Šå¾®æœåŠ¡çš„ç©æ³•éå¸¸å¤šï¼Œæˆ‘ä»¬åé¢çš„å­¦ä¹ ä¸­å°†ä¼šé€æ­¥è¿›è¡Œæ¢ç´¢ã€‚\né‚£ä¹ˆé¦–å…ˆï¼Œæˆ‘ä»¬å°±ä»æ³¨å†Œä¸­å¿ƒå¼€å§‹è¯´èµ·ã€‚\nEureka æ³¨å†Œä¸­å¿ƒ #\rå®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.spring.io/spring-cloud-netflix/docs/current/reference/html/\nå°è´´å£«ï¼š å„ä½å°ä¼™ä¼´åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­è§‰å¾—æœ‰ä»€ä¹ˆç–‘æƒ‘çš„å¯ä»¥ç›´æ¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¯ä¸€ä¸ªæŠ€æœ¯å¼€å§‹ä¹‹å‰è´´ä¸Šå®˜æ–¹æ–‡æ¡£çš„åœ°å€ï¼Œæ–¹ä¾¿å„ä½è¿›è¡ŒæŸ¥é˜…ï¼ŒåŒæ—¶åœ¨æˆ‘ä»¬çš„è¯¾ç¨‹ä¸­å¹¶ä¸ä¸€å®šä¼šå®Œå®Œæ•´æ•´åœ°è®²å®Œæ•´ä¸ªæ¡†æ¶çš„å†…å®¹ï¼Œæœ‰å…³è¯¦ç»†çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•æ–‡æ¡£ä¸­ä¹Ÿæ˜¯å†™çš„éå¸¸æ¸…æ¥šçš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥æ·±å…¥å­¦ä¹ å“¦ã€‚\nå¾®æœåŠ¡é¡¹ç›®ç»“æ„ #\rç°åœ¨æˆ‘ä»¬é‡æ–°è®¾è®¡ä¸€ä¸‹ä¹‹å‰çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿé¡¹ç›®ï¼Œå°†åŸæœ‰çš„å¤§å‹ï¼ˆä¹Ÿè®¸ é¡¹ç›®è¿›è¡Œæ‹†åˆ†ï¼Œæ³¨æ„é¡¹ç›®æ‹†åˆ†ä¸€å®šè¦å°½å¯èƒ½ä¿è¯å•ä¸€èŒè´£ï¼Œç›¸åŒçš„ä¸šåŠ¡ä¸è¦åœ¨å¤šä¸ªå¾®æœåŠ¡ä¸­é‡å¤å‡ºç°ï¼Œå¦‚æœå‡ºç°éœ€è¦å€ŸåŠ©å…¶ä»–ä¸šåŠ¡å®Œæˆçš„æœåŠ¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æœåŠ¡ä¹‹é—´ç›¸äº’è°ƒç”¨çš„å½¢å¼æ¥å®ç°ï¼ˆä¹‹åä¼šä»‹ç»ï¼‰ï¼š\nç™»å½•éªŒè¯æœåŠ¡ï¼šç”¨äºå¤„ç†ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€å¯†ç é‡ç½®ç­‰ï¼Œåæ­£å°±æ˜¯ä¸€åˆ‡ä¸è´¦æˆ·ç›¸å…³çš„å†…å®¹ï¼ŒåŒ…æ‹¬ç”¨æˆ·ä¿¡æ¯è·å–ç­‰ã€‚ å›¾ä¹¦ç®¡ç†æœåŠ¡ï¼šç”¨äºè¿›è¡Œå›¾ä¹¦æ·»åŠ ã€åˆ é™¤ã€æ›´æ–°ç­‰æ“ä½œï¼Œå›¾ä¹¦ç®¡ç†ç›¸å…³çš„æœåŠ¡ï¼ŒåŒ…æ‹¬å›¾ä¹¦çš„å­˜å‚¨ç­‰å’Œä¿¡æ¯è·å–ã€‚ å›¾ä¹¦å€Ÿé˜…æœåŠ¡ï¼šäº¤äº’æ€§æ¯”è¾ƒå¼ºçš„æœåŠ¡ï¼Œéœ€è¦å’Œç™»é™†éªŒè¯æœåŠ¡å’Œå›¾ä¹¦ç®¡ç†æœåŠ¡è¿›è¡Œäº¤äº’ã€‚ é‚£ä¹ˆæ—¢ç„¶è¦å°†å•ä½“åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªå°å‹æœåŠ¡ï¼Œæˆ‘ä»¬å°±éœ€è¦é‡æ–°è®¾è®¡ä¸€ä¸‹æ•´ä¸ªé¡¹ç›®ç›®å½•ç»“æ„ï¼Œè¿™é‡Œæˆ‘ä»¬å°±åˆ›å»ºå¤šä¸ªå­é¡¹ç›®ï¼Œæ¯ä¸€ä¸ªå­é¡¹ç›®éƒ½æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œè¿™æ ·ç”±çˆ¶é¡¹ç›®ç»Ÿä¸€ç®¡ç†ä¾èµ–ï¼Œå°±æ— éœ€æ¯ä¸ªå­é¡¹ç›®éƒ½å»å•ç‹¬ç®¡ç†ä¾èµ–äº†ï¼Œä¹Ÿæ›´æ–¹ä¾¿ä¸€ç‚¹ã€‚\næˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ™®é€šçš„SpringBooté¡¹ç›®ï¼š\nç„¶åä¸éœ€è¦å‹¾é€‰ä»»ä½•ä¾èµ–ï¼Œç›´æ¥åˆ›å»ºå³å¯ï¼Œé¡¹ç›®åˆ›å»ºå®Œæˆå¹¶åˆå§‹åŒ–åï¼Œæˆ‘ä»¬åˆ é™¤çˆ¶å·¥ç¨‹çš„æ— ç”¨æ–‡ä»¶ï¼Œåªä¿ç•™å¿…è¦æ–‡ä»¶ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š\næ¥ç€æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§æˆ‘ä»¬åˆ’åˆ†çš„æœåŠ¡ï¼Œè¿›è¡Œå­å·¥ç¨‹åˆ›å»ºäº†ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„Mavené¡¹ç›®ï¼Œæ³¨æ„çˆ¶é¡¹ç›®è¦æŒ‡å®šä¸ºæˆ‘ä»¬ä¸€å¼€å§‹åˆ›å»ºçš„çš„é¡¹ç›®ï¼Œå­é¡¹ç›®å‘½åéšæ„ï¼š\nå­é¡¹ç›®åˆ›å»ºå¥½ä¹‹åï¼Œæ¥ç€æˆ‘ä»¬åœ¨å­é¡¹ç›®ä¸­åˆ›å»ºSpringBootçš„å¯åŠ¨ä¸»ç±»ï¼š\næ¥ç€æˆ‘ä»¬ç‚¹å‡»è¿è¡Œï¼Œå³å¯å¯åŠ¨å­é¡¹ç›®äº†ï¼Œå®é™…ä¸Šè¿™ä¸ªå­é¡¹ç›®å°±ä¸€ä¸ªæœ€ç®€å•çš„SpringBoot webé¡¹ç›®ï¼Œæ³¨æ„å¯åŠ¨ä¹‹åæœ€ä¸‹æ–¹æœ‰å¼¹çª—ï¼Œæˆ‘ä»¬ç‚¹å‡»\u0026quot;ä½¿ç”¨ æœåŠ¡\u0026quot;ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å®æ—¶æŸ¥çœ‹å½“å‰æ•´ä¸ªå¤§é¡¹ç›®ä¸­æœ‰å“ªäº›å¾®æœåŠ¡äº†ï¼š\næ¥ç€æˆ‘ä»¬ä»¥åŒæ ·çš„æ–¹æ³•ï¼Œåˆ›å»ºå…¶ä»–çš„å­é¡¹ç›®ï¼Œæ³¨æ„æˆ‘ä»¬æœ€å¥½å°†å…¶ä»–å­é¡¹ç›®çš„ç«¯å£è®¾ç½®å¾—ä¸ä¸€æ ·ï¼Œä¸ç„¶ä¼šå¯¼è‡´ç«¯å£å ç”¨ï¼Œæˆ‘ä»¬åˆ†åˆ«ä¸ºå®ƒä»¬åˆ›å»ºapplication.ymlæ–‡ä»¶ï¼š\næ¥ç€æˆ‘ä»¬æ¥å°è¯•å¯åŠ¨ä¸€ä¸‹è¿™ä¸‰ä¸ªæœåŠ¡ï¼Œæ­£å¸¸æƒ…å†µä¸‹éƒ½æ˜¯å¯ä»¥ç›´æ¥å¯åŠ¨çš„ï¼š\nå¯ä»¥çœ‹åˆ°å®ƒä»¬åˆ†åˆ«è¿è¡Œåœ¨ä¸åŒçš„ç«¯å£ä¸Šï¼Œè¿™æ ·ï¼Œå°±æ–¹ä¾¿ä¸åŒçš„ç¨‹åºå‘˜ç¼–å†™ä¸åŒçš„æœåŠ¡äº†ï¼Œæäº¤å½“å‰é¡¹ç›®ä»£ç æ—¶çš„å†²çªç‡ä¹Ÿä¼šé™ä½ã€‚\næ¥ç€æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸‹æ•°æ®åº“ï¼Œè¿™é‡Œè¿˜æ˜¯è€æ ·å­ï¼Œåˆ›å»ºä¸‰ä¸ªè¡¨å³å¯ï¼Œå½“ç„¶å®é™…ä¸Šæ¯ä¸ªå¾®æœåŠ¡å•ç‹¬ä½¿ç”¨ä¸€ä¸ªæ•°æ®åº“æœåŠ¡å™¨ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæŒ‰ç…§å•ä¸€èŒè´£æœåŠ¡åªä¼šæ“ä½œè‡ªå·±å¯¹åº”çš„è¡¨ï¼Œè¿™é‡ŒUPä¸»æ¯”è¾ƒç©·ï¼Œå°±åªç”¨ä¸€ä¸ªæ•°æ®åº“æ¼”ç¤ºäº†ï¼š\nåˆ›å»ºå¥½ä¹‹åï¼Œç»“æœå¦‚ä¸‹ï¼Œä¸€å…±ä¸‰å¼ è¡¨ï¼Œå„ä½å¯ä»¥è‡ªè¡Œæ·»åŠ ä¸€äº›æ•°æ®åˆ°é‡Œé¢ï¼Œè¿™å°±ä¸è´´å‡ºæ¥äº†ï¼š\nå¦‚æœå„ä½å«Œéº»çƒ¦çš„è¯å¯ä»¥ä¸‹è½½.sqlæ–‡ä»¶è‡ªè¡Œå¯¼å…¥ã€‚\næ¥ç€æˆ‘ä»¬æ¥ç¨å¾®å†™ä¸€ç‚¹ä¸šåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ä¸šåŠ¡ï¼Œæˆ‘ä»¬å…ˆæŠŠæ•°æ®åº“ç›¸å…³çš„ä¾èµ–è¿›è¡Œå¯¼å…¥ï¼Œè¿™é‡Œä¾ç„¶ä½¿ç”¨Mybatisæ¡†æ¶ï¼Œé¦–å…ˆåœ¨çˆ¶é¡¹ç›®ä¸­æ·»åŠ MySQLé©±åŠ¨å’ŒLombokä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;mysql\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mysql-connector-java\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ç”±äºä¸æ˜¯æ‰€æœ‰çš„å­é¡¹ç›®éƒ½éœ€è¦ç”¨åˆ°Mybatisï¼Œæˆ‘ä»¬åœ¨çˆ¶é¡¹ç›®ä¸­åªè¿›è¡Œç‰ˆæœ¬ç®¡ç†å³å¯ï¼š\n\u0026lt;dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;/dependencyManagement\u0026gt; æ¥ç€æˆ‘ä»¬å°±å¯ä»¥åœ¨ç”¨æˆ·æœåŠ¡å­é¡¹ç›®ä¸­æ·»åŠ æ­¤ä¾èµ–äº†ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; æ¥ç€æ·»åŠ æ•°æ®æºä¿¡æ¯ï¼ˆUPç”¨åˆ°æ˜¯é˜¿é‡Œäº‘çš„MySQLäº‘æ•°æ®åº“ï¼Œå„ä½æ³¨æ„ä¿®æ”¹ä¸€ä¸‹æ•°æ®åº“åœ°å€ï¼‰ï¼š\nspring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://cloudstudy.mysql.cn-chengdu.rds.aliyuncs.com:3306/cloudstudy username: test password: 123456 æ¥ç€æˆ‘ä»¬æ¥å†™ç”¨æˆ·æŸ¥è¯¢ç›¸å…³çš„ä¸šåŠ¡ï¼š\n@Data public class User { int uid; String name; String sex; } @Mapper public interface UserMapper { @Select(\u0026#34;select * from DB_USER where uid = #{uid}\u0026#34;) User getUserById(int uid); } public interface UserService { User getUserById(int uid); } @Service public class UserServiceImpl implements UserService { @Resource UserMapper mapper; @Override public User getUserById(int uid) { return mapper.getUserById(uid); } } @RestController public class UserController { @Resource UserService service; //è¿™é‡Œä»¥RESTFulé£æ ¼ä¸ºä¾‹ @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) public User findUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserById(uid); } } ç°åœ¨æˆ‘ä»¬è®¿é—®å³å¯æ‹¿åˆ°æ•°æ®ï¼š\nåŒæ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬å®Œæˆä¸€ä¸‹å›¾ä¹¦æŸ¥è¯¢ä¸šåŠ¡ï¼Œæ³¨æ„ç°åœ¨æ˜¯åœ¨å›¾ä¹¦ç®¡ç†å¾®æœåŠ¡ä¸­ç¼–å†™ï¼ˆåˆ«å¿˜äº†å¯¼å…¥Mybatisä¾èµ–ä»¥åŠé…ç½®æ•°æ®æºï¼‰ï¼š\n@Data public class Book { int bid; String title; String desc; } @Mapper public interface BookMapper { @Select(\u0026#34;select * from DB_BOOK where bid = #{bid}\u0026#34;) Book getBookById(int bid); } public interface BookService { Book getBookById(int bid); } @Service public class BookServiceImpl implements BookService { @Resource BookMapper mapper; @Override public Book getBookById(int bid) { return mapper.getBookById(bid); } } @RestController public class BookController { @Resource BookService service; @RequestMapping(\u0026#34;/book/{bid}\u0026#34;) Book findBookById(@PathVariable(\u0026#34;bid\u0026#34;) int bid){ return service.getBookById(bid); } } åŒæ ·è¿›è¡Œä¸€ä¸‹æµ‹è¯•ï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬ä¸€ä¸ªå®Œæ•´é¡¹ç›®çš„å°±æ‹†åˆ†æˆäº†å¤šä¸ªå¾®æœåŠ¡ï¼Œä¸åŒå¾®æœåŠ¡ä¹‹é—´æ˜¯ç‹¬ç«‹è¿›è¡Œå¼€å‘å’Œéƒ¨ç½²çš„ã€‚\næœåŠ¡é—´è°ƒç”¨ #\rå‰é¢æˆ‘ä»¬å®Œæˆäº†ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢å’Œå›¾ä¹¦ä¿¡æ¯æŸ¥è¯¢ï¼Œç°åœ¨æˆ‘ä»¬æ¥æ¥ç€å®Œæˆå€Ÿé˜…æœåŠ¡ã€‚\nå€Ÿé˜…æœåŠ¡æ˜¯ä¸€ä¸ªå…³è”æ€§æ¯”è¾ƒå¼ºçš„æœåŠ¡ï¼Œå®ƒä¸ä»…ä»…éœ€è¦æŸ¥è¯¢å€Ÿé˜…ä¿¡æ¯ï¼ŒåŒæ—¶å¯èƒ½è¿˜éœ€è¦è·å–å€Ÿé˜…ä¿¡æ¯ä¸‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚å…·ä½“é‚£ä¸ªç”¨æˆ·å€Ÿé˜…äº†å“ªæœ¬ä¹¦ï¼Œå¹¶ä¸”ç”¨æˆ·å’Œä¹¦ç±çš„è¯¦æƒ…ä¹Ÿéœ€è¦åŒæ—¶å‡ºç°ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦å»è®¿é—®é™¤äº†å€Ÿé˜…è¡¨ä»¥å¤–çš„ç”¨æˆ·è¡¨å’Œå›¾ä¹¦è¡¨ã€‚\nä½†æ˜¯è¿™æ˜¾ç„¶æ˜¯è¿åæˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„å•ä¸€èŒè´£çš„ï¼Œç›¸åŒçš„ä¸šåŠ¡åŠŸèƒ½ä¸åº”è¯¥é‡å¤å‡ºç°ï¼Œä½†æ˜¯ç°åœ¨ç”±éœ€è¦åœ¨æ­¤æœåŠ¡ä¸­æŸ¥è¯¢ç”¨æˆ·çš„ä¿¡æ¯å’Œå›¾ä¹¦ä¿¡æ¯ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è®©ä¸€ä¸ªæœåŠ¡å»è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡æ¥è·å–ä¿¡æ¯ã€‚\nè¿™æ ·ï¼Œå›¾ä¹¦ç®¡ç†å¾®æœåŠ¡å’Œç”¨æˆ·ç®¡ç†å¾®æœåŠ¡ç›¸å¯¹äºå€Ÿé˜…è®°å½•ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å…³ç³»ï¼Œå‰è€…æ˜¯ç”Ÿäº§è€…ï¼Œåè€…ä¾¿æ˜¯æ¶ˆè´¹è€…ã€‚\nç°åœ¨æˆ‘ä»¬å…ˆå°†å€Ÿé˜…å…³è”ä¿¡æ¯æŸ¥è¯¢å®Œå–„äº†ï¼š\n@Data public class Borrow { int id; int uid; int bid; } @Mapper public interface BorrowMapper { @Select(\u0026#34;select * from DB_BORROW where uid = #{uid}\u0026#34;) List\u0026lt;Borrow\u0026gt; getBorrowsByUid(int uid); @Select(\u0026#34;select * from DB_BORROW where bid = #{bid}\u0026#34;) List\u0026lt;Borrow\u0026gt; getBorrowsByBid(int bid); @Select(\u0026#34;select * from DB_BORROW where bid = #{bid} and uid = #{uid}\u0026#34;) Borrow getBorrow(int uid, int bid); } ç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦æŸ¥è¯¢ç”¨æˆ·çš„å€Ÿé˜…è¯¦ç»†ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦æŸ¥è¯¢æŸä¸ªç”¨æˆ·å…·ä½“å€Ÿäº†é‚£äº›ä¹¦ï¼Œå¹¶ä¸”éœ€è¦æ­¤ç”¨æˆ·çš„ä¿¡æ¯å’Œæ‰€æœ‰å·²å€Ÿé˜…çš„ä¹¦ç±ä¿¡æ¯ä¸€èµ·è¿”å›ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥è®¾è®¡ä¸€ä¸‹è¿”å›å®ä½“ï¼š\n@Data @AllArgsConstructor public class UserBorrowDetail { User user; List\u0026lt;Book\u0026gt; bookList; } ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å‘ç°Userå’ŒBookå®ä½“å®é™…ä¸Šæ˜¯åœ¨å¦å¤–ä¸¤ä¸ªå¾®æœåŠ¡ä¸­å®šä¹‰çš„ï¼Œç›¸å½“äºå½“å‰é¡¹ç›®å¹¶æ²¡æœ‰å®šä¹‰è¿™äº›å®ä½“ç±»ï¼Œé‚£ä¹ˆæ€ä¹ˆè§£å†³å‘¢ï¼Ÿ\nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰æœåŠ¡éœ€è¦ç”¨åˆ°çš„å®ä½“ç±»å•ç‹¬æ”¾å…¥å¦ä¸€ä¸ªä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œç„¶åè®©è¿™äº›é¡¹ç›®å¼•ç”¨é›†ä¸­å­˜æ”¾å®ä½“ç±»çš„é‚£ä¸ªé¡¹ç›®ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯æ¯ä¸ªå¾®æœåŠ¡çš„å®ä½“ç±»ä¿¡æ¯éƒ½å¯ä»¥å…±ç”¨äº†ï¼š\nç„¶ååªéœ€è¦åœ¨å¯¹åº”çš„ç±»ä¸­å¼•ç”¨æ­¤é¡¹ç›®ä½œä¸ºä¾èµ–å³å¯ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.example\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;commons\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.0.1-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; ä¹‹åæ–°çš„å…¬å…±å®ä½“ç±»éƒ½å¯ä»¥åœ¨commonsé¡¹ç›®ä¸­è¿›è¡Œå®šä¹‰äº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥ç€æ¥å®Œæˆåˆšåˆšçš„éœ€æ±‚ï¼Œå…ˆå®šä¹‰æ¥å£ï¼š\npublic interface BorrowService { UserBorrowDetail getUserBorrowDetailByUid(int uid); } @Service public class BorrowServiceImpl implements BorrowService{ @Resource BorrowMapper mapper; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); //é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œç°åœ¨æ‹¿åˆ°å€Ÿé˜…å…³è”ä¿¡æ¯äº†ï¼Œæ€ä¹ˆè°ƒç”¨å…¶ä»–æœåŠ¡è·å–ä¿¡æ¯å‘¢ï¼Ÿ } } éœ€è¦è¿›è¡ŒæœåŠ¡è¿œç¨‹è°ƒç”¨æˆ‘ä»¬éœ€è¦ç”¨åˆ°RestTemplateæ¥è¿›è¡Œï¼š\n@Service public class BorrowServiceImpl implements BorrowService{ @Resource BorrowMapper mapper; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); //RestTemplateæ”¯æŒå¤šç§æ–¹å¼çš„è¿œç¨‹è°ƒç”¨ RestTemplate template = new RestTemplate(); //è¿™é‡Œé€šè¿‡è°ƒç”¨getForObjectæ¥è¯·æ±‚å…¶ä»–æœåŠ¡ï¼Œå¹¶å°†ç»“æœè‡ªåŠ¨è¿›è¡Œå°è£… //è·å–Userä¿¡æ¯ User user = template.getForObject(\u0026#34;http://localhost:8082/user/\u0026#34;+uid, User.class); //è·å–æ¯ä¸€æœ¬ä¹¦çš„è¯¦ç»†ä¿¡æ¯ List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; template.getForObject(\u0026#34;http://localhost:8080/book/\u0026#34;+b.getBid(), Book.class)) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } } ç°åœ¨æˆ‘ä»¬å†æœ€åå®Œå–„ä¸€ä¸‹Controllerï¼š\n@RestController public class BorrowController { @Resource BorrowService service; @RequestMapping(\u0026#34;/borrow/{uid}\u0026#34;) UserBorrowDetail findUserBorrows(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserBorrowDetailByUid(uid); } } åœ¨æ•°æ®åº“ä¸­æ·»åŠ ä¸€ç‚¹å€Ÿé˜…ä¿¡æ¯ï¼Œæµ‹è¯•çœ‹çœ‹èƒ½ä¸èƒ½æ­£å¸¸è·å–ï¼ˆæ³¨æ„ä¸€å®šè¦ä¿è¯ä¸‰ä¸ªæœåŠ¡éƒ½å¤„äºå¼€å¯çŠ¶æ€ï¼Œå¦åˆ™è¿œç¨‹è°ƒç”¨ä¼šå¤±è´¥ï¼‰ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œç»“æœæ­£å¸¸ï¼Œæ²¡æœ‰é—®é¢˜ï¼Œè¿œç¨‹è°ƒç”¨æˆåŠŸã€‚\nè¿™æ ·ï¼Œä¸€ä¸ªç®€æ˜“çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿçš„åˆ†å¸ƒå¼é¡¹ç›®å°±æ­å»ºå®Œæˆäº†ï¼Œè¿™é‡Œè®°å¾—æŠŠæ•´ä¸ªé¡¹ç›®å‹ç¼©æ‰“åŒ…å¤‡ä»½ä¸€ä¸‹ï¼Œä¸‹ä¸€ç« å­¦ä¹ SpringCloud Alibabaä¹Ÿéœ€è¦è¿›è¡Œé…ç½®ã€‚\næœåŠ¡æ³¨å†Œä¸å‘ç° #\rå‰é¢æˆ‘ä»¬äº†è§£äº†å¦‚ä½•å¯¹å•ä½“åº”ç”¨è¿›è¡Œæ‹†åˆ†ï¼Œå¹¶ä¸”ä¹Ÿå­¦ä¹ äº†å¦‚ä½•è¿›è¡ŒæœåŠ¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è™½ç„¶æœåŠ¡æ‹†åˆ†å®Œæˆï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªæ¯”è¾ƒåˆç†çš„ç®¡ç†æœºåˆ¶ï¼Œå¦‚æœå•çº¯åªæ˜¯è¿™æ ·ç¼–å†™ï¼Œåœ¨éƒ¨ç½²å’Œç»´æŠ¤èµ·æ¥ï¼Œè‚¯å®šæ˜¯å¾ˆéº»çƒ¦çš„ã€‚å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæŸä¸€å¤©è¿™äº›å¾®æœåŠ¡çš„ç«¯å£æˆ–æ˜¯åœ°å€å¤§è§„æ¨¡åœ°å‘ç”Ÿæ”¹å˜ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸å°†æœåŠ¡ä¹‹é—´çš„è°ƒç”¨è·¯å¾„å¤§è§„æ¨¡çš„åŒæ­¥è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ˜¯å¤šä¹ˆå¯æ€•çš„äº‹æƒ…ã€‚æˆ‘ä»¬éœ€è¦å‰Šå¼±è¿™ç§æœåŠ¡ä¹‹é—´çš„å¼ºå…³è”æ€§ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé›†ä¸­ç®¡ç†å¾®æœåŠ¡çš„å¹³å°ï¼Œè¿™æ—¶å°±è¦å€ŸåŠ©æˆ‘ä»¬è¿™ä¸€éƒ¨åˆ†çš„ä¸»è§’äº†ã€‚\nEurekaèƒ½å¤Ÿè‡ªåŠ¨æ³¨å†Œå¹¶å‘ç°å¾®æœåŠ¡ï¼Œç„¶åå¯¹æœåŠ¡çš„çŠ¶æ€ã€ä¿¡æ¯è¿›è¡Œé›†ä¸­ç®¡ç†ï¼Œè¿™æ ·å½“æˆ‘ä»¬éœ€è¦è·å–å…¶ä»–æœåŠ¡çš„ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å‘Eurekaè¿›è¡ŒæŸ¥è¯¢å°±å¯ä»¥äº†ã€‚\nåƒè¿™æ ·çš„è¯ï¼ŒæœåŠ¡ä¹‹é—´çš„å¼ºå…³è”æ€§å°±ä¼šè¢«è¿›ä¸€æ­¥å‰Šå¼±ã€‚\né‚£ä¹ˆç°åœ¨æˆ‘ä»¬å°±æ¥æ­å»ºä¸€ä¸ªEurekaæœåŠ¡å™¨ï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„Mavené¡¹ç›®å³å¯ï¼Œç„¶åæˆ‘ä»¬éœ€è¦åœ¨çˆ¶å·¥ç¨‹ä¸­æ·»åŠ ä¸€ä¸‹SpringCloudçš„ä¾èµ–ï¼Œè¿™é‡Œé€‰ç”¨2021.0.1ç‰ˆæœ¬ï¼ˆSpring Cloud æœ€æ–°çš„ç‰ˆæœ¬å‘½åæ–¹å¼å˜æ›´äº†ï¼Œç°åœ¨æ˜¯ YEAR.x è¿™ç§å‘½åæ–¹å¼ï¼Œå…·ä½“å¯ä»¥åœ¨å®˜ç½‘æŸ¥çœ‹ï¼šhttps://spring.io/projects/spring-cloud#learnï¼‰ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2021.0.1\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€æˆ‘ä»¬ä¸ºæ–°åˆ›å»ºçš„é¡¹ç›®æ·»åŠ ä¾èµ–ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-eureka-server\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; ä¸‹è½½å†…å®¹æœ‰ç‚¹å¤šï¼Œé¦–æ¬¡å¯¼å…¥è¯·è€å¿ƒç­‰å¾…ä¸€ä¸‹ã€‚\næ¥ç€æˆ‘ä»¬æ¥åˆ›å»ºä¸»ç±»ï¼Œè¿˜æ˜¯ä¸€æ ·çš„æ“ä½œï¼š\n@EnableEurekaServer @SpringBootApplication public class EurekaServerApplication { public static void main(String[] args) { SpringApplication.run(EurekaServerApplication.class, args); } } åˆ«ç€æ€¥å¯åŠ¨ï¼ï¼ï¼æ¥ç€æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼š\nserver: port: 8888 eureka: # å¼€å¯ä¹‹å‰éœ€è¦ä¿®æ”¹ä¸€ä¸‹å®¢æˆ·ç«¯è®¾ç½®ï¼ˆè™½ç„¶æ˜¯æœåŠ¡ç«¯ client: # ç”±äºæˆ‘ä»¬æ˜¯ä½œä¸ºæœåŠ¡ç«¯è§’è‰²ï¼Œæ‰€ä»¥ä¸éœ€è¦è·å–æœåŠ¡ç«¯ï¼Œæ”¹ä¸ºfalseï¼Œé»˜è®¤ä¸ºtrue fetch-registry: false # æš‚æ—¶ä¸éœ€è¦å°†è‡ªå·±ä¹Ÿæ³¨å†Œåˆ°Eureka register-with-eureka: false # å°†eurekaæœåŠ¡ç«¯æŒ‡å‘è‡ªå·± service-url: defaultZone: http://localhost:8888/eureka å¥½äº†ï¼Œç°åœ¨å·®ä¸å¤šå¯ä»¥å¯åŠ¨äº†ï¼Œå¯åŠ¨å®Œæˆåï¼Œç›´æ¥è¾“å…¥åœ°å€+ç«¯å£å³å¯è®¿é—®Eurekaçš„ç®¡ç†åå°ï¼š\nå¯ä»¥çœ‹åˆ°ç›®å‰è¿˜æ²¡æœ‰ä»»ä½•çš„æœåŠ¡æ³¨å†Œåˆ°Eurekaï¼Œæˆ‘ä»¬æ¥ç€æ¥é…ç½®ä¸€ä¸‹æˆ‘ä»¬çš„ä¸‰ä¸ªå¾®æœåŠ¡ï¼Œé¦–å…ˆè¿˜æ˜¯éœ€è¦å¯¼å…¥Eurekaä¾èµ–ï¼ˆæ³¨æ„åˆ«å¯¼é”™äº†ï¼Œåç§°é‡Œé¢æœ‰ä¸ªstarterçš„æ‰æ˜¯ï¼‰ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-eureka-client\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ç„¶åä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š\neureka: client: # è·Ÿä¸Šé¢ä¸€æ ·ï¼Œéœ€è¦æŒ‡å‘EurekaæœåŠ¡ç«¯åœ°å€ï¼Œè¿™æ ·æ‰èƒ½è¿›è¡Œæ³¨å†Œ service-url: defaultZone: http://localhost:8888/eureka OKï¼Œæ— éœ€åœ¨å¯åŠ¨ç±»æ·»åŠ æ³¨è§£ï¼Œç›´æ¥å¯åŠ¨å°±å¯ä»¥äº†ï¼Œç„¶åæ‰“å¼€Eurekaçš„æœåŠ¡ç®¡ç†é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšåˆšå¼€å¯çš„æœåŠ¡ï¼š\nå¯ä»¥çœ‹åˆ°8082ç«¯å£ä¸Šçš„æœåŠ¡å™¨ï¼Œå·²ç»æˆåŠŸæ³¨å†Œåˆ°Eurekaäº†ï¼Œä½†æ˜¯è¿™ä¸ªæœåŠ¡åç§°æ€ä¹ˆä¼šæ˜¾ç¤ºä¸ºUNKNOWNï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹ï¼š\nspring: application: name: userservice å½“æˆ‘ä»¬çš„æœåŠ¡å¯åŠ¨ä¹‹åï¼Œä¼šæ¯éš”ä¸€æ®µæ—¶é—´è·ŸEurekaå‘é€ä¸€æ¬¡å¿ƒè·³åŒ…ï¼Œè¿™æ ·Eurekaå°±èƒ½å¤Ÿæ„ŸçŸ¥åˆ°æˆ‘ä»¬çš„æœåŠ¡æ˜¯å¦å¤„äºæ­£å¸¸è¿è¡ŒçŠ¶æ€ã€‚\nç°åœ¨æˆ‘ä»¬ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œå°†å¦å¤–ä¸¤ä¸ªå¾®æœåŠ¡ä¹Ÿæ³¨å†Œè¿›æ¥ï¼š\né‚£ä¹ˆï¼Œç°åœ¨æˆ‘ä»¬æ€ä¹ˆå®ç°æœåŠ¡å‘ç°å‘¢ï¼Ÿ\nä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¹‹å‰å¦‚æœéœ€è¦å¯¹å…¶ä»–å¾®æœåŠ¡è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œé‚£ä¹ˆå°±å¿…é¡»è¦çŸ¥é“å…¶ä»–æœåŠ¡çš„åœ°å€ï¼š\nUser user = template.getForObject(\u0026#34;http://localhost:8082/user/\u0026#34;+uid, User.class); è€Œç°åœ¨æœ‰äº†Eurekaä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘å…¶è¿›è¡ŒæŸ¥è¯¢ï¼Œå¾—åˆ°å¯¹åº”çš„å¾®æœåŠ¡åœ°å€ï¼Œè¿™é‡Œç›´æ¥å°†æœåŠ¡åç§°æ›¿æ¢å³å¯ï¼š\n@Service public class BorrowServiceImpl implements BorrowService { @Resource BorrowMapper mapper; @Resource RestTemplate template; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); //è¿™é‡Œä¸ç”¨å†å†™IPï¼Œç›´æ¥å†™æœåŠ¡åç§°userservice User user = template.getForObject(\u0026#34;http://userservice/user/\u0026#34;+uid, User.class); //è¿™é‡Œä¸ç”¨å†å†™IPï¼Œç›´æ¥å†™æœåŠ¡åç§°bookservice List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; template.getForObject(\u0026#34;http://bookservice/book/\u0026#34;+b.getBid(), Book.class)) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } } æ¥ç€æˆ‘ä»¬æ‰‹åŠ¨å°†RestTemplateå£°æ˜ä¸ºä¸€ä¸ªBeanï¼Œç„¶åæ·»åŠ @LoadBalancedæ³¨è§£ï¼Œè¿™æ ·Eurekaå°±ä¼šå¯¹æœåŠ¡çš„è°ƒç”¨è¿›è¡Œè‡ªåŠ¨å‘ç°ï¼Œå¹¶æä¾›è´Ÿè½½å‡è¡¡ï¼š\n@Configuration public class BeanConfig { @Bean @LoadBalanced RestTemplate template(){ return new RestTemplate(); } } ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æ­£å¸¸è°ƒç”¨äº†ï¼š\nä¸å¯¹å•Šï¼Œä¸æ˜¯è¯´æœ‰è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›å—ï¼Œæ€ä¹ˆä¸ªè´Ÿè½½å‡è¡¡å‘¢ï¼Ÿ\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ï¼ŒåŒä¸€ä¸ªæœåŠ¡å™¨å®é™…ä¸Šæ˜¯å¯ä»¥æ³¨å†Œå¾ˆå¤šä¸ªçš„ï¼Œä½†æ˜¯å®ƒä»¬çš„ç«¯å£ä¸åŒï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œåˆ›å»ºå¤šä¸ªç”¨æˆ·æŸ¥è¯¢æœåŠ¡ï¼Œæˆ‘ä»¬ç°åœ¨å°†åŸæœ‰çš„ç«¯å£é…ç½®ä¿®æ”¹ä¸€ä¸‹ï¼Œç”±IDEAä¸­è®¾å®šå¯åŠ¨å‚æ•°æ¥å†³å®šï¼Œè¿™æ ·å°±å¯ä»¥å¤šåˆ›å»ºå‡ ä¸ªä¸åŒç«¯å£çš„å¯åŠ¨é¡¹äº†ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨Eurekaä¸­ï¼ŒåŒä¸€ä¸ªæœåŠ¡å‡ºç°äº†ä¸¤ä¸ªå®ä¾‹ï¼š\nç°åœ¨æˆ‘ä»¬ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ç”¨æˆ·æŸ¥è¯¢ï¼Œç„¶åè¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œçœ‹çœ‹è¯·æ±‚æ˜¯ä¸æ˜¯å‡åŒ€åœ°åˆ†é…åˆ°è¿™ä¸¤ä¸ªæœåŠ¡ç«¯ï¼š\n@RestController public class UserController { @Resource UserService service; @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) public User findUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ System.out.println(\u0026#34;æˆ‘è¢«è°ƒç”¨æ‹‰ï¼\u0026#34;); return service.getUserById(uid); } } å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªå®ä¾‹éƒ½èƒ½å¤Ÿå‡åŒ€åœ°è¢«åˆ†é…è¯·æ±‚ï¼š\nè¿™æ ·ï¼ŒæœåŠ¡è‡ªåŠ¨å‘ç°ä»¥åŠç®€å•çš„è´Ÿè½½å‡è¡¡å°±å®ç°å®Œæˆäº†ï¼Œå¹¶ä¸”ï¼Œå¦‚æœæŸä¸ªå¾®æœåŠ¡æŒ‚æ‰äº†ï¼Œåªè¦å­˜åœ¨å…¶ä»–åŒæ ·çš„å¾®æœåŠ¡å®ä¾‹åœ¨è¿è¡Œï¼Œé‚£ä¹ˆå°±ä¸ä¼šå¯¼è‡´æ•´ä¸ªå¾®æœåŠ¡ä¸å¯ç”¨ï¼Œæå¤§åœ°ä¿è¯äº†å®‰å…¨æ€§ã€‚\næ³¨å†Œä¸­å¿ƒé«˜å¯ç”¨ #\rå„ä½å¯å¦æƒ³è¿‡è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ï¼Ÿè™½ç„¶Eurekaèƒ½å¤Ÿå®ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Œä½†æ˜¯å¦‚æœEurekaæœåŠ¡å™¨å´©æºƒäº†ï¼Œå²‚ä¸æ˜¯æ‰€æœ‰éœ€è¦ç”¨åˆ°æœåŠ¡å‘ç°çš„å¾®æœåŠ¡å°±GGäº†ï¼Ÿ\nä¸ºäº†é¿å…ï¼Œè¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åƒä¸Šé¢é‚£æ ·ï¼Œæ­å»ºEurekaé›†ç¾¤ï¼Œå­˜åœ¨å¤šä¸ªEurekaæœåŠ¡å™¨ï¼Œè¿™æ ·å°±ç®—æŒ‚æ‰å…¶ä¸­ä¸€ä¸ªï¼Œå…¶ä»–çš„ä¹Ÿè¿˜åœ¨æ­£å¸¸è¿è¡Œï¼Œå°±ä¸ä¼šä½¿å¾—æœåŠ¡æ³¨å†Œä¸å‘ç°ä¸å¯ç”¨ã€‚å½“ç„¶ï¼Œè¦æ˜¯ç‰©ç†é»‘å®¢ç›´æ¥ç‚¸äº†æ•´ä¸ªæœºæˆ¿ï¼Œé‚£è¿˜æ˜¯ç®—äº†å§ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ­å»ºEurekaé›†ç¾¤ï¼Œè¿™é‡Œç”±äºæœºå™¨é…ç½®ä¸é«˜ï¼Œå°±æ­å»ºä¸¤ä¸ªEurekaæœåŠ¡å™¨ç»„æˆé›†ç¾¤ã€‚\né¦–å…ˆæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹EurekaæœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼Œï¼š\nserver: port: 8801 spring: application: name: eurekaserver eureka: instance: # ç”±äºä¸æ”¯æŒå¤šä¸ªlocalhostçš„EurekaæœåŠ¡å™¨ï¼Œä½†æ˜¯åˆåªæœ‰æœ¬åœ°æµ‹è¯•ç¯å¢ƒï¼Œæ‰€ä»¥å°±åªèƒ½è‡ªå®šä¹‰ä¸»æœºåç§°äº† # ä¸»æœºåç§°æ”¹ä¸ºeureka01 hostname: eureka01 client: fetch-registry: false # å»æ‰register-with-eurekaé€‰é¡¹ï¼Œè®©EurekaæœåŠ¡å™¨è‡ªå·±æ³¨å†Œåˆ°å…¶ä»–EurekaæœåŠ¡å™¨ï¼Œè¿™æ ·æ‰èƒ½ç›¸äº’å¯ç”¨ service-url: # æ³¨æ„è¿™é‡Œå¡«å†™å…¶ä»–EurekaæœåŠ¡å™¨çš„åœ°å€ï¼Œä¸ç”¨å†™è‡ªå·±çš„ defaultZone: http://eureka01:8801/eureka server: port: 8802 spring: application: name: eurekaserver eureka: instance: hostname: eureka02 client: fetch-registry: false service-url: defaultZone: http://eureka01:8801/eureka è¿™é‡Œç”±äºæˆ‘ä»¬ä¿®æ”¹æˆè‡ªå®šä¹‰çš„åœ°å€ï¼Œéœ€è¦åœ¨hostsæ–‡ä»¶ä¸­å°†å…¶è§£æåˆ°172.0.0.1æ‰èƒ½å›åˆ°localhostï¼ŒMacä¸‹æ–‡ä»¶è·¯å¾„ä¸º/etc/hostsï¼ŒWindowsä¸‹ä¸ºC:\\Windows\\system32\\drivers\\etc\\hostsï¼š\nå¯¹åˆ›å»ºçš„ä¸¤ä¸ªé…ç½®æ–‡ä»¶åˆ†åˆ«æ·»åŠ å¯åŠ¨é…ç½®ï¼Œç›´æ¥ä½¿ç”¨spring.profiles.activeæŒ‡å®šå¯ç”¨çš„é…ç½®æ–‡ä»¶å³å¯ï¼š\n!\r](/Users/nagocoler/Library/Application Support/typora-user-images/image-20230306225853705.png)\næ¥ç€å¯åŠ¨è¿™ä¸¤ä¸ªæ³¨å†Œä¸­å¿ƒï¼Œè¿™ä¸¤ä¸ªEurekaç®¡ç†é¡µé¢éƒ½å¯ä»¥è¢«è®¿é—®ï¼Œæˆ‘ä»¬è®¿é—®å…¶ä¸­ä¸€ä¸ªï¼š\nå¯ä»¥çœ‹åˆ°ä¸‹æ–¹replicasä¸­å·²ç»åŒ…å«äº†å¦ä¸€ä¸ªEurekaæœåŠ¡å™¨çš„åœ°å€ï¼Œå¹¶ä¸”æ˜¯å¯ç”¨çŠ¶æ€ã€‚\næ¥ç€æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬çš„å¾®æœåŠ¡é…ç½®ä¹Ÿè¿›è¡Œä¿®æ”¹ï¼š\neureka: client: service-url: # å°†ä¸¤ä¸ªEurekaçš„åœ°å€éƒ½åŠ å…¥ï¼Œè¿™æ ·å°±ç®—æœ‰ä¸€ä¸ªEurekaæŒ‚æ‰ï¼Œä¹Ÿèƒ½å®Œæˆæ³¨å†Œ defaultZone: http://localhost:8801/eureka, http://localhost:8802/eureka å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å…¨éƒ¨æˆåŠŸæ³¨å†Œï¼Œå¹¶ä¸”ä¸¤ä¸ªEurekaæœåŠ¡ç«¯éƒ½æ˜¾ç¤ºä¸ºå·²æ³¨å†Œï¼š\næ¥ç€æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹ï¼Œå°†å…¶ä¸­ä¸€ä¸ªEurekaæœåŠ¡å™¨å…³é—­æ‰ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä¼šç›´æ¥å˜æˆä¸å¯ç”¨çŠ¶æ€ï¼š\nå½“ç„¶ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æˆ‘ä»¬é‡å¯åˆšåˆšå…³é—­çš„EurekaæœåŠ¡å™¨ï¼Œä¼šè‡ªåŠ¨åŒæ­¥å…¶ä»–EurekaæœåŠ¡å™¨çš„æ•°æ®ã€‚\nLoadBalancer è´Ÿè½½å‡è¡¡ #\rå‰é¢æˆ‘ä»¬è®²è§£äº†å¦‚ä½•å¯¹æœåŠ¡è¿›è¡Œæ‹†åˆ†ã€å¦‚ä½•é€šè¿‡EurekaæœåŠ¡å™¨è¿›è¡ŒæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œå®ƒçš„è´Ÿè½½å‡è¡¡åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå®é™…ä¸Šä¹‹å‰æ¼”ç¤ºçš„è´Ÿè½½å‡è¡¡æ˜¯ä¾é LoadBalancerå®ç°çš„ã€‚\nåœ¨2020å¹´å‰çš„SpringCloudç‰ˆæœ¬æ˜¯é‡‡ç”¨Ribbonä½œä¸ºè´Ÿè½½å‡è¡¡å®ç°ï¼Œä½†æ˜¯2020å¹´çš„ç‰ˆæœ¬ä¹‹åSpringCloudæŠŠRibbonç§»é™¤äº†ï¼Œè¿›è€Œç”¨è‡ªå·±ç¼–å†™çš„LoadBalanceræ›¿ä»£ã€‚\né‚£ä¹ˆï¼Œè´Ÿè½½å‡è¡¡æ˜¯å¦‚ä½•è¿›è¡Œçš„å‘¢ï¼Ÿ\nè´Ÿè½½å‡è¡¡ #\rå®é™…ä¸Šï¼Œåœ¨æ·»åŠ @LoadBalancedæ³¨è§£ä¹‹åï¼Œä¼šå¯ç”¨æ‹¦æˆªå™¨å¯¹æˆ‘ä»¬å‘èµ·çš„æœåŠ¡è°ƒç”¨è¯·æ±‚è¿›è¡Œæ‹¦æˆªï¼ˆæ³¨æ„è¿™é‡Œæ˜¯é’ˆå¯¹æˆ‘ä»¬å‘èµ·çš„è¯·æ±‚è¿›è¡Œæ‹¦æˆªï¼‰ï¼Œå«åšLoadBalancerInterceptorï¼Œå®ƒå®ç°ClientHttpRequestInterceptoræ¥å£ï¼š\n@FunctionalInterface public interface ClientHttpRequestInterceptor { ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException; } ä¸»è¦æ˜¯å¯¹interceptæ–¹æ³•çš„å®ç°ï¼š\npublic ClientHttpResponse intercept(final HttpRequest request, final byte[] body, final ClientHttpRequestExecution execution) throws IOException { URI originalUri = request.getURI(); String serviceName = originalUri.getHost(); Assert.state(serviceName != null, \u0026#34;Request URI does not contain a valid hostname: \u0026#34; + originalUri); return (ClientHttpResponse)this.loadBalancer.execute(serviceName, this.requestFactory.createRequest(request, body, execution)); } æˆ‘ä»¬å¯ä»¥æ‰“ä¸ªæ–­ç‚¹çœ‹çœ‹å®é™…æ˜¯æ€ä¹ˆåœ¨æ‰§è¡Œçš„ï¼Œå¯ä»¥çœ‹åˆ°ï¼š\næœåŠ¡ç«¯ä¼šåœ¨å‘èµ·è¯·æ±‚æ—¶æ‰§è¡Œè¿™äº›æ‹¦æˆªå™¨ã€‚\né‚£ä¹ˆè¿™ä¸ªæ‹¦æˆªå™¨åšäº†ä»€ä¹ˆäº‹æƒ…å‘¢ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æ˜ç¡®ï¼Œæˆ‘ä»¬ç»™è¿‡æ¥çš„è¯·æ±‚åœ°å€ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä¸»æœºåç§°ï¼Œè€Œæ˜¯æœåŠ¡åç§°ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½å¾—åˆ°çœŸæ­£éœ€è¦è®¿é—®çš„ä¸»æœºåç§°å‘¢ï¼Œè‚¯å®šæ˜¯å¾—æ‰¾Eurekaè·å–çš„ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹loadBalancer.execute()åšäº†ä»€ä¹ˆï¼Œå®ƒçš„å…·ä½“å®ç°ä¸ºBlockingLoadBalancerClientï¼š\n//ä»ä¸Šé¢ç»™è¿›æ¥äº†æœåŠ¡çš„åç§°å’Œå…·ä½“çš„è¯·æ±‚å®ä½“ public \u0026lt;T\u0026gt; T execute(String serviceId, LoadBalancerRequest\u0026lt;T\u0026gt; request) throws IOException { String hint = this.getHint(serviceId); LoadBalancerRequestAdapter\u0026lt;T, DefaultRequestContext\u0026gt; lbRequest = new LoadBalancerRequestAdapter(request, new DefaultRequestContext(request, hint)); Set\u0026lt;LoadBalancerLifecycle\u0026gt; supportedLifecycleProcessors = this.getSupportedLifecycleProcessors(serviceId); supportedLifecycleProcessors.forEach((lifecycle) -\u0026gt; { lifecycle.onStart(lbRequest); }); //å¯ä»¥çœ‹åˆ°åœ¨è¿™é‡Œä¼šè°ƒç”¨chooseæ–¹æ³•è‡ªåŠ¨è·å–å¯¹åº”çš„æœåŠ¡å®ä¾‹ä¿¡æ¯ ServiceInstance serviceInstance = this.choose(serviceId, lbRequest); if (serviceInstance == null) { supportedLifecycleProcessors.forEach((lifecycle) -\u0026gt; { lifecycle.onComplete(new CompletionContext(Status.DISCARD, lbRequest, new EmptyResponse())); }); //æ²¡æœ‰å‘ç°ä»»ä½•æ­¤æœåŠ¡çš„å®ä¾‹å°±æŠ›å¼‚å¸¸ï¼ˆä¹‹å‰çš„æµ‹è¯•ä¸­å¯èƒ½å·²ç»é‡åˆ°äº†ï¼‰ throw new IllegalStateException(\u0026#34;No instances available for \u0026#34; + serviceId); } else { //æˆåŠŸè·å–åˆ°å¯¹åº”æœåŠ¡çš„å®ä¾‹ï¼Œè¿™æ—¶å°±å¯ä»¥å‘èµ·HTTPè¯·æ±‚è·å–ä¿¡æ¯äº† return this.execute(serviceId, serviceInstance, lbRequest); } } æ‰€ä»¥ï¼Œå®é™…ä¸Šåœ¨è¿›è¡Œè´Ÿè½½å‡è¡¡çš„æ—¶å€™ï¼Œä¼šå‘Eurekaå‘èµ·è¯·æ±‚ï¼Œé€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„å¯¹åº”æœåŠ¡ï¼Œç„¶åä¼šè¿”å›æ­¤æœåŠ¡çš„ä¸»æœºåœ°å€ç­‰ä¿¡æ¯ï¼š\nè‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥ #\rLoadBalanceré»˜è®¤æä¾›äº†ä¸¤ç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š\nRandomLoadBalancer - éšæœºåˆ†é…ç­–ç•¥ (é»˜è®¤) RoundRobinLoadBalancer - è½®è¯¢åˆ†é…ç­–ç•¥ ç°åœ¨æˆ‘ä»¬å¸Œæœ›ä¿®æ”¹é»˜è®¤çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯ä»¥è¿›è¡ŒæŒ‡å®šï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨å¸Œæœ›ç”¨æˆ·æœåŠ¡é‡‡ç”¨éšæœºåˆ†é…ç­–ç•¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºéšæœºåˆ†é…ç­–ç•¥çš„é…ç½®ç±»ï¼ˆä¸ç”¨åŠ @Configurationï¼‰ï¼š\npublic class LoadBalancerConfig { //å°†å®˜æ–¹æä¾›çš„ RandomLoadBalancer æ³¨å†Œä¸ºBean @Bean public ReactorLoadBalancer\u0026lt;ServiceInstance\u0026gt; randomLoadBalancer(Environment environment, LoadBalancerClientFactory loadBalancerClientFactory){ String name = environment.getProperty(LoadBalancerClientFactory.PROPERTY_NAME); return new RandomLoadBalancer(loadBalancerClientFactory.getLazyProvider(name, ServiceInstanceListSupplier.class), name); } } æ¥ç€æˆ‘ä»¬éœ€è¦ä¸ºå¯¹åº”çš„æœåŠ¡æŒ‡å®šè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œç›´æ¥ä½¿ç”¨æ³¨è§£å³å¯ï¼š\n@Configuration @LoadBalancerClient(value = \u0026#34;userservice\u0026#34;, //æŒ‡å®šä¸º userservice æœåŠ¡ï¼Œåªè¦æ˜¯è°ƒç”¨æ­¤æœåŠ¡éƒ½ä¼šä½¿ç”¨æˆ‘ä»¬æŒ‡å®šçš„ç­–ç•¥ configuration = LoadBalancerConfig.class) //æŒ‡å®šæˆ‘ä»¬åˆšåˆšå®šä¹‰å¥½çš„é…ç½®ç±» public class BeanConfig { @Bean @LoadBalanced RestTemplate template(){ return new RestTemplate(); } } æ¥ç€æˆ‘ä»¬åœ¨BlockingLoadBalancerClientä¸­æ·»åŠ æ–­ç‚¹ï¼Œè§‚å¯Ÿæ˜¯å¦é‡‡ç”¨æˆ‘ä»¬æŒ‡å®šçš„ç­–ç•¥è¿›è¡Œè¯·æ±‚ï¼š\nå‘ç°è®¿é—®userserviceæœåŠ¡çš„ç­–ç•¥å·²ç»æ›´æ”¹ä¸ºæˆ‘ä»¬æŒ‡å®šçš„ç­–ç•¥äº†ã€‚\nOpenFeignå®ç°è´Ÿè½½å‡è¡¡ #\rå®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.spring.io/spring-cloud-openfeign/docs/current/reference/html/\nFeignå’ŒRestTemplateä¸€æ ·ï¼Œä¹Ÿæ˜¯HTTPå®¢æˆ·ç«¯è¯·æ±‚å·¥å…·ï¼Œä½†æ˜¯å®ƒçš„ä½¿ç”¨æ–¹å¼æ›´åŠ ä¾¿æ·ã€‚é¦–å…ˆæ˜¯ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-openfeign\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€åœ¨å¯åŠ¨ç±»æ·»åŠ @EnableFeignClientsæ³¨è§£ï¼š\n@SpringBootApplication @EnableFeignClients public class BorrowApplication { public static void main(String[] args) { SpringApplication.run(BorrowApplication.class, args); } } é‚£ä¹ˆç°åœ¨æˆ‘ä»¬éœ€è¦è°ƒç”¨å…¶ä»–å¾®æœåŠ¡æä¾›çš„æ¥å£ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªå¯¹åº”æœåŠ¡çš„æ¥å£ç±»å³å¯ï¼š\n@FeignClient(\u0026#34;userservice\u0026#34;) //å£°æ˜ä¸ºuserserviceæœåŠ¡çš„HTTPè¯·æ±‚å®¢æˆ·ç«¯ public interface UserClient { } æ¥ç€æˆ‘ä»¬ç›´æ¥åˆ›å»ºæ‰€éœ€ç±»å‹çš„æ–¹æ³•ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰çš„ï¼š\nRestTemplate template = new RestTemplate(); User user = template.getForObject(\u0026#34;http://userservice/user/\u0026#34;+uid, User.class); ç°åœ¨å¯ä»¥ç›´æ¥å†™æˆè¿™æ ·ï¼š\n@FeignClient(\u0026#34;userservice\u0026#34;) public interface UserClient { //è·¯å¾„ä¿è¯å’Œå…¶ä»–å¾®æœåŠ¡æä¾›çš„ä¸€è‡´å³å¯ @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) User getUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid); //å‚æ•°å’Œè¿”å›å€¼ä¹Ÿä¿æŒä¸€è‡´ } æ¥ç€æˆ‘ä»¬ç›´æ¥æ³¨å…¥ä½¿ç”¨ï¼ˆæœ‰Mybatisé‚£å‘³äº†ï¼‰ï¼š\n@Resource UserClient userClient; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); User user = userClient.getUserById(uid); //è¿™é‡Œä¸ç”¨å†å†™IPï¼Œç›´æ¥å†™æœåŠ¡åç§°bookservice List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; template.getForObject(\u0026#34;http://bookservice/book/\u0026#34;+b.getBid(), Book.class)) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœä¾ç„¶æ˜¯æ­£ç¡®çš„ï¼š\nå¹¶ä¸”æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä¸€ä¸‹ä¸¤ä¸ªç”¨æˆ·å¾®æœåŠ¡çš„è°ƒç”¨æƒ…å†µï¼Œä¹Ÿæ˜¯ä»¥è´Ÿè½½å‡è¡¡çš„å½¢å¼è¿›è¡Œçš„ã€‚\næŒ‰ç…§åŒæ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥ç€å°†å›¾ä¹¦ç®¡ç†æœåŠ¡çš„è°ƒç”¨ä¹Ÿæ”¹æˆæ¥å£å½¢å¼ï¼š\næœ€åæˆ‘ä»¬çš„Serviceä»£ç å°±å˜æˆäº†ï¼š\n@Service public class BorrowServiceImpl implements BorrowService { @Resource BorrowMapper mapper; @Resource UserClient userClient; @Resource BookClient bookClient; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); User user = userClient.getUserById(uid); List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; bookClient.getBookById(b.getBid())) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } } ç»§ç»­è®¿é—®è¿›è¡Œæµ‹è¯•ï¼š\nOKï¼Œæ­£å¸¸ã€‚\nå½“ç„¶ï¼ŒFeignä¹Ÿæœ‰å¾ˆå¤šçš„å…¶ä»–é…ç½®é€‰é¡¹ï¼Œè¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ï¼Œè¯¦ç»†è¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚\nHystrix æœåŠ¡ç†”æ–­ #\rå®˜æ–¹æ–‡æ¡£ï¼šhttps://cloud.spring.io/spring-cloud-static/spring-cloud-netflix/1.3.5.RELEASE/single/spring-cloud-netflix.html#_circuit_breaker_hystrix_clients\næˆ‘ä»¬çŸ¥é“ï¼Œå¾®æœåŠ¡ä¹‹é—´æ˜¯å¯ä»¥è¿›è¡Œç›¸äº’è°ƒç”¨çš„ï¼Œé‚£ä¹ˆå¦‚æœå‡ºç°äº†ä¸‹é¢çš„æƒ…å†µä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ\nç”±äºä½äºæœ€åº•ç«¯çš„æœåŠ¡æä¾›è€…Eå‘ç”Ÿæ•…éšœï¼Œé‚£ä¹ˆæ­¤æ—¶ä¼šç›´æ¥å¯¼è‡´æœåŠ¡ABCDå…¨çº¿å´©æºƒï¼Œå°±åƒé›ªå´©äº†ä¸€æ ·ã€‚\nè¿™ç§é—®é¢˜å®é™…ä¸Šæ˜¯ä¸å¯é¿å…çš„ï¼Œç”±äºå¤šç§å› ç´ ï¼Œæ¯”å¦‚ç½‘ç»œå¡é¡¿ã€ç³»ç»Ÿæ•…éšœã€ç¡¬ä»¶é—®é¢˜ç­‰ï¼Œéƒ½å­˜åœ¨ä¸€å®šå¯èƒ½ï¼Œä¼šå¯¼è‡´è¿™ç§æç«¯çš„æƒ…å†µå‘ç”Ÿã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ä¸ªåº”å¯¹è¿™ç§æç«¯æƒ…å†µçš„è§£å†³æ–¹æ¡ˆã€‚\nä¸ºäº†è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿçš„é›ªå´©é—®é¢˜ï¼ŒSpringCloudæä¾›äº†Hystrixç†”æ–­å™¨ç»„ä»¶ï¼Œä»–å°±åƒæˆ‘ä»¬å®¶ä¸­çš„ä¿é™©ä¸ä¸€æ ·ï¼Œå½“ç”µæµè¿‡è½½å°±ä¼šç›´æ¥ç†”æ–­ï¼Œé˜²æ­¢å±é™©è¿›ä¸€æ­¥å‘ç”Ÿï¼Œä»è€Œä¿è¯å®¶åº­ç”¨ç”µå®‰å…¨ã€‚å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ•´æ¡é“¾è·¯ä¸Šçš„æœåŠ¡å·²ç»å…¨çº¿å´©æºƒï¼Œè¿™æ—¶è¿˜åœ¨ä¸æ–­åœ°æœ‰å¤§é‡çš„è¯·æ±‚åˆ°è¾¾ï¼Œéœ€è¦å„ä¸ªæœåŠ¡è¿›è¡Œå¤„ç†ï¼Œè‚¯å®šæ˜¯ä¼šä½¿å¾—æƒ…å†µè¶Šæ¥è¶Šç³Ÿç³•çš„ã€‚\næˆ‘ä»¬æ¥è¯¦ç»†çœ‹çœ‹å®ƒçš„å·¥ä½œæœºåˆ¶ã€‚\næœåŠ¡é™çº§ #\ré¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹æœåŠ¡é™çº§ï¼Œæ³¨æ„ä¸€å®šè¦åŒºåˆ†å¼€æœåŠ¡é™çº§å’ŒæœåŠ¡ç†”æ–­çš„åŒºåˆ«ï¼ŒæœåŠ¡é™çº§å¹¶ä¸ä¼šç›´æ¥è¿”å›é”™è¯¯ï¼Œè€Œæ˜¯å¯ä»¥æä¾›ä¸€ä¸ªè¡¥æ•‘æªæ–½ï¼Œæ­£å¸¸å“åº”ç»™è¯·æ±‚è€…ã€‚è¿™æ ·ç›¸å½“äºæœåŠ¡ä¾ç„¶å¯ç”¨ï¼Œä½†æ˜¯æœåŠ¡èƒ½åŠ›è‚¯å®šæ˜¯ä¸‹é™äº†çš„ã€‚\næˆ‘ä»¬å°±åŸºäºå€Ÿé˜…ç®¡ç†æœåŠ¡æ¥è¿›è¡Œè®²è§£ï¼Œæˆ‘ä»¬ä¸å¼€å¯ç”¨æˆ·æœåŠ¡å’Œå›¾ä¹¦æœåŠ¡ï¼Œè¡¨ç¤ºç”¨æˆ·æœåŠ¡å’Œå›¾ä¹¦æœåŠ¡å·²ç»æŒ‚æ‰äº†ã€‚\nè¿™é‡Œæˆ‘ä»¬å¯¼å…¥Hystrixçš„ä¾èµ–ï¼ˆæ­¤é¡¹ç›®å·²ç»åœæ­¢ç»´æŠ¤ï¼ŒSpringCloudä¾èµ–ä¸­å·²ç»ä¸è‡ªå¸¦äº†ï¼Œæ‰€ä»¥è¯´éœ€è¦è‡ªå·±å•ç‹¬å¯¼å…¥ï¼‰ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-hystrix\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.10.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€æˆ‘ä»¬éœ€è¦åœ¨å¯åŠ¨ç±»æ·»åŠ æ³¨è§£å¼€å¯ï¼š\n@SpringBootApplication @EnableHystrix //å¯ç”¨Hystrix public class BorrowApplication { public static void main(String[] args) { SpringApplication.run(BorrowApplication.class, args); } } é‚£ä¹ˆç°åœ¨ï¼Œç”±äºç”¨æˆ·æœåŠ¡å’Œå›¾ä¹¦æœåŠ¡ä¸å¯ç”¨ï¼Œæ‰€ä»¥æŸ¥è¯¢å€Ÿé˜…ä¿¡æ¯çš„è¯·æ±‚è‚¯å®šæ˜¯æ²¡åŠæ³•æ­£å¸¸å“åº”çš„ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªå¤‡é€‰æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯è¯´å½“æœåŠ¡å‡ºç°å¼‚å¸¸æ—¶ï¼Œè¿”å›æˆ‘ä»¬çš„å¤‡é€‰æ–¹æ¡ˆï¼š\n@RestController public class BorrowController { @Resource BorrowService service; @HystrixCommand(fallbackMethod = \u0026#34;onError\u0026#34;) //ä½¿ç”¨@HystrixCommandæ¥æŒ‡å®šå¤‡é€‰æ–¹æ¡ˆ @RequestMapping(\u0026#34;/borrow/{uid}\u0026#34;) UserBorrowDetail findUserBorrows(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserBorrowDetailByUid(uid); } //å¤‡é€‰æ–¹æ¡ˆï¼Œè¿™é‡Œç›´æ¥è¿”å›ç©ºåˆ—è¡¨äº† //æ³¨æ„å‚æ•°å’Œè¿”å›å€¼è¦å’Œä¸Šé¢çš„ä¸€è‡´ UserBorrowDetail onError(int uid){ return new UserBorrowDetail(null, Collections.emptyList()); } } å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æˆ‘ä»¬çš„æœåŠ¡æ— æ³•æ­£å¸¸è¿è¡Œäº†ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥ç»™æµè§ˆå™¨æ­£å¸¸è¿”å›å“åº”æ•°æ®ï¼š\næœåŠ¡é™çº§æ˜¯ä¸€ç§æ¯”è¾ƒæ¸©æŸ”çš„è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶æœåŠ¡æœ¬èº«çš„ä¸å¯ç”¨ï¼Œä½†æ˜¯èƒ½å¤Ÿä¿è¯æ­£å¸¸å“åº”æ•°æ®ã€‚\næœåŠ¡ç†”æ–­ #\rç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶ï¼Œå½“æ£€æµ‹å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§ï¼Œè¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨ï¼Œå¿«é€Ÿè¿”å›â€é”™è¯¯â€çš„å“åº”ä¿¡æ¯ã€‚å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹å¾®æœåŠ¡å“åº”æ­£å¸¸åæ¢å¤è°ƒç”¨é“¾è·¯ã€‚\nå®é™…ä¸Šï¼Œç†”æ–­å°±æ˜¯åœ¨é™çº§çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥å‡çº§å½¢æˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…å¤šæ¬¡è°ƒç”¨å¤±è´¥ï¼Œé‚£ä¹ˆå°±ç›´æ¥å‡çº§ä¸ºç†”æ–­ã€‚\næˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸¤æ¡è¾“å‡ºè¯­å¥ï¼š\n@RestController public class BorrowController { @Resource BorrowService service; @HystrixCommand(fallbackMethod = \u0026#34;onError\u0026#34;) @RequestMapping(\u0026#34;/borrow/{uid}\u0026#34;) UserBorrowDetail findUserBorrows(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ System.out.println(\u0026#34;å¼€å§‹å‘å…¶ä»–æœåŠ¡è·å–ä¿¡æ¯\u0026#34;); return service.getUserBorrowDetailByUid(uid); } UserBorrowDetail onError(int uid){ System.out.println(\u0026#34;æœåŠ¡é”™è¯¯ï¼Œè¿›å…¥å¤‡é€‰æ–¹æ³•ï¼\u0026#34;); return new UserBorrowDetail(null, Collections.emptyList()); } } æ¥ç€ï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­ç–¯ç‹‚ç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼Œå¯¹æ­¤æœåŠ¡ç–¯ç‹‚å‘èµ·è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°åå°ï¼š\nä¸€å¼€å§‹çš„æ—¶å€™ï¼Œä¼šæ­£å¸¸åœ°å»è°ƒç”¨Controllerå¯¹åº”çš„æ–¹æ³•findUserBorrowsï¼Œå‘ç°å¤±è´¥ç„¶åè¿›å…¥å¤‡é€‰æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°åœ¨æŒç»­è¯·æ±‚ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæ²¡æœ‰å†è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨å¤‡é€‰æ–¹æ¡ˆï¼Œè¿™ä¾¿æ˜¯å‡çº§åˆ°äº†ç†”æ–­çŠ¶æ€ã€‚\næˆ‘ä»¬å¯ä»¥ç»§ç»­ä¸æ–­ç‚¹å‡»ï¼Œç»§ç»­ä¸æ–­åœ°å‘èµ·è¯·æ±‚ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œä¼šå°è¯•æ­£å¸¸æ‰§è¡Œä¸€æ¬¡findUserBorrowsï¼Œä½†æ˜¯ä¾ç„¶æ˜¯å¤±è´¥çŠ¶æ€ï¼Œæ‰€ä»¥ç»§ç»­ä¿æŒç†”æ–­çŠ¶æ€ã€‚\næ‰€ä»¥å¾—åˆ°ç»“è®ºï¼Œå®ƒèƒ½å¤Ÿå¯¹ä¸€æ®µæ—¶é—´å†…å‡ºç°çš„é”™è¯¯è¿›è¡Œä¾¦æµ‹ï¼Œå½“ä¾¦æµ‹åˆ°å‡ºé”™æ¬¡æ•°è¿‡å¤šæ—¶ï¼Œç†”æ–­å™¨ä¼šæ‰“å¼€ï¼Œæ‰€æœ‰çš„è¯·æ±‚ä¼šç›´æ¥å“åº”å¤±è´¥ï¼Œä¸€æ®µæ—¶é—´åï¼Œåªæ‰§è¡Œä¸€å®šæ•°é‡çš„è¯·æ±‚ï¼Œå¦‚æœè¿˜æ˜¯å‡ºç°é”™è¯¯ï¼Œé‚£ä¹ˆåˆ™ç»§ç»­ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå¦åˆ™è¯´æ˜æœåŠ¡æ¢å¤æ­£å¸¸è¿è¡Œï¼Œå…³é—­ç†”æ–­å™¨ã€‚\næˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸‹ï¼Œå¼€å¯å¦å¤–ä¸¤ä¸ªæœåŠ¡ä¹‹åï¼Œç»§ç»­ç‚¹å‡»ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œå½“å¦å¤–ä¸¤ä¸ªæœåŠ¡æ­£å¸¸è¿è¡Œä¹‹åï¼Œå½“å†æ¬¡å°è¯•è°ƒç”¨findUserBorrowsä¹‹åä¼šæˆåŠŸï¼Œäºæ˜¯ç†”æ–­æœºåˆ¶å°±å…³é—­äº†ï¼ŒæœåŠ¡æ¢å¤è¿è¡Œã€‚\næ€»ç»“ä¸€ä¸‹ï¼š\nOpenFeignå®ç°é™çº§ #\rHystrixä¹Ÿå¯ä»¥é…åˆFeignè¿›è¡Œé™çº§ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹åº”æ¥å£ä¸­å®šä¹‰çš„è¿œç¨‹è°ƒç”¨å•ç‹¬è¿›è¡Œé™çº§æ“ä½œã€‚\næ¯”å¦‚æˆ‘ä»¬è¿˜æ˜¯ä»¥ç”¨æˆ·æœåŠ¡æŒ‚æ‰ä¸ºä¾‹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™è‚¯å®šæ˜¯ä¼šè¿œç¨‹è°ƒç”¨å¤±è´¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„Controllerä¸­çš„æ–¹æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè¿›è€Œè¢«Hystrixç›‘æ§åˆ°å¹¶è¿›è¡ŒæœåŠ¡é™çº§ã€‚\nè€Œå®é™…ä¸Šå¯¼è‡´æ–¹æ³•æ‰§è¡Œå¼‚å¸¸çš„æ ¹æºå°±æ˜¯è¿œç¨‹è°ƒç”¨å¤±è´¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼Œæ—¢ç„¶ç”¨æˆ·æœåŠ¡è°ƒç”¨å¤±è´¥ï¼Œé‚£ä¹ˆæˆ‘å°±ç»™è¿™ä¸ªè¿œç¨‹è°ƒç”¨æ·»åŠ ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œå¦‚æœæ­¤è¿œç¨‹è°ƒç”¨å¤±è´¥ï¼Œé‚£ä¹ˆå°±ç›´æ¥ä¸Šæ›¿ä»£æ–¹æ¡ˆã€‚é‚£ä¹ˆæ€ä¹ˆå®ç°æ›¿ä»£æ–¹æ¡ˆå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“Feignéƒ½æ˜¯ä»¥æ¥å£çš„å½¢å¼æ¥å£°æ˜è¿œç¨‹è°ƒç”¨ï¼Œé‚£ä¹ˆæ—¢ç„¶è¿œç¨‹è°ƒç”¨å·²ç»å¤±æ•ˆï¼Œæˆ‘ä»¬å°±è‡ªè¡Œå¯¹å…¶è¿›è¡Œå®ç°ï¼Œåˆ›å»ºä¸€ä¸ªå®ç°ç±»ï¼Œå¯¹åŸæœ‰çš„æ¥å£æ–¹æ³•è¿›è¡Œæ›¿ä»£æ–¹æ¡ˆå®ç°ï¼š\n@Component //æ³¨æ„ï¼Œéœ€è¦å°†å…¶æ³¨å†Œä¸ºBeanï¼ŒFeignæ‰èƒ½è‡ªåŠ¨æ³¨å…¥ public class UserFallbackClient implements UserClient{ @Override public User getUserById(int uid) { //è¿™é‡Œæˆ‘ä»¬è‡ªè¡Œå¯¹å…¶è¿›è¡Œå®ç°ï¼Œå¹¶è¿”å›æˆ‘ä»¬çš„æ›¿ä»£æ–¹æ¡ˆ User user = new User(); user.setName(\u0026#34;æˆ‘æ˜¯æ›¿ä»£æ–¹æ¡ˆ\u0026#34;); return user; } } å®ç°å®Œæˆåï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨åŸæœ‰çš„æ¥å£ä¸­æŒ‡å®šå¤±è´¥æ›¿ä»£å®ç°å³å¯ï¼š\n//fallbackå‚æ•°æŒ‡å®šä¸ºæˆ‘ä»¬åˆšåˆšç¼–å†™çš„å®ç°ç±» @FeignClient(value = \u0026#34;userservice\u0026#34;, fallback = UserFallbackClient.class) public interface UserClient { @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) User getUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid); } ç°åœ¨å»æ‰BorrowControllerçš„@HystrixCommandæ³¨è§£å’Œå¤‡é€‰æ–¹æ³•ï¼š\n@RestController public class BorrowController { @Resource BorrowService service; @RequestMapping(\u0026#34;/borrow/{uid}\u0026#34;) UserBorrowDetail findUserBorrows(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserBorrowDetailByUid(uid); } } æœ€åæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯ç†”æ–­æ”¯æŒï¼š\nfeign: circuitbreaker: enabled: true å¯åŠ¨æœåŠ¡ï¼Œè°ƒç”¨æ¥å£è¯•è¯•çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨å·²ç»é‡‡ç”¨æˆ‘ä»¬çš„æ›¿ä»£æ–¹æ¡ˆä½œä¸ºç»“æœã€‚\nç›‘æ§é¡µé¢éƒ¨ç½² #\ré™¤äº†å¯¹æœåŠ¡çš„é™çº§å’Œç†”æ–­å¤„ç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å…¶è¿›è¡Œå®æ—¶ç›‘æ§ï¼Œåªéœ€è¦å®‰è£…ç›‘æ§é¡µé¢å³å¯ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œå¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-hystrix-dashboard\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.10.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€æ·»åŠ é…ç½®æ–‡ä»¶ï¼š\nserver: port: 8900 hystrix: dashboard: # å°†localhostæ·»åŠ åˆ°ç™½åå•ï¼Œé»˜è®¤æ˜¯ä¸å…è®¸çš„ proxy-stream-allow-list: \u0026#34;localhost\u0026#34; æ¥ç€åˆ›å»ºä¸»ç±»ï¼Œæ³¨æ„éœ€è¦æ·»åŠ @EnableHystrixDashboardæ³¨è§£å¼€å¯ç®¡ç†é¡µé¢ï¼š\n@SpringBootApplication @EnableHystrixDashboard public class HystrixDashBoardApplication { public static void main(String[] args) { SpringApplication.run(HystrixDashBoardApplication.class, args); } } å¯åŠ¨Hystrixç®¡ç†é¡µé¢æœåŠ¡ï¼Œç„¶åæˆ‘ä»¬éœ€è¦åœ¨è¦è¿›è¡Œç›‘æ§çš„æœåŠ¡ä¸­æ·»åŠ Actuatorä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-actuator\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; Actuatoræ˜¯SpringBootç¨‹åºçš„ç›‘æ§ç³»ç»Ÿï¼Œå¯ä»¥å®ç°å¥åº·æ£€æŸ¥ï¼Œè®°å½•ä¿¡æ¯ç­‰ã€‚åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦å¼•å…¥spring-boot-starter-actuatorï¼Œå¹¶åšç®€å•çš„é…ç½®å³å¯ã€‚\næ·»åŠ æ­¤ä¾èµ–åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨IDEAä¸­æŸ¥çœ‹è¿è¡Œæƒ…å†µï¼š\nç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®Actuatoræ·»åŠ æš´éœ²ï¼š\nmanagement: endpoints: web: exposure: include: \u0026#39;*\u0026#39; æ¥ç€æˆ‘ä»¬æ‰“å¼€åˆšåˆšå¯åŠ¨çš„ç®¡ç†é¡µé¢ï¼Œåœ°å€ä¸ºï¼šhttp://localhost:8900/hystrix/\nåœ¨ä¸­é—´å¡«å†™è¦ç›‘æ§çš„æœåŠ¡ï¼šæ¯”å¦‚å€Ÿé˜…æœåŠ¡ï¼šhttp://localhost:8301/actuator/hystrix.streamï¼Œæ³¨æ„åé¢è¦æ·»åŠ /actuator/hystrix.streamï¼Œç„¶åç‚¹å‡»Monitor Streamå³å¯è¿›å…¥ç›‘æ§é¡µé¢ï¼š\nå¯ä»¥çœ‹åˆ°ç°åœ¨éƒ½æ˜¯LoadingçŠ¶æ€ï¼Œè¿™æ˜¯å› ä¸ºè¿˜æ²¡æœ‰å¼€å§‹ç»Ÿè®¡ï¼Œæˆ‘ä»¬ç°åœ¨å°è¯•è°ƒç”¨å‡ æ¬¡æˆ‘ä»¬çš„æœåŠ¡ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨è°ƒç”¨ä¹‹åï¼Œç›‘æ§é¡µé¢å‡ºç°äº†ä¿¡æ¯ï¼š\nå¯ä»¥çœ‹åˆ°5æ¬¡è®¿é—®éƒ½æ˜¯æ­£å¸¸çš„ï¼Œæ‰€ä»¥æ˜¾ç¤ºä¸ºç»¿è‰²ï¼Œæ¥ç€æˆ‘ä»¬æ¥å°è¯•å°†å›¾ä¹¦æœåŠ¡å…³é—­ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æœåŠ¡é™çº§ç”šè‡³ç†”æ–­ï¼Œç„¶åå†å¤šæ¬¡è®¿é—®æ­¤æœåŠ¡çœ‹çœ‹ç›‘æ§ä¼šå¦‚ä½•å˜åŒ–ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œé”™è¯¯ç‡ç›´æ¥é£™å‡åˆ°100%ï¼Œå¹¶ä¸”ä¸€æ®µæ—¶é—´å†…æŒç»­å‡ºç°é”™è¯¯ï¼Œä¸­å¿ƒçš„åœ†åœˆä¹Ÿå˜æˆäº†çº¢è‰²ï¼Œæˆ‘ä»¬ç»§ç»­è¿›è¡Œè®¿é—®ï¼š\nåœ¨å‡ºç°å¤§é‡é”™è¯¯çš„æƒ…å†µä¸‹ä¿æŒæŒç»­è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶å·²ç»å°†æœåŠ¡ç†”æ–­ï¼ŒCircuitæ›´æ”¹ä¸ºOpençŠ¶æ€ï¼Œå¹¶ä¸”å›¾ä¸­çš„åœ†åœˆä¹Ÿå˜å¾—æ›´å¤§ï¼Œè¡¨ç¤ºå‹åŠ›åœ¨æŒç»­ä¸Šå‡ã€‚\nGateway è·¯ç”±ç½‘å…³ #\rå®˜ç½‘åœ°å€ï¼šhttps://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/\nè¯´åˆ°è·¯ç”±ï¼Œæƒ³å¿…å„ä½ä¸€å®šæœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯å®¶é‡Œçš„è·¯ç”±å™¨äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®¶é‡Œçš„è·¯ç”±å™¨å……å½“çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆè§’è‰²å‘¢ï¼Ÿ\næˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è¿æ¥äº’è”ç½‘ï¼Œé‚£ä¹ˆå°±éœ€è¦å°†æ‰‹æœºæˆ–æ˜¯ç”µè„‘è¿æ¥åˆ°å®¶é‡Œçš„è·¯ç”±å™¨æ‰å¯ä»¥ï¼Œè€Œè·¯ç”±å™¨åˆ™è¿æ¥å…‰çŒ«ï¼Œå…‰çŒ«å†é€šè¿‡å…‰çº¤è¿æ¥åˆ°äº’è”ç½‘ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œäº’è”ç½‘æ–¹å‘å‘é€è¿‡æ¥çš„æ•°æ®ï¼Œéœ€è¦ç»è¿‡è·¯ç”±å™¨æ‰èƒ½åˆ°è¾¾æˆ‘ä»¬çš„è®¾å¤‡ã€‚è€Œè·¯ç”±å™¨å……å½“çš„å°±æ˜¯æ•°æ®åŒ…ä¸­è½¬ç«™ï¼Œæ‰€æœ‰çš„å±€åŸŸç½‘è®¾å¤‡éƒ½æ— æ³•ç›´æ¥ä¸äº’è”ç½‘è¿æ¥ï¼Œè€Œæ˜¯éœ€è¦ç»è¿‡è·¯ç”±å™¨è¿›è¡Œä¸­è½¬ï¼Œæˆ‘ä»¬ä¸€èˆ¬è¯´è·¯ç”±å™¨ä¸‹çš„ç½‘ç»œæ˜¯å†…ç½‘ï¼Œè€Œäº’è”ç½‘é‚£ä¸€ç«¯æ˜¯å¤–ç½‘ã€‚\næˆ‘ä»¬çš„å±€åŸŸç½‘è®¾å¤‡ï¼Œæ— æ³•è¢«äº’è”ç½‘ä¸Šçš„å…¶ä»–è®¾å¤‡ç›´æ¥è®¿é—®ï¼Œè‚¯å®šæ˜¯èƒ½å¤Ÿä¿è¯åˆ°å®‰å…¨æ€§çš„ã€‚å¹¶äº’è”ç½‘å‘é€è¿‡æ¥çš„æ•°æ®ï¼Œéœ€è¦ç»è¿‡è·¯ç”±å™¨è¿›è¡Œè§£æï¼Œè¯†åˆ«åˆ°åº•æ˜¯å“ªä¸€ä¸ªè®¾å¤‡çš„æ•°æ®åŒ…ï¼Œç„¶åå†å‘é€ç»™å¯¹åº”çš„è®¾å¤‡ã€‚\nè€Œæˆ‘ä»¬çš„å¾®æœåŠ¡ä¹Ÿæ˜¯è¿™æ ·ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯èƒ½å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¾®æœåŠ¡éƒ½éœ€è¦ç›´æ¥æš´éœ²ç»™å¤–éƒ¨è°ƒç”¨ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è·¯ç”±æœºåˆ¶ï¼Œæ·»åŠ ä¸€å±‚é˜²æŠ¤ï¼Œè®©æ‰€æœ‰çš„è¯·æ±‚å…¨éƒ¨é€šè¿‡è·¯ç”±æ¥è½¬å‘åˆ°å„ä¸ªå¾®æœåŠ¡ï¼Œå¹¶ä¸”è½¬å‘ç»™å¤šä¸ªç›¸åŒå¾®æœåŠ¡å®ä¾‹ä¹Ÿå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ã€‚\nåœ¨ä¹‹å‰ï¼Œè·¯ç”±çš„å®ç°ä¸€èˆ¬ä½¿ç”¨Zuulï¼Œä½†æ˜¯å·²ç»åœæ›´ï¼Œè€Œç°åœ¨æ–°å‡ºç°äº†ç”±SpringCloudå®˜æ–¹å¼€å‘çš„Gatewayè·¯ç”±ï¼Œå®ƒç›¸æ¯”Zuulä¸ä»…æ€§èƒ½ä¸Šå¾—åˆ°äº†ä¸€å®šçš„æå‡ï¼Œå¹¶ä¸”æ˜¯å®˜æ–¹æ¨å‡ºï¼Œå¥‘åˆæ€§ä¹Ÿä¼šæ›´å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå°±ä¸»è¦è®²è§£Gatewayã€‚\néƒ¨ç½²ç½‘å…³ #\rç°åœ¨æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œä½œä¸ºæˆ‘ä»¬çš„ç½‘å…³ï¼Œè¿™é‡Œéœ€è¦æ·»åŠ ä¸¤ä¸ªä¾èµ–ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-gateway\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-eureka-client\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; ç¬¬ä¸€ä¸ªä¾èµ–å°±æ˜¯ç½‘å…³çš„ä¾èµ–ï¼Œè€Œç¬¬äºŒä¸ªåˆ™è·Ÿå…¶ä»–å¾®æœåŠ¡ä¸€æ ·ï¼Œéœ€è¦æ³¨å†Œåˆ°Eurekaæ‰èƒ½ç”Ÿæ•ˆï¼Œæ³¨æ„åˆ«æ·»åŠ Webä¾èµ–ï¼Œä½¿ç”¨çš„æ˜¯WebFluxæ¡†æ¶ã€‚\nç„¶åæˆ‘ä»¬æ¥å®Œå–„ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼š\nserver: port: 8500 eureka: client: service-url: defaultZone: http://localhost:8801/eureka, http://localhost:8802/eureka spring: application: name: gateway ç°åœ¨å°±å¯ä»¥å¯åŠ¨äº†ï¼š\nä½†æ˜¯ç°åœ¨è¿˜æ²¡æœ‰é…ç½®ä»»ä½•çš„è·¯ç”±åŠŸèƒ½ï¼Œæˆ‘ä»¬æ¥ç€å°†è·¯ç”±åŠŸèƒ½è¿›è¡Œé…ç½®ï¼š\nspring: cloud: gateway: # é…ç½®è·¯ç”±ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ä¸ªåˆ—è¡¨ï¼Œæ¯ä¸€é¡¹éƒ½åŒ…å«äº†å¾ˆå¤šä¿¡æ¯ routes: - id: borrow-service # è·¯ç”±åç§° uri: lb://borrowservice # è·¯ç”±çš„åœ°å€ï¼Œlbè¡¨ç¤ºä½¿ç”¨è´Ÿè½½å‡è¡¡åˆ°å¾®æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨httpæ­£å¸¸è½¬å‘ predicates: # è·¯ç”±è§„åˆ™ï¼Œæ–­è¨€ä»€ä¹ˆè¯·æ±‚ä¼šè¢«è·¯ç”± - Path=/borrow/** # åªè¦æ˜¯è®¿é—®çš„è¿™ä¸ªè·¯å¾„ï¼Œä¸€å¾‹éƒ½è¢«è·¯ç”±åˆ°ä¸Šé¢æŒ‡å®šçš„æœåŠ¡ è·¯ç”±è§„åˆ™çš„è¯¦ç»†åˆ—è¡¨ï¼ˆæ–­è¨€å·¥å‚åˆ—è¡¨ï¼‰åœ¨è¿™é‡Œï¼šhttps://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-request-predicates-factoriesï¼Œå¯ä»¥æŒ‡å®šå¤šç§ç±»å‹ï¼ŒåŒ…æ‹¬æŒ‡å®šæ—¶é—´æ®µã€Cookieæºå¸¦æƒ…å†µã€Headeræºå¸¦æƒ…å†µã€è®¿é—®çš„åŸŸååœ°å€ã€è®¿é—®çš„æ–¹æ³•ã€è·¯å¾„ã€å‚æ•°ã€è®¿é—®è€…IPç­‰ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨é…ç½®ç±»è¿›è¡Œé…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æ¨èç›´æ¥é…ç½®æ–‡ä»¶ï¼Œçœäº‹ã€‚\næ¥ç€å¯åŠ¨ç½‘å…³ï¼Œæ­è½½Armæ¶æ„èŠ¯ç‰‡çš„Macç”µè„‘å¯èƒ½ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼š\nè¿™æ˜¯å› ä¸ºæ²¡æœ‰æ‰¾åˆ°é€‚ç”¨äºæ­¤æ¶æ„çš„åŠ¨æ€é“¾æ¥åº“ï¼Œä¸å½±å“ä½¿ç”¨ï¼Œæ— è§†å³å¯ï¼Œå¸Œæœ›ä»¥åçš„ç‰ˆæœ¬èƒ½ä¿®å¤å§ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç›´æ¥é€šè¿‡è·¯ç”±æ¥è®¿é—®æˆ‘ä»¬çš„æœåŠ¡äº†ï¼š\næ³¨æ„æ­¤æ—¶ä¾ç„¶å¯ä»¥é€šè¿‡åŸæœ‰çš„æœåŠ¡åœ°å€è¿›è¡Œè®¿é—®ï¼š\nè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†ä¸éœ€è¦å¤–ç½‘ç›´æ¥è®¿é—®çš„å¾®æœåŠ¡å…¨éƒ¨æ”¾åˆ°å†…ç½‘ç¯å¢ƒä¸‹ï¼Œè€Œåªä¾é ç½‘å…³æ¥å¯¹å¤–è¿›è¡Œäº¤æ¶‰ã€‚\nè·¯ç”±è¿‡æ»¤å™¨ #\rè·¯ç”±è¿‡æ»¤å™¨æ”¯æŒä»¥æŸç§æ–¹å¼ä¿®æ”¹ä¼ å…¥çš„ HTTP è¯·æ±‚æˆ–ä¼ å‡ºçš„ HTTP å“åº”ï¼Œè·¯ç”±è¿‡æ»¤å™¨çš„èŒƒå›´æ˜¯æŸä¸€ä¸ªè·¯ç”±ï¼Œè·Ÿä¹‹å‰çš„æ–­è¨€ä¸€æ ·ï¼ŒSpring Cloud Gateway ä¹ŸåŒ…å«è®¸å¤šå†…ç½®çš„è·¯ç”±è¿‡æ»¤å™¨å·¥å‚ï¼Œè¯¦ç»†åˆ—è¡¨ï¼šhttps://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gatewayfilter-factories\næ¯”å¦‚æˆ‘ä»¬ç°åœ¨å¸Œæœ›åœ¨è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ä¸€äº›ä¿¡æ¯å†è½¬å‘ç»™æˆ‘ä»¬çš„æœåŠ¡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨è·¯ç”±è¿‡æ»¤å™¨æ¥å®Œæˆï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼š\nspring: application: name: gateway cloud: gateway: routes: - id: borrow-service uri: lb://borrowservice predicates: - Path=/borrow/** # ç»§ç»­æ·»åŠ æ–°çš„è·¯ç”±é…ç½®ï¼Œè¿™é‡Œå°±ä»¥ä¹¦ç±ç®¡ç†æœåŠ¡ä¸ºä¾‹ # æ³¨æ„-è¦å¯¹é½routes: - id: book-service uri: lb://bookservice predicates: - Path=/book/** filters: # æ·»åŠ è¿‡æ»¤å™¨ - AddRequestHeader=Test, HelloWorld! # AddRequestHeader å°±æ˜¯æ·»åŠ è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå…¶ä»–å·¥å‚è¯·æŸ¥é˜…å®˜ç½‘ æ¥ç€æˆ‘ä»¬åœ¨BookControllerä¸­è·å–å¹¶è¾“å‡ºä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æˆåŠŸæ·»åŠ äº†ï¼š\n@RestController public class BookController { @Resource BookService service; @RequestMapping(\u0026#34;/book/{bid}\u0026#34;) Book findBookById(@PathVariable(\u0026#34;bid\u0026#34;) int bid, HttpServletRequest request){ System.out.println(request.getHeader(\u0026#34;Test\u0026#34;)); return service.getBookById(bid); } } ç°åœ¨æˆ‘ä»¬é€šè¿‡Gatewayè®¿é—®æˆ‘ä»¬çš„å›¾ä¹¦ç®¡ç†æœåŠ¡ï¼š\nå¯ä»¥çœ‹åˆ°è¿™é‡ŒæˆåŠŸè·å–åˆ°ç”±ç½‘å…³æ·»åŠ çš„è¯·æ±‚å¤´ä¿¡æ¯äº†ã€‚\né™¤äº†é’ˆå¯¹äºæŸä¸€ä¸ªè·¯ç”±é…ç½®è¿‡æ»¤å™¨ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ï¼Œå®ƒèƒ½å¤Ÿä½œç”¨äºå…¨å±€ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦é€šè¿‡ä»£ç çš„æ–¹å¼è¿›è¡Œç¼–å†™ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦å®ç°æ‹¦æˆªæ²¡æœ‰æºå¸¦æŒ‡å®šè¯·æ±‚å‚æ•°çš„è¯·æ±‚ï¼š\n@Component //éœ€è¦æ³¨å†Œä¸ºBean public class TestFilter implements GlobalFilter { @Override public Mono\u0026lt;Void\u0026gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { //åªéœ€è¦å®ç°æ­¤æ–¹æ³• return null; } } æ¥ç€æˆ‘ä»¬ç¼–å†™åˆ¤æ–­ï¼š\n@Override public Mono\u0026lt;Void\u0026gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { //å…ˆè·å–ServerHttpRequestå¯¹è±¡ï¼Œæ³¨æ„ä¸æ˜¯HttpServletRequest ServerHttpRequest request = exchange.getRequest(); //æ‰“å°ä¸€ä¸‹æ‰€æœ‰çš„è¯·æ±‚å‚æ•° System.out.println(request.getQueryParams()); //åˆ¤æ–­æ˜¯å¦åŒ…å«testå‚æ•°ï¼Œä¸”å‚æ•°å€¼ä¸º1 List\u0026lt;String\u0026gt; value = request.getQueryParams().get(\u0026#34;test\u0026#34;); if(value != null \u0026amp;\u0026amp; value.contains(\u0026#34;1\u0026#34;)) { //å°†ServerWebExchangeå‘è¿‡æ»¤é“¾çš„ä¸‹ä¸€çº§ä¼ é€’ï¼ˆè·ŸJavaWebä¸­ä»‹ç»çš„è¿‡æ»¤å™¨å…¶å®æ˜¯å·®ä¸å¤šçš„ï¼‰ return chain.filter(exchange); }else { //ç›´æ¥åœ¨è¿™é‡Œä¸å†å‘ä¸‹ä¼ é€’ï¼Œç„¶åè¿”å›å“åº” return exchange.getResponse().setComplete(); } } å¯ä»¥çœ‹åˆ°ç»“æœï¼š\næˆåŠŸå®ç°è§„åˆ™åˆ¤æ–­å’Œæ‹¦æˆªæ“ä½œã€‚\nå½“ç„¶ï¼Œè¿‡æ»¤å™¨è‚¯å®šæ˜¯å¯ä»¥å­˜åœ¨å¾ˆå¤šä¸ªçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šè¿‡æ»¤å™¨ä¹‹é—´çš„é¡ºåºï¼š\n@Component public class TestFilter implements GlobalFilter, Ordered { //å®ç°Orderedæ¥å£ @Override public int getOrder() { return 0; } æ³¨æ„Orderçš„å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œå¹¶ä¸”æ— è®ºæ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­ç¼–å†™çš„å•ä¸ªè·¯ç”±è¿‡æ»¤å™¨è¿˜æ˜¯å…¨å±€è·¯ç”±è¿‡æ»¤å™¨ï¼Œéƒ½ä¼šå—åˆ°Orderå€¼å½±å“ï¼ˆå•ä¸ªè·¯ç”±çš„è¿‡æ»¤å™¨Orderå€¼æŒ‰ä»ä¸Šå¾€ä¸‹çš„é¡ºåºä»1å¼€å§‹é€’å¢ï¼‰ï¼Œæœ€ç»ˆæ˜¯æŒ‰ç…§Orderå€¼å†³å®šå“ªä¸ªè¿‡æ»¤å™¨ä¼˜å…ˆæ‰§è¡Œï¼Œå½“Orderå€¼ä¸€æ ·æ—¶ å…¨å±€è·¯ç”±è¿‡æ»¤å™¨æ‰§è¡Œ ä¼˜äº å•ç‹¬çš„è·¯ç”±è¿‡æ»¤å™¨æ‰§è¡Œã€‚\nConfig é…ç½®ä¸­å¿ƒ #\rå®˜æ–¹æ–‡æ¡£ï¼š https://docs.spring.io/spring-cloud-config/docs/current/reference/html/\nç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼åº”ç”¨çš„æŠ€æœ¯é€‰å‹å’Œæ­å»ºå·²ç»äº†è§£å¾—æ¯”è¾ƒå¤šäº†ï¼Œä½†æ˜¯å„ä½æœ‰æ²¡æœ‰å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬çš„å¾®æœåŠ¡é¡¹ç›®éœ€è¦éƒ¨ç½²å¾ˆå¤šä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆé…ç½®æ–‡ä»¶æˆ‘ä»¬å²‚ä¸æ˜¯å¾—ä¸€ä¸ªä¸€ä¸ªå»æ”¹ï¼Œå¯èƒ½åå‡ ä¸ªå®ä¾‹è¿˜å¥½ï¼Œè¦æ˜¯æœ‰å‡ åä¸ªä¸Šç™¾ä¸ªå‘¢ï¼Ÿé‚£æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªå»é…ç½®ï¼Œå²‚ä¸ç›´æ¥çŒæ­»åœ¨å·¥ä½ä¸Šã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´åŠ é«˜çº§çš„é›†ä¸­åŒ–åœ°é…ç½®æ–‡ä»¶ç®¡ç†å·¥å…·ï¼Œé›†ä¸­åœ°å¯¹é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚\nSpring Cloud Config ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤–éƒ¨é…ç½®æä¾›æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯æ”¯æŒã€‚ä½¿ç”¨ Config Serverï¼Œæ‚¨å¯ä»¥é›†ä¸­ç®¡ç†æ‰€æœ‰ç¯å¢ƒä¸­åº”ç”¨ç¨‹åºçš„å¤–éƒ¨é…ç½®ã€‚\nå®é™…ä¸ŠSpring Cloud Configå°±æ˜¯ä¸€ä¸ªé…ç½®ä¸­å¿ƒï¼Œæ‰€æœ‰çš„æœåŠ¡éƒ½å¯ä»¥ä»é…ç½®ä¸­å¿ƒå–å‡ºé…ç½®ï¼Œè€Œé…ç½®ä¸­å¿ƒåˆå¯ä»¥ä»GitHubè¿œç¨‹ä»“åº“ä¸­è·å–äº‘ç«¯çš„é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹GitHubä¸­çš„é…ç½®å³å¯å¯¹æ‰€æœ‰çš„æœåŠ¡è¿›è¡Œé…ç½®ç®¡ç†äº†ã€‚\néƒ¨ç½²é…ç½®ä¸­å¿ƒ #\rè¿™é‡Œæˆ‘ä»¬æ¥ç€åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œå¹¶å¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-config-server\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-eureka-client\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; è€è§„çŸ©ï¼Œå¯åŠ¨ç±»ï¼š\n@SpringBootApplication @EnableConfigServer public class ConfigApplication { public static void main(String[] args) { SpringApplication.run(ConfigApplication.class, args); } } æ¥ç€å°±æ˜¯é…ç½®æ–‡ä»¶ï¼š\nserver: port: 8700 spring: application: name: configserver eureka: client: service-url: defaultZone: http://localhost:8801/eureka, http://localhost:8802/eureka å…ˆå¯åŠ¨ä¸€æ¬¡çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½æˆåŠŸï¼š\nè¿™é‡Œæˆ‘ä»¬ä»¥æœ¬åœ°ä»“åº“ä¸ºä¾‹ï¼ˆå°±ä¸ç”¨GitHubäº†ï¼Œå¡åˆ°æ€€ç–‘äººç”Ÿäº†ï¼‰ï¼Œé¦–å…ˆåœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæœ¬åœ°Gitä»“åº“ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œåœ¨æ¡Œé¢ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬åœ°ä»“åº“ï¼š\nç„¶åæˆ‘ä»¬åœ¨æ–‡ä»¶å¤¹ä¸­éšä¾¿åˆ›å»ºä¸€äº›é…ç½®æ–‡ä»¶ï¼Œæ³¨æ„åç§°æœ€å¥½æ˜¯{æœåŠ¡åç§°}-{ç¯å¢ƒ}.ymlï¼š\nç„¶åæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ æœ¬åœ°ä»“åº“çš„ä¸€äº›ä¿¡æ¯ï¼ˆè¿œç¨‹ä»“åº“åŒç†ï¼‰ï¼Œè¯¦ç»†ä½¿ç”¨æ•™ç¨‹ï¼šhttps://docs.spring.io/spring-cloud-config/docs/current/reference/html/#_git_backend\nspring: cloud: config: server: git: # è¿™é‡Œå¡«å†™çš„æ˜¯æœ¬åœ°ä»“åº“åœ°å€ï¼Œè¿œç¨‹ä»“åº“ç›´æ¥å¡«å†™è¿œç¨‹ä»“åº“åœ°å€ http://git... uri: file://${user.home}/Desktop/config-repo # é»˜è®¤åˆ†æ”¯è®¾å®šä¸ºä½ è‡ªå·±æœ¬åœ°æˆ–æ˜¯è¿œç¨‹åˆ†æ”¯çš„åç§° default-label: main ç„¶åå¯åŠ¨æˆ‘ä»¬çš„é…ç½®æœåŠ¡å™¨ï¼Œé€šè¿‡ä»¥ä¸‹æ ¼å¼è¿›è¡Œè®¿é—®ï¼š\nhttp://localhost:8700/{æœåŠ¡åç§°}/{ç¯å¢ƒ}/{Gitåˆ†æ”¯} http://localhost:8700/{Gitåˆ†æ”¯}/{æœåŠ¡åç§°}-{ç¯å¢ƒ}.yml æ¯”å¦‚æˆ‘ä»¬è¦è®¿é—®å›¾ä¹¦æœåŠ¡çš„ç”Ÿäº§ç¯å¢ƒä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ http://localhost:8700/bookservice/prod/main é“¾æ¥ï¼Œå®ƒä¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼š\nä¹Ÿå¯ä»¥ä½¿ç”¨ http://localhost:8700/main/bookservice-prod.yml é“¾æ¥ï¼Œå®ƒä»…æ˜¾ç¤ºé…ç½®æ–‡ä»¶åŸæ–‡ï¼š\nå½“ç„¶ï¼Œé™¤äº†ä½¿ç”¨Gitæ¥ä¿å­˜ä¹‹å¤–ï¼Œè¿˜æ”¯æŒä¸€äº›å…¶ä»–çš„æ–¹å¼ï¼Œè¯¦ç»†æƒ…å†µè¯·æŸ¥é˜…å®˜ç½‘ã€‚\nå®¢æˆ·ç«¯é…ç½® #\ræœåŠ¡ç«¯é…ç½®å®Œæˆä¹‹åï¼Œæˆ‘ä»¬æ¥ç€æ¥é…ç½®ä¸€ä¸‹å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬çš„æœåŠ¡æ—¢ç„¶éœ€è¦ä»æœåŠ¡å™¨è¯»å–é…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œä¸€äº›é…ç½®ï¼Œæˆ‘ä»¬åˆ é™¤åŸæ¥çš„application.ymlæ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥ä¿ç•™ï¼Œæœ€åæ— è®ºæ˜¯è¿œç«¯é…ç½®è¿˜æ˜¯æœ¬åœ°é…ç½®éƒ½ä¼šè¢«åŠ è½½ï¼‰ï¼Œæ”¹ç”¨bootstrap.ymlï¼ˆåœ¨application.ymlä¹‹å‰åŠ è½½ï¼Œå¯ä»¥å®ç°é…ç½®æ–‡ä»¶è¿œç¨‹è·å–ï¼‰ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-config\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-bootstrap\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; spring: cloud: config: # åç§°ï¼Œå…¶å®å°±æ˜¯æ–‡ä»¶åç§° name: bookservice # é…ç½®æœåŠ¡å™¨çš„åœ°å€ uri: http://localhost:8700 # ç¯å¢ƒ profile: prod # åˆ†æ”¯ label: main é…ç½®å®Œæˆä¹‹åï¼Œå¯åŠ¨å›¾ä¹¦æœåŠ¡ï¼š\nå¯ä»¥çœ‹åˆ°å·²ç»ä»è¿œç«¯è·å–åˆ°äº†é…ç½®ï¼Œå¹¶è¿›è¡Œå¯åŠ¨ã€‚\nå¾®æœåŠ¡CAPåŸåˆ™ #\rç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯¹SpringCloud Netflixä»¥åŠSpringCloudå®˜æ–¹æ•´ä¸ªç”Ÿæ€ä¸‹çš„ç»„ä»¶è®¤è¯†ä¹Ÿå·®ä¸å¤šäº†ï¼Œå…¥é—¨æ•™å­¦å°±åˆ°æ­¤ä¸ºæ­¢ï¼Œä¸‹ä¸€ç« å°†å¼€å¯çœŸæ­£ç²¾å½©çš„æ­£ç‰‡éƒ¨åˆ†ï¼Œæœ¬ç« çš„æœ€åæˆ‘ä»¬è¿˜æ˜¯æ¥äº†è§£ä¸€äº›ç†è®ºä¸Šçš„çŸ¥è¯†ã€‚\nCAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå­˜åœ¨Consistencyï¼ˆä¸€è‡´æ€§ï¼‰ã€Availabilityï¼ˆå¯ç”¨æ€§ï¼‰ã€Partition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰ï¼Œä¸‰è€…ä¸å¯åŒæ—¶ä¿è¯ï¼Œæœ€å¤šåªèƒ½ä¿è¯å…¶ä¸­çš„ä¸¤è€…ã€‚\nä¸€è‡´æ€§ï¼ˆCï¼‰ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®å¤‡ä»½ï¼Œåœ¨åŒä¸€æ—¶åˆ»éƒ½æ˜¯åŒæ ·çš„å€¼ï¼ˆæ‰€æœ‰çš„èŠ‚ç‚¹æ— è®ºä½•æ—¶è®¿é—®éƒ½èƒ½æ‹¿åˆ°æœ€æ–°çš„å€¼ï¼‰\nå¯ç”¨æ€§ï¼ˆAï¼‰ï¼šç³»ç»Ÿä¸­éæ•…éšœèŠ‚ç‚¹æ”¶åˆ°çš„æ¯ä¸ªè¯·æ±‚éƒ½å¿…é¡»å¾—åˆ°å“åº”ï¼ˆæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„æœåŠ¡é™çº§å’Œç†”æ–­ï¼Œå…¶å®å°±æ˜¯ä¸€ç§ç»´æŒå¯ç”¨æ€§çš„æªæ–½ï¼Œè™½ç„¶æœåŠ¡è¿”å›çš„æ˜¯æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰çš„æ•°æ®ï¼Œä½†æ˜¯ä¸è‡³äºç”¨æˆ·çš„è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¿½ç•¥ï¼‰\nåˆ†åŒºå®¹é”™æ€§ï¼ˆPï¼‰ï¼šä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿé‡Œé¢ï¼ŒèŠ‚ç‚¹ä¹‹é—´ç»„æˆçš„ç½‘ç»œæœ¬æ¥åº”è¯¥æ˜¯è¿é€šçš„ï¼Œç„¶è€Œå¯èƒ½å› ä¸ºä¸€äº›æ•…éšœï¼ˆæ¯”å¦‚ç½‘ç»œä¸¢åŒ…ç­‰ï¼Œè¿™æ˜¯å¾ˆéš¾é¿å…çš„ï¼‰ï¼Œä½¿å¾—æœ‰äº›èŠ‚ç‚¹ä¹‹é—´ä¸è¿é€šäº†ï¼Œæ•´ä¸ªç½‘ç»œå°±åˆ†æˆäº†å‡ å—åŒºåŸŸï¼Œæ•°æ®å°±æ•£å¸ƒåœ¨äº†è¿™äº›ä¸è¿é€šçš„åŒºåŸŸä¸­ï¼ˆè¿™æ ·å°±å¯èƒ½å‡ºç°æŸäº›è¢«åˆ†åŒºèŠ‚ç‚¹å­˜æ”¾çš„æ•°æ®è®¿é—®å¤±è´¥ï¼Œæˆ‘ä»¬éœ€è¦æ¥å®¹å¿è¿™äº›ä¸å¯é çš„æƒ…å†µï¼‰\næ€»çš„æ¥è¯´ï¼Œæ•°æ®å­˜æ”¾çš„èŠ‚ç‚¹æ•°è¶Šå¤šï¼Œåˆ†åŒºå®¹å¿æ€§å°±è¶Šé«˜ï¼Œä½†æ˜¯è¦å¤åˆ¶æ›´æ–°çš„æ¬¡æ•°å°±è¶Šå¤šï¼Œä¸€è‡´æ€§å°±è¶Šéš¾ä¿è¯ã€‚åŒæ—¶ä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œæ›´æ–°æ‰€æœ‰èŠ‚ç‚¹æ•°æ®æ‰€éœ€è¦çš„æ—¶é—´å°±è¶Šé•¿ï¼Œé‚£ä¹ˆå¯ç”¨æ€§å°±ä¼šé™ä½ã€‚\næ‰€ä»¥è¯´ï¼Œåªèƒ½å­˜åœ¨ä»¥ä¸‹ä¸‰ç§æ–¹æ¡ˆï¼š\nAC å¯ç”¨æ€§+ä¸€è‡´æ€§ #\rè¦åŒæ—¶ä¿è¯å¯ç”¨æ€§å’Œä¸€è‡´æ€§ï¼Œä»£è¡¨ç€æŸä¸ªèŠ‚ç‚¹æ•°æ®æ›´æ–°ä¹‹åï¼Œéœ€è¦ç«‹å³å°†ç»“æœé€šçŸ¥ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå¹¶ä¸”è¦å°½å¯èƒ½çš„å¿«ï¼Œè¿™æ ·æ‰èƒ½åŠæ—¶å“åº”ä¿è¯å¯ç”¨æ€§ï¼Œè¿™å°±å¯¹ç½‘ç»œçš„ç¨³å®šæ€§è¦æ±‚éå¸¸é«˜ï¼Œä½†æ˜¯å®é™…æƒ…å†µä¸‹ï¼Œç½‘ç»œå¾ˆå®¹æ˜“å‡ºç°ä¸¢åŒ…ç­‰æƒ…å†µï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¯é çš„ä¼ è¾“ï¼Œå¦‚æœéœ€è¦é¿å…è¿™ç§é—®é¢˜ï¼Œå°±åªèƒ½å°†èŠ‚ç‚¹å…¨éƒ¨æ”¾åœ¨ä¸€èµ·ï¼Œä½†æ˜¯è¿™æ˜¾ç„¶è¿èƒŒäº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¦‚å¿µï¼Œæ‰€ä»¥å¯¹äºæˆ‘ä»¬çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¥è¯´ï¼Œå¾ˆéš¾æ¥å—ã€‚\nCP ä¸€è‡´æ€§+åˆ†åŒºå®¹é”™æ€§ #\rä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œé‚£ä¹ˆå°±å¾—å°†æŸä¸ªèŠ‚ç‚¹çš„æœ€æ–°æ•°æ®å‘é€ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå¹¶ä¸”éœ€è¦ç­‰åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½å¾—åˆ°æ•°æ®æ‰èƒ½è¿›è¡Œå“åº”ï¼ŒåŒæ—¶æœ‰äº†åˆ†åŒºå®¹é”™æ€§ï¼Œé‚£ä¹ˆä»£è¡¨æˆ‘ä»¬å¯ä»¥å®¹å¿ç½‘ç»œçš„ä¸å¯é é—®é¢˜ï¼Œæ‰€ä»¥å°±ç®—ç½‘ç»œå‡ºç°å¡é¡¿ï¼Œé‚£ä¹ˆä¹Ÿå¿…é¡»ç­‰å¾…æ‰€æœ‰èŠ‚ç‚¹å®Œæˆæ•°æ®åŒæ­¥ï¼Œæ‰èƒ½è¿›è¡Œå“åº”ï¼Œå› æ­¤å°±ä¼šå¯¼è‡´æœåŠ¡åœ¨ä¸€æ®µæ—¶é—´å†…å®Œå…¨å¤±æ•ˆï¼Œæ‰€ä»¥å¯ç”¨æ€§æ˜¯æ— æ³•å¾—åˆ°ä¿è¯çš„ã€‚\nAP å¯ç”¨æ€§+åˆ†åŒºå®¹é”™æ€§ #\ræ—¢ç„¶CPå¯èƒ½ä¼šå¯¼è‡´ä¸€æ®µæ—¶é—´å†…æœåŠ¡å¾—ä¸åˆ°ä»»ä½•å“åº”ï¼Œé‚£ä¹ˆè¦ä¿è¯å¯ç”¨æ€§ï¼Œå°±åªèƒ½æ”¾å¼ƒèŠ‚ç‚¹ä¹‹é—´æ•°æ®çš„é«˜åº¦ç»Ÿä¸€ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨æ•°æ®ä¸ç»Ÿä¸€çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œå“åº”ï¼Œå› æ­¤å°±æ— æ³•ä¿è¯ä¸€è‡´æ€§äº†ã€‚è™½ç„¶è¿™æ ·ä¼šå¯¼è‡´æ‹¿ä¸åˆ°æœ€æ–°çš„æ•°æ®ï¼Œä½†æ˜¯åªè¦æ•°æ®åŒæ­¥æ“ä½œåœ¨åå°ç»§ç»­è¿è¡Œï¼Œä¸€å®šèƒ½å¤Ÿåœ¨æŸä¸€æ—¶åˆ»å®Œæˆæ‰€æœ‰èŠ‚ç‚¹æ•°æ®çš„åŒæ­¥ï¼Œé‚£ä¹ˆå°±èƒ½å®ç°æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ‰€ä»¥APå®é™…ä¸Šæ˜¯æœ€èƒ½æ¥å—çš„ä¸€ç§æ–¹æ¡ˆã€‚\næ¯”å¦‚æˆ‘ä»¬å®ç°çš„Eurekaé›†ç¾¤ï¼Œå®ƒä½¿ç”¨çš„å°±æ˜¯APæ–¹æ¡ˆï¼ŒEurekaå„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„ï¼Œå°‘æ•°èŠ‚ç‚¹æŒ‚æ‰ä¸ä¼šå½±å“æ­£å¸¸èŠ‚ç‚¹çš„å·¥ä½œï¼Œå‰©ä½™çš„èŠ‚ç‚¹ä¾ç„¶å¯ä»¥æä¾›æ³¨å†Œå’ŒæŸ¥è¯¢æœåŠ¡ã€‚è€ŒEurekaå®¢æˆ·ç«¯åœ¨å‘æŸä¸ªEurekaæœåŠ¡ç«¯æ³¨å†Œæ—¶å¦‚æœå‘ç°è¿æ¥å¤±è´¥ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ‡æ¢è‡³å…¶ä»–èŠ‚ç‚¹ã€‚åªè¦æœ‰ä¸€å°EurekaæœåŠ¡å™¨æ­£å¸¸è¿è¡Œï¼Œé‚£ä¹ˆå°±èƒ½ä¿è¯æœåŠ¡å¯ç”¨**ï¼ˆAï¼‰ï¼Œåªä¸è¿‡æŸ¥è¯¢åˆ°çš„ä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€æ–°çš„ï¼ˆCï¼‰**\nåœ¨ä¹‹åçš„ç« èŠ‚ï¼Œæˆ‘ä»¬è¿˜ä¼šç»§ç»­äº†è§£è¿™äº›ç†è®ºçš„å…¶ä»–å®é™…åº”ç”¨ã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºæŸç çŸ¥è¯†åº“ç‰ˆæƒæ‰€æœ‰ï¼Œç¦æ­¢ä¸€åˆ‡æœªç»æˆæƒçš„è½¬è½½ã€å‘å¸ƒã€å‡ºå”®ç­‰è¡Œä¸ºï¼Œè¿è€…å°†è¢«è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://www.itbaima.cn/document/35v1hbsfcdgagdnw\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/cloud/%E4%B8%80/","section":"Docs","summary":"å¾®æœåŠ¡åŸºç¡€ #\ræ³¨æ„ï¼š æ­¤é˜¶æ®µå­¦ä¹ æ¨èçš„ç”µè„‘é…ç½®ï¼Œè‡³å°‘é…å¤‡4æ ¸å¿ƒCPUï¼ˆä¸»é¢‘3.0Ghzä»¥ä¸Šï¼‰+16GBå†…å­˜ï¼Œå¦åˆ™å¡åˆ°ä½ æ€€ç–‘äººç”Ÿã€‚\nå‰é¢æˆ‘ä»¬è®²è§£äº†SpringBootæ¡†æ¶ï¼Œé€šè¿‡ä½¿ç”¨SpringBootæ¡†æ¶ï¼Œæˆ‘ä»¬çš„é¡¹ç›®å¼€å‘é€Ÿåº¦å¯ä»¥è¯´æ˜¯å¾—åˆ°äº†è´¨çš„æå‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¯¹äºé¡¹ç›®çš„ç»´æŠ¤å’Œç†è§£ï¼Œä¹Ÿä¼šæ›´åŠ çš„è½»æ¾ã€‚å¯è§ï¼ŒSpringBootä¸ºæˆ‘ä»¬çš„å¼€å‘å¸¦æ¥äº†å·¨å¤§ä¾¿æ·ã€‚è€Œè¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åŸºäºSpringBootï¼Œç»§ç»­æ·±å…¥åˆ°ä¼ä¸šå®é™…åœºæ™¯ï¼Œæ¢è®¨å¾®æœåŠ¡æ¶æ„ä¸‹çš„SpringCloudã€‚è¿™ä¸ªéƒ¨åˆ†æˆ‘ä»¬ä¼šæ›´åŠ æ³¨é‡äºæ¶æ„è®¾è®¡ä¸Šçš„è®²è§£ï¼Œå¼±åŒ–å®ç°åŸç†æ–¹é¢çš„ç ”ç©¶ã€‚\nä¼ ç»Ÿé¡¹ç›®è½¬å‹ #\rè¦è¯´è¿‘å‡ å¹´æœ€ç«çƒ­çš„è¯é¢˜ï¼Œé‚£è¿˜å¾—æ˜¯å¾®æœåŠ¡ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯å¾®æœåŠ¡å‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥å…ˆä»æŠ€æœ¯çš„æ¼”å˜å¼€å§‹çœ‹èµ·ï¼Œåœ¨æˆ‘ä»¬å­¦ä¹ JavaWebä¹‹åï¼Œä¸€èˆ¬çš„ç½‘ç«™å¼€å‘æ¨¡å¼ä¸ºServlet+JSPï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬åœ¨å­¦ä¹ äº†SSMä¹‹åï¼Œä¼šå‘ç°è¿™ç§æ¨¡å¼å·²ç»è¿œè¿œè½åäº†ï¼Œç¬¬ä¸€ï¼Œä¸€ä¸ªå…¬å¸ä¸å¯èƒ½å»æ‹›é‚£ä¹ˆå¤šåŒæ—¶ä¼šå‰ç«¯+åç«¯çš„å¼€å‘äººå‘˜ï¼Œå°±ç®—æ‹›åˆ°ï¼Œä¹Ÿå¹¶ä¸ä¸€å®šèƒ½ä¿è¯ä¸¤ä¸ªæ–¹é¢éƒ½æ¯”è¾ƒæ“…é•¿ï¼Œç›¸æ¯”å‰åç«¯åˆ†å¼€å­¦ä¹ çš„å¼€å‘äººå‘˜ï¼Œæ˜¾ç„¶åè€…çš„å­¦ä¹ æˆæœ¬æ›´ä½ï¼Œä¸“æ³¨åº¦æ›´é«˜ã€‚å› æ­¤å‰åç«¯åˆ†ç¦»æˆä¸ºäº†ä¸€ç§æ–°çš„è¶‹åŠ¿ã€‚é€šè¿‡ä½¿ç”¨SpringBootï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥å¾ˆå¿«é€Ÿåœ°å¼€å‘ä¸€ä¸ªé«˜æ€§èƒ½çš„å•ä½“åº”ç”¨ï¼Œåªéœ€è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œæˆ‘ä»¬æ•´ä¸ªé¡¹ç›®å°±å¼€å§‹è¿è¡Œäº†ï¼Œå„é¡¹åŠŸèƒ½èäºä¸€ä½“ï¼Œå¼€å‘èµ·æ¥ä¹Ÿæ›´åŠ è½»æ¾ã€‚\nä½†æ˜¯éšç€æˆ‘ä»¬é¡¹ç›®çš„ä¸æ–­æ‰©å¤§ï¼Œå•ä½“åº”ç”¨ä¼¼ä¹æ˜¾å¾—æœ‰ç‚¹ä¹åŠ›äº†ã€‚\néšç€è¶Šæ¥è¶Šå¤šçš„åŠŸèƒ½ä¸æ–­åœ°åŠ å…¥åˆ°ä¸€ä¸ªSpringBooté¡¹ç›®ä¸­ï¼Œéšç€æ¥å£ä¸æ–­å¢åŠ ï¼Œæ•´ä¸ªç³»ç»Ÿå°±è¦åœ¨åŒä¸€æ—¶é—´å†…å“åº”æ›´å¤šç±»å‹çš„è¯·æ±‚ï¼Œæ˜¾ç„¶ï¼Œè¿™ç§æ‰©å±•æ–¹å¼æ˜¯ä¸å¯èƒ½æ— é™ä½¿ç”¨ä¸‹å»çš„ï¼Œæ€»æœ‰ä¸€å¤©ï¼Œè¿™ä¸ªSpringBooté¡¹ç›®ä¼šåºå¤§åˆ°è¿è¡Œç¼“æ…¢ã€‚å¹¶ä¸”æ‰€æœ‰çš„åŠŸèƒ½å¦‚æœéƒ½é›†æˆåœ¨å•ç«¯ä¸Šï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šå…¨éƒ¨æ±‡é›†åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¯¹æ­¤æœåŠ¡å™¨é€ æˆå·¨å¤§å‹åŠ›ã€‚\nå¯ä»¥è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„ç”µè„‘å·²ç»å‡çº§åˆ°i9-12900Kï¼Œä½†æ˜¯ä¾ç„¶åœ¨è¿è¡Œé¡¹ç›®çš„æ—¶å€™ç¼“æ…¢ï¼Œæ— æ³•åŒä¸€æ—¶é—´å“åº”æˆåƒä¸Šä¸‡çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜å°±å·²ç»ä¸æ˜¯å•çº¯å‡çº§æœºå™¨é…ç½®å¯ä»¥è§£å†³çš„äº†ã€‚\nä¼ ç»Ÿå•ä½“æ¶æ„åº”ç”¨éšç€é¡¹ç›®è§„æ¨¡çš„æ‰©å¤§ï¼Œå®é™…ä¸Šä¼šæš´éœ²è¶Šæ¥è¶Šå¤šçš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯ä¸€å°æœåŠ¡å™¨æ— æ³•æ‰¿å—åºå¤§çš„å•ä½“åº”ç”¨éƒ¨ç½²ï¼Œå¹¶ä¸”å•ä½“åº”ç”¨çš„ç»´æŠ¤ä¹Ÿä¼šè¶Šæ¥è¶Šå›°éš¾ï¼Œæˆ‘ä»¬å¾—å¯»æ‰¾ä¸€ç§æ–°çš„å¼€å‘æ¶æ„æ¥è§£å†³è¿™äº›é—®é¢˜äº†ã€‚\nIn short, the microservice architectural style is an approach to developing a single application as a suite of small services, each running in its own process and communicating with lightweight mechanisms, often an HTTP resource API.","title":"SpringCloud 1","type":"doc"},{"content":"\rå¾®æœåŠ¡è¿›é˜¶ #\rå‰é¢æˆ‘ä»¬äº†è§£äº†å¾®æœåŠ¡çš„ä¸€å¥—è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®ƒæ˜¯åŸºäºNetflixçš„è§£å†³æ–¹æ¡ˆï¼Œå®é™…ä¸Šæˆ‘ä»¬å‘ç°ï¼Œå¾ˆå¤šæ¡†æ¶éƒ½å·²ç»åœæ­¢ç»´æŠ¤äº†ï¼Œæ¥çœ‹çœ‹ç›®å‰æˆ‘ä»¬æ‰€è®¤è¯†åˆ°çš„SpringCloudå„å¤§ç»„ä»¶çš„ç»´æŠ¤æƒ…å†µï¼š\næ³¨å†Œä¸­å¿ƒï¼š Eurekaï¼ˆå±äºNetflixï¼Œ2.xç‰ˆæœ¬ä¸å†å¼€æºï¼Œ1.xç‰ˆæœ¬ä»åœ¨æ›´æ–°ï¼‰ æœåŠ¡è°ƒç”¨ï¼š Ribbonï¼ˆå±äºNetflixï¼Œåœæ­¢æ›´æ–°ï¼Œå·²ç»å½»åº•è¢«ç§»é™¤ï¼‰ã€SpringCloud Loadbalancerï¼ˆå±äºSpringCloudå®˜æ–¹ï¼Œç›®å‰çš„é»˜è®¤æ–¹æ¡ˆï¼‰ æœåŠ¡é™çº§ï¼š Hystrixï¼ˆå±äºNetflixï¼Œåœæ­¢æ›´æ–°ï¼Œå·²ç»å½»åº•è¢«ç§»é™¤ï¼‰ è·¯ç”±ç½‘å…³ï¼š Zuulï¼ˆå±äºNetflixï¼Œåœæ­¢æ›´æ–°ï¼Œå·²ç»å½»åº•è¢«ç§»é™¤ï¼‰ã€Gatewayï¼ˆå±äºSpringCloudå®˜æ–¹ï¼Œæ¨èæ–¹æ¡ˆï¼‰ é…ç½®ä¸­å¿ƒï¼š Configï¼ˆå±äºSpringCloudå®˜æ–¹ï¼‰ å¯è§ï¼Œæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„æ•´å¥—è§£å†³æ–¹æ¡ˆä¸­ï¼Œè¶…è¿‡åŠæ•°çš„ç»„ä»¶éƒ½å·²ç»å¤„äºä¸å¯ç”¨çŠ¶æ€ï¼Œå¹¶ä¸”éƒ¨åˆ†ç»„ä»¶éƒ½æ˜¯SpringCloudå®˜æ–¹å‡ºæ‰‹æä¾›æ¡†æ¶è¿›è¡Œè§£å†³ï¼Œå› æ­¤ï¼Œå¯»æ‰¾ä¸€å¥—æ›´å¥½çš„è§£å†³æ–¹æ¡ˆåŠ¿åœ¨å¿…è¡Œï¼Œä¹Ÿå°±å¼•å‡ºäº†æˆ‘ä»¬æœ¬ç« çš„ä¸»è§’ï¼šSpringCloud Alibaba\né˜¿é‡Œå·´å·´ä½œä¸ºä¸šç•Œçš„äº’è”ç½‘å¤§å‚ï¼Œç»™å‡ºäº†ä¸€å¥—å…¨æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œå®˜æ–¹ç½‘ç«™ï¼ˆä¸­æ–‡ï¼‰ï¼šhttps://spring-cloud-alibaba-group.github.io/github-pages/2021/zh-cn/index.html\nSpring Cloud Alibaba è‡´åŠ›äºæä¾›å¾®æœåŠ¡å¼€å‘çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚æ­¤é¡¹ç›®åŒ…å«å¼€å‘åˆ†å¸ƒå¼åº”ç”¨æœåŠ¡çš„å¿…éœ€ç»„ä»¶ï¼Œæ–¹ä¾¿å¼€å‘è€…é€šè¿‡ Spring Cloud ç¼–ç¨‹æ¨¡å‹è½»æ¾ä½¿ç”¨è¿™äº›ç»„ä»¶æ¥å¼€å‘åˆ†å¸ƒå¼åº”ç”¨æœåŠ¡ã€‚\nä¾æ‰˜ Spring Cloud Alibabaï¼Œæ‚¨åªéœ€è¦æ·»åŠ ä¸€äº›æ³¨è§£å’Œå°‘é‡é…ç½®ï¼Œå°±å¯ä»¥å°† Spring Cloud åº”ç”¨æ¥å…¥é˜¿é‡Œåˆ†å¸ƒå¼åº”ç”¨è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡é˜¿é‡Œä¸­é—´ä»¶æ¥è¿…é€Ÿæ­å»ºåˆ†å¸ƒå¼åº”ç”¨ç³»ç»Ÿã€‚\nç›®å‰ Spring Cloud Alibaba æä¾›äº†å¦‚ä¸‹åŠŸèƒ½:\næœåŠ¡é™æµé™çº§ï¼šæ”¯æŒ WebServletã€WebFlux, OpenFeignã€RestTemplateã€Dubbo é™æµé™çº§åŠŸèƒ½çš„æ¥å…¥ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡æ§åˆ¶å°å®æ—¶ä¿®æ”¹é™æµé™çº§è§„åˆ™ï¼Œè¿˜æ”¯æŒæŸ¥çœ‹é™æµé™çº§ Metrics ç›‘æ§ã€‚ æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼šé€‚é… Spring Cloud æœåŠ¡æ³¨å†Œä¸å‘ç°æ ‡å‡†ï¼Œé»˜è®¤é›†æˆäº† Ribbon çš„æ”¯æŒã€‚ åˆ†å¸ƒå¼é…ç½®ç®¡ç†ï¼šæ”¯æŒåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤–éƒ¨åŒ–é…ç½®ï¼Œé…ç½®æ›´æ”¹æ—¶è‡ªåŠ¨åˆ·æ–°ã€‚ RpcæœåŠ¡ï¼šæ‰©å±• Spring Cloud å®¢æˆ·ç«¯ RestTemplate å’Œ OpenFeignï¼Œæ”¯æŒè°ƒç”¨ Dubbo RPC æœåŠ¡ æ¶ˆæ¯é©±åŠ¨èƒ½åŠ›ï¼šåŸºäº Spring Cloud Stream ä¸ºå¾®æœåŠ¡åº”ç”¨æ„å»ºæ¶ˆæ¯é©±åŠ¨èƒ½åŠ›ã€‚ åˆ†å¸ƒå¼äº‹åŠ¡ï¼šä½¿ç”¨ @GlobalTransactional æ³¨è§£ï¼Œ é«˜æ•ˆå¹¶ä¸”å¯¹ä¸šåŠ¡é›¶ä¾µå…¥åœ°è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚ é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ï¼šé˜¿é‡Œäº‘æä¾›çš„æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ã€‚æ”¯æŒåœ¨ä»»ä½•åº”ç”¨ã€ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹å­˜å‚¨å’Œè®¿é—®ä»»æ„ç±»å‹çš„æ•°æ®ã€‚ åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ï¼šæä¾›ç§’çº§ã€ç²¾å‡†ã€é«˜å¯é ã€é«˜å¯ç”¨çš„å®šæ—¶ï¼ˆåŸºäº Cron è¡¨è¾¾å¼ï¼‰ä»»åŠ¡è°ƒåº¦æœåŠ¡ã€‚åŒæ—¶æä¾›åˆ†å¸ƒå¼çš„ä»»åŠ¡æ‰§è¡Œæ¨¡å‹ï¼Œå¦‚ç½‘æ ¼ä»»åŠ¡ã€‚ç½‘æ ¼ä»»åŠ¡æ”¯æŒæµ·é‡å­ä»»åŠ¡å‡åŒ€åˆ†é…åˆ°æ‰€æœ‰ Workerï¼ˆschedulerx-clientï¼‰ä¸Šæ‰§è¡Œã€‚ é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ï¼šè¦†ç›–å…¨çƒçš„çŸ­ä¿¡æœåŠ¡ï¼Œå‹å¥½ã€é«˜æ•ˆã€æ™ºèƒ½çš„äº’è”åŒ–é€šè®¯èƒ½åŠ›ï¼Œå¸®åŠ©ä¼ä¸šè¿…é€Ÿæ­å»ºå®¢æˆ·è§¦è¾¾é€šé“ã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒSpringCloudAlibabaå®é™…ä¸Šæ˜¯å¯¹æˆ‘ä»¬çš„SpringCloudç»„ä»¶å¢å¼ºåŠŸèƒ½ï¼Œæ˜¯SpringCloudçš„å¢å¼ºæ¡†æ¶ï¼Œå¯ä»¥å…¼å®¹SpringCloudåŸç”Ÿç»„ä»¶å’ŒSpringCloudAlibabaçš„ç»„ä»¶ã€‚\nå¼€å§‹å­¦ä¹ ä¹‹å‰ï¼ŒæŠŠæˆ‘ä»¬ä¹‹å‰æ‰“åŒ…å¥½çš„æ‹†åˆ†é¡¹ç›®è§£å‹ï¼Œæˆ‘ä»¬å°†åŸºäºå®ƒè¿›è¡Œè®²è§£ã€‚\nNacos æ›´åŠ å…¨èƒ½çš„æ³¨å†Œä¸­å¿ƒ #\rNacosï¼ˆNaming Configuration Serviceï¼‰æ˜¯ä¸€æ¬¾é˜¿é‡Œå·´å·´å¼€æºçš„æœåŠ¡æ³¨å†Œä¸å‘ç°ã€é…ç½®ç®¡ç†çš„ç»„ä»¶ï¼Œç›¸å½“äºæ˜¯Eureka+Configçš„ç»„åˆå½¢æ€ã€‚\nå®‰è£…ä¸éƒ¨ç½² #\rNacosæœåŠ¡å™¨æ˜¯ç‹¬ç«‹å®‰è£…éƒ¨ç½²çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸‹è½½æœ€æ–°çš„NacosæœåŠ¡ç«¯ç¨‹åºï¼Œä¸‹è½½åœ°å€ï¼šhttps://github.com/alibaba/nacosï¼Œè¿ä¸ä¸Šå¯ä»¥åˆ°è§†é¢‘ä¸‹æ–¹äº‘ç›˜ä¸­ä¸‹è½½ã€‚\nå¯ä»¥çœ‹åˆ°ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯1.4.3ç‰ˆæœ¬ï¼ˆ2022å¹´2æœˆ27æ—¥å‘å¸ƒçš„ï¼‰ï¼Œæˆ‘ä»¬ç›´æ¥ä¸‹è½½zipæ–‡ä»¶å³å¯ã€‚\næ¥ç€æˆ‘ä»¬å°†æ–‡ä»¶è¿›è¡Œè§£å‹ï¼Œå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š\næˆ‘ä»¬ç›´æ¥å°†å…¶æ‹–å…¥åˆ°é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹ï¼Œä¾¿äºæˆ‘ä»¬ä¸€ä¼šåœ¨IDEAå†…éƒ¨å¯åŠ¨ï¼Œæ¥ç€æ·»åŠ è¿è¡Œé…ç½®ï¼š\nå…¶ä¸­-m standaloneè¡¨ç¤ºå•èŠ‚ç‚¹æ¨¡å¼ï¼ŒMacå’ŒLinuxä¸‹è®°å¾—å°†è§£é‡Šå™¨è®¾å®šä¸º/bin/bashï¼Œç”±äºNacosåœ¨Mac/Linuxé»˜è®¤æ˜¯åå°å¯åŠ¨æ¨¡å¼ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å®ƒçš„bashæ–‡ä»¶ï¼Œè®©å®ƒå˜æˆå‰å°å¯åŠ¨ï¼Œè¿™æ ·IDEAå…³é—­äº†Nacoså°±è‡ªåŠ¨å…³é—­äº†ï¼Œå¦åˆ™å¼€å‘ç¯å¢ƒä¸‹å¾ˆå®¹æ˜“å¿˜è®°å…³ï¼š\n# æ³¨é‡Šæ‰ nohup $JAVA ${JAVA_OPT} nacos.nacos \u0026gt;\u0026gt; ${BASE_DIR}/logs/start.out 2\u0026gt;\u0026amp;1 \u0026amp; # æ›¿æ¢æˆä¸‹é¢çš„ $JAVA ${JAVA_OPT} nacos.nacos æ¥ç€æˆ‘ä»¬ç‚¹å‡»å¯åŠ¨ï¼š\nOKï¼Œå¯åŠ¨æˆåŠŸï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„ç®¡ç†é¡µé¢åœ°å€ä¹Ÿæ˜¯ç»™æˆ‘ä»¬è´´å‡ºæ¥äº†ï¼š http://localhost:8848/nacos/index.htmlï¼Œè®¿é—®è¿™ä¸ªåœ°å€ï¼š\né»˜è®¤çš„ç”¨æˆ·åå’Œç®¡ç†å‘˜å¯†ç éƒ½æ˜¯nacosï¼Œç›´æ¥ç™»é™†å³å¯ï¼Œå¯ä»¥çœ‹åˆ°è¿›å…¥ç®¡ç†é¡µé¢ä¹‹ååŠŸèƒ½ä¹Ÿæ˜¯ç›¸å½“ä¸°å¯Œï¼š\nè‡³æ­¤ï¼ŒNacosçš„å®‰è£…ä¸éƒ¨ç½²å®Œæˆã€‚\næœåŠ¡æ³¨å†Œä¸å‘ç° #\rç°åœ¨æˆ‘ä»¬è¦å®ç°åŸºäºNacosçš„æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¼å…¥SpringCloudAlibabaç›¸å…³çš„ä¾èµ–ï¼Œæˆ‘ä»¬åœ¨çˆ¶å·¥ç¨‹å°†ä¾èµ–è¿›è¡Œç®¡ç†ï¼š\n\u0026lt;dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- è¿™é‡Œå¼•å…¥æœ€æ–°çš„SpringCloudä¾èµ– --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2021.0.1\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- è¿™é‡Œå¼•å…¥æœ€æ–°çš„SpringCloudAlibabaä¾èµ–ï¼Œ2021.0.1.0ç‰ˆæœ¬æ”¯æŒSpringBoot2.6.X --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-alibaba-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2021.0.1.0\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;/dependencyManagement\u0026gt; æ¥ç€æˆ‘ä»¬å°±å¯ä»¥åœ¨å­é¡¹ç›®ä¸­æ·»åŠ æœåŠ¡å‘ç°ä¾èµ–äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬ä»¥å›¾ä¹¦æœåŠ¡ä¸ºä¾‹ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-nacos-discovery\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; å’Œæ³¨å†Œåˆ°Eurekaä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®Nacosæ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼š\nserver: # ä¹‹åæ‰€æœ‰çš„å›¾ä¹¦æœåŠ¡èŠ‚ç‚¹å°±81XXç«¯å£ port: 8101 spring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://cloudstudy.mysql.cn-chengdu.rds.aliyuncs.com:3306/cloudstudy username: test password: 123456 # åº”ç”¨åç§° bookservice application: name: bookservice cloud: nacos: discovery: # é…ç½®Nacosæ³¨å†Œä¸­å¿ƒåœ°å€ server-addr: localhost:8848 æ¥ç€å¯åŠ¨æˆ‘ä»¬çš„å›¾ä¹¦æœåŠ¡ï¼Œå¯ä»¥åœ¨Nacosçš„æœåŠ¡åˆ—è¡¨ä¸­æ‰¾åˆ°ï¼š\næŒ‰ç…§åŒæ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥ç€å°†å¦å¤–ä¸¤ä¸ªæœåŠ¡ä¹Ÿæ³¨å†Œåˆ°Nacosä¸­ï¼š\næ¥ç€æˆ‘ä»¬ä½¿ç”¨OpenFeignï¼Œå®ç°æœåŠ¡å‘ç°è¿œç¨‹è°ƒç”¨ä»¥åŠè´Ÿè½½å‡è¡¡ï¼Œå¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-openfeign\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- è¿™é‡Œéœ€è¦å•ç‹¬å¯¼å…¥LoadBalancerä¾èµ– --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-loadbalancer\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ç¼–å†™æ¥å£ï¼š\n@FeignClient(\u0026#34;userservice\u0026#34;) public interface UserClient { @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) User getUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid); } @FeignClient(\u0026#34;bookservice\u0026#34;) public interface BookClient { @RequestMapping(\u0026#34;/book/{bid}\u0026#34;) Book getBookById(@PathVariable(\u0026#34;bid\u0026#34;) int bid); } @Service public class BorrowServiceImpl implements BorrowService{ @Resource BorrowMapper mapper; @Resource UserClient userClient; @Resource BookClient bookClient; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); User user = userClient.getUserById(uid); List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; bookClient.getBookById(b.getBid())) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } } @EnableFeignClients @SpringBootApplication public class BorrowApplication { public static void main(String[] args) { SpringApplication.run(BorrowApplication.class, args); } } æ¥ç€æˆ‘ä»¬è¿›è¡Œæµ‹è¯•ï¼š\næµ‹è¯•æ­£å¸¸ï¼Œå¯ä»¥è‡ªåŠ¨å‘ç°æœåŠ¡ï¼Œæ¥ç€æˆ‘ä»¬æ¥å¤šé…ç½®å‡ ä¸ªå®ä¾‹ï¼Œå»æ‰å›¾ä¹¦æœåŠ¡å’Œç”¨æˆ·æœåŠ¡çš„ç«¯å£é…ç½®ï¼š\nç„¶åæˆ‘ä»¬åœ¨å›¾ä¹¦æœåŠ¡å’Œç”¨æˆ·æœåŠ¡ä¸­æ·»åŠ ä¸€å¥æ‰“å°æ–¹ä¾¿ä¹‹åæŸ¥çœ‹ï¼š\n@RequestMapping(\u0026#34;/user/{uid}\u0026#34;) public User findUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ System.out.println(\u0026#34;è°ƒç”¨ç”¨æˆ·æœåŠ¡\u0026#34;); return service.getUserById(uid); } ç°åœ¨å°†å…¨éƒ¨æœåŠ¡å¯åŠ¨ï¼š å¯ä»¥çœ‹åˆ°Nacosä¸­çš„å®ä¾‹æ•°é‡å·²ç»æ˜¾ç¤ºä¸º2ï¼š\næ¥ç€æˆ‘ä»¬è°ƒç”¨å€Ÿé˜…æœåŠ¡ï¼Œçœ‹çœ‹èƒ½å¦è´Ÿè½½å‡è¡¡è¿œç¨‹è°ƒç”¨ï¼š\nOKï¼Œè´Ÿè½½å‡è¡¡è¿œç¨‹è°ƒç”¨æ²¡æœ‰é—®é¢˜ï¼Œè¿™æ ·æˆ‘ä»¬å°±å®ç°äº†åŸºäºNacosçš„æœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼Œå®é™…ä¸Šå¤§è‡´æµç¨‹ä¸Eurekaä¸€è‡´ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒNacosåŒºåˆ†äº†ä¸´æ—¶å®ä¾‹å’Œéä¸´æ—¶å®ä¾‹ï¼š\né‚£ä¹ˆä¸´æ—¶å’Œéä¸´æ—¶æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\nä¸´æ—¶å®ä¾‹ï¼šå’ŒEurekaä¸€æ ·ï¼Œé‡‡ç”¨å¿ƒè·³æœºåˆ¶å‘Nacoså‘é€è¯·æ±‚ä¿æŒåœ¨çº¿çŠ¶æ€ï¼Œä¸€æ—¦å¿ƒè·³åœæ­¢ï¼Œä»£è¡¨å®ä¾‹ä¸‹çº¿ï¼Œä¸ä¿ç•™å®ä¾‹ä¿¡æ¯ã€‚ éä¸´æ—¶å®ä¾‹ï¼šç”±Nacosä¸»åŠ¨è¿›è¡Œè”ç³»ï¼Œå¦‚æœè¿æ¥å¤±è´¥ï¼Œé‚£ä¹ˆä¸ä¼šç§»é™¤å®ä¾‹ä¿¡æ¯ï¼Œè€Œæ˜¯å°†å¥åº·çŠ¶æ€è®¾å®šä¸ºfalseï¼Œç›¸å½“äºä¼šå¯¹æŸä¸ªå®ä¾‹çŠ¶æ€æŒç»­åœ°è¿›è¡Œç›‘æ§ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ä¸´æ—¶å®ä¾‹ï¼š\nspring: application: name: borrowservice cloud: nacos: discovery: server-addr: localhost:8848 # å°†ephemeralä¿®æ”¹ä¸ºfalseï¼Œè¡¨ç¤ºéä¸´æ—¶å®ä¾‹ ephemeral: false æ¥ç€æˆ‘ä»¬åœ¨Nacosä¸­æŸ¥çœ‹ï¼Œå¯ä»¥å‘ç°å®ä¾‹å·²ç»ä¸æ˜¯ä¸´æ—¶çš„äº†ï¼š\nå¦‚æœè¿™æ—¶æˆ‘ä»¬å…³é—­æ­¤å®ä¾‹ï¼Œé‚£ä¹ˆä¼šå˜æˆè¿™æ ·ï¼š\nåªæ˜¯å°†å¥åº·çŠ¶æ€å˜ä¸ºfalseï¼Œè€Œä¸ä¼šåˆ é™¤å®ä¾‹çš„ä¿¡æ¯ã€‚\né›†ç¾¤åˆ†åŒº #\rå®é™…ä¸Šé›†ç¾¤åˆ†åŒºæ¦‚å¿µåœ¨ä¹‹å‰çš„Eurekaä¸­ä¹Ÿæœ‰å‡ºç°ï¼Œæ¯”å¦‚ï¼š\neureka: client: fetch-registry: false register-with-eureka: false service-url: defaultZone: http://localhost:8888/eureka # è¿™ä¸ªdefaultZoneæ˜¯ä¸ªå•¥ç©æ„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªåç§°ï¼Ÿä¸ºä»€ä¹ˆè¦è¦ç”¨è¿™æ ·çš„å½¢å¼æ¥å£°æ˜æ³¨å†Œä¸­å¿ƒï¼Ÿ åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼åº”ç”¨ä¸­ï¼Œç›¸åŒæœåŠ¡çš„å®ä¾‹å¯èƒ½ä¼šåœ¨ä¸åŒçš„æœºå™¨ã€ä½ç½®ä¸Šå¯åŠ¨ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç”¨æˆ·ç®¡ç†æœåŠ¡ï¼Œå¯èƒ½åœ¨æˆéƒ½æœ‰1å°æœåŠ¡å™¨éƒ¨ç½²ã€é‡åº†æœ‰ä¸€å°æœåŠ¡å™¨éƒ¨ç½²ï¼Œè€Œè¿™æ—¶ï¼Œæˆ‘ä»¬åœ¨æˆéƒ½çš„æœåŠ¡å™¨ä¸Šå¯åŠ¨äº†å€Ÿé˜…æœåŠ¡ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬çš„å€Ÿé˜…æœåŠ¡ç°åœ¨è¦è°ƒç”¨ç”¨æˆ·æœåŠ¡ï¼Œå°±åº”è¯¥ä¼˜å…ˆé€‰æ‹©åŒä¸€ä¸ªåŒºåŸŸçš„ç”¨æˆ·æœåŠ¡è¿›è¡Œè°ƒç”¨ï¼Œè¿™æ ·ä¼šä½¿å¾—å“åº”é€Ÿåº¦æ›´å¿«ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹éƒ¨ç½²åœ¨ä¸åŒæœºæˆ¿çš„æœåŠ¡è¿›è¡Œåˆ†åŒºï¼Œå¯ä»¥çœ‹åˆ°å®ä¾‹çš„åˆ†åŒºæ˜¯é»˜è®¤ï¼š\næˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼š\nspring: application: name: borrowservice cloud: nacos: discovery: server-addr: localhost:8848 # ä¿®æ”¹ä¸ºé‡åº†åœ°åŒºçš„é›†ç¾¤ cluster-name: Chongqing å½“ç„¶ç”±äºæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸åŒçš„å¯åŠ¨é…ç½®ï¼Œç›´æ¥åœ¨å¯åŠ¨é…ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡spring.cloud.nacos.discovery.cluster-nameä¹Ÿè¡Œï¼Œè¿™é‡Œæˆ‘ä»¬å°†ç”¨æˆ·æœåŠ¡å’Œå›¾ä¹¦æœåŠ¡ä¸¤ä¸ªåŒºåŸŸéƒ½åˆ†é…ä¸€ä¸ªï¼Œå€Ÿé˜…æœåŠ¡å°±é…ç½®ä¸ºæˆéƒ½åœ°åŒºï¼š\nä¿®æ”¹å®Œæˆä¹‹åï¼Œæˆ‘ä»¬æ¥å°è¯•é‡æ–°å¯åŠ¨ä¸€ä¸‹ï¼ˆNacosä¹Ÿè¦é‡å¯ï¼‰ï¼Œè§‚å¯ŸNacosä¸­é›†ç¾¤åˆ†å¸ƒæƒ…å†µï¼š\nå¯ä»¥çœ‹åˆ°ç°åœ¨æœ‰ä¸¤ä¸ªé›†ç¾¤ï¼Œå¹¶ä¸”éƒ½æœ‰ä¸€ä¸ªå®ä¾‹æ­£åœ¨è¿è¡Œã€‚æˆ‘ä»¬æ¥ç€å»è°ƒç”¨å€Ÿé˜…æœåŠ¡ï¼Œä½†æ˜¯å‘ç°å¹¶æ²¡æœ‰æŒ‰ç…§åŒºåŸŸè¿›è¡Œä¼˜å…ˆè°ƒç”¨ï¼Œè€Œä¾ç„¶ä½¿ç”¨çš„æ˜¯è½®è¯¢æ¨¡å¼çš„è´Ÿè½½å‡è¡¡è°ƒç”¨ã€‚\næˆ‘ä»¬å¿…é¡»è¦æä¾›Nacosçš„è´Ÿè½½å‡è¡¡å®ç°æ‰èƒ½å¼€å¯åŒºåŸŸä¼˜å…ˆè°ƒç”¨æœºåˆ¶ï¼Œåªéœ€è¦åœ¨é…åˆ¶æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹å³å¯ï¼š\nspring: application: name: borrowservice cloud: nacos: discovery: server-addr: localhost:8848 cluster-name: Chengdu # å°†loadbalancerçš„nacosæ”¯æŒå¼€å¯ï¼Œé›†æˆNacosè´Ÿè½½å‡è¡¡ loadbalancer: nacos: enabled: true ç°åœ¨æˆ‘ä»¬é‡å¯å€Ÿé˜…æœåŠ¡ï¼Œä¼šå‘ç°ä¼˜å…ˆè°ƒç”¨çš„æ˜¯åŒåŒºåŸŸçš„ç”¨æˆ·å’Œå›¾ä¹¦æœåŠ¡ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å°†æˆéƒ½åœ°åŒºçš„æœåŠ¡ä¸‹çº¿ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸‹çº¿ä¹‹åï¼Œç”±äºæœ¬åŒºåŸŸå†…æ²¡æœ‰å¯ç”¨æœåŠ¡äº†ï¼Œå€Ÿé˜…æœåŠ¡å°†ä¼šè°ƒç”¨é‡åº†åŒºåŸŸçš„ç”¨æˆ·æœåŠ¡ã€‚\né™¤äº†æ ¹æ®åŒºåŸŸä¼˜å…ˆè°ƒç”¨ä¹‹å¤–ï¼ŒåŒä¸€ä¸ªåŒºåŸŸå†…çš„å®ä¾‹ä¹Ÿå¯ä»¥å•ç‹¬è®¾ç½®æƒé‡ï¼ŒNacosä¼šä¼˜å…ˆé€‰æ‹©æƒé‡æ›´å¤§çš„å®ä¾‹è¿›è¡Œè°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ç®¡ç†é¡µé¢ä¸­è¿›è¡Œé…ç½®ï¼š\næˆ–æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼š\nspring: application: name: borrowservice cloud: nacos: discovery: server-addr: localhost:8848 cluster-name: Chengdu # æƒé‡å¤§å°ï¼Œè¶Šå¤§è¶Šä¼˜å…ˆè°ƒç”¨ï¼Œé»˜è®¤ä¸º1 weight: 0.5 é€šè¿‡é…ç½®æƒé‡ï¼ŒæŸäº›æ€§èƒ½ä¸å¤ªå¥½çš„æœºå™¨å°±èƒ½å¤Ÿæ›´å°‘åœ°è¢«ä½¿ç”¨ï¼Œè€Œæ›´å¤šçš„ä½¿ç”¨é‚£äº›ç½‘ç»œè‰¯å¥½æ€§èƒ½æ›´é«˜çš„ä¸»æœºä¸Šçš„å®ä¾‹ã€‚\né…ç½®ä¸­å¿ƒ #\rå‰é¢æˆ‘ä»¬å­¦ä¹ äº†SpringCloud Configï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æœåŠ¡æ¥åŠ è½½è¿œç¨‹é…ç½®ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨è¿œç«¯é›†ä¸­ç®¡ç†é…ç½®æ–‡ä»¶ã€‚\nå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥åœ¨bootstrap.ymlä¸­é…ç½®è¿œç¨‹é…ç½®æ–‡ä»¶è·å–ï¼Œç„¶åå†è¿›å…¥åˆ°é…ç½®æ–‡ä»¶åŠ è½½ç¯èŠ‚ï¼Œè€ŒNacosä¹Ÿæ”¯æŒè¿™æ ·çš„æ“ä½œï¼Œä½¿ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒç±»ä¼¼ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨æƒ³è¦å°†å€Ÿé˜…æœåŠ¡çš„é…ç½®æ–‡ä»¶æ”¾åˆ°Nacosè¿›è¡Œç®¡ç†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦åœ¨Nacosä¸­åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š\nå°†å€Ÿé˜…æœåŠ¡çš„é…ç½®æ–‡ä»¶å…¨éƒ¨ï¼ˆå½“ç„¶æ­£å¸¸æƒ…å†µä¸‹æ˜¯ä¸ä¼šå…¨éƒ¨CVçš„ï¼Œåªä¼šå¤åˆ¶é‚£äº›éœ€è¦ç»å¸¸ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œè¿™é‡Œä¸ºäº†çœäº‹å°±ç›´æ¥å…¨éƒ¨CVäº†ï¼‰å¤åˆ¶è¿‡æ¥ï¼Œæ³¨æ„Data IDçš„æ ¼å¼è·Ÿæˆ‘ä»¬ä¹‹å‰ä¸€æ ·ï¼Œåº”ç”¨åç§°-ç¯å¢ƒ.ymlï¼Œå¦‚æœåªç¼–å†™åº”ç”¨åç§°ï¼Œé‚£ä¹ˆä»£è¡¨æ­¤é…ç½®æ–‡ä»¶æ— è®ºåœ¨ä»€ä¹ˆç¯å¢ƒä¸‹éƒ½ä¼šä½¿ç”¨ï¼Œç„¶åæ¯ä¸ªé…ç½®æ–‡ä»¶éƒ½å¯ä»¥è¿›è¡Œåˆ†ç»„ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§åˆ†ç±»æ–¹å¼ï¼š\nå®Œæˆä¹‹åç‚¹å‡»å‘å¸ƒå³å¯ï¼š\nç„¶ååœ¨é¡¹ç›®ä¸­å¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-bootstrap\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-nacos-config\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€æˆ‘ä»¬åœ¨å€Ÿé˜…æœåŠ¡ä¸­æ·»åŠ bootstrap.ymlæ–‡ä»¶ï¼š\nspring: application: # æœåŠ¡åç§°å’Œé…ç½®æ–‡ä»¶ä¿æŒä¸€è‡´ name: borrowservice profiles: # ç¯å¢ƒä¹Ÿæ˜¯å’Œé…ç½®æ–‡ä»¶ä¿æŒä¸€è‡´ active: dev cloud: nacos: config: # é…ç½®æ–‡ä»¶åç¼€å file-extension: yml # é…ç½®ä¸­å¿ƒæœåŠ¡å™¨åœ°å€ï¼Œä¹Ÿå°±æ˜¯Nacosåœ°å€ server-addr: localhost:8848 ç°åœ¨æˆ‘ä»¬å¯åŠ¨æœåŠ¡è¯•è¯•çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°æˆåŠŸè¯»å–é…ç½®æ–‡ä»¶å¹¶å¯åŠ¨äº†ï¼Œå®é™…ä¸Šä½¿ç”¨ä¸Šæ¥è¯´è·Ÿä¹‹å‰çš„Configæ˜¯åŸºæœ¬ä¸€è‡´çš„ã€‚\nNacosè¿˜æ”¯æŒé…ç½®æ–‡ä»¶çš„çƒ­æ›´æ–°ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ äº†ä¸€ä¸ªå±æ€§ï¼Œè€Œè¿™ä¸ªæ—¶å€™å¯èƒ½éœ€è¦å®æ—¶ä¿®æ”¹ï¼Œå¹¶åœ¨åç«¯å®æ—¶æ›´æ–°ï¼Œé‚£ä¹ˆè¿™ç§è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„Controllerï¼š\n@RestController public class TestController { @Value(\u0026#34;${test.txt}\u0026#34;) //æˆ‘ä»¬ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–test.txtçš„å­—ç¬¦ä¸²å€¼ï¼Œä½œä¸ºtestæ¥å£çš„è¿”å›å€¼ String txt; @RequestMapping(\u0026#34;/test\u0026#34;) public String test(){ return txt; } } æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡å¯æœåŠ¡å™¨ï¼š\nå¯ä»¥çœ‹åˆ°å·²ç»å¯ä»¥æ­£å¸¸è¯»å–äº†ï¼š\nç°åœ¨æˆ‘ä»¬å°†é…ç½®æ–‡ä»¶çš„å€¼è¿›è¡Œä¿®æ”¹ï¼š\nå†æ¬¡è®¿é—®æ¥å£ï¼Œä¼šå‘ç°æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼š\nä½†æ˜¯åå°æ˜¯æˆåŠŸæ£€æµ‹åˆ°å€¼æ›´æ–°äº†ï¼Œä½†æ˜¯å€¼å´æ²¡æ”¹å˜ï¼š\né‚£ä¹ˆå¦‚ä½•æ‰èƒ½å®ç°é…ç½®çƒ­æ›´æ–°å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼š\n@RestController @RefreshScope //æ·»åŠ æ­¤æ³¨è§£å°±èƒ½å®ç°è‡ªåŠ¨åˆ·æ–°äº† public class TestController { @Value(\u0026#34;${test.txt}\u0026#34;) String txt; @RequestMapping(\u0026#34;/test\u0026#34;) public String test(){ return txt; } } é‡å¯æœåŠ¡å™¨ï¼Œå†æ¬¡é‡å¤ä¸Šè¿°å®éªŒï¼ŒæˆåŠŸã€‚\nå‘½åç©ºé—´ #\ræˆ‘ä»¬è¿˜å¯ä»¥å°†é…ç½®æ–‡ä»¶æˆ–æ˜¯æœåŠ¡å®ä¾‹åˆ’åˆ†åˆ°ä¸åŒçš„å‘½åç©ºé—´ä¸­ï¼Œå…¶å®å°±æ˜¯åŒºåˆ†å¼€å‘ã€ç”Ÿäº§ç¯å¢ƒæˆ–æ˜¯å¼•ç”¨å½’å±ä¹‹ç±»çš„ï¼š\nè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å‘½åç©ºé—´ï¼š\nå¯ä»¥çœ‹åˆ°åœ¨devå‘½åç©ºé—´ä¸‹ï¼Œæ²¡æœ‰ä»»ä½•é…ç½®æ–‡ä»¶å’ŒæœåŠ¡ï¼š\næˆ‘ä»¬åœ¨ä¸åŒçš„å‘½åç©ºé—´ä¸‹ï¼Œå®ä¾‹å’Œé…ç½®éƒ½æ˜¯ç›¸äº’ä¹‹é—´éš”ç¦»çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå½“å‰çš„å‘½åç©ºé—´ã€‚\nå®ç°é«˜å¯ç”¨ #\rç”±äºNacosæš‚ä¸æ”¯æŒArmæ¶æ„èŠ¯ç‰‡çš„Macé›†ç¾¤æ­å»ºï¼Œæœ¬å°èŠ‚ç”¨Linxuäº‘ä¸»æœºï¼ˆNacosæ¯”è¾ƒåƒå†…å­˜ï¼Œ2ä¸ªNacosæœåŠ¡å™¨é›†ç¾¤ï¼Œè‡³å°‘2Gå†…å­˜ï¼‰ç¯å¢ƒæ¼”ç¤ºã€‚\né€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨Nacosä»¥åŠNacosçš„åŠŸèƒ½ç­‰ï¼Œæœ€åæˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œå¦‚æœåƒä¹‹å‰Eurekaä¸€æ ·ï¼Œæ­å»ºNacosé›†ç¾¤ï¼Œå®ç°é«˜å¯ç”¨ã€‚\nå®˜æ–¹æ–¹æ¡ˆï¼šhttps://nacos.io/zh-cn/docs/cluster-mode-quick-start.html\nhttp://ip1:port/openAPI ç›´è¿ipæ¨¡å¼ï¼Œæœºå™¨æŒ‚åˆ™éœ€è¦ä¿®æ”¹ipæ‰å¯ä»¥ä½¿ç”¨ã€‚\nhttp://SLB:port/openAPI æŒ‚è½½SLBæ¨¡å¼(å†…ç½‘SLBï¼Œä¸å¯æš´éœ²åˆ°å…¬ç½‘ï¼Œä»¥å…å¸¦æ¥å®‰å…¨é£é™©)ï¼Œç›´è¿SLBå³å¯ï¼Œä¸‹é¢æŒ‚serverçœŸå®ipï¼Œå¯è¯»æ€§ä¸å¥½ã€‚\nhttp://nacos.com:port/openAPI åŸŸå + SLBæ¨¡å¼(å†…ç½‘SLBï¼Œä¸å¯æš´éœ²åˆ°å…¬ç½‘ï¼Œä»¥å…å¸¦æ¥å®‰å…¨é£é™©)ï¼Œå¯è¯»æ€§å¥½ï¼Œè€Œä¸”æ¢ipæ–¹ä¾¿ï¼Œæ¨èæ¨¡å¼\næˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„æ¶æ„è®¾è®¡ï¼Œå®ƒæ¨èæˆ‘ä»¬åœ¨æ‰€æœ‰çš„NacosæœåŠ¡ç«¯ä¹‹å‰å»ºç«‹ä¸€ä¸ªè´Ÿè½½å‡è¡¡ï¼Œæˆ‘ä»¬é€šè¿‡è®¿é—®è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ¥é—´æ¥è®¿é—®åˆ°å„ä¸ªNacosæœåŠ¡å™¨ã€‚å®é™…ä¸Šå°±ï¼Œæ˜¯æ¯”å¦‚æœ‰ä¸‰ä¸ªNacosæœåŠ¡å™¨åšé›†ç¾¤ï¼Œä½†æ˜¯æ¯ä¸ªæœåŠ¡ä¸å¯èƒ½æŠŠæ¯ä¸ªNacoséƒ½å»è®¿é—®ä¸€æ¬¡è¿›è¡Œæ³¨å†Œï¼Œå®é™…ä¸Šåªéœ€è¦åœ¨ä»»æ„ä¸€å°NacosæœåŠ¡å™¨ä¸Šæ³¨å†Œå³å¯ï¼ŒNacosæœåŠ¡å™¨ä¹‹é—´ä¼šè‡ªåŠ¨åŒæ­¥ä¿¡æ¯ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬éšä¾¿æŒ‡å®šä¸€å°NacosæœåŠ¡å™¨è¿›è¡Œæ³¨å†Œï¼Œå¦‚æœè¿™å°NacosæœåŠ¡å™¨æŒ‚äº†ï¼Œä½†æ˜¯å…¶ä»–NacosæœåŠ¡å™¨æ²¡æŒ‚ï¼Œè¿™æ ·å°±æ²¡åŠæ³•å®Œæˆæ³¨å†Œäº†ï¼Œä½†æ˜¯å®é™…ä¸Šæ•´ä¸ªé›†ç¾¤è¿˜æ˜¯å¯ç”¨çš„çŠ¶æ€ã€‚\næ‰€ä»¥è¿™é‡Œå°±éœ€è¦åœ¨æ‰€æœ‰NacosæœåŠ¡å™¨ä¹‹å‰æ­å»ºä¸€ä¸ªSLBï¼ˆæœåŠ¡å™¨è´Ÿè½½å‡è¡¡ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¸Šé¢çš„é—®é¢˜äº†ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœè¦å®ç°å¤–ç•Œå¯¹æœåŠ¡è®¿é—®çš„è´Ÿè½½å‡è¡¡ï¼Œæˆ‘ä»¬å°±å¾—ç”¨æ¯”å¦‚ä¹‹å‰è¯´åˆ°çš„Gatewayæ¥å®ç°ï¼Œè€Œè¿™é‡Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ›´åŠ æ–¹ä¾¿çš„å·¥å…·ï¼šNginxï¼Œæ¥å®ç°ï¼ˆä¹‹å‰æˆ‘ä»¬æ²¡è®²è¿‡ï¼Œä½†æ˜¯ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œæ”¾å¿ƒåé¢ä¼šå¸¦ç€å¤§å®¶ä½¿ç”¨ï¼‰\nå…³äºSLBæœ€ä¸Šæ–¹è¿˜æœ‰ä¸€ä¸ªDNSï¼ˆæˆ‘ä»¬åœ¨è®¡ç®—æœºç½‘ç»œè¿™é—¨è¯¾ç¨‹ä¸­å­¦ä¹ è¿‡ï¼‰ï¼Œè¿™ä¸ªæ˜¯å› ä¸ºSLBæ˜¯è£¸IPï¼Œå¦‚æœSLBæœåŠ¡å™¨ä¿®æ”¹äº†åœ°å€ï¼Œé‚£ä¹ˆæ‰€æœ‰å¾®æœåŠ¡æ³¨å†Œçš„åœ°å€ä¹Ÿå¾—æ”¹ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯é€šè¿‡åŠ åŸŸåï¼Œé€šè¿‡åŸŸåæ¥è®¿é—®ï¼Œè®©DNSå»è§£æçœŸå®IPï¼Œè¿™æ ·å°±ç®—æ”¹å˜IPï¼Œåªéœ€è¦ä¿®æ”¹åŸŸåè§£æè®°å½•å³å¯ï¼ŒåŸŸååœ°å€æ˜¯ä¸ä¼šå˜åŒ–çš„ã€‚\næœ€åå°±æ˜¯Nacosçš„æ•°æ®å­˜å‚¨æ¨¡å¼ï¼Œåœ¨å•èŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼ŒNacoså®é™…ä¸Šæ˜¯å°†æ•°æ®å­˜æ”¾åœ¨è‡ªå¸¦çš„ä¸€ä¸ªåµŒå…¥å¼æ•°æ®åº“ä¸­ï¼š\nè€Œè¿™ç§æ¨¡å¼åªé€‚ç”¨äºå•èŠ‚ç‚¹ï¼Œåœ¨å¤šèŠ‚ç‚¹é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œè‚¯å®šæ˜¯ä¸èƒ½å„å­˜å„çš„ï¼Œæ‰€ä»¥ï¼ŒNacosæä¾›äº†MySQLç»Ÿä¸€å­˜å‚¨æ”¯æŒï¼Œæˆ‘ä»¬åªéœ€è¦è®©æ‰€æœ‰çš„NacosæœåŠ¡å™¨è¿æ¥MySQLè¿›è¡Œæ•°æ®å­˜å‚¨å³å¯ï¼Œå®˜æ–¹ä¹Ÿæä¾›å¥½äº†SQLæ–‡ä»¶ã€‚\nç°åœ¨å°±å¯ä»¥å¼€å§‹äº†ï¼Œç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬ç›´æ¥å¯¼å…¥æ•°æ®åº“å³å¯ï¼Œæ–‡ä»¶åœ¨confç›®å½•ä¸­ï¼š\næˆ‘ä»¬æ¥å°†å…¶å¯¼å…¥åˆ°æ•°æ®åº“ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†å¾ˆå¤šçš„è¡¨ï¼š\nç„¶åæˆ‘ä»¬æ¥åˆ›å»ºä¸¤ä¸ªNacosæœåŠ¡å™¨ï¼Œåšä¸€ä¸ªè¿·ä½ çš„é›†ç¾¤ï¼Œè¿™é‡Œä½¿ç”¨scpå‘½ä»¤å°†nacosæœåŠ¡ç«¯ä¸Šä¼ åˆ°LinuxæœåŠ¡å™¨ï¼ˆæ³¨æ„éœ€è¦æå‰å®‰è£…å¥½JRE 8æˆ–æ›´é«˜ç‰ˆæœ¬çš„ç¯å¢ƒï¼‰ï¼š\nè§£å‹ä¹‹åï¼Œæˆ‘ä»¬å¯¹å…¶é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œé¦–å…ˆæ˜¯application.propertiesé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼ŒåŒ…æ‹¬MySQLæœåŠ¡å™¨çš„ä¿¡æ¯ï¼š\n### Default web server port: server.port=8801 #*************** Config Module Related Configurations ***************# ### If use MySQL as datasource: spring.datasource.platform=mysql ### Count of DB: db.num=1 ### Connect URL of DB: db.url.0=jdbc:mysql://cloudstudy.mysql.cn-chengdu.rds.aliyuncs.com:3306/nacos?characterEncoding=utf8\u0026amp;connectTimeout=1000\u0026amp;socketTimeout=3000\u0026amp;autoReconnect=true\u0026amp;useUnicode=true\u0026amp;useSSL=false\u0026amp;serverTimezone=UTC db.user.0=nacos db.password.0=nacos ç„¶åä¿®æ”¹é›†ç¾¤é…ç½®ï¼Œè¿™é‡Œéœ€è¦é‡å‘½åä¸€ä¸‹ï¼š\nç«¯å£è®°å¾—ä½¿ç”¨å†…ç½‘IPåœ°å€ï¼š\næœ€åæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹Nacosçš„å†…å­˜åˆ†é…ä»¥åŠå‰å°å¯åŠ¨ï¼Œç›´æ¥ä¿®æ”¹startup.shæ–‡ä»¶ï¼ˆå†…å­˜æœ‰é™ï¼Œç©ä¸èµ·é«˜çš„ï¼‰ï¼š\nä¿å­˜ä¹‹åï¼Œå°†nacoså¤åˆ¶ä¸€ä»½ï¼Œå¹¶å°†ç«¯å£ä¿®æ”¹ä¸º8802ï¼Œæ¥ç€å¯åŠ¨è¿™ä¸¤ä¸ªNacosæœåŠ¡å™¨ã€‚\nç„¶åæˆ‘ä»¬æ‰“å¼€ç®¡ç†é¢æ¿ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å·²ç»å¯åŠ¨äº†ï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬ç¬¬äºŒæ­¥å°±å®Œæˆäº†ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªSLBï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨Nginxåšåå‘ä»£ç†ï¼š\nNginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„\rHTTPå’Œ\råå‘ä»£ç†webæœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†IMAP/POP3/SMTPæœåŠ¡ã€‚å®ƒç›¸å½“äºåœ¨å†…ç½‘ä¸å¤–ç½‘ä¹‹é—´å½¢æˆä¸€ä¸ªç½‘å…³ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½å¯ä»¥ç”±NginxæœåŠ¡å™¨è½¬äº¤ç»™å†…ç½‘çš„å…¶ä»–æœåŠ¡å™¨ã€‚\nè¿™é‡Œæˆ‘ä»¬ç›´æ¥å®‰è£…ï¼š\nsudo apt install nginx å¯ä»¥çœ‹åˆ°ç›´æ¥è¯·æ±‚80ç«¯å£ä¹‹åå¾—åˆ°ï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸï¼š\nç°åœ¨æˆ‘ä»¬éœ€è¦è®©å…¶ä»£ç†æˆ‘ä»¬åˆšåˆšå¯åŠ¨çš„ä¸¤ä¸ªNacosæœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä¸€äº›é…ç½®ã€‚é…ç½®æ–‡ä»¶ä½äº/etc/nginx/nginx.confï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n#æ·»åŠ æˆ‘ä»¬åœ¨ä¸Šæ¸¸åˆšåˆšåˆ›å»ºå¥½çš„ä¸¤ä¸ªnacosæœåŠ¡å™¨\rupstream nacos-server {\rserver 10.0.0.12:8801;\rserver 10.0.0.12:8802;\r}\rserver {\rlisten 80;\rserver_name 1.14.121.107;\rlocation /nacos {\rproxy_pass http://nacos-server;\r}\r} é‡å¯NginxæœåŠ¡å™¨ï¼ŒæˆåŠŸè¿æ¥ï¼š\nç„¶åæˆ‘ä»¬å°†æ‰€æœ‰çš„æœåŠ¡å…¨éƒ¨ä¿®æ”¹ä¸ºäº‘æœåŠ¡å™¨ä¸ŠNacosçš„åœ°å€ï¼Œå¯åŠ¨è¯•è¯•çœ‹ã€‚\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±æ­å»ºå¥½äº†Nacosé›†ç¾¤ã€‚\nSentinel æµé‡é˜²å«å…µ #\ræ³¨æ„ï¼š è¿™ä¸€ç« æœ‰ç‚¹å°ç»•ï¼Œæ€è·¯ç†æ¸…ã€‚\nç»è¿‡ä¹‹å‰çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£äº†å¾®æœåŠ¡å­˜åœ¨çš„é›ªå´©é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªå¾®æœåŠ¡å‡ºç°é—®é¢˜ï¼Œæœ‰å¯èƒ½å¯¼è‡´æ•´ä¸ªé“¾è·¯ç›´æ¥ä¸å¯ç”¨ï¼Œè¿™ç§æ—¶å€™æˆ‘ä»¬å°±éœ€è¦è¿›è¡ŒåŠæ—¶çš„ç†”æ–­å’Œé™çº§ï¼Œè¿™äº›ç­–ç•¥ï¼Œæˆ‘ä»¬ä¹‹å‰é€šè¿‡ä½¿ç”¨Hystrixæ¥å®ç°ã€‚\nSpringCloud Alibabaä¹Ÿæœ‰è‡ªå·±çš„å¾®æœåŠ¡å®¹é”™ç»„ä»¶ï¼Œä½†æ˜¯å®ƒç›¸æ¯”Hystrixæ›´åŠ çš„å¼ºå¤§ã€‚\néšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚Sentinel ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚\nSentinel å…·æœ‰ä»¥ä¸‹ç‰¹å¾:\nä¸°å¯Œçš„åº”ç”¨åœºæ™¯ï¼šSentinel æ‰¿æ¥äº†é˜¿é‡Œå·´å·´è¿‘ 10 å¹´çš„åŒåä¸€å¤§ä¿ƒæµé‡çš„æ ¸å¿ƒåœºæ™¯ï¼Œä¾‹å¦‚ç§’æ€ï¼ˆå³çªå‘æµé‡æ§åˆ¶åœ¨ç³»ç»Ÿå®¹é‡å¯ä»¥æ‰¿å—çš„èŒƒå›´ï¼‰ã€æ¶ˆæ¯å‰Šå³°å¡«è°·ã€é›†ç¾¤æµé‡æ§åˆ¶ã€å®æ—¶ç†”æ–­ä¸‹æ¸¸ä¸å¯ç”¨åº”ç”¨ç­‰ã€‚ å®Œå¤‡çš„å®æ—¶ç›‘æ§ï¼šSentinel åŒæ—¶æä¾›å®æ—¶çš„ç›‘æ§åŠŸèƒ½ã€‚æ‚¨å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ¥å…¥åº”ç”¨çš„å•å°æœºå™¨ç§’çº§æ•°æ®ï¼Œç”šè‡³ 500 å°ä»¥ä¸‹è§„æ¨¡çš„é›†ç¾¤çš„æ±‡æ€»è¿è¡Œæƒ…å†µã€‚ å¹¿æ³›çš„å¼€æºç”Ÿæ€ï¼šSentinel æä¾›å¼€ç®±å³ç”¨çš„ä¸å…¶å®ƒå¼€æºæ¡†æ¶/åº“çš„æ•´åˆæ¨¡å—ï¼Œä¾‹å¦‚ä¸ Spring Cloudã€Apache Dubboã€gRPCã€Quarkus çš„æ•´åˆã€‚æ‚¨åªéœ€è¦å¼•å…¥ç›¸åº”çš„ä¾èµ–å¹¶è¿›è¡Œç®€å•çš„é…ç½®å³å¯å¿«é€Ÿåœ°æ¥å…¥ Sentinelã€‚åŒæ—¶ Sentinel æä¾› Java/Go/C++ ç­‰å¤šè¯­è¨€çš„åŸç”Ÿå®ç°ã€‚ å®Œå–„çš„ SPI æ‰©å±•æœºåˆ¶ï¼šSentinel æä¾›ç®€å•æ˜“ç”¨ã€å®Œå–„çš„ SPI æ‰©å±•æ¥å£ã€‚æ‚¨å¯ä»¥é€šè¿‡å®ç°æ‰©å±•æ¥å£æ¥å¿«é€Ÿåœ°å®šåˆ¶é€»è¾‘ã€‚ä¾‹å¦‚å®šåˆ¶è§„åˆ™ç®¡ç†ã€é€‚é…åŠ¨æ€æ•°æ®æºç­‰ã€‚ å®‰è£…ä¸éƒ¨ç½² #\rå’ŒNacosä¸€æ ·ï¼Œå®ƒæ˜¯ç‹¬ç«‹å®‰è£…å’Œéƒ¨ç½²çš„ï¼Œä¸‹è½½åœ°å€ï¼šhttps://github.com/alibaba/Sentinel/releases\næ³¨æ„ä¸‹è½½ä¸‹æ¥ä¹‹åæ˜¯ä¸€ä¸ªjaræ–‡ä»¶ï¼ˆå…¶å®å°±æ˜¯ä¸ªSpringBooté¡¹ç›®ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨IDEAä¸­æ·»åŠ ä¸€äº›è¿è¡Œé…ç½®ï¼š\næ¥ç€å°±å¯ä»¥ç›´æ¥å¯åŠ¨å•¦ï¼Œå½“ç„¶é»˜è®¤ç«¯å£å ç”¨8080ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹ï¼Œå¯ä»¥æ·»åŠ ç¯å¢ƒå˜é‡ï¼š\nå¯åŠ¨ä¹‹åï¼Œå°±å¯ä»¥è®¿é—®åˆ°Sentinelçš„ç›‘æ§é¡µé¢äº†ï¼Œç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯sentinelï¼Œåœ°å€ï¼šhttp://localhost:8858/#/dashboard\nè¿™æ ·å°±æˆåŠŸå¼€å¯ç›‘æ§é¡µé¢äº†ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦è®©æˆ‘ä»¬çš„æœåŠ¡è¿æ¥åˆ°Sentinelæ§åˆ¶å°ï¼Œè€è§„çŸ©ï¼Œå¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-sentinel\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ Sentinelç›¸å…³ä¿¡æ¯ï¼ˆå®é™…ä¸ŠSentinelæ˜¯æœ¬åœ°åœ¨è¿›è¡Œç®¡ç†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¿æ¥åˆ°ç›‘æ§é¡µé¢ï¼Œè¿™æ ·å°±å¯ä»¥å›¾å½¢åŒ–æ“ä½œäº†ï¼‰ï¼š\nspring: application: name: userservice cloud: nacos: discovery: server-addr: localhost:8848 sentinel: transport: # æ·»åŠ ç›‘æ§é¡µé¢åœ°å€å³å¯ dashboard: localhost:8858 ç°åœ¨å¯åŠ¨æˆ‘ä»¬çš„æœåŠ¡ï¼Œç„¶åè®¿é—®ä¸€æ¬¡æœåŠ¡ï¼Œè¿™æ ·Sentinelä¸­å°±ä¼šå­˜åœ¨ä¿¡æ¯äº†ï¼ˆæ‡’åŠ è½½æœºåˆ¶ï¼Œä¸ä¼šä¸€ä¸Šæ¥å°±åŠ è½½ï¼‰ï¼š\nç°åœ¨æˆ‘ä»¬å°±å¯ä»¥åœ¨Sentinelæ§åˆ¶å°ä¸­å¯¹æˆ‘ä»¬çš„æœåŠ¡è¿è¡Œæƒ…å†µè¿›è¡Œå®æ—¶ç›‘æ§äº†ï¼Œå¯ä»¥çœ‹åˆ°ç›‘æ§çš„å†…å®¹éå¸¸çš„å¤šï¼ŒåŒ…æ‹¬æ—¶é—´ç‚¹ã€QPS(æ¯ç§’æŸ¥è¯¢ç‡)ã€å“åº”æ—¶é—´ç­‰æ•°æ®ã€‚\næŒ‰ç…§ä¸Šé¢çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰çš„æœåŠ¡å…¨éƒ¨è¿æ¥åˆ°Sentinelç®¡ç†é¢æ¿ä¸­ã€‚\næµé‡æ§åˆ¶ #\rå‰é¢æˆ‘ä»¬å®Œæˆäº†å¯¹Sentinelçš„æ­å»ºä¸è¿æ¥ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹Sentinelçš„ç¬¬ä¸€ä¸ªåŠŸèƒ½ï¼Œæµé‡æ§åˆ¶ã€‚\næˆ‘ä»¬çš„æœºå™¨ä¸å¯èƒ½æ— é™åˆ¶çš„æ¥å—å’Œå¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¦‚æœä¸åŠ ä»¥é™åˆ¶ï¼Œå½“å‘ç”Ÿé«˜å¹¶å‘æƒ…å†µæ—¶ï¼Œç³»ç»Ÿèµ„æºå°†å¾ˆå¿«è¢«è€—å°½ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±å¯ä»¥æ·»åŠ æµé‡æ§åˆ¶ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯é™æµï¼‰å½“ä¸€æ®µæ—¶é—´å†…çš„æµé‡åˆ°è¾¾ä¸€å®šçš„é˜ˆå€¼çš„æ—¶å€™ï¼Œæ–°çš„è¯·æ±‚å°†ä¸å†è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·ä¸ä»…å¯ä»¥åˆç†åœ°åº”å¯¹é«˜å¹¶å‘è¯·æ±‚ï¼ŒåŒæ—¶ä¹Ÿèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤æœåŠ¡å™¨ä¸å—åˆ°å¤–ç•Œçš„æ¶æ„æ”»å‡»ã€‚\né‚£ä¹ˆè¦å®ç°é™æµï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¯¥é‡‡å–ä»€ä¹ˆæ ·çš„ç­–ç•¥å‘¢ï¼Ÿ\næ–¹æ¡ˆä¸€ï¼šå¿«é€Ÿæ‹’ç»ï¼Œæ—¢ç„¶ä¸å†æ¥å—æ–°çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªæ‹’ç»ä¿¡æ¯ï¼Œå‘Šè¯‰ç”¨æˆ·è®¿é—®é¢‘ç‡è¿‡é«˜ã€‚ æ–¹æ¡ˆäºŒï¼šé¢„çƒ­ï¼Œä¾ç„¶åŸºäºæ–¹æ¡ˆä¸€ï¼Œä½†æ˜¯ç”±äºæŸäº›æƒ…å†µä¸‹é«˜å¹¶å‘è¯·æ±‚æ˜¯åœ¨æŸä¸€æ—¶åˆ»çªç„¶åˆ°æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç¼“æ…¢åœ°å°†é˜ˆå€¼æé«˜åˆ°æŒ‡å®šé˜ˆå€¼ï¼Œå½¢æˆä¸€ä¸ªç¼“å†²ä¿æŠ¤ã€‚ æ–¹æ¡ˆä¸‰ï¼šæ’é˜Ÿç­‰å¾…ï¼Œä¸æ¥å—æ–°çš„è¯·æ±‚ï¼Œä½†æ˜¯ä¹Ÿä¸ç›´æ¥æ‹’ç»ï¼Œè€Œæ˜¯è¿›é˜Ÿåˆ—å…ˆç­‰ä¸€ä¸‹ï¼Œå¦‚æœè§„å®šæ—¶é—´å†…èƒ½å¤Ÿæ‰§è¡Œï¼Œé‚£ä¹ˆå°±æ‰§è¡Œï¼Œè¦æ˜¯è¶…æ—¶å°±ç®—äº†ã€‚ é’ˆå¯¹äºæ˜¯å¦è¶…è¿‡æµé‡é˜ˆå€¼çš„åˆ¤æ–­ï¼Œè¿™é‡Œæˆ‘ä»¬æ4ç§ç®—æ³•ï¼š\næ¼æ¡¶ç®—æ³•\né¡¾åæ€ä¹‰ï¼Œå°±åƒä¸€ä¸ªæ¡¶å¼€äº†ä¸€ä¸ªå°å­”ï¼Œæ°´æµè¿›æ¡¶ä¸­çš„é€Ÿåº¦è‚¯å®šæ˜¯è¿œå¤§äºæ°´æµå‡ºæ¡¶çš„é€Ÿåº¦çš„ï¼Œè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€ç§é™æµæ€è·¯ï¼š\næˆ‘ä»¬çŸ¥é“ï¼Œæ¡¶æ˜¯æœ‰å®¹é‡çš„ï¼Œæ‰€ä»¥å½“æ¡¶çš„å®¹é‡å·²æ»¡æ—¶ï¼Œå°±è£…ä¸ä¸‹æ°´äº†ï¼Œè¿™æ—¶å°±åªæœ‰ä¸¢å¼ƒè¯·æ±‚äº†ã€‚\nåˆ©ç”¨è¿™ç§æ€æƒ³ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºä¸€ä¸ªç®€å•çš„é™æµç®—æ³•ã€‚\nä»¤ç‰Œæ¡¶ç®—æ³•\nåªèƒ½è¯´æœ‰ç‚¹åƒä¿¡å·é‡æœºåˆ¶ã€‚ç°åœ¨æœ‰ä¸€ä¸ªä»¤ç‰Œæ¡¶ï¼Œè¿™ä¸ªæ¡¶æ˜¯ä¸“é—¨å­˜æ”¾ä»¤ç‰Œçš„ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å°±å‘æ¡¶ä¸­ä¸¢å…¥ä¸€ä¸ªä»¤ç‰Œï¼ˆé€Ÿåº¦ç”±æˆ‘ä»¬æŒ‡å®šï¼‰å½“æ–°çš„è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œå°†ä»æ¡¶ä¸­åˆ é™¤ä»¤ç‰Œï¼Œæ¥ç€è¯·æ±‚å°±å¯ä»¥é€šè¿‡å¹¶ç»™åˆ°æœåŠ¡ï¼Œä½†æ˜¯å¦‚æœæ¡¶ä¸­çš„ä»¤ç‰Œæ•°é‡ä¸è¶³ï¼Œé‚£ä¹ˆä¸ä¼šåˆ é™¤ä»¤ç‰Œï¼Œè€Œæ˜¯è®©æ­¤æ•°æ®åŒ…ç­‰å¾…ã€‚\nå¯ä»¥è¯•æƒ³ä¸€ä¸‹ï¼Œå½“æµé‡ä¸‹é™æ—¶ï¼Œä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œä¼šé€æ¸ç§¯ç´¯ï¼Œè¿™æ ·å¦‚æœçªç„¶å‡ºç°é«˜å¹¶å‘ï¼Œé‚£ä¹ˆå°±èƒ½åœ¨çŸ­æ—¶é—´å†…æ‹¿åˆ°å¤§é‡çš„ä»¤ç‰Œã€‚\nå›ºå®šæ—¶é—´çª—å£ç®—æ³•\næˆ‘ä»¬å¯ä»¥å¯¹æŸä¸€ä¸ªæ—¶é—´æ®µå†…çš„è¯·æ±‚è¿›è¡Œç»Ÿè®¡å’Œè®¡æ•°ï¼Œæ¯”å¦‚åœ¨14:15åˆ°14:16è¿™ä¸€åˆ†é’Ÿå†…ï¼Œè¯·æ±‚é‡ä¸èƒ½è¶…è¿‡100ï¼Œä¹Ÿå°±æ˜¯ä¸€åˆ†é’Ÿä¹‹å†…ä¸èƒ½è¶…è¿‡100æ¬¡è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·è¿›è¡Œåˆ’åˆ†ï¼š\nè™½ç„¶è¿™ç§æ¨¡å¼çœ‹ä¼¼æ¯”è¾ƒåˆç†ï¼Œä½†æ˜¯è¯•æƒ³ä¸€ä¸‹è¿™ç§æƒ…å†µï¼š\n14:15:59çš„æ—¶å€™æ¥äº†100ä¸ªè¯·æ±‚ 14:16:01çš„æ—¶å€™åˆæ¥äº†100ä¸ªè¯·æ±‚ å‡ºç°ä¸Šé¢è¿™ç§æƒ…å†µï¼Œç¬¦åˆå›ºå®šæ—¶é—´çª—å£ç®—æ³•çš„è§„åˆ™ï¼Œæ‰€ä»¥è¿™200ä¸ªè¯·æ±‚éƒ½èƒ½æ­£å¸¸æ¥å—ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ ååº”æ¯”è¾ƒå¿«ï¼Œåº”è¯¥å‘ç°äº†ï¼Œæˆ‘ä»¬å…¶å®å¸Œæœ›çš„æ˜¯60ç§’å†…åªæœ‰100ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µå´æ˜¯åœ¨3ç§’å†…å‡ºç°äº†200ä¸ªè¯·æ±‚ï¼Œå¾ˆæ˜æ˜¾å·²ç»è¿èƒŒäº†æˆ‘ä»¬çš„åˆè¡·ã€‚\nå› æ­¤ï¼Œå½“é‡åˆ°ä¸´ç•Œç‚¹æ—¶ï¼Œå›ºå®šæ—¶é—´çª—å£ç®—æ³•å­˜åœ¨å®‰å…¨éšæ‚£ã€‚\næ»‘åŠ¨æ—¶é—´çª—å£ç®—æ³•\nç›¸å¯¹äºå›ºå®šçª—å£ç®—æ³•ï¼Œæ»‘åŠ¨æ—¶é—´çª—å£ç®—æ³•æ›´åŠ çµæ´»ï¼Œå®ƒä¼šåŠ¨æ€ç§»åŠ¨çª—å£ï¼Œé‡æ–°è¿›è¡Œè®¡ç®—ï¼š\nè™½ç„¶è¿™æ ·èƒ½å¤Ÿé¿å…å›ºå®šæ—¶é—´çª—å£çš„ä¸´ç•Œé—®é¢˜ï¼Œä½†æ˜¯è¿™æ ·æ˜¾ç„¶æ˜¯æ¯”å›ºå®šçª—å£æ›´åŠ è€—æ—¶çš„ã€‚\nå¥½äº†ï¼Œäº†è§£å®Œäº†æˆ‘ä»¬çš„é™æµç­–ç•¥å’Œåˆ¤å®šæ–¹æ³•ä¹‹åï¼Œæˆ‘ä»¬åœ¨Sentinelä¸­è¿›è¡Œå®é™…æµ‹è¯•ä¸€ä¸‹ï¼Œæ‰“å¼€ç®¡ç†é¡µé¢çš„ç°‡ç‚¹é“¾è·¯æ¨¡å—ï¼š\nè¿™é‡Œæ¼”ç¤ºå¯¹æˆ‘ä»¬çš„å€Ÿé˜…æ¥å£è¿›è¡Œé™æµï¼Œç‚¹å‡»æµæ§ï¼Œä¼šçœ‹åˆ°è®©æˆ‘ä»¬æ·»åŠ æµæ§è§„åˆ™ï¼š\né˜ˆå€¼ç±»å‹ï¼šQPSå°±æ˜¯æ¯ç§’é’Ÿçš„è¯·æ±‚æ•°é‡ï¼Œå¹¶å‘çº¿ç¨‹æ•°æ˜¯æŒ‰æœåŠ¡å½“å‰ä½¿ç”¨çš„çº¿ç¨‹æ•°æ®è¿›è¡Œç»Ÿè®¡çš„ã€‚ æµæ§æ¨¡å¼ï¼šå½“è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œæµæ§çš„å¯¹è±¡ï¼Œè¿™é‡Œæš‚æ—¶åªç”¨ç›´æ¥ã€‚ æµæ§æ•ˆæœï¼šå°±æ˜¯æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„ä¸‰ç§æ–¹æ¡ˆã€‚ è¿™é‡Œæˆ‘ä»¬é€‰æ‹©QPSã€é˜ˆå€¼è®¾å®šä¸º1ï¼Œæµæ§æ¨¡å¼é€‰æ‹©ç›´æ¥ã€æµæ§æ•ˆæœé€‰æ‹©å¿«é€Ÿå¤±è´¥ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬å¿«é€Ÿåœ°è¿›è¡Œè¯·æ±‚æ—¶ï¼Œä¼šç›´æ¥è¿”å›å¤±è´¥ä¿¡æ¯ï¼š\nè¿™é‡Œå„ä½æœ€å¥½è‡ªè¡Œå°è¯•ä¸€ä¸‹å…¶ä»–çš„æµæ§æ•ˆæœï¼Œç†Ÿæ‚‰å’ŒåŠ æ·±å°è±¡ã€‚\næœ€åæˆ‘ä»¬æ¥çœ‹çœ‹è¿™äº›æµæ§æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼š\nç›´æ¥ï¼šåªé’ˆå¯¹äºå½“å‰æ¥å£ã€‚ å…³è”ï¼šå½“å…¶ä»–æ¥å£è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¼šå¯¼è‡´å½“å‰æ¥å£è¢«é™æµã€‚ é“¾è·¯ï¼šæ›´ç»†ç²’åº¦çš„é™æµï¼Œèƒ½ç²¾ç¡®åˆ°å…·ä½“çš„æ–¹æ³•ã€‚ æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹å…³è”ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬å¯¹è‡ªå¸¦çš„/erroræ¥å£è¿›è¡Œé™æµï¼š\næ³¨æ„é™æµæ˜¯ä½œç”¨äºå…³è”èµ„æºçš„ï¼Œä¸€æ—¦å‘ç°å…³è”èµ„æºè¶…è¿‡é˜ˆå€¼ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹å½“å‰çš„èµ„æºè¿›è¡Œé™æµï¼Œæˆ‘ä»¬ç°åœ¨æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œè¿™é‡Œä½¿ç”¨PostMançš„Runnerè¿ç»­å¯¹å…³è”èµ„æºå‘èµ·è¯·æ±‚ï¼š\nå¼€å¯Postmanï¼Œç„¶åæˆ‘ä»¬ä¼šå‘ç°å€Ÿé˜…æœåŠ¡å·²ç»å‡‰å‡‰ï¼š\nå½“æˆ‘ä»¬å…³é—­æ‰Postmançš„ä»»åŠ¡åï¼Œæ¢å¤æ­£å¸¸ã€‚\næœ€åæˆ‘ä»¬æ¥è®²è§£ä¸€ä¸‹é“¾è·¯æ¨¡å¼ï¼Œå®ƒèƒ½å¤Ÿæ›´åŠ ç²¾å‡†çš„è¿›è¡Œæµé‡æ§åˆ¶ï¼Œé“¾è·¯æµæ§æ¨¡å¼æŒ‡çš„æ˜¯ï¼Œå½“ä»æŒ‡å®šæ¥å£è¿‡æ¥çš„èµ„æºè¯·æ±‚è¾¾åˆ°é™æµæ¡ä»¶æ—¶ï¼Œå¼€å¯é™æµï¼Œè¿™é‡Œå¾—å…ˆè®²è§£ä¸€ä¸‹@SentinelResourceçš„ä½¿ç”¨ã€‚\næˆ‘ä»¬å¯ä»¥å¯¹æŸä¸€ä¸ªæ–¹æ³•è¿›è¡Œé™æµæ§åˆ¶ï¼Œæ— è®ºæ˜¯è°åœ¨ä½•å¤„è°ƒç”¨äº†å®ƒï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨åˆ°@SentinelResourceï¼Œä¸€æ—¦æ–¹æ³•è¢«æ ‡æ³¨ï¼Œé‚£ä¹ˆå°±ä¼šè¿›è¡Œç›‘æ§ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œåˆ›å»ºä¸¤ä¸ªè¯·æ±‚æ˜ å°„ï¼Œéƒ½æ¥è°ƒç”¨Serviceçš„è¢«ç›‘æ§æ–¹æ³•ï¼š\n@RestController public class BorrowController { @Resource BorrowService service; @RequestMapping(\u0026#34;/borrow/{uid}\u0026#34;) UserBorrowDetail findUserBorrows(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserBorrowDetailByUid(uid); } @RequestMapping(\u0026#34;/borrow2/{uid}\u0026#34;) UserBorrowDetail findUserBorrows2(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserBorrowDetailByUid(uid); } } @Service public class BorrowServiceImpl implements BorrowService{ @Resource BorrowMapper mapper; @Resource UserClient userClient; @Resource BookClient bookClient; @Override @SentinelResource(\u0026#34;getBorrow\u0026#34;) //ç›‘æ§æ­¤æ–¹æ³•ï¼Œæ— è®ºè¢«è°æ‰§è¡Œéƒ½åœ¨ç›‘æ§èŒƒå›´å†…ï¼Œè¿™é‡Œç»™çš„valueæ˜¯è‡ªå®šä¹‰åç§°ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥åŠ åœ¨ä»»ä½•æ–¹æ³•ä¸Šï¼ŒåŒ…æ‹¬Controllerä¸­çš„è¯·æ±‚æ˜ å°„æ–¹æ³•ï¼Œè·ŸHystrixCommandè´¼åƒ public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); User user = userClient.getUserById(uid); List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; bookClient.getBookById(b.getBid())) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } } æ¥ç€æ·»åŠ é…ç½®ï¼š\nspring: application: name: borrowservice cloud: sentinel: transport: dashboard: localhost:8858 # å…³é—­Contextæ”¶æ•›ï¼Œè¿™æ ·è¢«ç›‘æ§æ–¹æ³•å¯ä»¥è¿›è¡Œä¸åŒé“¾è·¯çš„å•ç‹¬æ§åˆ¶ web-context-unify: false ç„¶åæˆ‘ä»¬åœ¨Sentinelæ§åˆ¶å°ä¸­æ·»åŠ æµæ§è§„åˆ™ï¼Œæ³¨æ„æ˜¯é’ˆå¯¹æ­¤æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»è‡ªåŠ¨è¯†åˆ«åˆ°borrowæ¥å£ä¸‹è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼š\næœ€åæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­å¯¹è¿™ä¸¤ä¸ªæ¥å£éƒ½è¿›è¡Œæµ‹è¯•ï¼Œä¼šå‘ç°ï¼Œæ— è®ºè¯·æ±‚å“ªä¸ªæ¥å£ï¼Œåªè¦è°ƒç”¨äº†Serviceä¸­çš„getUserBorrowDetailByUidè¿™ä¸ªæ–¹æ³•ï¼Œéƒ½ä¼šè¢«é™æµã€‚æ³¨æ„é™æµçš„å½¢å¼æ˜¯åå°ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè‡³äºæ€ä¹ˆå¤„ç†æˆ‘ä»¬åé¢å†è¯´ã€‚\né‚£ä¹ˆè¿™ä¸ªé“¾è·¯é€‰é¡¹å®é™…ä¸Šå°±æ˜¯å†³å®šåªé™æµä»å“ªä¸ªæ–¹å‘æ¥çš„è°ƒç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬åªå¯¹borrow2è¿™ä¸ªæ¥å£å¯¹getUserBorrowDetailByUidæ–¹æ³•çš„è°ƒç”¨è¿›è¡Œé™æµï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¸ºå…¶æŒ‡å®šé“¾è·¯ï¼š\nç„¶åæˆ‘ä»¬ä¼šå‘ç°ï¼Œé™æµæ•ˆæœåªå¯¹æˆ‘ä»¬é…ç½®çš„é“¾è·¯æ¥å£æœ‰æ•ˆï¼Œè€Œå…¶ä»–é“¾è·¯æ˜¯ä¸ä¼šè¢«é™æµçš„ã€‚\né™¤äº†ç›´æ¥å¯¹æ¥å£è¿›è¡Œé™æµè§„åˆ™æ§åˆ¶ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®å½“å‰ç³»ç»Ÿçš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œå†³å®šæ˜¯å¦è¿›è¡Œé™æµï¼š\nç³»ç»Ÿè§„åˆ™æ”¯æŒä»¥ä¸‹çš„æ¨¡å¼ï¼š\nLoad è‡ªé€‚åº”ï¼ˆä»…å¯¹ Linux/Unix-like æœºå™¨ç”Ÿæ•ˆï¼‰ï¼šç³»ç»Ÿçš„ load1 ä½œä¸ºå¯å‘æŒ‡æ ‡ï¼Œè¿›è¡Œè‡ªé€‚åº”ç³»ç»Ÿä¿æŠ¤ã€‚å½“ç³»ç»Ÿ load1 è¶…è¿‡è®¾å®šçš„å¯å‘å€¼ï¼Œä¸”ç³»ç»Ÿå½“å‰çš„å¹¶å‘çº¿ç¨‹æ•°è¶…è¿‡ä¼°ç®—çš„ç³»ç»Ÿå®¹é‡æ—¶æ‰ä¼šè§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼ˆBBR é˜¶æ®µï¼‰ã€‚ç³»ç»Ÿå®¹é‡ç”±ç³»ç»Ÿçš„ maxQps * minRt ä¼°ç®—å¾—å‡ºã€‚è®¾å®šå‚è€ƒå€¼ä¸€èˆ¬æ˜¯ CPU cores * 2.5ã€‚ CPU usageï¼ˆ1.5.0+ ç‰ˆæœ¬ï¼‰ï¼šå½“ç³»ç»Ÿ CPU ä½¿ç”¨ç‡è¶…è¿‡é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼ˆå–å€¼èŒƒå›´ 0.0-1.0ï¼‰ï¼Œæ¯”è¾ƒçµæ•ã€‚ å¹³å‡ RTï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹³å‡ RT è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚ å¹¶å‘çº¿ç¨‹æ•°ï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹¶å‘çº¿ç¨‹æ•°è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚ å…¥å£ QPSï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„ QPS è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚ è¿™é‡Œå°±ä¸è¿›è¡Œæ¼”ç¤ºäº†ã€‚\né™æµå’Œå¼‚å¸¸å¤„ç† #\rç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•è¿›è¡Œé™æµæ“ä½œï¼Œé‚£ä¹ˆé™æµçŠ¶æ€ä¸‹çš„è¿”å›ç»“æœè¯¥æ€ä¹ˆä¿®æ”¹å‘¢ï¼Œæˆ‘ä»¬çœ‹åˆ°è¢«é™æµä¹‹åè¿”å›çš„æ˜¯Sentinelé»˜è®¤çš„æ•°æ®ï¼Œç°åœ¨æˆ‘ä»¬å¸Œæœ›è‡ªå®šä¹‰æ”¹å¦‚ä½•æ“ä½œï¼Ÿ\nè¿™é‡Œæˆ‘ä»¬å…ˆåˆ›å»ºå¥½è¢«é™æµçŠ¶æ€ä¸‹éœ€è¦è¿”å›çš„å†…å®¹ï¼Œå®šä¹‰ä¸€ä¸ªè¯·æ±‚æ˜ å°„ï¼š\n@RequestMapping(\u0026#34;/blocked\u0026#34;) JSONObject blocked(){ JSONObject object = new JSONObject(); object.put(\u0026#34;code\u0026#34;, 403); object.put(\u0026#34;success\u0026#34;, false); object.put(\u0026#34;massage\u0026#34;, \u0026#34;æ‚¨çš„è¯·æ±‚é¢‘ç‡è¿‡å¿«ï¼Œè¯·ç¨åå†è¯•ï¼\u0026#34;); return object; } æ¥ç€æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­å°†æ­¤é¡µé¢è®¾å®šä¸ºé™æµé¡µé¢ï¼š\nspring: cloud: sentinel: transport: dashboard: localhost:8858 # å°†åˆšåˆšç¼–å†™çš„è¯·æ±‚æ˜ å°„è®¾å®šä¸ºé™æµé¡µé¢ block-page: /blocked è¿™æ ·ï¼Œå½“è¢«é™æµæ—¶ï¼Œå°±ä¼šè¢«é‡å®šå‘åˆ°æŒ‡å®šé¡µé¢ï¼š\né‚£ä¹ˆï¼Œå¯¹äºæ–¹æ³•çº§åˆ«çš„é™æµå‘¢ï¼Ÿç»è¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“ï¼Œå½“æŸä¸ªæ–¹æ³•è¢«é™æµæ—¶ï¼Œä¼šç›´æ¥åœ¨åå°æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µæˆ‘ä»¬è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰åœ¨Hystrixä¸­å¯ä»¥ç›´æ¥æ·»åŠ ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œè¿™æ ·å½“å‡ºç°å¼‚å¸¸æ—¶ä¼šç›´æ¥æ‰§è¡Œæˆ‘ä»¬çš„æ›¿ä»£æ–¹æ³•å¹¶è¿”å›ï¼ŒSentinelä¹Ÿå¯ä»¥ã€‚\næ¯”å¦‚æˆ‘ä»¬è¿˜æ˜¯åœ¨getUserBorrowDetailByUidæ–¹æ³•ä¸Šè¿›è¡Œé…ç½®ï¼š\n@Override @SentinelResource(value = \u0026#34;getBorrow\u0026#34;, blockHandler = \u0026#34;blocked\u0026#34;) //æŒ‡å®šblockHandlerï¼Œä¹Ÿå°±æ˜¯è¢«é™æµä¹‹åçš„æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Œè¿™æ ·å°±ä¸ä¼šä½¿ç”¨é»˜è®¤çš„æŠ›å‡ºå¼‚å¸¸çš„å½¢å¼äº† public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); User user = userClient.getUserById(uid); List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; bookClient.getBookById(b.getBid())) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } //æ›¿ä»£æ–¹æ¡ˆï¼Œæ³¨æ„å‚æ•°å’Œè¿”å›å€¼éœ€è¦ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”å‚æ•°æœ€åè¿˜éœ€è¦é¢å¤–æ·»åŠ ä¸€ä¸ªBlockException public UserBorrowDetail blocked(int uid, BlockException e) { return new UserBorrowDetail(null, Collections.emptyList()); } å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦è¢«é™æµå°†æ‰§è¡Œæ›¿ä»£æ–¹æ¡ˆï¼Œæœ€åè¿”å›çš„ç»“æœå°±æ˜¯ï¼š\næ³¨æ„blockHandleråªèƒ½å¤„ç†é™æµæƒ…å†µä¸‹æŠ›å‡ºçš„å¼‚å¸¸ï¼ŒåŒ…æ‹¬ä¸‹é¢å³å°†è¦ä»‹ç»çš„çƒ­ç‚¹å‚æ•°é™æµä¹Ÿæ˜¯åŒç†ï¼Œå¦‚æœæ˜¯æ–¹æ³•æœ¬èº«æŠ›å‡ºçš„å…¶ä»–ç±»å‹å¼‚å¸¸ï¼Œä¸åœ¨ç®¡æ§èŒƒå›´å†…ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–å‚æ•°è¿›è¡Œå¤„ç†ï¼š\n@RequestMapping(\u0026#34;/test\u0026#34;) @SentinelResource(value = \u0026#34;test\u0026#34;, fallback = \u0026#34;except\u0026#34;, //fallbackæŒ‡å®šå‡ºç°å¼‚å¸¸æ—¶çš„æ›¿ä»£æ–¹æ¡ˆ exceptionsToIgnore = IOException.class) //å¿½ç•¥é‚£äº›å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›å¼‚å¸¸å‡ºç°æ—¶ä¸ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆ String test(){ throw new RuntimeException(\u0026#34;HelloWorldï¼\u0026#34;); } //æ›¿ä»£æ–¹æ³•å¿…é¡»å’ŒåŸæ–¹æ³•è¿”å›å€¼å’Œå‚æ•°ä¸€è‡´ï¼Œæœ€åå¯ä»¥æ·»åŠ ä¸€ä¸ªThrowableä½œä¸ºå‚æ•°æ¥å—å¼‚å¸¸ String except(Throwable t){ return t.getMessage(); } è¿™æ ·ï¼Œå…¶ä»–çš„å¼‚å¸¸ä¹Ÿå¯ä»¥æœ‰æ›¿ä»£æ–¹æ¡ˆäº†ï¼š\nç‰¹åˆ«æ³¨æ„è¿™ç§æ–¹å¼ä¼šåœ¨æ²¡æœ‰é…ç½®blockHandlerçš„æƒ…å†µä¸‹ï¼Œå°†Sentinelæœºåˆ¶å†…ï¼ˆä¹Ÿå°±æ˜¯é™æµçš„å¼‚å¸¸ï¼‰çš„å¼‚å¸¸ä¹Ÿä¸€å¹¶å¤„ç†äº†ï¼Œå¦‚æœé…ç½®äº†blockHandlerï¼Œé‚£ä¹ˆåœ¨å‡ºç°é™æµæ—¶ï¼Œä¾ç„¶åªä¼šæ‰§è¡ŒblockHandleræŒ‡å®šçš„æ›¿ä»£æ–¹æ¡ˆï¼ˆå› ä¸ºé™æµæ˜¯åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰è¿›è¡Œçš„ï¼‰\nçƒ­ç‚¹å‚æ•°é™æµ #\ræˆ‘ä»¬è¿˜å¯ä»¥å¯¹æŸä¸€çƒ­ç‚¹æ•°æ®è¿›è¡Œç²¾å‡†é™æµï¼Œæ¯”å¦‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œä¸åŒå‚æ•°è¢«æºå¸¦è®¿é—®çš„é¢‘ç‡æ˜¯ä¸ä¸€æ ·çš„ï¼š\nhttp://localhost:8301/test?a=10 è®¿é—®100æ¬¡ http://localhost:8301/test?b=10 è®¿é—®0æ¬¡ http://localhost:8301/test?c=10 è®¿é—®3æ¬¡ ç”±äºæºå¸¦å‚æ•°açš„è¯·æ±‚æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å°±å¯ä»¥åªå¯¹æºå¸¦å‚æ•°açš„è¯·æ±‚è¿›è¡Œé™æµã€‚\nè¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•è¯·æ±‚æ˜ å°„ï¼š\n@RequestMapping(\u0026#34;/test\u0026#34;) @SentinelResource(\u0026#34;test\u0026#34;) //æ³¨æ„è¿™é‡Œéœ€è¦æ·»åŠ @SentinelResourceæ‰å¯ä»¥ï¼Œç”¨æˆ·èµ„æºåç§°å°±ä½¿ç”¨è¿™é‡Œå®šä¹‰çš„èµ„æºåç§° String findUserBorrows2(@RequestParam(value = \u0026#34;a\u0026#34;, required = false) int a, @RequestParam(value = \u0026#34;b\u0026#34;, required = false) int b, @RequestParam(value = \u0026#34;c\u0026#34;,required = false) int c) { return \u0026#34;è¯·æ±‚æˆåŠŸï¼a = \u0026#34;+a+\u0026#34;, b = \u0026#34;+b+\u0026#34;, c = \u0026#34;+c; } å¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬åœ¨Sentinelé‡Œé¢è¿›è¡Œçƒ­ç‚¹é…ç½®ï¼š\nç„¶åå¼€å§‹è®¿é—®æˆ‘ä»¬çš„æµ‹è¯•æ¥å£ï¼Œå¯ä»¥çœ‹åˆ°åœ¨æºå¸¦å‚æ•°aæ—¶ï¼Œå½“è®¿é—®é¢‘ç‡è¶…è¿‡è®¾å®šå€¼ï¼Œå°±ä¼šç›´æ¥è¢«é™æµï¼Œè¿™é‡Œæ˜¯ç›´æ¥åœ¨åå°æŠ›å‡ºå¼‚å¸¸ï¼š\nè€Œæˆ‘ä»¬ä½¿ç”¨å…¶ä»–å‚æ•°æˆ–æ˜¯ä¸å¸¦aå‚æ•°ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå‡ºç°è¿™ç§é—®é¢˜äº†ï¼š\né™¤äº†ç›´æ¥å¯¹æŸä¸ªå‚æ•°ç²¾å‡†é™æµå¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¯¹å‚æ•°æºå¸¦çš„æŒ‡å®šå€¼å•ç‹¬è®¾å®šé˜ˆå€¼ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨ä¸ä»…å¸Œæœ›å¯¹å‚æ•°aé™æµï¼Œè€Œä¸”è¿˜å¸Œæœ›å½“å‚æ•°açš„å€¼ä¸º10æ—¶ï¼ŒQPSè¾¾åˆ°5å†è¿›è¡Œé™æµï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¾å®šä¾‹å¤–ï¼š\nè¿™æ ·ï¼Œå½“è¯·æ±‚æºå¸¦å‚æ•°aï¼Œä¸”å‚æ•°açš„å€¼ä¸º10æ—¶ï¼Œé˜ˆå€¼å°†æŒ‰ç…§æˆ‘ä»¬æŒ‡å®šçš„ç‰¹ä¾‹è¿›è¡Œè®¡ç®—ã€‚\næœåŠ¡ç†”æ–­å’Œé™çº§ #\rè¿˜è®°å¾—æˆ‘ä»¬å‰æ‰€è¯´çš„æœåŠ¡é™çº§å—ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦åœ¨æ•´ä¸ªå¾®æœåŠ¡è°ƒç”¨é“¾è·¯å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼ŒåŠæ—¶å¯¹æœåŠ¡è¿›è¡Œé™çº§ï¼Œä»¥é˜²æ­¢é—®é¢˜è¿›ä¸€æ­¥æ¶åŒ–ã€‚\né‚£ä¹ˆï¼Œå„ä½æ˜¯å¦æœ‰æ€è€ƒè¿‡ï¼Œå¦‚æœåœ¨æŸä¸€æ—¶åˆ»ï¼ŒæœåŠ¡Bå‡ºç°æ•…éšœï¼ˆå¯èƒ½å°±å¡åœ¨é‚£é‡Œäº†ï¼‰ï¼Œè€Œè¿™æ—¶æœåŠ¡Aä¾ç„¶æœ‰å¤§é‡çš„è¯·æ±‚ï¼Œåœ¨è°ƒç”¨æœåŠ¡Bï¼Œé‚£ä¹ˆï¼Œç”±äºæœåŠ¡Aæ²¡åŠæ³•å†çŸ­æ—¶é—´å†…å®Œæˆå¤„ç†ï¼Œæ–°æ¥çš„è¯·æ±‚å°±ä¼šå¯¼è‡´çº¿ç¨‹æ•°ä¸æ–­åœ°å¢åŠ ï¼Œè¿™æ ·ï¼ŒCPUçš„èµ„æºå¾ˆå¿«å°±ä¼šè¢«è€—å°½ã€‚\né‚£ä¹ˆè¦é˜²æ­¢è¿™ç§æƒ…å†µï¼Œå°±åªèƒ½è¿›è¡Œéš”ç¦»äº†ï¼Œè¿™é‡Œæˆ‘ä»¬æä¸¤ç§éš”ç¦»æ–¹æ¡ˆï¼š\nçº¿ç¨‹æ± éš”ç¦»\nçº¿ç¨‹æ± éš”ç¦»å®é™…ä¸Šå°±æ˜¯å¯¹æ¯ä¸ªæœåŠ¡çš„è¿œç¨‹è°ƒç”¨å•ç‹¬å¼€æ”¾çº¿ç¨‹æ± ï¼Œæ¯”å¦‚æœåŠ¡Aè¦è°ƒç”¨æœåŠ¡Bï¼Œé‚£ä¹ˆåªåŸºäºå›ºå®šæ•°é‡çš„çº¿ç¨‹æ± ï¼Œè¿™æ ·å³ä½¿åœ¨çŸ­æ—¶é—´å†…å‡ºç°å¤§é‡è¯·æ±‚ï¼Œç”±äºæ²¡æœ‰çº¿ç¨‹å¯ä»¥åˆ†é…ï¼Œæ‰€ä»¥å°±ä¸ä¼šå¯¼è‡´èµ„æºè€—å°½äº†ã€‚\nä¿¡å·é‡éš”ç¦»\nä¿¡å·é‡éš”ç¦»æ˜¯ä½¿ç”¨Semaphoreç±»å®ç°çš„ï¼ˆå¦‚æœä¸äº†è§£ï¼Œå¯ä»¥è§‚çœ‹æœ¬ç³»åˆ— å¹¶å‘ç¼–ç¨‹ç¯‡ è§†é¢‘æ•™ç¨‹ï¼‰ï¼Œæ€æƒ³åŸºæœ¬ä¸Šä¸ä¸Šé¢æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿæ˜¯é™å®šæŒ‡å®šçš„çº¿ç¨‹æ•°é‡èƒ½å¤ŸåŒæ—¶è¿›è¡ŒæœåŠ¡è°ƒç”¨ï¼Œä½†æ˜¯å®ƒç›¸å¯¹äºçº¿ç¨‹æ± éš”ç¦»ï¼Œå¼€é”€ä¼šæ›´å°ä¸€äº›ï¼Œä½¿ç”¨æ•ˆæœåŒæ ·ä¼˜ç§€ï¼Œä¹Ÿæ”¯æŒè¶…æ—¶ç­‰ã€‚\nSentinelä¹Ÿæ­£æ˜¯é‡‡ç”¨çš„è¿™ç§æ–¹æ¡ˆå®ç°éš”ç¦»çš„ã€‚\nå¥½äº†ï¼Œè¯´å›æˆ‘ä»¬çš„ç†”æ–­å’Œé™çº§ï¼Œå½“ä¸‹æ¸¸æœåŠ¡å› ä¸ºæŸç§åŸå› å˜å¾—ä¸å¯ç”¨æˆ–å“åº”è¿‡æ…¢æ—¶ï¼Œä¸Šæ¸¸æœåŠ¡ä¸ºäº†ä¿è¯è‡ªå·±æ•´ä½“æœåŠ¡çš„å¯ç”¨æ€§ï¼Œä¸å†ç»§ç»­è°ƒç”¨ç›®æ ‡æœåŠ¡è€Œæ˜¯å¿«é€Ÿè¿”å›æˆ–æ˜¯æ‰§è¡Œè‡ªå·±çš„æ›¿ä»£æ–¹æ¡ˆï¼Œè¿™ä¾¿æ˜¯æœåŠ¡é™çº§ã€‚\næ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªçŠ¶æ€ï¼š\nå…³é—­ï¼šç†”æ–­å™¨ä¸å·¥ä½œï¼Œæ‰€æœ‰è¯·æ±‚å…¨éƒ¨è¯¥å¹²å˜›å¹²å˜›ã€‚ æ‰“å¼€ï¼šç†”æ–­å™¨å·¥ä½œï¼Œæ‰€æœ‰è¯·æ±‚ä¸€å¾‹é™çº§å¤„ç†ã€‚ åŠå¼€ï¼šå°è¯•è¿›è¡Œä¸€ä¸‹ä¸‹æ­£å¸¸æµç¨‹ï¼Œè¦æ˜¯è¿˜ä¸è¡Œç»§ç»­ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå¦åˆ™å…³é—­ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹Sentinelä¸­å¦‚ä½•è¿›è¡Œç†”æ–­å’Œé™çº§æ“ä½œï¼Œæ‰“å¼€ç®¡ç†é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±æ–°å¢ç†”æ–­è§„åˆ™ï¼š\nå…¶ä¸­ï¼Œç†”æ–­ç­–ç•¥æœ‰ä¸‰ç§æ¨¡å¼ï¼š\næ…¢è°ƒç”¨æ¯”ä¾‹ï¼š å¦‚æœå‡ºç°é‚£ç§åŠå¤©éƒ½å¤„ç†ä¸å®Œçš„è°ƒç”¨ï¼Œæœ‰å¯èƒ½å°±æ˜¯æœåŠ¡å‡ºç°æ•…éšœï¼Œå¯¼è‡´å¡é¡¿ï¼Œè¿™ä¸ªé€‰é¡¹æ˜¯æŒ‰ç…§æœ€å¤§å“åº”æ—¶é—´ï¼ˆRTï¼‰è¿›è¡Œåˆ¤å®šï¼Œå¦‚æœä¸€æ¬¡è¯·æ±‚çš„å¤„ç†æ—¶é—´è¶…è¿‡äº†æŒ‡å®šçš„RTï¼Œé‚£ä¹ˆå°±è¢«åˆ¤å®šä¸ºæ…¢è°ƒç”¨ï¼Œåœ¨ä¸€ä¸ªç»Ÿè®¡æ—¶é•¿å†…ï¼Œå¦‚æœè¯·æ±‚æ•°ç›®å¤§äºæœ€å°è¯·æ±‚æ•°ç›®ï¼Œå¹¶ä¸”è¢«åˆ¤å®šä¸ºæ…¢è°ƒç”¨çš„è¯·æ±‚æ¯”ä¾‹å·²ç»è¶…è¿‡é˜ˆå€¼ï¼Œå°†è§¦å‘ç†”æ–­ã€‚ç»è¿‡ç†”æ–­æ—¶é•¿ä¹‹åï¼Œå°†ä¼šè¿›å…¥åˆ°åŠå¼€çŠ¶æ€è¿›è¡Œè¯•æ¢ï¼ˆè¿™é‡Œå’ŒHystrixä¸€è‡´ï¼‰\nç„¶åä¿®æ”¹ä¸€ä¸‹æ¥å£çš„æ‰§è¡Œï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹æ…¢è°ƒç”¨ï¼š\n@RequestMapping(\u0026#34;/borrow2/{uid}\u0026#34;) UserBorrowDetail findUserBorrows2(@PathVariable(\u0026#34;uid\u0026#34;) int uid) throws InterruptedException { Thread.sleep(1000); return null; } é‡å¯ï¼Œç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ç†”æ–­è§„åˆ™ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œè¶…æ—¶ç›´æ¥è§¦å‘äº†ç†”æ–­ï¼Œè¿›å…¥åˆ°é˜»æ­¢é¡µé¢ï¼š\nå¼‚å¸¸æ¯”ä¾‹ï¼š è¿™ä¸ªä¸æ…¢è°ƒç”¨æ¯”ä¾‹ç±»ä¼¼ï¼Œä¸è¿‡è¿™é‡Œåˆ¤æ–­çš„æ˜¯å‡ºç°å¼‚å¸¸çš„æ¬¡æ•°ï¼Œä¸ä¸Šé¢ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿæ¥è¿›è¡Œä¸€äº›å°æµ‹è¯•ï¼š\n@RequestMapping(\u0026#34;/borrow2/{uid}\u0026#34;) UserBorrowDetail findUserBorrows2(@PathVariable(\u0026#34;uid\u0026#34;) int uid) { throw new RuntimeException(); } å¯åŠ¨æœåŠ¡å™¨ï¼Œæ¥ç€æ·»åŠ æˆ‘ä»¬çš„ç†”æ–­è§„åˆ™ï¼š\nç°åœ¨æˆ‘ä»¬è¿›è¡Œè®¿é—®ï¼Œä¼šå‘ç°åå°ç–¯ç‹‚æŠ¥é”™ï¼Œç„¶åå°±ç†”æ–­äº†ï¼š\nå¼‚å¸¸æ•°ï¼š è¿™ä¸ªå’Œä¸Šé¢çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯ï¼Œåªè¦è¾¾åˆ°æŒ‡å®šçš„å¼‚å¸¸æ•°é‡ï¼Œå°±ç†”æ–­ï¼Œè¿™é‡Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ç†”æ–­è§„åˆ™ï¼š\nç°åœ¨æˆ‘ä»¬å†æ¬¡ä¸æ–­è®¿é—®æ­¤æ¥å£ï¼Œå¯ä»¥å‘ç°ï¼Œæ•ˆæœè·Ÿä¹‹å‰å…¶å®æ˜¯å·®ä¸å¤šçš„ï¼Œåªæ˜¯åˆ¤æ–­çš„ç­–ç•¥ç¨å¾®ä¸åŒç½¢äº†ï¼š\né‚£ä¹ˆç†”æ–­è§„åˆ™å¦‚ä½•è®¾å®šæˆ‘ä»¬äº†è§£äº†ï¼Œé‚£ä¹ˆï¼Œå¦‚ä½•è‡ªå®šä¹‰æœåŠ¡é™çº§å‘¢ï¼Ÿä¹‹å‰åœ¨ä½¿ç”¨Hystrixçš„æ—¶å€™ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„æ›¿ä»£æ–¹æ¡ˆï¼ŒSentinelä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\nåŒæ ·çš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨@SentinelResourceä¸­é…ç½®blockHandlerå‚æ•°ï¼ˆé‚£è¿™é‡Œè·Ÿå‰é¢é‚£ä¸ªæ–¹æ³•é™æµçš„é…ç½®ä¸æ˜¯ä¸€æ¯›ä¸€æ ·å—ï¼Ÿæ²¡é”™ï¼Œå› ä¸ºå¦‚æœæ·»åŠ äº†@SentinelResourceæ³¨è§£ï¼Œé‚£ä¹ˆè¿™é‡Œä¼šè¿›è¡Œæ–¹æ³•çº§åˆ«ç»†ç²’åº¦çš„é™åˆ¶ï¼Œå’Œä¹‹å‰æ–¹æ³•çº§åˆ«é™æµä¸€æ ·ï¼Œä¼šåœ¨é™çº§ä¹‹åç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœä¸æ·»åŠ åˆ™è¿”å›é»˜è®¤çš„é™æµé¡µé¢ï¼ŒblockHandlerçš„ç›®çš„å°±æ˜¯å¤„ç†è¿™ç§Sentinelæœºåˆ¶ä¸Šçš„å¼‚å¸¸ï¼Œæ‰€ä»¥è¿™é‡Œå…¶å®å’Œä¹‹å‰çš„é™æµé…ç½®æ˜¯ä¸€ä¸ªé“ç†ï¼Œå› æ­¤ä¸‹é¢ç†”æ–­é…ç½®ä¹Ÿåº”è¯¥å¯¹valueè‡ªå®šä¹‰åç§°çš„èµ„æºè¿›è¡Œé…ç½®ï¼Œæ‰èƒ½ä½œç”¨åˆ°æ­¤æ–¹æ³•ä¸Šï¼‰ï¼š\n@RequestMapping(\u0026#34;/borrow2/{uid}\u0026#34;) @SentinelResource(value = \u0026#34;findUserBorrows2\u0026#34;, blockHandler = \u0026#34;test\u0026#34;) UserBorrowDetail findUserBorrows2(@PathVariable(\u0026#34;uid\u0026#34;) int uid) { throw new RuntimeException(); } UserBorrowDetail test(int uid, BlockException e){ return new UserBorrowDetail(new User(), Collections.emptyList()); } æ¥ç€æˆ‘ä»¬å¯¹è¿›è¡Œç†”æ–­é…ç½®ï¼Œæ³¨æ„æ˜¯å¯¹æˆ‘ä»¬æ·»åŠ çš„@SentinelResourceä¸­æŒ‡å®šåç§°çš„findUserBorrows2è¿›è¡Œé…ç½®ï¼š\nOKï¼Œå¯ä»¥çœ‹åˆ°ç†”æ–­ä¹‹åï¼ŒæœåŠ¡é™çº§ä¹‹åçš„æ•ˆæœï¼š\næœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•è®©Feignçš„ä¹Ÿæ”¯æŒSentinelï¼Œå‰é¢æˆ‘ä»¬ä½¿ç”¨Hystrixçš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥å¯¹Feignçš„æ¯ä¸ªæ¥å£è°ƒç”¨å•ç‹¬è¿›è¡ŒæœåŠ¡é™çº§ï¼Œè€Œä½¿ç”¨Sentinelï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯æ”¯æŒï¼š\nfeign: sentinel: enabled: true ä¹‹åçš„æ­¥éª¤å…¶å®å’Œä¹‹å‰æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œé¦–å…ˆåˆ›å»ºå®ç°ç±»ï¼š\n@Component public class UserClientFallback implements UserClient{ @Override public User getUserById(int uid) { User user = new User(); user.setName(\u0026#34;æˆ‘æ˜¯æ›¿ä»£æ–¹æ¡ˆ\u0026#34;); return user; } } ç„¶åç›´æ¥å¯åŠ¨å°±å¯ä»¥äº†ï¼Œä¸­é€”çš„æ—¶å€™æˆ‘ä»¬å§ç”¨æˆ·æœåŠ¡å…¨éƒ¨ä¸‹æ‰ï¼Œå¯ä»¥çœ‹åˆ°æ­£å¸¸ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆï¼š\nè¿™æ ·Feignçš„é…ç½®å°±OKäº†ï¼Œé‚£ä¹ˆä¼ ç»Ÿçš„RestTemplateå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@SentinelRestTemplateæ³¨è§£å®ç°ï¼š\n@Bean @LoadBalanced @SentinelRestTemplate(blockHandler = \u0026#34;handleException\u0026#34;, blockHandlerClass = ExceptionUtil.class, fallback = \u0026#34;fallback\u0026#34;, fallbackClass = ExceptionUtil.class) //è¿™é‡ŒåŒæ ·å¯ä»¥è®¾å®šfallbackç­‰å‚æ•° public RestTemplate restTemplate() { return new RestTemplate(); } è¿™é‡Œå°±ä¸å¤šåšèµ˜è¿°äº†ã€‚\nSeataä¸åˆ†å¸ƒå¼äº‹åŠ¡ #\ré‡éš¾ç‚¹å†…å®¹ï¼Œå‘ä¹Ÿå¤šå¾—ç¦»è°±ï¼Œæœ€å¥½ä¿æŒè·ŸUPä¸€æ ·çš„ç‰ˆæœ¬ï¼Œå®˜æ–¹æ–‡æ¡£ï¼š https://seata.io/zh-cn/docs/overview/what-is-seata.html\nåœ¨å‰é¢çš„é˜¶æ®µä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ è¿‡äº‹åŠ¡ï¼Œè¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰è°ˆåˆ°çš„æ•°æ®åº“äº‹åŠ¡çš„ç‰¹æ€§å—ï¼Ÿ\nåŸå­æ€§ï¼š ä¸€ä¸ªäº‹åŠ¡ï¼ˆtransactionï¼‰ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼Œä¸ä¼šç»“æŸåœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œä¼šè¢«å›æ»šï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ä¸€æ ·ã€‚ ä¸€è‡´æ€§ï¼š åœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ²¡æœ‰è¢«ç ´åã€‚è¿™è¡¨ç¤ºå†™å…¥çš„èµ„æ–™å¿…é¡»å®Œå…¨ç¬¦åˆæ‰€æœ‰çš„é¢„è®¾è§„åˆ™ï¼Œè¿™åŒ…å«èµ„æ–™çš„ç²¾ç¡®åº¦ã€ä¸²è”æ€§ä»¥åŠåç»­æ•°æ®åº“å¯ä»¥è‡ªå‘æ€§åœ°å®Œæˆé¢„å®šçš„å·¥ä½œã€‚ éš”ç¦»æ€§ï¼š æ•°æ®åº“å…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹å…¶æ•°æ®è¿›è¡Œè¯»å†™å’Œä¿®æ”¹çš„èƒ½åŠ›ï¼Œéš”ç¦»æ€§å¯ä»¥é˜²æ­¢å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ç”±äºäº¤å‰æ‰§è¡Œè€Œå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚äº‹åŠ¡éš”ç¦»åˆ†ä¸ºä¸åŒçº§åˆ«ï¼ŒåŒ…æ‹¬è¯»æœªæäº¤ï¼ˆRead uncommittedï¼‰ã€è¯»å·²æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ã€‚ æŒä¹…æ€§ï¼š äº‹åŠ¡å¤„ç†ç»“æŸåï¼Œå¯¹æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…çš„ï¼Œå³ä¾¿ç³»ç»Ÿæ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ é‚£ä¹ˆå„ä½è¯•æƒ³ä¸€ä¸‹ï¼Œåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œæœ‰å¯èƒ½å‡ºç°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸‹å•è´­ç‰©ï¼Œé‚£ä¹ˆæ•´ä¸ªæµç¨‹å¯èƒ½æ˜¯è¿™æ ·çš„ï¼šå…ˆè°ƒç”¨åº“å­˜æœåŠ¡å¯¹åº“å­˜è¿›è¡Œå‡æ‰£ -\u0026gt; ç„¶åè®¢å•æœåŠ¡å¼€å§‹ä¸‹å• -\u0026gt; æœ€åç”¨æˆ·è´¦æˆ·æœåŠ¡è¿›è¡Œæ‰£æ¬¾ï¼Œè™½ç„¶çœ‹ä¼¼æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ä¸€ä¸ªæµç¨‹ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰äº‹åŠ¡çš„åŠ æŒï¼Œå¾ˆæœ‰å¯èƒ½ä¼šç”±äºä¸­é€”å‡ºé”™ï¼Œæ¯”å¦‚æ•´ä¸ªæµç¨‹ä¸­è®¢å•æœåŠ¡å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´åº“å­˜æ‰£äº†ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ä¸ªè®¢å•å¹¶æ²¡æœ‰ç”Ÿæˆï¼Œç”¨æˆ·ä¹Ÿæ²¡æœ‰ä»˜æ¬¾ã€‚\nä¸Šé¢è¿™ç§æƒ…å†µæ—¶é—´å°±æ˜¯ä¸€ç§å¤šæœåŠ¡å¤šæ•°æ®æºçš„åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å‹ï¼ˆæ¯”è¾ƒå¸¸è§ï¼‰ï¼Œå› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±å¾—å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè®©è¿™æ•´ä¸ªæµç¨‹ä¿è¯åŸå­æ€§ã€‚\nSpringCloud Alibabaä¸ºæˆ‘ä»¬æä¾›äº†ç”¨äºå¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„ç»„ä»¶Seataã€‚\nSeata æ˜¯ä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œè‡´åŠ›äºæä¾›é«˜æ€§èƒ½å’Œç®€å•æ˜“ç”¨çš„åˆ†å¸ƒå¼äº‹åŠ¡æœåŠ¡ã€‚Seata å°†ä¸ºç”¨æˆ·æä¾›äº† ATã€TCCã€SAGA å’Œ XA äº‹åŠ¡æ¨¡å¼ï¼Œä¸ºç”¨æˆ·æ‰“é€ ä¸€ç«™å¼çš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆã€‚\nå®é™…ä¸Šï¼Œå°±æ˜¯å¤šäº†ä¸€ä¸ªä¸­é—´äººæ¥åè°ƒæ‰€æœ‰æœåŠ¡çš„äº‹åŠ¡ã€‚\né¡¹ç›®ç¯å¢ƒæ­å»º #\rè¿™é‡Œæˆ‘ä»¬å¯¹æˆ‘ä»¬ä¹‹å‰çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿè¿›è¡Œå‡çº§ï¼š\næ¯ä¸ªç”¨æˆ·æœ€å¤šåªèƒ½åŒæ—¶å€Ÿé˜…2æœ¬ä¸åŒçš„ä¹¦ã€‚ å›¾ä¹¦é¦†ä¸­æ‰€æœ‰çš„ä¹¦éƒ½æœ‰3æœ¬ã€‚ ç”¨æˆ·å€Ÿä¹¦æµç¨‹ï¼šå…ˆè°ƒç”¨å›¾ä¹¦æœåŠ¡ä¹¦ç±æ•°é‡-1 -\u0026gt; æ·»åŠ å€Ÿé˜…è®°å½• -\u0026gt; è°ƒç”¨ç”¨æˆ·æœåŠ¡ç”¨æˆ·å¯å€Ÿé˜…æ•°é‡-1 é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬å¯¹æ•°æ®åº“è¿›è¡Œä¿®æ”¹ï¼Œè¿™é‡Œä¸ºäº†ç®€ä¾¿ï¼Œå°±ç›´æ¥åœ¨ç”¨æˆ·è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µç”¨äºå­˜å‚¨ç”¨æˆ·èƒ½å¤Ÿå€Ÿé˜…çš„ä¹¦ç±æ•°é‡ï¼š\nç„¶åä¿®æ”¹ä¹¦ç±ä¿¡æ¯ï¼Œä¹Ÿæ˜¯ç›´æ¥æ·»åŠ ä¸€ä¸ªå­—æ®µç”¨äºè®°å½•å‰©ä½™æ•°é‡ï¼š\næ¥ç€æˆ‘ä»¬å»ç¼–å†™ä¸€ä¸‹å¯¹åº”çš„æœåŠ¡å§ï¼Œé¦–å…ˆæ˜¯ç”¨æˆ·æœåŠ¡ï¼š\n@Mapper public interface UserMapper { @Select(\u0026#34;select * from DB_USER where uid = #{uid}\u0026#34;) User getUserById(int uid); @Select(\u0026#34;select book_count from DB_USER where uid = #{uid}\u0026#34;) int getUserBookRemain(int uid); @Update(\u0026#34;update DB_USER set book_count = #{count} where uid = #{uid}\u0026#34;) int updateBookCount(int uid, int count); } @Service public class UserServiceImpl implements UserService { @Resource UserMapper mapper; @Override public User getUserById(int uid) { return mapper.getUserById(uid); } @Override public int getRemain(int uid) { return mapper.getUserBookRemain(uid); } @Override public boolean setRemain(int uid, int count) { return mapper.updateBookCount(uid, count) \u0026gt; 0; } } @RestController public class UserController { @Resource UserService service; @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) public User findUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserById(uid); } @RequestMapping(\u0026#34;/user/remain/{uid}\u0026#34;) public int userRemain(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getRemain(uid); } @RequestMapping(\u0026#34;/user/borrow/{uid}\u0026#34;) public boolean userBorrow(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ int remain = service.getRemain(uid); return service.setRemain(uid, remain - 1); } } ç„¶åæ˜¯å›¾ä¹¦æœåŠ¡ï¼Œå…¶å®è·Ÿç”¨æˆ·æœåŠ¡å·®ä¸å¤šï¼š\n@Mapper public interface BookMapper { @Select(\u0026#34;select * from DB_BOOK where bid = #{bid}\u0026#34;) Book getBookById(int bid); @Select(\u0026#34;select count from DB_BOOK where bid = #{bid}\u0026#34;) int getRemain(int bid); @Update(\u0026#34;update DB_BOOK set count = #{count} where bid = #{bid}\u0026#34;) int setRemain(int bid, int count); } @Service public class BookServiceImpl implements BookService { @Resource BookMapper mapper; @Override public Book getBookById(int bid) { return mapper.getBookById(bid); } @Override public boolean setRemain(int bid, int count) { return mapper.setRemain(bid, count) \u0026gt; 0; } @Override public int getRemain(int bid) { return mapper.getRemain(bid); } } @RestController public class BookController { @Resource BookService service; @RequestMapping(\u0026#34;/book/{bid}\u0026#34;) Book findBookById(@PathVariable(\u0026#34;bid\u0026#34;) int bid){ return service.getBookById(bid); } @RequestMapping(\u0026#34;/book/remain/{bid}\u0026#34;) public int bookRemain(@PathVariable(\u0026#34;bid\u0026#34;) int uid){ return service.getRemain(uid); } @RequestMapping(\u0026#34;/book/borrow/{bid}\u0026#34;) public boolean bookBorrow(@PathVariable(\u0026#34;bid\u0026#34;) int uid){ int remain = service.getRemain(uid); return service.setRemain(uid, remain - 1); } } æœ€åå®Œå–„æˆ‘ä»¬çš„å€Ÿé˜…æœåŠ¡ï¼š\n@FeignClient(value = \u0026#34;userservice\u0026#34;) public interface UserClient { @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) User getUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid); @RequestMapping(\u0026#34;/user/borrow/{uid}\u0026#34;) boolean userBorrow(@PathVariable(\u0026#34;uid\u0026#34;) int uid); @RequestMapping(\u0026#34;/user/remain/{uid}\u0026#34;) int userRemain(@PathVariable(\u0026#34;uid\u0026#34;) int uid); } @FeignClient(\u0026#34;bookservice\u0026#34;) public interface BookClient { @RequestMapping(\u0026#34;/book/{bid}\u0026#34;) Book getBookById(@PathVariable(\u0026#34;bid\u0026#34;) int bid); @RequestMapping(\u0026#34;/book/borrow/{bid}\u0026#34;) boolean bookBorrow(@PathVariable(\u0026#34;bid\u0026#34;) int bid); @RequestMapping(\u0026#34;/book/remain/{bid}\u0026#34;) int bookRemain(@PathVariable(\u0026#34;bid\u0026#34;) int bid); } @RestController public class BorrowController { @Resource BorrowService service; @RequestMapping(\u0026#34;/borrow/{uid}\u0026#34;) UserBorrowDetail findUserBorrows(@PathVariable(\u0026#34;uid\u0026#34;) int uid){ return service.getUserBorrowDetailByUid(uid); } @RequestMapping(\u0026#34;/borrow/take/{uid}/{bid}\u0026#34;) JSONObject borrow(@PathVariable(\u0026#34;uid\u0026#34;) int uid, @PathVariable(\u0026#34;bid\u0026#34;) int bid){ service.doBorrow(uid, bid); JSONObject object = new JSONObject(); object.put(\u0026#34;code\u0026#34;, \u0026#34;200\u0026#34;); object.put(\u0026#34;success\u0026#34;, false); object.put(\u0026#34;message\u0026#34;, \u0026#34;å€Ÿé˜…æˆåŠŸï¼\u0026#34;); return object; } } @Service public class BorrowServiceImpl implements BorrowService{ @Resource BorrowMapper mapper; @Resource UserClient userClient; @Resource BookClient bookClient; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); User user = userClient.getUserById(uid); List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; bookClient.getBookById(b.getBid())) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } @Override public boolean doBorrow(int uid, int bid) { //1. åˆ¤æ–­å›¾ä¹¦å’Œç”¨æˆ·æ˜¯å¦éƒ½æ”¯æŒå€Ÿé˜… if(bookClient.bookRemain(bid) \u0026lt; 1) throw new RuntimeException(\u0026#34;å›¾ä¹¦æ•°é‡ä¸è¶³\u0026#34;); if(userClient.userRemain(uid) \u0026lt; 1) throw new RuntimeException(\u0026#34;ç”¨æˆ·å€Ÿé˜…é‡ä¸è¶³\u0026#34;); //2. é¦–å…ˆå°†å›¾ä¹¦çš„æ•°é‡-1 if(!bookClient.bookBorrow(bid)) throw new RuntimeException(\u0026#34;åœ¨å€Ÿé˜…å›¾ä¹¦æ—¶å‡ºç°é”™è¯¯ï¼\u0026#34;); //3. æ·»åŠ å€Ÿé˜…ä¿¡æ¯ if(mapper.getBorrow(uid, bid) != null) throw new RuntimeException(\u0026#34;æ­¤ä¹¦ç±å·²ç»è¢«æ­¤ç”¨æˆ·å€Ÿé˜…äº†ï¼\u0026#34;); if(mapper.addBorrow(uid, bid) \u0026lt;= 0) throw new RuntimeException(\u0026#34;åœ¨å½•å…¥å€Ÿé˜…ä¿¡æ¯æ—¶å‡ºç°é”™è¯¯ï¼\u0026#34;); //4. ç”¨æˆ·å¯å€Ÿé˜…-1 if(!userClient.userBorrow(uid)) throw new RuntimeException(\u0026#34;åœ¨å€Ÿé˜…æ—¶å‡ºç°é”™è¯¯ï¼\u0026#34;); //å®Œæˆ return true; } } è¿™æ ·ï¼Œåªè¦æˆ‘ä»¬çš„å›¾ä¹¦å€Ÿé˜…è¿‡ç¨‹ä¸­ä»»ä½•ä¸€æ­¥å‡ºç°é—®é¢˜ï¼Œéƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\næˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\nå†æ¬¡å°è¯•å€Ÿé˜…ï¼Œåå°ä¼šç›´æ¥æŠ¥é”™ï¼š\næŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå€Ÿé˜…ä¿¡æ¯æ·»åŠ å¤±è´¥äº†ï¼Œä½†æ˜¯å›¾ä¹¦çš„æ•°é‡ä¾ç„¶è¢«-1ï¼Œä¹Ÿå°±æ˜¯è¯´æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯å¸Œæœ›ä¸­é€”å‡ºç°å¼‚å¸¸ä¹‹åï¼Œä¹‹å‰çš„æ“ä½œå…¨éƒ¨å›æ»šçš„ï¼š\nè€Œè¿™é‡Œç”±äºæ˜¯åœ¨å¦ä¸€ä¸ªæœåŠ¡ä¸­è¿›è¡Œçš„æ•°æ®åº“æ“ä½œï¼Œæ‰€ä»¥ä¼ ç»Ÿçš„@Transactionalæ³¨è§£æ— æ•ˆï¼Œè¿™æ—¶å°±å¾—å€ŸåŠ©Seataæä¾›åˆ†å¸ƒå¼äº‹åŠ¡äº†ã€‚\nåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ #\rè¦å¼€å§‹å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæˆ‘ä»¬å¾—å…ˆä»ç†è®ºä¸Šå¼€å§‹ä¸‹æ‰‹ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å¸¸ç”¨çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚\nXAåˆ†å¸ƒå¼äº‹åŠ¡åè®® - 2PCï¼ˆä¸¤é˜¶æ®µæäº¤å®ç°ï¼‰\nè¿™é‡Œçš„PCå®é™…ä¸ŠæŒ‡çš„æ˜¯Prepareå’ŒCommitï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œä¸€ä¸ªæ˜¯å‡†å¤‡ä¸€ä¸ªæ˜¯æäº¤ï¼Œæ•´ä¸ªè¿‡ç¨‹çš„å‚ä¸è€…ä¸€å…±æœ‰ä¸¤ä¸ªè§’è‰²ï¼Œä¸€ä¸ªæ˜¯äº‹åŠ¡çš„æ‰§è¡Œè€…ï¼Œä¸€ä¸ªæ˜¯äº‹åŠ¡çš„åè°ƒè€…ï¼Œå®é™…ä¸Šæ•´ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„è¿ä½œéƒ½éœ€è¦ä¾é åè°ƒè€…æ¥ç»´æŒï¼š\nåœ¨å‡†å¤‡å’Œæäº¤é˜¶æ®µï¼Œä¼šè¿›è¡Œï¼š\nå‡†å¤‡é˜¶æ®µï¼š\nä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡æ˜¯ç”±åè°ƒè€…æ¥å¼€å¯çš„ï¼Œé¦–å…ˆåè°ƒè€…ä¼šå‘æ‰€æœ‰çš„äº‹åŠ¡æ‰§è¡Œè€…å‘é€äº‹åŠ¡å†…å®¹ï¼Œç­‰å¾…æ‰€æœ‰çš„äº‹åŠ¡æ‰§è¡Œè€…ç­”å¤ã€‚\nå„ä¸ªäº‹åŠ¡æ‰§è¡Œè€…å¼€å§‹æ‰§è¡Œäº‹åŠ¡æ“ä½œï¼Œä½†æ˜¯ä¸è¿›è¡Œæäº¤ï¼Œå¹¶å°†undoå’Œredoä¿¡æ¯è®°å½•åˆ°äº‹åŠ¡æ—¥å¿—ä¸­ã€‚\nå¦‚æœäº‹åŠ¡æ‰§è¡Œè€…æ‰§è¡Œäº‹åŠ¡æˆåŠŸï¼Œé‚£ä¹ˆå°±å‘Šè¯‰åè°ƒè€…æˆåŠŸYesï¼Œå¦åˆ™å‘Šè¯‰åè°ƒè€…å¤±è´¥Noï¼Œä¸èƒ½æäº¤äº‹åŠ¡ã€‚\næäº¤é˜¶æ®µï¼š\nå½“æ‰€æœ‰çš„æ‰§è¡Œè€…éƒ½åé¦ˆå®Œæˆä¹‹åï¼Œè¿›å…¥ç¬¬äºŒé˜¶æ®µã€‚\nåè°ƒè€…ä¼šæ£€æŸ¥å„ä¸ªæ‰§è¡Œè€…çš„åé¦ˆå†…å®¹ï¼Œå¦‚æœæ‰€æœ‰çš„æ‰§è¡Œè€…éƒ½è¿”å›æˆåŠŸï¼Œé‚£ä¹ˆå°±å‘Šè¯‰æ‰€æœ‰çš„æ‰§è¡Œè€…å¯ä»¥æäº¤äº‹åŠ¡äº†ï¼Œæœ€åå†é‡Šæ”¾é”èµ„æºã€‚\nå¦‚æœæœ‰è‡³å°‘ä¸€ä¸ªæ‰§è¡Œè€…è¿”å›å¤±è´¥æˆ–æ˜¯è¶…æ—¶ï¼Œé‚£ä¹ˆå°±è®©æ‰€æœ‰çš„æ‰§è¡Œè€…éƒ½å›æ»šï¼Œåˆ†å¸ƒå¼äº‹åŠ¡æ‰§è¡Œå¤±è´¥ã€‚\nè™½ç„¶è¿™ç§æ–¹å¼çœ‹èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š\näº‹åŠ¡åè°ƒè€…æ˜¯éå¸¸æ ¸å¿ƒçš„è§’è‰²ï¼Œä¸€æ—¦å‡ºç°é—®é¢˜ï¼Œå°†å¯¼è‡´æ•´ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ä¸èƒ½æ­£å¸¸è¿è¡Œã€‚ å¦‚æœæäº¤é˜¶æ®µå‘ç”Ÿç½‘ç»œé—®é¢˜ï¼Œå¯¼è‡´æŸäº›äº‹åŠ¡æ‰§è¡Œè€…æ²¡æœ‰æ”¶åˆ°åè°ƒè€…å‘æ¥çš„æäº¤å‘½ä»¤ï¼Œå°†å¯¼è‡´æŸäº›æ‰§è¡Œè€…æäº¤æŸäº›æ‰§è¡Œè€…æ²¡æäº¤ï¼Œè¿™æ ·è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚ XAåˆ†å¸ƒå¼äº‹åŠ¡åè®® - 3PCï¼ˆä¸‰é˜¶æ®µæäº¤å®ç°ï¼‰\nä¸‰é˜¶æ®µæäº¤æ˜¯åœ¨äºŒé˜¶æ®µæäº¤åŸºç¡€ä¸Šçš„æ”¹è¿›ç‰ˆæœ¬ï¼Œä¸»è¦æ˜¯åŠ å…¥äº†è¶…æ—¶æœºåˆ¶ï¼ŒåŒæ—¶åœ¨åè°ƒè€…å’Œæ‰§è¡Œè€…ä¸­éƒ½å¼•å…¥äº†è¶…æ—¶æœºåˆ¶ã€‚\nä¸‰ä¸ªé˜¶æ®µåˆ†åˆ«è¿›è¡Œï¼š\nCanCommité˜¶æ®µï¼š\nåè°ƒè€…å‘æ‰§è¡Œè€…å‘é€CanCommitè¯·æ±‚ï¼Œè¯¢é—®æ˜¯å¦å¯ä»¥æ‰§è¡Œäº‹åŠ¡æäº¤æ“ä½œï¼Œç„¶åå¼€å§‹ç­‰å¾…æ‰§è¡Œè€…çš„å“åº”ã€‚\næ‰§è¡Œè€…æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœå…¶è‡ªèº«è®¤ä¸ºå¯ä»¥é¡ºåˆ©æ‰§è¡Œäº‹åŠ¡ï¼Œåˆ™è¿”å›Yeså“åº”ï¼Œå¹¶è¿›å…¥é¢„å¤‡çŠ¶æ€ï¼Œå¦åˆ™è¿”å›No\nPreCommité˜¶æ®µï¼š\nåè°ƒè€…æ ¹æ®æ‰§è¡Œè€…çš„ååº”æƒ…å†µæ¥å†³å®šæ˜¯å¦å¯ä»¥è¿›å…¥ç¬¬äºŒé˜¶æ®µäº‹åŠ¡çš„PreCommitæ“ä½œã€‚\nå¦‚æœæ‰€æœ‰çš„æ‰§è¡Œè€…éƒ½è¿”å›Yesï¼Œåˆ™åè°ƒè€…å‘æ‰€æœ‰æ‰§è¡Œè€…å‘é€PreCommitè¯·æ±‚ï¼Œå¹¶è¿›å…¥Preparedé˜¶æ®µï¼Œæ‰§è¡Œè€…æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šæ‰§è¡Œäº‹åŠ¡æ“ä½œï¼Œå¹¶å°†undoå’Œredoä¿¡æ¯è®°å½•åˆ°äº‹åŠ¡æ—¥å¿—ä¸­ï¼Œå¦‚æœæˆåŠŸæ‰§è¡Œï¼Œåˆ™è¿”å›æˆåŠŸå“åº”ã€‚\nå¦‚æœæ‰€æœ‰çš„æ‰§è¡Œè€…è‡³å°‘æœ‰ä¸€ä¸ªè¿”å›Noï¼Œåˆ™åè°ƒè€…å‘æ‰€æœ‰æ‰§è¡Œè€…å‘é€abortè¯·æ±‚ï¼Œæ‰€æœ‰çš„æ‰§è¡Œè€…åœ¨æ”¶åˆ°è¯·æ±‚æˆ–æ˜¯è¶…è¿‡ä¸€æ®µæ—¶é—´æ²¡æœ‰æ”¶åˆ°ä»»ä½•è¯·æ±‚æ—¶ï¼Œä¼šç›´æ¥ä¸­æ–­äº‹åŠ¡ã€‚\nDoCommité˜¶æ®µï¼š\nè¯¥é˜¶æ®µè¿›è¡ŒçœŸæ­£çš„äº‹åŠ¡æäº¤ã€‚\nåè°ƒè€…æ¥æ”¶åˆ°æ‰€æœ‰æ‰§è¡Œè€…å‘é€çš„æˆåŠŸå“åº”ï¼Œé‚£ä¹ˆä»–å°†ä»PreCommitçŠ¶æ€è¿›å…¥åˆ°DoCommitçŠ¶æ€ï¼Œå¹¶å‘æ‰€æœ‰æ‰§è¡Œè€…å‘é€doCommitè¯·æ±‚ï¼Œæ‰§è¡Œè€…æ¥æ”¶åˆ°doCommitè¯·æ±‚ä¹‹åï¼Œå¼€å§‹æ‰§è¡Œäº‹åŠ¡æäº¤ï¼Œå¹¶åœ¨å®Œæˆäº‹åŠ¡æäº¤ä¹‹åé‡Šæ”¾æ‰€æœ‰äº‹åŠ¡èµ„æºï¼Œå¹¶æœ€åå‘åè°ƒè€…å‘é€ç¡®è®¤å“åº”ï¼Œåè°ƒè€…æ¥æ”¶åˆ°æ‰€æœ‰æ‰§è¡Œè€…çš„ç¡®è®¤å“åº”ä¹‹åï¼Œå®Œæˆäº‹åŠ¡ï¼ˆå¦‚æœå› ä¸ºç½‘ç»œé—®é¢˜å¯¼è‡´æ‰§è¡Œè€…æ²¡æœ‰æ”¶åˆ°doCommitè¯·æ±‚ï¼Œæ‰§è¡Œè€…ä¼šåœ¨è¶…æ—¶ä¹‹åç›´æ¥æäº¤äº‹åŠ¡ï¼Œè™½ç„¶æ‰§è¡Œè€…åªæ˜¯çŒœæµ‹åè°ƒè€…è¿”å›çš„æ˜¯doCommitè¯·æ±‚ï¼Œä½†æ˜¯å› ä¸ºå‰é¢çš„ä¸¤ä¸ªæµç¨‹éƒ½æ­£å¸¸æ‰§è¡Œï¼Œæ‰€ä»¥èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šè®¤ä¸ºæœ¬æ¬¡äº‹åŠ¡æ˜¯æˆåŠŸçš„ï¼Œå› æ­¤ä¼šç›´æ¥æäº¤ï¼‰\nåè°ƒè€…æ²¡æœ‰æ¥æ”¶è‡³å°‘ä¸€ä¸ªæ‰§è¡Œè€…å‘é€çš„æˆåŠŸå“åº”ï¼ˆä¹Ÿå¯èƒ½æ˜¯å“åº”è¶…æ—¶ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œä¸­æ–­äº‹åŠ¡ï¼Œåè°ƒè€…ä¼šå‘æ‰€æœ‰æ‰§è¡Œè€…å‘é€abortè¯·æ±‚ï¼Œæ‰§è¡Œè€…æ¥æ”¶åˆ°abortè¯·æ±‚ä¹‹åï¼Œåˆ©ç”¨å…¶åœ¨PreCommité˜¶æ®µè®°å½•çš„undoä¿¡æ¯æ¥æ‰§è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œï¼Œå¹¶åœ¨å®Œæˆå›æ»šä¹‹åé‡Šæ”¾æ‰€æœ‰çš„äº‹åŠ¡èµ„æºï¼Œæ‰§è¡Œè€…å®Œæˆäº‹åŠ¡å›æ»šä¹‹åï¼Œå‘åè°ƒè€…å‘é€ç¡®è®¤æ¶ˆæ¯ï¼Œ åè°ƒè€…æ¥æ”¶åˆ°å‚ä¸è€…åé¦ˆçš„ç¡®è®¤æ¶ˆæ¯ä¹‹åï¼Œæ‰§è¡Œäº‹åŠ¡çš„ä¸­æ–­ã€‚\nç›¸æ¯”ä¸¤é˜¶æ®µæäº¤ï¼Œä¸‰é˜¶æ®µæäº¤çš„ä¼˜åŠ¿æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå½“ç„¶ä¹Ÿæœ‰ç¼ºç‚¹ï¼š\n3PCåœ¨2PCçš„ç¬¬ä¸€é˜¶æ®µå’Œç¬¬äºŒé˜¶æ®µä¸­æ’å…¥ä¸€ä¸ªå‡†å¤‡é˜¶æ®µï¼Œä¿è¯äº†åœ¨æœ€åæäº¤é˜¶æ®µä¹‹å‰å„å‚ä¸èŠ‚ç‚¹çš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ã€‚ ä¸€æ—¦å‚ä¸è€…æ— æ³•åŠæ—¶æ”¶åˆ°æ¥è‡ªåè°ƒè€…çš„ä¿¡æ¯ä¹‹åï¼Œä¼šé»˜è®¤æ‰§è¡ŒCommitï¼Œè¿™æ ·å°±ä¸ä¼šå› ä¸ºåè°ƒè€…å•æ–¹é¢çš„æ•…éšœå¯¼è‡´å…¨å±€å‡ºç°é—®é¢˜ã€‚ ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œå®é™…ä¸Šè¶…æ—¶ä¹‹åçš„Commitå†³ç­–æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªèµŒæ³¨ç½¢äº†ï¼Œå¦‚æœæ­¤æ—¶åè°ƒè€…å‘é€çš„æ˜¯abortè¯·æ±‚ä½†æ˜¯è¶…æ—¶æœªæ¥æ”¶ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥å¯¼è‡´æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚ TCCï¼ˆè¡¥å¿äº‹åŠ¡ï¼‰\nè¡¥å¿äº‹åŠ¡TCCå°±æ˜¯Tryã€Confirmã€Cancelï¼Œå®ƒå¯¹ä¸šåŠ¡æœ‰ä¾µå…¥æ€§ï¼Œä¸€å…±åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬ä¾æ¬¡æ¥è§£è¯»ä¸€ä¸‹ã€‚\nTryé˜¶æ®µï¼š\næ¯”å¦‚æˆ‘ä»¬éœ€è¦åœ¨å€Ÿä¹¦æ—¶ï¼Œå°†ä¹¦ç±çš„åº“å­˜-1ï¼Œå¹¶ä¸”ç”¨æˆ·çš„å€Ÿé˜…é‡ä¹Ÿ-1ï¼Œä½†æ˜¯è¿™ä¸ªæ“ä½œï¼Œé™¤äº†ç›´æ¥å¯¹åº“å­˜å’Œå€Ÿé˜…é‡è¿›è¡Œä¿®æ”¹ä¹‹å¤–ï¼Œè¿˜éœ€è¦å°†å‡å»çš„å€¼ï¼Œå•ç‹¬å­˜æ”¾åˆ°å†»ç»“è¡¨ä¸­ï¼Œä½†æ˜¯æ­¤æ—¶ä¸ä¼šåˆ›å»ºå€Ÿé˜…ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´åªæ˜¯é¢„å…ˆæŠŠå…³é”®çš„ä¸œè¥¿ç»™å¤„ç†äº†ï¼Œé¢„ç•™ä¸šåŠ¡èµ„æºå‡ºæ¥ã€‚\nConfirmé˜¶æ®µï¼š\nå¦‚æœTryæ‰§è¡ŒæˆåŠŸæ— è¯¯ï¼Œé‚£ä¹ˆå°±è¿›å…¥åˆ°Confirmé˜¶æ®µï¼Œæ¥ç€ä¹‹å‰ï¼Œæˆ‘ä»¬å°±è¯¥åˆ›å»ºå€Ÿé˜…ä¿¡æ¯äº†ï¼Œåªèƒ½ä½¿ç”¨Tryé˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æºï¼Œå¦‚æœåˆ›å»ºæˆåŠŸï¼Œé‚£ä¹ˆå°±å¯¹Tryé˜¶æ®µå†»ç»“çš„å€¼ï¼Œè¿›è¡Œè§£å†»ï¼Œæ•´ä¸ªæµç¨‹å°±å®Œæˆäº†ã€‚å½“ç„¶ï¼Œå¦‚æœå¤±è´¥äº†ï¼Œé‚£ä¹ˆè¿›å…¥åˆ°Cancelé˜¶æ®µã€‚\nCancelé˜¶æ®µï¼š\nä¸ç”¨çŒœäº†ï¼Œé‚£è‚¯å®šæ˜¯æŠŠå†»ç»“çš„ä¸œè¥¿è¿˜ç»™äººå®¶ï¼Œå› ä¸ºæ•´ä¸ªå€Ÿé˜…æ“ä½œå‹æ ¹å°±æ²¡æˆåŠŸã€‚å°±åƒä½ ä»˜äº†æ¬¾ä¹°äº†ä¸œè¥¿ä½†æ˜¯ç½‘ç»œé—®é¢˜ï¼Œå¯¼è‡´äº¤æ˜“å¤±è´¥ï¼Œé’±ä¸å¯èƒ½ä¸è¿˜ç»™ä½ å§ã€‚\nè·ŸXAåè®®ç›¸æ¯”ï¼ŒTCCå°±æ²¡æœ‰åè°ƒè€…è¿™ä¸€è§’è‰²çš„å‚ä¸äº†ï¼Œè€Œæ˜¯è‡ªä¸»é€šè¿‡ä¸Šä¸€é˜¶æ®µçš„æ‰§è¡Œæƒ…å†µæ¥ç¡®ä¿æ­£å¸¸ï¼Œå……åˆ†åˆ©ç”¨äº†é›†ç¾¤çš„ä¼˜åŠ¿ï¼Œæ€§èƒ½ä¹Ÿæ˜¯æœ‰å¾ˆå¤§çš„æå‡ã€‚ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå®ƒä¸ä¸šåŠ¡å…·æœ‰ä¸€å®šçš„å…³è”æ€§ï¼Œéœ€è¦å¼€å‘è€…å»ç¼–å†™æ›´å¤šçš„è¡¥å¿ä»£ç ï¼ŒåŒæ—¶å¹¶ä¸ä¸€å®šæ‰€æœ‰çš„ä¸šåŠ¡æµç¨‹éƒ½é€‚ç”¨äºè¿™ç§å½¢å¼ã€‚\nSeataæœºåˆ¶ç®€ä»‹ #\rå‰é¢æˆ‘ä»¬äº†è§£äº†ä¸€äº›åˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Seataæ˜¯å¦‚ä½•è¿›è¡Œåˆ†å¸ƒå¼äº‹åŠ¡çš„å¤„ç†çš„ã€‚\nå®˜ç½‘ç»™å‡ºçš„æ˜¯è¿™æ ·çš„ä¸€ä¸ªæ¶æ„å›¾ï¼Œé‚£ä¹ˆå›¾ä¸­çš„RMã€TMã€TCä»£è¡¨ç€ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ\nRMï¼ˆResource Managerï¼‰ï¼šç”¨äºç›´æ¥æ‰§è¡Œæœ¬åœ°äº‹åŠ¡çš„æäº¤å’Œå›æ»šã€‚ TMï¼ˆTransaction Managerï¼‰ï¼šTMæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡çš„æ ¸å¿ƒç®¡ç†è€…ã€‚æ¯”å¦‚ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨å€Ÿé˜…æœåŠ¡ä¸­å¼€å¯å…¨å±€äº‹åŠ¡ï¼Œæ¥è®©å…¶è‡ªèº«ã€å›¾ä¹¦æœåŠ¡ã€ç”¨æˆ·æœåŠ¡éƒ½å‚ä¸è¿›æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€èˆ¬å…¨å±€äº‹åŠ¡å‘èµ·è€…å°±æ˜¯TMã€‚ TCï¼ˆTransaction Managerï¼‰è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„SeataæœåŠ¡å™¨ï¼Œç”¨äºå…¨å±€æ§åˆ¶ï¼Œæ¯”å¦‚åœ¨XAæ¨¡å¼ä¸‹å°±æ˜¯ä¸€ä¸ªåè°ƒè€…çš„è§’è‰²ï¼Œè€Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„å¯åŠ¨å°±æ˜¯ç”±TMå‘TCå‘èµ·è¯·æ±‚ï¼ŒTCå†æ¥ä¸å…¶ä»–çš„RMè¿›è¡Œåè°ƒæ“ä½œã€‚ TMè¯·æ±‚TCå¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼ŒTCä¼šç”Ÿæˆä¸€ä¸ªXIDä½œä¸ºè¯¥å…¨å±€äº‹åŠ¡çš„ç¼–å·ï¼ŒXIDä¼šåœ¨å¾®æœåŠ¡çš„è°ƒç”¨é“¾è·¯ä¸­ä¼ æ’­ï¼Œä¿è¯å°†å¤šä¸ªå¾®æœåŠ¡çš„å­äº‹åŠ¡å…³è”åœ¨ä¸€èµ·ï¼›RMè¯·æ±‚TCå°†æœ¬åœ°äº‹åŠ¡æ³¨å†Œä¸ºå…¨å±€äº‹åŠ¡çš„åˆ†æ”¯äº‹åŠ¡ï¼Œé€šè¿‡å…¨å±€äº‹åŠ¡çš„XIDè¿›è¡Œå…³è”ï¼›TMè¯·æ±‚TCå‘Šè¯‰XIDå¯¹åº”çš„å…¨å±€äº‹åŠ¡æ˜¯è¿›è¡Œæäº¤è¿˜æ˜¯å›æ»šï¼›TCé©±åŠ¨RMå°†XIDå¯¹åº”çš„è‡ªå·±çš„æœ¬åœ°äº‹åŠ¡è¿›è¡Œæäº¤è¿˜æ˜¯å›æ»šï¼›\nSeataæ”¯æŒ4ç§äº‹åŠ¡æ¨¡å¼ï¼Œå®˜ç½‘æ–‡æ¡£ï¼šhttps://seata.io/zh-cn/docs/overview/what-is-seata.html\nATï¼šæœ¬è´¨ä¸Šå°±æ˜¯2PCçš„å‡çº§ç‰ˆï¼Œåœ¨ AT æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·åªéœ€å…³å¿ƒè‡ªå·±çš„ â€œä¸šåŠ¡SQLâ€\nä¸€é˜¶æ®µï¼ŒSeata ä¼šæ‹¦æˆªâ€œä¸šåŠ¡ SQLâ€ï¼Œé¦–å…ˆè§£æ SQL è¯­ä¹‰ï¼Œæ‰¾åˆ°â€œä¸šåŠ¡ SQLâ€è¦æ›´æ–°çš„ä¸šåŠ¡æ•°æ®ï¼Œåœ¨ä¸šåŠ¡æ•°æ®è¢«æ›´æ–°å‰ï¼Œå°†å…¶ä¿å­˜æˆâ€œbefore imageâ€ï¼Œç„¶åæ‰§è¡Œâ€œä¸šåŠ¡ SQLâ€æ›´æ–°ä¸šåŠ¡æ•°æ®ï¼Œåœ¨ä¸šåŠ¡æ•°æ®æ›´æ–°ä¹‹åï¼Œå†å°†å…¶ä¿å­˜æˆâ€œafter imageâ€ï¼Œæœ€åç”Ÿæˆè¡Œé”ã€‚ä»¥ä¸Šæ“ä½œå…¨éƒ¨åœ¨ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡å†…å®Œæˆï¼Œè¿™æ ·ä¿è¯äº†ä¸€é˜¶æ®µæ“ä½œçš„åŸå­æ€§ã€‚ äºŒé˜¶æ®µå¦‚æœç¡®è®¤æäº¤çš„è¯ï¼Œå› ä¸ºâ€œä¸šåŠ¡ SQLâ€åœ¨ä¸€é˜¶æ®µå·²ç»æäº¤è‡³æ•°æ®åº“ï¼Œ æ‰€ä»¥ Seata æ¡†æ¶åªéœ€å°†ä¸€é˜¶æ®µä¿å­˜çš„å¿«ç…§æ•°æ®å’Œè¡Œé”åˆ æ‰ï¼Œå®Œæˆæ•°æ®æ¸…ç†å³å¯ï¼Œå½“ç„¶å¦‚æœéœ€è¦å›æ»šï¼Œé‚£ä¹ˆå°±ç”¨â€œbefore imageâ€è¿˜åŸä¸šåŠ¡æ•°æ®ï¼›ä½†åœ¨è¿˜åŸå‰è¦é¦–å…ˆè¦æ ¡éªŒè„å†™ï¼Œå¯¹æ¯”â€œæ•°æ®åº“å½“å‰ä¸šåŠ¡æ•°æ®â€å’Œ â€œafter imageâ€ï¼Œå¦‚æœä¸¤ä»½æ•°æ®å®Œå…¨ä¸€è‡´å°±è¯´æ˜æ²¡æœ‰è„å†™ï¼Œå¯ä»¥è¿˜åŸä¸šåŠ¡æ•°æ®ï¼Œå¦‚æœä¸ä¸€è‡´å°±è¯´æ˜æœ‰è„å†™ï¼Œå‡ºç°è„å†™å°±éœ€è¦è½¬äººå·¥å¤„ç†ã€‚ TCCï¼šå’Œæˆ‘ä»¬ä¸Šé¢è®²è§£çš„æ€è·¯æ˜¯ä¸€æ ·çš„ã€‚\nXAï¼šåŒä¸Šï¼Œä½†æ˜¯è¦æ±‚æ•°æ®åº“æœ¬èº«æ”¯æŒè¿™ç§æ¨¡å¼æ‰å¯ä»¥ã€‚\nSagaï¼šç”¨äºå¤„ç†é•¿äº‹åŠ¡ï¼Œæ¯ä¸ªæ‰§è¡Œè€…éœ€è¦å®ç°äº‹åŠ¡çš„æ­£å‘æ“ä½œå’Œè¡¥å¿æ“ä½œï¼š\né‚£ä¹ˆï¼Œä»¥ATæ¨¡å¼ä¸ºä¾‹ï¼Œæˆ‘ä»¬çš„ç¨‹åºå¦‚ä½•æ‰èƒ½åšåˆ°ä¸å¯¹ä¸šåŠ¡è¿›è¡Œä¾µå…¥çš„æƒ…å†µä¸‹å®ç°åˆ†å¸ƒå¼äº‹åŠ¡å‘¢ï¼Ÿå®é™…ä¸Šï¼ŒSeataå®¢æˆ·ç«¯ï¼Œæ˜¯é€šè¿‡å¯¹æ•°æ®æºè¿›è¡Œä»£ç†å®ç°çš„ï¼Œä½¿ç”¨çš„æ˜¯DataSourceProxyç±»ï¼Œæ‰€ä»¥åœ¨ç¨‹åºè¿™è¾¹ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å¯¹åº”çš„ä»£ç†ç±»æ³¨å†Œä¸ºBeanå³å¯ï¼ˆ0.9ç‰ˆæœ¬ä¹‹åæ”¯æŒè‡ªåŠ¨è¿›è¡Œä»£ç†ï¼Œä¸ç”¨æˆ‘ä»¬æ‰‹åŠ¨æ“ä½œï¼‰\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä»¥ATæ¨¡å¼ä¸ºä¾‹è¿›è¡Œè®²è§£ã€‚\nä½¿ç”¨fileæ¨¡å¼éƒ¨ç½² #\rSeataä¹Ÿæ˜¯ä»¥æœåŠ¡ç«¯å½¢å¼è¿›è¡Œéƒ¨ç½²çš„ï¼Œç„¶åæ¯ä¸ªæœåŠ¡éƒ½æ˜¯å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ä¸‹è½½åœ°å€ï¼šhttps://github.com/seata/seata/releases/download/v1.4.2/seata-server-1.4.2.zip\næŠŠæºç ä¹Ÿä¸‹è½½ä¸€ä¸‹ï¼šhttps://github.com/seata/seata/archive/refs/heads/develop.zip\nä¸‹è½½å®Œæˆä¹‹åï¼Œæ”¾å…¥åˆ°IDEAé¡¹ç›®ç›®å½•ä¸­ï¼Œæ·»åŠ å¯åŠ¨é…ç½®ï¼Œè¿™é‡Œç«¯å£ä½¿ç”¨8868ï¼š\nSeataæœåŠ¡ç«¯æ”¯æŒæœ¬åœ°éƒ¨ç½²æˆ–æ˜¯åŸºäºæ³¨å†Œå‘ç°ä¸­å¿ƒéƒ¨ç½²ï¼ˆæ¯”å¦‚Nacosã€Eurekaç­‰ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆæ¼”ç¤ºä¸€ä¸‹æœ€ç®€å•çš„æœ¬åœ°éƒ¨ç½²ï¼Œä¸éœ€è¦å¯¹Seataçš„é…ç½®æ–‡ä»¶åšä»»ä½•ä¿®æ”¹ã€‚\nSeataå­˜åœ¨ç€äº‹åŠ¡åˆ†ç»„æœºåˆ¶ï¼š\näº‹åŠ¡åˆ†ç»„ï¼šseataçš„èµ„æºé€»è¾‘ï¼Œå¯ä»¥æŒ‰å¾®æœåŠ¡çš„éœ€è¦ï¼Œåœ¨åº”ç”¨ç¨‹åºï¼ˆå®¢æˆ·ç«¯ï¼‰å¯¹è‡ªè¡Œå®šä¹‰äº‹åŠ¡åˆ†ç»„ï¼Œæ¯ç»„å–ä¸€ä¸ªåå­—ã€‚ é›†ç¾¤ï¼šseata-serveræœåŠ¡ç«¯ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ç»„æˆçš„é›†ç¾¤clusterã€‚ åº”ç”¨ç¨‹åºï¼ˆå®¢æˆ·ç«¯ï¼‰ä½¿ç”¨æ—¶éœ€è¦æŒ‡å®šäº‹åŠ¡é€»è¾‘åˆ†ç»„ä¸SeataæœåŠ¡ç«¯é›†ç¾¤ï¼ˆé»˜è®¤ä¸ºdefaultï¼‰çš„æ˜ å°„å…³ç³»ã€‚ ä¸ºå•¥è¦è®¾è®¡æˆé€šè¿‡äº‹åŠ¡åˆ†ç»„å†ç›´æ¥æ˜ å°„åˆ°é›†ç¾¤ï¼Ÿå¹²å˜›ä¸ç›´æ¥æŒ‡å®šé›†ç¾¤å‘¢ï¼Ÿè·å–äº‹åŠ¡åˆ†ç»„åˆ°æ˜ å°„é›†ç¾¤çš„é…ç½®ã€‚è¿™æ ·è®¾è®¡åï¼Œäº‹åŠ¡åˆ†ç»„å¯ä»¥ä½œä¸ºèµ„æºçš„é€»è¾‘éš”ç¦»å•ä½ï¼Œå‡ºç°æŸé›†ç¾¤æ•…éšœæ—¶å¯ä»¥å¿«é€Ÿfailoverï¼Œåªåˆ‡æ¢å¯¹åº”åˆ†ç»„ï¼Œå¯ä»¥æŠŠæ•…éšœç¼©å‡åˆ°æœåŠ¡çº§åˆ«ï¼Œä½†å‰æä¹Ÿæ˜¯ä½ æœ‰è¶³å¤Ÿserveré›†ç¾¤ã€‚\næ¥ç€æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬çš„å„ä¸ªæœåŠ¡ä½œä¸ºSeateçš„å®¢æˆ·ç«¯ï¼Œåªéœ€è¦å¯¼å…¥ä¾èµ–å³å¯ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-seata\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ç„¶åæ·»åŠ é…ç½®ï¼š\nseata: service: vgroup-mapping: # è¿™é‡Œéœ€è¦å¯¹äº‹åŠ¡ç»„åšæ˜ å°„ï¼Œé»˜è®¤çš„åˆ†ç»„åä¸º åº”ç”¨åç§°-seata-service-groupï¼Œå°†å…¶æ˜ å°„åˆ°defaulté›†ç¾¤ # è¿™ä¸ªå¾ˆå…³é”®ï¼Œä¸€å®šè¦é…ç½®å¯¹ï¼Œä¸ç„¶ä¼šæ‰¾ä¸åˆ°æœåŠ¡ bookservice-seata-service-group: default grouplist: default: localhost:8868 è¿™æ ·å°±å¯ä»¥ç›´æ¥å¯åŠ¨äº†ï¼Œä½†æ˜¯æ³¨æ„ç°åœ¨åªæ˜¯å•çº¯åœ°è¿æ¥ä¸Šï¼Œå¹¶æ²¡æœ‰å¼€å¯ä»»ä½•çš„åˆ†å¸ƒå¼äº‹åŠ¡ã€‚\nç°åœ¨æˆ‘ä»¬æ¥ç€æ¥é…ç½®å¼€å¯åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œé¦–å…ˆåœ¨å¯åŠ¨ç±»æ·»åŠ æ³¨è§£ï¼Œæ­¤æ³¨è§£ä¼šæ·»åŠ ä¸€ä¸ªåç½®å¤„ç†å™¨å°†æ•°æ®æºå°è£…ä¸ºæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡çš„ä»£ç†æ•°æ®æºï¼ˆè™½ç„¶å®˜æ–¹è¡¨ç¤ºé…ç½®æ–‡ä»¶ä¸­å·²ç»é»˜è®¤å¼€å¯äº†è‡ªåŠ¨ä»£ç†ï¼Œä½†æ˜¯UPä¸»å®æµ‹1.4.2ç‰ˆæœ¬ä¸‹åªèƒ½æ‰“æ³¨è§£çš„æ–¹å¼æ‰èƒ½ç”Ÿæ•ˆï¼‰ï¼š\n@EnableAutoDataSourceProxy @SpringBootApplication public class BookApplication { public static void main(String[] args) { SpringApplication.run(BookApplication.class, args); } } æ¥ç€æˆ‘ä»¬éœ€è¦åœ¨å¼€å¯åˆ†å¸ƒå¼äº‹åŠ¡çš„æ–¹æ³•ä¸Šæ·»åŠ @GlobalTransactionalæ³¨è§£ï¼š\n@GlobalTransactional @Override public boolean doBorrow(int uid, int bid) { //è¿™é‡Œæ‰“å°ä¸€ä¸‹XIDçœ‹çœ‹ï¼Œå…¶ä»–çš„æœåŠ¡ä¸šæ·»åŠ è¿™æ ·ä¸€ä¸ªæ‰“å°ï¼Œå¦‚æœä¸€ä¼šéƒ½æ‰“å°çš„æ˜¯åŒä¸€ä¸ªXIDï¼Œè¡¨ç¤ºä½¿ç”¨çš„å°±æ˜¯åŒä¸€ä¸ªäº‹åŠ¡ System.out.println(RootContext.getXID()); if(bookClient.bookRemain(bid) \u0026lt; 1) throw new RuntimeException(\u0026#34;å›¾ä¹¦æ•°é‡ä¸è¶³\u0026#34;); if(userClient.userRemain(uid) \u0026lt; 1) throw new RuntimeException(\u0026#34;ç”¨æˆ·å€Ÿé˜…é‡ä¸è¶³\u0026#34;); if(!bookClient.bookBorrow(bid)) throw new RuntimeException(\u0026#34;åœ¨å€Ÿé˜…å›¾ä¹¦æ—¶å‡ºç°é”™è¯¯ï¼\u0026#34;); if(mapper.getBorrow(uid, bid) != null) throw new RuntimeException(\u0026#34;æ­¤ä¹¦ç±å·²ç»è¢«æ­¤ç”¨æˆ·å€Ÿé˜…äº†ï¼\u0026#34;); if(mapper.addBorrow(uid, bid) \u0026lt;= 0) throw new RuntimeException(\u0026#34;åœ¨å½•å…¥å€Ÿé˜…ä¿¡æ¯æ—¶å‡ºç°é”™è¯¯ï¼\u0026#34;); if(!userClient.userBorrow(uid)) throw new RuntimeException(\u0026#34;åœ¨å€Ÿé˜…æ—¶å‡ºç°é”™è¯¯ï¼\u0026#34;); return true; } è¿˜æ²¡ç»“æŸï¼Œæˆ‘ä»¬å‰é¢è¯´äº†ï¼ŒSeataä¼šåˆ†æä¿®æ”¹æ•°æ®çš„sqlï¼ŒåŒæ—¶ç”Ÿæˆå¯¹åº”çš„åå‘å›æ»šSQLï¼Œè¿™ä¸ªå›æ»šè®°å½•ä¼šå­˜æ”¾åœ¨undo_log è¡¨ä¸­ã€‚æ‰€ä»¥è¦æ±‚æ¯ä¸€ä¸ªClient éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„undo_logè¡¨ï¼ˆä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªæœåŠ¡è¿æ¥çš„æ•°æ®åº“éƒ½éœ€è¦åˆ›å»ºè¿™æ ·ä¸€ä¸ªè¡¨ï¼Œè¿™é‡Œç”±äºæˆ‘ä»¬ä¸‰ä¸ªæœåŠ¡éƒ½ç”¨çš„åŒä¸€ä¸ªæ•°æ®åº“ï¼Œæ‰€ä»¥è¯´å°±åªç”¨åœ¨è¿™ä¸ªæ•°æ®åº“ä¸­åˆ›å»ºundo_logè¡¨å³å¯ï¼‰ï¼Œè¡¨SQLå®šä¹‰å¦‚ä¸‹ï¼š\nCREATE TABLE `undo_log` ( `id` BIGINT(20) NOT NULL AUTO_INCREMENT, `branch_id` BIGINT(20) NOT NULL, `xid` VARCHAR(100) NOT NULL, `context` VARCHAR(128) NOT NULL, `rollback_info` LONGBLOB NOT NULL, `log_status` INT(11) NOT NULL, `log_created` DATETIME NOT NULL, `log_modified` DATETIME NOT NULL, `ext` VARCHAR(100) DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `ux_undo_log` (`xid`, `branch_id`) ) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8; åˆ›å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥å¯åŠ¨ä¸‰ä¸ªæœåŠ¡äº†ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å½“å‡ºç°å¼‚å¸¸çš„æ—¶å€™æ˜¯ä¸æ˜¯ä¼šæ­£å¸¸å›æ»šï¼š\né¦–å…ˆç¬¬ä¸€æ¬¡è‚¯å®šæ˜¯æ­£å¸¸å®Œæˆå€Ÿé˜…æ“ä½œçš„ï¼Œæ¥ç€æˆ‘ä»¬å†æ¬¡è¿›è¡Œè¯·æ±‚ï¼Œè‚¯å®šä¼šå‡ºç°å¼‚å¸¸ï¼š\nå¦‚æœèƒ½åœ¨æ ˆè¿½è¸ªä¿¡æ¯ä¸­çœ‹åˆ°seataç›¸å…³çš„åŒ…ï¼Œé‚£ä¹ˆè¯´æ˜åˆ†å¸ƒå¼äº‹åŠ¡å·²ç»å¼€å§‹å·¥ä½œäº†ï¼Œé€šè¿‡æ—¥å¿—æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‡ºç°äº†å›æ»šæ“ä½œï¼š\nå¹¶ä¸”æ•°æ®åº“ä¸­ç¡®å®æ˜¯å›æ»šäº†æ‰£é™¤æ“ä½œï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬å°±é€šè¿‡Seataç®€å•åœ°å®ç°äº†åˆ†å¸ƒå¼äº‹åŠ¡ã€‚\nä½¿ç”¨nacosæ¨¡å¼éƒ¨ç½² #\rå‰é¢æˆ‘ä»¬å®ç°äº†æœ¬åœ°SeataæœåŠ¡çš„fileæ¨¡å¼éƒ¨ç½²ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è®©å…¶é…åˆNacosè¿›è¡Œéƒ¨ç½²ï¼Œåˆ©ç”¨Nacosçš„é…ç½®ç®¡ç†å’ŒæœåŠ¡å‘ç°æœºåˆ¶ï¼ŒSeataèƒ½å¤Ÿæ›´å¥½åœ°å·¥ä½œã€‚\næˆ‘ä»¬å…ˆå•ç‹¬ä¸ºSeataé…ç½®ä¸€ä¸ªå‘½åç©ºé—´ï¼š\næˆ‘ä»¬æ‰“å¼€confç›®å½•ä¸­çš„registry.confé…ç½®æ–‡ä»¶ï¼š\nregistry { # æ³¨å†Œé…ç½® # å¯ä»¥çœ‹åˆ°è¿™é‡Œå¯ä»¥é€‰æ‹©ç±»å‹ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ™®é€šçš„fileç±»å‹ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°æ–‡ä»¶çš„å½¢å¼è¿›è¡Œæ³¨å†Œé…ç½® # æ”¯æŒçš„ç±»å‹å¦‚ä¸‹ï¼Œå¯¹åº”çš„ç±»å‹åœ¨ä¸‹é¢éƒ½æœ‰å¯¹åº”çš„é…ç½® # file ã€nacos ã€eurekaã€redisã€zkã€consulã€etcd3ã€sofa type = \u0026#34;nacos\u0026#34; # é‡‡ç”¨nacosæ–¹å¼ä¼šå°†seataæœåŠ¡ç«¯ä¹Ÿæ³¨å†Œåˆ°nacosä¸­ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±å¯ä»¥åˆ©ç”¨æœåŠ¡å‘ç°è‡ªåŠ¨æ‰¾åˆ°seataæœåŠ¡ # å°±ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šIPå’Œç«¯å£äº†ï¼Œä¸è¿‡çœ‹ä¼¼æ–¹ä¾¿ï¼Œå‘å€’æ˜¯ä¸å°‘ï¼Œåé¢å†è¯´ nacos { # åº”ç”¨åç§°ï¼Œè¿™é‡Œé»˜è®¤å°±è¡Œ application = \u0026#34;seata-server\u0026#34; # NacosæœåŠ¡å™¨åœ°å€ serverAddr = \u0026#34;localhost:8848\u0026#34; # è¿™é‡Œä½¿ç”¨çš„æ˜¯SEATA_GROUPç»„ï¼Œä¸€ä¼šæ³¨å†Œåˆ°Nacosä¸­å°±æ˜¯è¿™ä¸ªç»„ group = \u0026#34;SEATA_GROUP\u0026#34; # è¿™é‡Œå°±ä½¿ç”¨æˆ‘ä»¬ä¸Šé¢å•ç‹¬ä¸ºseataé…ç½®çš„å‘½åç©ºé—´ï¼Œæ³¨æ„å¡«çš„æ˜¯ID namespace = \u0026#34;89fc2145-4676-48b8-9edd-29e867879bcb\u0026#34; # é›†ç¾¤åç§°ï¼Œè¿™é‡Œè¿˜æ˜¯ä½¿ç”¨default cluster = \u0026#34;default\u0026#34; # Nacosçš„ç”¨æˆ·åå’Œå¯†ç  username = \u0026#34;nacos\u0026#34; password = \u0026#34;nacos\u0026#34; } #... æ³¨å†Œä¿¡æ¯é…ç½®å®Œæˆä¹‹åï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦å°†é…ç½®æ–‡ä»¶ä¹Ÿæ”¾åˆ°Nacosä¸­ï¼Œè®©Nacosç®¡ç†é…ç½®ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹é…ç½®è¿›è¡Œçƒ­æ›´æ–°äº†ï¼Œä¸€æ—¦ç¯å¢ƒéœ€è¦å˜åŒ–ï¼Œåªéœ€è¦ç›´æ¥åœ¨Nacosä¸­ä¿®æ”¹å³å¯ã€‚\nconfig { # è¿™é‡Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨nacos # fileã€nacos ã€apolloã€zkã€consulã€etcd3 type = \u0026#34;nacos\u0026#34; nacos { # è·Ÿä¸Šé¢ä¸€æ ·çš„é…æ³• serverAddr = \u0026#34;127.0.0.1:8848\u0026#34; namespace = \u0026#34;89fc2145-4676-48b8-9edd-29e867879bcb\u0026#34; group = \u0026#34;SEATA_GROUP\u0026#34; username = \u0026#34;nacos\u0026#34; password = \u0026#34;nacos\u0026#34; # è¿™ä¸ªä¸ç”¨æ”¹ï¼Œé»˜è®¤å°±è¡Œ dataId = \u0026#34;seataServer.properties\u0026#34; } æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦å°†é…ç½®å¯¼å…¥åˆ°Nacosä¸­ï¼Œæˆ‘ä»¬æ‰“å¼€ä¸€å¼€å§‹ä¸‹è½½çš„æºç script/config-center/nacosç›®å½•ï¼Œè¿™æ˜¯å®˜æ–¹æä¾›çš„ä¸Šä¼ è„šæœ¬ï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œå³å¯ï¼ˆwindowsä¸‹æ²¡å¯¹åº”çš„batå°±å¾ˆè›‹ç–¼ï¼Œå¯ä»¥ä½¿ç”¨gitå‘½ä»¤è¡Œæ¥è¿è¡Œä¸€ä¸‹ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå¯äº¤äº’çš„ç‰ˆæœ¬ï¼š\næŒ‰ç…§æç¤ºè¾“å…¥å°±å¯ä»¥äº†ï¼Œä¸è¾“å…¥å°±ä½¿ç”¨çš„é»˜è®¤å€¼ï¼Œä¸çŸ¥é“ä¸ºå•¥æœ€æ–°ç‰ˆæœ¬æœ‰å››ä¸ªå› ä¸ºå‚æ•°è¿‡é•¿è¿˜å¯¼å…¥å¤±è´¥äº†ï¼Œå°±ç¦»è°±ï¼Œä¸è¿‡ä¸å½±å“ã€‚\nå¯¼å…¥æˆåŠŸä¹‹åï¼Œå¯ä»¥åœ¨å¯¹åº”çš„å‘½åç©ºé—´ä¸‹çœ‹åˆ°å¯¹åº”çš„é…ç½®ï¼ˆä¸ºå•¥éè¦ä¸€ä¸ªä¸€ä¸ªé…ç½®é¡¹å•ç‹¬æï¼Œå°±ä¸èƒ½å†™ä¸€èµ·å—ï¼‰ï¼š\næ³¨æ„ï¼Œè¿˜æ²¡å®Œï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å¯¹åº”çš„äº‹åŠ¡ç»„æ˜ å°„é…ç½®ä¹Ÿæ·»åŠ ä¸Šï¼ŒDataIdæ ¼å¼ä¸ºservice.vgroupMapping.äº‹åŠ¡ç»„åç§°ï¼Œæ¯”å¦‚æˆ‘ä»¬å°±ä½¿ç”¨é»˜è®¤çš„åç§°ï¼Œå€¼å…¨éƒ¨ä¾ç„¶ä½¿ç”¨defaultå³å¯ï¼š\nç°åœ¨æˆ‘ä»¬å°±å®Œæˆäº†æœåŠ¡ç«¯çš„Nacosé…ç½®ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦å¯¹å®¢æˆ·ç«¯ä¹Ÿè¿›è¡ŒNacosé…ç½®ï¼š\nseata: # æ³¨å†Œ registry: # ä½¿ç”¨Nacos type: nacos nacos: # ä½¿ç”¨Seataçš„å‘½åç©ºé—´ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®æ‰¾åˆ°SeataæœåŠ¡ï¼Œç”±äºç»„ä½¿ç”¨çš„æ˜¯SEATA_GROUPï¼Œé…ç½®é»˜è®¤å€¼å°±æ˜¯ï¼Œå°±ä¸ç”¨é…äº† namespace: 89fc2145-4676-48b8-9edd-29e867879bcb username: nacos password: nacos # é…ç½® config: type: nacos nacos: namespace: 89fc2145-4676-48b8-9edd-29e867879bcb username: nacos password: nacos ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨è¿™ä¸‰ä¸ªæœåŠ¡äº†ï¼Œå¯ä»¥åœ¨Nacosä¸­çœ‹åˆ°Seataä»¥åŠä¸‰ä¸ªæœåŠ¡éƒ½æ­£å¸¸æ³¨å†Œäº†ï¼š\næ¥ç€æˆ‘ä»¬å°±å¯ä»¥è®¿é—®ä¸€ä¸‹æœåŠ¡è¯•è¯•çœ‹äº†ï¼š\nå¯ä»¥çœ‹åˆ°æ•ˆæœå’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡ç°åœ¨æˆ‘ä»¬çš„æ³¨å†Œå’Œé…ç½®éƒ½ç»§æ‰¿åœ¨Nacosä¸­è¿›è¡Œäº†ã€‚\næˆ‘ä»¬è¿˜å¯ä»¥é…ç½®ä¸€ä¸‹äº‹åŠ¡ä¼šè¯ä¿¡æ¯çš„å­˜å‚¨æ–¹å¼ï¼Œé»˜è®¤æ˜¯fileç±»å‹ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨è¿è¡Œç›®å½•ä¸‹åˆ›å»ºfile_storeç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ¬åˆ°æ•°æ®åº“ä¸­å­˜å‚¨ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®å³å¯ï¼š\nå°†store.session.modeå’Œstore.modeçš„å€¼ä¿®æ”¹ä¸ºdb\næ¥ç€æˆ‘ä»¬å¯¹æ•°æ®åº“ä¿¡æ¯è¿›è¡Œä¸€ä¸‹é…ç½®ï¼š\næ•°æ®åº“é©±åŠ¨ æ•°æ®åº“URL æ•°æ®åº“ç”¨æˆ·åå¯†ç  å…¶ä»–çš„é»˜è®¤å³å¯ï¼š\næ¥ç€æˆ‘ä»¬éœ€è¦å°†å¯¹åº”çš„æ•°æ®åº“è¿›è¡Œåˆ›å»ºï¼Œåˆ›å»ºseataæ•°æ®åº“ï¼Œç„¶åç›´æ¥CVä»¥ä¸‹è¯­å¥ï¼š\n-- -------------------------------- The script used when storeMode is \u0026#39;db\u0026#39; -------------------------------- -- the table to store GlobalSession data CREATE TABLE IF NOT EXISTS `global_table` ( `xid` VARCHAR(128) NOT NULL, `transaction_id` BIGINT, `status` TINYINT NOT NULL, `application_id` VARCHAR(32), `transaction_service_group` VARCHAR(32), `transaction_name` VARCHAR(128), `timeout` INT, `begin_time` BIGINT, `application_data` VARCHAR(2000), `gmt_create` DATETIME, `gmt_modified` DATETIME, PRIMARY KEY (`xid`), KEY `idx_status_gmt_modified` (`status` , `gmt_modified`), KEY `idx_transaction_id` (`transaction_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4; -- the table to store BranchSession data CREATE TABLE IF NOT EXISTS `branch_table` ( `branch_id` BIGINT NOT NULL, `xid` VARCHAR(128) NOT NULL, `transaction_id` BIGINT, `resource_group_id` VARCHAR(32), `resource_id` VARCHAR(256), `branch_type` VARCHAR(8), `status` TINYINT, `client_id` VARCHAR(64), `application_data` VARCHAR(2000), `gmt_create` DATETIME(6), `gmt_modified` DATETIME(6), PRIMARY KEY (`branch_id`), KEY `idx_xid` (`xid`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4; -- the table to store lock data CREATE TABLE IF NOT EXISTS `lock_table` ( `row_key` VARCHAR(128) NOT NULL, `xid` VARCHAR(128), `transaction_id` BIGINT, `branch_id` BIGINT NOT NULL, `resource_id` VARCHAR(256), `table_name` VARCHAR(32), `pk` VARCHAR(36), `status` TINYINT NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;0:locked ,1:rollbacking\u0026#39;, `gmt_create` DATETIME, `gmt_modified` DATETIME, PRIMARY KEY (`row_key`), KEY `idx_status` (`status`), KEY `idx_branch_id` (`branch_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4; CREATE TABLE IF NOT EXISTS `distributed_lock` ( `lock_key` CHAR(20) NOT NULL, `lock_value` VARCHAR(20) NOT NULL, `expire` BIGINT, primary key (`lock_key`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4; INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\u0026#39;HandleAllSession\u0026#39;, \u0026#39; \u0026#39;, 0); å®Œæˆä¹‹åï¼Œé‡å¯SeataæœåŠ¡ç«¯å³å¯ï¼š\nçœ‹åˆ°äº†æ•°æ®æºåˆå§‹åŒ–æˆåŠŸï¼Œç°åœ¨å·²ç»åœ¨ä½¿ç”¨æ•°æ®åº“è¿›è¡Œä¼šè¯å­˜å‚¨äº†ã€‚\nå¦‚æœSeataæœåŠ¡ç«¯å‡ºç°æŠ¥é”™ï¼Œå¯èƒ½æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰äº‹åŠ¡ç»„çš„åç§°å¤ªé•¿äº†ï¼š\nå°†globle_tableè¡¨çš„å­—æ®µtransaction_server_groupé•¿åº¦é€‚å½“å¢åŠ ä¸€ä¸‹å³å¯ï¼š\nåˆ°æ­¤ï¼Œå…³äºåŸºäºnacosæ¨¡å¼ä¸‹çš„Seataéƒ¨ç½²ï¼Œå°±å®Œæˆäº†ã€‚\nè™½ç„¶æˆ‘ä»¬è¿™é‡Œå®ç°äº†åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œä½†æ˜¯è¿˜æ˜¯ç»™å„ä½åŒå­¦æå‡ºä¸€ä¸ªé—®é¢˜ï¼ˆå¯ä»¥æŠŠè‡ªå·±æ‰€è®¤ä¸ºçš„ç»“æœæ‰“åœ¨å¼¹å¹•ä¸Šï¼‰ï¼Œå°±æˆ‘ä»¬ç›®å‰è¿™æ ·çš„ç¨‹åºè®¾è®¡ï¼Œåœ¨é«˜å¹¶å‘ä¸‹ï¼ŒçœŸçš„å®‰å…¨å—ï¼Ÿæ¯”å¦‚åŒä¸€æ—¶é—´100ä¸ªåŒå­¦æŠ¢åŒä¸€ä¸ªä¹¦ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“åŒä¸€ä¸ªä¹¦å°±åªæœ‰3æœ¬ï¼Œå¦‚æœè¿™æ—¶çœŸçš„åŒæ—¶æ¥äº†100ä¸ªè¯·æ±‚è¦å€Ÿä¹¦ï¼Œä¼šæ­£å¸¸åœ°åªå€Ÿå‡º3æœ¬ä¹¦å—ï¼Ÿå¦‚æœä¸æ­£å¸¸ï¼Œè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºæŸç çŸ¥è¯†åº“ç‰ˆæƒæ‰€æœ‰ï¼Œç¦æ­¢ä¸€åˆ‡æœªç»æˆæƒçš„è½¬è½½ã€å‘å¸ƒã€å‡ºå”®ç­‰è¡Œä¸ºï¼Œè¿è€…å°†è¢«è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://www.itbaima.cn/document/35v1hbsfcdgagdnw\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/cloud/%E4%B8%89/","section":"Docs","summary":"å¾®æœåŠ¡è¿›é˜¶ #\rå‰é¢æˆ‘ä»¬äº†è§£äº†å¾®æœåŠ¡çš„ä¸€å¥—è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®ƒæ˜¯åŸºäºNetflixçš„è§£å†³æ–¹æ¡ˆï¼Œå®é™…ä¸Šæˆ‘ä»¬å‘ç°ï¼Œå¾ˆå¤šæ¡†æ¶éƒ½å·²ç»åœæ­¢ç»´æŠ¤äº†ï¼Œæ¥çœ‹çœ‹ç›®å‰æˆ‘ä»¬æ‰€è®¤è¯†åˆ°çš„SpringCloudå„å¤§ç»„ä»¶çš„ç»´æŠ¤æƒ…å†µï¼š\næ³¨å†Œä¸­å¿ƒï¼š Eurekaï¼ˆå±äºNetflixï¼Œ2.xç‰ˆæœ¬ä¸å†å¼€æºï¼Œ1.xç‰ˆæœ¬ä»åœ¨æ›´æ–°ï¼‰ æœåŠ¡è°ƒç”¨ï¼š Ribbonï¼ˆå±äºNetflixï¼Œåœæ­¢æ›´æ–°ï¼Œå·²ç»å½»åº•è¢«ç§»é™¤ï¼‰ã€SpringCloud Loadbalancerï¼ˆå±äºSpringCloudå®˜æ–¹ï¼Œç›®å‰çš„é»˜è®¤æ–¹æ¡ˆï¼‰ æœåŠ¡é™çº§ï¼š Hystrixï¼ˆå±äºNetflixï¼Œåœæ­¢æ›´æ–°ï¼Œå·²ç»å½»åº•è¢«ç§»é™¤ï¼‰ è·¯ç”±ç½‘å…³ï¼š Zuulï¼ˆå±äºNetflixï¼Œåœæ­¢æ›´æ–°ï¼Œå·²ç»å½»åº•è¢«ç§»é™¤ï¼‰ã€Gatewayï¼ˆå±äºSpringCloudå®˜æ–¹ï¼Œæ¨èæ–¹æ¡ˆï¼‰ é…ç½®ä¸­å¿ƒï¼š Configï¼ˆå±äºSpringCloudå®˜æ–¹ï¼‰ å¯è§ï¼Œæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„æ•´å¥—è§£å†³æ–¹æ¡ˆä¸­ï¼Œè¶…è¿‡åŠæ•°çš„ç»„ä»¶éƒ½å·²ç»å¤„äºä¸å¯ç”¨çŠ¶æ€ï¼Œå¹¶ä¸”éƒ¨åˆ†ç»„ä»¶éƒ½æ˜¯SpringCloudå®˜æ–¹å‡ºæ‰‹æä¾›æ¡†æ¶è¿›è¡Œè§£å†³ï¼Œå› æ­¤ï¼Œå¯»æ‰¾ä¸€å¥—æ›´å¥½çš„è§£å†³æ–¹æ¡ˆåŠ¿åœ¨å¿…è¡Œï¼Œä¹Ÿå°±å¼•å‡ºäº†æˆ‘ä»¬æœ¬ç« çš„ä¸»è§’ï¼šSpringCloud Alibaba\né˜¿é‡Œå·´å·´ä½œä¸ºä¸šç•Œçš„äº’è”ç½‘å¤§å‚ï¼Œç»™å‡ºäº†ä¸€å¥—å…¨æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œå®˜æ–¹ç½‘ç«™ï¼ˆä¸­æ–‡ï¼‰ï¼šhttps://spring-cloud-alibaba-group.github.io/github-pages/2021/zh-cn/index.html\nSpring Cloud Alibaba è‡´åŠ›äºæä¾›å¾®æœåŠ¡å¼€å‘çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚æ­¤é¡¹ç›®åŒ…å«å¼€å‘åˆ†å¸ƒå¼åº”ç”¨æœåŠ¡çš„å¿…éœ€ç»„ä»¶ï¼Œæ–¹ä¾¿å¼€å‘è€…é€šè¿‡ Spring Cloud ç¼–ç¨‹æ¨¡å‹è½»æ¾ä½¿ç”¨è¿™äº›ç»„ä»¶æ¥å¼€å‘åˆ†å¸ƒå¼åº”ç”¨æœåŠ¡ã€‚\nä¾æ‰˜ Spring Cloud Alibabaï¼Œæ‚¨åªéœ€è¦æ·»åŠ ä¸€äº›æ³¨è§£å’Œå°‘é‡é…ç½®ï¼Œå°±å¯ä»¥å°† Spring Cloud åº”ç”¨æ¥å…¥é˜¿é‡Œåˆ†å¸ƒå¼åº”ç”¨è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡é˜¿é‡Œä¸­é—´ä»¶æ¥è¿…é€Ÿæ­å»ºåˆ†å¸ƒå¼åº”ç”¨ç³»ç»Ÿã€‚","title":"SpringCloud 2","type":"doc"},{"content":"\rå¾®æœåŠ¡åº”ç”¨ #\rå‰é¢æˆ‘ä»¬å·²ç»å®Œæˆäº†SpringCloudAlibabaçš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯¹ä¸€ä¸ªå¾®æœåŠ¡é¡¹ç›®çš„æ¶æ„ä½“ç³»å·²ç»æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œé‚£ä¹ˆæœ¬ç« æˆ‘ä»¬å°†åœ¨åº”ç”¨å±‚é¢ç»§ç»­æ¢è®¨å¾®æœåŠ¡ã€‚\nåˆ†å¸ƒå¼æƒé™æ ¡éªŒ #\rè™½ç„¶å®Œæˆå‰é¢çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥è‡ªå·±å»ç¼–å†™ä¸€ä¸ªæ¯”è¾ƒä¸­è§„ä¸­çŸ©çš„å¾®æœåŠ¡é¡¹ç›®äº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æˆ‘ä»¬æ²¡æœ‰è§£å†³ï¼Œç™»å½•é—®é¢˜ã€‚å‡å¦‚ç°åœ¨è¦æ±‚ç”¨æˆ·ç™»å½•ä¹‹åï¼Œæ‰èƒ½è¿›è¡Œå›¾ä¹¦çš„æŸ¥è¯¢ã€å€Ÿé˜…ç­‰æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆè¯¥å¦‚ä½•è®¾è®¡è¿™ä¸ªç³»ç»Ÿå‘¢ï¼Ÿ\nå›é¡¾æˆ‘ä»¬ä¹‹å‰è¿›è¡Œæƒé™æ ¡éªŒçš„åŸç†ï¼ŒæœåŠ¡å™¨æ˜¯å¦‚ä½•åˆ¤å®šä¸€ä¸ªè¯·æ±‚æ˜¯æ¥è‡ªå“ªä¸ªç”¨æˆ·çš„å‘¢ï¼Ÿ\né¦–å…ˆæµè§ˆå™¨ä¼šå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œè®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ã€‚ æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œä¼šåˆ›å»ºä¸€ä¸ªSESSION IDï¼Œå¹¶æš‚æ—¶å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œç„¶åä¼šå‘é€ç»™æµè§ˆå™¨ä½œä¸ºCookieä¿å­˜ã€‚ ä¹‹åæµè§ˆå™¨ä¼šä¸€ç›´æºå¸¦æ­¤Cookieè®¿é—®æœåŠ¡å™¨ï¼Œè¿™æ ·åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œå°±èƒ½æ ¹æ®æºå¸¦çš„Cookieä¸­çš„SESSION IDåˆ¤æ–­æ˜¯å“ªä¸ªç”¨æˆ·äº†ã€‚ è¿™æ ·æœåŠ¡ç«¯å’Œæµè§ˆå™¨ä¹‹é—´å¯ä»¥è½»æ¾åœ°å»ºç«‹ä¼šè¯äº†ã€‚ ä½†æ˜¯æˆ‘ä»¬æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç°åœ¨é‡‡ç”¨çš„æ˜¯åˆ†å¸ƒå¼çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆåœ¨ç”¨æˆ·æœåŠ¡è¿›è¡Œç™»å½•ä¹‹åï¼Œå…¶ä»–æœåŠ¡æ¯”å¦‚å›¾ä¹¦æœåŠ¡å’Œå€Ÿé˜…æœåŠ¡ï¼Œå®ƒä»¬ä¼šçŸ¥é“ç”¨æˆ·ç™»å½•äº†å—ï¼Ÿ\nå®é™…ä¸Šæˆ‘ä»¬ç™»å½•åˆ°ç”¨æˆ·æœåŠ¡ä¹‹åï¼ŒSessionä¸­çš„ç”¨æˆ·æ•°æ®åªä¼šåœ¨ç”¨æˆ·æœåŠ¡çš„åº”ç”¨ä¸­ä¿å­˜ï¼Œè€Œåœ¨å…¶ä»–æœåŠ¡ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨å¸Œæœ›çš„æ˜¯ï¼Œæ‰€æœ‰çš„æœåŠ¡éƒ½èƒ½å¤ŸåŒæ­¥è¿™äº›Sessionä¿¡æ¯ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å®ç°åœ¨ç”¨æˆ·æœåŠ¡ç™»å½•ä¹‹åå…¶ä»–æœåŠ¡éƒ½èƒ½çŸ¥é“ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•å®ç°Sessionçš„åŒæ­¥å‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥åœ¨æ¯å°æœåŠ¡å™¨ä¸Šéƒ½å¤åˆ¶ä¸€ä»½Sessionï¼Œä½†æ˜¯è¿™æ ·æ˜¾ç„¶æ˜¯å¾ˆæµªè´¹æ—¶é—´çš„ï¼Œå¹¶ä¸”ç”¨æˆ·éªŒè¯æ•°æ®å ç”¨çš„å†…å­˜ä¼šæˆå€çš„å¢åŠ ã€‚ å°†Sessionç§»å‡ºæœåŠ¡å™¨ï¼Œç”¨ç»Ÿä¸€å­˜å‚¨æ¥å­˜æ”¾ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨Redisæˆ–æ˜¯MySQLä¸­å­˜æ”¾ç”¨æˆ·çš„Sessionä¿¡æ¯ï¼Œè¿™æ ·æ‰€æœ‰çš„æœåŠ¡å™¨åœ¨éœ€è¦è·å–Sessionä¿¡æ¯æ—¶ï¼Œç»Ÿä¸€è®¿é—®Redisæˆ–æ˜¯MySQLå³å¯ï¼Œè¿™æ ·å°±èƒ½ä¿è¯æ‰€æœ‰æœåŠ¡éƒ½å¯ä»¥åŒæ­¥Sessionäº†ï¼ˆæ˜¯ä¸æ˜¯è¶Šæ¥è¶Šæ„Ÿè§‰åªè¦æœ‰é—®é¢˜ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜¯åŠ ä¸€ä¸ªä¸­é—´ä»¶è§£å†³ä¸äº†çš„ï¼‰ é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ç€é‡æ¥ç ”ç©¶ä¸€ä¸‹ï¼Œç„¶åå®ç°2å·æ–¹æ¡ˆï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨Redisä½œä¸ºSessionç»Ÿä¸€å­˜å‚¨ï¼Œæˆ‘ä»¬æŠŠä¸€å¼€å§‹çš„å‹ç¼©åŒ…é‡æ–°è§£å‹ä¸€æ¬¡ï¼Œåˆæ¥ä»å¤´å¼€å§‹ç¼–å†™å§ã€‚\nè¿™é‡Œæˆ‘ä»¬å°±åªä½¿ç”¨Nacoså°±è¡Œäº†ï¼Œå’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬æŠŠNacosçš„åŒ…å¯¼å…¥ä¸€ä¸‹ï¼Œç„¶åè¿›è¡Œä¸€äº›é…ç½®ï¼š\nç°åœ¨æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªæœåŠ¡éƒ½æ·»åŠ éªŒè¯æœºåˆ¶ï¼Œé¦–å…ˆå¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;!-- SpringSession Redisæ”¯æŒ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.session\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-session-data-redis\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- æ·»åŠ Redisçš„Starter --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-redis\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ç„¶åæˆ‘ä»¬ä¾ç„¶ä½¿ç”¨SpringSecurityæ¡†æ¶ä½œä¸ºæƒé™æ ¡éªŒæ¡†æ¶ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-security\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€æˆ‘ä»¬åœ¨æ¯ä¸ªæœåŠ¡éƒ½ç¼–å†™ä¸€ä¸‹å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼š\nspring: session: # å­˜å‚¨ç±»å‹ä¿®æ”¹ä¸ºredis store-type: redis redis: # RedisæœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œè¯¥å’‹å†™å’‹å†™ host: 1.14.121.107 è¿™æ ·ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæœåŠ¡çš„æ¥å£éƒ½ä¼šè¢«SpringSecurityæ‰€ä¿æŠ¤ï¼Œåªæœ‰ç™»å½•æˆåŠŸä¹‹åï¼Œæ‰å¯ä»¥è¢«è®¿é—®ã€‚\næˆ‘ä»¬æ¥æ‰“å¼€Nacosçœ‹çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæœåŠ¡éƒ½æ­£å¸¸æ³¨å†Œäº†ï¼Œæ¥ç€æˆ‘ä»¬å»è®¿é—®å›¾ä¹¦æœåŠ¡ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œè®¿é—®å¤±è´¥ï¼Œç›´æ¥æŠŠæˆ‘ä»¬ç»™é‡å®šå‘åˆ°ç™»é™†é¡µé¢äº†ï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»ç™»é™†ä¹‹åæ‰èƒ½è®¿é—®ï¼ŒåŒæ ·çš„æ–¹å¼å»è®¿é—®å…¶ä»–æœåŠ¡ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœã€‚\nç”±äºç°åœ¨æ˜¯ç»Ÿä¸€Sessionå­˜å‚¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªæœåŠ¡ç™»å½•ä¹‹åï¼Œå…¶ä»–æœåŠ¡éƒ½å¯ä»¥æ­£å¸¸è®¿é—®ï¼Œç°åœ¨æˆ‘ä»¬åœ¨å½“å‰é¡µé¢ç™»å½•ï¼Œç™»å½•ä¹‹åå¯ä»¥çœ‹åˆ°å›¾ä¹¦æœåŠ¡èƒ½å¤Ÿæ­£å¸¸è®¿é—®äº†ï¼š\nåŒæ—¶ç”¨æˆ·æœåŠ¡ä¹Ÿèƒ½æ­£å¸¸è®¿é—®äº†ï¼š\næˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹RedisæœåŠ¡å™¨ä¸­æ˜¯ä¸æ˜¯å­˜å‚¨äº†æˆ‘ä»¬çš„Sessionä¿¡æ¯ï¼š\nè™½ç„¶çœ‹èµ·æ¥å¥½åƒç¡®å®æ²¡å•¥é—®é¢˜äº†ï¼Œä½†æ˜¯å€Ÿé˜…æœåŠ¡ç‚¸äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆï¼š\nåœ¨RestTemplateè¿›è¡Œè¿œç¨‹è°ƒç”¨çš„æ—¶å€™ï¼Œç”±äºæˆ‘ä»¬çš„è¯·æ±‚æ²¡æœ‰æºå¸¦å¯¹åº”SESSIONçš„Cookieï¼Œæ‰€ä»¥å¯¼è‡´éªŒè¯å¤±è´¥ï¼Œè®¿é—®ä¸æˆåŠŸï¼Œè¿”å›401ï¼Œæ‰€ä»¥è™½ç„¶è¿™ç§æ–¹æ¡ˆçœ‹èµ·æ¥æ¯”è¾ƒåˆç†ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„å®é™…ä½¿ç”¨ä¸­ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›ä¸ä¾¿çš„ã€‚\nOAuth 2.0 å®ç°å•ç‚¹ç™»å½• #\ræ³¨æ„ï¼š ç¬¬ä¸€æ¬¡æ¥è§¦å¯èƒ½ä¼šæ¯”è¾ƒéš¾ï¼Œä¸å¤ªå¥½ç†è§£ï¼Œéœ€è¦å¤šå®è·µå’Œè§‚å¯Ÿã€‚\nå‰é¢æˆ‘ä»¬è™½ç„¶ä½¿ç”¨äº†ç»Ÿä¸€å­˜å‚¨æ¥è§£å†³Sessionå…±äº«é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å°±ç®—å®ç°äº†Sessionå…±äº«ï¼Œä¾ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œç”±äºæˆ‘ä»¬æ¯ä¸ªæœåŠ¡éƒ½æœ‰è‡ªå·±çš„éªŒè¯æ¨¡å—ï¼Œå®é™…ä¸Šæ•´ä¸ªç³»ç»Ÿæ˜¯å­˜åœ¨å†—ä½™åŠŸèƒ½çš„ã€åŒæ—¶è¿˜æœ‰æˆ‘ä»¬ä¸Šé¢å‡ºç°çš„é—®é¢˜ï¼Œé‚£ä¹ˆèƒ½å¦å®ç°åªåœ¨ä¸€ä¸ªæœåŠ¡è¿›è¡Œç™»å½•ï¼Œå°±å¯ä»¥è®¿é—®å…¶ä»–çš„æœåŠ¡å‘¢ï¼Ÿ\nå®é™…ä¸Šä¹‹å‰çš„ç™»å½•æ¨¡å¼ç§°ä¸ºå¤šç‚¹ç™»å½•ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›çš„æ˜¯å®ç°å•ç‚¹ç™»é™†ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¾—æ‰¾ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚\nè¿™é‡Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ç§å…¨æ–°çš„ç™»å½•æ–¹å¼ï¼šOAuth 2.0ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°ä¸€äº›ç½‘ç«™æ”¯æŒç¬¬ä¸‰æ–¹ç™»å½•ï¼Œæ¯”å¦‚æ·˜å®ã€å’¸é±¼æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ”¯ä»˜å®è¿›è¡Œç™»å½•ï¼Œè…¾è®¯æ¸¸æˆå¯ä»¥ç”¨QQæˆ–æ˜¯å¾®ä¿¡ç™»é™†ï¼Œä»¥åŠå¾®ä¿¡å°ç¨‹åºéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨å¾®ä¿¡è¿›è¡Œç™»å½•ã€‚æˆ‘ä»¬çŸ¥é“å®ƒä»¬å¹¶ä¸æ˜¯å±äºåŒä¸€ä¸ªç³»ç»Ÿï¼Œæ¯”å¦‚æ·˜å®å’Œå’¸é±¼éƒ½ä¸å±äºæ”¯ä»˜å®è¿™ä¸ªåº”ç”¨ï¼Œä½†æ˜¯ç”±äºéœ€è¦è·å–æ”¯ä»˜å®çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ OAuth2.0 æ¥å®ç°ç¬¬ä¸‰æ–¹æˆæƒï¼ŒåŸºäºç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®ç”¨æˆ·ä¿¡æ¯çš„æƒé™ï¼ˆæœ¬è´¨ä¸Šå°±æ˜¯ç»™åˆ«äººè°ƒç”¨è‡ªå·±æœåŠ¡æ¥å£çš„æƒé™)ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ\nå››ç§æˆæƒæ¨¡å¼ #\ræˆ‘ä»¬è¿˜æ˜¯ä»ç†è®ºå¼€å§‹è®²è§£ï¼ŒOAuth 2.0ä¸€å…±æœ‰å››ç§æˆæƒæ¨¡å¼ï¼š\nå®¢æˆ·ç«¯æ¨¡å¼ï¼ˆClient Credentialsï¼‰\nè¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘éªŒè¯æœåŠ¡å™¨è¯·æ±‚ä¸€ä¸ªTokenï¼ˆè¿™é‡Œå¯èƒ½æœ‰äº›å°ä¼™ä¼´å¯¹Tokençš„æ¦‚å¿µä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼ŒTokenç›¸å½“äºæ˜¯ä¸€ä¸ªä»¤ç‰Œï¼Œæˆ‘ä»¬éœ€è¦åœ¨éªŒè¯æœåŠ¡å™¨**ï¼ˆUser Account And Authenticationï¼‰**æœåŠ¡æ‹¿åˆ°ä»¤ç‰Œä¹‹åï¼Œæ‰èƒ½å»è®¿é—®èµ„æºï¼Œæ¯”å¦‚ç”¨æˆ·ä¿¡æ¯ã€å€Ÿé˜…ä¿¡æ¯ç­‰ï¼Œè¿™æ ·èµ„æºæœåŠ¡å™¨æ‰èƒ½çŸ¥é“æˆ‘ä»¬æ˜¯è°ä»¥åŠæ˜¯å¦æˆåŠŸç™»å½•äº†ï¼‰\nå½“ç„¶ï¼Œè¿™é‡Œçš„å‰ç«¯é¡µé¢åªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå®ƒè¿˜å¯ä»¥æ˜¯å…¶ä»–ä»»ä½•ç±»å‹çš„å®¢æˆ·ç«¯ï¼Œæ¯”å¦‚Appã€å°ç¨‹åºç”šè‡³æ˜¯ç¬¬ä¸‰æ–¹åº”ç”¨çš„æœåŠ¡ã€‚\nè™½ç„¶è¿™ç§æ¨¡å¼æ¯”è¾ƒç®€ä¾¿ï¼Œä½†æ˜¯å·²ç»å¤±å»äº†ç”¨æˆ·éªŒè¯çš„æ„ä¹‰ï¼Œå‹æ ¹å°±ä¸æ˜¯ç»™ç”¨æˆ·æ ¡éªŒå‡†å¤‡çš„ï¼Œè€Œæ˜¯æ›´é€‚ç”¨äºæœåŠ¡å†…éƒ¨è°ƒç”¨çš„åœºæ™¯ã€‚\nå¯†ç æ¨¡å¼ï¼ˆResource Owner Password Credentialsï¼‰\nå¯†ç æ¨¡å¼ç›¸æ¯”å®¢æˆ·ç«¯æ¨¡å¼ï¼Œå°±å¤šäº†ç”¨æˆ·åå’Œå¯†ç çš„ä¿¡æ¯ï¼Œç”¨æˆ·éœ€è¦æä¾›å¯¹åº”è´¦å·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰èƒ½è·å–åˆ°Tokenã€‚\nè™½ç„¶è¿™æ ·çœ‹èµ·æ¥æ¯”è¾ƒåˆç†ï¼Œä½†æ˜¯ä¼šç›´æ¥å°†è´¦å·å’Œå¯†ç æ³„éœ²ç»™å®¢æˆ·ç«¯ï¼Œéœ€è¦åå°å®Œå…¨ä¿¡ä»»å®¢æˆ·ç«¯ä¸ä¼šæ‹¿è´¦å·å¯†ç å»å¹²å…¶ä»–åäº‹ï¼Œæ‰€ä»¥è¿™ä¹Ÿä¸æ˜¯æˆ‘ä»¬å¸¸è§çš„ã€‚\néšå¼æˆæƒæ¨¡å¼ï¼ˆImplicit Grantï¼‰\né¦–å…ˆç”¨æˆ·è®¿é—®é¡µé¢æ—¶ï¼Œä¼šé‡å®šå‘åˆ°è®¤è¯æœåŠ¡å™¨ï¼Œæ¥ç€è®¤è¯æœåŠ¡å™¨ç»™ç”¨æˆ·ä¸€ä¸ªè®¤è¯é¡µé¢ï¼Œç­‰å¾…ç”¨æˆ·æˆæƒï¼Œç”¨æˆ·å¡«å†™ä¿¡æ¯å®Œæˆæˆæƒåï¼Œè®¤è¯æœåŠ¡å™¨è¿”å›Tokenã€‚\nå®ƒé€‚ç”¨äºæ²¡æœ‰æœåŠ¡ç«¯çš„ç¬¬ä¸‰æ–¹åº”ç”¨é¡µé¢ï¼Œå¹¶ä¸”ç›¸æ¯”å‰é¢ä¸€ç§å½¢å¼ï¼ŒéªŒè¯éƒ½æ˜¯åœ¨éªŒè¯æœåŠ¡å™¨è¿›è¡Œçš„ï¼Œæ•æ„Ÿä¿¡æ¯ä¸ä¼šè½»æ˜“æ³„éœ²ï¼Œä½†æ˜¯Tokenä¾ç„¶å­˜åœ¨æ³„éœ²çš„é£é™©ã€‚\næˆæƒç æ¨¡å¼ï¼ˆAuthrization Codeï¼‰\nè¿™ç§æ¨¡å¼æ˜¯æœ€å®‰å…¨çš„ä¸€ç§æ¨¡å¼ï¼Œä¹Ÿæ˜¯æ¨èä½¿ç”¨çš„ä¸€ç§ï¼Œæ¯”å¦‚æˆ‘ä»¬æ‰‹æœºä¸Šçš„å¾ˆå¤šAppéƒ½æ˜¯ä½¿ç”¨çš„è¿™ç§æ¨¡å¼ã€‚\nç›¸æ¯”éšå¼æˆæƒæ¨¡å¼ï¼Œå®ƒå¹¶ä¸ä¼šç›´æ¥è¿”å›Tokenï¼Œè€Œæ˜¯è¿”å›æˆæƒç ï¼ŒçœŸæ­£çš„Tokenæ˜¯é€šè¿‡åº”ç”¨æœåŠ¡å™¨è®¿é—®éªŒè¯æœåŠ¡å™¨è·å¾—çš„ã€‚åœ¨ä¸€å¼€å§‹çš„æ—¶å€™ï¼Œåº”ç”¨æœåŠ¡å™¨ï¼ˆå®¢æˆ·ç«¯é€šè¿‡è®¿é—®è‡ªå·±çš„åº”ç”¨æœåŠ¡å™¨æ¥è¿›è€Œè®¿é—®å…¶ä»–æœåŠ¡ï¼‰å’ŒéªŒè¯æœåŠ¡å™¨ä¹‹é—´ä¼šå…±äº«ä¸€ä¸ªsecretï¼Œè¿™ä¸ªä¸œè¥¿æ²¡æœ‰å…¶ä»–äººçŸ¥é“ï¼Œè€ŒéªŒè¯æœåŠ¡å™¨åœ¨ç”¨æˆ·éªŒè¯å®Œæˆä¹‹åï¼Œä¼šè¿”å›ä¸€ä¸ªæˆæƒç ï¼Œåº”ç”¨æœåŠ¡å™¨æœ€åå°†æˆæƒç å’Œsecretä¸€èµ·äº¤ç»™éªŒè¯æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ï¼Œå¹¶ä¸”Tokenä¹Ÿæ˜¯åœ¨æœåŠ¡ç«¯ä¹‹é—´ä¼ é€’ï¼Œä¸ä¼šç›´æ¥ç»™åˆ°å®¢æˆ·ç«¯ã€‚\nè¿™æ ·å°±ç®—æœ‰äººä¸­é€”çªƒå–äº†æˆæƒç ï¼Œä¹Ÿæ¯«æ— æ„ä¹‰ï¼Œå› ä¸ºï¼ŒTokençš„è·å–å¿…é¡»åŒæ—¶æºå¸¦æˆæƒç å’Œsecretï¼Œä½†æ˜¯secretç¬¬ä¸‰æ–¹æ˜¯æ— æ³•å¾—çŸ¥çš„ï¼Œå¹¶ä¸”Tokenä¸ä¼šç›´æ¥ä¸¢ç»™å®¢æˆ·ç«¯ï¼Œå¤§å¤§å‡å°‘äº†æ³„éœ²çš„é£é™©ã€‚\nä½†æ˜¯ä¹ä¸€çœ‹ï¼ŒOAuth 2.0ä¸åº”è¯¥æ˜¯é‚£ç§ç¬¬ä¸‰æ–¹åº”ç”¨ä¸ºäº†è¯·æ±‚æˆ‘ä»¬çš„æœåŠ¡è€Œä½¿ç”¨çš„å—ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œéœ€è¦çš„åªæ˜¯å®ç°åŒä¸€ä¸ªåº”ç”¨å†…éƒ¨æœåŠ¡ä¹‹é—´çš„è®¤è¯ï¼Œå…¶å®æˆ‘ä¹Ÿå¯ä»¥åˆ©ç”¨ OAuth2.0 æ¥å®ç°å•ç‚¹ç™»å½•ï¼Œåªæ˜¯å°‘äº†èµ„æºæœåŠ¡å™¨è¿™ä¸€è§’è‰²ï¼Œå®¢æˆ·ç«¯å°±æ˜¯æˆ‘ä»¬çš„æ•´ä¸ªç³»ç»Ÿï¼Œæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹ã€‚\næ­å»ºéªŒè¯æœåŠ¡å™¨ #\rç¬¬ä¸€æ­¥å°±æ˜¯æœ€é‡è¦çš„ï¼Œæˆ‘ä»¬éœ€è¦æ­å»ºä¸€ä¸ªéªŒè¯æœåŠ¡å™¨ï¼Œå®ƒæ˜¯æˆ‘ä»¬è¿›è¡Œæƒé™æ ¡éªŒçš„æ ¸å¿ƒï¼ŒéªŒè¯æœåŠ¡å™¨æœ‰å¾ˆå¤šçš„ç¬¬ä¸‰æ–¹å®ç°ä¹Ÿæœ‰Springå®˜æ–¹æä¾›çš„å®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Springå®˜æ–¹æä¾›çš„éªŒè¯æœåŠ¡å™¨ã€‚\nè¿™é‡Œæˆ‘ä»¬å°†æœ€å¼€å§‹ä¿å­˜å¥½çš„é¡¹ç›®è§£å‹ï¼Œå°±é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œé¦–å…ˆæˆ‘ä»¬åœ¨çˆ¶é¡¹ç›®ä¸­æ·»åŠ æœ€æ–°çš„SpringCloudä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2021.0.1\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; æ¥ç€åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å—auth-serviceï¼Œæ·»åŠ ä¾èµ–ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-security\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- OAuth2.0ä¾èµ–ï¼Œä¸å†å†…ç½®äº†ï¼Œæ‰€ä»¥å¾—æˆ‘ä»¬è‡ªå·±æŒ‡å®šä¸€ä¸‹ç‰ˆæœ¬ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-oauth2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.5.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; æ¥ç€æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼š\nserver: port: 8500 servlet: #ä¸ºäº†é˜²æ­¢ä¸€ä¼šåœ¨æœåŠ¡ä¹‹é—´è·³è½¬å¯¼è‡´Cookieæ‰“æ¶ï¼ˆå› ä¸ºæ‰€æœ‰æœåŠ¡åœ°å€éƒ½æ˜¯localhostï¼Œéƒ½ä¼šå­˜JSESSIONIDï¼‰ #è¿™é‡Œä¿®æ”¹ä¸€ä¸‹context-pathï¼Œè¿™æ ·ä¿å­˜çš„Cookieä¼šä½¿ç”¨æŒ‡å®šçš„è·¯å¾„ï¼Œå°±ä¸ä¼šå’Œå…¶ä»–æœåŠ¡æ‰“æ¶äº† #ä½†æ˜¯æ³¨æ„ä¹‹åçš„è¯·æ±‚éƒ½å¾—åœ¨æœ€å‰é¢åŠ ä¸Šè¿™ä¸ªè·¯å¾„ context-path: /sso æ¥ç€æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸‹é…ç½®ç±»ï¼Œè¿™é‡Œéœ€è¦ä¸¤ä¸ªé…ç½®ç±»ï¼Œä¸€ä¸ªæ˜¯OAuth2çš„é…ç½®ç±»ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯SpringSecurityçš„é…ç½®ç±»ï¼š\n@Configuration public class SecurityConfiguration extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http .authorizeRequests() .anyRequest().authenticated() // .and() .formLogin().permitAll(); //ä½¿ç”¨è¡¨å•ç™»å½• } @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception { BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(); auth .inMemoryAuthentication() //ç›´æ¥åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œæ‡’å¾—ææ•°æ®åº“äº† .passwordEncoder(encoder) .withUser(\u0026#34;test\u0026#34;).password(encoder.encode(\u0026#34;123456\u0026#34;)).roles(\u0026#34;USER\u0026#34;); } @Bean //è¿™é‡Œéœ€è¦å°†AuthenticationManageræ³¨å†Œä¸ºBeanï¼Œåœ¨OAuthé…ç½®ä¸­ä½¿ç”¨ @Override public AuthenticationManager authenticationManagerBean() throws Exception { return super.authenticationManagerBean(); } } @EnableAuthorizationServer //å¼€å¯éªŒè¯æœåŠ¡å™¨ @Configuration public class OAuth2Configuration extends AuthorizationServerConfigurerAdapter { @Resource private AuthenticationManager manager; private final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(); /** * è¿™ä¸ªæ–¹æ³•æ˜¯å¯¹å®¢æˆ·ç«¯è¿›è¡Œé…ç½®ï¼Œä¸€ä¸ªéªŒè¯æœåŠ¡å™¨å¯ä»¥é¢„è®¾å¾ˆå¤šä¸ªå®¢æˆ·ç«¯ï¼Œ * ä¹‹åè¿™äº›æŒ‡å®šçš„å®¢æˆ·ç«¯å°±å¯ä»¥æŒ‰ç…§ä¸‹é¢æŒ‡å®šçš„æ–¹å¼è¿›è¡ŒéªŒè¯ * @param clients å®¢æˆ·ç«¯é…ç½®å·¥å…· */ @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients .inMemory() //è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç¡¬ç¼–ç åˆ›å»ºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åƒSecurityé‚£æ ·è‡ªå®šä¹‰æˆ–æ˜¯ä½¿ç”¨JDBCä»æ•°æ®åº“è¯»å– .withClient(\u0026#34;web\u0026#34;) //å®¢æˆ·ç«¯åç§°ï¼Œéšä¾¿èµ·å°±è¡Œ .secret(encoder.encode(\u0026#34;654321\u0026#34;)) //åªä¸å®¢æˆ·ç«¯åˆ†äº«çš„secretï¼Œéšä¾¿å†™ï¼Œä½†æ˜¯æ³¨æ„è¦åŠ å¯† .autoApprove(false) //è‡ªåŠ¨å®¡æ‰¹ï¼Œè¿™é‡Œå…³é—­ï¼Œè¦çš„å°±æ˜¯ä¸€ä¼šä½“éªŒé‚£ç§æ„Ÿè§‰ .scopes(\u0026#34;book\u0026#34;, \u0026#34;user\u0026#34;, \u0026#34;borrow\u0026#34;) //æˆæƒèŒƒå›´ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å…¨éƒ¨all .authorizedGrantTypes(\u0026#34;client_credentials\u0026#34;, \u0026#34;password\u0026#34;, \u0026#34;implicit\u0026#34;, \u0026#34;authorization_code\u0026#34;, \u0026#34;refresh_token\u0026#34;); //æˆæƒæ¨¡å¼ï¼Œä¸€å…±æ”¯æŒ5ç§ï¼Œé™¤äº†ä¹‹å‰æˆ‘ä»¬ä»‹ç»çš„å››ç§ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåˆ·æ–°Tokençš„æ¨¡å¼ //è¿™é‡Œæˆ‘ä»¬ç›´æ¥æŠŠäº”ç§éƒ½å†™ä¸Šï¼Œæ–¹ä¾¿ä¸€ä¼šå®éªŒï¼Œå½“ç„¶å„ä½ä¹Ÿå¯ä»¥å•ç‹¬åªå†™ä¸€ç§ä¸€ä¸ªä¸€ä¸ªè¿›è¡Œæµ‹è¯• //ç°åœ¨æˆ‘ä»¬æŒ‡å®šçš„å®¢æˆ·ç«¯å°±æ”¯æŒè¿™äº”ç§ç±»å‹çš„æˆæƒæ–¹å¼äº† } @Override public void configure(AuthorizationServerSecurityConfigurer security) { security .passwordEncoder(encoder) //ç¼–ç å™¨è®¾å®šä¸ºBCryptPasswordEncoder .allowFormAuthenticationForClients() //å…è®¸å®¢æˆ·ç«¯ä½¿ç”¨è¡¨å•éªŒè¯ï¼Œä¸€ä¼šæˆ‘ä»¬POSTè¯·æ±‚ä¸­ä¼šæºå¸¦è¡¨å•ä¿¡æ¯ .checkTokenAccess(\u0026#34;permitAll()\u0026#34;); //å…è®¸æ‰€æœ‰çš„TokenæŸ¥è¯¢è¯·æ±‚ } @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) { endpoints .authenticationManager(manager); //ç”±äºSpringSecurityæ–°ç‰ˆæœ¬çš„ä¸€äº›åº•å±‚æ”¹åŠ¨ï¼Œè¿™é‡Œéœ€è¦é…ç½®ä¸€ä¸‹authenticationManagerï¼Œæ‰èƒ½æ­£å¸¸ä½¿ç”¨passwordæ¨¡å¼ } } æ¥ç€æˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨æœåŠ¡å™¨äº†ï¼š\nç„¶åæˆ‘ä»¬ä½¿ç”¨Postmanè¿›è¡Œæ¥å£æµ‹è¯•ï¼Œé¦–å…ˆæˆ‘ä»¬ä»æœ€ç®€å•çš„å®¢æˆ·ç«¯æ¨¡å¼è¿›è¡Œæµ‹è¯•ï¼Œå®¢æˆ·ç«¯æ¨¡å¼åªéœ€è¦æä¾›idå’Œsecretå³å¯ç›´æ¥æ‹¿åˆ°Tokenï¼Œæ³¨æ„éœ€è¦å†æ·»åŠ ä¸€ä¸ªgrant_typeæ¥è¡¨æ˜æˆ‘ä»¬çš„æˆæƒæ–¹å¼ï¼Œé»˜è®¤è¯·æ±‚è·¯å¾„ä¸ºhttp://localhost:8500/sso/oauth/tokenï¼š\nå‘èµ·è¯·æ±‚åï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¾—åˆ°äº†Tokenï¼Œå®ƒæ˜¯ä»¥JSONæ ¼å¼ç»™åˆ°æˆ‘ä»¬çš„ï¼š\næˆ‘ä»¬è¿˜å¯ä»¥è®¿é—® http://localhost:8500/sso/oauth/check_token æ¥éªŒè¯æˆ‘ä»¬çš„Tokenæ˜¯å¦æœ‰æ•ˆï¼š\nå¯ä»¥çœ‹åˆ°activeä¸ºtrueï¼Œè¡¨ç¤ºæˆ‘ä»¬åˆšåˆšç”³è¯·åˆ°çš„Tokenæ˜¯æœ‰æ•ˆçš„ã€‚\næ¥ç€æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ç¬¬äºŒç§passwordæ¨¡å¼ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æä¾›å…·ä½“çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œæˆæƒæ¨¡å¼å®šä¹‰ä¸ºpasswordå³å¯ï¼š\næ¥ç€æˆ‘ä»¬éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ BasicéªŒè¯ä¿¡æ¯ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥å¡«å†™idå’Œsecretå³å¯ï¼š\nå¯ä»¥çœ‹åˆ°åœ¨è¯·æ±‚å¤´ä¸­è‡ªåŠ¨ç”Ÿæˆäº†BasicéªŒè¯ç›¸å…³å†…å®¹ï¼š\nå“åº”æˆåŠŸï¼Œå¾—åˆ°Tokenä¿¡æ¯ï¼Œå¹¶ä¸”è¿™é‡Œè¿˜å¤šå‡ºäº†ä¸€ä¸ªrefresh_tokenï¼Œè¿™æ˜¯ç”¨äºåˆ·æ–°Tokençš„ï¼Œæˆ‘ä»¬ä¹‹åä¼šè¿›è¡Œè®²è§£ã€‚\næŸ¥è¯¢Tokenä¿¡æ¯ä¹‹åè¿˜å¯ä»¥çœ‹åˆ°ç™»å½•çš„å…·ä½“ç”¨æˆ·ä»¥åŠè§’è‰²æƒé™ç­‰ã€‚\næ¥ç€æˆ‘ä»¬æ¥çœ‹éšå¼æˆæƒæ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æˆ‘ä»¬éœ€è¦åœ¨éªŒè¯æœåŠ¡å™¨ä¸Šè¿›è¡Œç™»å½•æ“ä½œï¼Œè€Œä¸æ˜¯ç›´æ¥è¯·æ±‚Tokenï¼ŒéªŒè¯ç™»å½•è¯·æ±‚åœ°å€ï¼šhttp://localhost:8500/sso/oauth/authorize?client_id=web\u0026amp;response_type=token\næ³¨æ„response_typeä¸€å®šè¦æ˜¯tokenç±»å‹ï¼Œè¿™æ ·æ‰ä¼šç›´æ¥è¿”å›Tokenï¼Œæµè§ˆå™¨å‘èµ·è¯·æ±‚åï¼Œå¯ä»¥çœ‹åˆ°ç†Ÿæ‚‰è€Œåˆé™Œç”Ÿçš„ç•Œé¢ï¼Œæ²¡é”™ï¼Œå®é™…ä¸Šè¿™é‡Œå°±æ˜¯ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰è®²è§£çš„SpringSecurityè¿›è¡Œç™»é™†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é…ç½®ä¸€ä¸‹è®°ä½æˆ‘ä¹‹ç±»çš„åŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ï¼š\nä½†æ˜¯ç™»å½•ä¹‹åæˆ‘ä»¬å‘ç°å‡ºç°äº†ä¸€ä¸ªé”™è¯¯ï¼š\nè¿™æ˜¯å› ä¸ºç™»å½•æˆåŠŸä¹‹åï¼ŒéªŒè¯æœåŠ¡å™¨éœ€è¦å°†ç»“æœç»™å›å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥éœ€è¦æä¾›å®¢æˆ·ç«¯çš„å›è°ƒåœ°å€ï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¼šè¢«é‡å®šå‘åˆ°æŒ‡å®šçš„å›è°ƒåœ°å€å¹¶ä¸”è¯·æ±‚ä¸­ä¼šæºå¸¦Tokenä¿¡æ¯ï¼Œè¿™é‡Œæˆ‘ä»¬éšä¾¿é…ç½®ä¸€ä¸ªå›è°ƒåœ°å€ï¼š\n@Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients .inMemory() .withClient(\u0026#34;web\u0026#34;) .secret(encoder.encode(\u0026#34;654321\u0026#34;)) .autoApprove(false) .scopes(\u0026#34;book\u0026#34;, \u0026#34;user\u0026#34;, \u0026#34;borrow\u0026#34;) .redirectUris(\u0026#34;http://localhost:8201/login\u0026#34;) //å¯ä»¥å†™å¤šä¸ªï¼Œå½“æœ‰å¤šä¸ªæ—¶éœ€è¦åœ¨éªŒè¯è¯·æ±‚ä¸­æŒ‡å®šä½¿ç”¨å“ªä¸ªåœ°å€è¿›è¡Œå›è°ƒ .authorizedGrantTypes(\u0026#34;client_credentials\u0026#34;, \u0026#34;password\u0026#34;, \u0026#34;implicit\u0026#34;, \u0026#34;authorization_code\u0026#34;, \u0026#34;refresh_token\u0026#34;); } æ¥ç€é‡å¯éªŒè¯æœåŠ¡å™¨ï¼Œå†æ¬¡è®¿é—®ï¼š\nå¯ä»¥çœ‹åˆ°è¿™é‡Œä¼šè®©æˆ‘ä»¬é€‰æ‹©å“ªäº›èŒƒå›´è¿›è¡Œæˆæƒï¼Œå°±åƒæˆ‘ä»¬åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ç™»é™†ä¸€æ ·ï¼Œä¼šè®©æˆ‘ä»¬æˆäºˆç”¨æˆ·ä¿¡æ¯æƒé™ã€æ”¯ä»˜æƒé™ã€ä¿¡ç”¨æŸ¥è¯¢æƒé™ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±å†³å®šè¦ä¸è¦ç»™å®¢æˆ·ç«¯æˆäºˆè®¿é—®è¿™äº›èµ„æºçš„æƒé™ï¼Œè¿™é‡Œæˆ‘ä»¬å…¨éƒ¨é€‰æ‹©æˆäºˆï¼š\næˆäºˆä¹‹åï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨è¢«é‡å®šå‘åˆ°æˆ‘ä»¬åˆšåˆšæŒ‡å®šçš„å›è°ƒåœ°å€ä¸­ï¼Œå¹¶ä¸”æºå¸¦äº†Tokenä¿¡æ¯ï¼Œç°åœ¨æˆ‘ä»¬æ¥æ ¡éªŒä¸€ä¸‹çœ‹çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°ï¼ŒTokenä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚\næœ€åæˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬å››ç§æœ€å®‰å…¨çš„æˆæƒç æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼å…¶å®æµç¨‹å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯è¯·æ±‚çš„æ˜¯codeç±»å‹ï¼šhttp://localhost:8500/sso/oauth/authorize?client_id=web\u0026amp;response_type=code\nå¯ä»¥çœ‹åˆ°è®¿é—®ä¹‹åï¼Œä¾ç„¶ä¼šè¿›å…¥åˆ°å›è°ƒåœ°å€ï¼Œä½†æ˜¯è¿™æ—¶ç»™çš„å°±æ˜¯æˆæƒç äº†ï¼Œè€Œä¸æ˜¯ç›´æ¥ç»™Tokenï¼Œé‚£ä¹ˆè¿™ä¸ªTokenè¯¥æ€ä¹ˆè·å–å‘¢ï¼Ÿ\næŒ‰ç…§æˆ‘ä»¬ä¹‹å‰è®²è§£çš„åŸç†ï¼Œæˆ‘ä»¬éœ€è¦æºå¸¦æˆæƒç å’Œsecretä¸€èµ·è¯·æ±‚ï¼Œæ‰èƒ½æ‹¿åˆ°Tokenï¼Œæ­£å¸¸æƒ…å†µä¸‹æ˜¯ç”±å›è°ƒçš„æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œæˆ‘ä»¬å°±åœ¨Postmanä¸­è¿›è¡Œï¼Œæˆ‘ä»¬å¤åˆ¶åˆšåˆšå¾—åˆ°çš„æˆæƒç ï¼Œæ¥å£ä¾ç„¶æ˜¯localhost:8500/sso/oauth/tokenï¼š\nå¯ä»¥çœ‹åˆ°ç»“æœä¹Ÿæ˜¯æ­£å¸¸è¿”å›äº†Tokenä¿¡æ¯ï¼š\nè¿™æ ·æˆ‘ä»¬å››ç§æœ€åŸºæœ¬çš„Tokenè¯·æ±‚æ–¹å¼å°±å®ç°äº†ã€‚\næœ€åè¿˜æœ‰ä¸€ä¸ªæ˜¯åˆ·æ–°ä»¤ç‰Œä½¿ç”¨çš„ï¼Œå½“æˆ‘ä»¬çš„Tokenè¿‡æœŸæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªrefresh_tokenæ¥ç”³è¯·ä¸€ä¸ªæ–°çš„Tokenï¼š\nä½†æ˜¯æ‰§è¡Œä¹‹åæˆ‘ä»¬å‘ç°ä¼šç›´æ¥å‡ºç°ä¸€ä¸ªå†…éƒ¨é”™è¯¯ï¼š\næŸ¥çœ‹æ—¥å¿—å‘ç°ï¼Œè¿™é‡Œè¿˜éœ€è¦æˆ‘ä»¬å•ç‹¬é…ç½®ä¸€ä¸ªUserDetailsServiceï¼Œæˆ‘ä»¬ç›´æ¥æŠŠSecurityä¸­çš„å®ä¾‹æ³¨å†Œä¸ºBeanï¼š\n@Bean @Override public UserDetailsService userDetailsServiceBean() throws Exception { return super.userDetailsServiceBean(); } ç„¶ååœ¨Endpointä¸­è®¾ç½®ï¼š\n@Resource UserDetailsService service; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) { endpoints .userDetailsService(service) .authenticationManager(manager); } æœ€åå†æ¬¡å°è¯•åˆ·æ–°Tokenï¼š\nOKï¼ŒæˆåŠŸåˆ·æ–°Tokenï¼Œè¿”å›äº†ä¸€ä¸ªæ–°çš„ã€‚\nåŸºäº@EnableOAuth2Ssoå®ç° #\rå‰é¢æˆ‘ä»¬å°†éªŒè¯æœåŠ¡å™¨å·²ç»æ­å»ºå®Œæˆäº†ï¼Œç°åœ¨æˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸‹å•ç‚¹ç™»é™†å§ï¼ŒSpringCloudä¸ºæˆ‘ä»¬æä¾›äº†å®¢æˆ·ç«¯çš„ç›´æ¥å®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ³¨è§£å’Œå°‘é‡é…ç½®å³å¯å°†æˆ‘ä»¬çš„æœåŠ¡ä½œä¸ºä¸€ä¸ªå•ç‚¹ç™»é™†åº”ç”¨ï¼Œä½¿ç”¨çš„æ˜¯ç¬¬å››ç§æˆæƒç æ¨¡å¼ã€‚\nä¸€å¥è¯æ¥è¯´å°±æ˜¯ï¼Œè¿™ç§æ¨¡å¼åªæ˜¯å°†éªŒè¯æ–¹å¼ç”±åŸæœ¬çš„é»˜è®¤ç™»å½•å½¢å¼æ”¹å˜ä¸ºäº†ç»Ÿä¸€åœ¨æˆæƒæœåŠ¡å™¨ç™»é™†çš„å½¢å¼ã€‚\né¦–å…ˆè¿˜æ˜¯ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-security\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-oauth2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.5.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; æˆ‘ä»¬åªéœ€è¦ç›´æ¥åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ å³å¯ï¼š\n@EnableOAuth2Sso @SpringBootApplication public class BookApplication { public static void main(String[] args) { SpringApplication.run(BookApplication.class, args); } } æˆ‘ä»¬ä¸éœ€è¦è¿›è¡Œé¢å¤–çš„é…ç½®ç±»ï¼Œå› ä¸ºè¿™ä¸ªæ³¨è§£å·²ç»å¸®æˆ‘ä»¬åšäº†ï¼š\n@Target({ElementType.TYPE}) @Retention(RetentionPolicy.RUNTIME) @Documented @EnableOAuth2Client @EnableConfigurationProperties({OAuth2SsoProperties.class}) @Import({OAuth2SsoDefaultConfiguration.class, OAuth2SsoCustomConfiguration.class, ResourceServerTokenServicesConfiguration.class}) public @interface EnableOAuth2Sso { } å¯ä»¥çœ‹åˆ°å®ƒç›´æ¥æ³¨å†Œäº†OAuth2SsoDefaultConfigurationï¼Œè€Œè¿™ä¸ªç±»å°±æ˜¯å¸®åŠ©æˆ‘ä»¬å¯¹Securityè¿›è¡Œé…ç½®çš„ï¼š\n@Configuration @Conditional({NeedsWebSecurityCondition.class}) public class OAuth2SsoDefaultConfiguration extends WebSecurityConfigurerAdapter { //ç›´æ¥ç»§æ‰¿çš„WebSecurityConfigurerAdapterï¼Œå¸®æˆ‘ä»¬æŠŠéªŒè¯è®¾ç½®éƒ½å†™å¥½äº† private final ApplicationContext applicationContext; public OAuth2SsoDefaultConfiguration(ApplicationContext applicationContext) { this.applicationContext = applicationContext; } æ¥ç€æˆ‘ä»¬éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®æˆ‘ä»¬çš„éªŒè¯æœåŠ¡å™¨ç›¸å…³ä¿¡æ¯ï¼š\nsecurity: oauth2: client: #ä¸å¤šè¯´äº† client-id: web client-secret: 654321 #Tokenè·å–åœ°å€ access-token-uri: http://localhost:8500/sso/oauth/token #éªŒè¯é¡µé¢åœ°å€ user-authorization-uri: http://localhost:8500/sso/oauth/authorize resource: #Tokenä¿¡æ¯è·å–å’Œæ ¡éªŒåœ°å€ token-info-uri: http://localhost:8500/sso/oauth/check_token ç°åœ¨æˆ‘ä»¬å°±å¼€å¯å›¾ä¹¦æœåŠ¡ï¼Œè°ƒç”¨å›¾ä¹¦æ¥å£ï¼š\nå¯ä»¥çœ‹åˆ°åœ¨å‘ç°æ²¡æœ‰ç™»å½•éªŒè¯æ—¶ï¼Œä¼šç›´æ¥è·³è½¬åˆ°æˆæƒé¡µé¢ï¼Œè¿›è¡Œæˆæƒç™»å½•ï¼Œä¹‹åæ‰å¯ä»¥ç»§ç»­è®¿é—®å›¾ä¹¦æœåŠ¡ï¼š\né‚£ä¹ˆç”¨æˆ·ä¿¡æ¯å‘¢ï¼Ÿæ˜¯å¦ä¹Ÿä¸€å¹¶ä¿å­˜è¿‡æ¥äº†ï¼Ÿæˆ‘ä»¬è¿™é‡Œç›´æ¥è·å–ä¸€ä¸‹SpringSecurityçš„ContextæŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ï¼Œè·å–æ–¹å¼è·Ÿæˆ‘ä»¬ä¹‹å‰çš„è§†é¢‘ä¸­è®²è§£çš„æ˜¯ä¸€æ ·çš„ï¼š\n@RequestMapping(\u0026#34;/book/{bid}\u0026#34;) Book findBookById(@PathVariable(\u0026#34;bid\u0026#34;) int bid){ //é€šè¿‡SecurityContextHolderå°†ç”¨æˆ·ä¿¡æ¯å–å‡º SecurityContext context = SecurityContextHolder.getContext(); System.out.println(context.getAuthentication()); return service.getBookById(bid); } å†æ¬¡è®¿é—®å›¾ä¹¦ç®¡ç†æ¥å£ï¼Œå¯ä»¥çœ‹åˆ°ï¼š\nè¿™é‡Œä½¿ç”¨çš„ä¸æ˜¯ä¹‹å‰çš„UsernamePasswordAuthenticationTokenä¹Ÿä¸æ˜¯RememberMeAuthenticationTokenï¼Œè€Œæ˜¯æ–°çš„OAuth2Authenticationï¼Œå®ƒä¿å­˜äº†éªŒè¯æœåŠ¡å™¨çš„ä¸€äº›ä¿¡æ¯ï¼Œä»¥åŠç»è¿‡æˆ‘ä»¬ä¹‹å‰çš„ç™»é™†æµç¨‹ä¹‹åï¼ŒéªŒè¯æœåŠ¡å™¨å‘æ”¾ç»™å®¢æˆ·ç«¯çš„Tokenä¿¡æ¯ï¼Œå¹¶é€šè¿‡Tokenä¿¡æ¯åœ¨éªŒè¯æœåŠ¡å™¨è¿›è¡ŒéªŒè¯è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œæœ€åä¿å­˜åˆ°Sessionä¸­ï¼Œè¡¨ç¤ºç”¨æˆ·å·²éªŒè¯ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šè¿˜æ˜¯è¦ä¾èµ–æµè§ˆå™¨å­˜Cookieçš„ã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬å°†æ‰€æœ‰çš„æœåŠ¡éƒ½ä½¿ç”¨è¿™ç§æ–¹å¼è¿›è¡ŒéªŒè¯ï¼Œåˆ«å¿˜äº†æŠŠé‡å®šå‘åœ°å€ç»™æ‰€æœ‰æœåŠ¡éƒ½åŠ ä¸Šï¼š\n@Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients .inMemory() .withClient(\u0026#34;web\u0026#34;) .secret(encoder.encode(\u0026#34;654321\u0026#34;)) .autoApprove(true) //è¿™é‡ŒæŠŠè‡ªåŠ¨å®¡æ‰¹å¼€äº†ï¼Œå°±ä¸ç”¨å†å»æ‰‹åŠ¨é€‰åŒæ„äº† .scopes(\u0026#34;book\u0026#34;, \u0026#34;user\u0026#34;, \u0026#34;borrow\u0026#34;) .redirectUris(\u0026#34;http://localhost:8101/login\u0026#34;, \u0026#34;http://localhost:8201/login\u0026#34;, \u0026#34;http://localhost:8301/login\u0026#34;) .authorizedGrantTypes(\u0026#34;client_credentials\u0026#34;, \u0026#34;password\u0026#34;, \u0026#34;implicit\u0026#34;, \u0026#34;authorization_code\u0026#34;, \u0026#34;refresh_token\u0026#34;); } è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å®ç°åªåœ¨éªŒè¯æœåŠ¡å™¨ç™»é™†ï¼Œå¦‚æœç™»é™†è¿‡å…¶ä»–çš„æœåŠ¡éƒ½å¯ä»¥è®¿é—®äº†ã€‚\nä½†æ˜¯æˆ‘ä»¬å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç”±äºSESSIONä¸åŒæ­¥ï¼Œæ¯æ¬¡åˆ‡æ¢ä¸åŒçš„æœåŠ¡è¿›è¡Œè®¿é—®éƒ½ä¼šé‡æ–°å¯¼éªŒè¯æœåŠ¡å™¨å»éªŒè¯ä¸€æ¬¡ï¼š\nè¿™é‡Œæœ‰ä¸¤ä¸ªæ–¹æ¡ˆï¼š\nåƒä¹‹å‰ä¸€æ ·åšSESSIONç»Ÿä¸€å­˜å‚¨ è®¾ç½®context-pathè·¯å¾„ï¼Œæ¯ä¸ªæœåŠ¡å•ç‹¬è®¾ç½®ï¼Œå°±ä¸ä¼šæ‰“æ¶äº† ä½†æ˜¯è¿™æ ·ä¾ç„¶æ²¡æ³•è§£å†³æœåŠ¡é—´è°ƒç”¨çš„é—®é¢˜ï¼Œæ‰€ä»¥ä»…ä»…ä¾é å•ç‚¹ç™»é™†çš„æ¨¡å¼ä¸å¤ªè¡Œã€‚\nåŸºäº@EnableResourceServerå®ç° #\rå‰é¢æˆ‘ä»¬è®²è§£äº†å°†æˆ‘ä»¬çš„æœåŠ¡ä½œä¸ºå•ç‚¹ç™»é™†åº”ç”¨ç›´æ¥å®ç°å•ç‚¹ç™»é™†ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬å¦‚æœæ˜¯ä»¥ç¬¬ä¸‰æ–¹åº”ç”¨è¿›è¡Œè®¿é—®å‘¢ï¼Ÿè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦å°†æˆ‘ä»¬çš„æœåŠ¡ä½œä¸ºèµ„æºæœåŠ¡äº†ï¼Œä½œä¸ºèµ„æºæœåŠ¡å°±ä¸ä¼šå†æä¾›éªŒè¯çš„è¿‡ç¨‹ï¼Œè€Œæ˜¯ç›´æ¥è¦æ±‚è¯·æ±‚æ—¶æºå¸¦Tokenï¼Œè€ŒéªŒè¯è¿‡ç¨‹æˆ‘ä»¬è¿™é‡Œå°±ç»§ç»­ç”¨Postmanæ¥å®Œæˆï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬å¸¸è§çš„æ¨¡å¼ã€‚\nä¸€å¥è¯æ¥è¯´ï¼Œè·Ÿä¸Šé¢ç›¸æ¯”ï¼Œæˆ‘ä»¬åªéœ€è¦æºå¸¦Tokenå°±èƒ½è®¿é—®è¿™äº›èµ„æºæœåŠ¡å™¨äº†ï¼Œå®¢æˆ·ç«¯è¢«ç‹¬ç«‹äº†å‡ºæ¥ï¼Œç”¨äºæºå¸¦Tokenå»è®¿é—®è¿™äº›æœåŠ¡ã€‚\næˆ‘ä»¬ä¹Ÿåªéœ€è¦æ·»åŠ ä¸€ä¸ªæ³¨è§£å’Œå°‘é‡é…ç½®å³å¯ï¼š\n@EnableResourceServer @SpringBootApplication public class BookApplication { public static void main(String[] args) { SpringApplication.run(BookApplication.class, args); } } é…ç½®ä¸­åªéœ€è¦ï¼š\nsecurity: oauth2: client: #åŸºæ“ client-id: web client-secret: 654321 resource: #å› ä¸ºèµ„æºæœåŠ¡å™¨å¾—éªŒè¯ä½ çš„Tokenæ˜¯å¦æœ‰è®¿é—®æ­¤èµ„æºçš„æƒé™ä»¥åŠç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥åªéœ€è¦ä¸€ä¸ªéªŒè¯åœ°å€ token-info-uri: http://localhost:8500/sso/oauth/check_token é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬å¯åŠ¨æœåŠ¡å™¨ï¼Œç›´æ¥è®¿é—®ä¼šå‘ç°ï¼š\nè¿™æ˜¯ç”±äºæˆ‘ä»¬çš„è¯·æ±‚å¤´ä¸­æ²¡æœ‰æºå¸¦Tokenä¿¡æ¯ï¼Œç°åœ¨æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è®¿é—®æ­¤èµ„æºï¼š\nåœ¨URLåé¢æ·»åŠ access_tokenè¯·æ±‚å‚æ•°ï¼Œå€¼ä¸ºTokenå€¼ åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ Authorizationï¼Œå€¼ä¸ºBearer +Tokenå€¼ æˆ‘ä»¬å…ˆæ¥è¯•è¯•çœ‹æœ€ç®€çš„ä¸€ç§ï¼š\nå¦ä¸€ç§æˆ‘ä»¬éœ€è¦ä½¿ç”¨Postmanæ¥å®Œæˆï¼š\næ·»åŠ éªŒè¯ä¿¡æ¯åï¼Œä¼šå¸®åŠ©æˆ‘ä»¬è½¬æ¢æˆè¯·æ±‚å¤´ä¿¡æ¯ï¼š\nè¿™æ ·æˆ‘ä»¬å°±å°†èµ„æºæœåŠ¡å™¨æ­å»ºå®Œæˆäº†ã€‚\næˆ‘ä»¬æ¥ç€æ¥çœ‹å¦‚ä½•å¯¹èµ„æºæœåŠ¡å™¨è¿›è¡Œæ·±åº¦è‡ªå®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå…¶ç¼–å†™ä¸€ä¸ªé…ç½®ç±»ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨å¸Œæœ›ç”¨æˆ·æˆæƒäº†æŸä¸ªScopeæ‰å¯ä»¥è®¿é—®æ­¤æœåŠ¡ï¼š\n@Configuration public class ResourceConfiguration extends ResourceServerConfigurerAdapter { //ç»§æ‰¿æ­¤ç±»è¿›è¡Œé«˜åº¦è‡ªå®šä¹‰ @Override public void configure(HttpSecurity http) throws Exception { //è¿™é‡Œä¹Ÿæœ‰HttpSecurityå¯¹è±¡ï¼Œæ–¹ä¾¿æˆ‘ä»¬é…ç½®SpringSecurity http .authorizeRequests() .anyRequest().access(\u0026#34;#oauth2.hasScope(\u0026#39;lbwnb\u0026#39;)\u0026#34;); //æ·»åŠ è‡ªå®šä¹‰è§„åˆ™ //Tokenå¿…é¡»è¦æœ‰æˆ‘ä»¬è‡ªå®šä¹‰scopeæˆæƒæ‰å¯ä»¥è®¿é—®æ­¤èµ„æº } } å¯ä»¥çœ‹åˆ°å½“æ²¡æœ‰å¯¹åº”çš„scopeæˆæƒæ—¶ï¼Œé‚£ä¹ˆä¼šç›´æ¥è¿”å›insufficient_scopeé”™è¯¯ï¼š\nä¸çŸ¥é“å„ä½æ˜¯å¦æœ‰å‘ç°ï¼Œå®é™…ä¸Šèµ„æºæœåŠ¡å™¨å®Œå…¨æ²¡æœ‰å¿…è¦å°†Securityçš„ä¿¡æ¯ä¿å­˜åœ¨Sessionä¸­äº†ï¼Œå› ä¸ºç°åœ¨åªéœ€è¦å°†Tokenå‘Šè¯‰èµ„æºæœåŠ¡å™¨ï¼Œé‚£ä¹ˆèµ„æºæœåŠ¡å™¨å°±å¯ä»¥è”ç³»éªŒè¯æœåŠ¡å™¨ï¼Œå¾—åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨ä¹‹å‰çš„Sessionå­˜å‚¨æœºåˆ¶äº†ï¼Œæ‰€ä»¥ä½ ä¼šå‘ç°HttpSessionä¸­æ²¡æœ‰SPRING_SECURITY_CONTEXTï¼Œç°åœ¨Securityä¿¡æ¯éƒ½æ˜¯é€šè¿‡è¿æ¥èµ„æºæœåŠ¡å™¨è·å–ã€‚\næ¥ç€æˆ‘ä»¬å°†æ‰€æœ‰çš„æœåŠ¡éƒ½\nä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨RestTemplateè¿›è¡ŒæœåŠ¡é—´çš„è¿œç¨‹è°ƒç”¨æ—¶ï¼Œä¼šå¾—åˆ°ä»¥ä¸‹é”™è¯¯ï¼š\nå®é™…ä¸Šè¿™æ˜¯å› ä¸ºåœ¨æœåŠ¡è°ƒç”¨æ—¶æ²¡æœ‰æºå¸¦Tokenä¿¡æ¯ï¼Œæˆ‘ä»¬å¾—æƒ³ä¸ªåŠæ³•æŠŠç”¨æˆ·ä¼ æ¥çš„Tokenä¿¡æ¯åœ¨è¿›è¡Œè¿œç¨‹è°ƒç”¨æ—¶ä¹Ÿæºå¸¦ä¸Šï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨OAuth2RestTemplateï¼Œå®ƒä¼šåœ¨è¯·æ±‚å…¶ä»–æœåŠ¡æ—¶æºå¸¦å½“å‰è¯·æ±‚çš„Tokenä¿¡æ¯ã€‚å®ƒç»§æ‰¿è‡ªRestTemplateï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥å®šä¹‰ä¸€ä¸ªBeanï¼š\n@Configuration public class WebConfiguration { @Resource OAuth2ClientContext context; @Bean public OAuth2RestTemplate restTemplate(){ return new OAuth2RestTemplate(new ClientCredentialsResourceDetails(), context); } } æ¥ç€æˆ‘ä»¬ç›´æ¥æ›¿æ¢æ‰ä¹‹å‰çš„RestTemplateå³å¯ï¼š\n@Service public class BorrowServiceImpl implements BorrowService { @Resource BorrowMapper mapper; @Resource OAuth2RestTemplate template; @Override public UserBorrowDetail getUserBorrowDetailByUid(int uid) { List\u0026lt;Borrow\u0026gt; borrow = mapper.getBorrowsByUid(uid); User user = template.getForObject(\u0026#34;http://localhost:8101/user/\u0026#34;+uid, User.class); //è·å–æ¯ä¸€æœ¬ä¹¦çš„è¯¦ç»†ä¿¡æ¯ List\u0026lt;Book\u0026gt; bookList = borrow .stream() .map(b -\u0026gt; template.getForObject(\u0026#34;http://localhost:8201/book/\u0026#34;+b.getBid(), Book.class)) .collect(Collectors.toList()); return new UserBorrowDetail(user, bookList); } } å¯ä»¥çœ‹åˆ°æœåŠ¡æˆåŠŸè°ƒç”¨äº†ï¼š\nç°åœ¨æˆ‘ä»¬æ¥å°†NacosåŠ å…¥ï¼Œå¹¶é€šè¿‡Feignå®ç°è¿œç¨‹è°ƒç”¨ã€‚\nä¾èµ–è¿˜æ˜¯è´´ä¸€ä¸‹ï¼Œä¸ç„¶æ‰¾ä¸åˆ°ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-alibaba-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2021.0.1.0\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-nacos-discovery\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-loadbalancer\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; æ‰€æœ‰æœåŠ¡éƒ½å·²ç»æ³¨å†ŒæˆåŠŸäº†ï¼š\næ¥ç€æˆ‘ä»¬é…ç½®ä¸€ä¸‹å€Ÿé˜…æœåŠ¡çš„è´Ÿè½½å‡è¡¡ï¼š\n@Configuration public class WebConfiguration { @Resource OAuth2ClientContext context; @LoadBalanced //å’ŒRestTemplateä¸€æ ·ç›´æ¥æ·»åŠ æ³¨è§£å°±è¡Œäº† @Bean public OAuth2RestTemplate restTemplate(){ return new OAuth2RestTemplate(new ClientCredentialsResourceDetails(), context); } } ç°åœ¨æˆ‘ä»¬æ¥æŠŠå®ƒæ›¿æ¢ä¸ºFeignï¼Œè€æ ·å­ï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯ï¼š\n@FeignClient(\u0026#34;user-service\u0026#34;) public interface UserClient { @RequestMapping(\u0026#34;/user/{uid}\u0026#34;) User getUserById(@PathVariable(\u0026#34;uid\u0026#34;) int uid); } @FeignClient(\u0026#34;book-service\u0026#34;) public interface BookClient { @RequestMapping(\u0026#34;/book/{bid}\u0026#34;) Book getBookById(@PathVariable(\u0026#34;bid\u0026#34;) int bid); } ä½†æ˜¯é…ç½®å®Œæˆä¹‹åï¼Œåˆå‡ºç°åˆšåˆšçš„é—®é¢˜äº†ï¼ŒOpenFeignä¹Ÿæ²¡æœ‰æºå¸¦Tokenè¿›è¡Œè®¿é—®ï¼š\né‚£ä¹ˆæ€ä¹ˆé…ç½®Feignæºå¸¦Tokenè®¿é—®å‘¢ï¼Ÿé‡åˆ°è¿™ç§é—®é¢˜ç›´æ¥å»å®˜æ–¹æŸ¥ï¼šhttps://docs.spring.io/spring-cloud-openfeign/docs/current/reference/html/#oauth2-supportï¼Œéå¸¸ç®€å•ï¼Œä¸¤ä¸ªé…ç½®å°±æå®šï¼š\nfeign: oauth2: #å¼€å¯Oauthæ”¯æŒï¼Œè¿™æ ·å°±ä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦Tokenäº† enabled: true #åŒæ—¶å¼€å¯è´Ÿè½½å‡è¡¡æ”¯æŒ load-balanced: true é‡å¯æœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœOKäº†ï¼š\nè¿™æ ·æˆ‘ä»¬å°±æˆåŠŸå°†ä¹‹å‰çš„ä¸‰ä¸ªæœåŠ¡ä½œä¸ºèµ„æºæœåŠ¡å™¨äº†ï¼Œæ³¨æ„å’Œæˆ‘ä»¬ä¸Šé¢çš„ä½œä¸ºå®¢æˆ·ç«¯æ˜¯ä¸åŒçš„ï¼Œå°†æœåŠ¡ç›´æ¥ä½œä¸ºå®¢æˆ·ç«¯ç›¸å½“äºåªéœ€è¦éªŒè¯é€šè¿‡å³å¯ï¼Œå¹¶ä¸”è¿˜æ˜¯è¦ä¿å­˜Sessionä¿¡æ¯ï¼Œç›¸å½“äºåªæ˜¯å°†ç™»å½•æµç¨‹æ¢åˆ°ç»Ÿä¸€çš„éªŒè¯æœåŠ¡å™¨ä¸Šè¿›è¡Œç½¢äº†ã€‚è€Œå°†å…¶ä½œä¸ºèµ„æºæœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±éœ€è¦å¦å¤–æ‰¾å®¢æˆ·ç«¯ï¼ˆå¯ä»¥æ˜¯æµè§ˆå™¨ã€å°ç¨‹åºã€Appã€ç¬¬ä¸‰æ–¹æœåŠ¡ç­‰ï¼‰æ¥è®¿é—®ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯éœ€è¦å…ˆè¿›è¡ŒéªŒè¯ç„¶åå†é€šè¿‡æºå¸¦Tokenè¿›è¡Œè®¿é—®ï¼Œè¿™ç§æ¨¡å¼æ˜¯æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„æ¨¡å¼ã€‚\nä½¿ç”¨jwtå­˜å‚¨Token #\rå®˜ç½‘ï¼šhttps://jwt.io\nJSON Web Tokenä»¤ç‰Œï¼ˆJWTï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼ˆ\rRFC 7519ï¼‰ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘å’Œè‡ªæˆä¸€ä½“çš„æ–¹å¼ï¼Œç”¨äºåœ¨å„æ–¹ä¹‹é—´ä½œä¸ºJSONå¯¹è±¡å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚JWTå¯ä»¥ä½¿ç”¨å¯†é’¥ï¼ˆä½¿ç”¨HMACç®—æ³•ï¼‰æˆ–ä½¿ç”¨RSAæˆ–ECDSAè¿›è¡Œå…¬é’¥/ç§é’¥å¯¹è¿›è¡Œç­¾åã€‚\nå®é™…ä¸Šï¼Œæˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯æºå¸¦Tokenå‘èµ„æºæœåŠ¡å™¨å‘èµ·è¯·æ±‚åï¼Œèµ„æºæœåŠ¡å™¨ç”±äºä¸çŸ¥é“æˆ‘ä»¬Tokençš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥éœ€è¦å‘éªŒè¯æœåŠ¡å™¨è¯¢é—®æ­¤Tokençš„è®¤è¯ä¿¡æ¯ï¼Œè¿™æ ·æ‰èƒ½å¾—åˆ°Tokenä»£è¡¨çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯å„ä½æ˜¯å¦è€ƒè™‘è¿‡ï¼Œå¦‚æœæ¯æ¬¡ç”¨æˆ·è¯·æ±‚éƒ½å»æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œé‚£ä¹ˆåœ¨å¤§é‡è¯·æ±‚ä¸‹ï¼ŒéªŒè¯æœåŠ¡å™¨çš„å‹åŠ›å¯èƒ½ä¼šéå¸¸çš„å¤§ã€‚è€Œä½¿ç”¨JWTä¹‹åï¼ŒTokenä¸­ä¼šç›´æ¥ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™æ ·èµ„æºæœåŠ¡å™¨å°±ä¸å†éœ€è¦è¯¢é—®éªŒè¯æœåŠ¡å™¨ï¼Œè‡ªè¡Œå°±å¯ä»¥å®Œæˆè§£æï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¸è”ç³»éªŒè¯æœåŠ¡å™¨å°±èƒ½ç›´æ¥å®ŒæˆéªŒè¯ã€‚\nJWTä»¤ç‰Œçš„æ ¼å¼å¦‚ä¸‹ï¼š\nä¸€ä¸ªJWTä»¤ç‰Œç”±3éƒ¨åˆ†ç»„æˆï¼šæ ‡å¤´(Header)ã€æœ‰æ•ˆè½½è·(Payload)å’Œç­¾å(Signature)ã€‚åœ¨ä¼ è¾“çš„æ—¶å€™ï¼Œä¼šå°†JWTçš„3éƒ¨åˆ†åˆ†åˆ«è¿›è¡ŒBase64ç¼–ç åç”¨.è¿›è¡Œè¿æ¥å½¢æˆæœ€ç»ˆéœ€è¦ä¼ è¾“çš„å­—ç¬¦ä¸²ã€‚\næ ‡å¤´ï¼šåŒ…å«ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚JWTç­¾åæ‰€ä½¿ç”¨çš„åŠ å¯†ç®—æ³•ï¼Œè¿˜æœ‰ç±»å‹ï¼Œè¿™é‡Œç»Ÿä¸€éƒ½æ˜¯JWTã€‚ æœ‰æ•ˆè½½è·ï¼šåŒ…æ‹¬ç”¨æˆ·åç§°ã€ä»¤ç‰Œå‘å¸ƒæ—¶é—´ã€è¿‡æœŸæ—¶é—´ã€JWT IDç­‰ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ·»åŠ å­—æ®µï¼Œæˆ‘ä»¬çš„ç”¨æˆ·ä¿¡æ¯ä¸€èˆ¬éƒ½åœ¨è¿™é‡Œå­˜æ”¾ã€‚ ç­¾åï¼šé¦–å…ˆéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼Œè¯¥å¯†é’¥ä»…ä»…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œä¿è¯ä¸èƒ½è®©å…¶ä»–ç”¨æˆ·çŸ¥é“ã€‚ç„¶åä½¿ç”¨Headerä¸­æŒ‡å®šçš„ç®—æ³•å¯¹Headerå’ŒPayloadè¿›è¡Œbase64åŠ å¯†ä¹‹åçš„ç»“æœé€šè¿‡å¯†é’¥è®¡ç®—å“ˆå¸Œå€¼ï¼Œç„¶åå°±å¾—å‡ºä¸€ä¸ªç­¾åå“ˆå¸Œã€‚è¿™ä¸ªä¼šç”¨äºä¹‹åéªŒè¯å†…å®¹æ˜¯å¦è¢«ç¯¡æ”¹ã€‚ è¿™é‡Œè¿˜æ˜¯è¡¥å……ä¸€ä¸‹ä¸€äº›æ¦‚å¿µï¼Œå› ä¸ºå¾ˆå¤šä¸œè¥¿éƒ½æ˜¯æˆ‘ä»¬ä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡çš„ï¼š\nBase64ï¼š å°±æ˜¯åŒ…æ‹¬å°å†™å­—æ¯a-zã€å¤§å†™å­—æ¯A-Zã€æ•°å­—0-9ã€ç¬¦å·\u0026quot;+\u0026quot;ã€\u0026quot;/\u0026ldquo;ä¸€å…±64ä¸ªå­—ç¬¦çš„å­—ç¬¦é›†ï¼ˆæœ«å°¾è¿˜æœ‰1ä¸ªæˆ–å¤šä¸ª=ç”¨æ¥å‡‘å¤Ÿå­—èŠ‚æ•°ï¼‰ï¼Œä»»ä½•çš„ç¬¦å·éƒ½å¯ä»¥è½¬æ¢æˆè¿™ä¸ªå­—ç¬¦é›†ä¸­çš„å­—ç¬¦ï¼Œè¿™ä¸ªè½¬æ¢è¿‡ç¨‹å°±å«åšBase64ç¼–ç ï¼Œç¼–ç ä¹‹åä¼šç”ŸæˆåªåŒ…å«ä¸Šè¿°64ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ç›¸åï¼Œå¦‚æœéœ€è¦åŸæœ¬çš„å†…å®¹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›è¡ŒBase64è§£ç ï¼Œå›åˆ°åŸæœ‰çš„æ ·å­ã€‚\npublic void test(){ String str = \u0026#34;ä½ ä»¬å¯èƒ½ä¸çŸ¥é“åªç”¨20ä¸‡èµ¢åˆ°578ä¸‡æ˜¯ä»€ä¹ˆæ¦‚å¿µ\u0026#34;; //Base64ä¸åªæ˜¯å¯ä»¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œç¼–ç ï¼Œä»»ä½•byte[]æ•°æ®éƒ½å¯ä»¥ï¼Œç¼–ç ç»“æœå¯ä»¥æ˜¯byte[]ï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸² String encodeStr = Base64.getEncoder().encodeToString(str.getBytes()); System.out.println(\u0026#34;Base64ç¼–ç åçš„å­—ç¬¦ä¸²ï¼š\u0026#34;+encodeStr); System.out.println(\u0026#34;è§£ç åçš„å­—ç¬¦ä¸²ï¼š\u0026#34;+new String(Base64.getDecoder().decode(encodeStr))); } æ³¨æ„Base64ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œåªæ˜¯ä¸€ç§ä¿¡æ¯çš„ç¼–ç æ–¹å¼è€Œå·²ã€‚\nåŠ å¯†ç®—æ³•ï¼š åŠ å¯†ç®—æ³•åˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œå…¶ä¸­**å¯¹ç§°åŠ å¯†ï¼ˆSymmetric Cryptographyï¼‰**æ¯”è¾ƒå¥½ç†è§£ï¼Œå°±åƒä¸€æŠŠé”é…äº†ä¸¤æŠŠé’¥åŒ™ä¸€æ ·ï¼Œè¿™ä¸¤æŠŠé’¥åŒ™ä½ å’Œåˆ«äººéƒ½æœ‰ä¸€æŠŠï¼Œç„¶åä½ ä»¬ç›´æ¥ä¼ é€’æ•°æ®ï¼Œéƒ½ä¼šæŠŠæ•°æ®ç”¨é”ç»™é”ä¸Šï¼Œå°±ç®—ä¼ é€’çš„é€”ä¸­æœ‰äººæŠŠæ•°æ®çªƒå–äº†ï¼Œä¹Ÿæ²¡åŠæ³•è§£å¯†ï¼Œå› ä¸ºé’¥åŒ™åªæœ‰ä½ å’Œå¯¹æ–¹æœ‰ï¼Œæ²¡æœ‰é’¥åŒ™æ— æ³•è¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯è¿™æ ·æœ‰ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶è§£å¯†çš„å…³é”®åœ¨äºé’¥åŒ™æœ¬èº«ï¼Œé‚£ä¹ˆå¦‚æœæœ‰äººä¸ä»…çªƒå–äº†æ•°æ®ï¼Œè€Œä¸”å¯¹æ–¹é‚£è¾¹çš„æ²»å®‰ä¹Ÿä¸å¥½ï¼Œäºæ˜¯é¡ºæ‰‹å°±å·èµ°äº†é’¥åŒ™ï¼Œé‚£ä½ ä»¬ä¹‹é—´å‘çš„æ•°æ®ä¸å°±å‡‰å‡‰äº†å—ã€‚\nå› æ­¤ï¼Œ**éå¯¹ç§°åŠ å¯†ï¼ˆAsymmetric Cryptographyï¼‰**ç®—æ³•å‡ºç°äº†ï¼Œå®ƒå¹¶ä¸æ˜¯ç›´æ¥ç”Ÿæˆä¸€æŠŠé’¥åŒ™ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼Œç§é’¥åªèƒ½ç”±ä½ ä¿ç®¡ï¼Œè€Œå…¬é’¥äº¤ç»™å¯¹æ–¹æˆ–æ˜¯ä½ è¦å‘é€çš„ä»»ä½•äººéƒ½è¡Œï¼Œç°åœ¨ä½ éœ€è¦æŠŠæ•°æ®ä¼ ç»™å¯¹æ–¹ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªæ•°æ®åªèƒ½ä½¿ç”¨å¯¹åº”çš„å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œç›¸åï¼Œå¦‚æœå¯¹æ–¹éœ€è¦ç»™ä½ å‘é€æ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œè€Œæ•°æ®åªèƒ½ä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼Œè¿™æ ·çš„è¯å°±ç®—å¯¹æ–¹çš„å…¬é’¥è¢«çªƒå–ï¼Œé‚£ä¹ˆåˆ«äººå‘ç»™ä½ çš„æ•°æ®ä¹Ÿæ²¡åŠæ³•è§£å¯†å‡ºæ¥ï¼Œå› ä¸ºéœ€è¦ç§é’¥æ‰èƒ½è§£å¯†ï¼Œè€Œåªæœ‰ä½ æ‰æœ‰ç§é’¥ã€‚\nå› æ­¤ï¼Œéå¯¹ç§°åŠ å¯†çš„å®‰å…¨æ€§ä¼šæ›´é«˜ä¸€äº›ï¼ŒåŒ…æ‹¬HTTPSçš„éšç§ä¿¡æ¯æ­£æ˜¯ä½¿ç”¨éå¯¹ç§°åŠ å¯†æ¥ä¿éšœä¼ è¾“æ•°æ®çš„å®‰å…¨ï¼ˆå½“ç„¶HTTPSå¹¶ä¸æ˜¯å•çº¯åœ°ä½¿ç”¨éå¯¹ç§°åŠ å¯†å®Œæˆçš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»äº†è§£ä¸€ä¸‹ï¼‰\nå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†éƒ½æœ‰å¾ˆå¤šçš„ç®—æ³•ï¼Œæ¯”å¦‚å¯¹ç§°åŠ å¯†ï¼Œå°±æœ‰ï¼šDESã€IDEAã€RC2ï¼Œéå¯¹ç§°åŠ å¯†æœ‰ï¼šRSAã€DASã€ECC\nä¸å¯é€†åŠ å¯†ç®—æ³•ï¼š å¸¸è§çš„ä¸å¯é€†åŠ å¯†ç®—æ³•æœ‰MD5, HMAC, SHA-1, SHA-224, SHA-256, SHA-384, å’ŒSHA-512, å…¶ä¸­SHA-224ã€SHA-256ã€SHA-384ï¼Œå’ŒSHA-512æˆ‘ä»¬å¯ä»¥ç»Ÿç§°ä¸ºSHA2åŠ å¯†ç®—æ³•ï¼ŒSHAåŠ å¯†ç®—æ³•çš„å®‰å…¨æ€§è¦æ¯”MD5æ›´é«˜ï¼Œè€ŒSHA2åŠ å¯†ç®—æ³•æ¯”SHA1çš„è¦é«˜ï¼Œå…¶ä¸­SHAåé¢çš„æ•°å­—è¡¨ç¤ºçš„æ˜¯åŠ å¯†åçš„å­—ç¬¦ä¸²é•¿åº¦ï¼ŒSHA1é»˜è®¤ä¼šäº§ç”Ÿä¸€ä¸ª160ä½çš„ä¿¡æ¯æ‘˜è¦ã€‚ç»è¿‡ä¸å¯é€†åŠ å¯†ç®—æ³•å¾—åˆ°çš„åŠ å¯†ç»“æœï¼Œæ˜¯æ— æ³•è§£å¯†å›å»çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åŠ å¯†å‡ºæ¥æ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆäº†ã€‚æœ¬è´¨ä¸Šï¼Œå…¶å°±æ˜¯ä¸€ç§å“ˆå¸Œå‡½æ•°ï¼Œç”¨äºå¯¹ä¸€æ®µä¿¡æ¯äº§ç”Ÿæ‘˜è¦ï¼Œä»¥é˜²æ­¢è¢«ç¯¡æ”¹ã€‚\nå®é™…ä¸Šè¿™ç§ç®—æ³•å°±å¸¸å¸¸è¢«ç”¨ä½œä¿¡æ¯æ‘˜è¦è®¡ç®—ï¼ŒåŒæ ·çš„æ•°æ®é€šè¿‡åŒæ ·çš„ç®—æ³•è®¡ç®—å¾—åˆ°çš„ç»“æœè‚¯å®šä¹Ÿä¸€æ ·ï¼Œè€Œå¦‚æœæ•°æ®è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆè®¡ç®—çš„ç»“æœè‚¯å®šå°±ä¸ä¸€æ ·äº†ã€‚\nè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨jwtï¼Œå°†æˆ‘ä»¬çš„Tokené‡‡ç”¨æ–°çš„æ–¹å¼è¿›è¡Œå­˜å‚¨ï¼š\nè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æœ€ç®€å•çš„ä¸€ç§æ–¹å¼ï¼Œå¯¹ç§°å¯†é’¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹éªŒè¯æœåŠ¡å™¨è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼š\n@Bean public JwtAccessTokenConverter tokenConverter(){ //Tokenè½¬æ¢å™¨ï¼Œå°†å…¶è½¬æ¢ä¸ºJWT JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); converter.setSigningKey(\u0026#34;lbwnb\u0026#34;); //è¿™ä¸ªæ˜¯å¯¹ç§°å¯†é’¥ï¼Œä¸€ä¼šèµ„æºæœåŠ¡å™¨é‚£è¾¹ä¹Ÿè¦æŒ‡å®šä¸ºè¿™ä¸ª return converter; } @Bean public TokenStore tokenStore(JwtAccessTokenConverter converter){ //Tokenå­˜å‚¨æ–¹å¼ç°åœ¨æ”¹ä¸ºJWTå­˜å‚¨ return new JwtTokenStore(converter); //ä¼ å…¥åˆšåˆšå®šä¹‰å¥½çš„è½¬æ¢å™¨ } @Resource TokenStore store; @Resource JwtAccessTokenConverter converter; private AuthorizationServerTokenServices serverTokenServices(){ //è¿™é‡Œå¯¹AuthorizationServerTokenServicesè¿›è¡Œä¸€ä¸‹é…ç½® DefaultTokenServices services = new DefaultTokenServices(); services.setSupportRefreshToken(true); //å…è®¸Tokenåˆ·æ–° services.setTokenStore(store); //æ·»åŠ åˆšåˆšçš„TokenStore services.setTokenEnhancer(converter); //æ·»åŠ Tokenå¢å¼ºï¼Œå…¶å®å°±æ˜¯JwtAccessTokenConverterï¼Œå¢å¼ºæ˜¯æ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„æ•°æ®åˆ°JWTä¸­ return services; } @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) { endpoints .tokenServices(serverTokenServices()) //è®¾å®šä¸ºåˆšåˆšé…ç½®å¥½çš„AuthorizationServerTokenServices .userDetailsService(service) .authenticationManager(manager); } ç„¶åæˆ‘ä»¬å°±å¯ä»¥é‡å¯éªŒè¯æœåŠ¡å™¨äº†ï¼š\nå¯ä»¥çœ‹åˆ°æˆåŠŸè·å–äº†AccessTokenï¼Œä½†æ˜¯è¿™é‡Œçš„æ ¼å¼è·Ÿæˆ‘ä»¬ä¹‹å‰çš„æ ¼å¼å°±å¤§ä¸ç›¸åŒäº†ï¼Œå› ä¸ºç°åœ¨å®ƒæ˜¯JWTä»¤ç‰Œï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œä¸€ä¸‹Base64è§£ç ï¼š\nå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„éªŒè¯ä¿¡æ¯åŒ…å«åœ¨å†…ï¼Œç°åœ¨æˆ‘ä»¬å¯¹èµ„æºæœåŠ¡å™¨è¿›è¡Œé…ç½®ï¼š\nsecurity: oauth2: resource: jwt: key-value: lbwnb #æ³¨æ„è¿™é‡Œè¦è·ŸéªŒè¯æœåŠ¡å™¨çš„å¯†é’¥ä¸€è‡´ï¼Œè¿™æ ·ç®—å‡ºæ¥çš„ç­¾åæ‰ä¼šä¸€è‡´ ç„¶åå¯åŠ¨èµ„æºæœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸€ä¸‹æ¥å£è¯•è¯•çœ‹ï¼š\nè¯·æ±‚æˆåŠŸï¼Œå¾—åˆ°æ•°æ®ï¼š\næ³¨æ„å¦‚æœTokenæœ‰è¯¯ï¼Œé‚£ä¹ˆä¼šå¾—åˆ°ï¼š\nRedisä¸åˆ†å¸ƒå¼ #\råœ¨SpringBooté˜¶æ®µï¼Œæˆ‘ä»¬å­¦ä¹ äº†Redisï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„é«˜æ€§èƒ½æ•°æ®åº“ï¼Œæˆ‘ä»¬å½“æ—¶å·²ç»å­¦ä¹ äº†åŒ…æ‹¬åŸºæœ¬æ“ä½œã€å¸¸ç”¨æ•°æ®ç±»å‹ã€æŒä¹…åŒ–ã€äº‹åŠ¡å’Œé”æœºåˆ¶ä»¥åŠä½¿ç”¨Javaä¸Redisè¿›è¡Œäº¤äº’ç­‰ï¼Œåˆ©ç”¨å®ƒçš„é«˜æ€§èƒ½ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨å®ƒæ¥åšMybatisçš„äºŒçº§ç¼“å­˜ã€ä»¥åŠTokençš„æŒä¹…åŒ–å­˜å‚¨ã€‚è€Œè¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ·±å…¥ï¼Œæ¢è®¨Redisåœ¨åˆ†å¸ƒå¼å¼€å‘åœºæ™¯ä¸‹çš„åº”ç”¨ã€‚\nä¸»ä»å¤åˆ¶ #\råœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è®©Rediså®ç°ä¸»ä»æ¨¡å¼ï¼š\nä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(Master)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(Slave)ï¼Œæ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚Masterä»¥å†™ä¸ºä¸»ï¼ŒSlave ä»¥è¯»ä¸ºä¸»ã€‚\nè¿™æ ·çš„å¥½å¤„è‚¯å®šæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼š\nå®ç°äº†è¯»å†™åˆ†ç¦»ï¼Œæé«˜äº†æ€§èƒ½ã€‚ åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥å®‰æ’å¾ˆå¤šä¸ªä»èŠ‚ç‚¹ï¼Œè¿™æ ·å°±èƒ½å¤Ÿå¤§å¹…åº¦çš„åˆ†æ‹…å‹åŠ›ï¼Œå¹¶ä¸”å°±ç®—æŒ‚æ‰ä¸€ä¸ªï¼Œå…¶ä»–çš„ä¹Ÿèƒ½ä½¿ç”¨ã€‚ é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å°±æ¥å°è¯•å®ç°ä¸€ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯åœ¨Windowsä¸‹è¿›è¡Œæµ‹è¯•ï¼Œæ‰“å¼€Redisæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬è¦å¼€å¯ä¸¤ä¸ªRedisæœåŠ¡å™¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶redis.windows.confï¼š\n# Accept connections on the specified port, default is 6379 (IANA #815344).\r# If port 0 is specified Redis will not listen on a TCP socket.\rport 6001 ä¸€ä¸ªæœåŠ¡å™¨çš„ç«¯å£è®¾å®šä¸º6001ï¼Œå¤åˆ¶ä¸€ä»½ï¼Œå¦ä¸€ä¸ªçš„ç«¯å£ä¸º6002ï¼Œæ¥ç€æˆ‘ä»¬æŒ‡å®šé…ç½®æ–‡ä»¶è¿›è¡Œå¯åŠ¨ï¼Œæ‰“å¼€cmdï¼š\nç°åœ¨æˆ‘ä»¬çš„ä¸¤ä¸ªæœåŠ¡å™¨å°±å¯åŠ¨æˆåŠŸäº†ï¼Œæ¥ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å½“å‰æœåŠ¡å™¨çš„ä¸»ä»çŠ¶æ€ï¼Œæˆ‘ä»¬æ‰“å¼€å®¢æˆ·ç«¯ï¼š\nè¾“å…¥info replicationå‘½ä»¤æ¥æŸ¥çœ‹å½“å‰çš„ä¸»ä»çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°é»˜è®¤çš„è§’è‰²ä¸ºï¼šmasterï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰çš„æœåŠ¡å™¨åœ¨å¯åŠ¨ä¹‹åéƒ½æ˜¯ä¸»èŠ‚ç‚¹çš„çŠ¶æ€ã€‚é‚£ä¹ˆç°åœ¨æˆ‘ä»¬å¸Œæœ›è®©6002ä½œä¸ºä»èŠ‚ç‚¹ï¼Œé€šè¿‡ä¸€ä¸ªå‘½ä»¤å³å¯ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¾“å…¥replicaof 127.0.0.1 6001å‘½ä»¤åï¼Œå°±ä¼šå°†6001æœåŠ¡å™¨ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œè€Œå½“å‰èŠ‚ç‚¹ä½œä¸º6001çš„ä»èŠ‚ç‚¹ï¼Œå¹¶ä¸”è§’è‰²ä¹Ÿä¼šå˜æˆï¼šslaveï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹6001çš„æƒ…å†µï¼š\nå¯ä»¥çœ‹åˆ°ä»èŠ‚ç‚¹ä¿¡æ¯ä¸­å·²ç»å‡ºç°äº†6002æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨æˆ‘ä»¬çš„6001å’Œ6002å°±å½¢æˆäº†ä¸»ä»å…³ç³»ï¼ˆè¿˜åŒ…å«ä¸€ä¸ªåç§»é‡ï¼Œè¿™ä¸ªåç§»é‡ååº”çš„æ˜¯ä»èŠ‚ç‚¹çš„åŒæ­¥æƒ…å†µï¼‰\nä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨éƒ½ä¼šç»´æŠ¤ä¸€ä¸ªå¤åˆ¶åç§»é‡ï¼Œä¸»æœåŠ¡å™¨æ¯æ¬¡å‘ä»æœåŠ¡å™¨ä¸­ä¼ é€’ N ä¸ªå­—èŠ‚çš„æ—¶å€™ï¼Œä¼šå°†è‡ªå·±çš„å¤åˆ¶åç§»é‡åŠ ä¸Š Nã€‚ä»æœåŠ¡å™¨ä¸­æ”¶åˆ°ä¸»æœåŠ¡å™¨çš„ N ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œå°±ä¼šå°†è‡ªå·±é¢å¤åˆ¶åç§»é‡åŠ ä¸Š Nï¼Œé€šè¿‡ä¸»ä»æœåŠ¡å™¨çš„åç§»é‡å¯¹æ¯”å¯ä»¥å¾ˆæ¸…æ¥šçš„çŸ¥é“ä¸»ä»æœåŠ¡å™¨çš„æ•°æ®æ˜¯å¦å¤„äºä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´å°±éœ€è¦è¿›è¡Œå¢é‡åŒæ­¥äº†ã€‚\né‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œåœ¨ä¸»èŠ‚ç‚¹æ–°å¢æ•°æ®ï¼Œçœ‹çœ‹æ˜¯å¦ä¼šåŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨6001æœåŠ¡å™¨æ’å…¥çš„aï¼Œå¯ä»¥åœ¨ä»èŠ‚ç‚¹6002è¯»å–åˆ°ï¼Œé‚£ä¹ˆï¼Œä»èŠ‚ç‚¹æ–°å¢çš„æ•°æ®åœ¨ä¸»èŠ‚ç‚¹èƒ½å¾—åˆ°å—ï¼Ÿæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œä»èŠ‚ç‚¹å‹æ ¹å°±æ²¡åŠæ³•è¿›è¡Œæ•°æ®æ’å…¥ï¼ŒèŠ‚ç‚¹çš„æ¨¡å¼ä¸ºåªè¯»æ¨¡å¼ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç°åœ¨ä¸æƒ³è®©6002ä½œä¸º6001çš„ä»èŠ‚ç‚¹äº†å‘¢ï¼Ÿ\nå¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡è¾“å…¥replicaof no oneï¼Œå³å¯å˜å›Masterè§’è‰²ã€‚æ¥ç€æˆ‘ä»¬å†æ¥å¯åŠ¨ä¸€å°6003æœåŠ¡å™¨ï¼Œæµç¨‹æ˜¯ä¸€æ ·çš„ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿æ¥ä¹‹åï¼Œä¹Ÿä¼šç›´æ¥åŒæ­¥ä¸»èŠ‚ç‚¹çš„æ•°æ®ï¼Œå› æ­¤æ— è®ºæ˜¯å·²ç»å¤„äºä»èŠ‚ç‚¹çŠ¶æ€è¿˜æ˜¯åˆšåˆšå¯åŠ¨å®Œæˆçš„æœåŠ¡å™¨ï¼Œéƒ½ä¼šä»ä¸»èŠ‚ç‚¹åŒæ­¥æ•°æ®ï¼Œå®é™…ä¸Šæ•´ä¸ªåŒæ­¥æµç¨‹ä¸ºï¼š\nä»èŠ‚ç‚¹æ‰§è¡Œreplicaof ip portå‘½ä»¤åï¼Œä»èŠ‚ç‚¹ä¼šä¿å­˜ä¸»èŠ‚ç‚¹ç›¸å…³çš„åœ°å€ä¿¡æ¯ã€‚ ä»èŠ‚ç‚¹é€šè¿‡æ¯ç§’è¿è¡Œçš„å®šæ—¶ä»»åŠ¡å‘ç°é…ç½®äº†æ–°çš„ä¸»èŠ‚ç‚¹åï¼Œä¼šå°è¯•ä¸è¯¥èŠ‚ç‚¹å»ºç«‹ç½‘ç»œè¿æ¥ï¼Œä¸“é—¨ç”¨äºæ¥æ”¶ä¸»èŠ‚ç‚¹å‘é€çš„å¤åˆ¶å‘½ä»¤ã€‚ è¿æ¥æˆåŠŸåï¼Œç¬¬ä¸€æ¬¡ä¼šå°†ä¸»èŠ‚ç‚¹çš„æ•°æ®è¿›è¡Œå…¨é‡å¤åˆ¶ï¼Œä¹‹åé‡‡ç”¨å¢é‡å¤åˆ¶ï¼ŒæŒç»­å°†æ–°æ¥çš„å†™å‘½ä»¤åŒæ­¥ç»™ä»èŠ‚ç‚¹ã€‚ å½“æˆ‘ä»¬çš„ä¸»èŠ‚ç‚¹å…³é—­åï¼Œä»èŠ‚ç‚¹ä¾ç„¶å¯ä»¥è¯»å–æ•°æ®ï¼š\nä½†æ˜¯ä»èŠ‚ç‚¹ä¼šç–¯ç‹‚æŠ¥é”™ï¼š\nå½“ç„¶æ¯æ¬¡éƒ½å»æ•²ä¸ªå‘½ä»¤é…ç½®ä¸»ä»å¤ªéº»çƒ¦äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œæ·»åŠ è¿™æ ·è¡Œå³å¯ï¼š\nreplicaof 127.0.0.1 6001 è¿™é‡Œæˆ‘ä»¬ç»™6002å’Œ6003æœåŠ¡å™¨éƒ½é…ç½®ä¸€ä¸‹ï¼Œç°åœ¨æˆ‘ä»¬é‡å¯ä¸‰ä¸ªæœåŠ¡å™¨ã€‚\nå½“ç„¶ï¼Œé™¤äº†ä½œä¸ºMasterèŠ‚ç‚¹çš„ä»èŠ‚ç‚¹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†å…¶ä½œä¸ºä»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬è®©6003ä½œä¸º6002çš„ä»èŠ‚ç‚¹ï¼š\nä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨å·®ä¸å¤šæ˜¯è¿™æ ·çš„çš„ä¸€ä¸ªæƒ…å†µï¼š\né‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œä¼˜ç‚¹è‚¯å®šæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ•´ä¸ªä¼ æ’­é“¾è·¯ä¸€æ—¦ä¸­é€”å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´åé¢çš„ä»èŠ‚ç‚¹æ— æ³•åŠæ—¶åŒæ­¥ã€‚\nå“¨å…µæ¨¡å¼ #\rå‰é¢æˆ‘ä»¬è®²è§£äº†Rediså®ç°ä¸»ä»å¤åˆ¶çš„ä¸€äº›åŸºæœ¬æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ç€æ¥çœ‹å“¨å…µæ¨¡å¼ã€‚\nç»è¿‡ä¹‹å‰çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå®é™…ä¸Šæœ€å…³é”®çš„è¿˜æ˜¯ä¸»èŠ‚ç‚¹ï¼Œå› ä¸ºä¸€æ—¦ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆæ•´ä¸ªä¸»ä»ç³»ç»Ÿå°†æ— æ³•å†™å…¥ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¾—æƒ³ä¸€ä¸ªåŠæ³•ï¼Œå¤„ç†ä¸€ä¸‹ä¸»èŠ‚ç‚¹æ•…éšœçš„æƒ…å†µã€‚å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥å‚è€ƒä¹‹å‰çš„æœåŠ¡æ²»ç†æ¨¡å¼ï¼Œæ¯”å¦‚Nacoså’ŒEurekaï¼Œæ‰€æœ‰çš„æœåŠ¡éƒ½ä¼šè¢«å®æ—¶ç›‘æ§ï¼Œé‚£ä¹ˆåªè¦å‡ºç°é—®é¢˜ï¼Œè‚¯å®šæ˜¯å¯ä»¥åŠæ—¶å‘ç°çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿé‡‡å–å“åº”çš„è¡¥æ•‘æªæ–½ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å³å°†ä»‹ç»çš„å“¨å…µï¼š\næ³¨æ„è¿™é‡Œçš„å“¨å…µä¸æ˜¯æˆ‘ä»¬ä¹‹å‰å­¦ä¹ SpringCloud Alibabaçš„é‚£ä¸ªï¼Œæ˜¯ä¸“ç”¨äºRedisçš„ã€‚å“¨å…µä¼šå¯¹æ‰€æœ‰çš„èŠ‚ç‚¹è¿›è¡Œç›‘æ§ï¼Œå¦‚æœå‘ç°ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆä¼šç«‹å³è®©ä»èŠ‚ç‚¹è¿›è¡ŒæŠ•ç¥¨ï¼Œé€‰ä¸¾ä¸€ä¸ªæ–°çš„ä¸»èŠ‚ç‚¹å‡ºæ¥ï¼Œè¿™æ ·å°±ä¸ä¼šç”±äºä¸»èŠ‚ç‚¹çš„æ•…éšœå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯å†™ï¼ˆæ³¨æ„è¦å®ç°è¿™æ ·çš„åŠŸèƒ½æœ€å°çš„ç³»ç»Ÿå¿…é¡»æ˜¯ä¸€ä¸»ä¸€ä»ï¼Œå†å°çš„è¯å°±æ²¡æœ‰æ„ä¹‰äº†ï¼‰\né‚£ä¹ˆæ€ä¹ˆå¯åŠ¨ä¸€ä¸ªå“¨å…µå‘¢ï¼Ÿæˆ‘ä»¬åªéœ€è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶å³å¯ï¼Œè¿™é‡Œç›´æ¥åˆ é™¤å…¨éƒ¨å†…å®¹ï¼Œæ·»åŠ ï¼š\nsentinel monitor lbwnb 127.0.0.1 6001 1 å…¶ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ˜¯å›ºå®šï¼Œç¬¬ä¸‰ä¸ªæ˜¯ä¸ºç›‘æ§å¯¹è±¡åç§°ï¼Œéšæ„ï¼Œåé¢å°±æ˜¯ä¸»èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬IPåœ°å€å’Œç«¯å£ï¼Œæœ€åä¸€ä¸ª1æˆ‘ä»¬æš‚æ—¶å…ˆä¸è¯´ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨æ­¤é…ç½®æ–‡ä»¶å¯åŠ¨æœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°å¯åŠ¨åï¼š\nå¯ä»¥çœ‹åˆ°ä»¥å“¨å…µæ¨¡å¼å¯åŠ¨åï¼Œä¼šè‡ªåŠ¨ç›‘æ§ä¸»èŠ‚ç‚¹ï¼Œç„¶åè¿˜ä¼šæ˜¾ç¤ºé‚£äº›èŠ‚ç‚¹æ˜¯ä½œä¸ºä»èŠ‚ç‚¹å­˜åœ¨çš„ã€‚\nç°åœ¨æˆ‘ä»¬ç›´æ¥æŠŠä¸»èŠ‚ç‚¹å…³é—­ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼š\nå¯ä»¥çœ‹åˆ°ä»èŠ‚ç‚¹è¿˜æ˜¯æ­£å¸¸çš„åœ¨æŠ¥é”™ï¼Œä¸€å¼€å§‹çš„æ—¶å€™ä¸ä¼šç›´æ¥é‡æ–°è¿›è¡Œé€‰ä¸¾è€Œæ˜¯ç»§ç»­å°è¯•é‡è¿ï¼ˆå› ä¸ºæœ‰å¯èƒ½åªæ˜¯ç½‘ç»œå°å¡ä¸€ä¸‹ï¼Œæ²¡å¿…è¦è¿™ä¹ˆæ•æ„Ÿï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´ä¹‹åï¼Œä¾ç„¶æ— æ³•è¿æ¥ï¼Œå“¨å…µè¾“å‡ºäº†ä»¥ä¸‹å†…å®¹ï¼š\nå¯ä»¥çœ‹åˆ°å“¨å…µå‘ç°ä¸»èŠ‚ç‚¹å·²ç»æœ‰ä¸€æ®µæ—¶é—´ä¸å¯ç”¨äº†ï¼Œé‚£ä¹ˆå°±ä¼šå¼€å§‹è¿›è¡Œé‡æ–°é€‰ä¸¾ï¼Œ6003èŠ‚ç‚¹è¢«é€‰ä¸ºäº†æ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¹‹å‰çš„ä¸»èŠ‚ç‚¹6001å˜æˆäº†æ–°çš„ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ï¼š\nå½“æˆ‘ä»¬å†æ¬¡å¯åŠ¨6001æ—¶ï¼Œä¼šå‘ç°ï¼Œå®ƒè‡ªåŠ¨å˜æˆäº†6003çš„ä»èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¼šå°†æ•°æ®åŒæ­¥è¿‡æ¥ï¼š\né‚£ä¹ˆï¼Œè¿™ä¸ªé€‰ä¸¾è§„åˆ™æ˜¯æ€æ ·çš„å‘¢ï¼Ÿæ˜¯åœ¨æ‰€æœ‰çš„ä»èŠ‚ç‚¹ä¸­éšæœºé€‰å–è¿˜æ˜¯éµå¾ªæŸç§è§„åˆ™å‘¢ï¼Ÿ\né¦–å…ˆä¼šæ ¹æ®ä¼˜å…ˆçº§è¿›è¡Œé€‰æ‹©ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œæ·»åŠ replica-priorityé…ç½®é¡¹ï¼ˆé»˜è®¤æ˜¯100ï¼‰ï¼Œè¶Šå°è¡¨ç¤ºä¼˜å…ˆçº§è¶Šé«˜ã€‚ å¦‚æœä¼˜å…ˆçº§ä¸€æ ·ï¼Œé‚£å°±é€‰æ‹©åç§»é‡æœ€å¤§çš„ è¦æ˜¯è¿˜é€‰ä¸å‡ºæ¥ï¼Œé‚£å°±é€‰æ‹©runidï¼ˆå¯åŠ¨æ—¶éšæœºç”Ÿæˆçš„ï¼‰æœ€å°çš„ã€‚ è¦æ˜¯å“¨å…µä¹ŸæŒ‚äº†å’‹åŠï¼Ÿæ²¡äº‹ï¼Œå’±ä»¬å¯ä»¥å¤šå®‰æ’å‡ ä¸ªå“¨å…µï¼Œåªéœ€è¦æŠŠå“¨å…µçš„é…ç½®å¤åˆ¶ä¸€ä¸‹ï¼Œç„¶åä¿®æ”¹ç«¯å£ï¼Œè¿™æ ·å°±å¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ªå“¨å…µäº†ï¼Œæˆ‘ä»¬å¯åŠ¨3ä¸ªå“¨å…µï¼ˆä¸€ä¸»äºŒä»ä¸‰å“¨å…µï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬å§æœ€åä¸€ä¸ªå€¼æ”¹ä¸º2ï¼š\nsentinel monitor lbwnb 192.168.0.8 6001 2 è¿™ä¸ªå€¼å®é™…ä¸Šä»£è¡¨çš„æ˜¯å½“æœ‰å‡ ä¸ªå“¨å…µè®¤ä¸ºä¸»èŠ‚ç‚¹æŒ‚æ‰æ—¶ï¼Œå°±åˆ¤æ–­ä¸»èŠ‚ç‚¹çœŸçš„æŒ‚æ‰äº†\nç°åœ¨æˆ‘ä»¬æŠŠ6001èŠ‚ç‚¹æŒ‚æ‰ï¼Œçœ‹çœ‹è¿™ä¸‰ä¸ªå“¨å…µä¼šæ€ä¹ˆæ ·ï¼š\nå¯ä»¥çœ‹åˆ°éƒ½æ˜¾ç¤ºå°†masteråˆ‡æ¢ä¸º6002èŠ‚ç‚¹äº†ã€‚\né‚£ä¹ˆï¼Œåœ¨å“¨å…µé‡æ–°é€‰ä¸¾æ–°çš„ä¸»èŠ‚ç‚¹ä¹‹åï¼Œæˆ‘ä»¬Javaä¸­çš„Redisçš„å®¢æˆ·ç«¯æ€ä¹ˆæ„ŸçŸ¥åˆ°å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œé¦–å…ˆè¿˜æ˜¯å¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;redis.clients\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jedis\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.2.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; public class Main { public static void main(String[] args) { //è¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨JedisSentinelPoolæ¥è·å–MasterèŠ‚ç‚¹ //éœ€è¦æŠŠä¸‰ä¸ªå“¨å…µçš„åœ°å€éƒ½å¡«å…¥ try (JedisSentinelPool pool = new JedisSentinelPool(\u0026#34;lbwnb\u0026#34;, new HashSet\u0026lt;\u0026gt;(Arrays.asList(\u0026#34;192.168.0.8:26741\u0026#34;, \u0026#34;192.168.0.8:26740\u0026#34;, \u0026#34;192.168.0.8:26739\u0026#34;)))) { Jedis jedis = pool.getResource(); //ç›´æ¥è¯¢é—®å¹¶å¾—åˆ°Jediså¯¹è±¡ï¼Œè¿™å°±æ˜¯è¿æ¥çš„MasterèŠ‚ç‚¹ jedis.set(\u0026#34;test\u0026#34;, \u0026#34;114514\u0026#34;); //ç›´æ¥å†™å…¥å³å¯ï¼Œå®é™…ä¸Šå°±æ˜¯å‘MasterèŠ‚ç‚¹å†™å…¥ Jedis jedis2 = pool.getResource(); //å†æ¬¡è·å– System.out.println(jedis2.get(\u0026#34;test\u0026#34;)); //è¯»å–æ“ä½œ } catch (Exception e) { e.printStackTrace(); } } } è¿™æ ·ï¼ŒJediså¯¹è±¡å°±å¯ä»¥é€šè¿‡å“¨å…µæ¥è·å–ï¼Œå½“MasterèŠ‚ç‚¹æ›´æ–°åï¼Œä¹Ÿèƒ½å¾—åˆ°æœ€æ–°çš„ã€‚\né›†ç¾¤æ­å»º #\rå¦‚æœæˆ‘ä»¬æœåŠ¡å™¨çš„å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬çš„Redisåˆéœ€è¦ç»§ç»­å­˜å‚¨å†…å®¹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åˆ©ç”¨é›†ç¾¤æ¥å®ç°æ‰©å®¹ã€‚\nå› ä¸ºå•æœºçš„å†…å­˜å®¹é‡æœ€å¤§å°±é‚£ä¹ˆå¤šï¼Œå·²ç»æ²¡åŠæ³•å†ç»§ç»­æ‰©å±•äº†ï¼Œä½†æ˜¯ç°åœ¨åˆéœ€è¦å­˜å‚¨æ›´å¤šçš„å†…å®¹ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥è®©Nå°æœºå™¨ä¸Šçš„Redisæ¥åˆ†åˆ«å­˜å‚¨å„ä¸ªéƒ¨åˆ†çš„æ•°æ®ï¼ˆæ¯ä¸ªRediså¯ä»¥å­˜å‚¨1/Nçš„æ•°æ®é‡ï¼‰ï¼Œè¿™æ ·å°±å®ç°äº†å®¹é‡çš„æ¨ªå‘æ‰©å±•ã€‚åŒæ—¶æ¯å°Redisè¿˜å¯ä»¥é…ä¸€ä¸ªä»èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥æ›´å¥½åœ°ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚\né‚£ä¹ˆé—®é¢˜æ¥ï¼Œç°åœ¨ç”¨æˆ·æ¥äº†ä¸€ä¸ªå†™å…¥çš„è¯·æ±‚ï¼Œæ•°æ®è¯¥å†™åˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šå‘¢ï¼Ÿæˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹é›†ç¾¤çš„æœºåˆ¶ï¼š\né¦–å…ˆï¼Œä¸€ä¸ªRedisé›†ç¾¤åŒ…å«16384ä¸ªæ’æ§½ï¼Œé›†ç¾¤ä¸­çš„æ¯ä¸ªRedis å®ä¾‹è´Ÿè´£ç»´æŠ¤ä¸€éƒ¨åˆ†æ’æ§½ä»¥åŠæ’æ§½æ‰€æ˜ å°„çš„é”®å€¼æ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªæ’æ§½æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ\nå®é™…ä¸Šï¼Œæ’æ§½å°±æ˜¯é”®çš„Hashè®¡ç®—åçš„ä¸€ä¸ªç»“æœï¼Œæ³¨æ„è¿™é‡Œå‡ºç°äº†è®¡ç®—æœºç½‘ç»œä¸­çš„CRCå¾ªç¯å†—ä½™æ ¡éªŒï¼Œè¿™é‡Œé‡‡ç”¨CRC16ï¼Œèƒ½å¾—åˆ°16ä¸ªbitä½çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ç®—å‡ºæ¥ä¹‹åç»“æœæ˜¯0-65535ä¹‹é—´ï¼Œå†è¿›è¡Œå–æ¨¡ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœï¼š\nRedis keyçš„è·¯ç”±è®¡ç®—å…¬å¼ï¼šslot = CRC16ï¼ˆkeyï¼‰ % 16384\nç»“æœçš„å€¼æ˜¯å¤šå°‘ï¼Œå°±åº”è¯¥å­˜æ”¾åˆ°å¯¹åº”ç»´æŠ¤çš„Redisä¸‹ï¼Œæ¯”å¦‚RedisèŠ‚ç‚¹1è´Ÿè´£0-25565çš„æ’æ§½ï¼Œè€Œè¿™æ—¶å®¢æˆ·ç«¯æ’å…¥äº†ä¸€ä¸ªæ–°çš„æ•°æ®a=10ï¼Œaåœ¨Hashè®¡ç®—åç»“æœä¸º666ï¼Œé‚£ä¹ˆaå°±åº”è¯¥å­˜æ”¾åˆ°1å·RedisèŠ‚ç‚¹ä¸­ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡å“ˆå¸Œç®—æ³•å°†æ’å…¥çš„æ•°æ®åˆ†æ‘Šåˆ°å„ä¸ªèŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥è¯´å“ˆå¸Œç®—æ³•çœŸçš„æ˜¯å¤„å¤„éƒ½æœ‰ç”¨å•Šã€‚\né‚£ä¹ˆç°åœ¨æˆ‘ä»¬å°±æ¥æ­å»ºä¸€ä¸ªç®€å•çš„Redisé›†ç¾¤ï¼Œè¿™é‡Œåˆ›å»º6ä¸ªé…ç½®ï¼Œæ³¨æ„å¼€å¯é›†ç¾¤æ¨¡å¼ï¼š\n# Normal Redis instances can\u0026#39;t be part of a Redis Cluster; only nodes that are\r# started as cluster nodes can. In order to start a Redis instance as a\r# cluster node enable the cluster support uncommenting the following:\r#\rcluster-enabled yes æ¥ç€è®°å¾—æŠŠæ‰€æœ‰çš„æŒä¹…åŒ–æ–‡ä»¶å…¨éƒ¨åˆ é™¤ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹å†…å®¹å¿…é¡»æ˜¯ç©ºçš„ã€‚\nç„¶åè¾“å…¥redis-cli.exe --cluster create --cluster-replicas 1 127.0.0.1:6001 127.0.0.1:6002 127.0.0.1:6003 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003ï¼Œè¿™é‡Œçš„--cluster-replicas 1æŒ‡çš„æ˜¯æ¯ä¸ªèŠ‚ç‚¹é…ä¸€ä¸ªä»èŠ‚ç‚¹ï¼š\nè¾“å…¥ä¹‹åï¼Œä¼šä¸ºä½ å±•ç¤ºå®¢æˆ·ç«¯é»˜è®¤åˆ†é…çš„æ–¹æ¡ˆï¼Œå¹¶ä¸”ä¼šè¯¢é—®ä½ å½“å‰çš„æ–¹æ¡ˆæ˜¯å¦åˆç†ã€‚å¯ä»¥çœ‹åˆ°6001/6002/6003éƒ½è¢«é€‰ä¸ºä¸»èŠ‚ç‚¹ï¼Œå…¶ä»–çš„ä¸ºä»èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç›´æ¥è¾“å…¥yeså³å¯ï¼š\næœ€ååˆ†é…æˆåŠŸï¼Œå¯ä»¥çœ‹åˆ°æ’æ§½çš„åˆ†é…æƒ…å†µï¼š\nç°åœ¨æˆ‘ä»¬éšä¾¿è¿æ¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°è¯•æ’å…¥ä¸€ä¸ªå€¼ï¼š\nåœ¨æ’å…¥æ—¶ï¼Œå‡ºç°äº†ä¸€ä¸ªé”™è¯¯ï¼Œå®é™…ä¸Šè¿™å°±æ˜¯å› ä¸ºaè®¡ç®—å‡ºæ¥çš„å“ˆå¸Œå€¼ï¼ˆæ’æ§½ï¼‰ï¼Œä¸å½’å½“å‰èŠ‚ç‚¹ç®¡ï¼Œæˆ‘ä»¬å¾—å»ç®¡è¿™ä¸ªæ’æ§½çš„èŠ‚ç‚¹æ‰§è¡Œï¼Œé€šè¿‡ä¸Šé¢çš„åˆ†é…æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°15495å±äºèŠ‚ç‚¹6003ç®¡ç†ï¼š\nåœ¨6003èŠ‚ç‚¹æ’å…¥æˆåŠŸï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨é›†ç¾¤æ–¹å¼è¿æ¥ï¼Œè¿™æ ·æˆ‘ä»¬æ— è®ºåœ¨å“ªä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥æ’å…¥ï¼Œåªéœ€è¦æ·»åŠ -cè¡¨ç¤ºä»¥é›†ç¾¤æ¨¡å¼è®¿é—®ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨6001èŠ‚ç‚¹æˆåŠŸå¯¹açš„å€¼è¿›è¡Œäº†æ›´æ–°ï¼Œåªä¸è¿‡è¿˜æ˜¯è¢«é‡å®šå‘åˆ°äº†6003èŠ‚ç‚¹è¿›è¡Œæ’å…¥ã€‚\næˆ‘ä»¬å¯ä»¥è¾“å…¥cluster nodeså‘½ä»¤æ¥æŸ¥çœ‹å½“å‰æ‰€æœ‰èŠ‚ç‚¹çš„ä¿¡æ¯ï¼š\né‚£ä¹ˆç°åœ¨å¦‚æœæˆ‘ä»¬è®©æŸä¸€ä¸ªä¸»èŠ‚ç‚¹æŒ‚æ‰ä¼šæ€ä¹ˆæ ·ï¼Ÿç°åœ¨æˆ‘ä»¬æŠŠ6001æŒ‚æ‰ï¼š\nå¯ä»¥çœ‹åˆ°åŸæœ¬çš„6001ä»èŠ‚ç‚¹7001ï¼Œæ™‹å‡ä¸ºäº†æ–°çš„ä¸»èŠ‚ç‚¹ï¼Œè€Œä¹‹å‰çš„6001å·²ç»æŒ‚äº†ï¼Œç°åœ¨æˆ‘ä»¬å°†6001é‡å¯è¯•è¯•çœ‹ï¼š\nå¯ä»¥çœ‹åˆ°6001å˜æˆäº†7001çš„ä»èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¦æ˜¯6001å’Œ7001éƒ½æŒ‚äº†å‘¢ï¼Ÿ\nè¿™æ—¶æˆ‘ä»¬å°è¯•æ’å…¥æ–°çš„æ•°æ®ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œå½“å­˜åœ¨èŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œä¼šæ— æ³•æ’å…¥æ–°çš„æ•°æ®ï¼Œç°åœ¨æˆ‘ä»¬å°†6001å’Œ7001æ¢å¤ï¼š\nå¯ä»¥çœ‹åˆ°æ¢å¤ä¹‹ååˆå¯ä»¥ç»§ç»­æ­£å¸¸ä½¿ç”¨äº†ã€‚\næœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨Javaè¿æ¥åˆ°é›†ç¾¤æ¨¡å¼ä¸‹çš„Redisï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°JedisClusterå¯¹è±¡ï¼š\npublic class Main { public static void main(String[] args) { //å’Œå®¢æˆ·ç«¯ä¸€æ ·ï¼Œéšä¾¿è¿ä¸€ä¸ªå°±è¡Œï¼Œä¹Ÿå¯ä»¥å¤šå†™å‡ ä¸ªï¼Œæ„é€ æ–¹æ³•æœ‰å¾ˆå¤šç§å¯ä»¥é€‰æ‹© try(JedisCluster cluster = new JedisCluster(new HostAndPort(\u0026#34;192.168.0.8\u0026#34;, 6003))){ System.out.println(\u0026#34;é›†ç¾¤å®ä¾‹æ•°é‡ï¼š\u0026#34;+cluster.getClusterNodes().size()); cluster.set(\u0026#34;a\u0026#34;, \u0026#34;yyds\u0026#34;); System.out.println(cluster.get(\u0026#34;a\u0026#34;)); } } } æ“ä½œåŸºæœ¬å’ŒJediså¯¹è±¡ä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸å¤šåšèµ˜è¿°äº†ã€‚\nåˆ†å¸ƒå¼é” #\råœ¨æˆ‘ä»¬çš„ä¼ ç»Ÿå•ä½“åº”ç”¨ä¸­ï¼Œç»å¸¸ä¼šç”¨åˆ°é”æœºåˆ¶ï¼Œç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢å¤šçº¿ç¨‹ç«äº‰å¯¼è‡´çš„å¹¶å‘é—®é¢˜ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œåˆè¯¥å¦‚ä½•å®ç°é”æœºåˆ¶å‘¢ï¼Ÿå¯èƒ½ä¸€æ¡é“¾è·¯ä¸Šæœ‰å¾ˆå¤šçš„åº”ç”¨ï¼Œå®ƒä»¬éƒ½æ˜¯ç‹¬ç«‹è¿è¡Œçš„ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©Redisæ¥å®ç°åˆ†å¸ƒå¼é”ã€‚\nè¿˜è®°å¾—æˆ‘ä»¬ä¸Šä¸€ç« æœ€åæå‡ºçš„é—®é¢˜å—ï¼Ÿ\n@Override public boolean doBorrow(int uid, int bid) { //1. åˆ¤æ–­å›¾ä¹¦å’Œç”¨æˆ·æ˜¯å¦éƒ½æ”¯æŒå€Ÿé˜…ï¼Œå¦‚æœæ­¤æ—¶æ¥äº†10ä¸ªçº¿ç¨‹ï¼Œéƒ½è¿›æ¥äº†ï¼Œé‚£ä¹ˆéƒ½èƒ½å¤Ÿåˆ¤æ–­ä¸ºå¯ä»¥å€Ÿé˜… if(bookClient.bookRemain(bid) \u0026lt; 1) throw new RuntimeException(\u0026#34;å›¾ä¹¦æ•°é‡ä¸è¶³\u0026#34;); if(userClient.userRemain(uid) \u0026lt; 1) throw new RuntimeException(\u0026#34;ç”¨æˆ·å€Ÿé˜…é‡ä¸è¶³\u0026#34;); //2. é¦–å…ˆå°†å›¾ä¹¦çš„æ•°é‡-1ï¼Œç”±äºä¸Šé¢10ä¸ªçº¿ç¨‹åŒæ—¶è¿›æ¥ï¼ŒåŒæ—¶åˆ¤æ–­å¯ä»¥å€Ÿé˜…ï¼Œé‚£ä¹ˆè¿™ä¸ª10ä¸ªçº¿ç¨‹å°±åŒæ—¶å°†å›¾ä¹¦æ•°é‡-1ï¼Œé‚£åº“å­˜å²‚ä¸æ˜¯ç›´æ¥å˜æˆè´Ÿæ•°äº†ï¼Ÿï¼Ÿï¼Ÿ if(!bookClient.bookBorrow(bid)) throw new RuntimeException(\u0026#34;åœ¨å€Ÿé˜…å›¾ä¹¦æ—¶å‡ºç°é”™è¯¯ï¼\u0026#34;); ... } å®é™…ä¸Šåœ¨é«˜å¹¶å‘ä¸‹ï¼Œæˆ‘ä»¬çœ‹ä¼¼æ­£å¸¸çš„å€Ÿé˜…æµç¨‹ï¼Œä¼šå‡ºç°é—®é¢˜ï¼Œæ¯”å¦‚ç°åœ¨åŒæ—¶æ¥äº†10ä¸ªåŒå­¦è¦å€ŸåŒä¸€æœ¬ä¹¦ï¼Œä½†æ˜¯ç°åœ¨åªæœ‰3æœ¬ï¼Œè€Œæˆ‘ä»¬çš„åˆ¤æ–­è§„åˆ™æ˜¯ï¼Œé¦–å…ˆçœ‹ä¹¦å¤Ÿä¸å¤Ÿï¼Œå¦‚æœæ­¤æ—¶è¿™10ä¸ªè¯·æ±‚éƒ½å·²ç»èµ°åˆ°è¿™é‡Œï¼Œå¹¶ä¸”éƒ½åˆ¤å®šä¸ºå¯ä»¥è¿›è¡Œå€Ÿé˜…ï¼Œé‚£ä¹ˆé—®é¢˜å°±å‡ºç°äº†ï¼Œæ¥ä¸‹æ¥è¿™10ä¸ªè¯·æ±‚éƒ½å¼€å§‹è¿›è¡Œå€Ÿé˜…æ“ä½œï¼Œå¯¼è‡´åº“å­˜ç›´æ¥çˆ†è¡¨ï¼Œå½¢æˆè¶…å€Ÿé—®é¢˜ï¼ˆåœ¨ç”µå•†ç³»ç»Ÿä¸­ä¹Ÿå­˜åœ¨åŒæ ·çš„è¶…å–é—®é¢˜ï¼‰\nå› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨åˆ†å¸ƒå¼é”æ¥å®ç°ã€‚é‚£ä¹ˆRediså¦‚ä½•å»å®ç°åˆ†å¸ƒå¼é”å‘¢ï¼Ÿ\nåœ¨Rediså­˜åœ¨è¿™æ ·ä¸€ä¸ªå‘½ä»¤ï¼š\nsetnx key value è¿™ä¸ªå‘½ä»¤çœ‹èµ·æ¥å’Œsetå‘½ä»¤å·®ä¸å¤šï¼Œä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªæœºåˆ¶ï¼Œå°±æ˜¯åªæœ‰å½“æŒ‡å®šçš„keyä¸å­˜åœ¨çš„æ—¶å€™ï¼Œæ‰èƒ½è¿›è¡Œæ’å…¥ï¼Œå®é™…ä¸Šå°±æ˜¯set if not existsçš„ç¼©å†™ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œå½“å®¢æˆ·ç«¯1è®¾å®šaä¹‹åï¼Œå®¢æˆ·ç«¯2ä½¿ç”¨setnxä¼šç›´æ¥å¤±è´¥ã€‚\nå½“å®¢æˆ·ç«¯1å°†aåˆ é™¤ä¹‹åï¼Œå®¢æˆ·ç«¯2å°±å¯ä»¥ä½¿ç”¨setnxæˆåŠŸæ’å…¥äº†ã€‚\nåˆ©ç”¨è¿™ç§ç‰¹æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸åŒçš„æœåŠ¡ä¸­å®ç°åˆ†å¸ƒå¼é”ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¦æ˜¯æŸä¸ªæœåŠ¡åŠ äº†é”ä½†æ˜¯å¡é¡¿äº†å‘¢ï¼Œæˆ–æ˜¯ç›´æ¥å´©æºƒäº†ï¼Œé‚£è¿™æŠŠé”å²‚ä¸æ˜¯æ°¸è¿œæ— æ³•é‡Šæ”¾äº†ï¼Ÿå› æ­¤æˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘åŠ ä¸ªè¿‡æœŸæ—¶é—´ï¼š\nset a 666 EX 5 NX è¿™é‡Œä½¿ç”¨setå‘½ä»¤ï¼Œæœ€ååŠ ä¸€ä¸ªNXè¡¨ç¤ºæ˜¯ä½¿ç”¨setnxçš„æ¨¡å¼ï¼Œå’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡EXè®¾å®šè¿‡æœŸæ—¶é—´ï¼Œè¿™é‡Œè®¾ç½®ä¸º5ç§’ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœ5ç§’è¿˜æ²¡é‡Šæ”¾ï¼Œé‚£ä¹ˆå°±è‡ªåŠ¨åˆ é™¤ã€‚\nå½“ç„¶ï¼Œæ·»åŠ äº†è¿‡æœŸæ—¶é—´ï¼Œå¸¦äº†çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿå¸¦æ¥äº†å¾ˆå¤šçš„éº»çƒ¦ï¼Œæˆ‘ä»¬æ¥è®¾æƒ³ä¸€ä¸‹è¿™ç§æƒ…å†µï¼š\nå› æ­¤ï¼Œå•çº¯åªæ˜¯æ·»åŠ è¿‡æœŸæ—¶é—´ï¼Œä¼šå‡ºç°è¿™ç§æŠŠåˆ«äººåŠ çš„é”è°å¸äº†çš„æƒ…å†µï¼Œè¦è§£å†³è¿™ç§é—®é¢˜ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬ç°åœ¨çš„ç›®æ ‡å°±æ˜¯ä¿è¯ä»»åŠ¡åªèƒ½åˆ é™¤è‡ªå·±åŠ çš„é”ï¼Œå¦‚æœæ˜¯åˆ«äººåŠ çš„é”æ˜¯æ²¡æœ‰èµ„æ ¼åˆ çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å§açš„å€¼æŒ‡å®šä¸ºæˆ‘ä»¬ä»»åŠ¡ä¸“å±çš„å€¼ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨UUIDä¹‹ç±»çš„ï¼Œå¦‚æœåœ¨ä¸»åŠ¨åˆ é™¤é”çš„æ—¶å€™å‘ç°å€¼ä¸æ˜¯æˆ‘ä»¬å½“å‰ä»»åŠ¡æŒ‡å®šçš„ï¼Œé‚£ä¹ˆè¯´æ˜å¯èƒ½æ˜¯å› ä¸ºè¶…æ—¶ï¼Œå…¶ä»–ä»»åŠ¡å·²ç»åŠ é”äº†ã€‚\nå¦‚æœä½ åœ¨å­¦ä¹ æœ¬ç¯‡ä¹‹å‰å®Œæˆäº†JUCå¹¶å‘ç¼–ç¨‹ç¯‡çš„å­¦ä¹ ï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰ä¸€ä¸ªç–‘æƒ‘ï¼Œå¦‚æœåœ¨è¶…æ—¶ä¹‹å‰é‚£ä¸€åˆ¹é‚£è¿›å…¥åˆ°é‡Šæ”¾é”çš„é˜¶æ®µï¼Œè·å–åˆ°å€¼è‚¯å®šè¿˜æ˜¯è‡ªå·±ï¼Œä½†æ˜¯åœ¨å³å°†æ‰§è¡Œåˆ é™¤ä¹‹å‰ï¼Œç”±äºè¶…æ—¶æœºåˆ¶å¯¼è‡´è¢«åˆ é™¤å¹¶ä¸”å…¶ä»–ä»»åŠ¡ä¹ŸåŠ é”äº†ï¼Œé‚£ä¹ˆè¿™æ—¶å†è¿›è¡Œåˆ é™¤ï¼Œä»ç„¶ä¼šå¯¼è‡´åˆ é™¤å…¶ä»–ä»»åŠ¡åŠ çš„é”ã€‚\nå®é™…ä¸Šæœ¬è´¨è¿˜æ˜¯å› ä¸ºé”çš„è¶…æ—¶æ—¶é—´ä¸å¤ªå¥½è¡¡é‡ï¼Œå¦‚æœè¶…æ—¶æ—¶é—´èƒ½å¤Ÿè®¾å®šåœ°æ¯”è¾ƒæ°å½“ï¼Œé‚£ä¹ˆå°±å¯ä»¥é¿å…è¿™ç§é—®é¢˜äº†ã€‚\nè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸€ä¸‹Redissonæ¡†æ¶ï¼Œå®ƒæ˜¯Rediså®˜æ–¹æ¨èçš„Javaç‰ˆçš„Rediså®¢æˆ·ç«¯ã€‚å®ƒæä¾›çš„åŠŸèƒ½éå¸¸å¤šï¼Œä¹Ÿéå¸¸å¼ºå¤§ï¼ŒRedissonå†…éƒ¨æä¾›äº†ä¸€ä¸ªç›‘æ§é”çš„çœ‹é—¨ç‹—ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨Redissonå®ä¾‹è¢«å…³é—­å‰ï¼Œä¸æ–­çš„å»¶é•¿é”çš„æœ‰æ•ˆæœŸï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šç§åˆ†å¸ƒå¼é”çš„å®ç°ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿç±»ä¼¼æˆ‘ä»¬åœ¨JUCä¸­å­¦ä¹ çš„é”ï¼Œè¿™é‡Œæˆ‘ä»¬å°è¯•ä½¿ç”¨ä¸€ä¸‹å®ƒçš„åˆ†å¸ƒå¼é”åŠŸèƒ½ã€‚\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.redisson\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;redisson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.17.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.netty\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;netty-all\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.1.75.Final\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ä¸åŠ é”çš„æƒ…å†µä¸‹ï¼š\npublic static void main(String[] args) { for (int i = 0; i \u0026lt; 10; i++) { new Thread(() -\u0026gt; { try(Jedis jedis = new Jedis(\u0026#34;192.168.0.10\u0026#34;, 6379)){ for (int j = 0; j \u0026lt; 100; j++) { //æ¯ä¸ªå®¢æˆ·ç«¯è·å–aç„¶åå¢åŠ açš„å€¼å†å†™å›å»ï¼Œå¦‚æœä¸åŠ é”é‚£ä¹ˆè‚¯å®šä¼šå‡ºé—®é¢˜ int a = Integer.parseInt(jedis.get(\u0026#34;a\u0026#34;)) + 1; jedis.set(\u0026#34;a\u0026#34;, a+\u0026#34;\u0026#34;); } } }).start(); } } è¿™é‡Œæ²¡æœ‰ç›´æ¥ç”¨incrè€Œæ˜¯æˆ‘ä»¬è‡ªå·±è¿›è¡Œè®¡ç®—ï¼Œæ–¹ä¾¿æ¨¡æ‹Ÿï¼Œå¯ä»¥çœ‹åˆ°è¿è¡Œç»“æŸä¹‹åaçš„å€¼å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼š\nç°åœ¨æˆ‘ä»¬æ¥ç»™å®ƒåŠ ä¸€æŠŠé”ï¼Œæ³¨æ„è¿™ä¸ªé”æ˜¯åŸºäºRedisçš„ï¼Œä¸ä»…ä»…åªå¯ä»¥ç”¨äºå½“å‰åº”ç”¨ï¼Œæ˜¯èƒ½å¤Ÿå®ç³»ç»Ÿçš„ï¼š\npublic static void main(String[] args) { Config config = new Config(); config.useSingleServer().setAddress(\u0026#34;redis://192.168.0.10:6379\u0026#34;); //é…ç½®è¿æ¥çš„RedisæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šé›†ç¾¤ RedissonClient client = Redisson.create(config); //åˆ›å»ºRedissonClientå®¢æˆ·ç«¯ for (int i = 0; i \u0026lt; 10; i++) { new Thread(() -\u0026gt; { try(Jedis jedis = new Jedis(\u0026#34;192.168.0.10\u0026#34;, 6379)){ RLock lock = client.getLock(\u0026#34;testLock\u0026#34;); //æŒ‡å®šé”çš„åç§°ï¼Œæ‹¿åˆ°é”å¯¹è±¡ for (int j = 0; j \u0026lt; 100; j++) { lock.lock(); //åŠ é” int a = Integer.parseInt(jedis.get(\u0026#34;a\u0026#34;)) + 1; jedis.set(\u0026#34;a\u0026#34;, a+\u0026#34;\u0026#34;); lock.unlock(); //è§£é” } } System.out.println(\u0026#34;ç»“æŸï¼\u0026#34;); }).start(); } } å¯ä»¥çœ‹åˆ°ç»“æœæ²¡æœ‰é—®é¢˜ï¼š\næ³¨æ„ï¼Œå¦‚æœç”¨äºå­˜æ”¾é”çš„RedisæœåŠ¡å™¨æŒ‚äº†ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯ä¼šå‡ºé—®é¢˜çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨RedLockï¼Œå®ƒçš„æ€è·¯æ˜¯ï¼Œåœ¨å¤šä¸ªRedisæœåŠ¡å™¨ä¸Šä¿å­˜é”ï¼Œåªéœ€è¦è¶…è¿‡åŠæ•°çš„RedisæœåŠ¡å™¨è·å–åˆ°é”ï¼Œé‚£ä¹ˆå°±çœŸçš„è·å–åˆ°é”äº†ï¼Œè¿™æ ·å°±ç®—æŒ‚æ‰ä¸€éƒ¨åˆ†èŠ‚ç‚¹ï¼Œä¹Ÿèƒ½ä¿è¯æ­£å¸¸è¿è¡Œï¼Œè¿™é‡Œå°±ä¸åšæ¼”ç¤ºäº†ã€‚\nMySQLä¸åˆ†å¸ƒå¼ #\rå‰é¢æˆ‘è®²è§£äº†Redisåœ¨åˆ†å¸ƒå¼åœºæ™¯çš„ä¸‹çš„ç›¸å…³åº”ç”¨ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹MySQLæ•°æ®åº“åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹çš„åº”ç”¨ã€‚\nä¸»ä»å¤åˆ¶ #\rå½“æˆ‘ä»¬ä½¿ç”¨MySQLçš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥é‡‡å–ä¸»ä»å¤åˆ¶çš„ç­–ç•¥ï¼Œå®ƒçš„å®ç°æ€è·¯åŸºæœ¬å’ŒRedisç›¸ä¼¼ï¼Œä¹Ÿæ˜¯é‡‡ç”¨å¢é‡å¤åˆ¶çš„æ–¹å¼ï¼ŒMySQLä¼šåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¼šè®°å½•äºŒè¿›åˆ¶æ—¥å¿—ï¼Œæ‰€æœ‰çš„DMLå’ŒDDLæ“ä½œéƒ½ä¼šè¢«è®°å½•è¿›æ—¥å¿—ä¸­ï¼Œä¸»åº“åªéœ€è¦å°†è®°å½•çš„æ“ä½œå¤åˆ¶ç»™ä»åº“ï¼Œè®©ä»åº“ä¹Ÿè¿è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°ä¸»ä»å¤åˆ¶ã€‚ä½†æ˜¯æ³¨æ„å®ƒä¸ä¼šåœ¨ä¸€å¼€å§‹è¿›è¡Œå…¨é‡å¤åˆ¶ï¼Œæ‰€ä»¥æœ€å¥½å†å¼€å§‹ä¸»ä»ä¹‹å‰å°†æ•°æ®åº“çš„å†…å®¹ä¿æŒä¸€è‡´ã€‚\nå’Œä¹‹å‰ä¸€æ ·ï¼Œä¸€æ—¦æˆ‘ä»¬å®ç°äº†ä¸»ä»å¤åˆ¶ï¼Œé‚£ä¹ˆå°±ç®—ä¸»åº“å‡ºç°æ•…éšœï¼Œä»åº“ä¹Ÿèƒ½æ­£å¸¸æä¾›æœåŠ¡ï¼Œå¹¶ä¸”è¿˜å¯ä»¥å®ç°è¯»å†™åˆ†ç¦»ç­‰æ“ä½œã€‚è¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨ä¸¤å°ä¸»æœºæ¥æ­å»ºä¸€ä¸»ä¸€ä»çš„ç¯å¢ƒï¼Œé¦–å…ˆç¡®ä¿ä¸¤å°æœåŠ¡å™¨éƒ½å®‰è£…äº†MySQLæ•°æ®åº“å¹¶ä¸”éƒ½å·²ç»æ­£å¸¸è¿è¡Œäº†ï¼š\næ¥ç€æˆ‘ä»¬éœ€è¦åˆ›å»ºå¯¹åº”çš„è´¦å·ï¼Œä¸€ä¼šæ–¹ä¾¿ä»åº“è¿›è¡Œè®¿é—®çš„ç”¨æˆ·ï¼š\nCREATE USER test identified with mysql_native_password by \u0026#39;123456\u0026#39;; æ¥ç€æˆ‘ä»¬å¼€å¯ä¸€ä¸‹å¤–ç½‘è®¿é—®ï¼š\nsudo vim /etc/mysql/mysql.conf.d/mysqld.cnf ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š\n# If MySQL is running as a replication slave, this should be # changed. Ref https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_tmpdir # tmpdir = /tmp # # Instead of skip-networking the default is now to listen only on # localhost which is more compatible and is not less secure. # bind-address = 127.0.0.1 è¿™é‡Œæ³¨é‡Šæ‰å°±è¡Œ ç°åœ¨æˆ‘ä»¬é‡å¯ä¸€ä¸‹MySQLæœåŠ¡ï¼š\nsudo systemctl restart mysql.service ç°åœ¨æˆ‘ä»¬é¦–å…ˆæ¥é…ç½®ä¸»åº“ï¼Œä¸»åº“åªéœ€è¦ä¸ºæˆ‘ä»¬åˆšåˆšåˆ›å»ºå¥½çš„ç”¨æˆ·åˆ†é…ä¸€ä¸ªä¸»ä»å¤åˆ¶çš„æƒé™å³å¯ï¼š\ngrant replication slave on *.* to test; FLUSH PRIVILEGES; ç„¶åæˆ‘ä»¬å¯ä»¥è¾“å…¥å‘½ä»¤æ¥æŸ¥çœ‹ä¸»åº“çš„ç›¸å…³æƒ…å†µï¼š\nè¿™æ ·ä¸»åº“å°±æ­å»ºå®Œæˆäº†ï¼Œæ¥ç€æˆ‘ä»¬éœ€è¦å°†ä»åº“è¿›è¡Œé…ç½®ï¼Œé¦–å…ˆæ˜¯é…ç½®æ–‡ä»¶ï¼š\n# The following can be used as easy to replay backup logs or for replication. # note: if you are setting up a replication slave, see README.Debian about # other settings you may need to change. # è¿™é‡Œéœ€è¦å°†server-idé…ç½®ä¸ºå…¶ä»–çš„å€¼ï¼ˆé»˜è®¤æ˜¯1ï¼‰æ‰€æœ‰Mysqlä¸»ä»å®ä¾‹çš„idå¿…é¡»å”¯ä¸€ï¼Œä¸èƒ½æ‰“æ¶ï¼Œä¸ç„¶ä¸€ä¼šå¼€å¯ä¼šå¤±è´¥ server-id = 2 è¿›å…¥æ•°æ®åº“ï¼Œè¾“å…¥ï¼š\nchange replication source to SOURCE_HOST=\u0026#39;192.168.0.8\u0026#39;,SOURCE_USER=\u0026#39;test\u0026#39;,SOURCE_PASSWORD=\u0026#39;123456\u0026#39;,SOURCE_LOG_FILE=\u0026#39;binlog.000004\u0026#39;,SOURCE_LOG_POS=591; æ³¨æ„åé¢çš„logfileå’Œposå°±æ˜¯æˆ‘ä»¬ä¸Šé¢ä»ä¸»åº“ä¸­æ˜¾ç¤ºçš„ä¿¡æ¯ã€‚\næ‰§è¡Œå®Œæˆåï¼Œæ˜¾ç¤ºOKè¡¨ç¤ºæ²¡æœ‰é—®é¢˜ï¼Œæ¥ç€è¾“å…¥ï¼š\nstart replica; ç°åœ¨æˆ‘ä»¬çš„ä»æœºå°±æ­£å¼å¯åŠ¨äº†ï¼Œç°åœ¨æˆ‘ä»¬è¾“å…¥ï¼š\nshow replica status\\G; æ¥æŸ¥çœ‹å½“å‰ä»æœºçŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ï¼š\næœ€å…³é”®çš„æ˜¯ä¸‹é¢çš„Replica_IO_Runningå’ŒReplica_SQL_Runningå¿…é¡»åŒæ—¶ä¸ºYesæ‰å¯ä»¥ï¼Œå®é™…ä¸Šä»åº“ä¼šåˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹è´Ÿè´£ä¸ä¸»åº“è¿›è¡Œé€šä¿¡ï¼Œè·å–äºŒè¿›åˆ¶æ—¥å¿—ï¼Œæš‚æ—¶å­˜æ”¾åˆ°ä¸€ä¸ªä¸­é—´è¡¨ï¼ˆRelay_Logï¼‰ä¸­ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åˆ™æ˜¯å°†ä¸­é—´è¡¨ä¿å­˜çš„äºŒè¿›åˆ¶æ—¥å¿—çš„ä¿¡æ¯è¿›è¡Œæ‰§è¡Œï¼Œç„¶åæ’å…¥åˆ°ä»åº“ä¸­ã€‚\næœ€åé…ç½®å®Œæˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åœ¨ä¸»åº“è¿›è¡Œæ“ä½œä¼šä¸ä¼šåŒæ­¥åˆ°ä»åº“ï¼š\nå¯ä»¥çœ‹åˆ°åœ¨ä¸»åº“ä¸­åˆ›å»ºçš„æ•°æ®åº“ï¼Œè¢«åŒæ­¥åˆ°ä»åº“ä¸­äº†ï¼Œæˆ‘ä»¬å†æ¥è¯•è¯•çœ‹åˆ›å»ºè¡¨å’Œæ’å…¥æ•°æ®ï¼š\nuse yyds; create table test ( `id` int primary key, `name` varchar(255) NULL, `passwd` varchar(255) NULL ); ç°åœ¨æˆ‘ä»¬éšä¾¿æ’å…¥ä¸€ç‚¹æ•°æ®ï¼š\nè¿™æ ·ï¼Œæˆ‘ä»¬çš„MySQLä¸»ä»å°±æ­å»ºå®Œæˆäº†ï¼Œé‚£ä¹ˆå¦‚æœä¸»æœºæ­¤æ—¶æŒ‚äº†ä¼šæ€ä¹ˆæ ·ï¼Ÿ\nå¯ä»¥çœ‹åˆ°IOçº¿ç¨‹æ˜¯å¤„äºé‡è¿çŠ¶æ€ï¼Œä¼šç­‰å¾…ä¸»åº“é‡æ–°æ¢å¤è¿è¡Œã€‚\nåˆ†åº“åˆ†è¡¨ #\råœ¨å¤§å‹çš„äº’è”ç½‘ç³»ç»Ÿä¸­ï¼Œå¯èƒ½å•å°MySQLçš„å­˜å‚¨å®¹é‡æ— æ³•æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼Œè¿™æ—¶å€™å°±éœ€è¦è¿›è¡Œæ‰©å®¹äº†ã€‚\nå’Œä¹‹å‰çš„é—®é¢˜ä¸€æ ·ï¼Œå•å°ä¸»æœºçš„ç¡¬ä»¶èµ„æºæ˜¯å­˜åœ¨ç“¶é¢ˆçš„ï¼Œä¸å¯èƒ½æ— é™åˆ¶åœ°çºµå‘æ‰©å±•ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¾—é€šè¿‡å¤šå°å®ä¾‹æ¥è¿›è¡Œå®¹é‡çš„æ¨ªå‘æ‰©å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®åˆ†æ•£å­˜å‚¨ï¼Œè®©å¤šå°ä¸»æœºå…±åŒæ¥ä¿å­˜æ•°æ®ã€‚\né‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆä¸ªåˆ†æ•£æ³•ï¼Ÿ\nå‚ç›´æ‹†åˆ†ï¼š æˆ‘ä»¬çš„è¡¨å’Œæ•°æ®åº“éƒ½å¯ä»¥è¿›è¡Œå‚ç›´æ‹†åˆ†ï¼Œæ‰€è°“å‚ç›´æ‹†åˆ†ï¼Œå°±æ˜¯å°†æ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨ï¼ŒæŒ‰ç…§ä¸šåŠ¡åŠŸèƒ½æ‹†åˆ†åˆ°å„ä¸ªæ•°æ®åº“ä¸­ï¼ˆæ˜¯ä¸æ˜¯æ„Ÿè§‰è·Ÿå‰é¢ä¸¤ç« çš„å­¦ä¹ çš„æ¶æ„å¯¹åº”èµ·æ¥äº†ï¼‰è€Œå¯¹äºä¸€å¼ è¡¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¤–é”®ä¹‹ç±»çš„æœºåˆ¶ï¼Œå°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªè¡¨ã€‚\næ°´å¹³æ‹†åˆ†ï¼š æ°´å¹³æ‹†åˆ†é’ˆå¯¹çš„ä¸æ˜¯è¡¨ï¼Œè€Œæ˜¯æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è®©å¾ˆå¤šä¸ªå…·æœ‰ç›¸åŒè¡¨çš„æ•°æ®åº“å­˜æ”¾ä¸€éƒ¨åˆ†æ•°æ®ï¼Œç›¸å½“äºæ˜¯å°†æ•°æ®åˆ†æ•£å­˜å‚¨åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šã€‚\né‚£ä¹ˆè¦å®ç°è¿™æ ·çš„æ‹†åˆ†æ“ä½œï¼Œæˆ‘ä»¬è‡ªè¡Œå»ç¼–å†™ä»£ç å·¥ä½œé‡è‚¯å®šæ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå› æ­¤ç›®å‰å®é™…ä¸Šå·²ç»æœ‰ä¸€äº›è§£å†³æ–¹æ¡ˆäº†ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨MyCatï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªæ•°æ®åº“ä¸­é—´ä»¶ï¼Œç›¸å½“äºæŒ‚äº†ä¸€å±‚ä»£ç†ï¼Œå†é€šè¿‡MyCatè¿›è¡Œåˆ†åº“åˆ†è¡¨æ“ä½œæ•°æ®åº“ï¼Œåªéœ€è¦è¿æ¥å°±èƒ½ä½¿ç”¨ï¼Œç±»ä¼¼çš„è¿˜æœ‰ShardingSphere-Proxyï¼‰æˆ–æ˜¯Sharding JDBCï¼ˆåº”ç”¨ç¨‹åºä¸­ç›´æ¥å¯¹SQLè¯­å¥è¿›è¡Œåˆ†æï¼Œç„¶åè½¬æ¢æˆåˆ†åº“åˆ†è¡¨æ“ä½œï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±ç¼–å†™ä¸€äº›é€»è¾‘ä»£ç ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬å°±è®²è§£ä¸€ä¸‹Sharding JDBCã€‚\nSharding JDBC #\rå®˜æ–¹æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰ï¼š https://shardingsphere.apache.org/document/5.1.0/cn/overview/#shardingsphere-jdbc\nå®šä½ä¸ºè½»é‡çº§ Java æ¡†æ¶ï¼Œåœ¨ Java çš„ JDBC å±‚æä¾›çš„é¢å¤–æœåŠ¡ï¼Œå®ƒä½¿ç”¨å®¢æˆ·ç«¯ç›´è¿æ•°æ®åº“ï¼Œä»¥ jar åŒ…å½¢å¼æä¾›æœåŠ¡ï¼Œæ— éœ€é¢å¤–éƒ¨ç½²å’Œä¾èµ–ï¼Œå¯ç†è§£ä¸ºå¢å¼ºç‰ˆçš„ JDBC é©±åŠ¨ï¼Œå®Œå…¨å…¼å®¹ JDBC å’Œå„ç§ ORM æ¡†æ¶ã€‚\né€‚ç”¨äºä»»ä½•åŸºäº JDBC çš„ ORM æ¡†æ¶ï¼Œå¦‚ï¼šJPA, Hibernate, Mybatis, Spring JDBC Template æˆ–ç›´æ¥ä½¿ç”¨ JDBCï¼› æ”¯æŒä»»ä½•ç¬¬ä¸‰æ–¹çš„æ•°æ®åº“è¿æ¥æ± ï¼Œå¦‚ï¼šDBCP, C3P0, BoneCP, HikariCP ç­‰ï¼› æ”¯æŒä»»æ„å®ç° JDBC è§„èŒƒçš„æ•°æ®åº“ï¼Œç›®å‰æ”¯æŒ MySQLï¼ŒPostgreSQLï¼ŒOracleï¼ŒSQLServer ä»¥åŠä»»ä½•å¯ä½¿ç”¨ JDBC è®¿é—®çš„æ•°æ®åº“ã€‚ è¿™é‡Œæˆ‘ä»¬ä¸»è¦æ¼”ç¤ºä¸€ä¸‹æ°´å¹³åˆ†è¡¨æ–¹å¼ï¼Œæˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„SpringBooté¡¹ç›®å³å¯ï¼Œä¾èµ–å¦‚ä¸‹ï¼š\n\u0026lt;dependencies\u0026gt; \u0026lt;!-- ShardingJDBCä¾èµ–ï¼Œé‚£å¿…é¡»å®‰æ’æœ€æ–°ç‰ˆå•Šï¼Œå¸Œæœ›ä½ ä»¬çœ‹è§†é¢‘çš„æ—¶å€™è¿˜æ˜¯5.Xç‰ˆæœ¬ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.shardingsphere\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;shardingsphere-jdbc-core-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.1.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;optional\u0026gt;true\u0026lt;/optional\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-test\u0026lt;/artifactId\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; æ•°æ®åº“æˆ‘ä»¬è¿™é‡Œç›´æ¥ç”¨ä¸ŠèŠ‚è¯¾çš„å³å¯ï¼Œå› ä¸ºåªéœ€è¦ä¸¤ä¸ªè¡¨ç»“æ„ä¸€æ ·çš„æ•°æ®åº“å³å¯ï¼Œæ­£å¥½ä¸ŠèŠ‚è¯¾è¿›è¡Œäº†åŒæ­¥ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠä»åº“å˜å›æ­£å¸¸çŠ¶æ€å°±å¯ä»¥äº†ï¼š\nstop replica; æ¥ç€æˆ‘ä»¬æŠŠä¸¤ä¸ªè¡¨çš„rootç”¨æˆ·å¯†ç æ”¹ä¸€ä¸‹ï¼Œä¸€ä¼šç”¨è¿™ä¸ªç”¨æˆ·è¿æ¥æ•°æ®åº“ï¼š\nupdate user set authentication_string=\u0026#39;\u0026#39; where user=\u0026#39;root\u0026#39;; update user set host = \u0026#39;%\u0026#39; where user = \u0026#39;root\u0026#39;; alter user root identified with mysql_native_password by \u0026#39;123456\u0026#39;; FLUSH PRIVILEGES; æ¥ç€æˆ‘ä»¬æ¥çœ‹ï¼Œå¦‚æœç›´æ¥å°è¯•å¼€å¯æœåŠ¡å™¨ï¼Œé‚£è‚¯å®šæ˜¯å¼€ä¸äº†çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¦é…ç½®æ•°æ®æºï¼š\né‚£ä¹ˆæ•°æ®æºè¯¥æ€ä¹ˆé…ç½®å‘¢ï¼Ÿç°åœ¨æˆ‘ä»¬æ˜¯ä¸€ä¸ªåˆ†åº“åˆ†è¡¨çš„çŠ¶æ€ï¼Œéœ€è¦é…ç½®ä¸¤ä¸ªæ•°æ®æºï¼š\nspring: shardingsphere: datasource: # æœ‰å‡ ä¸ªæ•°æ®å°±é…å‡ ä¸ªï¼Œè¿™é‡Œæ˜¯åç§°ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ ¼å¼ï¼Œåç§°+æ•°å­—çš„å½¢å¼ names: db0,db1 # ä¸ºæ¯ä¸ªæ•°æ®æºå•ç‹¬è¿›è¡Œé…ç½® db0: # æ•°æ®æºå®ç°ç±»ï¼Œè¿™é‡Œä½¿ç”¨é»˜è®¤çš„HikariDataSource type: com.zaxxer.hikari.HikariDataSource # æ•°æ®åº“é©±åŠ¨ driver-class-name: com.mysql.cj.jdbc.Driver # ä¸ç”¨æˆ‘å¤šè¯´äº†å§ jdbc-url: jdbc:mysql://192.168.0.8:3306/yyds username: root password: 123456 db1: type: com.zaxxer.hikari.HikariDataSource driver-class-name: com.mysql.cj.jdbc.Driver jdbc-url: jdbc:mysql://192.168.0.13:3306/yyds username: root password: 123456 å¦‚æœå¯åŠ¨æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆå°±æ˜¯é…ç½®æˆåŠŸäº†ï¼š\næ¥ç€æˆ‘ä»¬éœ€è¦å¯¹é¡¹ç›®è¿›è¡Œä¸€äº›ç¼–å†™ï¼Œæ·»åŠ æˆ‘ä»¬çš„ç”¨æˆ·å®ä½“ç±»å’ŒMapperï¼š\n@Data @AllArgsConstructor public class User { int id; String name; String passwd; } @Mapper public interface UserMapper { @Select(\u0026#34;select * from test where id = #{id}\u0026#34;) User getUserById(int id); @Insert(\u0026#34;insert into test(id, name, passwd) values(#{id}, #{name}, #{passwd})\u0026#34;) int addUser(User user); } å®é™…ä¸Šè¿™äº›æ“ä½œéƒ½æ˜¯å¸¸è§„æ“ä½œï¼Œåœ¨ç¼–å†™ä»£ç æ—¶å…³æ³¨ç‚¹ä¾ç„¶æ”¾åœ¨ä¸šåŠ¡æœ¬èº«ä¸Šï¼Œç°åœ¨æˆ‘ä»¬å°±æ¥ç¼–å†™é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ShardingJDBCè¦å¦‚ä½•è¿›è¡Œåˆ†ç‰‡ï¼Œé¦–å…ˆæ˜ç¡®ï¼šç°åœ¨æ˜¯ä¸¤ä¸ªæ•°æ®åº“éƒ½æœ‰testè¡¨å­˜æ”¾ç”¨æˆ·æ•°æ®ï¼Œæˆ‘ä»¬ç›®æ ‡æ˜¯å°†ç”¨æˆ·ä¿¡æ¯åˆ†åˆ«å­˜æ”¾åˆ°è¿™ä¸¤ä¸ªæ•°æ®åº“çš„è¡¨ä¸­ã€‚\nä¸åºŸè¯äº†ï¼Œç›´æ¥ä¸Šé…ç½®ï¼š\nspring: shardingsphere: rules: sharding: tables: #è¿™é‡Œå¡«å†™è¡¨åç§°ï¼Œç¨‹åºä¸­å¯¹è¿™å¼ è¡¨çš„æ‰€æœ‰æ“ä½œï¼Œéƒ½ä¼šé‡‡ç”¨ä¸‹é¢çš„è·¯ç”±æ–¹æ¡ˆ #æ¯”å¦‚æˆ‘ä»¬ä¸Šé¢Mybatiså°±æ˜¯å¯¹testè¡¨è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥ä¼šèµ°ä¸‹é¢çš„è·¯ç”±æ–¹æ¡ˆ test: #è¿™é‡Œå¡«å†™å®é™…çš„è·¯ç”±èŠ‚ç‚¹ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬è¦åˆ†ä¸¤ä¸ªåº“ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠä¸¤ä¸ªåº“éƒ½å†™ä¸Šï¼Œä»¥åŠå¯¹åº”çš„è¡¨ #ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ä¸‹é¢çš„å¯ä»¥ç®€å†™ä¸º db$-\u0026gt;{0..1}.test actual-data-nodes: db0.test,db1.test #è¿™é‡Œæ˜¯åˆ†åº“ç­–ç•¥é…ç½® database-strategy: #è¿™é‡Œé€‰æ‹©æ ‡å‡†ç­–ç•¥ï¼Œä¹Ÿå¯ä»¥é…ç½®å¤æ‚ç­–ç•¥ï¼ŒåŸºäºå¤šä¸ªé”®è¿›è¡Œåˆ†ç‰‡ standard: #å‚ä¸åˆ†ç‰‡è¿ç®—çš„å­—æ®µï¼Œä¸‹é¢çš„ç®—æ³•ä¼šæ ¹æ®è¿™é‡Œæä¾›çš„å­—æ®µè¿›è¡Œè¿ç®— sharding-column: id #è¿™é‡Œå¡«å†™æˆ‘ä»¬ä¸‹é¢è‡ªå®šä¹‰çš„ç®—æ³•åç§° sharding-algorithm-name: my-alg sharding-algorithms: #è‡ªå®šä¹‰ä¸€ä¸ªæ–°çš„ç®—æ³•ï¼Œåç§°éšæ„ my-alg: #ç®—æ³•ç±»å‹ï¼Œå®˜æ–¹å†…ç½®äº†å¾ˆå¤šç§ï¼Œè¿™é‡Œæ¼”ç¤ºæœ€ç®€å•çš„ä¸€ç§ type: MOD props: sharding-count: 2 props: #å¼€å¯æ—¥å¿—ï¼Œä¸€ä¼šæ–¹ä¾¿æˆ‘ä»¬è§‚å¯Ÿ sql-show: true å…¶ä¸­ï¼Œåˆ†ç‰‡ç®—æ³•æœ‰å¾ˆå¤šå†…ç½®çš„ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥è¯¢ï¼šhttps://shardingsphere.apache.org/document/5.1.0/cn/user-manual/shardingsphere-jdbc/builtin-algorithm/sharding/ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯MODï¼Œä¹Ÿå°±æ˜¯å–æ¨¡åˆ†ç‰‡ç®—æ³•ï¼Œå®ƒä¼šæ ¹æ®ä¸»é”®çš„å€¼è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œå¡«å†™çš„æ˜¯2ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºå¯¹ä¸»é”®è¿›è¡Œæ¨¡2è¿ç®—ï¼Œæ ¹æ®æ•°æ®æºçš„åç§°ï¼Œæ¯”å¦‚db0å°±æ˜¯å–æ¨¡åä¸º0ï¼Œdb1å°±æ˜¯å–æ¨¡åä¸º1ï¼ˆå®˜æ–¹æ–‡æ¡£æè¿°çš„å¹¶ä¸æ˜¯å¾ˆæ¸…æ¥šï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€ç»ˆå®ç°çš„æ•ˆæœå°±æ˜¯å•æ•°æ”¾åœ¨db1ï¼ŒåŒæ•°æ”¾åœ¨db0ï¼Œå½“ç„¶å®ƒè¿˜æ”¯æŒä¸€äº›å…¶ä»–çš„ç®—æ³•ï¼Œè¿™é‡Œå°±ä¸å¤šä»‹ç»äº†ã€‚\né‚£ä¹ˆç°åœ¨æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æ¥çœ‹çœ‹ï¼Œæ˜¯å¦èƒ½å¤ŸæŒ‰ç…§æˆ‘ä»¬ä¸Šé¢çš„è§„åˆ™è¿›è¡Œè·¯ç”±ï¼š\n@SpringBootTest class ShardingJdbcTestApplicationTests { @Resource UserMapper mapper; @Test void contextLoads() { for (int i = 0; i \u0026lt; 10; i++) { //è¿™é‡ŒIDè‡ªåŠ¨ç”Ÿæˆ1-10ï¼Œç„¶åæ’å…¥æ•°æ®åº“ mapper.addUser(new User(i, \u0026#34;xxx\u0026#34;, \u0026#34;ccc\u0026#34;)); } } } ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿è¡Œäº†ï¼š\næµ‹è¯•é€šè¿‡ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ•°æ®åº“é‡Œé¢æ˜¯ä¸æ˜¯æŒ‰ç…§æˆ‘ä»¬çš„è§„åˆ™è¿›è¡Œæ•°æ®æ’å…¥çš„ï¼š\nå¯ä»¥çœ‹åˆ°è¿™ä¸¤å¼ è¡¨ï¼Œéƒ½æˆåŠŸæŒ‰ç…§æˆ‘ä»¬æŒ‡å®šçš„è·¯ç”±è§„åˆ™è¿›è¡Œæ’å…¥äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¯¦ç»†çš„è·¯ç”±æƒ…å†µï¼Œé€šè¿‡æ§åˆ¶å°è¾“å‡ºçš„SQLå°±å¯ä»¥çœ‹åˆ°ï¼š\nå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„SQLè¯­å¥éƒ½æœ‰ä¸€ä¸ªLogic SQLï¼ˆè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬åœ¨Mybatisé‡Œé¢å†™çš„ï¼Œæ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆï¼‰ç´§æ¥ç€ä¸‹é¢å°±æ˜¯Actual SQLï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªé€»è¾‘SQLæœ€ç»ˆä¼šæ ¹æ®æˆ‘ä»¬çš„ç­–ç•¥è½¬æ¢ä¸ºå®é™…SQLï¼Œæ¯”å¦‚ç¬¬ä¸€æ¡æ•°æ®ï¼Œå®ƒçš„idæ˜¯0ï¼Œé‚£ä¹ˆå®é™…è½¬æ¢å‡ºæ¥çš„SQLä¼šåœ¨db0è¿™ä¸ªæ•°æ®æºè¿›è¡Œæ’å…¥ã€‚\nè¿™æ ·æˆ‘ä»¬å°±å¾ˆè½»æ¾åœ°å®ç°äº†åˆ†åº“ç­–ç•¥ã€‚\nåˆ†åº“å®Œæˆä¹‹åï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹åˆ†è¡¨ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬çš„æ•°æ®åº“ä¸­æœ‰test_0å’Œtest_1ä¸¤å¼ è¡¨ï¼Œè¡¨ç»“æ„ä¸€æ ·ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿæ˜¯å¸Œæœ›èƒ½å¤Ÿæ ¹æ®idå–æ¨¡è¿ç®—çš„ç»“æœåˆ†åˆ«æ”¾åˆ°è¿™ä¸¤ä¸ªä¸åŒçš„è¡¨ä¸­ï¼Œå®ç°æ€è·¯å…¶å®æ˜¯å·®ä¸å¤šçš„ï¼Œè¿™é‡Œé¦–å…ˆéœ€è¦ä»‹ç»ä¸€ä¸‹ä¸¤ç§è¡¨æ¦‚å¿µï¼š\né€»è¾‘è¡¨ï¼š ç›¸åŒç»“æ„çš„æ°´å¹³æ‹†åˆ†æ•°æ®åº“ï¼ˆè¡¨ï¼‰çš„é€»è¾‘åç§°ï¼Œæ˜¯ SQL ä¸­è¡¨çš„é€»è¾‘æ ‡è¯†ã€‚ ä¾‹ï¼šè®¢å•æ•°æ®æ ¹æ®ä¸»é”®å°¾æ•°æ‹†åˆ†ä¸º 10 å¼ è¡¨ï¼Œåˆ†åˆ«æ˜¯ t_order_0 åˆ° t_order_9ï¼Œä»–ä»¬çš„é€»è¾‘è¡¨åä¸º t_order çœŸå®è¡¨ï¼š åœ¨æ°´å¹³æ‹†åˆ†çš„æ•°æ®åº“ä¸­çœŸå®å­˜åœ¨çš„ç‰©ç†è¡¨ã€‚ å³ä¸Šä¸ªç¤ºä¾‹ä¸­çš„ t_order_0 åˆ° t_order_9 ç°åœ¨æˆ‘ä»¬å°±ä»¥ä¸€å·æ•°æ®åº“ä¸ºä¾‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨é‡Œé¢åˆ›å»ºä¸Šé¢æåˆ°çš„ä¸¤å¼ è¡¨ï¼Œä¹‹å‰çš„é‚£ä¸ªtestè¡¨åˆ ä¸åˆ éƒ½å¯ä»¥ï¼Œå°±å½“åšä¸å­˜åœ¨å°±è¡Œäº†ï¼š\ncreate table test_0 ( `id` int primary key, `name` varchar(255) NULL, `passwd` varchar(255) NULL ); create table test_1 ( `id` int primary key, `name` varchar(255) NULL, `passwd` varchar(255) NULL ); æ¥ç€æˆ‘ä»¬ä¸è¦å»ä¿®æ”¹ä»»ä½•çš„ä¸šåŠ¡ä»£ç ï¼ŒMybatisé‡Œé¢å†™çš„æ˜¯ä»€ä¹ˆä¾ç„¶ä¿æŒåŸæ ·ï¼Œå³ä½¿æˆ‘ä»¬çš„è¡¨åå·²ç»å˜äº†ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯é€šè¿‡è·¯ç”±æ¥ä¿®æ”¹åŸæœ‰çš„SQLï¼Œé…ç½®å¦‚ä¸‹ï¼š\nspring: shardingsphere: rules: sharding: tables: test: actual-data-nodes: db0.test_$-\u0026gt;{0..1} #ç°åœ¨æˆ‘ä»¬æ¥é…ç½®ä¸€ä¸‹åˆ†è¡¨ç­–ç•¥ï¼Œæ³¨æ„è¿™é‡Œæ˜¯table-strategyä¸Šé¢æ˜¯database-strategy table-strategy: #åŸºæœ¬éƒ½è·Ÿä¹‹å‰æ˜¯ä¸€æ ·çš„ standard: sharding-column: id sharding-algorithm-name: my-alg sharding-algorithms: my-alg: #è¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºä¸€ä¸‹INLINEæ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªè¡Œç¼–å†™è¡¨è¾¾å¼æ¥å†³å®š type: INLINE props: #æ¯”å¦‚æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›è¿›è¡Œæ¨¡2è®¡ç®—å¾—åˆ°æ•°æ®è¯¥å»çš„è¡¨ #åªéœ€è¦ç»™ä¸€ä¸ªæœ€ç»ˆçš„è¡¨åç§°å°±è¡Œäº†test_ï¼Œåé¢çš„æ•°å­—æ˜¯è¡¨è¾¾å¼å–æ¨¡ç®—å‡ºçš„ #å®é™…ä¸Šè¿™æ ·å†™å’ŒMODæ¨¡å¼ä¸€æ¨¡ä¸€æ · algorithm-expression: test_$-\u0026gt;{id % 2} #æ²¡é”™ï¼ŒæŸ¥è¯¢ä¹Ÿä¼šæ ¹æ®åˆ†ç‰‡ç­–ç•¥æ¥è¿›è¡Œï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯èŒƒå›´æŸ¥è¯¢ï¼Œé‚£ä¹ˆä¾ç„¶ä¼šè¿›è¡Œå…¨é‡æŸ¥è¯¢ #è¿™ä¸ªæˆ‘ä»¬åé¢ç´§æ¥ç€ä¼šè®²ï¼Œè¿™é‡Œå…ˆå†™ä¸Šå§ allow-range-query-with-inline-sharding: false ç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹ä¼šä¸ä¼šæŒ‰ç…§æˆ‘ä»¬çš„ç­–ç•¥è¿›è¡Œåˆ†è¡¨æ’å…¥ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œæ ¹æ®æˆ‘ä»¬çš„ç®—æ³•ï¼ŒåŸæœ¬çš„é€»è¾‘è¡¨è¢«ä¿®æ”¹ä¸ºäº†æœ€ç»ˆè¿›è¡Œåˆ†è¡¨è®¡ç®—åçš„ç»“æœï¼Œæˆ‘ä»¬æ¥æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“ï¼š\næ’å…¥æˆ‘ä»¬äº†è§£å®Œæ¯•äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æŸ¥è¯¢å‘¢ï¼š\n@SpringBootTest class ShardingJdbcTestApplicationTests { @Resource UserMapper mapper; @Test void contextLoads() { System.out.println(mapper.getUserById(0)); System.out.println(mapper.getUserById(1)); } } å¯ä»¥çœ‹åˆ°ï¼Œæ ¹æ®æˆ‘ä»¬é…ç½®çš„ç­–ç•¥ï¼ŒæŸ¥è¯¢ä¹Ÿä¼šè‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„è¡¨è¿›è¡Œï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰å†…å‘³äº†ã€‚\né‚£ä¹ˆå¦‚æœæ˜¯èŒƒå›´æŸ¥è¯¢å‘¢ï¼Ÿ\n@Select(\u0026#34;select * from test where id between #{start} and #{end}\u0026#34;) List\u0026lt;User\u0026gt; getUsersByIdRange(int start, int end); @SpringBootTest class ShardingJdbcTestApplicationTests { @Resource UserMapper mapper; @Test void contextLoads() { System.out.println(mapper.getUsersByIdRange(3, 5)); } } æˆ‘ä»¬æ¥çœ‹çœ‹æ‰§è¡Œç»“æœä¼šæ€ä¹ˆæ ·ï¼š\nå¯ä»¥çœ‹åˆ°INLINEç®—æ³•é»˜è®¤æ˜¯ä¸æ”¯æŒè¿›è¡Œå…¨é‡æŸ¥è¯¢çš„ï¼Œæˆ‘ä»¬å¾—å°†ä¸Šé¢çš„é…ç½®é¡¹æ”¹æˆtrueï¼š\nallow-range-query-with-inline-sharding: true å†æ¬¡è¿›è¡Œæµ‹è¯•ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆå‡ºæ¥çš„SQLè¯­å¥æ˜¯ç›´æ¥å¯¹ä¸¤ä¸ªè¡¨éƒ½è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åæ±‚å‡ºä¸€ä¸ªå¹¶é›†å‡ºæ¥ä½œä¸ºæœ€åçš„ç»“æœã€‚\nå½“ç„¶é™¤äº†åˆ†ç‰‡ä¹‹å¤–ï¼Œè¿˜æœ‰å¹¿æ’­è¡¨å’Œç»‘å®šè¡¨æœºåˆ¶ï¼Œç”¨äºå¤šç§ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œè¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ï¼Œè¯¦ç»†è¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚\nåˆ†å¸ƒå¼åºåˆ—ç®—æ³• #\rå‰é¢æˆ‘ä»¬è®²è§£äº†å¦‚ä½•è¿›è¡Œåˆ†åº“åˆ†è¡¨ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹åˆ†å¸ƒå¼åºåˆ—ç®—æ³•ã€‚\nåœ¨å¤æ‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç‰¹åˆ«æ˜¯å¾®æœæ„æ¶ä¸­ï¼Œå¾€å¾€éœ€è¦å¯¹å¤§é‡çš„æ•°æ®å’Œæ¶ˆæ¯è¿›è¡Œå”¯ä¸€æ ‡è¯†ã€‚éšç€ç³»ç»Ÿçš„å¤æ‚ï¼Œæ•°æ®çš„å¢å¤šï¼Œåˆ†åº“åˆ†è¡¨æˆä¸ºäº†å¸¸è§çš„æ–¹æ¡ˆï¼Œå¯¹æ•°æ®åˆ†åº“åˆ†è¡¨åéœ€è¦æœ‰ä¸€ä¸ªå”¯ä¸€IDæ¥æ ‡è¯†ä¸€æ¡æ•°æ®æˆ–æ¶ˆæ¯ï¼ˆå¦‚è®¢å•å·ã€äº¤æ˜“æµæ°´ã€äº‹ä»¶ç¼–å·ç­‰ï¼‰ï¼Œæ­¤æ—¶ä¸€ä¸ªèƒ½å¤Ÿç”Ÿæˆå…¨å±€å”¯ä¸€IDçš„ç³»ç»Ÿæ˜¯éå¸¸å¿…è¦çš„ã€‚\næ¯”å¦‚æˆ‘ä»¬ä¹‹å‰åˆ›å»ºè¿‡å­¦ç”Ÿä¿¡æ¯è¡¨ã€å›¾ä¹¦å€Ÿé˜…è¡¨ã€å›¾ä¹¦ç®¡ç†è¡¨ï¼Œæ‰€æœ‰çš„ä¿¡æ¯éƒ½ä¼šæœ‰ä¸€ä¸ªIDä½œä¸ºä¸»é”®ï¼Œå¹¶ä¸”è¿™ä¸ªIDæœ‰ä»¥ä¸‹è¦æ±‚ï¼š\nä¸ºäº†åŒºåˆ«äºå…¶ä»–çš„æ•°æ®ï¼Œè¿™ä¸ªIDå¿…é¡»æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚ ä¸»é”®åº”è¯¥å°½å¯èƒ½çš„ä¿æŒæœ‰åºï¼Œè¿™æ ·ä¼šå¤§å¤§æå‡ç´¢å¼•çš„æŸ¥è¯¢æ•ˆç‡ã€‚ é‚£ä¹ˆæˆ‘ä»¬åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹ï¼Œå¦‚ä½•ä¿è¯IDçš„ç”Ÿæˆæ»¡è¶³ä¸Šé¢çš„éœ€æ±‚å‘¢ï¼Ÿ\nä½¿ç”¨UUIDï¼š UUIDæ˜¯ç”±ä¸€ç»„32ä½æ•°çš„16è¿›åˆ¶æ•°å­—éšæœºæ„æˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨JDKä¸ºæˆ‘ä»¬æä¾›çš„UUIDç±»æ¥åˆ›å»ºï¼š\npublic static void main(String[] args) { String uuid = UUID.randomUUID().toString(); System.out.println(uuid); } ç»“æœä¸º73d5219b-dc0f-4282-ac6e-8df17bcd5860ï¼Œç”Ÿæˆé€Ÿåº¦éå¸¸å¿«ï¼Œå¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯èƒ½å¤Ÿä¿è¯å”¯ä¸€æ€§ï¼Œå› ä¸ºæ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œè€Œä¸”è¿™ä¹ˆé•¿ä¸€ä¸²é‚£é‡å¤çš„æ¦‚ç‡çœŸçš„æ˜¯å°çš„å¯æ€œã€‚\nä½†æ˜¯å®ƒå¹¶ä¸æ»¡è¶³æˆ‘ä»¬ä¸Šé¢çš„ç¬¬äºŒä¸ªè¦æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦å°½å¯èƒ½çš„ä¿è¯æœ‰åºï¼Œè€Œè¿™é‡Œæˆ‘ä»¬å¾—åˆ°çš„éƒ½æ˜¯ä¸€äº›æ— åºçš„IDã€‚\né›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰ï¼š\næˆ‘ä»¬æ¥çœ‹é›ªèŠ±ç®—æ³•ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªä¸€ä¸ª64bitå¤§å°çš„æ•´å‹çš„IDï¼Œintè‚¯å®šæ˜¯è£…ä¸ä¸‹äº†ã€‚\nå¯ä»¥çœ‹åˆ°å®ƒä¸»è¦æ˜¯ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œæ—¶é—´+å·¥ä½œæœºå™¨ID+åºåˆ—å·ï¼Œæ—¶é—´ä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œ41ä¸ªbitä½èƒ½è¡¨ç¤ºçº¦70å¹´çš„æ—¶é—´ï¼Œæ—¶é—´çºªå…ƒä»2016å¹´11æœˆ1æ—¥é›¶ç‚¹å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨åˆ°2086å¹´ï¼Œå·¥ä½œæœºå™¨IDå…¶å®å°±æ˜¯èŠ‚ç‚¹IDï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„IDéƒ½ä¸ç›¸åŒï¼Œé‚£ä¹ˆå°±å¯ä»¥åŒºåˆ†å‡ºæ¥ï¼Œ10ä¸ªbitä½å¯ä»¥è¡¨ç¤ºæœ€å¤š1024ä¸ªèŠ‚ç‚¹ï¼Œæœ€å12ä½å°±æ˜¯æ¯ä¸ªèŠ‚ç‚¹ä¸‹çš„åºåˆ—å·ï¼Œå› æ­¤æ¯å°æœºå™¨æ¯æ¯«ç§’å°±å¯ä»¥æœ‰4096ä¸ªç³»åˆ—å·ã€‚\nè¿™æ ·ï¼Œå®ƒå°±å…¼å…·äº†ä¸Šé¢æ‰€è¯´çš„å”¯ä¸€æ€§å’Œæœ‰åºæ€§äº†ï¼Œä½†æ˜¯ä¾ç„¶æ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ—¶é—´é—®é¢˜ï¼Œå¦‚æœæœºå™¨æ—¶é—´å‡ºç°å€’é€€ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ç”Ÿæˆé‡å¤çš„IDï¼Œå¹¶ä¸”èŠ‚ç‚¹å®¹é‡åªæœ‰1024ä¸ªï¼Œå¦‚æœæ˜¯è¶…å¤§è§„æ¨¡é›†ç¾¤ï¼Œä¹Ÿæ˜¯å­˜åœ¨éšæ‚£çš„ã€‚\nShardingJDBCæ”¯æŒä»¥ä¸Šä¸¤ç§ç®—æ³•ä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”ŸæˆIDï¼Œæ–‡æ¡£ï¼šhttps://shardingsphere.apache.org/document/5.1.0/cn/user-manual/shardingsphere-jdbc/builtin-algorithm/keygen/\nè¿™é‡Œï¼Œæˆ‘ä»¬å°±æ˜¯è¦ShardingJDBCæ¥è®©æˆ‘ä»¬çš„ä¸»é”®IDä»¥é›ªèŠ±ç®—æ³•è¿›è¡Œç”Ÿæˆï¼Œé¦–å…ˆæ˜¯é…ç½®æ•°æ®åº“ï¼Œå› ä¸ºæˆ‘ä»¬é»˜è®¤çš„idæ˜¯intç±»å‹ï¼Œè£…ä¸ä¸‹64ä½çš„ï¼Œæ”¹ä¸€ä¸‹ï¼š\nALTER TABLE `yyds`.`test` MODIFY COLUMN `id` bigint NOT NULL FIRST; æ¥ç€æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹Mybatisçš„æ’å…¥è¯­å¥ï¼Œå› ä¸ºç°åœ¨idæ˜¯ç”±ShardingJDBCè‡ªåŠ¨ç”Ÿæˆï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦è‡ªå·±åŠ äº†ï¼š\n@Insert(\u0026#34;insert into test(name, passwd) values(#{name}, #{passwd})\u0026#34;) int addUser(User user); æ¥ç€æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­å°†æˆ‘ä»¬çš„ç®—æ³•å†™ä¸Šï¼š\nspring: shardingsphere: datasource: sharding: tables: test: actual-data-nodes: db0.test,db1.test #è¿™é‡Œè¿˜æ˜¯ä½¿ç”¨åˆ†åº“ç­–ç•¥ database-strategy: standard: sharding-column: id sharding-algorithm-name: my-alg #è¿™é‡Œä½¿ç”¨è‡ªå®šä¹‰çš„ä¸»é”®ç”Ÿæˆç­–ç•¥ key-generate-strategy: column: id key-generator-name: my-gen key-generators: #è¿™é‡Œå†™æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸»é”®ç”Ÿæˆç®—æ³• my-gen: #ä½¿ç”¨é›ªèŠ±ç®—æ³• type: SNOWFLAKE props: #å·¥ä½œæœºå™¨IDï¼Œä¿è¯å”¯ä¸€å°±è¡Œ worker-id: 666 sharding-algorithms: my-alg: type: MOD props: sharding-count: 2 æ¥ç€æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸‹æµ‹è¯•ç”¨ä¾‹ï¼š\n@SpringBootTest class ShardingJdbcTestApplicationTests { @Resource UserMapper mapper; @Test void contextLoads() { for (int i = 0; i \u0026lt; 20; i++) { mapper.addUser(new User(\u0026#34;aaa\u0026#34;, \u0026#34;bbb\u0026#34;)); } } } å¯ä»¥çœ‹åˆ°æ—¥å¿—ï¼š\nåœ¨æ’å…¥çš„æ—¶å€™ï¼Œå°†æˆ‘ä»¬çš„SQLè¯­å¥è‡ªè¡Œæ·»åŠ äº†ä¸€ä¸ªidå­—æ®µï¼Œå¹¶ä¸”ä½¿ç”¨çš„æ˜¯é›ªèŠ±ç®—æ³•ç”Ÿæˆçš„å€¼ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æ ¹æ®æˆ‘ä»¬çš„åˆ†åº“ç­–ç•¥åœ¨è¿›è¡Œæ’å…¥æ“ä½œã€‚\nè¯»å†™åˆ†ç¦» #\ræœ€åæˆ‘ä»¬æ¥çœ‹çœ‹è¯»å†™åˆ†ç¦»ï¼Œæˆ‘ä»¬ä¹‹å‰å®ç°äº†MySQLçš„ä¸»ä»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†ä¸»åº“ä½œä¸ºè¯»ï¼Œä»åº“ä½œä¸ºå†™ï¼š\nè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯å°†æ•°æ®åº“å˜å›ä¸»ä»çŠ¶æ€ï¼Œç›´æ¥åˆ é™¤å½“å‰çš„è¡¨ï¼Œæˆ‘ä»¬é‡æ–°æ¥è¿‡ï¼š\ndrop table test; æˆ‘ä»¬éœ€è¦å°†ä»åº“å¼€å¯åªè¯»æ¨¡å¼ï¼Œåœ¨MySQLé…ç½®ä¸­è¿›è¡Œä¿®æ”¹ï¼š\nread-only = 1 è¿™æ ·ä»åº“å°±åªèƒ½è¯»æ•°æ®äº†ï¼ˆä½†æ˜¯rootè´¦å·è¿˜æ˜¯å¯ä»¥å†™æ•°æ®ï¼‰ï¼Œæ¥ç€æˆ‘ä»¬é‡å¯æœåŠ¡å™¨ï¼š\nsudo systemctl restart mysql.service ç„¶åè¿›å…¥ä¸»åº“ï¼Œçœ‹çœ‹çŠ¶æ€ï¼š\nç°åœ¨æˆ‘ä»¬é…ç½®ä¸€ä¸‹ä»åº“ï¼š\nchange replication source to SOURCE_HOST=\u0026#39;192.168.0.13\u0026#39;,SOURCE_USER=\u0026#39;test\u0026#39;,SOURCE_PASSWORD=\u0026#39;123456\u0026#39;,SOURCE_LOG_FILE=\u0026#39;binlog.000007\u0026#39;,SOURCE_LOG_POS=19845; start replica; ç°åœ¨æˆ‘ä»¬åœ¨ä¸»åº“åˆ›å»ºè¡¨ï¼š\ncreate table test ( `id` bigint primary key, `name` varchar(255) NULL, `passwd` varchar(255) NULL ); ç„¶åæˆ‘ä»¬å°±å¯ä»¥é…ç½®ShardingJDBCäº†ï¼Œæ‰“å¼€é…ç½®æ–‡ä»¶ï¼š\nspring: shardingsphere: rules: #é…ç½®è¯»å†™åˆ†ç¦» readwrite-splitting: data-sources: #åç§°éšä¾¿å†™ user-db: #ä½¿ç”¨é™æ€ç±»å‹ï¼ŒåŠ¨æ€Dynamicç±»å‹å¯ä»¥è‡ªåŠ¨å‘ç°auto-aware-data-source-nameï¼Œè¿™é‡Œä¸æ¼”ç¤º type: Static props: #é…ç½®å†™åº“ï¼ˆåªèƒ½ä¸€ä¸ªï¼‰ write-data-source-name: db0 #é…ç½®ä»åº“ï¼ˆå¤šä¸ªï¼Œé€—å·éš”å¼€ï¼‰ read-data-source-names: db1 #è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯ä»¥è‡ªå®šä¹‰ load-balancer-name: my-load load-balancers: #è‡ªå®šä¹‰çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ my-load: type: ROUND_ROBIN æ³¨æ„æŠŠä¹‹å‰æ”¹çš„ç”¨æˆ·å®ä½“ç±»å’ŒMapperæ”¹å›å»ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸ç”¨è‡ªåŠ¨ç”ŸæˆIDçš„äº†ã€‚æ‰€æœ‰çš„è´Ÿè½½å‡è¡¡ç®—æ³•åœ°å€ï¼šhttps://shardingsphere.apache.org/document/5.1.0/cn/user-manual/shardingsphere-jdbc/builtin-algorithm/load-balance/\nç°åœ¨æˆ‘ä»¬å°±æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼š\n@SpringBootTest class ShardingJdbcTestApplicationTests { @Resource UserMapper mapper; @Test void contextLoads() { mapper.addUser(new User(10, \u0026#34;aaa\u0026#34;, \u0026#34;bbb\u0026#34;)); System.out.println(mapper.getUserById(10)); } } è¿è¡Œçœ‹çœ‹SQLæ—¥å¿—ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œä¼šç›´æ¥å‘db0è¿›è¡Œæ“ä½œï¼Œè€Œè¯»å–æ“ä½œæ˜¯ä¼šæ ¹æ®æˆ‘ä»¬çš„é…ç½®ï¼Œé€‰æ‹©db1è¿›è¡Œæ“ä½œã€‚\nè‡³æ­¤ï¼Œå¾®æœåŠ¡åº”ç”¨ç« èŠ‚åˆ°æ­¤ç»“æŸã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºæŸç çŸ¥è¯†åº“ç‰ˆæƒæ‰€æœ‰ï¼Œç¦æ­¢ä¸€åˆ‡æœªç»æˆæƒçš„è½¬è½½ã€å‘å¸ƒã€å‡ºå”®ç­‰è¡Œä¸ºï¼Œè¿è€…å°†è¢«è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://www.itbaima.cn/document/35v1hbsfcdgagdnw\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/cloud/%E4%BA%8C/","section":"Docs","summary":"å¾®æœåŠ¡åº”ç”¨ #\rå‰é¢æˆ‘ä»¬å·²ç»å®Œæˆäº†SpringCloudAlibabaçš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯¹ä¸€ä¸ªå¾®æœåŠ¡é¡¹ç›®çš„æ¶æ„ä½“ç³»å·²ç»æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œé‚£ä¹ˆæœ¬ç« æˆ‘ä»¬å°†åœ¨åº”ç”¨å±‚é¢ç»§ç»­æ¢è®¨å¾®æœåŠ¡ã€‚\nåˆ†å¸ƒå¼æƒé™æ ¡éªŒ #\rè™½ç„¶å®Œæˆå‰é¢çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥è‡ªå·±å»ç¼–å†™ä¸€ä¸ªæ¯”è¾ƒä¸­è§„ä¸­çŸ©çš„å¾®æœåŠ¡é¡¹ç›®äº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æˆ‘ä»¬æ²¡æœ‰è§£å†³ï¼Œç™»å½•é—®é¢˜ã€‚å‡å¦‚ç°åœ¨è¦æ±‚ç”¨æˆ·ç™»å½•ä¹‹åï¼Œæ‰èƒ½è¿›è¡Œå›¾ä¹¦çš„æŸ¥è¯¢ã€å€Ÿé˜…ç­‰æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆè¯¥å¦‚ä½•è®¾è®¡è¿™ä¸ªç³»ç»Ÿå‘¢ï¼Ÿ\nå›é¡¾æˆ‘ä»¬ä¹‹å‰è¿›è¡Œæƒé™æ ¡éªŒçš„åŸç†ï¼ŒæœåŠ¡å™¨æ˜¯å¦‚ä½•åˆ¤å®šä¸€ä¸ªè¯·æ±‚æ˜¯æ¥è‡ªå“ªä¸ªç”¨æˆ·çš„å‘¢ï¼Ÿ\né¦–å…ˆæµè§ˆå™¨ä¼šå‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œè®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ã€‚ æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œä¼šåˆ›å»ºä¸€ä¸ªSESSION IDï¼Œå¹¶æš‚æ—¶å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œç„¶åä¼šå‘é€ç»™æµè§ˆå™¨ä½œä¸ºCookieä¿å­˜ã€‚ ä¹‹åæµè§ˆå™¨ä¼šä¸€ç›´æºå¸¦æ­¤Cookieè®¿é—®æœåŠ¡å™¨ï¼Œè¿™æ ·åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œå°±èƒ½æ ¹æ®æºå¸¦çš„Cookieä¸­çš„SESSION IDåˆ¤æ–­æ˜¯å“ªä¸ªç”¨æˆ·äº†ã€‚ è¿™æ ·æœåŠ¡ç«¯å’Œæµè§ˆå™¨ä¹‹é—´å¯ä»¥è½»æ¾åœ°å»ºç«‹ä¼šè¯äº†ã€‚ ä½†æ˜¯æˆ‘ä»¬æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç°åœ¨é‡‡ç”¨çš„æ˜¯åˆ†å¸ƒå¼çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆåœ¨ç”¨æˆ·æœåŠ¡è¿›è¡Œç™»å½•ä¹‹åï¼Œå…¶ä»–æœåŠ¡æ¯”å¦‚å›¾ä¹¦æœåŠ¡å’Œå€Ÿé˜…æœåŠ¡ï¼Œå®ƒä»¬ä¼šçŸ¥é“ç”¨æˆ·ç™»å½•äº†å—ï¼Ÿ\nå®é™…ä¸Šæˆ‘ä»¬ç™»å½•åˆ°ç”¨æˆ·æœåŠ¡ä¹‹åï¼ŒSessionä¸­çš„ç”¨æˆ·æ•°æ®åªä¼šåœ¨ç”¨æˆ·æœåŠ¡çš„åº”ç”¨ä¸­ä¿å­˜ï¼Œè€Œåœ¨å…¶ä»–æœåŠ¡ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨å¸Œæœ›çš„æ˜¯ï¼Œæ‰€æœ‰çš„æœåŠ¡éƒ½èƒ½å¤ŸåŒæ­¥è¿™äº›Sessionä¿¡æ¯ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å®ç°åœ¨ç”¨æˆ·æœåŠ¡ç™»å½•ä¹‹åå…¶ä»–æœåŠ¡éƒ½èƒ½çŸ¥é“ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•å®ç°Sessionçš„åŒæ­¥å‘¢ï¼Ÿ\næˆ‘ä»¬å¯ä»¥åœ¨æ¯å°æœåŠ¡å™¨ä¸Šéƒ½å¤åˆ¶ä¸€ä»½Sessionï¼Œä½†æ˜¯è¿™æ ·æ˜¾ç„¶æ˜¯å¾ˆæµªè´¹æ—¶é—´çš„ï¼Œå¹¶ä¸”ç”¨æˆ·éªŒè¯æ•°æ®å ç”¨çš„å†…å­˜ä¼šæˆå€çš„å¢åŠ ã€‚ å°†Sessionç§»å‡ºæœåŠ¡å™¨ï¼Œç”¨ç»Ÿä¸€å­˜å‚¨æ¥å­˜æ”¾ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨Redisæˆ–æ˜¯MySQLä¸­å­˜æ”¾ç”¨æˆ·çš„Sessionä¿¡æ¯ï¼Œè¿™æ ·æ‰€æœ‰çš„æœåŠ¡å™¨åœ¨éœ€è¦è·å–Sessionä¿¡æ¯æ—¶ï¼Œç»Ÿä¸€è®¿é—®Redisæˆ–æ˜¯MySQLå³å¯ï¼Œè¿™æ ·å°±èƒ½ä¿è¯æ‰€æœ‰æœåŠ¡éƒ½å¯ä»¥åŒæ­¥Sessionäº†ï¼ˆæ˜¯ä¸æ˜¯è¶Šæ¥è¶Šæ„Ÿè§‰åªè¦æœ‰é—®é¢˜ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜¯åŠ ä¸€ä¸ªä¸­é—´ä»¶è§£å†³ä¸äº†çš„ï¼‰ é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ç€é‡æ¥ç ”ç©¶ä¸€ä¸‹ï¼Œç„¶åå®ç°2å·æ–¹æ¡ˆï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨Redisä½œä¸ºSessionç»Ÿä¸€å­˜å‚¨ï¼Œæˆ‘ä»¬æŠŠä¸€å¼€å§‹çš„å‹ç¼©åŒ…é‡æ–°è§£å‹ä¸€æ¬¡ï¼Œåˆæ¥ä»å¤´å¼€å§‹ç¼–å†™å§ã€‚\nè¿™é‡Œæˆ‘ä»¬å°±åªä½¿ç”¨Nacoså°±è¡Œäº†ï¼Œå’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬æŠŠNacosçš„åŒ…å¯¼å…¥ä¸€ä¸‹ï¼Œç„¶åè¿›è¡Œä¸€äº›é…ç½®ï¼š\nç°åœ¨æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªæœåŠ¡éƒ½æ·»åŠ éªŒè¯æœºåˆ¶ï¼Œé¦–å…ˆå¯¼å…¥ä¾èµ–ï¼š\n\u0026lt;!-- SpringSession Redisæ”¯æŒ --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.session\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-session-data-redis\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- æ·»åŠ Redisçš„Starter --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.","title":"SpringCloud 3","type":"doc"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/sql/","section":"Series","summary":"","title":"Sql","type":"series"},{"content":"æ³¨1ï¼šåŒä¸€æ–‡ç« å¯èƒ½åŒ…å«å¤šä¸ªåˆ†ç±»ï¼Œä¸‹åŒã€‚ æ³¨2ï¼šå±±è´¼ æ˜¯æˆ‘çš„ä¸€ä¸ªæœ‹å‹ã€‚\nç¤¾äº¤ #\r","date":"1 January 0001","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/stats/","section":"ç¬”è®°s","summary":"æ³¨1ï¼šåŒä¸€æ–‡ç« å¯èƒ½åŒ…å«å¤šä¸ªåˆ†ç±»ï¼Œä¸‹åŒã€‚ æ³¨2ï¼šå±±è´¼ æ˜¯æˆ‘çš„ä¸€ä¸ªæœ‹å‹ã€‚\nç¤¾äº¤ #\r","title":"åšå®¢ç»Ÿè®¡","type":"sample"},{"content":"\rè®¾è®¡æ¨¡å¼ï¼ˆåˆ›å»ºå‹ï¼‰ #\rè½¯ä»¶è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰ï¼Œåˆç§°è®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€ç¨‹åºçš„é‡ç”¨æ€§ã€‚\nè‚¯ç‰¹Â·è´å…‹å’Œ\ræ²ƒå¾·Â·åå®å®‰åœ¨1987å¹´åˆ©ç”¨å…‹é‡Œæ–¯æ‰˜ä½›Â·äºšå†å±±å¤§åœ¨å»ºç­‘è®¾è®¡é¢†åŸŸé‡Œçš„æ€æƒ³å¼€å‘äº†è®¾è®¡æ¨¡å¼å¹¶æŠŠæ­¤æ€æƒ³åº”ç”¨åœ¨Smalltalkä¸­çš„å›¾å½¢ç”¨æˆ·æ¥å£çš„ç”Ÿæˆä¸­ã€‚ä¸€å¹´åErich Gammaåœ¨ä»–çš„\rè‹é»ä¸–å¤§å­¦åšå£«æ¯•ä¸šè®ºæ–‡ä¸­å¼€å§‹å°è¯•æŠŠè¿™ç§æ€æƒ³æ”¹å†™ä¸ºé€‚ç”¨äºè½¯ä»¶å¼€å‘ã€‚ä¸æ­¤åŒæ—¶James Coplien åœ¨1989å¹´è‡³1991 å¹´ä¹Ÿåœ¨åˆ©ç”¨ç›¸åŒçš„æ€æƒ³è‡´åŠ›äºC++çš„å¼€å‘ï¼Œè€Œåäº1991å¹´å‘è¡¨äº†ä»–çš„è‘—ä½œAdvanced C++ Idiomsã€‚å°±åœ¨è¿™ä¸€å¹´Erich Gamma å¾—åˆ°äº†åšå£«å­¦ä½ï¼Œç„¶åå»äº†ç¾å›½ï¼Œåœ¨é‚£ä¸Richard Helm, Ralph Johnson ,John Vlissidesåˆä½œå‡ºç‰ˆäº†Design Patterns - Elements of Reusable Object-Oriented Software ä¸€ä¹¦ï¼Œåœ¨æ­¤ä¹¦ä¸­å…±æ”¶å½•äº†23ä¸ªè®¾è®¡æ¨¡å¼ã€‚è¿™å››ä½ä½œè€…åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸé‡Œä¹Ÿä»¥ä»–ä»¬çš„åŒ¿åè‘—ç§°Gang of Four(å››äººå¸®ï¼Œç®€ç§°GoF),å¹¶ä¸”æ˜¯ä»–ä»¬åœ¨æ­¤ä¹¦ä¸­çš„åä½œå¯¼è‡´äº†è½¯ä»¶è®¾è®¡æ¨¡å¼çš„çªç ´ã€‚\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æœ‰å…³å¯¹è±¡åˆ›å»ºçš„å‡ ç§è®¾è®¡æ¨¡å¼ã€‚\nå·¥å‚æ–¹æ³•æ¨¡å¼ #\ré¦–å½“å…¶å†²çš„æ˜¯æœ€ç®€å•çš„ä¸€ç§è®¾è®¡æ¨¡å¼â€”â€”å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœéœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ç›´æ¥newä¸€ä¸ªå³å¯ã€‚è€Œå·¥å‚æ–¹æ³•æ¨¡å¼ä»£æ›¿äº†ä¼ ç»Ÿçš„ç›´æ¥newçš„å½¢å¼ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¦æ›¿ä»£ä¼ ç»Ÿçš„newå½¢å¼å‘¢ï¼Ÿ\nå¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ‰€æœ‰çš„å¯¹è±¡æˆ‘ä»¬éƒ½é€šè¿‡newçš„æ–¹å¼å»åˆ›å»ºï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬çš„ç¨‹åºä¸­å¤§é‡ä½¿ç”¨æ­¤å¯¹è±¡æ—¶ï¼Œçªç„¶æœ‰ä¸€å¤©è¿™ä¸ªå¯¹è±¡çš„æ„é€ æ–¹æ³•æˆ–æ˜¯ç±»åå‘ç”Ÿäº†ä¿®æ”¹ï¼Œé‚£æˆ‘ä»¬å²‚ä¸æ˜¯å¾—æŒ¨ä¸ªå»è¿›è¡Œä¿®æ”¹ï¼Ÿæ ¹æ®è¿ªç±³ç‰¹æ³•åˆ™ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½åœ°å°‘ä¸å…¶ä»–ç±»è¿›è¡Œäº¤äº’ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†é‚£äº›éœ€è¦é¢‘ç¹å‡ºç°çš„å¯¹è±¡åˆ›å»ºï¼Œå°è£…åˆ°ä¸€ä¸ªå·¥å‚ç±»ä¸­ï¼Œå½“æˆ‘ä»¬éœ€è¦å¯¹è±¡æ—¶ï¼Œç›´æ¥è°ƒç”¨å·¥å‚ç±»ä¸­çš„å·¥å‚æ–¹æ³•æ¥ä¸ºæˆ‘ä»¬ç”Ÿæˆå¯¹è±¡ï¼Œè¿™æ ·ï¼Œå°±ç®—ç±»å‡ºç°äº†å˜åŠ¨ï¼Œæˆ‘ä»¬ä¹Ÿåªéœ€è¦ä¿®æ”¹å·¥å‚ä¸­çš„ä»£ç å³å¯ï¼Œè€Œä¸æ˜¯å¤§é¢ç§¯åœ°è¿›è¡Œä¿®æ”¹ã€‚\nåŒæ—¶ï¼Œå¯èƒ½æŸäº›å¯¹è±¡çš„åˆ›å»ºå¹¶ä¸åªæ˜¯ä¸€ä¸ªnewå°±å¯ä»¥æå®šï¼Œå¯èƒ½è¿˜éœ€è¦æ›´å¤šçš„æ­¥éª¤æ¥å‡†å¤‡æ„é€ æ–¹æ³•éœ€è¦çš„å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼æ¥åˆ›å»ºå¯¹è±¡ï¼Œæ—¢ç„¶æ˜¯å·¥å‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥åˆ›å»ºç‚¹å·¥å‚éœ€è¦ç”Ÿäº§çš„ä¸œè¥¿ï¼š\npublic abstract class Fruit { //æ°´æœæŠ½è±¡ç±» private final String name; public Fruit(String name){ this.name = name; } @Override public String toString() { return name+\u0026#34;@\u0026#34;+hashCode(); //æ‰“å°ä¸€ä¸‹å½“å‰æ°´æœåç§°ï¼Œè¿˜æœ‰å¯¹è±¡çš„hashCode } } public class Apple extends Fruit{ //è‹¹æœï¼Œç»§æ‰¿è‡ªæ°´æœ public Apple() { super(\u0026#34;è‹¹æœ\u0026#34;); } } public class Orange extends Fruit{ //æ©˜å­ï¼Œä¹Ÿæ˜¯ç»§æ‰¿è‡ªæ°´æœ public Orange() { super(\u0026#34;æ©˜å­\u0026#34;); } } æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥newå°±å¯ä»¥å¾—åˆ°å¯¹è±¡äº†ï¼š\npublic class Main { public static void main(String[] args) { Apple apple = new Apple(); System.out.println(apple); } } ç°åœ¨æˆ‘ä»¬å°†å¯¹è±¡çš„åˆ›å»ºå°è£…åˆ°å·¥å‚ä¸­ï¼š\npublic class FruitFactory { /** * è¿™é‡Œå°±ç›´æ¥æ¥ä¸€ä¸ªé™æ€æ–¹æ³•æ ¹æ®æŒ‡å®šç±»å‹è¿›è¡Œåˆ›å»º * @param type æ°´æœç±»å‹ * @return å¯¹åº”çš„æ°´æœå¯¹è±¡ */ public static Fruit getFruit(String type) { switch (type) { case \u0026#34;è‹¹æœ\u0026#34;: return new Apple(); case \u0026#34;æ©˜å­\u0026#34;: return new Orange(); default: return null; } } } ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ­¤å·¥å‚æ¥åˆ›å»ºå¯¹è±¡äº†ï¼š\npublic class Main { public static void main(String[] args) { Fruit fruit = FruitFactory.getFruit(\u0026#34;æ©˜å­\u0026#34;); //ç›´æ¥é—®å·¥å‚è¦ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è‡ªå·±å»åˆ›å»º System.out.println(fruit); } } ä¸è¿‡è¿™æ ·è¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬å‰é¢æåˆ°äº†å¼€é—­åŸåˆ™ï¼Œä¸€ä¸ªè½¯ä»¶å®ä½“ï¼Œæ¯”å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ç°åœ¨éœ€è¦æ–°å¢ä¸€ç§æ°´æœï¼Œæ¯”å¦‚æ¡ƒå­ï¼Œé‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬å°±å¾—å»ä¿®æ”¹å·¥å‚æä¾›çš„å·¥å‚æ–¹æ³•äº†ï¼Œä½†æ˜¯è¿™æ ·æ˜¯ä¸å¤ªç¬¦åˆå¼€é—­åŸåˆ™çš„ï¼Œå› ä¸ºå·¥å‚å®é™…ä¸Šæ˜¯é’ˆå¯¹äºè°ƒç”¨æ–¹æä¾›çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å¯¹ä¿®æ”¹å…³é—­ã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­çš„æ€§è´¨ï¼Œå°†ç®€å•å·¥å‚æ¨¡å¼æ”¹è¿›ä¸ºå·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œé‚£ç°åœ¨æ—¢ç„¶ä¸è®©æ”¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çœ‹çœ‹å¦‚ä½•å»ä½¿ç”¨æ‰©å±•çš„å½¢å¼ï¼š\npublic abstract class FruitFactory\u0026lt;T extends Fruit\u0026gt; { //å°†æ°´æœå·¥å‚æŠ½è±¡ä¸ºæŠ½è±¡ç±»ï¼Œæ·»åŠ æ³›å‹Tç”±å­ç±»æŒ‡å®šæ°´æœç±»å‹ public abstract T getFruit(); //ä¸åŒçš„æ°´æœå·¥å‚ï¼Œé€šè¿‡æ­¤æ–¹æ³•ç”Ÿäº§ä¸åŒçš„æ°´æœ } public class AppleFactory extends FruitFactory\u0026lt;Apple\u0026gt; { //è‹¹æœå·¥å‚ï¼Œç›´æ¥è¿”å›Appleï¼Œä¸€æ­¥åˆ°ä½ @Override public Apple getFruit() { return new Apple(); } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸åŒç±»å‹çš„å·¥å‚æ¥ç”Ÿäº§ä¸åŒç±»å‹çš„æ°´æœäº†ï¼Œå¹¶ä¸”å¦‚æœæ–°å¢äº†æ°´æœç±»å‹ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥å‚ç±»å°±è¡Œï¼Œä¸éœ€è¦ä¿®æ”¹ä¹‹å‰å·²ç»ç¼–å†™å¥½çš„å†…å®¹ã€‚\npublic class Main { public static void main(String[] args) { test(new AppleFactory()::getFruit); //æ¯”å¦‚æˆ‘ä»¬ç°åœ¨è¦åƒä¸€ä¸ªè‹¹æœï¼Œé‚£ä¹ˆå°±ç›´æ¥é€šè¿‡è‹¹æœå·¥å‚æ¥è·å–è‹¹æœ } //æ­¤æ–¹æ³•æ¨¡æ‹Ÿåƒæ‰ä¸€ä¸ªæ°´æœ private static void test(Supplier\u0026lt;Fruit\u0026gt; supplier){ System.out.println(supplier.get()+\u0026#34; è¢«åƒæ‰äº†ï¼ŒçœŸå¥½åƒã€‚\u0026#34;); } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±ç®€å•å®ç°äº†å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œé€šè¿‡å·¥å‚æ¥å±è”½å¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ï¼Œä½¿ç”¨è€…åªéœ€è¦å…³å¿ƒå¦‚ä½•å»ä½¿ç”¨å¯¹è±¡å³å¯ã€‚\næŠ½è±¡å·¥å‚æ¨¡å¼ #\rå‰é¢æˆ‘ä»¬ä»‹ç»äº†å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œé€šè¿‡å®šä¹‰é¡¶å±‚æŠ½è±¡å·¥å‚ç±»ï¼Œé€šè¿‡ç»§æ‰¿çš„æ–¹å¼ï¼Œé’ˆå¯¹äºæ¯ä¸€ä¸ªäº§å“éƒ½æä¾›ä¸€ä¸ªå·¥å‚ç±»ç”¨äºåˆ›å»ºã€‚\nä¸è¿‡è¿™ç§æ¨¡å¼åªé€‚ç”¨äºç®€å•å¯¹è±¡ï¼Œå½“æˆ‘ä»¬éœ€è¦ç”Ÿäº§è®¸å¤šä¸ªäº§å“æ—çš„æ—¶å€™ï¼Œè¿™ç§æ¨¡å¼å°±æœ‰ç‚¹ä¹åŠ›äº†ï¼Œæ¯”å¦‚ï¼š\nå®é™…ä¸Šè¿™äº›äº§å“éƒ½æ˜¯æˆæ—å‡ºç°çš„ï¼Œæ¯”å¦‚å°ç±³çš„äº§å“çº¿ä¸Šæœ‰å°ç±³12ï¼Œå°ç±³å¹³æ¿ç­‰ï¼Œåä¸ºçš„äº§å“çº¿ä¸Šä¹Ÿæœ‰åä¸ºæ‰‹æœºã€åä¸ºå¹³æ¿ï¼Œä½†æ˜¯å¦‚æœæŒ‰ç…§æˆ‘ä»¬ä¹‹å‰å·¥å‚æ–¹æ³•æ¨¡å¼æ¥è¿›è¡Œè®¾è®¡ï¼Œé‚£å°±éœ€è¦å•ç‹¬è®¾è®¡9ä¸ªå·¥å‚æ¥ç”Ÿäº§ä¸Šé¢è¿™äº›äº§å“ï¼Œæ˜¾ç„¶è¿™æ ·å°±æ¯”è¾ƒæµªè´¹æ—¶é—´çš„ã€‚\nä½†æ˜¯ç°åœ¨æœ‰ä»€ä¹ˆæ–¹æ³•èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†è¿™ç§æƒ…å†µå‘¢ï¼Ÿæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤šä¸ªäº§å“ï¼Œéƒ½æ”¾åœ¨ä¸€ä¸ªå·¥å‚ä¸­è¿›è¡Œç”Ÿæˆï¼ŒæŒ‰ä¸åŒçš„äº§å“æ—è¿›è¡Œåˆ’åˆ†ï¼Œæ¯”å¦‚å°ç±³ï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥å®‰æ’ä¸€ä¸ªå°ç±³å·¥å‚ï¼Œè€Œè¿™ä¸ªå·¥å‚é‡Œé¢å°±å¯ä»¥ç”Ÿäº§æ•´æ¡äº§å“çº¿ä¸Šçš„å†…å®¹ï¼ŒåŒ…æ‹¬å°ç±³æ‰‹æœºã€å°ç±³å¹³æ¿ã€å°ç±³è·¯ç”±ç­‰ã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦å»ºç«‹ä¸€ä¸ªæŠ½è±¡å·¥å‚å³å¯ï¼š\npublic class Router { } public class Table { } public class Phone { } public abstract class AbstractFactory { public abstract Phone getPhone(); public abstract Table getTable(); public abstract Router getRouter(); } ä¸€ä¸ªå·¥å‚å¯ä»¥ç”Ÿäº§åŒä¸€ä¸ªäº§å“æ—çš„æ‰€æœ‰äº§å“ï¼Œè¿™æ ·æŒ‰æ—è¿›è¡Œåˆ†ç±»ï¼Œæ˜¾ç„¶æ¯”ä¹‹å‰çš„å·¥å‚æ–¹æ³•æ¨¡å¼æ›´å¥½ã€‚\nä¸è¿‡ï¼Œç¼ºç‚¹è¿˜æ˜¯æœ‰çš„ï¼Œå¦‚æœäº§å“æ—æ–°å¢äº†äº§å“ï¼Œé‚£ä¹ˆæˆ‘å°±ä¸å¾—ä¸å»ä¸ºæ¯ä¸€ä¸ªäº§å“æ—çš„å·¥å‚éƒ½å»æ·»åŠ æ–°äº§å“çš„ç”Ÿäº§æ–¹æ³•ï¼Œè¿èƒŒäº†å¼€é—­åŸåˆ™ã€‚\nå»ºé€ è€…æ¨¡å¼ #\rå»ºé€ è€…æ¨¡å¼ä¹Ÿæ˜¯éå¸¸å¸¸è§çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°æœ‰å¾ˆå¤šçš„æ¡†æ¶éƒ½ä¸ºæˆ‘ä»¬æä¾›äº†å½¢å¦‚XXXBuilderçš„ç±»å‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¹Ÿæ˜¯ä½¿ç”¨è¿™äº›ç±»æ¥åˆ›å»ºæˆ‘ä»¬éœ€è¦çš„å¯¹è±¡ã€‚\næ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨JavaSEä¸­å°±å­¦ä¹ è¿‡çš„StringBuilerç±»ï¼š\npublic static void main(String[] args) { StringBuilder builder = new StringBuilder(); //åˆ›å»ºä¸€ä¸ªStringBuilderæ¥é€æ­¥æ„å»ºä¸€ä¸ªå­—ç¬¦ä¸² builder.append(666); //æ‹¼æ¥ä¸€ä¸ªæ•°å­— builder.append(\u0026#34;è€é“\u0026#34;); //æ‹¼æ¥ä¸€ä¸ªå­—ç¬¦ä¸² builder.insert(2, \u0026#39;?\u0026#39;); //åœ¨ç¬¬ä¸‰ä¸ªä½ç½®æ’å…¥ä¸€ä¸ªå­—ç¬¦ System.out.println(builder.toString()); //å·®ä¸å¤šæˆå½¢äº†ï¼Œæœ€åè½¬æ¢ä¸ºå­—ç¬¦ä¸² } å®é™…ä¸Šæˆ‘ä»¬æ˜¯é€šè¿‡å»ºé€ è€…æ¥ä¸æ–­é…ç½®å‚æ•°æˆ–æ˜¯å†…å®¹ï¼Œå½“æˆ‘ä»¬é…ç½®å®Œæ‰€æœ‰å†…å®¹åï¼Œæœ€åå†è¿›è¡Œå¯¹è±¡çš„æ„å»ºã€‚\nç›¸æ¯”ç›´æ¥å»newä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå»ºé€ è€…æ¨¡å¼çš„é‡å¿ƒæ›´åŠ å…³æ³¨åœ¨å¦‚ä½•å®Œæˆæ¯ä¸€æ­¥çš„é…ç½®ï¼ŒåŒæ—¶å¦‚æœä¸€ä¸ªç±»çš„æ„é€ æ–¹æ³•å‚æ•°è¿‡å¤šï¼Œæˆ‘ä»¬é€šè¿‡å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºè¿™ä¸ªå¯¹è±¡ï¼Œä¼šæ›´åŠ ä¼˜é›…ã€‚\næ¯”å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå­¦ç”Ÿç±»ï¼š\npublic class Student { int id; int age; int grade; String name; String college; String profession; List\u0026lt;String\u0026gt; awards; public Student(int id, int age, int grade, String name, String college, String profession, List\u0026lt;String\u0026gt; awards) { this.id = id; this.age = age; this.grade = grade; this.name = name; this.college = college; this.profession = profession; this.awards = awards; } } å¯ä»¥çœ‹åˆ°è¿™ä¸ªå­¦ç”Ÿç±»çš„å±æ€§æ˜¯éå¸¸å¤šçš„ï¼Œæ‰€ä»¥æ„é€ æ–¹æ³•ä¸æ˜¯ä¸€èˆ¬çš„é•¿ï¼Œå¦‚æœæˆ‘ä»¬ç°åœ¨ç›´æ¥é€šè¿‡newçš„æ–¹å¼å»åˆ›å»ºï¼š\npublic static void main(String[] args) { Student student = new Student(1, 18, 3, \u0026#34;å°æ˜\u0026#34;, \u0026#34;è®¡ç®—æœºå­¦é™¢\u0026#34;, \u0026#34;è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯\u0026#34;, Arrays.asList(\u0026#34;ICPC-ACM åŒºåŸŸèµ› é‡‘ç‰Œ\u0026#34;, \u0026#34;LPL 2022æ˜¥å­£èµ› å† å†›\u0026#34;)); } å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å…‰æ˜¯å¡«å‚æ•°å°±éº»çƒ¦ï¼Œæˆ‘ä»¬è¿˜å¾—ä¸€ä¸ªä¸€ä¸ªå¯¹åº”ç€å»å¡«ï¼Œä¸€ä¸å°å¿ƒå¯èƒ½å°±æŠŠå‚æ•°å¡«åˆ°é”™è¯¯çš„ä½ç½®äº†ã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ¥è¿›è¡Œå¯¹è±¡çš„åˆ›å»ºï¼š\npublic class Student { ... //ä¸€å¾‹ä½¿ç”¨å»ºé€ è€…æ¥åˆ›å»ºï¼Œä¸å¯¹å¤–ç›´æ¥å¼€æ”¾ private Student(int id, int age, int grade, String name, String college, String profession, List\u0026lt;String\u0026gt; awards) { ... } public static StudentBuilder builder(){ //é€šè¿‡builderæ–¹æ³•ç›´æ¥è·å–å»ºé€ è€… return new StudentBuilder(); } public static class StudentBuilder{ //è¿™é‡Œå°±ç›´æ¥åˆ›å»ºä¸€ä¸ªå†…éƒ¨ç±» //Builderä¹Ÿéœ€è¦å°†æ‰€æœ‰çš„å‚æ•°éƒ½è¿›è¡Œæš‚æ—¶ä¿å­˜ï¼Œæ‰€ä»¥Studentæ€ä¹ˆå®šä¹‰çš„è¿™é‡Œå°±æ€ä¹ˆå®šä¹‰ int id; int age; int grade; String name; String college; String profession; List\u0026lt;String\u0026gt; awards; public StudentBuilder id(int id){ //ç›´æ¥è°ƒç”¨å»ºé€ è€…å¯¹åº”çš„æ–¹æ³•ï¼Œä¸ºå¯¹åº”çš„å±æ€§èµ‹å€¼ this.id = id; return this; //ä¸ºäº†æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œè¿™é‡Œç›´æ¥è¿”å›å»ºé€ è€…æœ¬èº«ï¼Œä¸‹åŒ } public StudentBuilder age(int age){ this.age = age; return this; } ... public StudentBuilder awards(String... awards){ this.awards = Arrays.asList(awards); return this; } public Student build(){ //æœ€åæˆ‘ä»¬åªéœ€è¦è°ƒç”¨å»ºé€ è€…æä¾›çš„buildæ–¹æ³•å³å¯æ ¹æ®æˆ‘ä»¬çš„é…ç½®è¿”å›ä¸€ä¸ªå¯¹è±¡ return new Student(id, age, grade, name, college, profession, awards); } } } ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¥ä¸ºæˆ‘ä»¬ç”Ÿæˆå¯¹è±¡äº†ï¼š\npublic static void main(String[] args) { Student student = Student.builder() //è·å–å»ºé€ è€… .id(1) //é€æ­¥é…ç½®å„ä¸ªå‚æ•° .age(18) .grade(3) .name(\u0026#34;å°æ˜\u0026#34;) .awards(\u0026#34;ICPC-ACM åŒºåŸŸèµ› é‡‘ç‰Œ\u0026#34;, \u0026#34;LPL 2022æ˜¥å­£èµ› å† å†›\u0026#34;) .build(); //æœ€åç›´æ¥å»ºé€ æˆ‘ä»¬æƒ³è¦çš„å¯¹è±¡ } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®©è¿™äº›å‚æ•°å¯¹å·å…¥åº§äº†ï¼Œå¹¶ä¸”ä¹Ÿæ¯”ä¹‹å‰çš„æ–¹å¼ä¼˜é›…è®¸å¤šã€‚\nå•ä¾‹æ¨¡å¼ #\rå•ä¾‹æ¨¡å¼å…¶å®åœ¨ä¹‹å‰çš„è¯¾ç¨‹ä¸­å·²ç»æ¼”ç¤ºè¿‡å¾ˆå¤šæ¬¡äº†ï¼Œè¿™ä¹Ÿæ˜¯ä½¿ç”¨é¢‘ç‡éå¸¸é«˜çš„ä¸€ç§æ¨¡å¼ã€‚\né‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼å‘¢ï¼Ÿé¡¾åæ€ä¹‰ï¼Œå•ä¾‹é‚£ä¹ˆè‚¯å®šå°±æ˜¯åªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œåœ¨æˆ‘ä»¬çš„æ•´ä¸ªç¨‹åºä¸­ï¼ŒåŒä¸€ä¸ªç±»å§‹ç»ˆåªä¼šæœ‰ä¸€ä¸ªå¯¹è±¡æ¥è¿›è¡Œæ“ä½œã€‚æ¯”å¦‚æ•°æ®åº“è¿æ¥ç±»ï¼Œå®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡æˆ–æ˜¯ç›´æ¥ä½¿ç”¨é™æ€æ–¹æ³•å°±å¯ä»¥äº†ï¼Œæ²¡å¿…è¦å»åˆ›å»ºå¤šä¸ªå¯¹è±¡ã€‚\nè¿™é‡Œè¿˜æ˜¯è¿˜åŸä¸€ä¸‹æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„ç®€å•å•ä¾‹æ¨¡å¼ï¼š\npublic class Singleton { private final static Singleton INSTANCE = new Singleton(); //ç”¨äºå¼•ç”¨å…¨å±€å”¯ä¸€çš„å•ä¾‹å¯¹è±¡ï¼Œåœ¨ä¸€å¼€å§‹å°±åˆ›å»ºå¥½ private Singleton() {} //ä¸å…è®¸éšä¾¿newï¼Œéœ€è¦å¯¹è±¡ç›´æ¥æ‰¾getInstance public static Singleton getInstance(){ //è·å–å…¨å±€å”¯ä¸€çš„å•ä¾‹å¯¹è±¡ return INSTANCE; } } è¿™æ ·ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–æ­¤å¯¹è±¡æ—¶ï¼Œåªèƒ½é€šè¿‡getInstance()æ¥è·å–å”¯ä¸€çš„å¯¹è±¡ï¼š\npublic static void main(String[] args) { Singleton singleton = Singleton.getInstance(); } å½“ç„¶ï¼Œå•ä¾‹æ¨¡å¼é™¤äº†è¿™ç§å†™æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–å†™æ³•ï¼Œè¿™ç§å†™æ³•è¢«ç§°ä¸ºé¥¿æ±‰å¼å•ä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€å¼€å§‹ç±»åŠ è½½æ—¶å°±åˆ›å»ºå¥½äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦ä¸€ç§å†™æ³•â€”â€”æ‡’æ±‰å¼ï¼š\npublic class Singleton { private static Singleton INSTANCE; //åœ¨ä¸€å¼€å§‹å…ˆä¸è¿›è¡Œå¯¹è±¡åˆ›å»º private Singleton() {} //ä¸ç”¨å¤šè¯´äº†å§ public static Singleton getInstance(){ //å°†å¯¹è±¡çš„åˆ›å»ºå»¶ååˆ°éœ€è¦æ—¶å†è¿›è¡Œ if(INSTANCE == null) { //å¦‚æœå®ä¾‹ä¸ºç©ºï¼Œé‚£ä¹ˆå°±è¿›è¡Œåˆ›å»ºï¼Œä¸ä¸ºç©ºè¯´æ˜å·²ç»åˆ›å»ºè¿‡äº†ï¼Œé‚£ä¹ˆå°±ç›´æ¥è¿”å› INSTANCE = new Singleton(); } return INSTANCE; } } å¯ä»¥çœ‹åˆ°ï¼Œæ‡’æ±‰å¼å°±çœŸçš„æ˜¯æ¡æ‡’ç‹—ï¼Œä½ ä¸å»ç”¨å®ƒï¼Œå®ƒæ˜¯ä¸ä¼šç»™ä½ æå‰å‡†å¤‡å•ä¾‹å¯¹è±¡çš„ï¼ˆå»¶è¿ŸåŠ è½½ï¼Œæ‡’åŠ è½½ï¼‰ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–å¯¹è±¡æ—¶ï¼Œæ‰ä¼šè¿›è¡Œæ£€æŸ¥å¹¶åˆ›å»ºã€‚è™½ç„¶é¥¿æ±‰å¼å’Œæ‡’æ±‰å¼å†™æ³•ä¸åŒï¼Œä½†æ˜¯æœ€åéƒ½æ˜¯æˆåŠŸå®ç°äº†å•ä¾‹æ¨¡å¼ã€‚\nä¸è¿‡ï¼Œè¿™é‡Œéœ€è¦ç‰¹åˆ«æé†’ä¸€ä¸‹ï¼Œç”±äºæ‡’æ±‰å¼æ˜¯åœ¨æ–¹æ³•ä¸­è¿›è¡Œçš„åˆå§‹åŒ–ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼ˆå»ºè®®å­¦å®ŒJUCç¯‡è§†é¢‘æ•™ç¨‹å†æ¥è§‚çœ‹ï¼‰å¤§å®¶å¯ä»¥è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨äº†getInstance()æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸‰æ¡çº¿ç¨‹åŒæ—¶è°ƒç”¨getInstance()æ–¹æ³•ï¼Œä¼šåŒæ—¶è¿›è¡ŒINSTANCE == nullçš„åˆ¤æ–­ï¼Œé‚£ä¹ˆæ­¤æ—¶ç”±äºç¡®å®è¿˜æ²¡æœ‰è¿›è¡Œä»»ä½•å®ä¾‹åŒ–ï¼Œæ‰€ä»¥å¯¼è‡´ä¸‰æ¡çº¿ç¨‹å…¨éƒ¨åˆ¤æ–­ä¸ºtrueï¼ˆè€Œé¥¿æ±‰å¼ç”±äºåœ¨ç±»åŠ è½½æ—¶å°±åˆ›å»ºå®Œæˆï¼Œä¸ä¼šå­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼‰æ­¤æ—¶é—®é¢˜å°±æ¥äº†ï¼Œæˆ‘ä»¬æ—¢ç„¶è¦ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯åªå¸Œæœ›å¯¹è±¡åªè¢«åˆå§‹åŒ–ä¸€æ¬¡çš„ï¼Œä½†æ˜¯ç°åœ¨ç”±äºå¤šçº¿ç¨‹çš„æœºåˆ¶ï¼Œå¯¼è‡´å¯¹è±¡è¢«å¤šæ¬¡åˆ›å»ºã€‚\næ‰€ä»¥ï¼Œä¸ºäº†é¿å…çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œé’ˆå¯¹äºæ‡’æ±‰å¼å•ä¾‹ï¼Œæˆ‘ä»¬è¿˜å¾—è¿›è¡Œä¸€äº›æ”¹è¿›ï¼š\npublic static synchronized Singleton getInstance(){ //æ–¹æ³•å¿…é¡»æ·»åŠ synchronizedå…³é”®å­—åŠ é” if(INSTANCE == null) { INSTANCE = new Singleton(); } return INSTANCE; } æ—¢ç„¶å¤šä¸ªçº¿ç¨‹è¦è°ƒç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç›´æ¥åŠ ä¸€æŠŠé”ï¼Œåœ¨æ–¹æ³•ä¸Šæ·»åŠ synchronizedå…³é”®å­—å³å¯ï¼Œè¿™æ ·åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†ã€‚è™½ç„¶è¿™æ ·ç®€å•ç²—æš´ï¼Œä½†æ˜¯åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæ•ˆç‡è‚¯å®šæ˜¯æ¯”è¾ƒä½çš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è¿›è¡Œä¼˜åŒ–ï¼š\npublic static Singleton getInstance(){ if(INSTANCE == null) { synchronized (Singleton.class) { //å®é™…ä¸Šåªéœ€è¦å¯¹èµ‹å€¼è¿™ä¸€æ­¥è¿›è¡ŒåŠ é”å³å¯ INSTANCE = new Singleton(); } } return INSTANCE; } ä¸è¿‡è¿™æ ·è¿˜ä¸å®Œç¾ï¼Œå› ä¸ºè¿™æ ·è¿˜æ˜¯æœ‰å¯èƒ½å¤šä¸ªçº¿ç¨‹åŒæ—¶åˆ¤æ–­ä¸ºnullè€Œè¿›å…¥ç­‰é”çš„çŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜å¾—åŠ ä¸€å±‚å†…å±‚åˆ¤æ–­ï¼š\npublic static Singleton getInstance(){ if(INSTANCE == null) { synchronized (Singleton.class) { if(INSTANCE == null) INSTANCE = new Singleton(); //å†…å±‚è¿˜è¦è¿›è¡Œä¸€æ¬¡æ£€æŸ¥ï¼ŒåŒé‡æ£€æŸ¥é”å®š } } return INSTANCE; } ä¸è¿‡æˆ‘ä»¬è¿˜å°‘è€ƒè™‘äº†ä¸€æ ·å†…å®¹ï¼Œå…¶å®IDEAæ­¤æ—¶åº”è¯¥æ˜¯ç»™äº†é»„æ ‡äº†ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒIDEAä¼šè¦æ±‚æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªvolatileç»™INSTANCEï¼Œå„ä½è¿˜è®°å¾—è¿™ä¸ªå…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨å—ï¼Ÿæ²¡é”™ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¿è¯INSTANCEåœ¨çº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ï¼Œè¿™æ ·å½“å…¶ä»–çº¿ç¨‹è¿›å…¥ä¹‹åæ‰ä¼šæ‹¿INSTANCEç”±å…¶ä»–çº¿ç¨‹æ›´æ–°çš„æœ€æ–°å€¼å»åˆ¤æ–­ï¼Œè¿™æ ·ï¼Œå°±å·®ä¸å¤šå®Œç¾äº†ã€‚\né‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ›´å¥½çš„ï¼Œä¸ç”¨åŠ é”çš„æ–¹å¼ä¹Ÿèƒ½å®ç°å»¶è¿ŸåŠ è½½çš„å†™æ³•å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼š\npublic class Singleton { private Singleton() {} private static class Holder { //ç”±é™æ€å†…éƒ¨ç±»æŒæœ‰å•ä¾‹å¯¹è±¡ï¼Œä½†æ˜¯æ ¹æ®ç±»åŠ è½½ç‰¹æ€§ï¼Œæˆ‘ä»¬ä»…ä½¿ç”¨Singletonç±»æ—¶ï¼Œä¸ä¼šå¯¹é™æ€å†…éƒ¨ç±»è¿›è¡Œåˆå§‹åŒ– private final static Singleton INSTANCE = new Singleton(); } public static Singleton getInstance(){ //åªæœ‰çœŸæ­£ä½¿ç”¨å†…éƒ¨ç±»æ—¶ï¼Œæ‰ä¼šè¿›è¡Œç±»åˆå§‹åŒ– return Holder.INSTANCE; //ç›´æ¥è·å–å†…éƒ¨ç±»ä¸­çš„ } } è¿™ç§æ–¹å¼æ˜¾ç„¶æ˜¯æœ€å®Œç¾çš„æ‡’æ±‰å¼è§£å†³æ–¹æ¡ˆï¼Œæ²¡æœ‰è¿›è¡Œä»»ä½•çš„åŠ é”æ“ä½œï¼Œä¹Ÿèƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä¸è¿‡è¦å®ç°è¿™ç§å†™æ³•ï¼Œè·Ÿè¯­è¨€æœ¬èº«ä¹Ÿæœ‰ä¸€å®šçš„å…³è”ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„è¯­è¨€éƒ½æ”¯æŒè¿™ç§å†™æ³•ã€‚\nåŸå‹æ¨¡å¼ #\råŸå‹æ¨¡å¼å®é™…ä¸Šä¸å¯¹è±¡çš„æ‹·è´æ¯æ¯ç›¸å…³ï¼ŒåŸå‹æ¨¡å¼ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šå¾…åˆ›å»ºå¯¹è±¡çš„ç±»å‹ï¼Œå¹¶ä¸”é€šè¿‡å¤åˆ¶è¿™ä¸ªåŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸå‹å¯¹è±¡ä½œä¸ºæ¨¡æ¿ï¼Œé€šè¿‡å…‹éš†æ“ä½œï¼Œæ¥äº§ç”Ÿæ›´å¤šçš„å¯¹è±¡ï¼Œå°±åƒç»†èƒçš„å¤åˆ¶ä¸€æ ·ã€‚\nå¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹å¯¹è±¡çš„æ·±æ‹·è´å’Œæµ…æ‹·è´ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹æµ…æ‹·è´ï¼š\n**æµ…æ‹·è´ï¼š**å¯¹äºç±»ä¸­åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¼šç›´æ¥å¤åˆ¶å€¼ç»™æ‹·è´å¯¹è±¡ï¼›å¯¹äºå¼•ç”¨ç±»å‹ï¼Œåªä¼šå¤åˆ¶å¯¹è±¡çš„åœ°å€ï¼Œè€Œå®é™…ä¸ŠæŒ‡å‘çš„è¿˜æ˜¯åŸæ¥çš„é‚£ä¸ªå¯¹è±¡ï¼Œæ‹·è´ä¸ªåŸºè«ã€‚\npublic static void main(String[] args) { int a = 10; int b = a; //åŸºæœ¬ç±»å‹æµ…æ‹·è´ System.out.println(a == b); Object o = new Object(); Object k = o; //å¼•ç”¨ç±»å‹æµ…æ‹·è´ï¼Œæ‹·è´çš„ä»…ä»…æ˜¯å¯¹ä¸Šé¢å¯¹è±¡çš„å¼•ç”¨ System.out.println(o == k); } **æ·±æ‹·è´ï¼š**æ— è®ºæ˜¯åŸºæœ¬ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ·±æ‹·è´ä¼šå°†å¼•ç”¨ç±»å‹çš„æ‰€æœ‰å†…å®¹ï¼Œå…¨éƒ¨æ‹·è´ä¸ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬å¯¹è±¡å†…éƒ¨çš„æ‰€æœ‰æˆå‘˜å˜é‡ï¼Œä¹Ÿä¼šè¿›è¡Œæ‹·è´ã€‚\nåœ¨Javaä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Cloneableæ¥å£æä¾›çš„æ‹·è´æœºåˆ¶ï¼Œæ¥å®ç°åŸå‹æ¨¡å¼ï¼š\npublic class Student implements Cloneable{ //æ³¨æ„éœ€è¦å®ç°Cloneableæ¥å£ @Override public Object clone() throws CloneNotSupportedException { //æå‡cloneæ–¹æ³•çš„è®¿é—®æƒé™ return super.clone(); } } æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹å…‹éš†çš„å¯¹è±¡æ˜¯ä¸æ˜¯åŸæ¥çš„å¯¹è±¡ï¼š\npublic static void main(String[] args) throws CloneNotSupportedException { Student student0 = new Student(); Student student1 = (Student) student0.clone(); System.out.println(student0); System.out.println(student1); } å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡clone()æ–¹æ³•å…‹éš†çš„å¯¹è±¡å¹¶ä¸æ˜¯åŸæ¥çš„å¯¹è±¡ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰å±æ€§ä¼šä¸ä¼šä¸€èµ·è¿›è¡Œå…‹éš†ï¼š\npublic class Student implements Cloneable{ String name; public Student(String name){ this.name = name; } public String getName() { return name; } @Override public Object clone() throws CloneNotSupportedException { return super.clone(); } } public static void main(String[] args) throws CloneNotSupportedException { Student student0 = new Student(\u0026#34;å°æ˜\u0026#34;); Student student1 = (Student) student0.clone(); System.out.println(student0.getName() == student1.getName()); } å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶Studentå¯¹è±¡æˆåŠŸæ‹·è´ï¼Œä½†æ˜¯å…¶å†…å±‚å¯¹è±¡å¹¶æ²¡æœ‰è¿›è¡Œæ‹·è´ï¼Œä¾ç„¶åªæ˜¯å¯¹è±¡å¼•ç”¨çš„å¤åˆ¶ï¼Œæ‰€ä»¥Javaä¸ºæˆ‘ä»¬æä¾›çš„cloneæ–¹æ³•åªä¼šè¿›è¡Œæµ…æ‹·è´ã€‚é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å®ç°æ·±æ‹·è´å‘¢ï¼Ÿ\n@Override public Object clone() throws CloneNotSupportedException { //è¿™é‡Œæˆ‘ä»¬æ”¹è¿›ä¸€ä¸‹ï¼Œé’ˆå¯¹æˆå‘˜å˜é‡ä¹Ÿè¿›è¡Œæ‹·è´ Student student = (Student) super.clone(); student.name = new String(name); return student; //æˆå‘˜æ‹·è´å®Œæˆåï¼Œå†è¿”å› } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®ç°äº†æ·±æ‹·è´ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/design/%E5%88%9B%E5%BB%BA%E5%9E%8B/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97---%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%BA%8C%E5%88%9B%E5%BB%BA%E5%9E%8B/","section":"Docs","summary":"è®¾è®¡æ¨¡å¼ï¼ˆåˆ›å»ºå‹ï¼‰ #\rè½¯ä»¶è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰ï¼Œåˆç§°è®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€ç¨‹åºçš„é‡ç”¨æ€§ã€‚\nè‚¯ç‰¹Â·è´å…‹å’Œ\ræ²ƒå¾·Â·åå®å®‰åœ¨1987å¹´åˆ©ç”¨å…‹é‡Œæ–¯æ‰˜ä½›Â·äºšå†å±±å¤§åœ¨å»ºç­‘è®¾è®¡é¢†åŸŸé‡Œçš„æ€æƒ³å¼€å‘äº†è®¾è®¡æ¨¡å¼å¹¶æŠŠæ­¤æ€æƒ³åº”ç”¨åœ¨Smalltalkä¸­çš„å›¾å½¢ç”¨æˆ·æ¥å£çš„ç”Ÿæˆä¸­ã€‚ä¸€å¹´åErich Gammaåœ¨ä»–çš„\rè‹é»ä¸–å¤§å­¦åšå£«æ¯•ä¸šè®ºæ–‡ä¸­å¼€å§‹å°è¯•æŠŠè¿™ç§æ€æƒ³æ”¹å†™ä¸ºé€‚ç”¨äºè½¯ä»¶å¼€å‘ã€‚ä¸æ­¤åŒæ—¶James Coplien åœ¨1989å¹´è‡³1991 å¹´ä¹Ÿåœ¨åˆ©ç”¨ç›¸åŒçš„æ€æƒ³è‡´åŠ›äºC++çš„å¼€å‘ï¼Œè€Œåäº1991å¹´å‘è¡¨äº†ä»–çš„è‘—ä½œAdvanced C++ Idiomsã€‚å°±åœ¨è¿™ä¸€å¹´Erich Gamma å¾—åˆ°äº†åšå£«å­¦ä½ï¼Œç„¶åå»äº†ç¾å›½ï¼Œåœ¨é‚£ä¸Richard Helm, Ralph Johnson ,John Vlissidesåˆä½œå‡ºç‰ˆäº†Design Patterns - Elements of Reusable Object-Oriented Software ä¸€ä¹¦ï¼Œåœ¨æ­¤ä¹¦ä¸­å…±æ”¶å½•äº†23ä¸ªè®¾è®¡æ¨¡å¼ã€‚è¿™å››ä½ä½œè€…åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸé‡Œä¹Ÿä»¥ä»–ä»¬çš„åŒ¿åè‘—ç§°Gang of Four(å››äººå¸®ï¼Œç®€ç§°GoF),å¹¶ä¸”æ˜¯ä»–ä»¬åœ¨æ­¤ä¹¦ä¸­çš„åä½œå¯¼è‡´äº†è½¯ä»¶è®¾è®¡æ¨¡å¼çš„çªç ´ã€‚","title":"åˆ›å»ºå‹","type":"doc"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/tags/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/","section":"Tags","summary":"","title":"ä»£ç éšæƒ³å½•","type":"tags"},{"content":"ç¡®å®šåŒºé—´\nå·¦é—­å³é—­\nleft = 0; right = nums.size() - 1; while(left \u0026lt;= right){ // åŒºé—´ä¸ºç©º ç»“æŸå¾ªç¯ ï¼š (l \u0026gt; r) //å·¦å³ç›¸ç­‰æ˜¯åˆæ³•åŒºé—´ï¼Œæ¯”å¦‚ã€1ï¼Œ1ã€‘åªæœ‰ å…ƒç´ 1 mid = left + (right-left)\u0026gt;\u0026gt;2; if(nums[mid]\u0026gt;target){ right = mid -1;//ä¸ºäº†ä¸åŒ…å«åŸæ¥çš„nums[mid],æ‰€ä»¥å‡ä¸€ }else if(nums[mid]\u0026lt;target){ left = mid +1; }else return mid; } return -1; class Solution { public int search(int[] nums, int target) { int left = 0; int right = nums.length-1; while(left \u0026lt;= right){ int mid =left + (right-left) /2; if(nums[mid] \u0026gt; target){ right=mid-1; }else if(nums[mid] \u0026lt; target){ left = mid +1; }else{ return mid; } } return -1; } } å·¦é—­å³å¼€\n//å·¦é—­å³å¼€ä¸æ˜¯åˆæ³•åŒºé—´ï¼Œæ¯”å¦‚ã€1ï¼Œ1)æ²¡æœ‰ å…ƒç´ 1 left = 0; right = nums.size() ;//å·¦é—­å³å¼€ï¼Œæœ¬æ¥å°±ä¸åŒ…å« while(left \u0026lt; right){ // åŒºé—´ä¸ºç©º ç»“æŸå¾ªç¯ ï¼š (l == r) mid = left + (right-left)/2; if(nums[mid]\u0026gt;target){ // nums[mid] \u0026gt;= target æŸ¥è¯¢[l,midï¼‰ right = mid;//å·¦é—­å³å¼€ï¼Œæœ¬æ¥å°±ä¸åŒ…å« }else if(nums[mid]\u0026lt;target){ // æŸ¥è¯¢[mid+1,r), left = mid +1; }else{ return mid; } } return -1; ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E4%BA%8C%E5%88%86%E6%B3%95/","section":"Algorithms","summary":"ç¡®å®šåŒºé—´\nå·¦é—­å³é—­\nleft = 0; right = nums.size() - 1; while(left \u0026lt;= right){ // åŒºé—´ä¸ºç©º ç»“æŸå¾ªç¯ ï¼š (l \u0026gt; r) //å·¦å³ç›¸ç­‰æ˜¯åˆæ³•åŒºé—´ï¼Œæ¯”å¦‚ã€1ï¼Œ1ã€‘åªæœ‰ å…ƒç´ 1 mid = left + (right-left)\u0026gt;\u0026gt;2; if(nums[mid]\u0026gt;target){ right = mid -1;//ä¸ºäº†ä¸åŒ…å«åŸæ¥çš„nums[mid],æ‰€ä»¥å‡ä¸€ }else if(nums[mid]\u0026lt;target){ left = mid +1; }else return mid; } return -1; class Solution { public int search(int[] nums, int target) { int left = 0; int right = nums.","title":"äºŒåˆ†æ³•","type":"algorithm"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/%E7%AC%94%E8%AE%B0/featured/","section":"ç¬”è®°s","summary":"","title":"å°é¢æµ‹è¯•","type":"ç¬”è®°"},{"content":"masterå…¬å¼ï¼š\nåœ¨ç¼–ç¨‹ä¸­ï¼Œé€’å½’æ˜¯éå¸¸å¸¸è§çš„ä¸€ç§ç®—æ³•ï¼Œç”±äºä»£ç ç®€æ´è€Œåº”ç”¨å¹¿æ³›ï¼Œä½†é€’å½’ç›¸æ¯”é¡ºåºæ‰§è¡Œæˆ–å¾ªç¯ç¨‹åºï¼Œæ—¶é—´å¤æ‚åº¦éš¾ä»¥è®¡ç®—ï¼Œè€Œmasterå…¬å¼å°±æ˜¯ç”¨äºè®¡ç®—é€’å½’ç¨‹åºçš„æ—¶é—´å¤æ‚åº¦ã€‚\nT(N) = a*T(N/b) + O(N^d);\nâ€‹ ä¸‹é¢å¯¹å‚æ•°è¿›è¡Œè§£é‡Š:\nbï¼šå­è¿‡ç¨‹çš„æ ·æœ¬é‡ aï¼šå­è¿‡ç¨‹çš„è®¡ç®—æ¬¡æ•° O(N^d)ï¼šå­ç»“æœåˆå¹¶çš„æ—¶é—´å¤æ‚åº¦ æ»¡è¶³å¦‚ä¸Šå…¬å¼çš„ç¨‹åºéƒ½å¯ä»¥æ ¹æ®masterå…¬å¼è®¡ç®—æ—¶é—´å¤æ‚åº¦ï¼š\nlog(bï¼Œa) \u0026gt; d ï¼šæ—¶é—´å¤æ‚åº¦ä¸ºO(N^log(bï¼Œa)) log(bï¼Œa) = d ï¼šæ—¶é—´å¤æ‚åº¦ä¸ºO(N^d * logN) log(bï¼Œa) \u0026lt; d ï¼šæ—¶é—´å¤æ‚åº¦ä¸ºO(N^d)\nåœ¨å­¦ä¹ å½’å¹¶æ’åºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå­¦ä¹ ä¸€ä¸ªç®€å•çš„ç®—æ³•:å½“æˆ‘ä»¬æ±‚ä¸€ä¸ªå€¼çš„ä¸­å€¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\nint mid = L + ((R - L) \u0026raquo; 1); æ³¨æ„ä½¿ç”¨ä½è¿ç®—æ›´å¥½ï¼Œä¹‹åé‡‡ç”¨è¿™ç§æ–¹æ³•æ¥è®¡ç®—å¹³å‡æ•°\nâ€‹ è¿™æ ·å¯ä»¥é¿å…å†…å­˜æ³„éœ²ã€‚\nå½’å¹¶æ’åºï¼š\næ€æƒ³å¾ˆç®€å•ï¼Œå†™ä¸€ä¸ªä¸´æ—¶æ•°ç»„ï¼Œæ¯”è¾ƒéœ€è¦ä¼ å…¥çš„å¯¹åº”å…ƒç´ ï¼Œå°çš„å…ˆæ”¾å¥½ï¼Œå¤§çš„åæ”¾ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E7%AE%97%E6%B3%95/c/","section":"Algorithms","summary":"masterå…¬å¼ï¼š\nåœ¨ç¼–ç¨‹ä¸­ï¼Œé€’å½’æ˜¯éå¸¸å¸¸è§çš„ä¸€ç§ç®—æ³•ï¼Œç”±äºä»£ç ç®€æ´è€Œåº”ç”¨å¹¿æ³›ï¼Œä½†é€’å½’ç›¸æ¯”é¡ºåºæ‰§è¡Œæˆ–å¾ªç¯ç¨‹åºï¼Œæ—¶é—´å¤æ‚åº¦éš¾ä»¥è®¡ç®—ï¼Œè€Œmasterå…¬å¼å°±æ˜¯ç”¨äºè®¡ç®—é€’å½’ç¨‹åºçš„æ—¶é—´å¤æ‚åº¦ã€‚\nT(N) = a*T(N/b) + O(N^d);\nâ€‹ ä¸‹é¢å¯¹å‚æ•°è¿›è¡Œè§£é‡Š:\nbï¼šå­è¿‡ç¨‹çš„æ ·æœ¬é‡ aï¼šå­è¿‡ç¨‹çš„è®¡ç®—æ¬¡æ•° O(N^d)ï¼šå­ç»“æœåˆå¹¶çš„æ—¶é—´å¤æ‚åº¦ æ»¡è¶³å¦‚ä¸Šå…¬å¼çš„ç¨‹åºéƒ½å¯ä»¥æ ¹æ®masterå…¬å¼è®¡ç®—æ—¶é—´å¤æ‚åº¦ï¼š\nlog(bï¼Œa) \u0026gt; d ï¼šæ—¶é—´å¤æ‚åº¦ä¸ºO(N^log(bï¼Œa)) log(bï¼Œa) = d ï¼šæ—¶é—´å¤æ‚åº¦ä¸ºO(N^d * logN) log(bï¼Œa) \u0026lt; d ï¼šæ—¶é—´å¤æ‚åº¦ä¸ºO(N^d)\nåœ¨å­¦ä¹ å½’å¹¶æ’åºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå­¦ä¹ ä¸€ä¸ªç®€å•çš„ç®—æ³•:å½“æˆ‘ä»¬æ±‚ä¸€ä¸ªå€¼çš„ä¸­å€¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\nint mid = L + ((R - L) \u0026raquo; 1); æ³¨æ„ä½¿ç”¨ä½è¿ç®—æ›´å¥½ï¼Œä¹‹åé‡‡ç”¨è¿™ç§æ–¹æ³•æ¥è®¡ç®—å¹³å‡æ•°","title":"å¤æ‚åº¦","type":"algorithm"},{"content":"å­—æ¯å¼‚ä½è¯\nclass Solution { public: bool isAnagram(string s, string t) { int record[26] = {0}; for (int i = 0; i \u0026lt; s.size(); i++) { // å¹¶ä¸éœ€è¦è®°ä½å­—ç¬¦açš„ASCIIï¼Œåªè¦æ±‚å‡ºä¸€ä¸ªç›¸å¯¹æ•°å€¼å°±å¯ä»¥äº† record[s[i] - \u0026#39;a\u0026#39;]++; } for (int i = 0; i \u0026lt; t.size(); i++) { record[t[i] - \u0026#39;a\u0026#39;]--; } for (int i = 0; i \u0026lt; 26; i++) { if (record[i] != 0) { // recordæ•°ç»„å¦‚æœæœ‰çš„å…ƒç´ ä¸ä¸ºé›¶0ï¼Œè¯´æ˜å­—ç¬¦ä¸²så’Œt ä¸€å®šæ˜¯è°å¤šäº†å­—ç¬¦æˆ–è€…è°å°‘äº†å­—ç¬¦ã€‚ return false; } } // recordæ•°ç»„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºé›¶0ï¼Œè¯´æ˜å­—ç¬¦ä¸²så’Œtæ˜¯å­—æ¯å¼‚ä½è¯ return true; } }; é‡å æ•°\nclass Solution { public: vector\u0026lt;int\u0026gt; intersection(vector\u0026lt;int\u0026gt;\u0026amp; nums1, vector\u0026lt;int\u0026gt;\u0026amp; nums2) { vector\u0026lt;int\u0026gt; res(0); if (nums1.size()==0||nums2.size()==0){ return res; } unordered_set\u0026lt;int\u0026gt; setp; unordered_set\u0026lt;int\u0026gt; setq; for (int i = 0; i \u0026lt; nums1.size(); ++i) { setp.insert(nums1[i]); } //åœ¨å‰é¢çš„æ•°ç»„ä¸­å‡ºç°è¿‡ for (int i = 0; i \u0026lt; nums2.size(); ++i) { if (setp.find(nums2[i]) != setp.end()) { setq.insert(nums2[i]); } } return vector\u0026lt;int\u0026gt;(setq.begin(),setq.end()); } }; ä¸¤æ•°ä¹‹å’Œ\nclass Solution { public: vector\u0026lt;int\u0026gt; twoSum(vector\u0026lt;int\u0026gt;\u0026amp; nums, int target) { unordered_map\u0026lt;int,int\u0026gt; map;//kï¼šå…ƒç´ ï¼Œvï¼šä¸‹æ ‡ for (int i = 0; i \u0026lt; nums.size(); ++i){ if (map.find(target-nums[i])!=map.end()){ return {map.find(target-nums[i])-\u0026gt;second,i}; } map.insert(pair\u0026lt;int,int\u0026gt;(nums[i], i)); } return {}; } }; ä¸‰æ•°ä¹‹å’Œ\nvector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; threeSum(vector\u0026lt;int\u0026gt; \u0026amp;nums) { vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; res; //æ’åº sort(nums.begin(), nums.end()); for (int i = 0; i \u0026lt; nums.size(); ++i) { if (nums[0] \u0026gt; 0) { break; } unordered_set\u0026lt;int\u0026gt; set; //å»é‡ if (i \u0026gt; 0 \u0026amp;\u0026amp; nums[i - 1] == nums[i]) { continue; } for (int j = i + 1; j \u0026lt; nums.size(); ++j) { int target = 0 - (nums[i] + nums[j]); if (set.find(target) != set.end()) { res.push_back(vector\u0026lt;int\u0026gt;{nums[i], nums[j], target}); } else { res.push_back(vector\u0026lt;int\u0026gt;{nums[j]}); } } } return res; }; å¯»æ‰¾æœ€è¿‘çš„ä¸‰æ•°ä¹‹å’Œï¼š\n/**\nç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„ nums å’Œ ä¸€ä¸ªç›®æ ‡å€¼ targetã€‚è¯·ä½ ä» nums ä¸­é€‰å‡ºä¸‰ä¸ªæ•´æ•°ï¼Œä½¿å®ƒä»¬çš„å’Œä¸ target æœ€æ¥è¿‘ã€‚\nè¿”å›è¿™ä¸‰ä¸ªæ•°çš„å’Œã€‚\nå‡å®šæ¯ç»„è¾“å…¥åªå­˜åœ¨æ°å¥½ä¸€ä¸ªè§£ã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥ï¼šnums = [-1,2,1,-4], target = 1 è¾“å‡ºï¼š2 è§£é‡Šï¼šä¸ target æœ€æ¥è¿‘çš„å’Œæ˜¯ 2 (-1 + 2 + 1 = 2) ã€‚ */\nclass Solution { public: int threeSumClosest(vector\u0026lt;int\u0026gt; \u0026amp;nums, int target) { sort(nums.begin(), nums.end()); int len = nums.size(); int closestNum = nums[0] + nums[1] + nums[2]; for (int i = 0; i \u0026lt; len; ++i) { int j = i + 1; int k = len - 1; while (j \u0026lt; k) { int sum = nums[i] + nums[j] + nums[k]; if (sum == target) { return target;//åˆšå¥½ç›¸ç­‰ï¼Œç›´æ¥è¿”å›ç›®æ ‡å…ƒç´  } if (abs(target - sum) \u0026lt; abs(target - closestNum)) { closestNum = sum; } if (sum \u0026gt; target) { k--; } else { j++; } } } return closestNum; } }; class Solution { public int threeSumClosest(int[] nums, int target) { Arrays.sort(nums); int best=Integer.MAX_VALUE; int n=nums.length;//æ•°ç»„é•¿åº¦ for(int i=0;i\u0026lt;n;i++){ int j=i+1,k=n-1; //äºŒåˆ† while(j\u0026lt;k){ int sum=nums[i]+nums[j]+nums[k]; if(sum==target) return target;//åˆšå¥½ç›¸ç­‰ï¼Œç›´æ¥è¿”å›ç›®æ ‡å…ƒç´  if(Math.abs(target-sum)\u0026lt;Math.abs(best-target)){ best=sum; }else if(sum\u0026gt;target){ k--; }else{ j++; } } } return best; } } ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E5%93%88%E5%B8%8C%E7%AF%87/","section":"Algorithms","summary":"å­—æ¯å¼‚ä½è¯\nclass Solution { public: bool isAnagram(string s, string t) { int record[26] = {0}; for (int i = 0; i \u0026lt; s.size(); i++) { // å¹¶ä¸éœ€è¦è®°ä½å­—ç¬¦açš„ASCIIï¼Œåªè¦æ±‚å‡ºä¸€ä¸ªç›¸å¯¹æ•°å€¼å°±å¯ä»¥äº† record[s[i] - \u0026#39;a\u0026#39;]++; } for (int i = 0; i \u0026lt; t.","title":"å“ˆå¸Œç¯‡","type":"algorithm"},{"content":"\rè®¾è®¡æ¨¡å¼ï¼ˆç»“æ„å‹ï¼‰ #\rç»“æ„å‹è®¾è®¡æ¨¡å¼å…³æ³¨å¦‚ä½•å°†ç°æœ‰çš„ç±»æˆ–å¯¹è±¡ç»„ç»‡åœ¨ä¸€èµ·å½¢æˆæ›´åŠ å¼ºå¤§çš„ç»“æ„ã€‚å¹¶ä¸”æ ¹æ®æˆ‘ä»¬å‰é¢å­¦ä¹ çš„åˆæˆå¤ç”¨åŸåˆ™ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å°½å¯èƒ½åœ°ä½¿ç”¨å…³è”å…³ç³»æ¥ä»£æ›¿ç»§æ‰¿å…³ç³»æ˜¯æˆ‘ä»¬æœ¬ç‰ˆå—éœ€è¦é‡ç‚¹å­¦ä¹ çš„å†…å®¹ã€‚\nç±»/å¯¹è±¡é€‚é…å™¨æ¨¡å¼ #\råœ¨ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ï¼šç¬”è®°æœ¬å¤ªè½»è–„äº†ï¼Œä»¥è‡³äºæ²¡æœ‰RJ45ç½‘å£å’ŒUSB Aå£ï¼ˆæ¯”å¦‚Macbookä¸ºäº†è½»è–„ç”šè‡³å…¨æ˜¯type-cå½¢å¼çš„é›·ç”µå£ï¼‰ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å› ä¸ºå·¥ä½œéœ€è¦ï¼Œåˆå¾—ä½¿ç”¨è¿™äº›æ¥å£æ¥è¿æ¥çº¿ç¼†ï¼Œè¿™æ—¶æˆ‘ä»¬æƒ³åˆ°çš„ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯å»ä¹°ä¸€ä¸ªè½¬æ¥å£ï¼ˆæ‰©å±•åï¼‰ï¼Œæ‰©å±•åå¯ä»¥å°†type-cå£è½¬æ¢ä¸ºå…¶ä»–ç±»å‹çš„æ¥å£ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œå®é™…ä¸Šè¿™å°±æ˜¯ä¸€ç§é€‚é…æ¨¡å¼ã€‚\nç”±äºæˆ‘ä»¬çš„ç”µè„‘æ²¡æœ‰è¿™äº›æ¥å£ï¼Œä½†æ˜¯æä¾›äº†type-cç±»å‹çš„æ¥å£ï¼Œè™½ç„¶æ¥å£ç±»å‹ä¸ä¸€æ ·ï¼Œä½†æ˜¯åŒæ ·å¯ä»¥åšå…¶ä»–æ¥å£èƒ½åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚USBæ–‡ä»¶ä¼ è¾“ã€æœ‰çº¿ç½‘ç»œè¿æ¥ç­‰ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªä¸­é—´äººæ¥å¸®æˆ‘ä»¬è½¬æ¢ä¸€ä¸‹æ¥å£å½¢æ€å³å¯ã€‚åŒ…æ‹¬æˆ‘ä»¬å¸¸ç”¨çš„å……ç”µå¤´ï¼Œä¸ºä»€ä¹ˆå«ç”µæºé€‚é…å™¨å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ä¼ ç»Ÿçš„ä¾›ç”µæ˜¯220Väº¤æµç”µï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ‰‹æœºå¯èƒ½åªéœ€è¦5Vçš„ç”µå‹è¿›è¡Œå……ç”µï¼Œè™½ç„¶ç°åœ¨æœ‰ç”µï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥å……ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¯èƒ½è®©ç”µåŠ›å…¬å¸ä¸“é—¨ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ª5Vçš„ç›´æµç”µä½¿ç”¨ã€‚è¿™æ—¶ç”µæºé€‚é…å™¨å°±å¼€å§‹å‘æŒ¥ä½œç”¨äº†ï¼Œæ¯”å¦‚è‹¹æœçš„ç¥–ä¼ 5V1Aå……ç”µå¤´ï¼Œå®é™…ä¸Šå°±æ˜¯å°†220Väº¤æµç”µè½¬æ¢ä¸º5Vçš„ç›´æµç”µè¿›è¡Œä¼ è¾“ï¼Œè¿™æ ·å°±ç›¸å½“äºåœ¨220Väº¤æµç”µå’Œæˆ‘ä»¬çš„æ‰‹æœºä¹‹å‰ï¼Œåšäº†ä¸€ä¸ªé€‚é…å™¨çš„è§’è‰²ã€‚\nåœ¨æˆ‘ä»¬çš„Javaç¨‹åºä¸­ï¼Œä¹Ÿä¼šç»å¸¸é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š\npublic class TestSupplier { //æ‰‹æœºä¾›åº”å•† public String doSupply(){ return \u0026#34;iPhone 14 Pro\u0026#34;; } } public class Main { public static void main(String[] args) { TestSupplier supplier = new TestSupplier(); test( ? ); //æˆ‘ä»¬æ²¡æœ‰Targetç±»å‹çš„æ‰‹æœºä¾›åº”å•†ï¼Œåªæœ‰å…¶ä»–çš„ï¼Œé‚£è¿™é‡Œè¯¥å¡«ä¸ªå•¥ } public static void test(Target target){ //ç°åœ¨æˆ‘ä»¬éœ€è¦è°ƒç”¨testæ–¹æ³•ï¼Œä½†æ˜¯testæ–¹æ³•éœ€è¦Targetç±»å‹çš„æ‰‹æœºä¾›åº”å•† System.out.println(\u0026#34;æˆåŠŸå¾—åˆ°ï¼š\u0026#34;+target.supply()); } } public interface Target { //ç°åœ¨çš„æ‰‹æœºä¾›åº”å•†ï¼Œå¹¶ä¸æ˜¯testæ–¹æ³•æ‰€éœ€è¦çš„é‚£ç§ç±»å‹ String supply(); } è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨é€‚é…å™¨æ¨¡å¼äº†ï¼Œé€‚é…å™¨æ¨¡å¼åˆ†ä¸ºç±»é€‚é…å™¨å’Œå¯¹è±¡é€‚é…å™¨ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ç±»é€‚é…å™¨è§£å†³è¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªé€‚é…å™¨ç±»ï¼š\npublic class TestAdapter extends TestSupplier implements Target { //è®©æˆ‘ä»¬çš„é€‚é…å™¨ç»§æ‰¿TestSupplierå¹¶ä¸”å®ç°Targetæ¥å£ @Override public String supply() { //æ¥ç€å®ç°supplyæ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨TestSupplieræä¾›çš„å®ç° return super.doSupply(); } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªTargetç±»å‹çš„å®ç°ç±»ï¼Œå¹¶ä¸”åŒæ—¶é‡‡ç”¨çš„æ˜¯TestSupplieræä¾›çš„å®ç°ã€‚\npublic static void main(String[] args) { TestAdapter adapter = new TestAdapter(); test(adapter); } public static void test(Target target){ System.out.println(\u0026#34;æˆåŠŸå¾—åˆ°ï¼š\u0026#34;+target.supply()); } ä¸è¿‡ï¼Œè¿™ç§å®ç°æ–¹å¼éœ€è¦å ç”¨ä¸€ä¸ªç»§æ‰¿å‘ä½ï¼Œå¦‚æœæ­¤æ—¶Targetä¸æ˜¯æ¥å£è€Œæ˜¯æŠ½åƒç±»çš„è¯ï¼Œç”±äºJavaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œé‚£ä¹ˆå°±æ— æ³•å®ç°äº†ã€‚åŒæ—¶æ ¹æ®åˆæˆå¤ç”¨åŸåˆ™ï¼Œæˆ‘ä»¬åº”è¯¥æ›´å¤šçš„é€šè¿‡åˆæˆçš„æ–¹å¼å»å®ç°åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒç§ï¼Œä¹Ÿæ˜¯ç”¨çš„æ¯”è¾ƒå¤šçš„ä¸€ç§æ¨¡å¼ï¼Œå¯¹è±¡é€‚é…å™¨ï¼š\npublic class TestAdapter implements Target{ //ç°åœ¨ä¸å†ç»§æ‰¿TestSupplierï¼Œä»…å®ç°Target TestSupplier supplier; public TestAdapter(TestSupplier supplier){ this.supplier = supplier; } @Override public String supply() { return supplier.doSupply(); } } ç°åœ¨ï¼Œæˆ‘ä»¬å°±å°†å¯¹è±¡ä»¥ç»„åˆçš„å½¢å¼å­˜æ”¾åœ¨TestAdapterä¸­ï¼Œä¾ç„¶æ˜¯é€šè¿‡å­˜æ”¾çš„å¯¹è±¡è°ƒç”¨å…·ä½“å®ç°ã€‚\næ¡¥æ¥æ¨¡å¼ #\rç›¸ä¿¡å„ä½éƒ½å»å¥¶èŒ¶åº—ä¹°è¿‡å¥¶èŒ¶ï¼Œåœ¨è´­ä¹°å¥¶èŒ¶çš„æ—¶å€™ï¼Œåº—å‘˜é¦–å…ˆä¼šé—®æˆ‘ä»¬ï¼Œæ‚¨éœ€è¦ä»€ä¹ˆç±»å‹çš„å¥¶èŒ¶ï¼Œæ¯”å¦‚æˆ‘ä»¬æ­¤æ—¶ç‚¹äº†ä¸€æ¯å•µå•µèŠ‹åœ†å¥¶èŒ¶ï¼Œæ¥ç€åº—å‘˜ä¼šç›´æ¥é—®æˆ‘ä»¬éœ€è¦å¤§æ¯ã€ä¸­æ¯è¿˜æ˜¯å°æ¯ï¼Œæœ€åè¿˜ä¼šè¯¢é—®æˆ‘ä»¬éœ€è¦åŠ ä»€ä¹ˆé…æ–™ï¼Œæ¯”å¦‚æ¤°æœã€çç ç­‰ï¼Œæœ€åæ‰ä¼šç»™æˆ‘ä»¬åˆ¶ä½œå¥¶èŒ¶ã€‚\né‚£ä¹ˆç°åœ¨è®©ä½ æ¥è®¾è®¡ä¸€ä¸‹è¿™ç§æ¨¡å¼çš„Javaç±»ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬è¦æ˜ç¡®ï¼Œä¸€æ¯å¥¶èŒ¶é™¤äº†ç±»å‹ä¹‹å¤–ï¼Œè¿˜åˆ†å¤§ä¸­å°æ¯ï¼Œç”šè‡³å¯èƒ½è¿˜åˆ†åŠ ä»€ä¹ˆé…æ–™ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ç…§æ¥å£å®ç°çš„å†™æ³•ï¼š\npublic interface Tea { //ç”±å…·ä½“ç±»å‹çš„å¥¶èŒ¶å®ç° String getType(); //ä¸åŒçš„å¥¶èŒ¶è¿”å›çš„ç±»å‹ä¸åŒ } public interface Size { //åˆ†å¤§æ¯å°æ¯ä¸­æ¯ String getSize(); } æ¯”å¦‚ç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å‹ï¼š\n/** * å¤§æ¯èŠ‹åœ†å•µå•µå¥¶èŒ¶ */ public class LargeKissTea implements Tea, Size{ @Override public String getSize() { return \u0026#34;å¤§æ¯\u0026#34;; } @Override public String getType() { return \u0026#34;èŠ‹åœ†å•µå•µå¥¶èŒ¶\u0026#34;; } } è™½ç„¶è¿™æ ·è®¾è®¡èµ·æ¥è¿˜æŒºåˆç†çš„ï¼Œä½†æ˜¯å¦‚æœç°åœ¨æˆ‘ä»¬çš„å¥¶èŒ¶å“ç§å¤šèµ·æ¥äº†ï¼Œå¹¶ä¸”æ¯ç§å¥¶èŒ¶éƒ½æœ‰å¤§ä¸­å°æ¯ï¼Œç°åœ¨ä¸€å…±æœ‰ä¸¤ä¸ªç»´åº¦éœ€è¦è€ƒè™‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å²‚ä¸æ˜¯å¾—ä¸€ä¸ªä¸€ä¸ªå»åˆ›å»ºè¿™äº›ç±»ï¼Ÿç”šè‡³å¦‚æœè¿˜è¦è€ƒè™‘é…æ–™ï¼Œé‚£ä¹ˆå…‰åˆ›å»ºç±»å°±å¾—åˆ›å»ºä¸çŸ¥é“å¤šå°‘ä¸ªäº†ã€‚æ˜¾ç„¶è¿™ç§è®¾è®¡ä¸å¤ªå¥½ï¼Œæˆ‘ä»¬å¾—æ¢ä¸ªæ–¹å¼ã€‚\nè¿™æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„æ¡¥æ¥æ¨¡å¼äº†ï¼Œç°åœ¨æˆ‘ä»¬é¢ä¸´çš„é—®é¢˜æ˜¯ï¼Œç»´åº¦å¤ªå¤šï¼Œä¸å¯èƒ½å„ç§ç±»å‹å„ç§å°ºå¯¸çš„å¥¶èŒ¶éƒ½å»åˆ›å»ºä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¿˜æ˜¯å•ç‹¬å¯¹è¿™äº›æ¥å£è¿›è¡Œç®€å•çš„æ‰©å±•ï¼Œå•ç‹¬å¯¹ä¸åŒçš„ç»´åº¦è¿›è¡Œæ§åˆ¶ï¼Œä½†æ˜¯å¦‚ä½•å®ç°å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨å°†å¥¶èŒ¶çš„ç±»å‹ä½œä¸ºæœ€åŸºæœ¬çš„æŠ½è±¡ç±»ï¼Œç„¶åå¯¹å°ºå¯¸ã€é…æ–™ç­‰å±æ€§è¿›è¡Œæ¡¥æ¥ï¼š\npublic abstract class AbstractTea { protected Size size; //å°ºå¯¸ä½œä¸ºæ¡¥æ¥å±æ€§å­˜æ”¾åœ¨ç±»ä¸­ protected AbstractTea(Size size){ //åœ¨æ„é€ æ—¶éœ€è¦çŸ¥é“å°ºå¯¸å±æ€§ this.size = size; } public abstract String getType(); //å…·ä½“ç±»å‹ä¾ç„¶æ˜¯ç”±å­ç±»å†³å®š } ä¸è¿‡è¿™ä¸ªæŠ½è±¡ç±»æä¾›çš„æ–¹æ³•è¿˜ä¸å…¨é¢ï¼Œä»…ä»…åªæœ‰Teaçš„getTypeæ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ å…¶ä»–ç»´åº¦çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç»§ç»­ç¼–å†™ä¸€ä¸ªå­ç±»ï¼š\npublic abstract class RefinedAbstractTea extends AbstractTea{ protected RefinedAbstractTea(Size size) { super(size); } public String getSize(){ //æ·»åŠ å°ºå¯¸ç»´åº¦è·å–æ–¹å¼ return size.getSize(); } } ç°åœ¨æˆ‘ä»¬åªéœ€è¦å•ç‹¬ä¸ºSizeåˆ›å»ºå­ç±»å³å¯ï¼š\npublic class Large implements Size{ @Override public String getSize() { return \u0026#34;å¤§æ¯\u0026#34;; } } ç°åœ¨æˆ‘ä»¬å¦‚æœéœ€è¦ä¸€ä¸ªå¤§æ¯çš„å•µå•µèŠ‹åœ†å¥¶èŒ¶ï¼Œåªéœ€è¦ï¼š\npublic class KissTea extends RefinedAbstractTea{ //åˆ›å»ºä¸€ä¸ªå•µå•µèŠ‹åœ†å¥¶èŒ¶çš„å­ç±» protected KissTea(Size size) { //åœ¨æ„é€ æ—¶éœ€è¦æŒ‡å®šå…·ä½“çš„å¤§å°å®ç° super(size); } @Override public String getType() { return \u0026#34;å•µå•µèŠ‹åœ†å¥¶èŒ¶\u0026#34;; //è¿”å›å¥¶èŒ¶ç±»å‹ } } ç°åœ¨æˆ‘ä»¬å°±å°†ä¸¤ä¸ªç»´åº¦æ‹†å¼€ï¼Œå¯ä»¥åˆ†åˆ«è¿›è¡Œé…ç½®äº†ï¼š\npublic static void main(String[] args) { KissTea tea = new KissTea(new Large()); System.out.println(tea.getType()); System.out.println(tea.getSize()); } é€šè¿‡æ¡¥æ¥æ¨¡å¼ï¼Œä½¿å¾—æŠ½è±¡å’Œå®ç°å¯ä»¥æ²¿ç€å„è‡ªçš„ç»´åº¦æ¥è¿›è¡Œå˜åŒ–ï¼Œä¸å†æ˜¯å›ºå®šçš„ç»‘å®šå…³ç³»ã€‚\nç»„åˆæ¨¡å¼ #\rç»„åˆæ¨¡å¼å®é™…ä¸Šå°±æ˜¯å°†å¤šä¸ªç»„ä»¶è¿›è¡Œç»„åˆï¼Œè®©ç”¨æˆ·å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œä¸€è‡´æ€§å¤„ç†ã€‚æ¯”å¦‚æˆ‘ä»¬çš„æ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­å¯ä»¥æœ‰å¾ˆå¤šä¸ªå­æ–‡ä»¶å¤¹æˆ–æ˜¯æ–‡ä»¶ï¼š\nå®ƒå°±åƒæ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ä¸€æ ·ï¼Œæœ‰åˆ†æ”¯æœ‰å¶å­ï¼Œè€Œç»„åˆæ¨¡å¼åˆ™æ˜¯å¯ä»¥å¯¹æ•´ä¸ªæ ‘å½¢ç»“æ„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹è¿›è¡Œé€’å½’å¤„ç†ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨å¸Œæœ›å°†æ‰€æœ‰æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶çš„åç§°å‰é¢éƒ½æ·»åŠ ä¸€ä¸ªå‰ç¼€ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ç»„åˆæ¨¡å¼ã€‚\nç»„åˆæ¨¡å¼çš„ç¤ºä¾‹å¦‚ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç”¨æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„ä¾‹å­æ¥è®²è§£ï¼š\n/** * é¦–å…ˆåˆ›å»ºä¸€ä¸ªç»„ä»¶æŠ½è±¡ï¼Œç»„ä»¶å¯ä»¥åŒ…å«ç»„ä»¶ï¼Œç»„ä»¶æœ‰è‡ªå·±çš„ä¸šåŠ¡æ–¹æ³• */ public abstract class Component { public abstract void addComponent(Component component); //æ·»åŠ å­ç»„ä»¶ public abstract void removeComponent(Component component); //åˆ é™¤å­ç»„ä»¶ public abstract Component getChild(int index); //è·å–å­ç»„ä»¶ public abstract void test(); //æ‰§è¡Œå¯¹åº”çš„ä¸šåŠ¡æ–¹æ³•ï¼Œæ¯”å¦‚ä¿®æ”¹æ–‡ä»¶åç§° } æ¥ç€æˆ‘ä»¬æ¥ç¼–å†™ä¸¤ç§å®ç°ç±»ï¼š\npublic class Directory extends Component{ //ç›®å½•å¯ä»¥åŒ…å«å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½• List\u0026lt;Component\u0026gt; child = new ArrayList\u0026lt;\u0026gt;(); //è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Listæ¥å­˜æ”¾ç›®å½•ä¸­çš„å­ç»„ä»¶ @Override public void addComponent(Component component) { child.add(component); } @Override public void removeComponent(Component component) { child.remove(component); } @Override public Component getChild(int index) { return child.get(index); } @Override public void test() { child.forEach(Component::test); //å°†ç»§ç»­è°ƒç”¨æ‰€æœ‰å­ç»„ä»¶çš„testæ–¹æ³•æ‰§è¡Œä¸šåŠ¡ } } public class File extends Component{ //æ–‡ä»¶å°±ç›¸å½“äºæ˜¯æ ‘å¶ï¼Œæ— æ³•å†ç»§ç»­æ·»åŠ å­ç»„ä»¶äº† @Override public void addComponent(Component component) { throw new UnsupportedOperationException(); //ä¸æ”¯æŒè¿™äº›æ“ä½œäº† } @Override public void removeComponent(Component component) { throw new UnsupportedOperationException(); } @Override public Component getChild(int index) { throw new UnsupportedOperationException(); } @Override public void test() { System.out.println(\u0026#34;æ–‡ä»¶åç§°ä¿®æ”¹æˆåŠŸï¼\u0026#34;+this); //å…·ä½“çš„åç§°ä¿®æ”¹æ“ä½œ } } æœ€åï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\npublic static void main(String[] args) { Directory outer = new Directory(); //æ–°å»ºä¸€ä¸ªå¤–å±‚ç›®å½• Directory inner = new Directory(); //æ–°å»ºä¸€ä¸ªå†…å±‚ç›®å½• outer.addComponent(inner); outer.addComponent(new File()); //åœ¨å†…å±‚ç›®å½•å’Œå¤–å±‚ç›®å½•éƒ½æ·»åŠ ç‚¹æ–‡ä»¶ï¼Œæ³¨æ„åˆ«å¯¼é”™åŒ…äº† inner.addComponent(new File()); inner.addComponent(new File()); outer.test(); //å¼€å§‹æ‰§è¡Œæ–‡ä»¶åç§°ä¿®æ”¹æ“ä½œ } å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯¹æœ€å¤–å±‚ç›®å½•è¿›è¡Œæ“ä½œåï¼Œä¼šé€’å½’å‘ä¸‹å¤„ç†å½“å‰ç›®å½•å’Œå­ç›®å½•ä¸­æ‰€æœ‰çš„æ–‡ä»¶ã€‚\nè£…é¥°æ¨¡å¼ #\rè£…é¥°æ¨¡å¼å°±åƒå…¶åå­—ä¸€æ ·ï¼Œä¸ºäº†å¯¹ç°æœ‰çš„ç±»è¿›è¡Œè£…é¥°ã€‚æ¯”å¦‚ä¸€å¼ ç›¸ç‰‡å°±ä¸€å¼ çº¸ï¼Œå¦‚æœç›´æ¥è´´åœ¨å¢™ä¸Šï¼Œæ€»æ„Ÿè§‰å°‘äº†ç‚¹ä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘ä»¬ç»™å…¶æ·»åŠ ä¸€ä¸ªå¥½çœ‹çš„ç›¸æ¡†ï¼Œå°±ä¼šå˜å¾—éå¸¸å¯¹å‘³ã€‚è£…é¥°æ¨¡å¼çš„æ ¸å¿ƒå°±åœ¨äºä¸æ”¹å˜ä¸€ä¸ªå¯¹è±¡æœ¬èº«åŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œç»™å¯¹è±¡æ·»åŠ é¢å¤–çš„è¡Œä¸ºï¼Œå¹¶ä¸”å®ƒæ˜¯é€šè¿‡ç»„åˆçš„å½¢å¼å®Œæˆçš„ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„ç»§æ‰¿å…³ç³»ã€‚\næ¯”å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªæ™®é€šçš„åŠŸèƒ½ç±»ï¼š\npublic abstract class Base { //é¡¶å±‚æŠ½è±¡ç±»ï¼Œå®šä¹‰äº†ä¸€ä¸ªtestæ–¹æ³•æ‰§è¡Œä¸šåŠ¡ public abstract void test(); } public class BaseImpl extends Base{ @Override public void test() { System.out.println(\u0026#34;æˆ‘æ˜¯ä¸šåŠ¡æ–¹æ³•\u0026#34;); //å…·ä½“çš„ä¸šåŠ¡æ–¹æ³• } } ä¸è¿‡ç°åœ¨çš„å®ç°ç±»å¤ªå•è°ƒäº†ï¼Œæˆ‘ä»¬æ¥æ·»åŠ ä¸€ç‚¹è£…é¥°ä¸Šå»ï¼š\npublic class Decorator extends Base{ //è£…é¥°è€…éœ€è¦å°†è£…é¥°ç›®æ ‡ç»„åˆåˆ°ç±»ä¸­ protected Base base; public Decorator(Base base) { this.base = base; } @Override public void test() { base.test(); //è¿™é‡Œæš‚æ—¶è¿˜æ˜¯ä½¿ç”¨ç›®æ ‡çš„åŸæœ¬æ–¹æ³•å®ç° } } public class DecoratorImpl extends Decorator{ //è£…é¥°å®ç° public DecoratorImpl(Base base) { super(base); } @Override public void test() { //å¯¹åŸæœ¬çš„æ–¹æ³•è¿›è¡Œè£…é¥°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‰åéƒ½å»æ·»åŠ é¢å¤–æ“ä½œ System.out.println(\u0026#34;è£…é¥°æ–¹æ³•ï¼šæˆ‘æ˜¯æ“ä½œå‰é€»è¾‘\u0026#34;); super.test(); System.out.println(\u0026#34;è£…é¥°æ–¹æ³•ï¼šæˆ‘æ˜¯æ“ä½œåé€»è¾‘\u0026#34;); } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±é€šè¿‡è£…é¥°æ¨¡å¼å¯¹ç±»çš„åŠŸèƒ½è¿›è¡Œäº†æ‰©å±•ï¼š\npublic static void main(String[] args) { Base base = new BaseImpl(); Decorator decorator = new DecoratorImpl(base); //å°†Baseå®ç°è£…é¥°ä¸€ä¸‹ Decorator outer = new DecoratorImpl(decorator); //è£…é¥°è€…è¿˜å¯ä»¥åµŒå¥— decorator.test(); outer.test(); } è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†è£…é¥°æ¨¡å¼ã€‚\nä»£ç†æ¨¡å¼ #\rä»£ç†æ¨¡å¼å’Œè£…é¥°æ¨¡å¼å¾ˆåƒï¼Œåˆå­¦è€…å¾ˆå®¹æ˜“ææ··ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¾—ç´§æ¥ç€æ¥è®²è§£ä¸€ä¸‹ã€‚é¦–å…ˆè¯·è®°ä½ï¼Œå½“æ— æ³•ç›´æ¥è®¿é—®æŸä¸ªå¯¹è±¡æˆ–è®¿é—®æŸä¸ªå¯¹è±¡å­˜åœ¨å›°éš¾æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€ä¸ªä»£ç†å¯¹è±¡æ¥é—´æ¥è®¿é—®ã€‚\nå®é™…ä¸Šä»£ç†åœ¨æˆ‘ä»¬ç”Ÿæ´»ä¸­å¤„å¤„éƒ½å­˜åœ¨ï¼Œæ¯”å¦‚æ‰‹æœºå‚å•†è¦å»é”€å”®æ‰‹æœºï¼Œä½†æ˜¯æ‰‹æœºå‚å•†æœ¬èº«æ²¡æœ‰ä»€ä¹ˆæ¸ é“å¯ä»¥å¤§è§„æ¨¡åœ°è¿›è¡Œå”®å–ï¼Œå¾ˆéš¾ä¸è¿™äº›æ¶ˆè´¹è€…è¿›è¡Œå¯¹æ¥ï¼Œè¿™æ—¶å°±å¾—äº¤ç»™ä»£ç†å•†å»è¿›è¡Œå‡ºå”®ï¼Œæ¯”å¦‚Appleåœ¨ä¸­å›½çš„ç›´è¥åº—å¾ˆå°‘ï¼Œä½†æ˜¯åœ¨ä¸­å›½çš„æˆæƒç»é”€å•†å´å¾ˆå¤šï¼Œæ‰‹æœºå‚å•†é€šè¿‡äº¤ç»™æ——ä¸‹ä»£ç†å•†çš„å½¢å¼æ¥è¿›è¡Œæ›´å¤§è§„æ¨¡çš„å‡ºå”®ã€‚æ¯”å¦‚æˆ‘ä»¬ç»å¸¸è¦è®¿é—®Githubï¼Œä½†æ˜¯ç›´æ¥è¿æ¥ä¼šå‘ç°å¾ˆéš¾è¿çš„ä¸Šï¼Œè¿™æ—¶æˆ‘ä»¬åŠ äº†ä¸€ä¸ªä»£ç†å°±å¯ä»¥è½»æ¾è®¿é—®ï¼Œä¹Ÿæ˜¯åœ¨ä½“ç°ä»£ç†çš„ä½œç”¨ã€‚\nåŒæ—¶ï¼Œä»£ç†ç±»éœ€è¦ä¿è¯å®¢æˆ·ç«¯ä½¿ç”¨çš„é€æ˜æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´æ“ä½œèµ·æ¥éœ€è¦ä¸åŸæœ¬çš„çœŸå®å¯¹è±¡ç›¸åŒï¼Œæ¯”å¦‚æˆ‘ä»¬è®¿é—®Githubåªéœ€è¦è¾“å…¥ç½‘å€å³å¯è®¿é—®ï¼Œè€Œæ·»åŠ ä»£ç†ä¹‹åï¼Œä¹Ÿæ˜¯ä½¿ç”¨åŒæ ·çš„æ–¹å¼å»è®¿é—®Githubï¼Œæ‰€ä»¥æ“ä½œèµ·æ¥æ˜¯ä¸€æ ·çš„ã€‚åŒ…æ‹¬Springæ¡†æ¶å…¶å®ä¹Ÿæ˜¯ä¾é ä»£ç†æ¨¡å¼å»å®ç°çš„AOPè®°å½•æ—¥å¿—ç­‰ã€‚\næ¯”å¦‚ç°åœ¨æœ‰ä¸€ä¸ªç›®æ ‡ç±»ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨éœ€è¦é€šè¿‡ä»£ç†æ¥ä½¿ç”¨å®ƒï¼š\npublic abstract class Subject { public abstract void test(); } public class SubjectImpl extends Subject{ //æ­¤ç±»æ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦æˆ‘ä»¬è¿›è¡Œä»£ç† @Override public void test() { System.out.println(\u0026#34;æˆ‘æ˜¯æµ‹è¯•æ–¹æ³•ï¼\u0026#34;); } } ç°åœ¨æˆ‘ä»¬ä¸ºå…¶å»ºç«‹ä¸€ä¸ªä»£ç†ç±»ï¼š\npublic class Proxy extends Subject{ //ä¸ºäº†ä¿è¯å’ŒSubjectæ“ä½œæ–¹å¼ä¸€æ ·ï¼Œä¿è¯é€æ˜æ€§ï¼Œä¹Ÿå¾—ç»§æ‰¿ Subject target; //è¢«ä»£ç†çš„å¯¹è±¡ï¼ˆç”šè‡³å¯ä»¥å¤šé‡ä»£ç†ï¼‰ public Proxy(Subject subject){ this.target = subject; } @Override public void test() { //ç”±ä»£ç†å»æ‰§è¡Œè¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å¯ä»¥åœ¨å‰åæ·»æ²¹åŠ é†‹ System.out.println(\u0026#34;ä»£ç†å‰ç»•æ–¹æ³•\u0026#34;); target.test(); System.out.println(\u0026#34;ä»£ç†åç»•æ–¹æ³•\u0026#34;); } } ä¹ä¸€çœ‹ï¼Œè¿™ä¸è·Ÿä¹‹å‰çš„è£…é¥°æ¨¡å¼ä¸€æ¨¡ä¸€æ ·å—ï¼Ÿ\nå¯¹è£…é¥°å™¨æ¨¡å¼æ¥è¯´ï¼Œè£…é¥°è€…å’Œè¢«è£…é¥°è€…éƒ½å®ç°åŒä¸€ä¸ªæ¥å£/æŠ½è±¡ç±»ã€‚å¯¹ä»£ç†æ¨¡å¼æ¥è¯´ï¼Œä»£ç†ç±»å’Œè¢«ä»£ç†çš„ç±»éƒ½å®ç°åŒä¸€ä¸ªæ¥å£/æŠ½è±¡ç±»ï¼Œåœ¨ç»“æ„ä¸Šç¡®å®æ²¡æœ‰å•¥åŒºåˆ«ã€‚ä½†æ˜¯ä»–ä»¬çš„ä½œç”¨ä¸åŒï¼Œè£…é¥°å™¨æ¨¡å¼å¼ºè°ƒçš„æ˜¯å¢å¼ºè‡ªèº«ï¼Œåœ¨è¢«è£…é¥°ä¹‹åä½ èƒ½å¤Ÿåœ¨è¢«å¢å¼ºçš„ç±»ä¸Šä½¿ç”¨å¢å¼ºåçš„åŠŸèƒ½ï¼Œå¢å¼ºåä½ è¿˜æ˜¯ä½ ï¼Œåªä¸è¿‡è¢«å¼ºåŒ–äº†è€Œå·²ï¼›ä»£ç†æ¨¡å¼å¼ºè°ƒè¦è®©åˆ«äººå¸®ä½ å»åšäº‹æƒ…ï¼Œä»¥åŠæ·»åŠ ä¸€äº›æœ¬èº«ä¸ä½ ä¸šåŠ¡æ²¡æœ‰å¤ªå¤šå…³ç³»çš„äº‹æƒ…ï¼ˆè®°å½•æ—¥å¿—ã€è®¾ç½®ç¼“å­˜ç­‰ï¼‰é‡ç‚¹åœ¨äºè®©åˆ«äººå¸®ä½ åšã€‚\nè£…é¥°æ¨¡å¼å’Œä»£ç†æ¨¡å¼çš„ä¸åŒä¹‹å¤„åœ¨äºæ€æƒ³ã€‚\nå½“ç„¶å®ç°ä»£ç†æ¨¡å¼é™¤äº†æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„è¿™ç§æ–¹å¼ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨JDKä¸ºæˆ‘ä»¬æä¾›çš„åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦æ‰‹åŠ¨ç¼–å†™ç»§æ‰¿å…³ç³»åˆ›å»ºä»£ç†ç±»ï¼Œå®ƒèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶é€šè¿‡åå°„æœºåˆ¶ä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»ï¼š\npublic interface Subject { //JDKæä¾›çš„åŠ¨æ€ä»£ç†åªæ”¯æŒæ¥å£ void test(); } public class SubjectImpl implements Subject{ @Override public void test() { System.out.println(\u0026#34;æˆ‘æ˜¯æµ‹è¯•æ–¹æ³•ï¼\u0026#34;); } } æ¥ç€æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåŠ¨æ€ä»£ç†çš„å¤„ç†é€»è¾‘ï¼š\npublic class TestProxy implements InvocationHandler { //ä»£ç†ç±»ï¼Œéœ€è¦å®ç°InvocationHandleræ¥å£ private final Object object; //è¿™é‡Œéœ€è¦ä¿å­˜ä¸€ä¸‹è¢«ä»£ç†çš„å¯¹è±¡ï¼Œä¸‹é¢éœ€è¦ç”¨åˆ° public TestProxy(Object object) { this.object = object; } @Override //æ­¤æ–¹æ³•å°±æ˜¯è°ƒç”¨ä»£ç†å¯¹è±¡çš„å¯¹åº”æ–¹æ³•æ—¶ä¼šè¿›å…¥ï¼Œè¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ç¼–å†™å¦‚ä½•è¿›è¡Œä»£ç†äº† public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { //methodå°±æ˜¯è°ƒç”¨çš„ä»£ç†å¯¹è±¡çš„å“ªä¸€ä¸ªæ–¹æ³•ï¼Œargsæ˜¯å®å‚æ•°ç»„ System.out.println(\u0026#34;ä»£ç†çš„å¯¹è±¡ï¼š\u0026#34;+proxy.getClass()); //proxyå°±æ˜¯ç”Ÿæˆçš„ä»£ç†å¯¹è±¡äº†ï¼Œæˆ‘ä»¬çœ‹çœ‹æ˜¯ä»€ä¹ˆç±»å‹çš„ Object res = method.invoke(object, args); //åœ¨ä»£ç†ä¸­è°ƒç”¨è¢«ä»£ç†å¯¹è±¡åŸæœ¬çš„æ–¹æ³•ï¼Œå› ä¸ºä½ æ˜¯ä»£ç†ï¼Œè¿˜æ˜¯å¾—æ‰§è¡Œä¸€ä¸‹åˆ«äººçš„ä¸šåŠ¡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸æ‰§è¡Œï¼Œä½†æ˜¯è¿™æ ·å°±å¤±å»ä»£ç†çš„æ„ä¹‰äº†ï¼Œæ³¨æ„è¦ç”¨ä¸Šé¢çš„object System.out.println(\u0026#34;æ–¹æ³•è°ƒç”¨å®Œæˆï¼Œè¿”å›å€¼ä¸ºï¼š\u0026#34;+res); //çœ‹çœ‹è¿”å›å€¼æ˜¯ä»€ä¹ˆ return res; //è¿”å›è¿”å›å€¼ } } æœ€åæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªä»£ç†ç±»ï¼š\npublic static void main(String[] args) { SubjectImpl subject = new SubjectImpl(); //è¢«ä»£ç†çš„å¤§å†¤ç§ InvocationHandler handler = new TestProxy(subject); Subject proxy = (Subject) Proxy.newProxyInstance( subject.getClass().getClassLoader(), //éœ€è¦ä¼ å…¥è¢«ä»£ç†çš„ç±»çš„ç±»åŠ è½½å™¨ subject.getClass().getInterfaces(), //éœ€è¦ä¼ å…¥è¢«ä»£ç†çš„ç±»çš„æ¥å£åˆ—è¡¨ handler); //æœ€åä¼ å…¥æˆ‘ä»¬å®ç°çš„ä»£ç†å¤„ç†é€»è¾‘å®ç°ç±» proxy.test(); //æ¯”å¦‚ç°åœ¨æˆ‘ä»¬è°ƒç”¨ä»£ç†ç±»çš„testæ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥åˆ°æˆ‘ä»¬ä¸Šé¢TestProxyä¸­invokeæ–¹æ³•ï¼Œèµ°æˆ‘ä»¬çš„ä»£ç†é€»è¾‘ } è¿è¡Œä¸€æ¬¡ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨ä»£ç†ç±»çš„æ–¹æ³•ï¼Œæœ€ç»ˆä¼šèµ°åˆ°æˆ‘ä»¬çš„invokeæ–¹æ³•ä¸­è¿›è¡Œï¼š\næ ¹æ®æ¥å£ï¼Œä»£ç†å¯¹è±¡æ˜¯com.sun.proxy.$Proxy0ç±»ï¼ˆçœ‹åå­—å°±çŸ¥é“ä¸å¯¹åŠ²ï¼‰ï¼Œè¿™ä¸ªç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬ä¹Ÿæ‰¾ä¸åˆ°å…·ä½“çš„æºä»£ç ã€‚\nä¸è¿‡JDKæä¾›çš„åŠ¨æ€ä»£ç†åªèƒ½ä½¿ç”¨æ¥å£ï¼Œå¦‚æœæ¢æˆæˆ‘ä»¬ä¸€å¼€å§‹çš„æŠ½è±¡ç±»ï¼Œå°±æ²¡åŠæ³•äº†ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›ç¬¬ä¸‰æ–¹æ¡†æ¶æ¥å®ç°æ›´å¤šæ–¹å¼çš„åŠ¨æ€ä»£ç†ï¼Œæ¯”å¦‚Springéƒ½åœ¨ä½¿ç”¨çš„CGLibæ¡†æ¶ï¼ŒMavenä¾èµ–å¦‚ä¸‹ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;cglib\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;cglib\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; ç”±äºCGlibåº•å±‚ä½¿ç”¨ASMæ¡†æ¶ï¼ˆJVMç¯‡è§†é¢‘æ•™ç¨‹æœ‰ä»‹ç»ï¼‰è¿›è¡Œå­—èŠ‚ç ç¼–è¾‘ï¼Œæ‰€ä»¥èƒ½å¤Ÿå®ç°ä¸ä»…ä»…å±€é™äºå¯¹æ¥å£çš„ä»£ç†ï¼š\npublic class TestProxy implements MethodInterceptor { //é¦–å…ˆè¿˜æ˜¯ç¼–å†™æˆ‘ä»¬çš„ä»£ç†é€»è¾‘ private final Object target; //è¿™äº›å’Œä¹‹å‰JDKåŠ¨æ€ä»£ç†å†™æ³•æ˜¯ä¸€æ ·çš„ public TestProxy(Object target) { this.target = target; } @Override //æˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦åœ¨è¿™é‡Œå»ç¼–å†™æˆ‘ä»¬çš„ä»£ç†é€»è¾‘ public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable { System.out.println(\u0026#34;ç°åœ¨æ˜¯ç”±CGLibè¿›è¡Œä»£ç†æ“ä½œï¼\u0026#34;+o.getClass()); return method.invoke(target, objects); //ä¹Ÿæ˜¯ç›´æ¥è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•å³å¯ } } æ¥ç€æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸‹ä»£ç†ç±»ï¼š\npublic static void main(String[] args) { SubjectImpl subject = new SubjectImpl(); Enhancer enhancer = new Enhancer(); //å¢å¼ºå™¨ï¼Œä¸€ä¼šå°±éœ€è¦ä¾é å¢å¼ºå™¨æ¥ä¸ºæˆ‘ä»¬ç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ enhancer.setSuperclass(SubjectImpl.class); //ç›´æ¥é€‰æ‹©æˆ‘ä»¬éœ€è¦ä»£ç†çš„ç±»å‹ï¼Œç›´æ¥ä¸éœ€è¦æ¥å£æˆ–æ˜¯æŠ½è±¡ç±»ï¼ŒSuperClassä½œä¸ºä»£ç†ç±»çš„çˆ¶ç±»å­˜åœ¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§æŒ‡å®šç±»å‹çš„æ–¹å¼å»æ“ä½œä»£ç†ç±»äº† enhancer.setCallback(new TestProxy(subject)); //è®¾å®šæˆ‘ä»¬åˆšåˆšç¼–å†™å¥½çš„ä»£ç†é€»è¾‘ SubjectImpl proxy = (SubjectImpl) enhancer.create(); //ç›´æ¥åˆ›å»ºä»£ç†ç±» proxy.test(); //è°ƒç”¨ä»£ç†ç±»çš„testæ–¹æ³• } å¯ä»¥çœ‹åˆ°ï¼Œæ•ˆæœå…¶å®æ˜¯å·®ä¸å¤šçš„ï¼š\nå¯ä»¥çœ‹åˆ°ä»£ç†ç±»æ˜¯åŒ…å.SubjectImpl$$EnhancerByCGLIB$$47f6ed3aï¼Œä¹Ÿæ˜¯åŠ¨æ€ç”Ÿæˆçš„ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•å»æŸ¥çœ‹æºç ï¼Œä¸è¿‡æ­¤ç±»æ˜¯ç»§æ‰¿è‡ªæˆ‘ä»¬æŒ‡å®šçš„ç±»å‹çš„ã€‚\nå¤–è§‚æ¨¡å¼ #\rä½ æ˜¯å¦ç»å†è¿‡ç±»ä¼¼çš„æƒ…å†µï¼šä»Šå¹´è®¡ç®—æœºå­¦é™¢çš„å¥–å­¦é‡‘è¯„å®šå·¥ä½œå¼€å§‹äº†ï¼Œç”±äºä½ å»å¹´ä¸€ä¸å°å¿ƒæ‹¿äº†ä¸ªACMçš„åŒºåŸŸèµ›é‡‘ç‰Œï¼Œè§‰å¾—è‡ªå·±åˆè¡Œäº†ï¼Œäºæ˜¯ä¹Ÿæƒ³å‚ä¸åˆ°å¥–å­¦é‡‘çš„äº‰å¤ºä¸­ï¼Œé¦–å…ˆä½ çš„è¾…å¯¼å‘˜ä¼šé€šçŸ¥ä½ å»æ‰“å°ä½ çš„è·å¥–ææ–™ï¼Œç„¶åä½ é«˜é«˜å…´å…´æ‹¿ç»™è¾…å¯¼å‘˜ä¹‹åï¼Œè¾…å¯¼å‘˜åˆç»™äº†ä½ ä¸€å¼ è¡¨ï¼Œè®©ä½ æ‰“å°äº†ä¹‹åå¡«å†™ä¸€ä¸‹ï¼ŒåŒ…æ‹¬ä½ çš„ä¸ªäººä¿¡æ¯è¿˜æœ‰ä¸€äº›ä¸ªäººä»‹ç»ï¼Œå®Œæˆåï¼Œä½ æœ¬ä»¥ä¸ºå¯ä»¥åç­‰å‘å¥–äº†ï¼Œç»“æœè¾…å¯¼å‘˜åˆè·Ÿä½ è¯´æˆ‘ä»¬è¯„å®šè¿˜è¦å»æŸæŸåœ°æ–¹ç›–ç« ï¼Œç›–å®Œç« è¿˜è¦å»æ‰¾è°è°è°ç­¾å­—ï¼Œæœ€åè¿˜è¦å‚åŠ ä¸€ä¸‹ç­”è¾©\u0026hellip; çœ‹ç€å¦‚æ­¤å¤æ‚çš„æµç¨‹ï¼Œä½ ç¬é—´ä¸æƒ³æäº†ã€‚\nå®é™…ä¸Šæˆ‘ä»¬ç”Ÿæ´»ä¸­å¾ˆå¤šæ—¶å€™éƒ½æ˜¯è¿™æ ·ï¼Œå¯èƒ½åœ¨åŠä¸€ä»¶äº‹æƒ…çš„æ—¶å€™ï¼Œç”±äºéƒ¨é—¨èŒèƒ½çš„ä¸åŒï¼Œä½ å¾—å„ä¸ªéƒ¨é—¨åˆ°å¤„è·‘ï¼Œä½ è‚¯å®šä¼šæŠ±æ€¨ä¸€å¥ï¼Œå°±ä¸èƒ½æœ‰ä¸ªäººæ¥ç»Ÿä¸€ä¸€ä¸‹å—ï¼Œå°±ä¸èƒ½åœ¨ä¸€ä¸ªåœ°æ–¹ä¸€èµ·æŠŠäº‹æƒ…éƒ½åŠäº†å—ï¼Ÿè¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨åˆ°å¤–è§‚æ¨¡å¼äº†ã€‚\nå¤–è§‚æ¨¡å¼å……åˆ†ä½“ç°äº†è¿ªç±³ç‰¹æ³•åˆ™ã€‚å¯èƒ½æˆ‘ä»¬çš„æ•´ä¸ªé¡¹ç›®æœ‰å¾ˆå¤šä¸ªå­ç³»ç»Ÿï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨è¿™äº›å­ç³»ç»Ÿçš„ä¸Šé¢åŠ ä¸€ä¸ªé—¨é¢ï¼ˆFacadeï¼‰å½“æˆ‘ä»¬å¤–éƒ¨éœ€è¦ä¸å„ä¸ªå­ç³»ç»Ÿäº¤äº’æ—¶ï¼Œæ— éœ€å†å»ç›´æ¥ä½¿ç”¨å„ä¸ªå­ç³»ç»Ÿï¼Œè€Œæ˜¯ä¸é—¨é¢è¿›è¡Œäº¤äº’ï¼Œå†ç”±é—¨é¢ä¸åé¢çš„å„ä¸ªå­ç³»ç»Ÿæ“ä½œï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬ä»¥åéœ€è¦åŠä»€ä¹ˆäº‹æƒ…ï¼Œå°±ç»Ÿä¸€æ‰¾é—¨é¢å°±è¡Œäº†ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œé¦–å…ˆè‚¯å®šæ–¹ä¾¿äº†ä»£ç çš„ç¼–å†™ï¼Œç»Ÿä¸€æ‰¾é—¨é¢å°±è¡Œï¼Œä¸éœ€è¦å»è¯¦ç»†äº†è§£å­ç³»ç»Ÿï¼Œå¹¶ä¸”ï¼Œå½“å­ç³»ç»Ÿéœ€è¦ä¿®æ”¹æ—¶ï¼Œä¹Ÿåªéœ€è¦ä¿®æ”¹é—¨é¢ä¸­çš„é€»è¾‘ï¼Œä¸éœ€è¦å¤§é¢ç§¯çš„å˜åŠ¨ï¼Œéµå¾ªè¿ªç±³ç‰¹æ³•åˆ™å°½å¯èƒ½å°‘çš„äº¤äº’ã€‚\næ¯”å¦‚ç°åœ¨æˆ‘ä»¬è®¾è®¡äº†ä¸‰ä¸ªå­ç³»ç»Ÿï¼Œåˆ†åˆ«æ˜¯æ’é˜Ÿã€ç»“å©šã€é¢†è¯ï¼Œæ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯éœ€è¦åˆ†åˆ«å»æ‰¾è¿™ä¸‰ä¸ªéƒ¨é—¨å»å®Œæˆçš„ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬é€šè¿‡é—¨é¢ç»Ÿä¸€æ¥å®Œæˆï¼š\npublic class SubSystemA { public void test1(){ System.out.println(\u0026#34;æ’é˜Ÿ\u0026#34;); } } public class SubSystemB { public void test2(){ System.out.println(\u0026#34;ç»“å©š\u0026#34;); } } public class SubSystemC { public void test3(){ System.out.println(\u0026#34;é¢†è¯\u0026#34;); } } ç°åœ¨ä¸‰ä¸ªç³»ç»Ÿå¤ªå¤æ‚äº†ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªé—¨é¢ï¼š\npublic class Facade { SubSystemA a = new SubSystemA(); SubSystemB b = new SubSystemB(); SubSystemC c = new SubSystemC(); public void marry(){ //çº¢ç™½å–œäº‹ä¸€æ¡é¾™æœåŠ¡ a.test1(); b.test2(); c.test3(); } } ç°åœ¨æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªé—¨é¢å°±èƒ½ç›´æ¥æŠŠäº‹æƒ…åŠå®Œäº†ï¼š\npublic static void main(String[] args) { Facade facade = new Facade(); facade.marry(); } é€šè¿‡ä½¿ç”¨å¤–è§‚æ¨¡å¼ï¼Œæˆ‘ä»¬å°±å¤§å¤§é™ä½äº†ç±»ä¸ç±»ç›´æ¥çš„å…³è”ç¨‹åº¦ï¼Œå¹¶ä¸”ç®€åŒ–äº†æµç¨‹ã€‚\näº«å…ƒæ¨¡å¼ #\ræœ€åæˆ‘ä»¬æ¥çœ‹çœ‹äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ª\u0026quot;äº«å…ƒ\u0026quot;ä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸‹é¢çš„é—®é¢˜ï¼š\npublic static void main(String[] args) { String str1 = \u0026#34;abcdefg\u0026#34;; String str2 = \u0026#34;abcd\u0026#34;; } æˆ‘ä»¬å‘ç°ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²è™½ç„¶é•¿çŸ­ä¸åŒï¼Œä½†æ˜¯å´åŒ…å«äº†ä¸€æ®µç›¸åŒçš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬å¦‚æœè¦å¯¹å†…å­˜è¿›è¡Œä¼˜åŒ–ï¼š\npublic static void main(String[] args) { String str1 = \u0026#34;efg\u0026#34;; //ç”±äºstr1åŒ…å«str2ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ‰é‡å¤çš„éƒ¨åˆ†ï¼Œå½“éœ€è¦åŸæœ¬çš„str1æ—¶ï¼Œå†åˆåœ¨ä¸€èµ· String str2 = \u0026#34;abcd\u0026#34;; System.out.println(\u0026#34;str1 = \u0026#34;+str2+str1); } è€Œäº«å…ƒæ¨¡å¼å°±æ˜¯è¿™ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥å°†é‚£äº›é‡å¤å‡ºç°çš„å†…å®¹ä½œä¸ºå…±äº«éƒ¨åˆ†å–å‡ºï¼Œè¿™æ ·å½“æˆ‘ä»¬æ‹¥æœ‰å¤§é‡å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬æŠŠå…¶ä¸­å…±åŒçš„éƒ¨åˆ†æŠ½å–å‡ºæ¥ï¼Œç”±äºæå–çš„éƒ¨åˆ†æ˜¯å¤šä¸ªå¯¹è±¡å…±äº«åªæœ‰ä¸€ä»½ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‡è½»å†…å­˜çš„å‹åŠ›ã€‚åŒ…æ‹¬æˆ‘ä»¬çš„å›´æ£‹ï¼Œå®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦çŸ¥é“æ£‹ç›˜ä¸Šçš„å„ä¸ªä½ç½®æ˜¯é»‘æ£‹è¿˜æ˜¯ç™½æ£‹ï¼Œå®é™…ä¸Šæ²¡æœ‰æ¯•ä¸šåˆ›å»ºå¾ˆå¤šä¸ªæ£‹å­å¯¹è±¡ï¼Œæˆ‘ä»¬åªéœ€è¦å»å¤ç”¨ä¸€ä¸ªé»‘æ£‹å’Œä¸€ä¸ªç™½æ£‹å­å¯¹è±¡å³å¯ã€‚\næ¯”å¦‚ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ä¸ªæœåŠ¡ï¼Œä½†æ˜¯ä»–ä»¬éƒ½éœ€è¦ä½¿ç”¨æ•°æ®åº“å·¥å…·ç±»æ¥æ“ä½œï¼Œå®é™…ä¸Šè¿™ä¸ªå·¥å…·ç±»æ²¡å¿…è¦åˆ›å»ºå¤šä¸ªï¼Œæˆ‘ä»¬è¿™æ—¶å°±å¯ä»¥ä½¿ç”¨äº«å…ƒæ¨¡å¼ï¼Œè®©æ•°æ®åº“å·¥å…·ç±»ä½œä¸ºäº«å…ƒç±»ï¼Œé€šè¿‡äº«å…ƒå·¥å‚æ¥æä¾›ä¸€ä¸ªå…±äº«çš„æ•°æ®åº“å·¥å…·ç±»ï¼š\npublic class DBUtil { public void selectDB(){ System.out.println(\u0026#34;æˆ‘æ˜¯æ•°æ®åº“æ“ä½œ...\u0026#34;); } } public class DBUtilFactory { private static final DBUtil UTIL = new DBUtil(); //äº«å…ƒå¯¹è±¡è¢«å­˜æ”¾åœ¨å·¥å‚ä¸­ public static DBUtil getFlyweight(){ //è·å–äº«å…ƒå¯¹è±¡ return UTIL; } } æœ€åå½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨äº«å…ƒå¯¹è±¡æ—¶ï¼Œç›´æ¥æ‰¾äº«å…ƒå·¥å‚è¦å°±è¡Œäº†ï¼š\npublic class UserService { //ç”¨æˆ·æœåŠ¡ public void service(){ DBUtil util = DBUtilFactory.getFlyweight(); //é€šè¿‡äº«å…ƒå·¥å‚æ‹¿åˆ°DBUtilå¯¹è±¡ util.selectDB(); //è¯¥å¹²å˜›å¹²å˜› } } å½“ç„¶ï¼Œè¿™åªæ˜¯ç®€å•çš„äº«å…ƒæ¨¡å¼å®ç°ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¸€å¼€å§‹ä¸¾ä¾‹çš„Stringç±»ï¼Œä¹Ÿåœ¨ä½¿ç”¨äº«å…ƒæ¨¡å¼è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š\npublic static void main(String[] args) { String str1 = \u0026#34;abcd\u0026#34;; String str2 = \u0026#34;abcd\u0026#34;; String str3 = \u0026#34;ab\u0026#34; + \u0026#34;cd\u0026#34;; System.out.println(str1 == str2); System.out.println(str1 == str3); //çŒœçŒœè¿™ä¸‰ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯éƒ½æ˜¯åŒä¸€ä¸ªï¼Ÿ } è™½ç„¶æˆ‘ä»¬è¿™é‡Œå®šä¹‰äº†ä¸‰ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œè¿™ä¸‰ä¸ªå¯¹è±¡æŒ‡å‘çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå®é™…ä¸Šè¿™æ­£æ˜¯Javaè¯­è¨€å®ç°äº†æ•°æ®çš„å…±äº«ï¼Œæƒ³è¦äº†è§£å…·ä½“å®ç°è¯·å‰å¾€JVMç¯‡è§†é¢‘æ•™ç¨‹ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/design/%E7%BB%93%E6%9E%84%E5%9E%8B/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97---%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%89%E7%BB%93%E6%9E%84%E5%9E%8B/","section":"Docs","summary":"è®¾è®¡æ¨¡å¼ï¼ˆç»“æ„å‹ï¼‰ #\rç»“æ„å‹è®¾è®¡æ¨¡å¼å…³æ³¨å¦‚ä½•å°†ç°æœ‰çš„ç±»æˆ–å¯¹è±¡ç»„ç»‡åœ¨ä¸€èµ·å½¢æˆæ›´åŠ å¼ºå¤§çš„ç»“æ„ã€‚å¹¶ä¸”æ ¹æ®æˆ‘ä»¬å‰é¢å­¦ä¹ çš„åˆæˆå¤ç”¨åŸåˆ™ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å°½å¯èƒ½åœ°ä½¿ç”¨å…³è”å…³ç³»æ¥ä»£æ›¿ç»§æ‰¿å…³ç³»æ˜¯æˆ‘ä»¬æœ¬ç‰ˆå—éœ€è¦é‡ç‚¹å­¦ä¹ çš„å†…å®¹ã€‚\nç±»/å¯¹è±¡é€‚é…å™¨æ¨¡å¼ #\råœ¨ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ï¼šç¬”è®°æœ¬å¤ªè½»è–„äº†ï¼Œä»¥è‡³äºæ²¡æœ‰RJ45ç½‘å£å’ŒUSB Aå£ï¼ˆæ¯”å¦‚Macbookä¸ºäº†è½»è–„ç”šè‡³å…¨æ˜¯type-cå½¢å¼çš„é›·ç”µå£ï¼‰ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å› ä¸ºå·¥ä½œéœ€è¦ï¼Œåˆå¾—ä½¿ç”¨è¿™äº›æ¥å£æ¥è¿æ¥çº¿ç¼†ï¼Œè¿™æ—¶æˆ‘ä»¬æƒ³åˆ°çš„ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯å»ä¹°ä¸€ä¸ªè½¬æ¥å£ï¼ˆæ‰©å±•åï¼‰ï¼Œæ‰©å±•åå¯ä»¥å°†type-cå£è½¬æ¢ä¸ºå…¶ä»–ç±»å‹çš„æ¥å£ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œå®é™…ä¸Šè¿™å°±æ˜¯ä¸€ç§é€‚é…æ¨¡å¼ã€‚\nç”±äºæˆ‘ä»¬çš„ç”µè„‘æ²¡æœ‰è¿™äº›æ¥å£ï¼Œä½†æ˜¯æä¾›äº†type-cç±»å‹çš„æ¥å£ï¼Œè™½ç„¶æ¥å£ç±»å‹ä¸ä¸€æ ·ï¼Œä½†æ˜¯åŒæ ·å¯ä»¥åšå…¶ä»–æ¥å£èƒ½åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚USBæ–‡ä»¶ä¼ è¾“ã€æœ‰çº¿ç½‘ç»œè¿æ¥ç­‰ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªä¸­é—´äººæ¥å¸®æˆ‘ä»¬è½¬æ¢ä¸€ä¸‹æ¥å£å½¢æ€å³å¯ã€‚åŒ…æ‹¬æˆ‘ä»¬å¸¸ç”¨çš„å……ç”µå¤´ï¼Œä¸ºä»€ä¹ˆå«ç”µæºé€‚é…å™¨å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ä¼ ç»Ÿçš„ä¾›ç”µæ˜¯220Väº¤æµç”µï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ‰‹æœºå¯èƒ½åªéœ€è¦5Vçš„ç”µå‹è¿›è¡Œå……ç”µï¼Œè™½ç„¶ç°åœ¨æœ‰ç”µï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥å……ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¯èƒ½è®©ç”µåŠ›å…¬å¸ä¸“é—¨ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ª5Vçš„ç›´æµç”µä½¿ç”¨ã€‚è¿™æ—¶ç”µæºé€‚é…å™¨å°±å¼€å§‹å‘æŒ¥ä½œç”¨äº†ï¼Œæ¯”å¦‚è‹¹æœçš„ç¥–ä¼ 5V1Aå……ç”µå¤´ï¼Œå®é™…ä¸Šå°±æ˜¯å°†220Väº¤æµç”µè½¬æ¢ä¸º5Vçš„ç›´æµç”µè¿›è¡Œä¼ è¾“ï¼Œè¿™æ ·å°±ç›¸å½“äºåœ¨220Väº¤æµç”µå’Œæˆ‘ä»¬çš„æ‰‹æœºä¹‹å‰ï¼Œåšäº†ä¸€ä¸ªé€‚é…å™¨çš„è§’è‰²ã€‚\nåœ¨æˆ‘ä»¬çš„Javaç¨‹åºä¸­ï¼Œä¹Ÿä¼šç»å¸¸é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š\npublic class TestSupplier { //æ‰‹æœºä¾›åº”å•† public String doSupply(){ return \u0026#34;iPhone 14 Pro\u0026#34;; } } public class Main { public static void main(String[] args) { TestSupplier supplier = new TestSupplier(); test( ?","title":"ç»“æ„å‹","type":"doc"},{"content":"ADTæ¨¡å‹\n\u0026lt;--java--\u0026gt; public class ListNode { // ç»“ç‚¹çš„å€¼ int val; // ä¸‹ä¸€ä¸ªç»“ç‚¹ ListNode next; // èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æ— å‚) public ListNode() { } // èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æœ‰ä¸€ä¸ªå‚æ•°) public ListNode(int val) { this.val = val; } // èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æœ‰ä¸¤ä¸ªå‚æ•°) public ListNode(int val, ListNode next) { this.val = val; this.next = next; } } \u0026lt;--Cpp--\u0026gt; struct ListNode{ int val; ListNode *next; ListNode() : val(0), next(nullptr) {} ListNode(int x) : val(x), next(nullptr) {} // èŠ‚ç‚¹çš„æ„é€ å‡½æ•° //æ‰€ä»¥å¦‚æœä¸å®šä¹‰æ„é€ å‡½æ•°ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°çš„è¯ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±ä¸èƒ½ç›´æ¥ç»™å˜é‡èµ‹å€¼ï¼ ListNode(int x, ListNode *next) : val(x), next(next) {} }; // // Created by Rainy-Heights on 2024/3/20. // #include \u0026#34;../cunion.h\u0026#34; /** * Definition for singly-linked list. */ class Solution { public: ListNode* removeElements(ListNode* head, int val) { ListNode *dummyHead=new ListNode(0);//åˆ›å»ºè™šæ‹Ÿå¤´èŠ‚ç‚¹ dummyHead-\u0026gt;next=head;//è™šæ‹Ÿå¤´èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å¤´èŠ‚ç‚¹ ListNode *cur=dummyHead;//å½“å‰èŠ‚ç‚¹,ç”¨äºéå†,ä¸ºäº†èƒ½å¤Ÿåˆ é™¤å¤´èŠ‚ç‚¹ï¼Œéœ€è¦çŸ¥é“å¤´ç»“ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå°±æ˜¯dummyHead //åˆ é™¤ä¸€èˆ¬èŠ‚ç‚¹ while (cur!= NULL\u0026amp;\u0026amp;cur-\u0026gt;next!= NULL){ if (cur-\u0026gt;next-\u0026gt;val==val){ cur-\u0026gt;next=cur-\u0026gt;next-\u0026gt;next; } else{ cur=cur-\u0026gt;next; } } head=dummyHead-\u0026gt;next; delete(dummyHead); //åˆ é™¤å¤´èŠ‚ç‚¹ï¼Œä½¿ç”¨è™šæ‹ŸèŠ‚ç‚¹ return head;//è¿”å›å¤´èŠ‚ç‚¹å³å¯ } }; int main(){ ListNode *node=new ListNode(0); ListNode *head=node; vector\u0026lt;int\u0026gt; v={1,2,6,3,4,5,6}; for (int i = 0; i \u0026lt; 7; ++i) { head-\u0026gt;val=v[i]; cout\u0026lt;\u0026lt;v[i]\u0026lt;\u0026lt;endl; head-\u0026gt;next=new ListNode; head=head-\u0026gt;next; } // head-\u0026gt;initNode(head,8); Solution *solution; ListNode *res=solution-\u0026gt;removeElements(node,6); while (res-\u0026gt;next!= NULL){ cout\u0026lt;\u0026lt;res-\u0026gt;val\u0026lt;\u0026lt;endl; res=res-\u0026gt;next; } } ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E9%93%BE%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/","section":"Algorithms","summary":"ADTæ¨¡å‹\n\u0026lt;--java--\u0026gt; public class ListNode { // ç»“ç‚¹çš„å€¼ int val; // ä¸‹ä¸€ä¸ªç»“ç‚¹ ListNode next; // èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æ— å‚) public ListNode() { } // èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æœ‰ä¸€ä¸ªå‚æ•°) public ListNode(int val) { this.val = val; } // èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æœ‰ä¸¤ä¸ªå‚æ•°) public ListNode(int val, ListNode next) { this.","title":"é“¾è¡¨çš„åŸºæœ¬æ“ä½œ","type":"algorithm"},{"content":"ç¿»è½¬é“¾è¡¨\nclass Solution { public: //ç¿»è½¬é“¾è¡¨ //è¾“å…¥ï¼šhead = [1,2,3,4,5] //è¾“å‡ºï¼š[5,4,3,2,1] //åŒæŒ‡é’ˆæ³• ListNode *reverseList(ListNode *head) { ListNode *cur = head; ListNode *pre = NULL; ListNode *tmp = cur;//ä¿å­˜å˜é‡ while (cur) { tmp = cur-\u0026gt;next;//ä¿å­˜åŸæ¥çš„ä¸‹ä¸€ä¸ªæŒ‡å‘ cur-\u0026gt;next = pre;//å°†ä¸‹ä¸€ä¸ªæŒ‡å‘æ”¹ä¸ºpre pre = cur;//ä¿®æ”¹preå¾€å‰ç§»åŠ¨ä¸€æ ¼ cur = tmp;//ä¿®æ”¹curå¾€å‰ç§»åŠ¨ä¸€æ ¼ } return pre; } //é€’å½’æ³• ListNode *reverse(ListNode *cur,ListNode *pre){ if(cur == NULL) return pre; ListNode *tmp= NULL; tmp=cur-\u0026gt;next; cur-\u0026gt;next=pre; return reverse(tmp,cur); } }; ç¯å½¢é“¾è¡¨\n#include \u0026#34;../cunion.h\u0026#34; class Solution { public: ListNode *detectCycle(ListNode *head) { ListNode * dummyHead=new ListNode(); dummyHead-\u0026gt;next=head; ListNode *fast=dummyHead-\u0026gt;next; ListNode *slow=dummyHead-\u0026gt;next; while (fast!= nullptr\u0026amp;\u0026amp; fast-\u0026gt;next!= nullptr){ fast=fast-\u0026gt;next-\u0026gt;next; slow=slow-\u0026gt;next; if (fast==slow){ ListNode *pos=fast; ListNode *run=head; while (run!=pos){ pos=pos-\u0026gt;next; run=run-\u0026gt;next; } return run; } } return nullptr; } }; äº¤æ¢é“¾è¡¨\n#include \u0026#34;../cunion.h\u0026#34; class Solution { public: //è¾“å…¥ï¼šhead = [1,2,3,4] //è¾“å‡ºï¼š[2,1,4,3] ListNode* swapPairs(ListNode* head) { ListNode *pre=new ListNode(0); pre-\u0026gt;next=head; ListNode *cur=pre; ListNode *tmp=cur; ListNode *tmp1=cur; while (cur-\u0026gt;next != nullptr \u0026amp;\u0026amp; cur-\u0026gt;next-\u0026gt;next != nullptr){ tmp=cur-\u0026gt;next-\u0026gt;next; tmp1=tmp-\u0026gt;next; tmp-\u0026gt;next=cur-\u0026gt;next; cur-\u0026gt;next=tmp1; cur=tmp1; } return pre-\u0026gt;next; } }; é“¾è¡¨ç›¸äº¤\n// // Created by æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ on 2024/3/23. // #include \u0026#34;../cunion.h\u0026#34; class Solution { public: ListNode *getIntersectionNode(ListNode *headA, ListNode *headB) { ListNode *A = headA; ListNode *B = headB; int lenA = len(A); int lenB = len(B); ListNode *curA = headA; ListNode *curB = headB; if (lenA \u0026gt; lenB) { int diff = lenA - lenB; return findInsect(curA,curB,diff); } else if (lenB \u0026gt; lenA) { int diff = lenB - lenA; return findInsect(curB,curA,diff); } else if (lenA == lenB) { return findInsect(curA,curB,0); } return nullptr; } ListNode *findInsect(ListNode *left,ListNode *right,int diff){ while (diff--){ left=left-\u0026gt;next; } if (left!=right){ while (left!= nullptr){ if (left==right){ return left; } left=left-\u0026gt;next; right=right-\u0026gt;next; } } else{ return left; } return nullptr; } int len(ListNode *node) { int len = 0; while (node != nullptr) { node = node-\u0026gt;next; len++; } return len; } }; åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹\n// // Created by æ˜¥æ±ŸèŠ±æœç§‹æœˆå¤œ on 2024/3/21. // //åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹ #include \u0026#34;../cunion.h\u0026#34; class Solution { public: ListNode *removeNthFromEnd(ListNode *head, int n) { ListNode *dummyHead = new ListNode(0, head); int len = 0; ListNode *node = dummyHead-\u0026gt;next; while (node) { len++; node = node-\u0026gt;next; } ListNode *travelNode = dummyHead-\u0026gt;next; //å› ä¸ºæ˜¯é€šè¿‡å€’æ•°æ¥å®ç°è®¡æ•°ï¼Œæ‰€ä»¥ç´¢å¼•ä»1å¼€å§‹ for (int i = 1; i \u0026lt; len - i + 1; ++i) { travelNode = travelNode-\u0026gt;next; } travelNode-\u0026gt;next = travelNode-\u0026gt;next-\u0026gt;next; return dummyHead-\u0026gt;next; } //ä½¿ç”¨åŒæŒ‡é’ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ï¼ï¼ ListNode* removeNthFromEndWithDouble(ListNode* head, int n) { ListNode *dummyHead=new ListNode(0); dummyHead-\u0026gt;next=head;//è™šæ‹Ÿå¤´èŠ‚ç‚¹ ListNode *fast=dummyHead; ListNode *slow=dummyHead; //fastå‘å‰ç§»åŠ¨næ­¥ while (fast!= NULL\u0026amp;\u0026amp;n--){ fast=fast-\u0026gt;next; } fast = fast-\u0026gt;next; // fastå†æå‰èµ°ä¸€æ­¥ï¼Œå› ä¸ºéœ€è¦è®©slowæŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ while (fast != NULL) { fast = fast-\u0026gt;next; slow = slow-\u0026gt;next; } slow-\u0026gt;next=slow-\u0026gt;next-\u0026gt;next; return dummyHead-\u0026gt;next; } }; /** é‡‡ç”¨è™šæ‹Ÿå¤´èŠ‚ç‚¹æ¥è§£å†³çš„æ–¹æ³•ï¼š * ListNode *removeNthFromEnd(ListNode *head, int n) { //ä½¿ç”¨åŒæŒ‡é’ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ï¼ï¼ ListNode *dummyHead = new ListNode(0, head); int len = 0; ListNode *node = dummyHead-\u0026gt;next; while (node) { len++; node = node-\u0026gt;next; } ListNode *travelNode = dummyHead-\u0026gt;next; //å› ä¸ºæ˜¯é€šè¿‡å€’æ•°æ¥å®ç°è®¡æ•°ï¼Œæ‰€ä»¥ç´¢å¼•ä»1å¼€å§‹ for (int i = 1; i \u0026lt; len - i + 1; ++i) { travelNode = travelNode-\u0026gt;next; } travelNode-\u0026gt;next = travelNode-\u0026gt;next-\u0026gt;next; return dummyHead-\u0026gt;next; } */ ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E9%93%BE%E8%A1%A8%E7%AF%87/","section":"Algorithms","summary":"ç¿»è½¬é“¾è¡¨\nclass Solution { public: //ç¿»è½¬é“¾è¡¨ //è¾“å…¥ï¼šhead = [1,2,3,4,5] //è¾“å‡ºï¼š[5,4,3,2,1] //åŒæŒ‡é’ˆæ³• ListNode *reverseList(ListNode *head) { ListNode *cur = head; ListNode *pre = NULL; ListNode *tmp = cur;//ä¿å­˜å˜é‡ while (cur) { tmp = cur-\u0026gt;next;//ä¿å­˜åŸæ¥çš„ä¸‹ä¸€ä¸ªæŒ‡å‘ cur-\u0026gt;next = pre;//å°†ä¸‹ä¸€ä¸ªæŒ‡å‘æ”¹ä¸ºpre pre = cur;//ä¿®æ”¹preå¾€å‰ç§»åŠ¨ä¸€æ ¼ cur = tmp;//ä¿®æ”¹curå¾€å‰ç§»åŠ¨ä¸€æ ¼ } return pre; } //é€’å½’æ³• ListNode *reverse(ListNode *cur,ListNode *pre){ if(cur == NULL) return pre; ListNode *tmp= NULL; tmp=cur-\u0026gt;next; cur-\u0026gt;next=pre; return reverse(tmp,cur); } }; ç¯å½¢é“¾è¡¨","title":"é“¾è¡¨ç¯‡","type":"algorithm"},{"content":"\rå¤„ç†è¾¹ç•Œæ¡ä»¶ï¼Ÿ\nå¾ªç¯ä¸å¯é ï¼æ‰¾åˆ°å¾ªç¯ä¸å˜é‡ï¼\n#include \u0026#34;../cunion.h\u0026#34; class Solution { public: vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; generateMatrix(int n) { int num = 1; //æ³¨æ„è¿™é‡Œæ˜¯å…¨é—­åŒºé—´ vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; matrix(n, vector\u0026lt;int\u0026gt;(n)); int left = 0, right = n - 1, top = 0, bottom = n - 1; while (left \u0026lt;= right \u0026amp;\u0026amp; top \u0026lt;= bottom) { //ä»å·¦å¾€å³ for (int column = left; column \u0026lt;= right; ++column) { matrix[top][column] = num; num++; } for (int row = top + 1; row \u0026lt;= bottom; ++row) { matrix[row][right] = num; num++; } //ä»å³å¾€å·¦ if (left \u0026lt; right \u0026amp;\u0026amp; top \u0026lt; bottom) { for (int column = right - 1; column \u0026gt; left; --column) { matrix[bottom][column] = num; num++; } for (int row = bottom; row \u0026gt; top; --row) { matrix[row][left] = num; num++; } } left++; right--; top++; bottom--; } return matrix; } }; int main() { Solution *solution; vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; vo = solution-\u0026gt;generateMatrix(4); for (int i = 0; i \u0026lt; vo.size(); ++i) { for (int j = 0; j \u0026lt; vo[i].size(); ++j) { printf(\u0026#34;%d \u0026#34;, vo[i][j]); } cout \u0026lt;\u0026lt; endl; } } class Solution { public int[][] generateMatrix(int n) { int [][]matrix=new int[n][n]; int left=0,right=n-1,top=0,bottom=n-1; int num=1; while(left\u0026lt;=right\u0026amp;\u0026amp;top\u0026lt;=bottom){ //ä»å·¦å¾€å³ï¼š for(int column =left;column\u0026lt;=right;column++){ matrix[top][column]=num; num++; } //ä»ä¸Šåˆ°ä¸‹ï¼š for(int row =top+1;row\u0026lt;=bottom;row++){ matrix[row][right]=num; num++; } if(left\u0026lt;right\u0026amp;\u0026amp;top\u0026lt;bottom){ //ä»å³å¾€å·¦ for(int column=right-1;column\u0026gt;left;column--){ matrix[bottom][column]=num; num++; } //ä»ä¸‹åˆ°ä¸Š for(int row=bottom;row\u0026gt;top;row--){ matrix[row][left]=num; num++; } } left++; right--; bottom--; top++; } return matrix; } } ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E8%9E%BA%E6%97%8B%E7%9F%A9%E9%98%B5/%E8%9E%BA%E6%97%8B%E7%9F%A9%E9%98%B5/","section":"Algorithms","summary":"å¤„ç†è¾¹ç•Œæ¡ä»¶ï¼Ÿ\nå¾ªç¯ä¸å¯é ï¼æ‰¾åˆ°å¾ªç¯ä¸å˜é‡ï¼\n#include \u0026#34;../cunion.h\u0026#34; class Solution { public: vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; generateMatrix(int n) { int num = 1; //æ³¨æ„è¿™é‡Œæ˜¯å…¨é—­åŒºé—´ vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; matrix(n, vector\u0026lt;int\u0026gt;(n)); int left = 0, right = n - 1, top = 0, bottom = n - 1; while (left \u0026lt;= right \u0026amp;\u0026amp; top \u0026lt;= bottom) { //ä»å·¦å¾€å³ for (int column = left; column \u0026lt;= right; ++column) { matrix[top][column] = num; num++; } for (int row = top + 1; row \u0026lt;= bottom; ++row) { matrix[row][right] = num; num++; } //ä»å³å¾€å·¦ if (left \u0026lt; right \u0026amp;\u0026amp; top \u0026lt; bottom) { for (int column = right - 1; column \u0026gt; left; --column) { matrix[bottom][column] = num; num++; } for (int row = bottom; row \u0026gt; top; --row) { matrix[row][left] = num; num++; } } left++; right--; top++; bottom--; } return matrix; } }; int main() { Solution *solution; vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; vo = solution-\u0026gt;generateMatrix(4); for (int i = 0; i \u0026lt; vo.","title":"èºæ—‹çŸ©é˜µ","type":"algorithm"},{"content":"\ré¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ #\r**æ³¨æ„ï¼š**æ¨èå®ŒæˆJavaEEé€šå…³è·¯çº¿å†å¼€å§‹å­¦ä¹ ã€‚\næˆ‘ä»¬åœ¨è¿›è¡Œè½¯ä»¶å¼€å‘æ—¶ï¼Œä¸ä»…ä»…éœ€è¦å°†æœ€åŸºæœ¬çš„ä¸šåŠ¡ç»™å®Œæˆï¼Œè¿˜è¦è€ƒè™‘æ•´ä¸ªé¡¹ç›®çš„å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ï¼Œæˆ‘ä»¬å¼€å‘çš„é¡¹ç›®ä¸å•å•éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç»´æŠ¤ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦å…¶ä»–çš„å¼€å‘è€…ä¸€èµ·æ¥è¿›è¡Œå…±åŒç»´æŠ¤ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œåº”è¯¥å°½å¯èƒ½çš„è§„èŒƒã€‚å¦‚æœæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ä¸æ³¨é‡è¿™äº›é—®é¢˜ï¼Œæ•´ä¸ªå›¢é˜Ÿé¡¹ç›®å°±åƒä¸€åº§å±å±±ï¼Œéšç€é¡¹ç›®çš„ä¸æ–­æ‰©å¤§ï¼Œæ•´ä½“ç»“æ„åªä¼šè¶Šæ¥è¶Šé­ã€‚\nç”šè‡³åˆ°æœ€åä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬çš„ç¨‹åºå±…ç„¶æ˜¯ç¨³å®šè¿è¡Œåœ¨BUGä¹‹ä¸Šçš„\u0026hellip;\næ‰€ä»¥ï¼Œä¸ºäº†å°½å¯èƒ½é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œæˆ‘ä»¬å°±æ¥èŠèŠé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ã€‚\nå•ä¸€èŒè´£åŸåˆ™ #\rå•ä¸€èŒè´£åŸåˆ™ï¼ˆSimple Responsibility Pincipleï¼ŒSRPï¼‰æ˜¯æœ€ç®€å•çš„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ï¼Œå®ƒç”¨äºæ§åˆ¶ç±»çš„ç²’åº¦å¤§å°ã€‚\nä¸€ä¸ªå¯¹è±¡åº”è¯¥åªåŒ…å«å•ä¸€çš„èŒè´£ï¼Œå¹¶ä¸”è¯¥èŒè´£è¢«å®Œæ•´åœ°å°è£…åœ¨ä¸€ä¸ªç±»ä¸­ã€‚\næ¯”å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªPeopleç±»ï¼š\n//ä¸€ä¸ªäººç±» public class People { /** * äººç±»ä¼šç¼–ç¨‹ */ public void coding(){ System.out.println(\u0026#34;int mian() {\u0026#34;); System.out.println(\u0026#34; printf(\\\u0026#34;Holle Wrold!\\\u0026#34;);\u0026#34;); System.out.println(\u0026#34;}\u0026#34;); System.out.println(\u0026#34;å•Šå˜ï¼Œæ€ä¹ˆè¿è¡Œä¸èµ·ï¼Ÿæ˜æ˜ç…§ç€è€å¸ˆæ•²çš„å•Š\u0026#34;); } /** * å·¥å‚æ‰“èºä¸ä¹Ÿä¼š */ public void work(){ System.out.println(\u0026#34;çœŸå¼€å¿ƒï¼Œèƒ½è¿›åˆ°å¯ŒåœŸåº·æ‰“èºä¸\u0026#34;); System.out.println(\u0026#34;è¯¶ï¼Œæ€ä¹ˆå·¥å‹éƒ½ææ¡¶è·‘è·¯äº†\u0026#34;); } /** * é€å¤–å–ä¹Ÿä¼š */ public void ride(){ System.out.println(\u0026#34;ä»Šå¤©ç»ˆäºé€šè¿‡ç¾å›¢æœ€ç»ˆé¢ï¼ŒåŠ å…¥äº†æ¢¦å¯ä»¥æ±‚çš„å¤§å‚äº†\u0026#34;); System.out.println(\u0026#34;æ„Ÿè§‰é¢è¯•æŒºç®€å•çš„ï¼Œå°±æ˜¯ä¸çŸ¥é“ä¸ºå•¥æˆ‘åŒå­¦æ˜¯ç°åœºåšä¸€é“åŠ›æ‰£æ¥é›¨æ°´ï¼Œè€Œæˆ‘æ˜¯ç°åœºé—®ä¼šä¸ä¼šéª‘è½¦\u0026#34;); System.out.println(\u0026#34;ï¼ˆè¿«ä¸åŠå¾…ç©¿ä¸Šå¤–å–æœè£…ï¼‰\u0026#34;); } } æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªPeopleç±»å¯ä»¥è¯´æ˜¯åå…«èˆ¬æ­¦è‰ºæ ·æ ·ç²¾é€šäº†ï¼Œå•¥éƒ½ä¼šï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œæˆ‘ä»¬æ¯ä¸ªäººæœ€ç»ˆéƒ½æ˜¯åœ¨è‡ªå·±æ‰€æ“…é•¿çš„é¢†åŸŸå·¥ä½œï¼Œæ‰€è°“é—»é“æœ‰å…ˆåï¼Œæœ¯ä¸šæœ‰ä¸“æ”»ï¼Œä¼šç¼–ç¨‹çš„å°±åº”è¯¥æ˜¯ç¨‹åºå‘˜ï¼Œä¼šæ‰“èºä¸çš„å°±åº”è¯¥æ˜¯å·¥äººï¼Œä¼šé€å¤–å–çš„åº”è¯¥æ˜¯éª‘æ‰‹ï¼Œæ˜¾ç„¶è¿™ä¸ªPeopleå¤ªè¿‡è‡ƒè‚¿ï¼ˆæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä»»æ„ä¸€ç§è¡Œä¸ºéƒ½éœ€è¦ä¿®æ”¹Peopleç±»ï¼Œå®ƒæ‹¥æœ‰ä¸æ­¢ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ï¼‰ï¼Œæ‰€ä»¥æ ¹æ®å•ä¸€èŒè´£åŸåˆ™ï¼Œæˆ‘ä»¬ä¸‹éœ€è¦è¿›è¡Œæ›´æ˜ç¡®çš„åˆ’åˆ†ï¼ŒåŒç§ç±»å‹çš„æ“ä½œæˆ‘ä»¬ä¸€èˆ¬æ‰æ”¾åœ¨ä¸€èµ·ï¼š\nclass Coder{ /** * ç¨‹åºå‘˜ä¼šç¼–ç¨‹ */ public void coding(){ System.out.println(\u0026#34;int mian() {\u0026#34;); System.out.println(\u0026#34; printf(\\\u0026#34;Hello World!\\\u0026#34;)\u0026#34;); System.out.println(\u0026#34;}\u0026#34;); System.out.println(\u0026#34;å•Šå˜ï¼Œæ€ä¹ˆè¿è¡Œä¸èµ·ï¼Ÿæ˜æ˜ç…§ç€è€å¸ˆæ•²çš„å•Š\u0026#34;); } } class Worker{ /** * å·¥äººä¼šæ‰“èºä¸ */ public void work(){ System.out.println(\u0026#34;çœŸå¼€å¿ƒï¼Œèƒ½è¿›åˆ°å¯ŒåœŸåº·æ‰“èºä¸\u0026#34;); System.out.println(\u0026#34;è¯¶ï¼Œæ€ä¹ˆå·¥å‹éƒ½ææ¡¶è·‘è·¯äº†\u0026#34;); } } class Rider { /** * éª‘æ‰‹ä¼šé€å¤–å– */ public void ride(){ System.out.println(\u0026#34;ä»Šå¤©ç»ˆäºé€šè¿‡ç¾å›¢æœ€ç»ˆé¢ï¼ŒåŠ å…¥äº†æ¢¦å¯ä»¥æ±‚çš„å¤§å‚\u0026#34;); System.out.println(\u0026#34;æ„Ÿè§‰é¢è¯•æŒºç®€å•çš„ï¼Œå°±æ˜¯ä¸çŸ¥é“ä¸ºå•¥æˆ‘åŒå­¦æ˜¯ç°åœºåšä¸€é“åŠ›æ‰£æ¥é›¨æ°´ï¼Œæˆ‘æ˜¯ç°åœºé—®ä¼šä¸ä¼šéª‘è½¦\u0026#34;); System.out.println(\u0026#34;ï¼ˆè¿«ä¸åŠå¾…ç©¿ä¸Šå¤–å–æœè£…ï¼‰\u0026#34;); } } æˆ‘ä»¬å°†ç±»çš„ç²’åº¦è¿›è¡Œæ›´è¿‘ä¸€æ­¥çš„åˆ’åˆ†ï¼Œè¿™æ ·å°±å¾ˆæ¸…æ™°äº†ï¼ŒåŒ…æ‹¬æˆ‘ä»¬ä»¥ååœ¨è®¾è®¡Mapperã€Serviceã€Controllerç­‰ç­‰ï¼Œæ ¹æ®ä¸åŒçš„ä¸šåŠ¡è¿›è¡Œåˆ’åˆ†ï¼Œéƒ½å¯ä»¥é‡‡ç”¨å•ä¸€èŒè´£åŸåˆ™ï¼Œä»¥å®ƒä½œä¸ºæˆ‘ä»¬å®ç°é«˜å†…èšä½è€¦åˆçš„æŒ‡å¯¼æ–¹é’ˆã€‚å®é™…ä¸Šæˆ‘ä»¬çš„å¾®æœåŠ¡ä¹Ÿæ˜¯å‚è€ƒäº†å•ä¸€èŒè´£åŸåˆ™ï¼Œæ¯ä¸ªå¾®æœåŠ¡åªåº”æ‹…è´Ÿä¸€ä¸ªèŒè´£ã€‚\nå¼€é—­åŸåˆ™ #\rå¼€é—­åŸåˆ™ï¼ˆOpen Close Principleï¼‰ä¹Ÿæ˜¯é‡è¦çš„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ã€‚\nè½¯ä»¶å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚\nä¸€ä¸ªè½¯ä»¶å®ä½“ï¼Œæ¯”å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚å…¶ä¸­ï¼Œå¯¹æ‰©å±•å¼€æ”¾æ˜¯é’ˆå¯¹æä¾›æ–¹æ¥è¯´çš„ï¼Œå¯¹ä¿®æ”¹å…³é—­æ˜¯é’ˆå¯¹è°ƒç”¨æ–¹æ¥è¯´çš„ã€‚\næ¯”å¦‚æˆ‘ä»¬çš„ç¨‹åºå‘˜åˆ†ä¸ºJavaç¨‹åºå‘˜ã€C#ç¨‹åºå‘˜ã€Cè‰¹ç¨‹åºå‘˜ã€PHPç¨‹åºå‘˜ã€å‰ç«¯ç¨‹åºå‘˜ç­‰ï¼Œè€Œä»–ä»¬è¦åšçš„éƒ½æ˜¯å»æ‰“ä»£ç ï¼Œè€Œå…·ä½“å¦‚ä½•æ‰“ä»£ç æ˜¯æ ¹æ®ä¸åŒè¯­è¨€çš„ç¨‹åºå‘˜æ¥å†³å®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¨‹åºå‘˜æ‰“ä»£ç è¿™ä¸€ä¸ªè¡Œä¸ºæŠ½è±¡æˆä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æˆ–æ˜¯æŠ½è±¡ç±»ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ»¡è¶³äº†å¼€é—­åŸåˆ™çš„ç¬¬ä¸€ä¸ªè¦æ±‚ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œä¸åŒçš„ç¨‹åºå‘˜å¯ä»¥è‡ªç”±åœ°å†³å®šä»–ä»¬è¯¥å¦‚ä½•è¿›è¡Œç¼–ç¨‹ã€‚è€Œå…·ä½“å“ªä¸ªç¨‹åºå‘˜ä½¿ç”¨ä»€ä¹ˆè¯­è¨€æ€ä¹ˆç¼–ç¨‹ï¼Œæ˜¯è‡ªå·±åœ¨è´Ÿè´£ï¼Œä¸éœ€è¦å…¶ä»–ç¨‹åºå‘˜å¹²æ¶‰ï¼Œæ‰€ä»¥æ»¡è¶³ç¬¬äºŒä¸ªè¦æ±‚ï¼šå¯¹ä¿®æ”¹å…³é—­ï¼Œæ¯”å¦‚ï¼š\npublic abstract class Coder { public abstract void coding(); class JavaCoder extends Coder{ @Override public void coding() { System.out.println(\u0026#34;Javaå¤ªå·äº†T_Tï¼Œå¿«å»å­¦Goå§ï¼\u0026#34;); } } class PHPCoder extends Coder{ @Override public void coding() { System.out.println(\u0026#34;PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€\u0026#34;); } } class Cè‰¹Coder extends Coder{ @Override public void coding() { System.out.println(\u0026#34;ç¬‘æ­»ï¼ŒJavaå†ç‰›é€¼åº•å±‚ä¸è¿˜å¾—æ‰¾æˆ‘ï¼Ÿ\u0026#34;); } } } é€šè¿‡æä¾›ä¸€ä¸ªCoderæŠ½è±¡ç±»ï¼Œå®šä¹‰å‡ºç¼–ç¨‹çš„è¡Œä¸ºï¼Œä½†æ˜¯ä¸è¿›è¡Œå®ç°ï¼Œè€Œæ˜¯å¼€æ”¾ç»™å…¶ä»–å…·ä½“ç±»å‹çš„ç¨‹åºå‘˜æ¥å®ç°ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®ä¸åŒçš„ä¸šåŠ¡è¿›è¡Œçµæ´»æ‰©å±•äº†ï¼Œå…·æœ‰è¾ƒå¥½çš„å»¶ç»­æ€§ã€‚\nä¸è¿‡ï¼Œå›é¡¾æˆ‘ä»¬è¿™ä¸€è·¯çš„å­¦ä¹ ï¼Œå¥½åƒå¤„å¤„éƒ½åœ¨ä½¿ç”¨å¼€é—­åŸåˆ™ã€‚\né‡Œæ°æ›¿æ¢åŸåˆ™ #\ré‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰æ˜¯å¯¹å­ç±»å‹çš„ç‰¹åˆ«å®šä¹‰ã€‚å®ƒç”±èŠ­èŠ­æ‹‰Â·åˆ©æ–¯ç§‘å¤«ï¼ˆBarbara Liskovï¼‰åœ¨1987å¹´åœ¨ä¸€æ¬¡ä¼šè®®ä¸Šåä¸º \u0026ldquo;æ•°æ®çš„æŠ½è±¡ä¸å±‚æ¬¡\u0026rdquo; çš„æ¼”è¯´ä¸­é¦–å…ˆæå‡ºã€‚\næ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚\nç®€å•çš„è¯´å°±æ˜¯ï¼Œå­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ï¼š\nå­ç±»å¯ä»¥å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†ä¸èƒ½è¦†ç›–çˆ¶ç±»çš„éæŠ½è±¡æ–¹æ³•ã€‚ å­ç±»å¯ä»¥å¢åŠ è‡ªå·±ç‰¹æœ‰çš„æ–¹æ³•ã€‚ å½“å­ç±»çš„æ–¹æ³•é‡è½½çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„å‰ç½®æ¡ä»¶ï¼ˆå³æ–¹æ³•çš„è¾“å…¥/å…¥å‚ï¼‰è¦æ¯”çˆ¶ç±»æ–¹æ³•çš„è¾“å…¥å‚æ•°æ›´å®½æ¾ã€‚ å½“å­ç±»çš„æ–¹æ³•å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼ˆé‡å†™/é‡è½½æˆ–å®ç°æŠ½è±¡æ–¹æ³•ï¼‰ï¼Œæ–¹æ³•çš„åç½®æ¡ä»¶ï¼ˆå³æ–¹æ³•çš„è¾“å‡º/è¿”å›å€¼ï¼‰è¦æ¯”çˆ¶ç±»æ›´ä¸¥æ ¼æˆ–ä¸çˆ¶ç±»ä¸€æ ·ã€‚ æ¯”å¦‚æˆ‘ä»¬ä¸‹é¢çš„ä¾‹å­ï¼š\npublic abstract class Coder { public void coding() { System.out.println(\u0026#34;æˆ‘ä¼šæ‰“ä»£ç \u0026#34;); } class JavaCoder extends Coder{ /** * å­ç±»é™¤äº†ä¼šæ‰“ä»£ç ä¹‹å¤–ï¼Œè¿˜ä¼šæ‰“æ¸¸æˆ */ public void game(){ System.out.println(\u0026#34;è‰¾æ¬§å°¼äºšæœ€å¼ºç‹è€…å·²ä¸Šå·\u0026#34;); } } } å¯ä»¥çœ‹åˆ°JavaCoderè™½ç„¶ç»§æ‰¿è‡ªCoderï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¯¹çˆ¶ç±»æ–¹æ³•è¿›è¡Œé‡å†™ï¼Œå¹¶ä¸”è¿˜åœ¨çˆ¶ç±»çš„åŸºç¡€ä¸Šè¿›è¡Œé¢å¤–æ‰©å±•ï¼Œç¬¦åˆé‡Œæ°æ›¿æ¢åŸåˆ™ã€‚ä½†æ˜¯æˆ‘ä»¬å†æ¥çœ‹ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ï¼š\npublic abstract class Coder { public void coding() { System.out.println(\u0026#34;æˆ‘ä¼šæ‰“ä»£ç \u0026#34;); } class JavaCoder extends Coder{ public void game(){ System.out.println(\u0026#34;è‰¾æ¬§å°¼äºšæœ€å¼ºç‹è€…å·²ä¸Šå·\u0026#34;); } /** * è¿™é‡Œæˆ‘ä»¬å¯¹çˆ¶ç±»çš„è¡Œä¸ºè¿›è¡Œäº†é‡å†™ï¼Œç°åœ¨å®ƒä¸å†å…·å¤‡çˆ¶ç±»åŸæœ¬çš„èƒ½åŠ›äº† */ public void coding() { System.out.println(\u0026#34;æˆ‘å¯’çª—è‹¦è¯»åå…­å¹´ï¼Œåˆ°æœ€åè¿˜ä¸å¦‚åŸ¹è®­ç­ä¸‰ä¸ªæœˆå‡ºæ¥çš„ç¨‹åºå‘˜\u0026#34;); System.out.println(\u0026#34;æƒ³æ¥æƒ³å»ï¼Œæˆ¿å­è½¦å­ç»“å©šå½©ç¤¼ï¼Œä¸ºä»€ä¹ˆè¿™è¾ˆå­è¦æ´»çš„è¿™ä¹ˆç´¯å‘¢ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;éš¾é“æ¥åˆ°è¿™ä¸–é—´èµ°è¿™ä¸€é­å°±ä¸ºäº†èŠ±ä¸€è¾ˆå­æ—¶é—´ä¹°ä¸ªæˆ¿å­å—ï¼Ÿä¸€ä¸ªäººä¸æ˜¯ä¹Ÿèƒ½æ´»çš„è½»æ¾å¿«ä¹å—ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;æ‘†çƒ‚äº†ï¼Œå•Šå¯¹å¯¹å¯¹\u0026#34;); //å¥½äº†ï¼Œemoç»“æŸï¼Œç»§ç»­å·å§ï¼Œäººç”Ÿå› å¥‹æ–—è€Œç¾ä¸½ï¼Œè¿™ä¸ªä¸–ç•Œè™½ç„¶æ»¡ç›®ç–®ç—ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šç¾å¥½å€¼å¾—æœŸå¾… } } } å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨æˆ‘ä»¬å¯¹çˆ¶ç±»çš„æ–¹æ³•è¿›è¡Œäº†é‡å†™ï¼Œæ˜¾ç„¶ï¼Œçˆ¶ç±»çš„è¡Œä¸ºå·²ç»è¢«æˆ‘ä»¬ç»™è¦†ç›–äº†ï¼Œè¿™ä¸ªå­ç±»å·²ç»ä¸å…·å¤‡çˆ¶ç±»çš„åŸæœ¬çš„è¡Œä¸ºï¼Œå¾ˆæ˜¾ç„¶è¿èƒŒäº†é‡Œæ°æ›¿æ¢åŸåˆ™ã€‚\nè¦æ˜¯ç¨‹åºå‘˜è¿æ•²ä»£ç éƒ½ä¸ä¼šäº†ï¼Œè¿˜èƒ½å«åšç¨‹åºå‘˜å—ï¼Ÿ\næ‰€ä»¥ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¸éœ€è¦å†ç»§æ‰¿è‡ªCoderäº†ï¼Œæˆ‘ä»¬å¯ä»¥æå‡ä¸€ä¸‹ï¼Œå°†æ­¤è¡Œä¸ºå®šä¹‰åˆ°Peopleä¸­ï¼š\npublic abstract class People { public abstract void coding(); //è¿™ä¸ªè¡Œä¸ºè¿˜æ˜¯å®šä¹‰å‡ºæ¥ï¼Œä½†æ˜¯ä¸å®ç° class Coder extends People{ @Override public void coding() { System.out.println(\u0026#34;æˆ‘ä¼šæ‰“ä»£ç \u0026#34;); } } class JavaCoder extends People{ public void game(){ System.out.println(\u0026#34;è‰¾æ¬§å°¼äºšæœ€å¼ºç‹è€…å·²ä¸Šå·\u0026#34;); } public void coding() { System.out.println(\u0026#34;æ‘†çƒ‚äº†ï¼Œå•Šå¯¹å¯¹å¯¹\u0026#34;); } } } é‡Œæ°æ›¿æ¢ä¹Ÿæ˜¯å®ç°å¼€é—­åŸåˆ™çš„é‡è¦æ–¹å¼ä¹‹ä¸€ã€‚\nä¾èµ–å€’è½¬åŸåˆ™ #\rä¾èµ–å€’è½¬åŸåˆ™ï¼ˆDependence Inversion Principleï¼‰ä¹Ÿæ˜¯æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨çš„ï¼Œæœ€æ˜æ˜¾çš„å°±æ˜¯æˆ‘ä»¬çš„Springæ¡†æ¶äº†ã€‚\né«˜å±‚æ¨¡å—ä¸åº”ä¾èµ–äºåº•å±‚æ¨¡å—ï¼Œå®ƒä»¬éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚æŠ½è±¡ä¸åº”ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚\nè¿˜è®°å¾—æˆ‘ä»¬åœ¨æˆ‘ä»¬ä¹‹å‰çš„å­¦ä¹ ä¸­ä¸ºä»€ä¹ˆè¦ä¸€ç›´ä½¿ç”¨æ¥å£æ¥è¿›è¡ŒåŠŸèƒ½å®šä¹‰ï¼Œç„¶åå†å»å®ç°å—ï¼Ÿæˆ‘ä»¬å›é¡¾ä¸€ä¸‹åœ¨ä½¿ç”¨Springæ¡†æ¶ä¹‹å‰çš„æƒ…å†µï¼š\npublic class Main { public static void main(String[] args) { UserController controller = new UserController(); //è¯¥æ€ä¹ˆç”¨å°±è¿™ä¹ˆç”¨ } static class UserMapper { //CRUD... } static class UserService { UserMapper mapper = new UserMapper(); //ä¸šåŠ¡ä»£ç .... } static class UserController { UserService service = new UserService(); //ä¸šåŠ¡ä»£ç .... } } ä½†æ˜¯çªç„¶æœ‰ä¸€å¤©ï¼Œå…¬å¸ä¸šåŠ¡éœ€æ±‚å˜åŒ–ï¼Œç°åœ¨ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡æ“ä½œéœ€è¦ä½¿ç”¨æ–°çš„å®ç°ï¼š\npublic class Main { public static void main(String[] args) { UserController controller = new UserController(); } static class UserMapper { //CRUD... } static class UserServiceNew { //ç”±äºUserServiceNewå‘ç”Ÿå˜åŒ–ï¼Œä¼šç›´æ¥å½±å“åˆ°å…¶ä»–é«˜å±‚æ¨¡å— UserMapper mapper = new UserMapper(); //ä¸šåŠ¡ä»£ç .... } static class UserController { //ç„¯ï¼Œå¹²å˜›æ”¹åº•å±‚å•Šï¼Œæˆ‘è¿™åˆå¾—é‡å†™äº† UserService service = new UserService(); //å“¦è±ï¼ŒåŸæ¥çš„ä¸èƒ½ç”¨äº† UserServiceNew serviceNew = new UserServiceNew(); //åªèƒ½ä¿®æ”¹æˆæ–°çš„äº† //ä¸šåŠ¡ä»£ç .... } } æˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬çš„å„ä¸ªæ¨¡å—ä¹‹é—´å®é™…ä¸Šæ˜¯å…·æœ‰å¼ºå…³è”çš„ï¼Œä¸€ä¸ªæ¨¡å—æ˜¯ç›´æ¥æŒ‡å®šä¾èµ–äºå¦ä¸€ä¸ªæ¨¡å—ï¼Œè™½ç„¶è¿™æ ·ç»“æ„æ¸…æ™°ï¼Œä½†æ˜¯åº•å±‚æ¨¡å—çš„å˜åŠ¨ï¼Œä¼šç›´æ¥å½±å“åˆ°å…¶ä»–ä¾èµ–äºå®ƒçš„é«˜å±‚æ¨¡å—ï¼Œå¦‚æœæˆ‘ä»¬çš„é¡¹ç›®å˜å¾—å¾ˆåºå¤§ï¼Œé‚£ä¹ˆè¿™æ ·çš„ä¿®æ”¹å°†æ˜¯ä¸€åœºç¾éš¾ã€‚\nè€Œæœ‰äº†Springæ¡†æ¶ä¹‹åï¼Œæˆ‘ä»¬çš„å¼€å‘æ¨¡å¼å°±å‘ç”Ÿäº†å˜åŒ–ï¼š\npublic class Main { public static void main(String[] args) { UserController controller = new UserController(); } interface UserMapper { //æ¥å£ä¸­åªåšCRUDæ–¹æ³•å®šä¹‰ } static class UserMapperImpl implements UserMapper { //å®ç°ç±»å®ŒæˆCRUDå…·ä½“å®ç° } interface UserService { //ä¸šåŠ¡ä»£ç å®šä¹‰.... } static class UserServiceImpl implements UserService { @Resource //ç°åœ¨ç”±Springæ¥ä¸ºæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªæŒ‡å®šçš„å®ç°ç±»ï¼Œç„¶åæ³¨å…¥ï¼Œè€Œä¸æ˜¯ç”±æˆ‘ä»¬åœ¨ç±»ä¸­ç¡¬ç¼–ç è¿›è¡ŒæŒ‡å®š UserMapper mapper; //ä¸šåŠ¡ä»£ç å…·ä½“å®ç° } static class UserController { @Resource UserService service; //ç›´æ¥ä½¿ç”¨æ¥å£ï¼Œå°±ç®—ä½ æ”¹å®ç°ï¼Œæˆ‘ä¹Ÿä¸éœ€è¦å†ä¿®æ”¹ä»£ç äº† //ä¸šåŠ¡ä»£ç .... } } å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä½¿ç”¨æ¥å£ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†åŸæœ‰çš„å¼ºå…³è”ç»™å¼±åŒ–ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“æ¥å£ä¸­å®šä¹‰äº†ä»€ä¹ˆæ–¹æ³•ç„¶åå»ä½¿ç”¨å³å¯ï¼Œè€Œå…·ä½“çš„æ“ä½œç”±æ¥å£çš„å®ç°ç±»æ¥å®Œæˆï¼Œå¹¶ç”±Springæ¥ä¸ºæˆ‘ä»¬æ³¨å…¥ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼å»æŒ‡å®šã€‚\næ¥å£éš”ç¦»åŸåˆ™ #\ræ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principle, ISPï¼‰å®é™…ä¸Šæ˜¯å¯¹æ¥å£çš„ç»†åŒ–ã€‚\nå®¢æˆ·ç«¯ä¸åº”ä¾èµ–é‚£äº›å®ƒä¸éœ€è¦çš„æ¥å£ã€‚\næˆ‘ä»¬åœ¨å®šä¹‰æ¥å£çš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„æ§åˆ¶æ¥å£çš„ç²’åº¦ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š\ninterface Device { String getCpu(); String getType(); String getMemory(); } //ç”µè„‘å°±æ˜¯ä¸€ç§ç”µå­è®¾å¤‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å®ç°æ­¤æ¥å£ class Computer implements Device { @Override public String getCpu() { return \u0026#34;i9-12900K\u0026#34;; } @Override public String getType() { return \u0026#34;ç”µè„‘\u0026#34;; } @Override public String getMemory() { return \u0026#34;32G DDR5\u0026#34;; } } //ç”µé£æ‰‡ä¹Ÿç®—æ˜¯ä¸€ç§ç”µå­è®¾å¤‡ class Fan implements Device { @Override public String getCpu() { return null; //å°±ä¸€ä¸ªç ´é£æ‰‡ï¼Œè¿˜éœ€è¦CPUï¼Ÿ } @Override public String getType() { return \u0026#34;é£æ‰‡\u0026#34;; } @Override public String getMemory() { return null; //é£æ‰‡ä¹Ÿä¸éœ€è¦å†…å­˜å§ } } è™½ç„¶æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªDeviceæ¥å£ï¼Œä½†æ˜¯ç”±äºæ­¤æ¥å£çš„ç²’åº¦ä¸å¤Ÿç»†ï¼Œè™½ç„¶æ¯”è¾ƒå¥‘åˆç”µè„‘è¿™ç§è®¾å¤‡ï¼Œä½†æ˜¯ä¸é€‚åˆé£æ‰‡è¿™ç§è®¾å¤‡ï¼Œå› ä¸ºé£æ‰‡å‹æ ¹å°±ä¸éœ€è¦CPUå’Œå†…å­˜ï¼Œæ‰€ä»¥é£æ‰‡å®Œå…¨ä¸éœ€è¦è¿™äº›æ–¹æ³•ã€‚è¿™æ—¶æˆ‘ä»¬å°±å¿…é¡»è¦å¯¹å…¶è¿›è¡Œæ›´ç»†ç²’åº¦çš„åˆ’åˆ†ï¼š\ninterface SmartDevice { //æ™ºèƒ½è®¾å¤‡æ‰æœ‰getCpuå’ŒgetMemory String getCpu(); String getType(); String getMemory(); } interface NormalDevice { //æ™®é€šè®¾å¤‡åªæœ‰getType String getType(); } //ç”µè„‘å°±æ˜¯ä¸€ç§ç”µå­è®¾å¤‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç»§æ‰¿æ­¤æ¥å£ class Computer implements SmartDevice { @Override public String getCpu() { return \u0026#34;i9-12900K\u0026#34;; } @Override public String getType() { return \u0026#34;ç”µè„‘\u0026#34;; } @Override public String getMemory() { return \u0026#34;32G DDR5\u0026#34;; } } //ç”µé£æ‰‡ä¹Ÿç®—æ˜¯ä¸€ç§ç”µå­è®¾å¤‡ class Fan implements NormalDevice { @Override public String getType() { return \u0026#34;é£æ‰‡\u0026#34;; } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å°†æ¥å£è¿›è¡Œäº†ç»†ç²’åº¦çš„åˆ’åˆ†ï¼Œä¸åŒç±»å‹çš„ç”µå­è®¾å¤‡å°±å¯ä»¥æ ¹æ®åˆ’åˆ†å»å®ç°ä¸åŒçš„æ¥å£äº†ã€‚å½“ç„¶ï¼Œä¹Ÿä¸èƒ½åˆ’åˆ†å¾—å¤ªå°ï¼Œè¿˜æ˜¯è¦æ ¹æ®å®é™…æƒ…å†µæ¥è¿›è¡Œå†³å®šã€‚\nåˆæˆå¤ç”¨åŸåˆ™ #\råˆæˆå¤ç”¨åŸåˆ™ï¼ˆComposite Reuse Principleï¼‰çš„æ ¸å¿ƒå°±æ˜¯å§”æ´¾ã€‚\nä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè€Œä¸æ˜¯é€šè¿‡ç»§æ‰¿æ¥è¾¾åˆ°å¤ç”¨çš„ç›®çš„ã€‚\nåœ¨ä¸€ä¸ªæ–°çš„å¯¹è±¡é‡Œé¢ä½¿ç”¨ä¸€äº›å·²æœ‰çš„å¯¹è±¡ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œæ–°çš„å¯¹è±¡é€šè¿‡å‘è¿™äº›å¯¹è±¡çš„å§”æ´¾è¾¾åˆ°å¤ç”¨å·²æœ‰åŠŸèƒ½çš„ç›®çš„ã€‚å®é™…ä¸Šæˆ‘ä»¬åœ¨è€ƒè™‘å°†æŸä¸ªç±»é€šè¿‡ç»§æ‰¿å…³ç³»åœ¨å­ç±»å¾—åˆ°çˆ¶ç±»å·²ç»å®ç°çš„æ–¹æ³•ä¹‹å¤–ï¼ˆæ¯”å¦‚Aç±»å®ç°äº†è¿æ¥æ•°æ®åº“çš„åŠŸèƒ½ï¼Œæ°å·§Bç±»ä¸­ä¹Ÿéœ€è¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç»§æ‰¿æ¥è·å¾—Aå·²ç»å†™å¥½çš„è¿æ¥æ•°æ®åº“çš„åŠŸèƒ½ï¼Œè¿™æ ·å°±èƒ½ç›´æ¥å¤ç”¨Aä¸­å·²ç»å†™å¥½çš„é€»è¾‘ï¼‰æˆ‘ä»¬åº”è¯¥åº”è¯¥ä¼˜å…ˆåœ°å»è€ƒè™‘ä½¿ç”¨åˆæˆçš„æ–¹å¼æ¥å®ç°å¤ç”¨ã€‚\næ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š\nclass A { public void connectDatabase(){ System.out.println(\u0026#34;æˆ‘æ˜¯è¿æ¥æ•°æ®åº“æ“ä½œï¼\u0026#34;); } } class B extends A{ //ç›´æ¥é€šè¿‡ç»§æ‰¿çš„æ–¹å¼ï¼Œå¾—åˆ°Açš„æ•°æ®åº“è¿æ¥é€»è¾‘ public void test(){ System.out.println(\u0026#34;æˆ‘æ˜¯Bçš„æ–¹æ³•ï¼Œæˆ‘ä¹Ÿéœ€è¦è¿æ¥æ•°æ®åº“ï¼\u0026#34;); connectDatabase(); //ç›´æ¥è°ƒç”¨çˆ¶ç±»æ–¹æ³•å°±è¡Œ } } è™½ç„¶è¿™æ ·çœ‹èµ·æ¥æ²¡å•¥æ¯›ç—…ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨æˆ‘ä»¬ä¹‹å‰è¯´çš„é‚£ä¸ªé—®é¢˜ï¼Œè€¦åˆåº¦å¤ªé«˜äº†ã€‚\nå¯ä»¥çœ‹åˆ°é€šè¿‡ç»§æ‰¿çš„æ–¹å¼å®ç°å¤ç”¨ï¼Œæˆ‘ä»¬æ˜¯å°†ç±»Bç›´æ¥æŒ‡å®šç»§æ‰¿è‡ªç±»Açš„ï¼Œé‚£ä¹ˆå¦‚æœæœ‰ä¸€å¤©ï¼Œç”±äºä¸šåŠ¡çš„æ›´æ”¹ï¼Œæˆ‘ä»¬çš„æ•°æ®åº“è¿æ¥æ“ä½œï¼Œä¸å†ç”±Aæ¥è´Ÿè´£ï¼Œè€Œæ˜¯ç”±æ–°æ¥çš„Cå»è´Ÿè´£ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸å°†éœ€è¦å¤ç”¨Aä¸­æ–¹æ³•çš„å­ç±»å…¨éƒ¨è¿›è¡Œä¿®æ”¹ï¼Œå¾ˆæ˜¾ç„¶è¿™æ ·æ˜¯è´¹æ—¶è´¹åŠ›çš„ã€‚\nå¹¶ä¸”è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œé€šè¿‡ç»§æ‰¿å­ç±»ä¼šå¾—åˆ°ä¸€äº›çˆ¶ç±»ä¸­çš„å®ç°ç»†èŠ‚ï¼Œæ¯”å¦‚æŸäº›å­—æ®µæˆ–æ˜¯æ–¹æ³•ï¼Œè¿™æ ·ç›´æ¥æš´éœ²ç»™å­ç±»ï¼Œå¹¶ä¸å®‰å…¨ã€‚\næ‰€ä»¥ï¼Œå½“æˆ‘ä»¬éœ€è¦å®ç°å¤ç”¨æ—¶ï¼Œå¯ä»¥ä¼˜å…ˆè€ƒè™‘ä»¥ä¸‹æ“ä½œï¼š\nclass A { public void connectDatabase(){ System.out.println(\u0026#34;æˆ‘æ˜¯è¿æ¥æ•°æ®åº“æ“ä½œï¼\u0026#34;); } } class B { //ä¸è¿›è¡Œç»§æ‰¿ï¼Œè€Œæ˜¯åœ¨ç”¨çš„æ—¶å€™ç»™æˆ‘ä¸€ä¸ªAï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŠ½è±¡æˆä¸€ä¸ªæ¥å£ï¼Œæ›´åŠ çµæ´» public void test(A a){ System.out.println(\u0026#34;æˆ‘æ˜¯Bçš„æ–¹æ³•ï¼Œæˆ‘ä¹Ÿéœ€è¦è¿æ¥æ•°æ®åº“ï¼\u0026#34;); a.connectDatabase(); //åœ¨é€šè¿‡ä¼ å…¥çš„å¯¹è±¡Aå»æ‰§è¡Œ } } æˆ–æ˜¯ï¼š\nclass A { public void connectDatabase(){ System.out.println(\u0026#34;æˆ‘æ˜¯è¿æ¥æ•°æ®åº“æ“ä½œï¼\u0026#34;); } } class B { A a; public B(A a){ //åœ¨æ„é€ æ—¶å°±æŒ‡å®šå¥½ this.a = a; } public void test(){ System.out.println(\u0026#34;æˆ‘æ˜¯Bçš„æ–¹æ³•ï¼Œæˆ‘ä¹Ÿéœ€è¦è¿æ¥æ•°æ®åº“ï¼\u0026#34;); a.connectDatabase(); //ä¹Ÿæ˜¯é€šè¿‡å¯¹è±¡Aå»æ‰§è¡Œ } } é€šè¿‡å¯¹è±¡ä¹‹é—´çš„ç»„åˆï¼Œæˆ‘ä»¬å°±å¤§å¤§é™ä½äº†ç±»ä¹‹é—´çš„è€¦åˆåº¦ï¼Œå¹¶ä¸”Açš„å®ç°ç»†èŠ‚æˆ‘ä»¬ä¹Ÿä¸ä¼šç›´æ¥å¾—åˆ°äº†ã€‚\nè¿ªç±³ç‰¹æ³•åˆ™ #\rè¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLaw of Demeterï¼‰åˆç§°æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œæ˜¯å¯¹ç¨‹åºå†…éƒ¨æ•°æ®äº¤äº’çš„é™åˆ¶ã€‚\næ¯ä¸€ä¸ªè½¯ä»¶å•ä½å¯¹å…¶ä»–å•ä½éƒ½åªæœ‰æœ€å°‘çš„çŸ¥è¯†ï¼Œè€Œä¸”å±€é™äºé‚£äº›ä¸æœ¬å•ä½å¯†åˆ‡ç›¸å…³çš„è½¯ä»¶å•ä½ã€‚\nç®€å•æ¥è¯´å°±æ˜¯ï¼Œä¸€ä¸ªç±»/æ¨¡å—å¯¹å…¶ä»–çš„ç±»/æ¨¡å—æœ‰è¶Šå°‘çš„äº¤äº’è¶Šå¥½ã€‚å½“ä¸€ä¸ªç±»å‘ç”Ÿæ”¹åŠ¨ï¼Œé‚£ä¹ˆï¼Œä¸å…¶ç›¸å…³çš„ç±»ï¼ˆæ¯”å¦‚ç”¨åˆ°æ­¤ç±»å•¥æ–¹æ³•çš„ç±»ï¼‰éœ€è¦å°½å¯èƒ½å°‘çš„å—å½±å“ï¼ˆæ¯”å¦‚ä¿®æ”¹äº†æ–¹æ³•åã€å­—æ®µåç­‰ï¼Œå¯èƒ½å…¶ä»–ç”¨åˆ°è¿™äº›æ–¹æ³•æˆ–æ˜¯å­—æ®µçš„ç±»ä¹Ÿéœ€è¦è·Ÿç€ä¿®æ”¹ï¼‰è¿™æ ·æˆ‘ä»¬åœ¨ç»´æŠ¤é¡¹ç›®çš„æ—¶å€™ä¼šæ›´åŠ è½»æ¾ä¸€äº›ã€‚\nå…¶å®è¯´ç™½äº†ï¼Œè¿˜æ˜¯é™ä½è€¦åˆåº¦ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š\npublic class Main { public static void main(String[] args) throws IOException { Socket socket = new Socket(\u0026#34;localhost\u0026#34;, 8080); //å‡è®¾æˆ‘ä»¬å½“å‰çš„ç¨‹åºéœ€è¦è¿›è¡Œç½‘ç»œé€šä¿¡ Test test = new Test(); test.test(socket); //ç°åœ¨éœ€è¦æ‰§è¡Œtestæ–¹æ³•æ¥åšä¸€äº›äº‹æƒ… } static class Test { /** * æ¯”å¦‚testæ–¹æ³•éœ€è¦å¾—åˆ°æˆ‘ä»¬å½“å‰Socketè¿æ¥çš„æœ¬åœ°åœ°å€ */ public void test(Socket socket){ System.out.println(\u0026#34;IPåœ°å€ï¼š\u0026#34;+socket.getLocalAddress()); } } } å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ä¸Šé¢è¿™ç§å†™æ³•æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬æä¾›ç›´æ¥æä¾›ä¸€ä¸ªSocketå¯¹è±¡ï¼Œç„¶åå†ç”±testæ–¹æ³•æ¥å–å‡ºIPåœ°å€ï¼Œä½†æ˜¯è¿™æ ·æ˜¾ç„¶è¿èƒŒäº†è¿ªç±³ç‰¹æ³•åˆ™ï¼Œå®é™…ä¸Šè¿™é‡Œçš„testæ–¹æ³•åªéœ€è¦ä¸€ä¸ªIPåœ°å€å³å¯ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ•´ä¸ªSocketå¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯ä¸å…¶ä»–ç±»çš„äº¤äº’å°½å¯èƒ½çš„å°‘ã€‚\nå°±åƒæˆ‘ä»¬åœ¨é¤å…åƒå®Œäº†é¥­ï¼Œåº”è¯¥æ˜¯æˆ‘ä»¬è‡ªå·±æ‰«ç ä»˜æ¬¾ï¼Œè€Œä¸æ˜¯ç›´æ¥æŠŠæ‰‹æœºäº¤ç»™è€æ¿æ¥å¸®ä½ æ“ä½œä»˜æ¬¾ã€‚\nè¦æ˜¯æŸä¸€å¤©ï¼ŒSocketç±»ä¸­çš„è¿™äº›æ–¹æ³•å‘ç”Ÿä¿®æ”¹äº†ï¼Œé‚£æˆ‘ä»¬å°±å¾—è¿å¸¦ç€å»ä¿®æ”¹è¿™äº›ç±»ï¼Œå¾ˆéº»çƒ¦ã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬æ¥æ”¹è¿›æ”¹è¿›ï¼š\npublic class Main { public static void main(String[] args) throws IOException { Socket socket = new Socket(\u0026#34;localhost\u0026#34;, 8080); Test test = new Test(); test.test(socket.getLocalAddress().getHostAddress()); //åœ¨å¤–é¢è§£æå¥½å°±è¡Œäº† } static class Test { public void test(String str){ //ä¸€ä¸ªå­—ç¬¦ä¸²å°±èƒ½æå®šï¼Œå°±æ²¡å¿…è¦ä¸¢æ•´ä¸ªå¯¹è±¡è¿›æ¥ System.out.println(\u0026#34;IPåœ°å€ï¼š\u0026#34;+str); } } } è¿™æ ·ï¼Œç±»ä¸ç±»ä¹‹é—´çš„è€¦åˆåº¦å†æ¬¡é™ä½ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/design/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97---%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%80%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/","section":"Docs","summary":"é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ #\r**æ³¨æ„ï¼š**æ¨èå®ŒæˆJavaEEé€šå…³è·¯çº¿å†å¼€å§‹å­¦ä¹ ã€‚\næˆ‘ä»¬åœ¨è¿›è¡Œè½¯ä»¶å¼€å‘æ—¶ï¼Œä¸ä»…ä»…éœ€è¦å°†æœ€åŸºæœ¬çš„ä¸šåŠ¡ç»™å®Œæˆï¼Œè¿˜è¦è€ƒè™‘æ•´ä¸ªé¡¹ç›®çš„å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ï¼Œæˆ‘ä»¬å¼€å‘çš„é¡¹ç›®ä¸å•å•éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç»´æŠ¤ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦å…¶ä»–çš„å¼€å‘è€…ä¸€èµ·æ¥è¿›è¡Œå…±åŒç»´æŠ¤ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œåº”è¯¥å°½å¯èƒ½çš„è§„èŒƒã€‚å¦‚æœæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ä¸æ³¨é‡è¿™äº›é—®é¢˜ï¼Œæ•´ä¸ªå›¢é˜Ÿé¡¹ç›®å°±åƒä¸€åº§å±å±±ï¼Œéšç€é¡¹ç›®çš„ä¸æ–­æ‰©å¤§ï¼Œæ•´ä½“ç»“æ„åªä¼šè¶Šæ¥è¶Šé­ã€‚\nç”šè‡³åˆ°æœ€åä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬çš„ç¨‹åºå±…ç„¶æ˜¯ç¨³å®šè¿è¡Œåœ¨BUGä¹‹ä¸Šçš„\u0026hellip;\næ‰€ä»¥ï¼Œä¸ºäº†å°½å¯èƒ½é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œæˆ‘ä»¬å°±æ¥èŠèŠé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ã€‚\nå•ä¸€èŒè´£åŸåˆ™ #\rå•ä¸€èŒè´£åŸåˆ™ï¼ˆSimple Responsibility Pincipleï¼ŒSRPï¼‰æ˜¯æœ€ç®€å•çš„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ï¼Œå®ƒç”¨äºæ§åˆ¶ç±»çš„ç²’åº¦å¤§å°ã€‚\nä¸€ä¸ªå¯¹è±¡åº”è¯¥åªåŒ…å«å•ä¸€çš„èŒè´£ï¼Œå¹¶ä¸”è¯¥èŒè´£è¢«å®Œæ•´åœ°å°è£…åœ¨ä¸€ä¸ªç±»ä¸­ã€‚\næ¯”å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªPeopleç±»ï¼š\n//ä¸€ä¸ªäººç±» public class People { /** * äººç±»ä¼šç¼–ç¨‹ */ public void coding(){ System.out.println(\u0026#34;int mian() {\u0026#34;); System.out.println(\u0026#34; printf(\\\u0026#34;Holle Wrold!","title":"é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™","type":"doc"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","section":"Series","summary":"","title":"è®¾è®¡æ¨¡å¼","type":"series"},{"content":"æˆ‘çš„ NeoDB ä¹¦å½±éŸ³æ ‡è®°è®°å½•ã€‚ äººç”Ÿå°±åƒä¸€åœºæ²¡æœ‰å‰§æœ¬çš„ç”µå½±ã€‚çœ‹ä¸€åœºç”µå½±ï¼Œå°±åƒåšäº†ä¸€åœºæ¢¦ï¼Œåƒä¸€æ¬¡è¿œè¡Œï¼Œåƒä½“éªŒäº†åˆ«äººçš„ä¸€ç”Ÿã€‚è¯»ä¹¦ä¸ä¼šå˜èªæ˜ï¼Œä½†è¯»ä¹¦ä¼šè®©ä½ çŸ¥é“è‡ªå·±è ¢ã€‚é‚£äº›å¸ˆé•¿æ²¡æœ‰æ•™ä¼šæˆ‘ä»¬çš„é“ç†ï¼Œä»ä¹¦å½±éŸ³ä¸­ï¼Œæˆ‘ä»¬æ‚„æ‚„åœ°å°±å­¦ä¼šäº†ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/media/","section":"","summary":"æˆ‘çš„ NeoDB ä¹¦å½±éŸ³æ ‡è®°è®°å½•ã€‚ äººç”Ÿå°±åƒä¸€åœºæ²¡æœ‰å‰§æœ¬çš„ç”µå½±ã€‚çœ‹ä¸€åœºç”µå½±ï¼Œå°±åƒåšäº†ä¸€åœºæ¢¦ï¼Œåƒä¸€æ¬¡è¿œè¡Œï¼Œåƒä½“éªŒäº†åˆ«äººçš„ä¸€ç”Ÿã€‚è¯»ä¹¦ä¸ä¼šå˜èªæ˜ï¼Œä½†è¯»ä¹¦ä¼šè®©ä½ çŸ¥é“è‡ªå·±è ¢ã€‚é‚£äº›å¸ˆé•¿æ²¡æœ‰æ•™ä¼šæˆ‘ä»¬çš„é“ç†ï¼Œä»ä¹¦å½±éŸ³ä¸­ï¼Œæˆ‘ä»¬æ‚„æ‚„åœ°å°±å­¦ä¼šäº†ã€‚","title":"ä¹¦å½±éŸ³","type":"sample"},{"content":"\rè®¾è®¡æ¨¡å¼ï¼ˆè¡Œä¸ºå‹ï¼‰ #\rå‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†12ç§è®¾è®¡æ¨¡å¼ï¼Œåˆ†ä¸ºä¸¤ç±»ï¼š\nåˆ›å»ºå‹ï¼šå…³æ³¨å¯¹è±¡åˆ›å»º ç»“æ„å‹ï¼šå…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»“æ„ç»„ç»‡ æˆ‘ä»¬æ¥ç€æ¥çœ‹æœ€åä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯æœ€å¤šçš„ä¸€ç§ï¼Œè¡Œä¸ºå‹è®¾è®¡æ¨¡å¼å…³æ³¨ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œç ”ç©¶ç³»ç»Ÿåœ¨è¿è¡Œæ—¶å¯¹è±¡ä¹‹é—´çš„ç›¸äº’é€šä¿¡ä¸åä½œï¼Œè¿›ä¸€æ­¥æ˜ç¡®å¯¹è±¡çš„èŒè´£ã€‚\nè§£é‡Šå™¨æ¨¡å¼ #\rè¿™ç§æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯è¾ƒå°‘ï¼Œå¾ˆå°‘ä½¿ç”¨çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œè¿™é‡Œæä¸€ä¸‹å°±è¡Œã€‚\nè§£é‡Šå™¨é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯¹æˆ‘ä»¬çš„è¯­è¨€è¿›è¡Œè§£é‡Šï¼Œæ ¹æ®ä¸åŒçš„è¯­ä¹‰æ¥åšä¸åŒçš„äº‹æƒ…ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨SEä¸­å­¦ä¹ çš„åŒæ ˆè®¡ç®—å™¨ï¼Œæ­£æ˜¯æ ¹æ®æˆ‘ä»¬è¾“å…¥çš„ç®—å¼ï¼Œå»è¿›è¡Œè§£æï¼Œå¹¶æ ¹æ®ä¸åŒçš„è¿ç®—ç¬¦æ¥ä¸æ–­è¿›è¡Œè®¡ç®—ã€‚\næ¯”å¦‚æˆ‘ä»¬è¾“å…¥ï¼š1+2*3\né‚£ä¹ˆè®¡ç®—å™¨å°±ä¼šè¿›è¡Œè§£æç„¶åæ ¹æ®è¯­ä¹‰ä¼˜å…ˆè®¡ç®—2*3çš„ç»“æœç„¶ååœ¨è®¡ç®—1+6æœ€åå¾—åˆ°7ï¼Œè¯¦ç»†å®ç°è¯·å‚è€ƒJavaSEç¯‡åŒæ ˆè®¡ç®—å™¨å®ç°ã€‚\næ¨¡æ¿æ–¹æ³•æ¨¡å¼ #\ræ¨¡æ¿æ–¹æ³•æ¨¡å¼æˆ‘ä»¬ä¹‹å‰ä¹Ÿè§åˆ°è¿‡è®¸å¤šï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•ã€‚\næœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡å¯èƒ½éœ€è¦ç»å†å¾ˆå¤šä¸ªæ­¥éª¤æ¥å®Œæˆï¼Œæ¯”å¦‚æˆ‘ä»¬ç”Ÿç—…äº†åœ¨åŒ»é™¢çœ‹ç—…ï¼Œé¦–å…ˆæ˜¯å»é—¨è¯ŠæŒ‚å·ï¼Œç„¶åç­‰å¾…å«å·ï¼Œç„¶åæ˜¯å»æ‰¾åŒ»ç”Ÿçœ‹ç—…ï¼Œç¡®å®šç—…å› åï¼Œå°±æ ¹æ®åŒ»ç”Ÿçš„å¤„æ–¹å»å‰å°å¼€è¯ï¼Œæœ€åä»˜é’±ã€‚è¿™ä¸€æ•´å¥—æµç¨‹çœ‹ä¼¼æ˜¯è§„è§„çŸ©çŸ©çš„ï¼Œä½†æ˜¯åœ¨è¿™å…¶ä¸­ï¼ŒæŸäº›æ­¥éª¤å¹¶ä¸æ˜¯ç¡®å®šçš„ï¼Œæ¯”å¦‚åŒ»ç”Ÿçœ‹ç—…è¿™ä¸€æ­¥ï¼Œç”±äºä¸åŒçš„ç—…å› ï¼Œå¯èƒ½ä¼šè¿›è¡Œä¸åŒçš„å¤„ç†ï¼Œæœ€åå¼€å‡ºæ¥çš„è¯æ–¹ä¹Ÿä¼šä¸åŒï¼Œæ‰€ä»¥ï¼Œæ•´å¥—æµç¨‹ä¸­ï¼Œæœ‰äº›æ“ä½œæ˜¯å›ºå®šçš„ï¼Œæœ‰äº›æ“ä½œå¯èƒ½éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè€Œå®šã€‚\nåœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¯èƒ½æŸäº›æ“ä½œæ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨ç±»ä¸­å¯¹åº”æ–¹æ³•è¿›è¡Œç¼–å†™ï¼Œä½†æ˜¯å¯èƒ½æŸäº›æ“ä½œéœ€è¦è§†æƒ…å†µè€Œå®šï¼Œç”±ä¸åŒçš„å­ç±»å®ç°æ¥å†³å®šï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦è®©è¿™äº›æ“ä½œç”±å­ç±»æ¥å»¶è¿Ÿå®ç°äº†ã€‚ç°åœ¨æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚\næˆ‘ä»¬å…ˆæ¥å†™ä¸ªä¾‹å­ï¼š\n/** * æŠ½è±¡è¯Šæ–­æ–¹æ³•ï¼Œå› ä¸ºç°åœ¨åªçŸ¥é“æŒ‚å·å’Œçœ‹åŒ»ç”Ÿæ˜¯å›ºå®šæ¨¡å¼ï¼Œå‰©ä¸‹çš„å¼€å¤„æ–¹å’Œæ‹¿è¯éƒ½æ˜¯ä¸ç¡®å®šçš„ */ public abstract class AbstractDiagnosis { public void test(){ System.out.println(\u0026#34;ä»Šå¤©å¤´å¥½æ™•ï¼Œä¸æƒ³èµ·åºŠï¼Œå¼€æ‘†ï¼Œå…ˆè·Ÿå…¬å¸è¯·ä¸ªå‡\u0026#34;); System.out.println(\u0026#34;å»åŒ»é™¢çœ‹ç—…äº†~\u0026#34;); System.out.println(\u0026#34;1 \u0026gt;\u0026gt; å…ˆæŒ‚å·\u0026#34;); System.out.println(\u0026#34;2 \u0026gt;\u0026gt; ç­‰å¾…å«å·\u0026#34;); //ç”±äºç°åœ¨ä¸çŸ¥é“è¯¥å¼€ä»€ä¹ˆå¤„æ–¹ï¼Œæ‰€ä»¥åªèƒ½å…ˆå®šä¹‰ä¸€ä¸‹è¡Œä¸ºï¼Œç„¶åå…·ä½“ç”±å­ç±»å®ç° //å¤§è‡´çš„æµç¨‹å…ˆå®šä¹‰å¥½å°±è¡Œ this.prescribe(); this.medicine(); //å¼€è¯åŒç† } public abstract void prescribe(); //å¼€å¤„æ–¹æ“ä½œæ ¹æ®å…·ä½“ç—…ç—‡å†³å®šäº† public abstract void medicine(); //æ‹¿è¯ä¹Ÿæ˜¯æ ¹æ®å…·ä½“çš„å¤„æ–¹å»æ‹¿ } ç°åœ¨æˆ‘ä»¬å®šä¹‰å¥½äº†æŠ½è±¡æ–¹æ³•ï¼Œåªæ˜¯å°†å…·ä½“çš„æµç¨‹å…ˆå®šä¹‰å‡ºæ¥äº†ï¼Œä½†æ˜¯éƒ¨åˆ†æ–¹æ³•éœ€è¦æ ¹æ®å®ç°å†³å®šï¼š\n/** * æ„Ÿå†’ç›¸å…³çš„å…·ä½“å®ç°å­ç±» */ public class ColdDiagnosis extends AbstractDiagnosis{ @Override public void prescribe() { System.out.println(\u0026#34;3 \u0026gt;\u0026gt; ä¸€çœ¼ä¸çœŸï¼Œé‰´å®šä¸ºå‡ï¼Œä½ è¿™ä¸æ˜¯æ„Ÿå†’ï¼Œçº¯ç²¹æ˜¯æƒ³æ‘†çƒ‚\u0026#34;); } @Override public void medicine() { System.out.println(\u0026#34;4 \u0026gt;\u0026gt; å¼€ç‚¹å¤´å­¢å›å»åƒå§\u0026#34;); } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå…·ä½“çš„å®ç°ç±»ï¼Œå¹¶ä¸”ç”±äºçœ‹ç—…çš„é€»è¾‘å·²ç»ç”±çˆ¶ç±»å®šä¹‰å¥½äº†ï¼Œæ‰€ä»¥å­ç±»åªéœ€è¦å®ç°éœ€è¦å®ç°çš„éƒ¨åˆ†å³å¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ç®€å•çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼š\npublic static void main(String[] args) { AbstractDiagnosis diagnosis = new ColdDiagnosis(); diagnosis.test(); } æœ€åæˆ‘ä»¬æ¥çœ‹çœ‹åœ¨JUCä¸­è®²è§£AQSæºç å®ç°ä¸­å‡ºç°çš„ä»£ç ï¼š\npublic final boolean release(int arg) { //AQSçš„é”é‡Šæ”¾æ“ä½œ if (tryRelease(arg)) { //å¯ä»¥çœ‹åˆ°è¿™é‡Œè°ƒç”¨äº†tryReleaseæ–¹æ³•ï¼Œä½†æ˜¯æ­¤æ–¹æ³•å¹¶ä¸æ˜¯åœ¨AQSå®ç°çš„ï¼Œè€Œæ˜¯ä¸åŒçš„é”è‡ªè¡Œå®ç°ï¼Œå› ä¸ºAQSä¹Ÿä¸çŸ¥é“ä½ è¿™ç§ç±»å‹çš„é”åˆ°åº•è¯¥æ€ä¹ˆå»è§£é” Node h = head; if (h != null \u0026amp;\u0026amp; h.waitStatus != 0) unparkSuccessor(h); return true; } return false; } protected boolean tryRelease(int arg) { throw new UnsupportedOperationException(); //AQSä¸­ä¸æ”¯æŒï¼Œéœ€è¦å»¶è¿Ÿåˆ°å…·ä½“çš„å­ç±»å»å®ç° } æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå®é™…ä¸Šéƒ¨åˆ†åŠŸèƒ½çš„å®ç°æ˜¯åœ¨å­ç±»å®Œæˆçš„ï¼š\nprotected final boolean tryRelease(int releases) { //ReentrantLockä¸­çš„AQS Syncå®ç°ç±»ï¼Œå¯¹tryReleaseæ–¹æ³•è¿›è¡Œäº†å…·ä½“å®ç° int c = getState() - releases; if (Thread.currentThread() != getExclusiveOwnerThread()) throw new IllegalMonitorStateException(); boolean free = false; if (c == 0) { free = true; setExclusiveOwnerThread(null); } setState(c); return free; } æ˜¯ä¸æ˜¯ç°åœ¨æ„Ÿè§‰ï¼Œè¿™ç§å±‚å±‚å¥—å¨ƒçš„å†™æ³•ï¼Œå¥½åƒå¹¶ä¸æ˜¯è¿™äº›å¤§ä½¬æ•…æ„ä¸ºäº†è£…é€¼æ‰è¿™æ ·å†™çš„ï¼Œè€Œæ˜¯çœŸçš„åœ¨éµå®ˆè§„èŒƒç¼–å†™ï¼Œè®©ä»£ç æ›´æ˜“æ‡‚ä¸€äº›ï¼Œç”šè‡³ä½ ç°åœ¨å†å›å»æ¨ä¸€éä¼šå‘ç°æ€è·¯éå¸¸æ¸…æ™°ã€‚å½“ç„¶ï¼Œé™¤äº†è¿™é‡Œä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šæ¡†æ¶éƒ½ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ¥è®¾è®¡ç±»ç»“æ„ï¼Œè¿˜è¯·å„ä½å°ä¼™ä¼´è‡ªè¡Œæ¢ç´¢ã€‚\nè´£ä»»é“¾æ¨¡å¼ #\rè´£ä»»é“¾æ¨¡å¼ä¹Ÿéå¸¸å¥½ç†è§£ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„é’‰é’‰å®¡æ‰¹ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€æ¡æµæ°´çº¿ä¸€æ ·çš„æ“ä½œï¼Œç”±ä½ å‘èµ·ç”³è¯·ï¼Œç„¶åç»è¿‡å¤šä¸ªéƒ¨é—¨ä¸»ç®¡å®¡æ‰¹ï¼Œæœ€åæ‰èƒ½é€šè¿‡ï¼Œæ‰€ä»¥ä½ çš„ç”³è¯·è¡¨ç›¸å½“äºæ˜¯åœ¨ä¸€æ¡è´£ä»»é“¾ä¸Šä¼ é€’ã€‚å½“ç„¶é™¤äº†è¿™æ ·çš„ç›´çº¿å‹è´£ä»»é“¾ä¹‹å¤–ï¼Œè¿˜æœ‰ç¯å½¢ã€æ ‘å½¢ç­‰ã€‚\nå®é™…ä¸Šæˆ‘ä»¬ä¹‹å‰ä¹Ÿé‡åˆ°è¿‡å¾ˆå¤šç§è´£ä»»é“¾ï¼Œæ¯”å¦‚JavaWebä¸­å­¦ä¹ çš„Filterè¿‡æ»¤å™¨ï¼Œæ­£æ˜¯é‡‡ç”¨çš„è´£ä»»é“¾æ¨¡å¼ï¼Œé€šè¿‡å°†è¯·æ±‚ä¸€çº§ä¸€çº§ä¸æ–­å‘ä¸‹ä¼ é€’ï¼Œæ¥å¯¹æˆ‘ä»¬æ‰€éœ€è¦çš„è¯·æ±‚è¿›è¡Œè¿‡æ»¤å’Œå¤„ç†ã€‚\nè¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨è´£ä»»é“¾æ¨¡å¼æ¥æ¨¡æ‹Ÿä¸€ä¸ªç®€å•çš„é¢è¯•è¿‡ç¨‹ï¼Œæˆ‘ä»¬é¢è¯•ä¹Ÿæ˜¯ä¸€é¢äºŒé¢ä¸‰é¢è¿™æ ·èµ°çš„æµç¨‹ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆè®¾è®¡ä¸€ä¸‹è´£ä»»é“¾ä¸Šçš„å„ä¸ªå¤„ç†å™¨ï¼š\npublic abstract class Handler { protected Handler successor; //è¿™é‡Œæˆ‘ä»¬å°±è®¾è®¡è´£ä»»é“¾ä»¥å•é“¾è¡¨å½¢å¼å­˜åœ¨ï¼Œè¿™é‡Œå­˜æ”¾åç»§èŠ‚ç‚¹ public Handler connect(Handler successor){ //æ‹¼æ¥åç»­èŠ‚ç‚¹ this.successor = successor; return successor; //è¿™é‡Œè¿”å›åç»§èŠ‚ç‚¹ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä¸€ä¼šé“¾å¼è°ƒç”¨ } public void handle(){ this.doHandle(); //ç”±ä¸åŒçš„å­ç±»å®ç°å…·ä½“å¤„ç†è¿‡ç¨‹ Optional .ofNullable(successor) .ifPresent(Handler::handle); //è´£ä»»é“¾ä¸Šå¦‚æœè¿˜æœ‰åç»§èŠ‚ç‚¹ï¼Œå°±ç»§ç»­å‘ä¸‹ä¼ é€’ } public abstract void doHandle(); //ç»“åˆä¸ŠèŠ‚è¯¾å­¦ä¹ çš„æ¨¡æ¿æ–¹æ³•ï¼Œäº¤ç»™å­ç±»å®ç° } å› ä¸ºé¢è¯•æœ‰å¾ˆå¤šè½®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œåˆ›å»ºå‡ ä¸ªå¤„ç†å™¨çš„å®ç°ï¼š\npublic class FirstHandler extends Handler{ //ç”¨äºä¸€é¢çš„å¤„ç†å™¨ @Override public void doHandle() { System.out.println(\u0026#34;============= ç™½é©¬ç¨‹åºå‘˜ä¸€é¢ ==========\u0026#34;); System.out.println(\u0026#34;1. è°ˆè°ˆä½ å¯¹staticå…³é”®å­—çš„ç†è§£ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;2. å†…éƒ¨ç±»å¯ä»¥è°ƒç”¨å¤–éƒ¨çš„æ•°æ®å—ï¼Ÿå¦‚æœæ˜¯é™æ€çš„å‘¢ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;3. hashCode()æ–¹æ³•æ˜¯æ‰€æœ‰çš„ç±»éƒ½æœ‰å—ï¼Ÿé»˜è®¤è¿”å›çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;ä»¥ä¸Šé—®é¢˜ä¼šçš„ï¼Œå¯ä»¥ä¾æ¬¡æ‰“åœ¨è¯„è®ºåŒº\u0026#34;); } } public class SecondHandler extends Handler{ //äºŒé¢ @Override public void doHandle() { System.out.println(\u0026#34;============= ç™½é©¬ç¨‹åºå‘˜äºŒé¢ ==========\u0026#34;); System.out.println(\u0026#34;1. å¦‚æœæˆ‘ä»¬è‡ªå·±åˆ›å»ºä¸€ä¸ªjava.langåŒ…å¹¶ä¸”ç¼–å†™ä¸€ä¸ªStringç±»ï¼Œèƒ½å¦å®ç°è¦†ç›–JDKé»˜è®¤çš„ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;2. HashMapçš„è´Ÿè½½å› å­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå˜åŒ–è§„å¾‹æ˜¯ä»€ä¹ˆï¼Ÿ\u0026#34;); System.out.println(\u0026#34;3. çº¿ç¨‹æ± çš„è¿ä½œæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ\u0026#34;); System.out.println(\u0026#34;4. ReentrantLockå…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\u0026#34;); System.out.println(\u0026#34;ä»¥ä¸Šé—®é¢˜ä¼šçš„ï¼Œå¯ä»¥ä¾æ¬¡æ‰“åœ¨è¯„è®ºåŒº\u0026#34;); } } public class ThirdHandler extends Handler{ @Override public void doHandle() { System.out.println(\u0026#34;============= ç™½é©¬ç¨‹åºå‘˜ä¸‰é¢ ==========\u0026#34;); System.out.println(\u0026#34;1. synchronizedå…³é”®å­—äº†è§£å—ï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿåº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;2. IOå’ŒNIOçš„åŒºåˆ«åœ¨å“ªé‡Œï¼ŸNIOä¸‰å¤§æ ¸å¿ƒç»„ä»¶ï¼Ÿ\u0026#34;); System.out.println(\u0026#34;3. TCPæ¡æ‰‹å’ŒæŒ¥æ‰‹æµç¨‹ï¼Ÿå°‘ä¸€æ¬¡æ¡æ‰‹å¯ä»¥å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\u0026#34;); System.out.println(\u0026#34;4. æ“ä½œç³»ç»Ÿä¸­PCBæ˜¯åšä»€ä¹ˆçš„ï¼Ÿè¿è¡Œæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ\u0026#34;); System.out.println(\u0026#34;ä»¥ä¸Šé—®é¢˜ä¼šçš„ï¼Œå¯ä»¥ä¾æ¬¡æ‰“åœ¨è¯„è®ºåŒº\u0026#34;); } } è¿™æ ·æˆ‘ä»¬å°±ç¼–å†™å¥½äº†æ¯ä¸€è½®çš„é¢è¯•æµç¨‹ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æ„å»ºä¸€ä¸ªè´£ä»»é“¾äº†ï¼š\npublic static void main(String[] args) { Handler handler = new FirstHandler(); //ä¸€é¢é¦–å½“å…¶å†² handler .connect(new SecondHandler()) //ç»§ç»­è¿æ¥äºŒé¢å’Œä¸‰é¢ .connect(new ThirdHandler()); handler.handle(); //å¼€å§‹é¢è¯• } å¯ä»¥çœ‹åˆ°æœ€åç»“æœä¹Ÿæ˜¯æŒ‰ç…§æˆ‘ä»¬çš„è´£ä»»é“¾æ¥è¿›è¡Œçš„ã€‚\nå‘½ä»¤æ¨¡å¼ #\rå¤§å®¶æœ‰æ²¡æœ‰å‘ç°ç°åœ¨çš„å®¶ç”µéƒ½åœ¨è¶‹å‘äºæ™ºèƒ½åŒ–ï¼Œé€šè¿‡ä¸€ä¸ªä¸­å¤®æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å®¶é‡Œçš„å¾ˆå¤šç”µå™¨è¿›è¡Œæ§åˆ¶ï¼Œæ¯”å¦‚å›½å†…åšçš„æ¯”è¾ƒå¥½çš„å°ç±³æ™ºèƒ½å®¶å±…ç³»åˆ—ï¼Œè¿˜æœ‰Appleçš„HomeKitç­‰ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸€ä¸ªç»ˆç«¯ä¸Šè¿›è¡Œæ“ä½œï¼Œå°±å¯ä»¥éšä¾¿æ§åˆ¶å®¶é‡Œçš„ç”µå™¨ã€‚\næ¯”å¦‚ç°åœ¨æˆ‘ä»¬æœ‰å¾ˆå¤šçš„ç±»ï¼Œå½©ç”µã€å†°ç®±ã€ç©ºè°ƒã€æ´—è¡£æœºã€çƒ­æ°´å™¨ç­‰ï¼Œæ—¢ç„¶ç°åœ¨æˆ‘ä»¬è¦é€šè¿‡ä¸€ä¸ªé¥æ§å™¨å»æ§åˆ¶ä»–ä»¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å°†æ§åˆ¶è¿™äº›ç”µå™¨çš„æŒ‡ä»¤éƒ½ç»™è®¾è®¡å¥½æ‰è¡Œï¼Œå¹¶ä¸”è¿˜ä¸èƒ½æœ‰å¤ªå¼ºçš„å…³è”æ€§ã€‚\næ‰€æœ‰çš„ç”µå™¨è‚¯å®šéœ€è¦é€šè¿‡è“ç‰™æˆ–æ˜¯çº¢å¤–çº¿æ¥å—é¥æ§å™¨å‘é€çš„è¯·æ±‚ï¼Œæ‰€ä»¥æ‰€æœ‰çš„ç”µå™¨éƒ½æ˜¯æ¥æ”¶è€…ï¼š\npublic interface Receiver { void action(); //å…·ä½“è¡Œä¸ºï¼Œè¿™é‡Œå°±å†™ä¸€ä¸ªç®—äº† } æ¥ç€æˆ‘ä»¬è¦æ§åˆ¶è¿™äº›ç”µå™¨ï¼Œé‚£ä¹ˆè‚¯å®šéœ€è¦ä¸€ä¸ªæŒ‡ä»¤æ‰èƒ½æ§åˆ¶ï¼š\npublic abstract class Command { //æŒ‡ä»¤æŠ½è±¡ï¼Œä¸åŒçš„ç”µå™¨æœ‰æŒ‡ä»¤ private final Receiver receiver; protected Command(Receiver receiver){ //æŒ‡å®šæ­¤å‘½ä»¤å¯¹åº”çš„ç”µå™¨ï¼ˆæ¥å—è€…ï¼‰ this.receiver = receiver; } public void execute() { receiver.action(); //æ‰§è¡Œå‘½ä»¤ï¼Œå®é™…ä¸Šå°±æ˜¯è®©æ¥æ”¶è€…å¼€å§‹å¹²æ´» } } æœ€åæˆ‘ä»¬æ¥å®‰æ’ä¸€ä¸ªé¥æ§å™¨ï¼š\npublic class Controller { //é¥æ§å™¨åªéœ€è¦æŠŠæˆ‘ä»¬çš„æŒ‡ä»¤å‘å‡ºå»å°±è¡Œäº† public static void call(Command command){ command.execute(); } } æ¯”å¦‚ç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºè°ƒï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä½œä¸ºæˆ‘ä»¬å‘½ä»¤çš„æ¥æ”¶è€…ï¼š\npublic class AirConditioner implements Receiver{ @Override public void action() { System.out.println(\u0026#34;ç©ºè°ƒå·²å¼€å¯ï¼Œå‘¼å‘¼å‘¼\u0026#34;); } } ç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¼€å¯ç©ºè°ƒçš„å‘½ä»¤ï¼š\npublic class OpenCommand extends Command { public OpenCommand(AirConditioner airConditioner) { super(airConditioner); } } æœ€åæˆ‘ä»¬åªéœ€è¦é€šè¿‡é¥æ§å™¨å‘é€å‡ºå»å°±å¯ä»¥äº†ï¼š\npublic static void main(String[] args) { AirConditioner airConditioner = new AirConditioner(); //å…ˆåˆ›å»ºä¸€ä¸ªç©ºè°ƒ Controller.call(new OpenCommand(airConditioner)); //ç›´æ¥é€šè¿‡é¥æ§å™¨æ¥å‘é€ç©ºè°ƒå¼€å¯å‘½ä»¤ } é€šè¿‡è¿™ç§æ–¹å¼ï¼Œé¥æ§å™¨è¿™ä¸ªè§’è‰²å¹¶ä¸éœ€è¦çŸ¥é“å…·ä½“ä¼šæ‰§è¡Œä»€ä¹ˆï¼Œåªéœ€è¦å‘é€å‘½ä»¤å³å¯ï¼Œé¥æ§å™¨å’Œç”µå™¨çš„å…³è”æ€§å°±ä¸å†é‚£ä¹ˆå¼ºäº†ã€‚\nè¿­ä»£å™¨æ¨¡å¼ #\rè¿­ä»£å™¨æˆ‘ä»¬åœ¨JavaSEç¯‡å°±å·²ç»è®²è§£è¿‡äº†ï¼Œè¿­ä»£å™¨å¯ä»¥è¯´æ˜¯æˆ‘ä»¬å­¦ä¹ Javaè¯­è¨€çš„åŸºç¡€ï¼Œæ²¡æœ‰è¿­ä»£å™¨ï¼Œé›†åˆç±»çš„éå†å°±æˆäº†é—®é¢˜ï¼Œæ­£æ˜¯å› ä¸ºæœ‰è¿­ä»£å™¨çš„å­˜åœ¨ï¼Œæˆ‘ä»¬æ‰èƒ½æ›´åŠ ä¼˜é›…çš„ä½¿ç”¨foreachè¯­æ³•ã€‚\nå›é¡¾æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨è¿­ä»£å™¨çš„åœºæ™¯ï¼š\npublic static void main(String[] args) { List\u0026lt;String\u0026gt; list = Arrays.asList(\u0026#34;AAA\u0026#34;, \u0026#34;BBB\u0026#34;, \u0026#34;CCC\u0026#34;); for (String s : list) { //ä½¿ç”¨foreachè¯­æ³•ç³–è¿›è¡Œè¿­ä»£ï¼Œä¾æ¬¡è·å–æ¯ä¸€ä¸ªå…ƒç´  System.out.println(s); //æ‰“å°ä¸€ä¸‹ } } ç¼–è¯‘ä¹‹åçš„ä»£ç å¦‚ä¸‹ï¼š\npublic static void main(String[] args) { List\u0026lt;String\u0026gt; list = Arrays.asList(\u0026#34;AAA\u0026#34;, \u0026#34;BBB\u0026#34;, \u0026#34;CCC\u0026#34;); Iterator var2 = list.iterator(); //å®é™…ä¸Šè¿™é‡Œæœ¬è´¨æ˜¯é€šè¿‡Listç”Ÿæˆçš„è¿­ä»£å™¨æ¥éå†æˆ‘ä»¬æ¯ä¸ªå…ƒç´ çš„ while(var2.hasNext()) { //åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å…ƒç´ å¯ä»¥è¿­ä»£ï¼Œæ²¡æœ‰å°±false String s = (String)var2.next(); //é€šè¿‡nextæ–¹æ³•å¾—åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡ï¼Œè¿­ä»£å™¨ä¼šå‘åç§»åŠ¨ä¸€ä½ System.out.println(s); //æ‰“å°ä¸€ä¸‹ } } å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨è¿­ä»£å™¨å¯¹Listè¿›è¡Œéå†æ—¶ï¼Œå®é™…ä¸Šå°±åƒä¸€ä¸ªæŒ‡å‘åˆ—è¡¨å¤´éƒ¨çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬é€šè¿‡ä¸æ–­å‘åç§»åŠ¨æŒ‡é’ˆæ¥ä¾æ¬¡è·å–æ‰€æŒ‡å‘çš„å…ƒç´ ï¼š\nè¿™é‡Œï¼Œæˆ‘ä»¬ä¾ç…§JDKæä¾›çš„è¿­ä»£å™¨æ¥å£ï¼ˆJDKå·²ç»ä¸ºæˆ‘ä»¬å®šä¹‰å¥½äº†ä¸€ä¸ªè¿­ä»£å™¨çš„å…·ä½“ç›¸å…³æ“ä½œï¼‰ï¼Œä¹Ÿæ¥è®¾è®¡ä¸€ä¸ªè¿­ä»£å™¨ï¼š\npublic class ArrayCollection\u0026lt;T\u0026gt; { //é¦–å…ˆè®¾è®¡ä¸€ä¸ªç®€å•çš„æ•°ç»„é›†åˆï¼Œä¸€ä¼šæˆ‘ä»¬å°±è¿­ä»£æ­¤é›†åˆå†…çš„å…ƒç´  private final T[] array; //åº•å±‚ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥å­˜æ”¾æ•°æ® private ArrayCollection(T[] array){ //privateæ‰ï¼Œè‡ªå·±ç”¨ this.array = array; } public static \u0026lt;T\u0026gt; ArrayCollection\u0026lt;T\u0026gt; of(T[] array){ //å¼€ä¸ªé™æ€æ–¹æ³•ç›´æ¥å§æ•°ç»„è½¬æ¢æˆArrayCollectionï¼Œå…¶å®å’Œç›´æ¥newä¸€æ ·ï¼Œä½†æ˜¯è¿™æ ·å†™å¥½çœ‹ä¸€ç‚¹ return new ArrayCollection\u0026lt;\u0026gt;(array); } } ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å°†æ•°æ®å­˜æ”¾åœ¨æ­¤é›†åˆä¸­äº†ï¼š\npublic static void main(String[] args) { String[] arr = new String[]{\u0026#34;AAA\u0026#34;, \u0026#34;BBB\u0026#34;, \u0026#34;CCC\u0026#34;, \u0026#34;DDD\u0026#34;}; ArrayCollection\u0026lt;String\u0026gt; collection = ArrayCollection.of(arr); } æ¥ç€æˆ‘ä»¬å°±å¯ä»¥æ¥å®ç°è¿­ä»£å™¨æ¥å£äº†ï¼š\npublic class ArrayCollection\u0026lt;T\u0026gt; implements Iterable\u0026lt;T\u0026gt;{ //å®ç°Iterableæ¥å£è¡¨ç¤ºæ­¤ç±»æ˜¯æ”¯æŒè¿­ä»£çš„ ... @Override public Iterator\u0026lt;T\u0026gt; iterator() { //éœ€è¦å®ç°iteratoræ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œç”¨äºè¿­ä»£æˆ‘ä»¬é›†åˆä¸­çš„å…ƒç´  return new ArrayIterator(); } public class ArrayIterator implements Iterator\u0026lt;T\u0026gt; { //è¿™é‡Œå®ç°ä¸€ä¸ªï¼Œæ³¨æ„åˆ«ç”¨é™æ€ï¼Œéœ€è¦ä½¿ç”¨å¯¹è±¡ä¸­å­˜æ”¾çš„æ•°ç»„ private int cur = 0; //è¿™é‡Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæŒ‡é’ˆè¡¨ç¤ºå½“å‰çš„è¿­ä»£ä½ç½® @Override public boolean hasNext() { //åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´  return cur \u0026lt; array.length; //å¦‚æœæŒ‡é’ˆå¤§äºæˆ–ç­‰äºæ•°ç»„æœ€å¤§é•¿åº¦ï¼Œå°±ä¸èƒ½å†ç»§ç»­äº† } @Override public T next() { //è¿”å›å½“å‰æŒ‡é’ˆä½ç½®çš„å…ƒç´ å¹¶å‘åç§»åŠ¨ä¸€ä½ return array[cur++]; //æ­£å¸¸è¿”å›å¯¹åº”ä½ç½®çš„å…ƒç´ ï¼Œå¹¶å°†æŒ‡é’ˆè‡ªå¢ } } } æ¥ç€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ä¸€ä¸ªç®€å•é›†åˆç±»è¿›è¡Œè¿­ä»£äº†ï¼š\npublic static void main(String[] args) { String[] arr = new String[]{\u0026#34;AAA\u0026#34;, \u0026#34;BBB\u0026#34;, \u0026#34;CCC\u0026#34;, \u0026#34;DDD\u0026#34;}; ArrayCollection\u0026lt;String\u0026gt; collection = ArrayCollection.of(arr); for (String s : collection) { //å¯ä»¥ç›´æ¥ä½¿ç”¨foreachè¯­æ³•ç³–ï¼Œå½“ç„¶æœ€åè¿˜æ˜¯ä¼šå˜æˆè¿­ä»£å™¨è°ƒç”¨ System.out.println(s); } } æœ€åç¼–è¯‘å‡ºæ¥çš„æ ·å­ï¼š\npublic static void main(String[] args) { String[] arr = new String[]{\u0026#34;AAA\u0026#34;, \u0026#34;BBB\u0026#34;, \u0026#34;CCC\u0026#34;, \u0026#34;DDD\u0026#34;}; ArrayCollection\u0026lt;String\u0026gt; collection = ArrayCollection.of(arr); Iterator var3 = collection.iterator(); //é¦–å…ˆè·å–è¿­ä»£å™¨ï¼Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨æˆ‘ä»¬å®ç°çš„iteratoræ–¹æ³• while(var3.hasNext()) { String s = (String)var3.next(); //ç›´æ¥ä½¿ç”¨next()æ–¹æ³•ä¸æ–­å‘ä¸‹è·å– System.out.println(s); } } è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ä¸€ä¸ªè¿­ä»£å™¨æ¥éå†æˆ‘ä»¬çš„å…ƒç´ ã€‚\nä¸­ä»‹è€…æ¨¡å¼ #\råœ¨æ—©æœŸï¼Œæˆ‘ä»¬æƒ³è¦å’Œåˆ«äººè¿›è¡Œè¯­éŸ³èŠå¤©ï¼Œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ç”µè¯çš„æ–¹å¼ï¼Œæˆ‘ä»¬é€šè¿‡æ‹¨æ‰“ä»–äººçš„ç”µè¯å·ç ï¼Œæ¥å»ºç«‹ä¼šè¯ï¼Œä¸è¿‡è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨æƒ³è¦é€šçŸ¥é€šçŸ¥3ä¸ªäººæŸä»¶äº‹æƒ…ï¼Œé‚£ä¹ˆæˆ‘å°±å¾—ä¾æ¬¡ç»™ä¸‰ä¸ªäººæ‰“ç”µè¯ï¼Œç”šè‡³è¿˜ä¼šé‡åˆ°ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æˆ‘ä»¬æ²¡æœ‰æŸä¸ªäººçš„ç”µè¯å·ç ï¼Œä½†æ˜¯å…¶ä»–äººæœ‰ï¼Œè¿™æ—¶è¿˜éœ€è¦å‘ŠçŸ¥è¿™ä¸ªäººå¹¶è¿›è¡Œè½¬å‘Šï¼Œå°±å¾ˆéº»çƒ¦ã€‚\nä½†æ˜¯ç°åœ¨æˆ‘ä»¬æœ‰äº†Facetimeã€æœ‰äº†å¾®ä¿¡ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶è®©å¤šä¸ªäººå‚ä¸åˆ°ç¾¤é€šè¯ä¸­è¿›è¡Œç¾¤èŠï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸éœ€è¦ä¸€ä¸ªä¸€ä¸ªå•ç‹¬è¿›è¡Œé€šè¯æˆ–æ˜¯è½¬è¾¾äº†ã€‚å®é™…ä¸Šæ­£æ˜¯ä¾é äº†ä¸€ä¸ªä¸­é—´å•†ç»™æˆ‘ä»¬æä¾›äº†è¿›è¡Œç¾¤ä½“é€šè¯çš„å¹³å°ï¼Œæˆ‘ä»¬æ‰èƒ½å®ç°æ­¤åŠŸèƒ½ï¼Œè€Œè¿™ä¸ªå¹³å°å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªä¸­é—´äººã€‚åˆæ¯”å¦‚æˆ‘ä»¬æƒ³è¦å»å¤–é¢ç§Ÿæˆ¿ï¼Œä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆçŸ¥é“å“ªé‡Œæœ‰å¯ä»¥ç§Ÿçš„æˆ¿å­å‘¢ï¼Ÿäºæ˜¯æˆ‘ä»¬å°±ä¼šä¸Šå„å¤§ç§Ÿæˆ¿APPä¸Šå»æ‰¾æˆ¿æºï¼ŒåŒæ ·çš„ï¼Œå¦‚æœæˆ‘ä»¬ç°åœ¨æœ‰æˆ¿å­éœ€è¦å‡ºç§Ÿï¼Œæˆ‘ä»¬ä¹Ÿä¸çŸ¥é“è°ä¼šæƒ³è¦ç§Ÿæˆ¿å­ï¼ŒåŒæ ·çš„æˆ‘ä»¬ä¹Ÿä¼šæŠŠæˆ¿å­æŒ‚åœ¨ç§Ÿæˆ¿APPä¸Šå±•ç¤ºï¼Œè€Œå½“æˆ‘ä»¬å»ç§Ÿæˆ¿æ—¶æˆ–æ˜¯å‡ºç§Ÿæ—¶ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªç§°ä¸ºä¸­ä»‹çš„äººæ¥è·Ÿæˆ‘ä»¬å¯¹æ¥ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§ä¸­ä»‹çš„æ¨¡å¼ã€‚\nåœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ï¼Œå¯èƒ½ä¹Ÿä¼šå‡ºç°å¾ˆå¤šçš„å¯¹è±¡ï¼Œä½†æ˜¯è¿™äº›å¯¹è±¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚ï¼Œå¯èƒ½ä¸€ä¸ªå¯¹è±¡è¦åšä»€ä¹ˆäº‹æƒ…å°±å¾—è”ç³»å¥½å‡ ä¸ªå¯¹è±¡ï¼š\nä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸­é—´æä¸€ä¸ªä¸­é—´äººï¼š\nè¿™æ ·å½“æˆ‘ä»¬è¦è”ç³»å…¶ä»–äººæ—¶ï¼Œä¸€å¾‹æ‰¾ä¸­ä»‹å°±å¯ä»¥äº†ï¼Œä¸­ä»‹å­˜å‚¨äº†æ‰€æœ‰äººçš„è”ç³»æ–¹å¼ï¼Œè¿™æ ·å°±ä¸ä¼šåƒä¸Šé¢ä¸€æ ·ä¹±æˆä¸€å›¢äº†ã€‚è¿™é‡Œæˆ‘ä»¬å°±ä»¥æˆ¿äº§ä¸­ä»‹çš„ä¾‹å­æ¥ç¼–å†™ï¼š\npublic class Mediator { //æˆ¿äº§ä¸­ä»‹ private final Map\u0026lt;String, User\u0026gt; userMap = new HashMap\u0026lt;\u0026gt;(); //åœ¨å‡ºå”®çš„æˆ¿å­éœ€è¦å­˜å‚¨ä¸€ä¸‹ public void register(String address, User user){ //å‡ºå”®æˆ¿å±‹çš„äººï¼Œéœ€è¦å‘Šè¯‰ä¸­ä»‹ä»–çš„æˆ¿å±‹åœ¨å“ªé‡Œ userMap.put(address, user); } public User find(String address){ //é€šè¿‡æ­¤æ–¹æ³•æ¥çœ‹çœ‹æœ‰æ²¡æœ‰å¯¹åº”çš„æˆ¿æº return userMap.get(address); } } æ¥ç€å°±æ˜¯ç”¨æˆ·äº†ï¼Œç”¨æˆ·æœ‰ä¸¤ç§è§’è‰²ï¼Œä¸€ç§æ˜¯ç§Ÿæˆ¿ï¼Œä¸€ç§æ˜¯å‡ºç§Ÿï¼š\npublic class User { //ç”¨æˆ·å¯ä»¥æ˜¯å‡ºå”®æˆ¿å±‹çš„ä¸€æ–¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯»æ‰¾æˆ¿å±‹çš„ä¸€æ–¹ String name; String tel; public User(String name, String tel) { this.name = name; this.tel = tel; } public User find(String address, Mediator mediator){ //æ‰¾æˆ¿å­çš„è¯ï¼Œéœ€è¦ä¸€ä¸ªä¸­ä»‹å’Œä½ å…·ä½“æƒ³æ‰¾çš„åœ°æ–¹ return mediator.find(address); } @Override public String toString() { return name+\u0026#34; (ç”µè¯ï¼š\u0026#34;+tel+\u0026#34;)\u0026#34;; } } ç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š\npublic static void main(String[] args) { User user0 = new User(\u0026#34;åˆ˜å¥³å£«\u0026#34;, \u0026#34;10086\u0026#34;); //å‡ºç§Ÿäºº User user1 = new User(\u0026#34;æå…ˆç”Ÿ\u0026#34;, \u0026#34;10010\u0026#34;); //æ‰¾æˆ¿äºº Mediator mediator = new Mediator(); //æˆ‘æ˜¯é»‘å¿ƒä¸­ä»‹ mediator.register(\u0026#34;æˆéƒ½å¸‚æ­¦ä¾¯åŒºå¤©åºœäº”è¡—ç™½é©¬ç¨‹åºå‘˜\u0026#34;, user0); //å…ˆæŠŠæˆ¿å­ç»™ä¸­ä»‹æŒ‚ä¸Šå» User user = user1.find(\u0026#34;æˆéƒ½å¸‚æ­¦ä¾¯åŒºå¤©åºœäº”è¡—ä¸‹ç¡…è°·\u0026#34;, mediator); //å¼€å§‹æ‰¾æˆ¿å­ if(user == null) System.out.println(\u0026#34;æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æˆ¿æº\u0026#34;); user = user1.find(\u0026#34;æˆéƒ½å¸‚æ­¦ä¾¯åŒºå¤©åºœäº”è¡—ç™½é©¬ç¨‹åºå‘˜\u0026#34;, mediator); //å¼€å§‹æ‰¾æˆ¿å­ System.out.println(user); //æˆåŠŸæ‰¾åˆ°å¯¹åº”æˆ¿æº } ä¸­ä»‹è€…æ¨¡å¼ä¼˜åŒ–äº†åŸæœ‰çš„å¤æ‚å¤šå¯¹å¤šå…³ç³»ï¼Œè€Œæ˜¯å°†å…¶ç®€åŒ–ä¸ºä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæ›´å®¹æ˜“ç†è§£ä¸€äº›ã€‚\nå¤‡å¿˜å½•æ¨¡å¼ #\r2021å¹´10æœˆ1æ—¥ä¸‹åˆï¼Œæ²³å—é©»é©¬åº—çš„ä¸€å13å²å¥³ä¸­å­¦ç”Ÿï¼Œå› å’ŒåŒå­¦å‘ç”Ÿä¸æ„‰å¿«å–ä¸‹åŠç“¶ç™¾è‰æ¯ã€‚\n10æœˆ5æ—¥ï¼ŒæŠ¢æ•‘å››å¤©æƒ…å†µæ¶åŒ–ï¼Œå®¶å±æ³£ä¸æˆå£°ç§°â€œè‚ºéƒ¨ä¸€ä¸ªå°æ—¶ä¸€å˜â€ã€‚\n10æœˆ6æ—¥ä¸‹åˆï¼Œæ®æ­¦è­¦æ²³å—çœæ€»é˜ŸåŒ»é™¢æ¶ˆæ¯ï¼Œâ€œç›®å‰å¥³å­©ä»åœ¨åŒ»é™¢æ•‘æ²»ã€‚â€\nå–ä¸‹ç™¾è‰æ¯ï¼Œä¼šç»™ä½ åæ‚”çš„æ—¶é—´ï¼Œä½†æ˜¯ä¸ä¼šç»™ä½ åæ‚”çš„æœºä¼šï¼ˆç™¾è‰æ¯å«æœ‰å‰§æ¯’ç‰©è´¨ï¼Œä¼šç›´æ¥å¯¼è‡´è‚ºéƒ¨çº¤ç»´åŒ–ï¼Œè¿™æ˜¯ä¸å¯é€†çš„ï¼Œä¸€èˆ¬æ­»äº¡è¿‡ç¨‹åœ¨ä¸€å‘¨å·¦å³ï¼Œå³ä½¿å®¶é‡ŒèŠ±äº†å†å¤šçš„é’±ï¼Œæ¥å—äº†å†å¤šçš„æ²»ç–—ï¼Œä¹Ÿæ— æ³•é€†è½¬è¿™ä¸€è¿‡ç¨‹ï¼‰ç›¸ä¿¡å¦‚æœå†ç»™è¿™ä½å°å¥³å­©ä¸€æ¬¡æœºä¼šï¼Œå›åˆ°æ‹¿èµ·ç™¾è‰æ¯çš„é‚£ä¸€åˆ»ï¼Œä¸€å®šä¸ä¼šå†å†²åŠ¨åœ°å–ä¸‹äº†å§ã€‚\nå¤‡å¿˜å½•æ¨¡å¼ï¼Œå°±ä¸ºæˆ‘ä»¬çš„è½¯ä»¶æä¾›äº†ä¸€ä¸ªå¯å›æº¯çš„æ—¶é—´èŠ‚ç‚¹ï¼Œå¯èƒ½æˆ‘ä»¬ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­æŸä¸€æ­¥å‡ºç°äº†é”™è¯¯ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥å›åˆ°ä¹‹å‰çš„æŸä¸ªè¢«ä¿å­˜çš„èŠ‚ç‚¹ä¸Šé‡æ–°æ¥è¿‡ï¼ˆå°±åƒè‰¾å…‹çš„å¤§æ‹›ï¼‰ï¼Œæˆ‘ä»¬å¹³æ—¶ç¼–è¾‘æ–‡æœ¬çš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬ç¼–è¾‘å‡ºç°é”™è¯¯æ—¶ï¼Œå°±éœ€è¦æ’¤å›ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦æŒ‰ä¸‹Ctrl+Zå°±å¯ä»¥å›åˆ°ä¸Šä¸€æ­¥ï¼Œè¿™æ ·å°±å¤§å¤§æ–¹ä¾¿äº†æˆ‘ä»¬çš„æ–‡æœ¬ç¼–è¾‘ã€‚\nå…¶å®å¤‡å¿˜å½•æ¨¡å¼ä¹Ÿå¯ä»¥åº”ç”¨åˆ°æˆ‘ä»¬çš„ç¨‹åºä¸­ï¼Œå¦‚æœä½ å­¦ä¹ è¿‡å®‰å“å¼€å‘ï¼Œå®‰å“ç¨‹åºåœ¨å¾ˆå¤šæƒ…å†µä¸‹éƒ½ä¼šé‡æ–°åŠ è½½Activityï¼Œå®é™…ä¸Šå®‰å“ä¸­Activityçš„onSaveInstanceStateå’ŒonRestoreInstanceStateå°±æ˜¯ç”¨åˆ°äº†å¤‡å¿˜å½•æ¨¡å¼ï¼Œåˆ†åˆ«ç”¨äºä¿å­˜å’Œæ¢å¤ï¼Œè¿™æ ·å°±ç®—é‡æ–°åŠ è½½ä¹Ÿå¯ä»¥æ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚\nè¿™é‡Œæˆ‘ä»¬å°±æ¨¡æ‹Ÿä¸€ä¸‹å¯¹è±¡çš„çŠ¶æ€ä¿å­˜ï¼š\npublic class Student { private String currentWork; //å½“å‰æ­£åœ¨åšçš„äº‹æƒ… private int percentage; //å½“å‰çš„å·¥ä½œå®Œæˆç™¾åˆ†æ¯” public void work(String currentWork) { this.currentWork = currentWork; this.percentage = new Random().nextInt(100); } @Override public String toString() { return \u0026#34;æˆ‘ç°åœ¨æ­£åœ¨åšï¼š\u0026#34;+currentWork+\u0026#34; (è¿›åº¦ï¼š\u0026#34;+percentage+\u0026#34;%)\u0026#34;; } } æ¥ç€æˆ‘ä»¬éœ€è¦ä¿å­˜å®ƒåœ¨æŸä¸€æ—¶åˆ»çš„çŠ¶æ€ï¼Œæˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªçŠ¶æ€ä¿å­˜ç±»ï¼š\npublic class State { final String currentWork; final int percentage; State(String currentWork, int percentage) { //ä»…å¼€æ”¾ç»™åŒä¸€ä¸ªåŒ…ä¸‹çš„Studentç±»ä½¿ç”¨ this.currentWork = currentWork; this.percentage = percentage; } } æ¥ç€æˆ‘ä»¬æ¥å°†çŠ¶æ€çš„ä¿å­˜å’Œæ¢å¤æ“ä½œéƒ½å®ç°ä¸€ä¸‹ï¼š\npublic class Student { ... public State save(){ return new State(currentWork, percentage); } public void restore(State state){ this.currentWork = state.currentWork; this.percentage = state.percentage; } ... } ç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼š\npublic static void main(String[] args) { Student student = new Student(); student.work(\u0026#34;å­¦Java\u0026#34;); //å¼€å§‹å­¦Java System.out.println(student); State savedState = student.save(); //ä¿å­˜ä¸€ä¸‹å½“å‰çš„çŠ¶æ€ student.work(\u0026#34;æ‰“ç”µåŠ¨\u0026#34;); //åˆšæ‰“å¼€Bç«™æ’­æ”¾è§†é¢‘ï¼Œå­¦ä¸€åŠå¼€å§‹æ‘†çƒ‚äº† System.out.println(student); student.restore(savedState); //ä¸¤çº§åè½¬ï¼å›åˆ°ä¸Šä¸€ä¸ªä¿å­˜çš„çŠ¶æ€ System.out.println(student); //å›åˆ°å­¦Javaçš„çŠ¶æ€ } å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶åœ¨å­¦ä¹ Javaçš„è¿‡ç¨‹ä¸­ï¼Œä¸­é€”æ‘†çƒ‚äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ—¶å…‰å€’æµï¼Œå›åˆ°è¿˜æ²¡å¼€å§‹æ‘†çƒ‚çš„æ—¶å€™ï¼Œç»§ç»­å­¦ä¹ Javaï¼š\nä¸è¿‡å¤‡å¿˜å½•æ¨¡å¼ä¸ºäº†å»ä¿å­˜å¯¹è±¡çš„çŠ¶æ€ï¼Œä¼šå ç”¨å¤§é‡çš„èµ„æºï¼Œå°¤å…¶æ˜¯é‚£ç§å±æ€§å¾ˆå¤šçš„å¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦åˆç†çš„ä½¿ç”¨æ‰èƒ½ä¿è¯ç¨‹åºç¨³å®šè¿è¡Œã€‚\nè§‚å¯Ÿè€…æ¨¡å¼ #\rç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œä¸€å¹…æœ‰åºæ‘†æ”¾çš„å¤šç±³è¯ºéª¨ç‰Œï¼Œåœ¨æˆ‘ä»¬æ¨åˆ°ç¬¬ä¸€ä¸ªéª¨ç‰Œæ—¶ï¼Œåé¢çš„éª¨ç‰Œä¼šä¸æ–­åœ°è¢«ä¸Šä¸€ä¸ªéª¨ç‰Œæ¨å€’ï¼š\nåœ¨Javaä¸­ï¼Œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå¯èƒ½å°±ä¼šå½±å“åˆ°å…¶ä»–çš„å¯¹è±¡ï¼Œä¸ä¹‹ç›¸å…³çš„å¯¹è±¡å¯èƒ½ä¹Ÿä¼šè”åŠ¨çš„è¿›è¡Œæ”¹å˜ã€‚è¿˜æœ‰æˆ‘ä»¬ä¹‹å‰é‡åˆ°è¿‡çš„ç›‘å¬å™¨æœºåˆ¶ï¼Œå½“å…·ä½“çš„äº‹ä»¶è§¦å‘æ—¶ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹åˆ›å»ºçš„ç›‘å¬å™¨å°±å¯ä»¥æ‰§è¡Œç›¸å…³çš„é€»è¾‘ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥å®ç°è¿™æ ·çš„åŠŸèƒ½ï¼Œå½“å¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè§‚å¯Ÿè€…èƒ½å¤Ÿç«‹å³è§‚å¯Ÿåˆ°å¹¶è¿›è¡Œä¸€äº›è”åŠ¨æ“ä½œï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…æ¥å£ï¼š\npublic interface Observer { //è§‚å¯Ÿè€…æ¥å£ void update(); //å½“å¯¹è±¡æœ‰æ›´æ–°æ—¶ï¼Œä¼šå›è°ƒæ­¤æ–¹æ³• } æ¥ç€æˆ‘ä»¬æ¥å†™ä¸€ä¸ªæ”¯æŒè§‚å¯Ÿè€…çš„å®ä½“ç±»ï¼š\npublic class Subject { private final Set\u0026lt;Observer\u0026gt; observerSet = new HashSet\u0026lt;\u0026gt;(); public void observe(Observer observer) { //æ·»åŠ è§‚å¯Ÿè€… observerSet.add(observer); } public void modify() { //æ¨¡æ‹Ÿå¯¹è±¡è¿›è¡Œä¿®æ”¹ observerSet.forEach(Observer::update); //å½“å¯¹è±¡å‘ç”Ÿä¿®æ”¹æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…ï¼Œå¹¶è¿›è¡Œæ–¹æ³•å›è°ƒ } } æ¥ç€æˆ‘ä»¬å°±å¯ä»¥æµ‹è¯•ä¸€ä¸‹äº†ï¼š\npublic static void main(String[] args) { Subject subject = new Subject(); subject.observe(() -\u0026gt; System.out.println(\u0026#34;æˆ‘æ˜¯ä¸€å·è§‚å¯Ÿè€…ï¼\u0026#34;)); subject.observe(() -\u0026gt; System.out.println(\u0026#34;æˆ‘æ˜¯äºŒå·è§‚å¯Ÿè€…ï¼\u0026#34;)); subject.modify(); } è¿™æ ·ï¼Œæˆ‘ä»¬å°±ç®€å•å®ç°äº†ä¸€ä¸‹è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå½“ç„¶JDKä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†å®ç°è§‚å¯Ÿè€…æ¨¡å¼ç›¸å…³çš„æ¥å£ï¼š\nimport java.util.Observable; //java.utilåŒ…ä¸‹æä¾›çš„è§‚å¯Ÿè€…æŠ½è±¡ç±» public class Subject extends Observable { //ç»§æ‰¿æ­¤æŠ½è±¡ç±»è¡¨ç¤ºæ”¯æŒè§‚å¯Ÿè€… public void modify(){ System.out.println(\u0026#34;å¯¹å¯¹è±¡è¿›è¡Œä¿®æ”¹ï¼\u0026#34;); this.setChanged(); //å½“å¯¹å¯¹è±¡ä¿®æ”¹åï¼Œéœ€è¦setChangedæ¥è®¾å®šä¸ºå·²ä¿®æ”¹çŠ¶æ€ this.notifyObservers(new Date()); //ä½¿ç”¨notifyObserversæ–¹æ³•æ¥é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€… //æ³¨æ„åªæœ‰å·²ä¿®æ”¹çŠ¶æ€ä¸‹é€šçŸ¥è§‚å¯Ÿè€…æ‰ä¼šæœ‰æ•ˆï¼Œå¹¶ä¸”å¯ä»¥ç»™è§‚å¯Ÿè€…ä¼ é€’å‚æ•°ï¼Œè¿™é‡Œä¼ é€’äº†ä¸€ä¸ªæ—¶é—´å¯¹è±¡ } } æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼š\npublic static void main(String[] args) { Subject subject = new Subject(); subject.addObserver((o, arg) -\u0026gt; System.out.println(\u0026#34;ç›‘å¬åˆ°å˜åŒ–ï¼Œå¹¶å¾—åˆ°å‚æ•°ï¼š\u0026#34;+arg)); //æ³¨æ„è¿™é‡Œçš„Observeræ˜¯java.utilåŒ…ä¸‹æä¾›çš„ subject.modify(); //è¿›è¡Œä¿®æ”¹æ“ä½œ } çŠ¶æ€æ¨¡å¼ #\råœ¨æ ‡å‡†å¤§æ°”å‹ä¸‹ï¼Œæ°´åœ¨0åº¦æ—¶ä¼šç»“å†°å˜æˆå›ºæ€ï¼Œåœ¨0-100åº¦ä¹‹é—´æ—¶ï¼Œä¼šå‘ˆç°æ¶²æ€ï¼Œ100åº¦ä»¥ä¸Šä¼šå˜æˆæ°”æ€ï¼Œæ°´è¿™ç§ç‰©è´¨åœ¨ä¸åŒçš„æ¸©åº¦ä¸‹å‘ˆç°å‡ºä¸åŒçš„çŠ¶æ€ï¼Œè€Œæˆ‘ä»¬çš„å¯¹è±¡ï¼Œå¯èƒ½ä¹Ÿä¼šåƒè¿™æ ·å­˜åœ¨å¾ˆå¤šç§çŠ¶æ€ï¼Œç”šè‡³åœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ä¼šæœ‰ä¸åŒçš„è¡Œä¸ºï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡çŠ¶æ€æ¨¡å¼æ¥å®ç°ã€‚\næˆ‘ä»¬æ¥è®¾è®¡ä¸€ä¸ªå­¦ç”Ÿç±»ï¼Œç„¶åå­¦ç”Ÿçš„å­¦ä¹ æ–¹æ³•ä¼šæ ¹æ®çŠ¶æ€ä¸åŒè€Œå‘ç”Ÿæ”¹å˜ï¼Œæˆ‘ä»¬å…ˆè®¾è®¡ä¸€ä¸ªçŠ¶æ€æšä¸¾ï¼š\npublic enum State { //çŠ¶æ€ç›´æ¥ä½¿ç”¨æšä¸¾å®šä¹‰ NORMAL, LAZY } æ¥ç€æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªå­¦ç”Ÿç±»ï¼š\npublic class Student { public class Student { private State state; //ä½¿ç”¨ä¸€ä¸ªæˆå‘˜æ¥å­˜å‚¨çŠ¶æ€ public void setState(State state) { this.state = state; } public void study(){ switch (state) { //æ ¹æ®ä¸åŒçš„çŠ¶æ€ï¼Œå­¦ä¹ æ–¹æ³•ä¼šæœ‰ä¸åŒçš„ç»“æœ case LAZY: System.out.println(\u0026#34;åªè¦æˆ‘ä¸åŠªåŠ›ï¼Œè€æ¿å°±åˆ«æƒ³è¿‡ä¸Šæƒ³è¦çš„ç”Ÿæ´»ï¼Œå¼€æ‘†ï¼\u0026#34;); break; case NORMAL: System.out.println(\u0026#34;æ‹¼æç™¾å¤©ï¼Œæˆ‘è¦ä¸Šæ¸…åå¤§å­¦ï¼\u0026#34;); break; } } } æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œåœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ï¼Œæ˜¯å¦å­¦ä¹ ä¼šå‡ºç°ä¸åŒçš„æ•ˆæœï¼š\npublic static void main(String[] args) { Student student = new Student(); student.setState(State.NORMAL); //å…ˆæ­£å¸¸æ¨¡å¼ student.study(); student.setState(State.LAZY); //å¼€å¯æ‘†çƒ‚æ¨¡å¼ student.study(); } çŠ¶æ€æ¨¡å¼æ›´åŠ å¼ºè°ƒå½“å‰çš„å¯¹è±¡æ‰€å¤„çš„çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å¯¹è±¡ä¸åŒçš„çŠ¶æ€å†³å®šå…¶ä»–çš„å¤„ç†é€»è¾‘ã€‚\nç­–ç•¥æ¨¡å¼ #\rå¯¹é¢å¡å…¹å…‹æ‰“é‡è¢«å¼€äº†ï¼Œæˆ‘ä»¬æ˜¯å»æ‰“å°é¾™è¿˜æ˜¯æ‰“å¤§é¾™å‘¢ï¼Ÿè¿™å°±è¦çœ‹æˆ‘ä»¬å›¢é˜Ÿè¿™ä¸€å±€çš„æ‰“æ³•ç­–ç•¥äº†ã€‚\næˆ‘ä»¬å¯ä»¥ä¸ºå¯¹è±¡è®¾å®šä¸€ç§ç­–ç•¥ï¼Œè¿™æ ·å¯¹è±¡ä¹‹åçš„è¡Œä¸ºå°±ä¼šæŒ‰ç…§æˆ‘ä»¬åœ¨ä¸€å¼€å§‹æŒ‡å®šçš„ç­–ç•¥è€Œå†³å®šäº†ï¼Œçœ‹èµ·æ¥å’Œå‰é¢çš„çŠ¶æ€æ¨¡å¼å¾ˆåƒï¼Œä½†æ˜¯ï¼Œå®ƒä¸çŠ¶æ€æ¨¡å¼çš„åŒºåˆ«åœ¨äºï¼Œè¿™ç§è½¬æ¢æ˜¯â€œä¸»åŠ¨â€çš„ï¼Œæ˜¯ç”±æˆ‘ä»¬å»æŒ‡å®šï¼Œè€ŒçŠ¶æ€æ¨¡å¼ï¼Œå¯èƒ½æ˜¯åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨åˆ‡æ¢çš„ã€‚\nå…¶å®ç­–ç•¥æ¨¡å¼æˆ‘ä»¬ä¹‹å‰ä¹Ÿé‡åˆ°è¿‡ï¼Œæ¯”å¦‚çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥ï¼š\npublic static void main(String[] args) { ThreadPoolExecutor executor = new ThreadPoolExecutor(1, 1, 10, TimeUnit.SECONDS, new SynchronousQueue\u0026lt;\u0026gt;(), //è¿™é‡Œä¸ç»™æ’é˜Ÿ new ThreadPoolExecutor.AbortPolicy()); //å½“çº¿ç¨‹æ± æ— æ³•å†ç»§ç»­åˆ›å»ºæ–°ä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±å†³å®šä½¿ç”¨ä»€ä¹ˆæ‹’ç»ç­–ç•¥ Runnable runnable = () -\u0026gt; { try { TimeUnit.SECONDS.sleep(60); } catch (InterruptedException e) { throw new RuntimeException(e); } }; executor.execute(runnable); //è¿ç»­æäº¤ä¸¤æ¬¡ä»»åŠ¡ï¼Œè‚¯å®šå¡ä¸ä¸‹ï¼Œè¿™æ—¶å°±å¾—èµ°æ‹’ç»äº† executor.execute(runnable); } å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¦‚æœä½¿ç”¨AbortPolicyï¼Œé‚£ä¹ˆå°±æ˜¯ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼š\næˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ç­–ç•¥ï¼š\npublic static void main(String[] args) { ThreadPoolExecutor executor = new ThreadPoolExecutor(1, 1, 10, TimeUnit.SECONDS, new SynchronousQueue\u0026lt;\u0026gt;(), new ThreadPoolExecutor.DiscardOldestPolicy()); //ä½¿ç”¨DiscardOldestPolicyç­–ç•¥ä»é˜Ÿåˆ—ä¸­ä¸¢å¼ƒ è¿™ç§ç­–ç•¥å°±ä¼šä»ç­‰å¾…é˜Ÿåˆ—ä¸­è¸¢å‡ºä¸€ä¸ªä¹‹å‰çš„ï¼Œä¸è¿‡æˆ‘ä»¬è¿™é‡Œçš„ç­‰å¾…é˜Ÿåˆ—æ˜¯æ²¡æœ‰å®¹é‡çš„é‚£ç§ï¼Œæ‰€ä»¥ä¼šç›´æ¥ç‚¸æ‰ï¼š\nè‡³äºå…·ä½“åŸå› ï¼Œå¯ä»¥å›å»çœ‹çœ‹JUCç¯‡è§†é¢‘æ•™ç¨‹ã€‚\nå†æ¯”å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªæ’åºç±»ï¼Œä½†æ˜¯æ ¹æ®ä¸åŒçš„ç­–ç•¥ï¼Œä¼šä½¿ç”¨ä¸åŒçš„æ’åºæ–¹æ¡ˆï¼š\npublic interface Strategy { //ç­–ç•¥æ¥å£ï¼Œä¸åŒçš„ç­–ç•¥å®ç°ä¹Ÿä¸åŒ Strategy SINGLE = Arrays::sort; //å•çº¿ç¨‹æ’åºæ–¹æ¡ˆ Strategy PARALLEL = Arrays::parallelSort; //å¹¶è¡Œæ’åºæ–¹æ¡ˆ void sort(int[] array); } ç°åœ¨æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæ’åºç±»ï¼š\npublic class Sorter { private Strategy strategy; //ç­–ç•¥ public void setStrategy(Strategy strategy) { this.strategy = strategy; } public void sort(int[] array){ strategy.sort(array); } } ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æŒ‡å®šä¸åŒçš„ç­–ç•¥è¿›è¡Œæ’åºäº†ï¼š\npublic static void main(String[] args) { Sorter sorter = new Sorter(); sorter.setStrategy(Strategy.PARALLEL); //æŒ‡å®šä¸ºå¹¶è¡Œæ’åºæ–¹æ¡ˆ sorter.sort(new int[]{9, 2, 4, 5, 1, 0, 3, 7}); } è®¿é—®è€…æ¨¡å¼ #\rå…¬å›­ä¸­å­˜åœ¨å¤šä¸ªæ™¯ç‚¹ï¼Œä¹Ÿå­˜åœ¨å¤šä¸ªæ¸¸å®¢ï¼Œä¸åŒçš„æ¸¸å®¢å¯¹åŒä¸€ä¸ªæ™¯ç‚¹çš„è¯„ä»·å¯èƒ½ä¸åŒï¼›åŒ»é™¢åŒ»ç”Ÿå¼€çš„å¤„æ–¹å•ä¸­åŒ…å«å¤šç§è¯å…ƒç´ ï¼ŒæŸ»çœ‹å®ƒçš„åˆ’ä»·å‘˜å’Œè¯æˆ¿å·¥ä½œäººå‘˜å¯¹å®ƒçš„å¤„ç†æ–¹å¼ä¹Ÿä¸åŒï¼Œåˆ’ä»·å‘˜æ ¹æ®å¤„æ–¹å•ä¸Šé¢çš„è¯å“åå’Œæ•°é‡è¿›è¡Œåˆ’ä»·ï¼Œè¯æˆ¿å·¥ä½œäººå‘˜æ ¹æ®å¤„æ–¹å•çš„å†…å®¹è¿›è¡ŒæŠ“è¯ï¼Œç›¸å¯¹äºå¤„æ–¹å•æ¥è¯´ï¼Œåˆ’ä»·å‘˜å’Œè¯æˆ¿å·¥ä½œäººå‘˜å°±æ˜¯å®ƒçš„è®¿é—®è€…ï¼Œä¸è¿‡è®¿é—®è€…çš„è®¿é—®æ–¹å¼å¯èƒ½ä¼šä¸åŒã€‚\nåœ¨æˆ‘ä»¬çš„Javaç¨‹åºä¸­ï¼Œä¹Ÿå¯èƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è®¿é—®è€…æ¨¡å¼æ¥è¿›è¡Œè®¾è®¡ã€‚\næ¯”å¦‚æˆ‘ä»¬æ—¥ä»¥ç»§å¤œåœ°åŠªåŠ›ï¼Œç»ˆäºåœ¨æŸæŸæ¯”èµ›èµ¢å¾—äº†å† å†›ï¼Œè€Œä¸åŒçš„äººå¯¹äºè¿™åˆ†è£èª‰ï¼Œå´æœ‰ç€ä¸åŒçš„ååº”ï¼š\npublic class Prize { //å¥– String name; //æ¯”èµ›åç§° String level; //ç­‰çº§ public Prize(String name, String level) { this.name = name; this.level = level; } public String getName() { return name; } public String getLevel() { return level; } } æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªè®¿é—®è€…æ¥å£ï¼š\npublic interface Visitor { void visit(Prize prize); //visitæ–¹æ³•æ¥è®¿é—®æˆ‘ä»¬çš„å¥–é¡¹ } ç„¶åå°±æ˜¯è®¿é—®è€…ç›¸å…³çš„å®ç°äº†ï¼š\npublic class Teacher implements Visitor { //æŒ‡å¯¼è€å¸ˆä½œä¸ºä¸€ä¸ªè®¿é—®è€… @Override public void visit(Prize prize) { //å®ƒåªå…³å¿ƒä½ å¾—äº†ä»€ä¹ˆå¥–ä»¥åŠæ˜¯å‡ ç­‰å¥–ï¼Œè¿™ä¹Ÿå…³ä¹è€å¸ˆçš„è£èª‰ System.out.println(\u0026#34;ä½ å¾—å¥–æ˜¯ä»€ä¹ˆå¥–ï¼Ÿ\u0026#34;+prize.name); System.out.println(\u0026#34;ä½ å¾—äº†å‡ ç­‰å¥–ï¼Ÿ\u0026#34;+prize.level); } } public class Boss implements Visitor{ //ä½ çš„å…¬å¸è€æ¿ä½œä¸ºä¸€ä¸ªè®¿é—®è€… @Override public void visit(Prize prize) { //ä½ çš„è€æ¿åªå…³å¿ƒè¿™äº›èƒ½ä¸èƒ½ä¸ºå…¬å¸å¸¦æ¥ä»€ä¹ˆæ•ˆç›Šï¼Œå¥–æœ¬èº«å¹¶ä¸é‡è¦ System.out.println(\u0026#34;ä½ çš„å¥–é¡¹å¤§ä¹ˆï¼Œèƒ½å¤Ÿä¸ºå…¬å¸å¸¦æ¥ä»€ä¹ˆæ•ˆç›Šä¹ˆï¼Ÿ\u0026#34;); System.out.println(\u0026#34;è¿˜ä¸å¦‚è€è€å®å®åŠ ç­ç»™æˆ‘å¤šå¹²å¹²ï¼Œåˆ«å»æè¿™äº›æ²¡ç”¨çš„\u0026#34;); } } public class Classmate implements Visitor{ //ä½ çš„åŒå­¦ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªè®¿é—®è€… @Override public void visit(Prize prize) { //ä½ çš„åŒå­¦ä¹Ÿå…³å¿ƒä½ å¾—äº†ä»€ä¹ˆå¥–ï¼Œä¸è¿‡æ˜¯å› ä¸ºä½ æ˜¯ä»–çš„å¥–å­¦é‡‘ç«äº‰å¯¹æ‰‹ï¼Œä»–å…¶å®å¹¶ä¸å¸Œæœ›ä½ å¾—å¥– System.out.println(\u0026#34;ä½ å¾—äº†\u0026#34;+prize.name+\u0026#34;å¥–å•Šï¼Œè¿˜å¯ä»¥\u0026#34;); System.out.println(\u0026#34;ä¸è¿‡è¿™ä¸ªå¥–æ²¡ä»€ä¹ˆå«é‡‘é‡ï¼Œä¸‹æ¬¡åˆ«å»äº†\u0026#34;); } } public class Family implements Visitor{ //ä½ çš„å®¶äººä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè®¿é—®è€… @Override public void visit(Prize prize) { //ä½ çš„å®¶äººå¹¶ä¸æ˜¯æœ€å…³å¿ƒä½ å¾—äº†ä»€ä¹ˆå¥–ï¼Œè€Œæ˜¯å…ˆå…³å¿ƒä½ è‡ªå·±ç„¶åæ‰æ˜¯å¥–é¡¹ï¼Œä»–ä»¬æ‰æ˜¯çœŸæ­£å¸Œæœ›ä½ å¥½çš„äººã€‚è¿™ä¸ªä¸–ç•Œå¾ˆæ®‹é…·ï¼Œå¯èƒ½ä½ ä¼šè¢«æ¬ºè´Ÿå¾—éä½“é³ä¼¤ï¼Œå¯èƒ½ä½ ä¼šè§‰å¾—æ´»ç€å¦‚æ­¤è‰°éš¾ï¼Œä½†æ˜¯ä½ çš„èƒŒåè‡³å°‘è¿˜æœ‰çˆ±ä½ çš„äººï¼Œä¸ºäº†ä»–ä»¬ï¼Œæ€èƒ½å°±æ­¤é©»è¶³ã€‚ System.out.println(\u0026#34;å­©å­ï¼Œè¾›è‹¦äº†ï¼Œæœ‰æ²¡æœ‰å¥½å¥½ç…§é¡¾è‡ªå·±å•Š\u0026#34;); System.out.println(\u0026#34;ä½ å¾—äº†ä»€ä¹ˆå¥–å•Šï¼Ÿ\u0026#34;+prize.name+\u0026#34;ï¼Œå¾ˆä¸é”™ï¼Œè¦ç»§ç»­åŠ æ²¹å•Šï¼\u0026#34;); } } å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæˆ‘ä»¬å°±è®¾è®¡äº†å››ç§è®¿é—®è€…ï¼Œä½†æ˜¯ä¸åŒçš„è®¿é—®è€…å¯¹äºæŸä¸€ä»¶äº‹åŠ¡çš„å¤„ç†å¯èƒ½ä¼šä¸åŒã€‚è®¿é—®è€…æ¨¡å¼æŠŠæ•°æ®ç»“æ„å’Œä½œç”¨äºç»“æ„ä¸Šçš„æ“ä½œè§£è€¦ï¼Œä½¿å¾—æ“ä½œé›†åˆå¯ç›¸å¯¹è‡ªç”±åœ°æ¼”åŒ–ï¼Œæˆ‘ä»¬ä¸Šé¢å°±æ˜¯å°†å¥–é¡¹æœ¬èº«çš„å±æ€§å’Œå¯¹äºå¥–é¡¹çš„ä¸åŒæ“ä½œè¿›è¡Œäº†åˆ†ç¦»ã€‚\n","date":"1 January 0001","externalUrl":null,"permalink":"/doc/design/%E8%A1%8C%E4%B8%BA%E5%9E%8B/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97---%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9B%9B%E8%A1%8C%E4%B8%BA%E5%9E%8B/","section":"Docs","summary":"è®¾è®¡æ¨¡å¼ï¼ˆè¡Œä¸ºå‹ï¼‰ #\rå‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†12ç§è®¾è®¡æ¨¡å¼ï¼Œåˆ†ä¸ºä¸¤ç±»ï¼š\nåˆ›å»ºå‹ï¼šå…³æ³¨å¯¹è±¡åˆ›å»º ç»“æ„å‹ï¼šå…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»“æ„ç»„ç»‡ æˆ‘ä»¬æ¥ç€æ¥çœ‹æœ€åä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯æœ€å¤šçš„ä¸€ç§ï¼Œè¡Œä¸ºå‹è®¾è®¡æ¨¡å¼å…³æ³¨ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œç ”ç©¶ç³»ç»Ÿåœ¨è¿è¡Œæ—¶å¯¹è±¡ä¹‹é—´çš„ç›¸äº’é€šä¿¡ä¸åä½œï¼Œè¿›ä¸€æ­¥æ˜ç¡®å¯¹è±¡çš„èŒè´£ã€‚\nè§£é‡Šå™¨æ¨¡å¼ #\rè¿™ç§æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯è¾ƒå°‘ï¼Œå¾ˆå°‘ä½¿ç”¨çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œè¿™é‡Œæä¸€ä¸‹å°±è¡Œã€‚\nè§£é‡Šå™¨é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯¹æˆ‘ä»¬çš„è¯­è¨€è¿›è¡Œè§£é‡Šï¼Œæ ¹æ®ä¸åŒçš„è¯­ä¹‰æ¥åšä¸åŒçš„äº‹æƒ…ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨SEä¸­å­¦ä¹ çš„åŒæ ˆè®¡ç®—å™¨ï¼Œæ­£æ˜¯æ ¹æ®æˆ‘ä»¬è¾“å…¥çš„ç®—å¼ï¼Œå»è¿›è¡Œè§£æï¼Œå¹¶æ ¹æ®ä¸åŒçš„è¿ç®—ç¬¦æ¥ä¸æ–­è¿›è¡Œè®¡ç®—ã€‚\næ¯”å¦‚æˆ‘ä»¬è¾“å…¥ï¼š1+2*3\né‚£ä¹ˆè®¡ç®—å™¨å°±ä¼šè¿›è¡Œè§£æç„¶åæ ¹æ®è¯­ä¹‰ä¼˜å…ˆè®¡ç®—2*3çš„ç»“æœç„¶ååœ¨è®¡ç®—1+6æœ€åå¾—åˆ°7ï¼Œè¯¦ç»†å®ç°è¯·å‚è€ƒJavaSEç¯‡åŒæ ˆè®¡ç®—å™¨å®ç°ã€‚\næ¨¡æ¿æ–¹æ³•æ¨¡å¼ #\ræ¨¡æ¿æ–¹æ³•æ¨¡å¼æˆ‘ä»¬ä¹‹å‰ä¹Ÿè§åˆ°è¿‡è®¸å¤šï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•ã€‚\næœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡å¯èƒ½éœ€è¦ç»å†å¾ˆå¤šä¸ªæ­¥éª¤æ¥å®Œæˆï¼Œæ¯”å¦‚æˆ‘ä»¬ç”Ÿç—…äº†åœ¨åŒ»é™¢çœ‹ç—…ï¼Œé¦–å…ˆæ˜¯å»é—¨è¯ŠæŒ‚å·ï¼Œç„¶åç­‰å¾…å«å·ï¼Œç„¶åæ˜¯å»æ‰¾åŒ»ç”Ÿçœ‹ç—…ï¼Œç¡®å®šç—…å› åï¼Œå°±æ ¹æ®åŒ»ç”Ÿçš„å¤„æ–¹å»å‰å°å¼€è¯ï¼Œæœ€åä»˜é’±ã€‚è¿™ä¸€æ•´å¥—æµç¨‹çœ‹ä¼¼æ˜¯è§„è§„çŸ©çŸ©çš„ï¼Œä½†æ˜¯åœ¨è¿™å…¶ä¸­ï¼ŒæŸäº›æ­¥éª¤å¹¶ä¸æ˜¯ç¡®å®šçš„ï¼Œæ¯”å¦‚åŒ»ç”Ÿçœ‹ç—…è¿™ä¸€æ­¥ï¼Œç”±äºä¸åŒçš„ç—…å› ï¼Œå¯èƒ½ä¼šè¿›è¡Œä¸åŒçš„å¤„ç†ï¼Œæœ€åå¼€å‡ºæ¥çš„è¯æ–¹ä¹Ÿä¼šä¸åŒï¼Œæ‰€ä»¥ï¼Œæ•´å¥—æµç¨‹ä¸­ï¼Œæœ‰äº›æ“ä½œæ˜¯å›ºå®šçš„ï¼Œæœ‰äº›æ“ä½œå¯èƒ½éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè€Œå®šã€‚\nåœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¯èƒ½æŸäº›æ“ä½œæ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨ç±»ä¸­å¯¹åº”æ–¹æ³•è¿›è¡Œç¼–å†™ï¼Œä½†æ˜¯å¯èƒ½æŸäº›æ“ä½œéœ€è¦è§†æƒ…å†µè€Œå®šï¼Œç”±ä¸åŒçš„å­ç±»å®ç°æ¥å†³å®šï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦è®©è¿™äº›æ“ä½œç”±å­ç±»æ¥å»¶è¿Ÿå®ç°äº†ã€‚ç°åœ¨æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚\næˆ‘ä»¬å…ˆæ¥å†™ä¸ªä¾‹å­ï¼š\n/** * æŠ½è±¡è¯Šæ–­æ–¹æ³•ï¼Œå› ä¸ºç°åœ¨åªçŸ¥é“æŒ‚å·å’Œçœ‹åŒ»ç”Ÿæ˜¯å›ºå®šæ¨¡å¼ï¼Œå‰©ä¸‹çš„å¼€å¤„æ–¹å’Œæ‹¿è¯éƒ½æ˜¯ä¸ç¡®å®šçš„ */ public abstract class AbstractDiagnosis { public void test(){ System.","title":"è¡Œä¸ºå‹","type":"doc"},{"content":"åˆ é™¤å…ƒç´ \næŒ‡çš„æ˜¯è¦†ç›–è€Œä¸æ˜¯çš„çš„ç¡®ç¡®çš„åˆ é™¤\nC++ vectorä½œä¸ºæ•°ç»„çš„å°è£…\neraseå‡½æ•°ï¼šåˆ é™¤ï¼šO(n)\nåŒæŒ‡é’ˆå®ç°\nclass Solution { public: int removeElement(vector\u0026lt;int\u0026gt;\u0026amp; nums, int val) { //å®šä¹‰å¿«æ…¢æŒ‡é’ˆ int fast = 0;//è·å–æ–°å…ƒç´  int slow = 0;//è·å–æ›´æ”¹ä½ç½® for(fast = 0; fast \u0026lt; nums.size(); fast++){ if(nums[fast] != val){ nums[slow++]=nums[fast]; } } return slow; } }; ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E7%A7%BB%E9%99%A4%E5%85%83%E7%B4%A0/","section":"Algorithms","summary":"åˆ é™¤å…ƒç´ \næŒ‡çš„æ˜¯è¦†ç›–è€Œä¸æ˜¯çš„çš„ç¡®ç¡®çš„åˆ é™¤\nC++ vectorä½œä¸ºæ•°ç»„çš„å°è£…\neraseå‡½æ•°ï¼šåˆ é™¤ï¼šO(n)\nåŒæŒ‡é’ˆå®ç°\nclass Solution { public: int removeElement(vector\u0026lt;int\u0026gt;\u0026amp; nums, int val) { //å®šä¹‰å¿«æ…¢æŒ‡é’ˆ int fast = 0;//è·å–æ–°å…ƒç´  int slow = 0;//è·å–æ›´æ”¹ä½ç½® for(fast = 0; fast \u0026lt; nums.","title":"ç§»é™¤å…ƒç´ ","type":"algorithm"},{"content":"977\næœ‰åºæ•°ç»„çš„å¹³æ–¹\nè¾“å…¥ï¼šnums = [-4,-1,0,3,10] è¾“å‡ºï¼š[0,1,9,16,100] è§£é‡Šï¼šå¹³æ–¹åï¼Œæ•°ç»„å˜ä¸º [16,1,0,9,100] æ’åºåï¼Œæ•°ç»„å˜ä¸º [0,1,9,16,100] æœ€å¤§å…ƒç´ åœ¨ä¸¤è¾¹ï¼Œä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆä»ä¸¤è¾¹åˆ°ä¸­é—´åˆæ‹¢\næ›´æ–°æ–¹æ³•ä»å¤§åˆ°å°\nvector\u0026lt;int\u0026gt;result(nums.size(),0); int k=nums.size()-1;//æ–°æ•°ç»„çš„ä¸‹æ ‡ int i=0,j=nums.size()-1; //åˆ†åˆ«ä»ä¸¤è¾¹å¾€ä¸­é—´å– while(i\u0026lt;=j){ if(nums[i]*nums[i]\u0026lt;nums[j]*nums[j]){ result[k--]=nums[j]*nums[j]; j--; } //num[i]*nums[i] \u0026gt;= nums[j]*nums[j] else { result[k--]=nums[i]*nums[i]; i++; } } return result; class Solution { public int[] sortedSquares(int[] nums) { int []res = new int [nums.length ]; int k = nums.length -1; int j=nums.length-1; int i =0; while(i\u0026lt;=j){ if(nums[i]*nums[i] \u0026gt; nums[j]*nums[j]){ res[k--] = nums[i]*nums[i]; i++; }else{ res[k--] = nums[j]*nums[j]; j--; } } return res; } } ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E7%9A%84%E5%B9%B3%E6%96%B9/","section":"Algorithms","summary":"977\næœ‰åºæ•°ç»„çš„å¹³æ–¹\nè¾“å…¥ï¼šnums = [-4,-1,0,3,10] è¾“å‡ºï¼š[0,1,9,16,100] è§£é‡Šï¼šå¹³æ–¹åï¼Œæ•°ç»„å˜ä¸º [16,1,0,9,100] æ’åºåï¼Œæ•°ç»„å˜ä¸º [0,1,9,16,100] æœ€å¤§å…ƒç´ åœ¨ä¸¤è¾¹ï¼Œä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆä»ä¸¤è¾¹åˆ°ä¸­é—´åˆæ‹¢\næ›´æ–°æ–¹æ³•ä»å¤§åˆ°å°\nvector\u0026lt;int\u0026gt;result(nums.size(),0); int k=nums.size()-1;//æ–°æ•°ç»„çš„ä¸‹æ ‡ int i=0,j=nums.size()-1; //åˆ†åˆ«ä»ä¸¤è¾¹å¾€ä¸­é—´å– while(i\u0026lt;=j){ if(nums[i]*nums[i]\u0026lt;nums[j]*nums[j]){ result[k--]=nums[j]*nums[j]; j--; } //num[i]*nums[i] \u0026gt;= nums[j]*nums[j] else { result[k--]=nums[i]*nums[i]; i++; } } return result; class Solution { public int[] sortedSquares(int[] nums) { int []res = new int [nums.","title":"æœ‰åºæ•°ç»„çš„å¹³æ–¹","type":"algorithm"},{"content":"209\nç»™å®šä¸€ä¸ªå«æœ‰ n ä¸ªæ­£æ•´æ•°çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•° target ã€‚\næ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶æ€»å’Œå¤§äºç­‰äº target çš„é•¿åº¦æœ€å°çš„ è¿ç»­ å­æ•°ç»„ [numsl, numsl+1, \u0026hellip;, numsr-1, numsr] ï¼Œå¹¶è¿”å›å…¶é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å› 0 ã€‚\nè¾“å…¥ï¼štarget = 7, nums = [2,3,1,2,4,3] è¾“å‡ºï¼š2 è§£é‡Šï¼šå­æ•°ç»„ [4,3] æ˜¯è¯¥æ¡ä»¶ä¸‹çš„é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€‚ #include \u0026lt;iostream\u0026gt; #include \u0026lt;cstdio\u0026gt; #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; using namespace std; class Solution { public: int minSubArrayLen(int target, vector\u0026lt;int\u0026gt;\u0026amp; nums) { int right = nums.size(); if(right == 0){ return 0; } int ans = INT_MAX; // vector\u0026lt;int\u0026gt; sums(right+1,0);//è¦å¤šä¸€ä¸ªé•¿åº¦ï¼Œå‰ç¼€å’Œ int *sums = (int *)malloc(sizeof(int) * (right + 1)); //è®¡ç®—å‰ç¼€å’Œ for(int i =1; i\u0026lt;=right; i++){ sums[i] = sums[i-1]+nums[i-1];//å¤ªå¦™äº†ï¼Œè¿™æ ·å°±å¯ä»¥è®¡ç®—å‰ç¼€å’Œäº† } //äºŒåˆ†æ³• for(int i = 1;i \u0026lt;= right; i++){ int mid = target+sums[i-1]; int bound = lower_bounds(sums, 1, right, mid); if(bound != -1){ ans=min(ans,(bound - ( i - 1 ))); } } return ans == INT_MAX ? 0 : ans; } int lower_bounds(int *array, int l, int r, int q) { if (array[r] \u0026lt; q) return -1; while (l \u0026lt; r) { int mid = (l + r) \u0026gt;\u0026gt; 1; if (array[mid] \u0026gt;= q) { r = mid; } else { l = mid + 1; } } return l; } }; int main(){ vector\u0026lt;int\u0026gt; nums={2,3,1,2,4,3}; Solution *solution; printf(\u0026#34;%d\u0026#34;,solution-\u0026gt;minSubArrayLen(7,nums)); } æ»‘åŠ¨çª—å£çš„åŠæ³•\nç¡®å®šå¦‚ä½•ç§»åŠ¨èµ·å§‹ä½ç½®\nç”±äºæ˜¯å–æœ€å°çš„ï¼Œæ‰€ä»¥ä½¿ç”¨å‡½æ•°min\næŒç»­å‘åç§»åŠ¨èµ·å§‹ä½ç½®ï¼Œæ›´æ–°sum\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;cstdio\u0026gt; #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; using namespace std; class Solution { public: int minSubArrayLen(int target, vector\u0026lt;int\u0026gt;\u0026amp; nums) { int len = nums.size(); int sum = 0; int index = 0; int ans = INT_MAX; for(int i = 0;i \u0026lt;= len -1; i++){ sum += nums[i];//æ±‚å’Œ while(sum \u0026gt;= target){//å¤§äºtargetï¼Œå¾€å‰å‡å°æ‰¾åˆ°ç¬¦åˆçš„åŒºé—´ int len = i-index + 1;//å½“å‰çª—å£çš„é•¿åº¦ sum -= nums[index]; ans = min(ans,len);//å–æœ€å°çš„ index++; } } return ans==INT_MAX ? 0 : ans; } }; int main(){ vector\u0026lt;int\u0026gt; nums={2,3,1,2,4,3}; Solution *solution; printf(\u0026#34;%d\u0026#34;,solution-\u0026gt;minSubArrayLen(7,nums)); } ","date":"1 January 0001","externalUrl":null,"permalink":"/algorithm/%E9%95%BF%E5%BA%A6%E6%9C%80%E5%B0%8F%E7%9A%84%E6%95%B0%E7%BB%84/","section":"Algorithms","summary":"209\nç»™å®šä¸€ä¸ªå«æœ‰ n ä¸ªæ­£æ•´æ•°çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•° target ã€‚\næ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶æ€»å’Œå¤§äºç­‰äº target çš„é•¿åº¦æœ€å°çš„ è¿ç»­ å­æ•°ç»„ [numsl, numsl+1, \u0026hellip;, numsr-1, numsr] ï¼Œå¹¶è¿”å›å…¶é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å› 0 ã€‚\nè¾“å…¥ï¼štarget = 7, nums = [2,3,1,2,4,3] è¾“å‡ºï¼š2 è§£é‡Šï¼šå­æ•°ç»„ [4,3] æ˜¯è¯¥æ¡ä»¶ä¸‹çš„é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€‚ #include \u0026lt;iostream\u0026gt; #include \u0026lt;cstdio\u0026gt; #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; using namespace std; class Solution { public: int minSubArrayLen(int target, vector\u0026lt;int\u0026gt;\u0026amp; nums) { int right = nums.","title":"é•¿åº¦æœ€å°çš„æ•°ç»„","type":"algorithm"}]